!function(e){var t={};function i(r){if(t[r])return t[r].exports;var n=t[r]={i:r,l:!1,exports:{}};return e[r].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=e,i.c=t,i.d=function(e,t,r){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(i.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)i.d(r,n,function(t){return e[t]}.bind(null,n));return r},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s="./single-documenteditor-bundle.js")}({"./modules/accumulationchart.js":function(e,t){function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}window.sf=window.sf||{};sf.charts=sf.base.extend({},sf.charts,function(e){"use strict";var t;!function(e){e.axisLabelFont={size:"12px",fontWeight:"Normal",color:null,fontStyle:"Normal",fontFamily:"Segoe UI"},e.axisTitleFont={size:"14px",fontWeight:"Normal",color:null,fontStyle:"Normal",fontFamily:"Segoe UI"},e.chartTitleFont={size:"15px",fontWeight:"500",color:null,fontStyle:"Normal",fontFamily:"Segoe UI"},e.chartSubTitleFont={size:"11px",fontWeight:"500",color:null,fontStyle:"Normal",fontFamily:"Segoe UI"},e.crosshairLabelFont={size:"13px",fontWeight:"Normal",color:null,fontStyle:"Normal",fontFamily:"Segoe UI"},e.tooltipLabelFont={size:"13px",fontWeight:"Normal",color:null,fontStyle:"Normal",fontFamily:"Segoe UI"},e.legendLabelFont={size:"13px",fontWeight:"Normal",color:null,fontStyle:"Normal",fontFamily:"Segoe UI"},e.legendTitleFont={size:"13px",fontWeight:"Normal",color:null,fontStyle:"Normal",fontFamily:"Segoe UI"},e.stripLineLabelFont={size:"12px",fontWeight:"Regular",color:"#353535",fontStyle:"Normal",fontFamily:"Segoe UI"},e.stockEventFont={size:"13px",fontWeight:"Normal",color:null,fontStyle:"Normal",fontFamily:"Segoe UI"}}(t||(t={}));var r,n,o,s,a=(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),l=function(e,t,r,n){var o,s=arguments.length,a=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(s<3?o(a):s>3?o(t,r,a):o(t,r))||a);return s>3&&a&&Object.defineProperty(t,r,a),a},h=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),l([sf.base.Property("Line")],t.prototype,"type",void 0),l([sf.base.Property(null)],t.prototype,"color",void 0),l([sf.base.Property(1)],t.prototype,"width",void 0),l([sf.base.Property(null)],t.prototype,"length",void 0),l([sf.base.Property("")],t.prototype,"dashArray",void 0),t}(sf.base.ChildProperty),d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),l([sf.base.Property("Normal")],t.prototype,"fontStyle",void 0),l([sf.base.Property("16px")],t.prototype,"size",void 0),l([sf.base.Property("Normal")],t.prototype,"fontWeight",void 0),l([sf.base.Property("")],t.prototype,"color",void 0),l([sf.base.Property("Center")],t.prototype,"textAlignment",void 0),l([sf.base.Property("Segoe UI")],t.prototype,"fontFamily",void 0),l([sf.base.Property(1)],t.prototype,"opacity",void 0),l([sf.base.Property("Trim")],t.prototype,"textOverflow",void 0),t}(sf.base.ChildProperty),c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),l([sf.base.Property("")],t.prototype,"color",void 0),l([sf.base.Property(1)],t.prototype,"width",void 0),t}(sf.base.ChildProperty),p=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}a(t,e),l([sf.base.Property(0)],t.prototype,"x",void 0),l([sf.base.Property(0)],t.prototype,"y",void 0)}(sf.base.ChildProperty),function(e){function t(){return null!==e&&e.apply(this,arguments)||this}a(t,e),l([sf.base.Complex({},c)],t.prototype,"border",void 0),l([sf.base.Property("transparent")],t.prototype,"background",void 0),l([sf.base.Property(1)],t.prototype,"opacity",void 0),l([sf.base.Property(null)],t.prototype,"backgroundImage",void 0)}(sf.base.ChildProperty),function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),l([sf.base.Property(10)],t.prototype,"left",void 0),l([sf.base.Property(10)],t.prototype,"right",void 0),l([sf.base.Property(10)],t.prototype,"top",void 0),l([sf.base.Property(10)],t.prototype,"bottom",void 0),t}(sf.base.ChildProperty)),u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),l([sf.base.Property(0)],t.prototype,"left",void 0),l([sf.base.Property(0)],t.prototype,"right",void 0),l([sf.base.Property(0)],t.prototype,"top",void 0),l([sf.base.Property(0)],t.prototype,"bottom",void 0),t}(sf.base.ChildProperty),g=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),l([sf.base.Property(!0)],t.prototype,"enable",void 0),l([sf.base.Property(1e3)],t.prototype,"duration",void 0),l([sf.base.Property(0)],t.prototype,"delay",void 0),t}(sf.base.ChildProperty),f=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),l([sf.base.Property(0)],t.prototype,"series",void 0),l([sf.base.Property(0)],t.prototype,"point",void 0),t}(sf.base.ChildProperty),m=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}a(t,e),l([sf.base.Property(0)],t.prototype,"topLeft",void 0),l([sf.base.Property(0)],t.prototype,"topRight",void 0),l([sf.base.Property(0)],t.prototype,"bottomLeft",void 0),l([sf.base.Property(0)],t.prototype,"bottomRight",void 0)}(sf.base.ChildProperty),function(e,t){this.series=e,this.point=t}),y=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),l([sf.base.Property(null)],t.prototype,"fill",void 0),l([sf.base.Complex({color:"transparent",width:0},c)],t.prototype,"border",void 0),l([sf.base.Property("Gap")],t.prototype,"mode",void 0),t}(sf.base.ChildProperty),v=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}a(t,e),l([sf.base.Property(!1)],t.prototype,"enable",void 0),l([sf.base.Property(null)],t.prototype,"minY",void 0),l([sf.base.Property(null)],t.prototype,"maxY",void 0),l([sf.base.Property(null)],t.prototype,"fill",void 0)}(sf.base.ChildProperty),function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return a(i,e),l([sf.base.Property(!1)],i.prototype,"enable",void 0),l([sf.base.Property(!0)],i.prototype,"enableMarker",void 0),l([sf.base.Property(!1)],i.prototype,"shared",void 0),l([sf.base.Property(null)],i.prototype,"fill",void 0),l([sf.base.Property(null)],i.prototype,"header",void 0),l([sf.base.Property(.75)],i.prototype,"opacity",void 0),l([sf.base.Complex(t.tooltipLabelFont,d)],i.prototype,"textStyle",void 0),l([sf.base.Property(null)],i.prototype,"format",void 0),l([sf.base.Property(null)],i.prototype,"template",void 0),l([sf.base.Property(!0)],i.prototype,"enableAnimation",void 0),l([sf.base.Property(300)],i.prototype,"duration",void 0),l([sf.base.Property(1e3)],i.prototype,"fadeOutDuration",void 0),l([sf.base.Property("Move")],i.prototype,"fadeOutMode",void 0),l([sf.base.Property(!1)],i.prototype,"enableTextWrap",void 0),l([sf.base.Complex({color:"#cccccc",width:.5},c)],i.prototype,"border",void 0),i}(sf.base.ChildProperty)),b=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),l([sf.base.Property("Years")],t.prototype,"intervalType",void 0),l([sf.base.Property(1)],t.prototype,"interval",void 0),l([sf.base.Property(null)],t.prototype,"text",void 0),l([sf.base.Property(!1)],t.prototype,"selected",void 0),t}(sf.base.ChildProperty),w=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}a(t,e),l([sf.base.Property(43)],t.prototype,"height",void 0),l([sf.base.Property("Bottom")],t.prototype,"position",void 0),l([sf.base.Collection([],b)],t.prototype,"periods",void 0)}(sf.base.ChildProperty),function(){function e(e,t){e<t?(this.mStart=e,this.mEnd=t):(this.mStart=t,this.mEnd=e)}return Object.defineProperty(e.prototype,"start",{get:function(){return this.mStart},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"end",{get:function(){return this.mEnd},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"delta",{get:function(){return this.mEnd-this.mStart},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"median",{get:function(){return this.mStart+(this.mEnd-this.mStart)/2},enumerable:!0,configurable:!0}),e}()),x=function(){function e(e){this.isColumn=0,this.chart=e}return e.prototype.calculateNumericNiceInterval=function(e,t,i){var r=function(e,t){var i="Horizontal"===t.orientation?e.width:e.height;if(sf.base.isNullOrUndefined(t.desiredIntervals)){var r=("Horizontal"===t.orientation?.533:1)*t.maximumLabels;return r=Math.max(i*(r/100),1)}return t.desiredIntervals}(i,e),n=t/r;if(!sf.base.isNullOrUndefined(e.desiredIntervals))return n;for(var o=Math.pow(10,Math.floor(B(n,10))),s=0,a=e.intervalDivs;s<a.length;s++){var l=o*a[s];if(r<t/l)break;n=l}return n},e.prototype.getActualRange=function(e,t){this.initializeDoubleRange(e),!e.startFromZero&&this.isColumn>0?(e.actualRange.interval=e.interval||this.calculateNumericNiceInterval(e,e.doubleRange.delta,t),e.actualRange.max=e.doubleRange.end+e.actualRange.interval,e.doubleRange.start-e.actualRange.interval<0&&e.doubleRange.start>0?e.actualRange.min=0:e.actualRange.min=e.doubleRange.start-e.actualRange.interval):(e.actualRange.interval=e.interval||this.calculateNumericNiceInterval(e,e.doubleRange.delta,t),e.actualRange.min=e.doubleRange.start,e.actualRange.max=e.doubleRange.end)},e.prototype.initializeDoubleRange=function(e){null!==e.minimum?this.min=e.minimum:null!==this.min&&this.min!==Number.POSITIVE_INFINITY||(this.min=0),null!==e.maximum?this.max=e.maximum:null!==this.max&&this.max!==Number.NEGATIVE_INFINITY||(this.max=5),this.min===this.max&&(this.max=e.valueType.indexOf("Category")>-1?this.max:this.min+1),e.doubleRange=new w(this.min,this.max),e.actualRange={}},e.prototype.calculateRangeAndInterval=function(e,t){this.calculateRange(t),this.getActualRange(t,e),this.applyRangePadding(t,e),this.calculateVisibleLabels(t,this.chart)},e.prototype.calculateRange=function(e){if(/*! Generate axis range */this.min=null,this.max=null,!ee(e))for(var t=0,i=e.series;t<i.length;t++){var r=i[t];r.visible&&(this.paddingInterval=0,e.maxPointLength=r.points.length,((r.type.indexOf("Column")>-1||r.type.indexOf("Histogram")>-1)&&"Horizontal"===e.orientation||r.type.indexOf("Bar")>-1&&"Vertical"===e.orientation)&&("Double"!==r.xAxis.valueType&&"DateTime"!==r.xAxis.valueType||"Auto"!==r.xAxis.rangePadding||(this.paddingInterval=.5*K(r.xAxis,e.series))),"Horizontal"===e.orientation&&(this.chart.requireInvertedAxis?this.yAxisRange(e,r):this.findMinMax(r.xMin-this.paddingInterval,r.xMax+this.paddingInterval)),"Vertical"===e.orientation&&(this.isColumn+="Column"===r.type||"Bar"===r.type||"Column"===r.drawType?1:0,this.chart.requireInvertedAxis?this.findMinMax(r.xMin-this.paddingInterval,r.xMax+this.paddingInterval):this.yAxisRange(e,r)))}},e.prototype.yAxisRange=function(e,t){t.dragSettings.enable&&this.chart.dragY&&(this.chart.dragY>=e.visibleRange.max&&(t.yMax=this.chart.dragY+e.visibleRange.interval),this.chart.dragY<=e.visibleRange.min&&(t.yMin=this.chart.dragY-e.visibleRange.interval)),this.findMinMax(t.yMin,t.yMax)},e.prototype.findMinMax=function(e,t){(null===this.min||this.min>e)&&(this.min=e),(null===this.max||this.max<t)&&(this.max=t),this.max===this.min&&this.max<0&&this.min<0&&(this.max=0)},e.prototype.applyRangePadding=function(e,t){var i=e.actualRange.min,r=e.actualRange.max;if(!ee(e)){var n=e.actualRange.interval,o=e.getRangePadding(this.chart);"Additional"===o||"Round"===o?this.findAdditional(e,i,r,n):"Normal"===o?this.findNormal(e,i,r,n,t):this.updateActualRange(e,i,r,n)}e.actualRange.delta=e.actualRange.max-e.actualRange.min,this.calculateVisibleRange(t,e)},e.prototype.updateActualRange=function(e,t,i,r){e.actualRange={min:null!=e.minimum?e.minimum:t,max:null!=e.maximum?e.maximum:i,interval:null!=e.interval?e.interval:r,delta:e.actualRange.delta}},e.prototype.findAdditional=function(e,t,i,r){var n,o;n=Math.floor(t/r)*r,o=Math.ceil(i/r)*r,"Additional"===e.rangePadding&&(n-=r,o+=r),this.updateActualRange(e,n,o,r)},e.prototype.findNormal=function(e,t,i,r,n){var o,s,a=t;t<0?(a=0,.365*r>=r+(o=t+.05*t)%r&&(o-=r),o%r<0&&(o=o-r-o%r)):(o=t<5/6*i?0:t-.5*(i-t))%r>0&&(o-=o%r),.365*r>=r-(s=i>0?i+.05*(i-a):i-.05*(i-a))%r&&(s+=r),s%r>0&&(s=s+r-s%r),e.doubleRange=new w(o,s),0===o&&(r=this.calculateNumericNiceInterval(e,e.doubleRange.delta,n),s=Math.ceil(s/r)*r),this.updateActualRange(e,o,s,r)},e.prototype.calculateVisibleRange=function(e,t){if(t.visibleRange={max:t.actualRange.max,min:t.actualRange.min,delta:t.actualRange.delta,interval:t.actualRange.interval},"Cartesian"===this.chart.chartAreaType){var i=!sf.base.isNullOrUndefined(t.zoomingScrollBar)&&t.zoomingScrollBar.isLazyLoad;(t.zoomFactor<1||t.zoomPosition>0)&&!i&&(t.calculateVisibleRangeOnZooming(e),t.calculateAxisRange(e,this.chart),t.visibleRange.interval=t.enableAutoIntervalOnZooming&&"Category"!==t.valueType?this.calculateNumericNiceInterval(t,t.doubleRange.delta,e):t.visibleRange.interval)}t.triggerRangeRender(this.chart,t.visibleRange.min,t.visibleRange.max,t.visibleRange.interval)},e.prototype.calculateVisibleLabels=function(e,t){/*! Generate axis labels */e.visibleLabels=[];var i,r=e.visibleRange.min;!("chart"===t.getModuleName()&&"PolarRadar"===t.chartAreaType)&&(e.zoomFactor<1||e.zoomPosition>0||this.paddingInterval)&&(r=e.visibleRange.min-e.visibleRange.min%e.visibleRange.interval);var n,o=this.getFormat(e),s=null!==o.match("{value}"),a=0,l=0;for(e.labelFormat&&e.labelFormat.indexOf("n")>-1&&(l=parseInt(e.labelFormat.substring(1,e.labelFormat.length),10)),e.format=t.intl.getNumberFormat({format:s?"":o,useGrouping:t.useGroupingSeparator}),e.startLabel=e.format(e.visibleRange.min),e.endLabel=e.format(e.visibleRange.max),e.visibleRange.interval&&(e.visibleRange.interval+"").indexOf(".")>=0&&(a=(e.visibleRange.interval+"").split(".")[1].length);r<=e.visibleRange.max&&n!==r;r+=e.visibleRange.interval)n=r,i=sf.base.extend({},sf.base.getValue("properties",e.labelStyle),null,!0),V(r,e.visibleRange)&&$(t,r,this.formatValue(e,s,o,r),i,e);r&&(r+"").indexOf(".")>=0&&(r+"").split(".")[1].length>10&&(r=(r+"").split(".")[1].length>(l||a)?+r.toFixed(l||a):r)<=e.visibleRange.max&&$(t,r,this.formatValue(e,s,o,r),i,e),e.getMaxLabelWidth&&e.getMaxLabelWidth(this.chart)},e.prototype.getFormat=function(e){return e.labelFormat?0===e.labelFormat.indexOf("p")&&-1===e.labelFormat.indexOf("{value}")&&e.isStack100?"{value}%":e.labelFormat:e.isStack100?"{value}%":""},e.prototype.formatValue=function(e,t,i,r){return t?i.replace("{value}",e.format(r)):e.format(r)},e}(),M=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),N=function(e,t,r,n){var o,s=arguments.length,a=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(s<3?o(a):s>3?o(t,r,a):o(t,r))||a);return s>3&&a&&Object.defineProperty(t,r,a),a},I=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}M(t,e),N([sf.base.Property("0")],t.prototype,"x",void 0),N([sf.base.Property("0")],t.prototype,"y",void 0),N([sf.base.Property(null)],t.prototype,"content",void 0),N([sf.base.Property("Center")],t.prototype,"horizontalAlignment",void 0),N([sf.base.Property("Pixel")],t.prototype,"coordinateUnits",void 0),N([sf.base.Property("Chart")],t.prototype,"region",void 0),N([sf.base.Property("Middle")],t.prototype,"verticalAlignment",void 0),N([sf.base.Property(null)],t.prototype,"xAxisName",void 0),N([sf.base.Property(null)],t.prototype,"yAxisName",void 0),N([sf.base.Property(null)],t.prototype,"description",void 0)}(sf.base.ChildProperty),function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return M(t,e),N([sf.base.Property("")],t.prototype,"color",void 0),N([sf.base.Property(1)],t.prototype,"width",void 0),N([sf.base.Property("Rectangle")],t.prototype,"type",void 0),t}(sf.base.ChildProperty)),S=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return M(t,e),N([sf.base.Property(null)],t.prototype,"start",void 0),N([sf.base.Property(null)],t.prototype,"end",void 0),N([sf.base.Property("")],t.prototype,"text",void 0),N([sf.base.Property(null)],t.prototype,"maximumTextWidth",void 0),N([sf.base.Property(null)],t.prototype,"customAttributes",void 0),N([sf.base.Property("")],t.prototype,"type",void 0),t}(sf.base.ChildProperty),C=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return M(i,e),N([sf.base.Property(!0)],i.prototype,"visible",void 0),N([sf.base.Property(!1)],i.prototype,"startFromAxis",void 0),N([sf.base.Property(null)],i.prototype,"start",void 0),N([sf.base.Property(null)],i.prototype,"end",void 0),N([sf.base.Property(null)],i.prototype,"size",void 0),N([sf.base.Property("#808080")],i.prototype,"color",void 0),N([sf.base.Property(null)],i.prototype,"dashArray",void 0),N([sf.base.Property("Auto")],i.prototype,"sizeType",void 0),N([sf.base.Property(!1)],i.prototype,"isRepeat",void 0),N([sf.base.Property(null)],i.prototype,"repeatEvery",void 0),N([sf.base.Property(null)],i.prototype,"repeatUntil",void 0),N([sf.base.Property(!1)],i.prototype,"isSegmented",void 0),N([sf.base.Property(null)],i.prototype,"segmentStart",void 0),N([sf.base.Property(null)],i.prototype,"segmentEnd",void 0),N([sf.base.Property(null)],i.prototype,"segmentAxisName",void 0),N([sf.base.Complex({color:"transparent",width:1},c)],i.prototype,"border",void 0),N([sf.base.Property("")],i.prototype,"text",void 0),N([sf.base.Property(null)],i.prototype,"rotation",void 0),N([sf.base.Property("Middle")],i.prototype,"horizontalAlignment",void 0),N([sf.base.Property("Middle")],i.prototype,"verticalAlignment",void 0),N([sf.base.Complex(t.stripLineLabelFont,d)],i.prototype,"textStyle",void 0),N([sf.base.Property("Behind")],i.prototype,"zIndex",void 0),N([sf.base.Property(1)],i.prototype,"opacity",void 0),i}(sf.base.ChildProperty),O=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return M(i,e),N([sf.base.Property("Center")],i.prototype,"alignment",void 0),N([sf.base.Property("Wrap")],i.prototype,"overflow",void 0),N([sf.base.Complex(t.axisLabelFont,d)],i.prototype,"textStyle",void 0),N([sf.base.Complex({color:null,width:1,type:"Rectangle"},I)],i.prototype,"border",void 0),N([sf.base.Collection([],S)],i.prototype,"categories",void 0),i}(sf.base.ChildProperty),T=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return M(t,e),N([sf.base.Property(null)],t.prototype,"minimum",void 0),N([sf.base.Property(null)],t.prototype,"maximum",void 0),t}(sf.base.ChildProperty),P=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return M(t,e),N([sf.base.Property(!1)],t.prototype,"enable",void 0),N([sf.base.Property(null)],t.prototype,"pointsLength",void 0),N([sf.base.Complex({},T)],t.prototype,"range",void 0),t}(sf.base.ChildProperty),A=(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),L=function(e,t,r,n){var o,s=arguments.length,a=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(s<3?o(a):s>3?o(t,r,a):o(t,r))||a);return s>3&&a&&Object.defineProperty(t,r,a),a},F=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.axes=[],t.nearSizes=[],t.farSizes=[],t}A(t,e),t.prototype.computeSize=function(e,t){var i=0;e.visible&&e.internalVisibility&&(i+=e.findTickSize(e.crossInAxis)+t+e.findLabelSize(e.crossInAxis,5)+.5*e.lineStyle.width),e.opposedPosition?this.farSizes.push(i):this.nearSizes.push(i)},L([sf.base.Property("100%")],t.prototype,"height",void 0),L([sf.base.Complex({},c)],t.prototype,"border",void 0)}(sf.base.ChildProperty),function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.axes=[],t.nearSizes=[],t.farSizes=[],t.padding=0,t}A(t,e),t.prototype.computeSize=function(e,t){var i=0;e.visible&&e.internalVisibility&&(i+=e.findTickSize(e.crossInAxis)+t+e.findLabelSize(e.crossInAxis,5)+.5*e.lineStyle.width),e.opposedPosition?this.farSizes.push(i):this.nearSizes.push(i)},L([sf.base.Property("100%")],t.prototype,"width",void 0),L([sf.base.Complex({},c)],t.prototype,"border",void 0)}(sf.base.ChildProperty),function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return A(t,e),L([sf.base.Property(1)],t.prototype,"width",void 0),L([sf.base.Property("")],t.prototype,"dashArray",void 0),L([sf.base.Property(null)],t.prototype,"color",void 0),t}(sf.base.ChildProperty)),D=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return A(t,e),L([sf.base.Property(.7)],t.prototype,"width",void 0),L([sf.base.Property("")],t.prototype,"dashArray",void 0),L([sf.base.Property(null)],t.prototype,"color",void 0),t}(sf.base.ChildProperty),E=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return A(t,e),L([sf.base.Property(1)],t.prototype,"width",void 0),L([sf.base.Property("")],t.prototype,"dashArray",void 0),L([sf.base.Property(null)],t.prototype,"color",void 0),t}(sf.base.ChildProperty),z=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return A(t,e),L([sf.base.Property(1)],t.prototype,"width",void 0),L([sf.base.Property(5)],t.prototype,"height",void 0),L([sf.base.Property(null)],t.prototype,"color",void 0),t}(sf.base.ChildProperty),k=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return A(t,e),L([sf.base.Property(.7)],t.prototype,"width",void 0),L([sf.base.Property(5)],t.prototype,"height",void 0),L([sf.base.Property(null)],t.prototype,"color",void 0),t}(sf.base.ChildProperty),W=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return A(i,e),L([sf.base.Property(!1)],i.prototype,"enable",void 0),L([sf.base.Property(null)],i.prototype,"fill",void 0),L([sf.base.Complex(t.crosshairLabelFont,d)],i.prototype,"textStyle",void 0),i}(sf.base.ChildProperty),R=(function(e){function i(t,i,r,n){var o=e.call(this,t,i,r,n)||this;return o.visibleLabels=[],o.series=[],o.rect=new sf.svgbase.Rect(void 0,void 0,0,0),o.axisBottomLine=null,o.intervalDivs=[10,5,2,1],o.isStack100=!1,o.crossAt=null,o.updatedRect=null,o.multiLevelLabelHeight=0,o.isChart=!0,o.isIntervalInDecimal=!0,o.titleCollection=[],o.titleSize=new sf.svgbase.Size(0,0),o.internalVisibility=!0,o.angle=o.labelRotation,o}A(i,e),i.prototype.findTickSize=function(e){return"Inside"===this.tickPosition?0:!e||e.visibleRange&&!this.isInside(e.visibleRange)?this.majorTickLines.height:0},i.prototype.isInside=function(e){return function(e,t){return e<t.max&&e>t.min}(this.crossAt,e)||!this.opposedPosition&&this.crossAt>=e.max||this.opposedPosition&&this.crossAt<=e.min},i.prototype.findLabelSize=function(e,t){var i,r,n=0,o="Horizontal"===this.orientation;if(this.title&&(this.titleSize=sf.svgbase.measureText(this.title,this.titleStyle),n=this.titleSize.height+t,this.rect.width||this.rect.height)){var s=o?this.rect.width:this.rect.height;this.titleCollection=ve(this.title,this.titleStyle,s),n*=this.titleCollection.length}if("Inside"===this.labelPosition)return n+t;var a=n+t+this.titlePadding+this.labelPadding+("Vertical"===this.orientation?this.maxLabelSize.width:this.maxLabelSize.height)+this.multiLevelLabelHeight;if(e&&this.placeNextToAxisLine){var l=e.visibleRange,h="Horizontal"===e.orientation?e.rect.width:e.rect.height;if(!l||!h)return 0;this.isInside(l)&&(a=(i=(r=this.findDifference(e))*((h-((i=r*(h/l.delta))<a?a-i:0))/l.delta))<a?a-i:0)}return a},i.prototype.updateCrossValue=function(){var e=this.crossAt;if(null===e||!this.isInside(this.crossInAxis.visibleRange))return this.updatedRect=this.rect,null;var t=this.crossInAxis.visibleRange;this.opposedPosition?this.crossAt<t.min&&(e=t.min):this.crossAt>t.max&&(e=t.max),this.updatedRect=sf.base.extend({},this.rect,null,!0),"Horizontal"===this.orientation?(e=this.crossInAxis.rect.height-q(e,this.crossInAxis)*this.crossInAxis.rect.height,this.updatedRect.y=this.crossInAxis.rect.y+e):(e=q(e,this.crossInAxis)*this.crossInAxis.rect.width,this.updatedRect.x=this.crossInAxis.rect.x+e)},i.prototype.findDifference=function(e){var t=0;return t=this.opposedPosition?e.isInversed?e.visibleRange.min:e.visibleRange.max:e.isInversed?e.visibleRange.max:e.visibleRange.min,Math.abs(this.crossAt-t)},i.prototype.calculateVisibleRangeOnZooming=function(e){if((n=this).zoomFactor<1&&n.zoomPosition>=0){var t=this.actualRange,i=void 0,r=void 0;r=this.isInversed?(i=this.actualRange.max-this.zoomPosition*this.actualRange.delta)-this.zoomFactor*this.actualRange.delta:(i=this.actualRange.min+this.zoomPosition*this.actualRange.delta)+this.zoomFactor*this.actualRange.delta,i<t.min&&(r+=t.min-i,i=t.min),r>t.max&&(i-=r-t.max,r=t.max),this.doubleRange=new w(i,r),this.visibleRange={min:this.doubleRange.start,max:this.doubleRange.end,delta:this.doubleRange.delta,interval:this.visibleRange.interval}}var n},i.prototype.calculateAxisRange=function(e,t){if(t.enableAutoIntervalOnBothAxis){if("Horizontal"===this.orientation&&"X"===t.zoomSettings.mode)for(var i=0;i<this.series.length;i++){for(var r=[],n=0,o=this.series[i].visiblePoints;n<o.length;n++){(c=o[n]).xValue>this.visibleRange.min&&c.xValue<this.visibleRange.max&&r.push(c.yValue)}for(var s=0,a=t.axisCollections;s<a.length;s++){"Vertical"!==(g=a[s]).orientation||sf.base.isNullOrUndefined(g.series[i])||(g.series[i].yMin=Math.min.apply(Math,r),g.series[i].yMax=Math.max.apply(Math,r),g.baseModule.calculateRangeAndInterval(e,g))}}if("Vertical"===this.orientation&&"Y"===t.zoomSettings.mode)for(i=0;i<this.series.length;i++){for(var l=[],h=0,d=this.series[i].visiblePoints;h<d.length;h++){var c;(c=d[h]).yValue>this.visibleRange.min&&c.yValue<this.visibleRange.max&&l.push(c.xValue)}for(var p=0,u=t.axisCollections;p<u.length;p++){var g;"Horizontal"!==(g=u[p]).orientation||sf.base.isNullOrUndefined(g.series[i])||(g.series[i].xMin=Math.min.apply(Math,l),g.series[i].xMax=Math.max.apply(Math,l),g.baseModule.calculateRangeAndInterval(e,g))}}}},i.prototype.triggerRangeRender=function(e,t,i,r){var n={cancel:!1,name:"axisRangeCalculated",axis:this,minimum:t,maximum:i,interval:r};e.trigger("axisRangeCalculated",n),n.cancel||(this.visibleRange={min:n.minimum,max:n.maximum,interval:n.interval,delta:n.maximum-n.minimum})},i.prototype.getRangePadding=function(e){var t=this.rangePadding;if("Auto"!==t)return t;switch(this.orientation){case"Horizontal":t=e.requireInvertedAxis?this.isStack100||this.baseModule.chart.stockChart?"Round":"Normal":"None";break;case"Vertical":t=e.requireInvertedAxis?"None":this.isStack100||this.baseModule.chart.stockChart?"Round":"Normal"}return t},i.prototype.getMaxLabelWidth=function(e){var t,i,r=0,n=!1;this.angle=this.labelRotation,this.maxLabelSize=new sf.svgbase.Size(0,0);for(var o,s=this.labelIntersectAction,a=0,l=this.visibleLabels.length;a<l;a++){(i=U((o=this.visibleLabels[a]).originalText))?(o.size=sf.svgbase.measureText(o.originalText.replace(/<br>/g," "),this.labelStyle),o.breakLabelSize=sf.svgbase.measureText(this.enableTrim?o.text.join("<br>"):o.originalText,this.labelStyle)):o.size=sf.svgbase.measureText(o.text,this.labelStyle);var h=i?o.breakLabelSize.width:o.size.width;h>this.maxLabelSize.width&&(this.maxLabelSize.width=h,this.rotatedLabel=o.text);var d=i?o.breakLabelSize.height:o.size.height;if(d>this.maxLabelSize.height&&(this.maxLabelSize.height=d),i&&(o.text=this.enableTrim?o.text:o.originalText.split("<br>")),"None"!==s&&"Hide"!==s&&"Trim"!==s&&("None"!==s||this.angle%360==0)&&"Horizontal"===this.orientation&&this.rect.width>0&&!n){var c=i?o.breakLabelSize.width:o.size.width;switch(t=q(o.value,this)*this.rect.width+this.rect.x,t-=c/2,"Shift"===this.edgeLabelPlacement&&(0===a&&t<this.rect.x&&(t=this.rect.x),a===this.visibleLabels.length-1&&t+c>this.rect.x+this.rect.width&&(t=this.rect.x+this.rect.width-c)),s){case"MultipleRows":a>0&&this.findMultiRows(a,t,o,i);break;case"Rotate45":case"Rotate90":a>0&&(this.isInversed?t+c>=r:t<=r)&&(this.angle="Rotate45"===s?45:90,n=!0);break;default:if(i){for(var p=void 0,u=[],g=void 0,f=0;f<o.text.length;f++)if((p=we(o.text[f],this.rect.width/this.visibleLabels.length,this.labelStyle)).length>1)for(var m=0;m<p.length;m++)g=p[m],u.push(g);else u.push(p[0]);o.text=u}else o.text=we(o.text,this.rect.width/this.visibleLabels.length,this.labelStyle);var y=o.size.height*o.text.length;y>this.maxLabelSize.height&&(this.maxLabelSize.height=y)}r=this.isInversed?t:t+c}}if(0!==this.angle&&"Horizontal"===this.orientation){this.rotatedLabel=sf.base.isNullOrUndefined(this.rotatedLabel)?"":this.rotatedLabel;var v=-360===this.angle||0===this.angle||-180===this.angle||180===this.angle||360===this.angle;"Outside"===this.labelPosition&&!v&&U(this.rotatedLabel)?this.maxLabelSize=new sf.svgbase.Size(this.maxLabelSize.height,this.maxLabelSize.width):this.maxLabelSize=function(e,t,i,r){var n,o,s,a,l,h=new sf.svgbase.SvgRenderer(r.element.id),d=[],c={id:"rotate_text",x:r.initialClipRect.x,y:r.initialClipRect.y,"font-size":e.size,"font-style":e.fontStyle,"font-family":e.fontFamily,"font-weight":e.fontWeight,transform:"rotate("+i+", 0, 0)","text-anchor":"middle"};U(t)?(d=t.split("<br>"),n=d[0]):n=t;var p=h.createText(c,n);r.delayRedraw||r.redraw||r.element.appendChild(r.svgObject);if("string"!=typeof d&&d.length>1)for(var u=1,g=d.length;u<g;u++)o=sf.svgbase.measureText(d[u],e).height,s=c.y+u*o,a=d[u],l=h.createTSpan({x:c.x,id:c.id,y:s},a),p.appendChild(l);r.svgObject.appendChild(p);var f=p.getBoundingClientRect();sf.base.remove(p),r.delayRedraw||r.redraw||sf.base.remove(r.svgObject);return new sf.svgbase.Size(f.right-f.left,f.bottom-f.top)}(this.labelStyle,this.rotatedLabel,this.angle,e)}e.multiLevelLabelModule&&this.multiLevelLabels.length>0&&e.multiLevelLabelModule.getMultilevelLabelsHeight(this)},i.prototype.findMultiRows=function(e,t,i,r){for(var n,o,s,a=[],l=e-1;l>=0;l--)n=this.visibleLabels[l],s=r?n.breakLabelSize.width:n.size.width,o=q(n.value,this)*this.rect.width+this.rect.x,(this.isInversed?t+i.size.width>o-.5*s:t<o+.5*s)?(a.push(n.index),i.index=i.index>n.index?i.index:n.index+1):i.index=a.indexOf(n.index)>-1?i.index:n.index;var h=(r?i.breakLabelSize.height:i.size.height)*i.index+5*(i.index-1);h>this.maxLabelSize.height&&(this.maxLabelSize.height=h)},i.prototype.getModule=function(e){"Double"===this.valueType?this.baseModule=new x(e):this.baseModule=e[Z(this.valueType)+"Module"]},L([sf.base.Complex(t.axisLabelFont,d)],i.prototype,"labelStyle",void 0),L([sf.base.Complex({},W)],i.prototype,"crosshairTooltip",void 0),L([sf.base.Property("")],i.prototype,"title",void 0),L([sf.base.Complex(t.axisTitleFont,d)],i.prototype,"titleStyle",void 0),L([sf.base.Property("")],i.prototype,"labelFormat",void 0),L([sf.base.Property("")],i.prototype,"skeleton",void 0),L([sf.base.Property("DateTime")],i.prototype,"skeletonType",void 0),L([sf.base.Property("Center")],i.prototype,"lineBreakAlignment",void 0),L([sf.base.Property(0)],i.prototype,"plotOffset",void 0),L([sf.base.Property(null)],i.prototype,"plotOffsetLeft",void 0),L([sf.base.Property(null)],i.prototype,"plotOffsetTop",void 0),L([sf.base.Property(null)],i.prototype,"plotOffsetRight",void 0),L([sf.base.Property(null)],i.prototype,"plotOffsetBottom",void 0),L([sf.base.Property(!1)],i.prototype,"isIndexed",void 0),L([sf.base.Property(10)],i.prototype,"logBase",void 0),L([sf.base.Property(0)],i.prototype,"columnIndex",void 0),L([sf.base.Property(0)],i.prototype,"rowIndex",void 0),L([sf.base.Property(1)],i.prototype,"span",void 0),L([sf.base.Property(null)],i.prototype,"desiredIntervals",void 0),L([sf.base.Property(3)],i.prototype,"maximumLabels",void 0),L([sf.base.Property(1)],i.prototype,"zoomFactor",void 0),L([sf.base.Property(0)],i.prototype,"zoomPosition",void 0),L([sf.base.Property(!0)],i.prototype,"enableScrollbarOnZooming",void 0),L([sf.base.Property(!1)],i.prototype,"opposedPosition",void 0),L([sf.base.Property(!0)],i.prototype,"enableAutoIntervalOnZooming",void 0),L([sf.base.Property("Auto")],i.prototype,"rangePadding",void 0),L([sf.base.Property("Double")],i.prototype,"valueType",void 0),L([sf.base.Property("None")],i.prototype,"edgeLabelPlacement",void 0),L([sf.base.Property("Auto")],i.prototype,"intervalType",void 0),L([sf.base.Property("BetweenTicks")],i.prototype,"labelPlacement",void 0),L([sf.base.Property("Outside")],i.prototype,"tickPosition",void 0),L([sf.base.Property("Outside")],i.prototype,"labelPosition",void 0),L([sf.base.Property("")],i.prototype,"name",void 0),L([sf.base.Property(!0)],i.prototype,"visible",void 0),L([sf.base.Property(0)],i.prototype,"minorTicksPerInterval",void 0),L([sf.base.Property(0)],i.prototype,"labelRotation",void 0),L([sf.base.Property(null)],i.prototype,"crossesAt",void 0),L([sf.base.Property(!0)],i.prototype,"placeNextToAxisLine",void 0),L([sf.base.Property(null)],i.prototype,"crossesInAxis",void 0),L([sf.base.Property(null)],i.prototype,"minimum",void 0),L([sf.base.Property(null)],i.prototype,"maximum",void 0),L([sf.base.Property(null)],i.prototype,"interval",void 0),L([sf.base.Property(34)],i.prototype,"maximumLabelWidth",void 0),L([sf.base.Property(!1)],i.prototype,"enableTrim",void 0),L([sf.base.Property(5)],i.prototype,"labelPadding",void 0),L([sf.base.Property(5)],i.prototype,"titlePadding",void 0),L([sf.base.Complex({},z)],i.prototype,"majorTickLines",void 0),L([sf.base.Complex({},k)],i.prototype,"minorTickLines",void 0),L([sf.base.Complex({},F)],i.prototype,"majorGridLines",void 0),L([sf.base.Complex({},D)],i.prototype,"minorGridLines",void 0),L([sf.base.Complex({},E)],i.prototype,"lineStyle",void 0),L([sf.base.Property("Trim")],i.prototype,"labelIntersectAction",void 0),L([sf.base.Property(!1)],i.prototype,"isInversed",void 0),L([sf.base.Property(100)],i.prototype,"coefficient",void 0),L([sf.base.Property(0)],i.prototype,"startAngle",void 0),L([sf.base.Property(!0)],i.prototype,"startFromZero",void 0),L([sf.base.Property(null)],i.prototype,"description",void 0),L([sf.base.Property(2)],i.prototype,"tabIndex",void 0),L([sf.base.Collection([],C)],i.prototype,"stripLines",void 0),L([sf.base.Collection([],O)],i.prototype,"multiLevelLabels",void 0),L([sf.base.Complex({color:null,width:0,type:"Rectangle"},I)],i.prototype,"border",void 0),L([sf.base.Complex({},P)],i.prototype,"scrollbarSettings",void 0)}(sf.base.ChildProperty),function(e,t,i,r,n,o,s){void 0===n&&(n=new sf.svgbase.Size(0,0)),void 0===o&&(o=new sf.svgbase.Size(0,0)),void 0===s&&(s=1),this.text=e,this.originalText=r,this.value=t,this.labelStyle=i,this.size=n,this.breakLabelSize=o,this.index=s}),j=(s=function(e,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}s(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});function U(e){return-1!==e.indexOf("<br>")}function H(e){if(!e)return null;var t="string"==typeof e?re(e):e;t&&sf.base.remove(t)}function B(e,t){return Math.log(e)/Math.log(t)}function _(e,t,i,r,n,o,s,a){var l=document.getElementById(n),h=sf.svgbase.measureText(e,{fontFamily:"Segoe UI",size:"12px",fontStyle:"Normal",fontWeight:"Regular"}),d=h.width+5;(t=t+d>r?t-(d+15):t,i=a?i-h.height/2:i+15,l)?(l.innerHTML=e,l.style.top=i.toString()+"px",l.style.left=(t+15).toString()+"px"):(l=sf.base.createElement("div",{innerHTML:e,id:n,styles:"top:"+i.toString()+"px;left:"+(t+15).toString()+'px;background-color: rgb(255, 255, 255) !important; color:black !important; position:absolute;border:1px solid rgb(112, 112, 112); padding-left : 3px; padding-right : 2px;padding-bottom : 2px; padding-top : 2px; font-size:12px; font-family: "Segoe UI"'}),o.appendChild(l),parseInt(l.style.left.replace("px",""),10)<0&&(l.style.left="0px"));s&&setTimeout((function(){H(n)}),1500)}function V(e,t){return e<=t.max&&e>=t.min}function Y(e,t){return e.x+=t.left,e.y+=t.top,e.width-=t.left+t.right,e.height-=t.top+t.bottom,e}function Q(e,t,i){var r=e*Math.PI/180;return new Se(Math.cos(r)*t+i.x,Math.sin(r)*t+i.y)}function q(e,t){var i=t.visibleRange,r=(e-i.min)/i.delta;return t.isInversed?1-r:r}function G(e,t){void 0===t&&(t=!1);var i=["NaN","NaN"];return e.indexOf("_Point_")>-1?i=e.split("_Series_")[1].split("_Point_"):e.indexOf("_shape_")>-1&&(!t||t&&-1===e.indexOf("_legend_"))?(i=e.split("_shape_"))[0]="0":e.indexOf("_text_")>-1&&(!t||t&&-1===e.indexOf("_legend_"))&&((i=e.split("_text_"))[0]="0"),new m(parseInt(i[0],10),parseInt(i[1],10))}function X(e,t,i,r,n){return void 0===r&&(r=0),void 0===n&&(n=0),e>=i.x-r&&e<=i.x+i.width+r&&t>=i.y-n&&t<=i.y+i.height+n}function Z(e){return e.substr(0,1).toLowerCase()+e.substr(1)}function K(e,t){for(var i,r,n,o=Number.MAX_VALUE,s=0;s<t.length;s++){var a=t[s];if(i=[],a.visible&&(e.name===a.xAxisName||"primaryXAxis"===e.name&&null===a.xAxisName||e.name===a.chart.primaryXAxis.name&&!a.xAxisName))if((i=a.points.map((function(e){return e.xValue}))).sort((function(e,t){return e-t})),1===i.length)n="DateTime"===e.valueType&&a.xMin===a.xMax?a.xMin-2592e6:a.xMin,0!==(r=i[0]-(sf.base.isNullOrUndefined(n)?e.visibleRange.min:n))&&(o=Math.min(o,r));else for(var l=0;l<i.length;l++){var h=i[l];l>0&&h&&0!==(r=h-i[l-1])&&(o=Math.min(o,r))}}return o===Number.MAX_VALUE&&(o=1),o}function J(e,t,i,r){return-i*Math.cos(e/r*(Math.PI/2))+i+t}function $(e,t,i,r,n){var o={cancel:!1,name:"axisLabelRender",axis:n,text:i,value:t,labelStyle:r};if(e.trigger("axisLabelRender",o),!o.cancel){var s=-1!==o.text.indexOf("<br>"),a=n.enableTrim?s?function(e,t,i){for(var r=[],n=t.split("<br>"),o=0;o<n.length;o++){t=n[o];var s=sf.svgbase.measureText(t,i).width;if(s>e){for(var a=t.length-1;a>=0;--a)if(t=t.substring(0,a)+"...",(s=sf.svgbase.measureText(t,i).width)<=e){r.push(t);break}}else r.push(t)}return r}(n.maximumLabelWidth,o.text,n.labelStyle):ue(n.maximumLabelWidth,o.text,n.labelStyle):o.text;n.visibleLabels.push(new R(a,o.value,o.labelStyle,o.text))}}function ee(e){return null!=e.minimum&&null!=e.maximum}function te(e,t,i,r,n){new sf.base.Animation({}).animate(e,{duration:i,delay:t,name:r,progress:function(e){e.element.style.visibility="visible"},end:function(e){n?sf.base.remove(e.element):e.element.style.visibility="visible"}})}function ie(e,t,i,r,n,o,s,a,l,h){var d=s||new sf.svgbase.SvgRenderer(""),c=function(e,t,i,r,n,o,s){var a,l,h,d="Path",c=o,p=c&&"Circle"===i?t.width-2:t.width,u=c&&"Circle"===i?t.height-2:t.height,g=c?s.targetWidth:0,f=e.x,m=e.y,y=e.y+-u/2,v=e.x+-p/2;switch(i){case"Bubble":case"Circle":d="Ellipse",sf.base.merge(r,{rx:p/2,ry:u/2,cx:f,cy:m});break;case"Cross":a="M "+v+" "+m+" L "+(f+p/2)+" "+m+" M "+f+" "+(m+u/2)+" L "+f+" "+(m+-u/2),sf.base.merge(r,{d:a,stroke:r.fill});break;case"Multiply":a="M "+(f-g)+" "+(m-g)+" L "+(f+g)+" "+(m+g)+" M "+(f-g)+" "+(m+g)+" L "+(f+g)+" "+(m-g),sf.base.merge(r,{d:a,stroke:r.fill});break;case"HorizontalLine":a="M "+v+" "+m+" L "+(f+p/2)+" "+m,sf.base.merge(r,{d:a});break;case"VerticalLine":a="M "+f+" "+(m+u/2)+" L "+f+" "+(m+-u/2),sf.base.merge(r,{d:a});break;case"Diamond":a="M "+v+" "+m+" L "+f+" "+(m+-u/2)+" L "+(f+p/2)+" "+m+" L "+f+" "+(m+u/2)+" L "+v+" "+m+" z",sf.base.merge(r,{d:a});break;case"ActualRect":a="M "+v+" "+(m+-u/8)+" L "+(f+g)+" "+(m+-u/8)+" L "+(f+g)+" "+(m+u/8)+" L "+v+" "+(m+u/8)+" L "+v+" "+(m+-u/8)+" z",sf.base.merge(r,{d:a});break;case"TargetRect":a="M "+(v+g)+" "+(m+-u/2)+" L "+(f+g/2)+" "+(m+-u/2)+" L "+(f+g/2)+" "+(m+u/2)+" L "+(v+g)+" "+(m+u/2)+" L "+(v+g)+" "+(m+-u/2)+" z",sf.base.merge(r,{d:a});break;case"Rectangle":case"Hilo":case"HiloOpenClose":case"Candle":case"Waterfall":case"BoxAndWhisker":case"StepArea":case"StackingStepArea":case"Square":case"Flag":a="M "+v+" "+(m+-u/2)+" L "+(f+p/2)+" "+(m+-u/2)+" L "+(f+p/2)+" "+(m+u/2)+" L "+v+" "+(m+u/2)+" L "+v+" "+(m+-u/2)+" z",sf.base.merge(r,{d:a});break;case"Pyramid":case"Triangle":a="M "+v+" "+(m+u/2)+" L "+f+" "+(m+-u/2)+" L "+(f+p/2)+" "+(m+u/2)+" L "+v+" "+(m+u/2)+" z",sf.base.merge(r,{d:a});break;case"Funnel":case"InvertedTriangle":a="M "+(f+p/2)+" "+(m-u/2)+" L "+f+" "+(m+u/2)+" L "+(f-p/2)+" "+(m-u/2)+" L "+(f+p/2)+" "+(m-u/2)+" z",sf.base.merge(r,{d:a});break;case"Pentagon":for(var b=0;b<=5;b++)l=p/2*Math.cos(Math.PI/180*(72*b)),h=u/2*Math.sin(Math.PI/180*(72*b)),a=0===b?"M "+(f+l)+" "+(m+h)+" ":a.concat("L "+(f+l)+" "+(m+h)+" ");a=a.concat("Z"),sf.base.merge(r,{d:a});break;case"Image":d="Image",sf.base.merge(r,{href:n,height:u,width:p,x:v,y:y})}return{renderOption:r=function(e,t,i,r){var n="",o=t.height,s=t.width,a=e.x,l=e.y;switch(i){case"MultiColoredLine":case"Line":case"StackingLine":case"StackingLine100":n="M "+(a+-s/2)+" "+l+" L "+(a+s/2)+" "+l,sf.base.merge(r,{d:n});break;case"StepLine":r.fill="transparent",n="M "+(a+-s/2-2.5)+" "+(l+o/2)+" L "+(a+-s/2+s/10)+" "+(l+o/2)+" L "+(a+-s/2+s/10)+" "+l+" L "+(a+-s/10)+" "+l+" L "+(a+-s/10)+" "+(l+o/2)+" L "+(a+s/5)+" "+(l+o/2)+" L "+(a+s/5)+" "+(l+-o/2)+" L "+(a+s/2)+" "+(l+-o/2)+"L "+(a+s/2)+" "+(l+o/2)+" L"+(a+s/2+2.5)+" "+(l+o/2),sf.base.merge(r,{d:n});break;case"UpArrow":r.fill=r.stroke,r.stroke="transparent",n="M "+(a+-s/2)+" "+(l+o/2)+" L "+a+" "+(l-o/2)+" L "+(a+s/2)+" "+(l+o/2)+"L "+(a+s/2-2)+" "+(l+o/2)+" L "+a+" "+(l-o/2+4)+"L"+(a-s/2+2)+" "+(l+o/2)+" Z",sf.base.merge(r,{d:n});break;case"DownArrow":n="M "+(a-s/2)+" "+(l-o/2)+" L "+a+" "+(l+o/2)+" L "+(a+s/2)+" "+(l-o/2)+"L "+(a+s/2-2)+" "+(l-o/2)+" L "+a+" "+(l+o/2-4)+"L"+(a-s/2+2)+" "+(l-o/2)+" Z",sf.base.merge(r,{d:n});break;case"RightArrow":n="M "+(a+-s/2)+" "+(l-o/2)+" L "+(a+s/2)+" "+l+" L "+(a+-s/2)+" "+(l+o/2)+" L "+(a+-s/2)+" "+(l+o/2-2)+" L "+(a+s/2-4)+" "+l+" L"+(a+-s/2)+" "+(l-o/2+2)+" Z",sf.base.merge(r,{d:n});break;case"LeftArrow":r.fill=r.stroke,r.stroke="transparent",n="M "+(a+s/2)+" "+(l-o/2)+" L "+(a+-s/2)+" "+l+" L "+(a+s/2)+" "+(l+o/2)+" L "+(a+s/2)+" "+(l+o/2-2)+" L "+(a+-s/2+4)+" "+l+" L"+(a+s/2)+" "+(l-o/2+2)+" Z",sf.base.merge(r,{d:n});break;case"Column":case"Pareto":case"StackingColumn":case"StackingColumn100":case"RangeColumn":case"Histogram":n="M "+(a-s/5*3)+" "+(l-o/5)+" L "+(a+-s/10*3)+" "+(l-o/5)+" L "+(a+-s/10*3)+" "+(l+o/2)+" L "+(a-s/5*3)+" "+(l+o/2)+" Z M "+(a+-s/10-s/20)+" "+(l-o/4-5)+" L "+(a+s/10+s/20)+" "+(l-o/4-5)+" L "+(a+s/10+s/20)+" "+(l+o/2)+" L "+(a+-s/10-s/20)+" "+(l+o/2)+" Z M "+(a+s/10*3)+" "+l+" L "+(a+s/5*3)+" "+l+" L "+(a+s/5*3)+" "+(l+o/2)+" L "+(a+s/10*3)+" "+(l+o/2)+" Z",sf.base.merge(r,{d:n});break;case"Bar":case"StackingBar":case"StackingBar100":n="M "+(a+-s/2+-2.5)+" "+(l-o/5*3)+" L "+(a+s/10*3)+" "+(l-o/5*3)+" L "+(a+s/10*3)+" "+(l-o/10*3)+" L "+(a-s/2-2.5)+" "+(l-o/10*3)+" Z M "+(a+-s/2+-2.5)+" "+(l-o/5+.5)+" L "+(a+s/2+2.5)+" "+(l-o/5+.5)+" L "+(a+s/2+2.5)+" "+(l+o/10+.5)+" L "+(a-s/2-2.5)+" "+(l+o/10+.5)+" Z M "+(a-s/2-2.5)+" "+(l+o/5+1)+" L "+(a+-s/4)+" "+(l+o/5+1)+" L "+(a+-s/4)+" "+(l+o/2+1)+" L "+(a-s/2-2.5)+" "+(l+o/2+1)+" Z",sf.base.merge(r,{d:n});break;case"Spline":r.fill="transparent",n="M "+(a-s/2)+" "+(l+o/5)+" Q "+a+" "+(l-o)+" "+a+" "+(l+o/5)+" M "+a+" "+(l+o/5)+" Q "+(a+s/2)+" "+(l+o/2)+" "+(a+s/2)+" "+(l-o/2),sf.base.merge(r,{d:n});break;case"Area":case"MultiColoredArea":case"RangeArea":case"StackingArea":case"StackingArea100":n="M "+(a-s/2-2.5)+" "+(l+o/2)+" L "+(a+-s/4+-1.25)+" "+(l-o/2)+" L "+a+" "+(l+o/4)+" L "+(a+s/4+1.25)+" "+(l+-o/2+o/4)+" L "+(a+o/2+2.5)+" "+(l+o/2)+" Z",sf.base.merge(r,{d:n});break;case"SplineArea":case"SplineRangeArea":n="M "+(a-s/2)+" "+(l+o/5)+" Q "+a+" "+(l-o)+" "+a+" "+(l+o/5)+" Z M "+a+" "+(l+o/5)+" Q "+(a+s/2)+" "+(l+o/2)+" "+(a+s/2)+" "+(l-o/2)+"  Z",sf.base.merge(r,{d:n});break;case"Pie":case"Doughnut":r.stroke="transparent";var h=Math.min(o,s)/2;n=function(e,t,i,r,n,o){var s=Q(270,i,new Se(e,t)),a=Q(270,i,new Se(e+n/10,t));return"M "+e+" "+t+" L "+(e+i)+" "+t+" A "+i+" "+i+" 0 1 1 "+s.x+" "+s.y+" Z M "+(e+n/10)+" "+(t-r/10)+" L"+(e+i)+" "+(t-r/10)+" A "+i+" "+i+" 0 0 0 "+a.x+" "+a.y+" Z"}(a,l,h,o,s),sf.base.merge(r,{d:n})}return{renderOption:r}}(e,new sf.svgbase.Size(p,u),i,r).renderOption,functionName:d}}(e,i,t,n,r,l,h);return d["draw"+c.functionName](c.renderOption,a?new Int32Array([a.x,a.y]):null)}function re(e){return document.getElementById(e)}function ne(e,t,i,r,n,o,s,a,l,h){var d=e.getBoundingClientRect();t.accumulationDataLabelModule.calculateLabelSize(i,e,o,r,n,s,a,l,h,d,!0)}function oe(e,t,i,r,n,o){var s=document.getElementById(t.element.id+"_Series_"+(void 0===r.index?r.category:r.index)+"_DataLabelCollections");s&&(0===i.index&&(t.dataLabelCollections=[]),t.dataLabelModule.calculateTemplateLabelSize(s,e,i,r,r.marker.dataLabel,n,r.clipRect,o,!0))}function se(e,t,i,r,n,o,s,a,l,h,d,c,p,u,g){var f,m=function(e){var t=null;try{document.querySelectorAll(e).length&&(t=sf.base.compile(document.querySelector(e).innerHTML.trim()))}catch(i){t=sf.base.compile(e)}return t}(i);try{var y=window.Blazor?s?n:{point:n}:{chart:r,series:o,point:n},v=m?m(y,r,s?s+"_template":"template",s||e.id.replace(/[^a-zA-Z0-9]/g,"")):[];if(v.length)for(var b=(f=Array.prototype.slice.call(v)).length,w=0;w<b;w++)e.appendChild(f[w]);var x=void 0;"accumulationchart"===r.getModuleName()?(x=ne.bind(this,e,r,h,d,l,d[t],c,p,u,g),r.isReact&&r.renderReactTemplates(x)):"chart"===r.getModuleName()&&(x=n&&o?oe.bind(this,e,r,n,o,a,g):x,r.isReact&&r.renderReactTemplates(x))}catch(t){return e}return e}function ae(e,t,i){void 0===t&&(t=!1),i||document.body.appendChild(e);var r=e.getBoundingClientRect();return t?sf.base.remove(e):i||H(e.id),r}function le(e,t,i,r,n,o){if(void 0===i&&(i=!1),void 0===r&&(r=!1),void 0===n&&(n="x"),void 0===o&&(o="y"),!(e&&e.hasChildNodes()&&t))return null;he(!1,t,e,i,r,n,o)}function he(e,t,i,r,n,o,s,a,l,h,d,c,p){if(void 0===n&&(n=!1),void 0===o&&(o="x"),void 0===s&&(s="y"),void 0===h&&(h=!1),void 0===d&&(d=!1),void 0===c&&(c=null),e)return null;var u=t.querySelector("#"+i.id),g=u||re(i.id),f=i,m=p||300;if(r&&n&&g)if(a=a||("DIV"===g.tagName?new Se(+g.style[o].split("px")[0],+g.style[s].split("px")[0]):new Se(+g.getAttribute(o),+g.getAttribute(s))),l&&"undefined"!==l)!function(e,t,i,r,n){if(!i||!r&&!e)return null;var o=300;n&&(o=n);var s,a,l,h=r||e.getAttribute("d"),d=h.split(/(?=[LMCZAQ])/),c=t.split(/(?=[LMCZAQ])/),p=[],u=[];e.setAttribute("d",h),new sf.base.Animation({}).animate(sf.base.createElement("div"),{duration:o,progress:function(t){s="",d.map((function(e,i){if(p=e.split(" "),u=c[i]?c[i].split(" "):p,"Z"===p[0]?s+="Z ":s+=p[0]+" "+J(t.timeStamp,+p[1],+u[1]-+p[1],t.duration)+" "+J(t.timeStamp,+p[2],+u[2]-+p[2],t.duration)+" ","C"===p[0]||"Q"===p[0])for(a=3,l="Q"===p[0]?4:6;a<l;)s+=J(t.timeStamp,+p[a],+u[a]-+p[a],t.duration)+" "+J(t.timeStamp,+p[++a],+u[a]-+p[a],t.duration)+" ",++a;"A"===p[0]&&(s+="0 0 1 "+J(t.timeStamp,+p[6],+u[6]-+p[6],t.duration)+" "+J(t.timeStamp,+p[7],+u[7]-+p[7],t.duration)+" ")})),e.setAttribute("d",s)},end:function(){e.setAttribute("d",t)}})}(i,i.getAttribute("d"),r,l,m);else if(d&&c)!function(e,t,i,r,n){var o=function(t){e.setAttribute("x",t.x+""),e.setAttribute("y",t.y+""),e.setAttribute("width",t.width+""),e.setAttribute("height",t.height+"")};new sf.base.Animation({}).animate(sf.base.createElement("div"),{duration:i,delay:t,progress:function(e){o(new sf.svgbase.Rect(J(e.timeStamp,n.x,r.x-n.x,e.duration),J(e.timeStamp,n.y,r.y-n.y,e.duration),J(e.timeStamp,n.width,r.width-n.width,e.duration),J(e.timeStamp,n.height,r.height-n.height,e.duration)))},end:function(){o(r)}})}(f,0,m,new sf.svgbase.Rect(+g.getAttribute("x"),+g.getAttribute("y"),+g.getAttribute("width"),+g.getAttribute("height")),c);else{var y="DIV"===f.tagName?new Se(+f.style[o].split("px")[0],+f.style[s].split("px")[0]):new Se(+f.getAttribute(o),+f.getAttribute(s));!function(e,t,i,r,n,o){void 0===n&&(n="x");void 0===o&&(o="y");var s="DIV"===e.tagName,a=function(t,i){s?(e.style[n]=t+"px",e.style[o]=i+"px"):(e.setAttribute(n,t+""),e.setAttribute(o,i+""))};a(i.x,i.y),new sf.base.Animation({}).animate(sf.base.createElement("div"),{duration:t,progress:function(e){a(J(e.timeStamp,i.x,r.x-i.x,e.duration),J(e.timeStamp,i.y,r.y-i.y,e.duration))},end:function(){a(r.x,r.y)}})}(f,m,a,y,o,s)}else r&&n&&!g&&h&&te(f,0,600,"FadeIn");u?t.replaceChild(f,g):t.appendChild(f)}function de(e,t){return e.x<t.x+t.width&&e.x+e.width>t.x&&e.y<t.y+t.height&&e.height+e.y>t.y}function ce(e){var t=e.toString(16);return 1===t.length?"0"+t:t}function pe(e){e="transparent"===e?"white":e,document.body.appendChild(sf.base.createElement("text",{id:"chartmeasuretext"}));var t=document.getElementById("chartmeasuretext");t.style.color=e,e=window.getComputedStyle(t).color,sf.base.remove(t);var i,r=/^(rgb|hsl)(a?)[(]\s*([\d.]+\s*%?)\s*,\s*([\d.]+\s*%?)\s*,\s*([\d.]+\s*%?)\s*(?:,\s*([\d.]+)\s*)?[)]$/.exec(e);return"#"+ce((i=new Oe(parseInt(r[3],10),parseInt(r[4],10),parseInt(r[5],10))).r)+ce(i.g)+ce(i.b)}function ue(e,t,i){var r=t,n=sf.svgbase.measureText(t,i).width;if(n>e)for(var o=t.length-1;o>=0;--o)if(r=t.substring(0,o)+"...",(n=sf.svgbase.measureText(r,i).width)<=e)return r;return r}function ge(e,t){return null!=e?-1!==e.indexOf("%")?t/100*parseInt(e,10):parseInt(e,10):null}function fe(e,t,i,r){if(!e)return null;var n=re(t);return n&&i&&r.setElementAttributes(i,"clipPath"===n.tagName?n.childNodes[0]:n),n}function me(e,t,i,r,n,o,s,a,l,h,d,c,p,u){void 0===o&&(o=!1),void 0===l&&(l=!1);var g,f,m,y,v;g={id:t.id,x:t.x,y:t.y,fill:r||"black","font-size":i.size,"font-style":i.fontStyle,"font-family":i.fontFamily,"font-weight":i.fontWeight,"text-anchor":t.anchor,labelRotation:t.labelRotation,transform:t.transform,opacity:i.opacity,"dominant-baseline":t.baseLine};var b="string"==typeof t.text?t.text:o?t.text[t.text.length-1]:t.text[0],w=d?d.x:0,x=d?d.y:0,M=e.createText(g,b,w,x);if(M.style.fontFamily=i.fontFamily,M.style.fontStyle=i.fontStyle,M.style.fontSize=i.size,M.style.fontWeight=i.fontWeight,M.style.color=i.color,M.style.textAnchor=t.anchor,"string"!=typeof t.text&&t.text.length>1)for(var N=1,I=t.text.length;N<I;N++)m=sf.svgbase.measureText(t.text[N],i).height,y=t.y+(o?-N*m:N*m),v=o?t.text[t.text.length-(N+1)]:t.text[N],u?f=e.createText(g,v,null,null,y,!0):(f=e.createTSpan({x:t.x,id:t.id,y:y},v),M.appendChild(f));return p||he(e instanceof sf.svgbase.CanvasRenderer,n,M,s,a,"x","y",null,null,l,!1,null,h),M}function ye(e){var t=e.element.clientWidth||e.element.offsetWidth,i=e.element.clientHeight;e.stockChart&&(t=e.stockChart.availableSize.width,i=e.stockChart.availableSize.height);var r,n=450;if("rangeNavigator"===e.getModuleName()){var o=e,s=o.tooltip.enable?35:0,a=o.periodSelectorSettings.periods.length?o.periodSelectorSettings.height:0;r=o.margin.top+o.margin.bottom+s;var l=sf.svgbase.measureText("tempString",o.labelStyle).height;n=(e.series.length?sf.base.Browser.isDevice?80:120:(o.enableGrouping?55+l:40)+r)+a,o.disableRangeSelector&&(n=a)}e.availableSize=new sf.svgbase.Size(ge(e.width,t)||t||600,ge(e.height,i||n)||i||n)}function ve(e,t,i){var r=[];switch(t.textOverflow){case"Wrap":r=we(e,i,t);break;case"Trim":r.push(ue(i,e,t));break;default:r.push(e)}return r}function be(e,t){return"Near"===t.textAlignment?e.x:"Center"===t.textAlignment?e.x+e.width/2:e.x+e.width}function we(e,t,i){for(var r,n=e.split(" "),o="",s=[],a=0,l=n.length;a<l;a++)r=n[a],sf.svgbase.measureText(o.concat(r),i).width<t?o=o.concat((""===o?"":" ")+r):""!==o?(s.push(ue(t,o,i)),o=r):(s.push(ue(t,r,i)),r=""),o&&a===l-1&&s.push(ue(t,o,i));return s}function xe(e){for(var t=0;t<e.annotations.length;t++)sf.base.resetBlazorTemplate((e.element.id+"_Annotation_"+t).replace(/[^a-zA-Z0-9]/g,""),"ContentTemplate");sf.base.resetBlazorTemplate(e.element.id+"_tooltipparent_template_blazorTemplate","Template"),sf.base.resetBlazorTemplate(e.element.id+"_DataLabel")}var Me,Ne=function(e){function t(t,i,r,n,o,s,a,l,h){var d=e.call(this,t,i,r.width,r.color,n,h)||this;return d.y=o.y,d.x=o.x,d.height=o.height,d.width=o.width,d.rx=s||0,d.ry=a||0,d.transform=l||"",d.stroke=0!==r.width&&""!==d.stroke?r.color:"transparent",d}return j(t,e),t}(sf.svgbase.PathOption),Ie=function(e,t,i,r,n,o,s,a){this.height=e,this.width=t,this.href=i,this.x=r,this.y=n,this.id=o,this.visibility=s,this.preserveAspectRatio=a},Se=(function(e){function t(t,i,r,n,o,s,a){var l=e.call(this,t,i,r.width,r.color,n)||this;return l.cy=s,l.cx=o,l.r=a,l}j(t,e)}(sf.svgbase.PathOption),function(e,t){this.x=e,this.y=t}),Ce=function(e,t,i,r){this.left=e,this.right=t,this.top=i,this.bottom=r},Oe=function(e,t,i){this.r=e,this.g=t,this.b=i},Te=function(e,t,i){void 0===i&&(i=0),this.point=e,this.series=t,this.lierIndex=i},Pe=function(e,t,i){void 0===i&&(i=0),this.point=e,this.series=t,this.index=i},Ae=(Me=function(e,t){return(Me=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}Me(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),Le=function(e,t,r,n){var o,s=arguments.length,a=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(s<3?o(a):s>3?o(t,r,a):o(t,r))||a);return s>3&&a&&Object.defineProperty(t,r,a),a},Fe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Ae(t,e),Le([sf.base.Property(null)],t.prototype,"content",void 0),Le([sf.base.Property("0")],t.prototype,"x",void 0),Le([sf.base.Property("0")],t.prototype,"y",void 0),Le([sf.base.Property("Pixel")],t.prototype,"coordinateUnits",void 0),Le([sf.base.Property("Chart")],t.prototype,"region",void 0),Le([sf.base.Property("Middle")],t.prototype,"verticalAlignment",void 0),Le([sf.base.Property("Center")],t.prototype,"horizontalAlignment",void 0),Le([sf.base.Property(null)],t.prototype,"description",void 0),t}(sf.base.ChildProperty),De=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Ae(t,e),Le([sf.base.Property(!1)],t.prototype,"visible",void 0),Le([sf.base.Property(!0)],t.prototype,"showZero",void 0),Le([sf.base.Property(null)],t.prototype,"name",void 0),Le([sf.base.Property("transparent")],t.prototype,"fill",void 0),Le([sf.base.Property("Inside")],t.prototype,"position",void 0),Le([sf.base.Property(5)],t.prototype,"rx",void 0),Le([sf.base.Property(5)],t.prototype,"ry",void 0),Le([sf.base.Property(0)],t.prototype,"angle",void 0),Le([sf.base.Property(!1)],t.prototype,"enableRotation",void 0),Le([sf.base.Complex({width:null,color:null},c)],t.prototype,"border",void 0),Le([sf.base.Complex({size:"11px",color:"",fontStyle:"Normal",fontWeight:"Normal",fontFamily:"Segoe UI"},d)],t.prototype,"font",void 0),Le([sf.base.Complex({},h)],t.prototype,"connectorStyle",void 0),Le([sf.base.Property(null)],t.prototype,"template",void 0),t}(sf.base.ChildProperty),Ee=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Ae(t,e),Le([sf.base.Property("50%")],t.prototype,"x",void 0),Le([sf.base.Property("50%")],t.prototype,"y",void 0),t}(sf.base.ChildProperty),ze=function(){this.visible=!0,this.symbolLocation=null,this.region=null,this.labelRegion=null,this.labelVisible=!0,this.regions=null,this.isExplode=!1,this.isClubbed=!1,this.isSliced=!1,this.argsData=null,this.isLabelUpdated=null,this.initialLabelRegion=null},ke=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.points=[],t.clubbedPoints=[],t.sumOfPoints=0,t.isRectSeries=!0,t.clipRect=new sf.svgbase.Rect(0,0,0,0),t.category="Series",t.rightSidePoints=[],t.leftSidePoints=[],t}return Ae(t,e),t.prototype.refreshDataManager=function(e,t){var i=this,r=this.dataSource||e.dataSource;r instanceof sf.data.DataManager||!sf.base.isNullOrUndefined(this.query)?this.dataModule.getData(this.dataModule.generateQuery().requiresCount()).then((function(t){return i.dataManagerSuccess(t,e)})):this.dataManagerSuccess({result:r,count:r.length},e,t)},t.prototype.dataManagerSuccess=function(e,t,i){void 0===i&&(i=!0);var r={name:"seriesRender",series:this,data:e.result};t.allowServerDataBinding=!1,t.trigger("seriesRender",r),this.resultData=""!==e.result?e.result:[],t.isBlazor||i||this.getPoints(this.resultData,t),(++t.seriesCounts===t.visibleSeries.length&&i||window.Blazor&&!i&&1===t.seriesCounts)&&(this.getPoints(this.resultData,t),t.refreshChart())},t.prototype.getPoints=function(e,t){var i,r=Object.keys(e).length;if(this.sumOfPoints=0,0===r)return null;this.findSumOfPoints(e),this.points=[],this.clubbedPoints=[],this.sumOfClub=0;for(var n=this.palettes.length?this.palettes:function(e){var t;switch(e){case"Fabric":t=["#4472c4","#ed7d31","#ffc000","#70ad47","#5b9bd5","#c1c1c1","#6f6fe2","#e269ae","#9e480e","#997300"];break;case"Bootstrap4":case"Bootstrap":t=["#a16ee5","#f7ce69","#55a5c2","#7ddf1e","#ff6ea6","#7953ac","#b99b4f","#407c92","#5ea716","#b91c52"];break;case"HighContrastLight":case"Highcontrast":case"HighContrast":t=["#79ECE4","#E98272","#DFE6B6","#C6E773","#BA98FF","#FA83C3","#00C27A","#43ACEF","#D681EF","#D8BC6E"];break;case"MaterialDark":t=["#9ECB08","#56AEFF","#C57AFF","#61EAA9","#EBBB3E","#F45C5C","#8A77FF","#63C7FF","#FF84B0","#F7C928"];break;case"FabricDark":t=["#4472c4","#ed7d31","#ffc000","#70ad47","#5b9bd5","#c1c1c1","#6f6fe2","#e269ae","#9e480e","#997300"];break;case"BootstrapDark":t=["#a16ee5","#f7ce69","#55a5c2","#7ddf1e","#ff6ea6","#7953ac","#b99b4f","#407c92","#5ea716","#b91c52"];break;case"Tailwind":t=["#5A61F6","#65A30D","#334155","#14B8A6","#8B5CF6","#0369A1","#F97316","#9333EA","#F59E0B","#15803D"];break;case"TailwindDark":t=["#8B5CF6","#22D3EE","#F87171","#4ADE80","#E879F9","#FCD34D","#F97316","#2DD4BF","#F472B6","#10B981"];break;case"Bootstrap5":t=["#262E0B","#668E1F","#AF6E10","#862C0B","#1F2D50","#64680B","#311508","#4C4C81","#0C7DA0","#862C0B"];break;case"Bootstrap5Dark":t=["#5ECB9B","#A860F1","#EBA844","#557EF7","#E9599B","#BFC529","#3BC6CF","#7A68EC","#74B706","#EA6266"];break;case"FluentDark":t=["#8AB113","#2A72D5","#43B786","#584EC6","#E85F9C","#6E7A89","#EA6266","#EBA844","#26BC7A","#BC4870"];break;case"Fluent":t=["#614570","#4C6FB1","#CC6952","#3F579A","#4EA09B","#6E7A89","#D4515C","#E6AF5D","#639751","#9D4D69"];break;default:t=["#00bdae","#404041","#357cd2","#e56590","#f8b883","#70ad47","#dd8abd","#7f84e8","#7bb4eb","#ea7a57"]}return t}(t.theme),o=ge(this.groupTo,this.sumOfPoints),s=0;s<r;s++){(i=this.setPoints(e,s,n,t)).y;this.isClub(i,o,s)?(i.index=this.clubbedPoints.length,i.isExplode=!0,this.clubbedPoints.push(i),i.isSliced=!0):(sf.base.isNullOrUndefined(i.y)&&(i.visible=!1),this.pushPoints(i,n))}if(this.lastGroupTo=this.groupTo,this.sumOfClub>0){var a=this.generateClubPoint();this.pushPoints(a,n);var l=this.points.length-1;this.clubbedPoints.map((function(e){e.index+=l,e.color=a.color}))}this.clubbedPoints.length&&this.explode&&"Pie"===this.type&&(this.explodeAll||this.points[this.points.length-1].index===this.explodeIndex)&&(this.points.splice(this.points.length-1,1),this.points=this.points.concat(this.clubbedPoints))},t.prototype.generateClubPoint=function(){var e=new ze;return e.isClubbed=!0,e.x="Others",e.y=this.sumOfClub,e.text=e.originalText=e.x+": "+this.sumOfClub,e.sliceRadius="80%",e},t.prototype.pushPoints=function(e,t){e.index=this.points.length,e.isExplode=this.explodeAll||e.index===this.explodeIndex,e.color=e.color||t[e.index%t.length],this.points.push(e)},t.prototype.isClub=function(e,t,i){if(!sf.base.isNullOrUndefined(t)){if("Value"===this.groupMode&&Math.abs(e.y)<=t)return this.sumOfClub+=Math.abs(e.y),!0;if("Point"===this.groupMode&&i>=t)return this.sumOfClub+=Math.abs(e.y),!0}return!1},t.prototype.findSumOfPoints=function(e){for(var t=Object.keys(e).length,i=0;i<t;i++)sf.base.isNullOrUndefined(e[i])||sf.base.isNullOrUndefined(e[i][this.yName])||isNaN(e[i][this.yName])||(this.sumOfPoints+=Math.abs(e[i][this.yName]))},t.prototype.setPoints=function(e,t,i,r){var n=new ze;return n.x=sf.base.getValue(this.xName,e[t]),n.y=sf.base.getValue(this.yName,e[t]),n.percentage=+(n.y/this.sumOfPoints*100).toFixed(2),n.legendImageUrl=sf.base.getValue(this.legendImageUrl,e[t]),n.color=sf.base.getValue(this.pointColorMapping,e[t]),n.text=n.originalText=sf.base.getValue(this.dataLabel.name||"",e[t]),n.tooltip=sf.base.getValue(this.tooltipMappingName||"",e[t]),n.sliceRadius=sf.base.getValue(this.radius,e[t]),n.sliceRadius=sf.base.isNullOrUndefined(n.sliceRadius)?"80%":n.sliceRadius,n.separatorY=r.intl.formatNumber(n.y,{useGrouping:r.useGroupingSeparator}),this.setAccEmptyPoint(n,t,e,i),n},t.prototype.renderSeries=function(e,t){var i,r=t?re(e.element.id+"_Series_"+this.index):e.renderer.createGroup({id:e.element.id+"_Series_"+this.index});this.renderPoints(e,r,t),e.accumulationDataLabelModule&&this.dataLabel.visible&&((i=e.renderer.createGroup({id:e.element.id+"_datalabel_Series_"+this.index})).style.visibility=this.animation.enable&&e.animateSeries&&"Pie"===this.type?"hidden":"visible",this.renderDataLabel(e,i,t)),"Pie"===this.type&&(this.findMaxBounds(this.labelBound,this.accumulationBound),e.pieSeriesModule.animateSeries(e,this.animation,this,r)),e.accumulationLegendModule&&(this.labelBound.x-=e.explodeDistance,this.labelBound.y-=e.explodeDistance,this.labelBound.height+=e.explodeDistance-this.labelBound.y,this.labelBound.width+=e.explodeDistance-this.labelBound.x)},t.prototype.renderPoints=function(e,t,i){for(var r,n=e.element.id+"_Series_"+this.index+"_Point_",o=0,s=this.points;o<s.length;o++){var a=s[o],l={cancel:!1,name:"pointRender",series:this,point:a,fill:a.color,border:this.isEmpty(a)?{width:this.emptyPointSettings.border.width,color:this.emptyPointSettings.border.color}:{width:this.border.width,color:this.border.color}};e.trigger("pointRender",l),a.color=l.fill,r=new sf.svgbase.PathOption(n+a.index,a.color,l.border.width||1,l.border.color||a.color,this.opacity,"",""),e[Z(this.type)+"SeriesModule"].renderPoint(a,this,e,r,t,i)}he(!1,e.getSeriesElement(),t,i)},t.prototype.renderDataLabel=function(e,t,i){e.accumulationDataLabelModule.findAreaRect();var r=sf.base.createElement("div",{id:e.element.id+"_Series_0_DataLabelCollections"});this.leftSidePoints=[],this.rightSidePoints=[];for(var n=[],o=[],s=0,a=this.points;s<a.length;s++){var l=a[s];l.visible&&(this.dataLabel.showZero||!this.dataLabel.showZero&&(0!==l.y||0===l.y&&"Zero"===this.emptyPointSettings.mode))&&e.accumulationDataLabelModule.renderDataLabel(l,this.dataLabel,t,this.points,this.index,r,i),l.midAngle>=90&&l.midAngle<=270?this.leftSidePoints.push(l):l.midAngle>=0&&l.midAngle<=90?o.push(l):n.push(l)}if(n.sort((function(e,t){return e.midAngle-t.midAngle})),o.sort((function(e,t){return e.midAngle-t.midAngle})),this.leftSidePoints.sort((function(e,t){return e.midAngle-t.midAngle})),this.rightSidePoints=n.concat(o),e.accumulationDataLabelModule.drawDataLabels(this,this.dataLabel,t,r,i),null!==this.dataLabel.template&&r.childElementCount){var h=e.accumulationDataLabelModule.drawDataLabels.bind(e.accumulationDataLabelModule,this,this.dataLabel,t,r,i);e.isReact&&e.renderReactTemplates(h),he(!1,re(e.element.id+"_Secondary_Element"),r,i)}he(!1,e.getSeriesElement(),t,i)},t.prototype.findMaxBounds=function(e,t){e.x=t.x<e.x?t.x:e.x,e.y=t.y<e.y?t.y:e.y,e.height=t.y+t.height>e.height?t.y+t.height:e.height,e.width=t.x+t.width>e.width?t.x+t.width:e.width},t.prototype.setAccEmptyPoint=function(e,t,i,r){if(!sf.base.isNullOrUndefined(e.y)&&!isNaN(e.y))return null;switch(e.color=this.emptyPointSettings.fill||e.color,this.emptyPointSettings.mode){case"Zero":e.y=0,e.visible=!0;break;case"Average":var n=i[t-1]&&i[t-1][this.yName]||0,o=i[t+1]&&i[t+1][this.yName]||0;e.y=(Math.abs(n)+Math.abs(o))/2,this.sumOfPoints+=e.y,e.visible=!0;break;default:e.visible=!1}},t.prototype.isEmpty=function(e){return e.color===this.emptyPointSettings.fill},Le([sf.base.Property("")],t.prototype,"dataSource",void 0),Le([sf.base.Property()],t.prototype,"query",void 0),Le([sf.base.Property("")],t.prototype,"xName",void 0),Le([sf.base.Property("")],t.prototype,"name",void 0),Le([sf.base.Property("")],t.prototype,"tooltipMappingName",void 0),Le([sf.base.Property("")],t.prototype,"yName",void 0),Le([sf.base.Property(!0)],t.prototype,"visible",void 0),Le([sf.base.Complex({color:null,width:0},c)],t.prototype,"border",void 0),Le([sf.base.Complex(null,g)],t.prototype,"animation",void 0),Le([sf.base.Property("SeriesType")],t.prototype,"legendShape",void 0),Le([sf.base.Property("")],t.prototype,"legendImageUrl",void 0),Le([sf.base.Property("")],t.prototype,"pointColorMapping",void 0),Le([sf.base.Property(null)],t.prototype,"selectionStyle",void 0),Le([sf.base.Property(null)],t.prototype,"groupTo",void 0),Le([sf.base.Property("Value")],t.prototype,"groupMode",void 0),Le([sf.base.Complex({},De)],t.prototype,"dataLabel",void 0),Le([sf.base.Property([])],t.prototype,"palettes",void 0),Le([sf.base.Property(0)],t.prototype,"startAngle",void 0),Le([sf.base.Property(null)],t.prototype,"endAngle",void 0),Le([sf.base.Property("80%")],t.prototype,"radius",void 0),Le([sf.base.Property("0")],t.prototype,"innerRadius",void 0),Le([sf.base.Property("Pie")],t.prototype,"type",void 0),Le([sf.base.Property(!0)],t.prototype,"enableTooltip",void 0),Le([sf.base.Property(!1)],t.prototype,"explode",void 0),Le([sf.base.Property("30%")],t.prototype,"explodeOffset",void 0),Le([sf.base.Property(!1)],t.prototype,"explodeAll",void 0),Le([sf.base.Property(null)],t.prototype,"explodeIndex",void 0),Le([sf.base.Complex({mode:"Drop"},y)],t.prototype,"emptyPointSettings",void 0),Le([sf.base.Property(0)],t.prototype,"gapRatio",void 0),Le([sf.base.Property("80%")],t.prototype,"width",void 0),Le([sf.base.Property("80%")],t.prototype,"height",void 0),Le([sf.base.Property("20%")],t.prototype,"neckWidth",void 0),Le([sf.base.Property("20%")],t.prototype,"neckHeight",void 0),Le([sf.base.Property("Linear")],t.prototype,"pyramidMode",void 0),Le([sf.base.Property(1)],t.prototype,"opacity",void 0),t}(sf.base.ChildProperty);function We(e,t){for(var i=0,r=t;i<r.length;i++){var n=r[i];if(e===n.index)return n}return t[0]}function Re(e,t){for(var i=0,r=t;i<r.length;i++){var n=r[i];if(n.index===e)return n}return null}var je,Ue,He,Be,_e,Ve,Ye,Qe,qe,Ge,Xe,Ze,Ke,Je=(je=function(e,t){return(je=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}je(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),$e=function(e,t,r,n){var o,s=arguments.length,a=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(s<3?o(a):s>3?o(t,r,a):o(t,r))||a);return s>3&&a&&Object.defineProperty(t,r,a),a},et=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Je(t,e),$e([sf.base.Property(0)],t.prototype,"x",void 0),$e([sf.base.Property(0)],t.prototype,"y",void 0),t}(sf.base.ChildProperty),tt=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return Je(i,e),$e([sf.base.Property(!0)],i.prototype,"visible",void 0),$e([sf.base.Property(null)],i.prototype,"height",void 0),$e([sf.base.Property(null)],i.prototype,"width",void 0),$e([sf.base.Complex({x:0,y:0},et)],i.prototype,"location",void 0),$e([sf.base.Property("Auto")],i.prototype,"position",void 0),$e([sf.base.Property("Series")],i.prototype,"mode",void 0),$e([sf.base.Property(8)],i.prototype,"padding",void 0),$e([sf.base.Property("Center")],i.prototype,"alignment",void 0),$e([sf.base.Complex(t.legendLabelFont,d)],i.prototype,"textStyle",void 0),$e([sf.base.Property(10)],i.prototype,"shapeHeight",void 0),$e([sf.base.Property(10)],i.prototype,"shapeWidth",void 0),$e([sf.base.Complex({},c)],i.prototype,"border",void 0),$e([sf.base.Complex({left:0,right:0,top:0,bottom:0},p)],i.prototype,"margin",void 0),$e([sf.base.Complex({left:0,right:0,top:0,bottom:0},u)],i.prototype,"containerPadding",void 0),$e([sf.base.Property(5)],i.prototype,"shapePadding",void 0),$e([sf.base.Property("transparent")],i.prototype,"background",void 0),$e([sf.base.Property(1)],i.prototype,"opacity",void 0),$e([sf.base.Property(!0)],i.prototype,"toggleVisibility",void 0),$e([sf.base.Property(null)],i.prototype,"description",void 0),$e([sf.base.Property(3)],i.prototype,"tabIndex",void 0),$e([sf.base.Property(null)],i.prototype,"title",void 0),$e([sf.base.Complex(t.legendTitleFont,d)],i.prototype,"titleStyle",void 0),$e([sf.base.Property("Top")],i.prototype,"titlePosition",void 0),$e([sf.base.Property(100)],i.prototype,"maximumTitleWidth",void 0),$e([sf.base.Property(!0)],i.prototype,"enablePages",void 0),$e([sf.base.Property(!1)],i.prototype,"isInversed",void 0),i}(sf.base.ChildProperty),it=function(){function e(e){this.pageXCollections=[],this.legendTitleCollections=[],this.legendRegions=[],this.pagingRegions=[],this.chart=e,this.legend=e.legendSettings,this.legendID=e.element.id+"_chart_legend",this.isChartControl="chart"===e.getModuleName(),this.isBulletChartControl="bulletChart"===e.getModuleName(),this.isStockChartControl="stockChart"===e.getModuleName(),this.bulletChart=this.chart,this.fivePixel=5,this.rowCount=0,this.pageButtonSize=8,this.maxColumns=0,this.maxWidth=0,this.currentPage=1,this.backwardArrowOpacity=0,this.forwardArrowOpacity=1,this.arrowWidth=2*(this.fivePixel+this.pageButtonSize+this.fivePixel),this.arrowHeight=this.arrowWidth,this.isTop=!1,this.isTitle=!1,this.currentPageNumber=1}return e.prototype.calculateLegendBounds=function(e,t,i){var r=this.legend,n=this.isBulletChartControl?"40%":"20%";this.getPosition(r.position,t),this.legendBounds=new sf.svgbase.Rect(e.x,e.y,0,0),this.isVertical="Left"===this.position||"Right"===this.position,this.isVertical?(this.legendBounds.height=ge(r.height,t.height-(e.y-this.chart.margin.top))||e.height,this.legendBounds.width=ge(r.width||n,t.width)):(this.legendBounds.width=ge(r.width,t.width)||e.width,this.legendBounds.height=ge(r.height||n,t.height)),this.library.getLegendBounds(t,this.legendBounds,r),this.isBulletChartControl||(this.legendBounds.width+=this.legend.containerPadding.left+this.legend.containerPadding.right,this.legendBounds.height+=this.legend.containerPadding.top+this.legend.containerPadding.bottom),this.getLocation(this.position,r.alignment,this.legendBounds,e,t,i)},e.prototype.getPosition=function(e,t){var i=this.chart,r=this.chart;this.isChartControl||this.isBulletChartControl||this.isStockChartControl?this.position="Auto"!==e?e:"Bottom":("Auto"===e&&((i||r).visibleSeries&&"Funnel"===(i||r).visibleSeries[0].type||"Pyramid"===(i||r).visibleSeries[0].type)&&(e="Top"),this.position="Auto"!==e?e:t.width>t.height?"Right":"Bottom")},e.prototype.setBounds=function(e,t,i,r){var n=i.title&&"Top"===i.titlePosition?this.legendTitleSize.height+this.fivePixel:0;this.isVertical&&this.isPaging&&!i.enablePages&&!this.isBulletChartControl&&(n=i.title&&"Top"===i.titlePosition?this.legendTitleSize.height+this.fivePixel:0,n+=this.pageButtonSize+this.fivePixel),e=Math.min(e,r.width),t=Math.min(t,r.height),"Gradient"===i.mode?(r.width=i.width?r.width:this.isVertical?e:.75*r.width,r.height=i.height?r.height:this.isVertical?.75*r.height:t):(r.width=i.width?r.width:e,r.height=i.height?r.height:t),this.isBulletChartControl||this.isTop&&"None"!==i.titleStyle.textOverflow&&(this.calculateLegendTitle(i,r),r.height+="Wrap"===i.titleStyle.textOverflow&&this.legendTitleCollections.length>1?this.legendTitleSize.height-this.legendTitleSize.height/this.legendTitleCollections.length:0),this.rowCount=Math.max(1,Math.ceil((r.height-i.padding-n)/(this.maxItemHeight+i.padding)))},e.prototype.getLocation=function(e,t,i,r,n,o){var s=this.legend.border.width,a=this.isBulletChartControl,l=this.bulletChart,h="Inside"===l.labelPosition,d="Inside"===l.tickPosition,c="Vertical"===l.orientation,p=a&&""!==l.categoryField?o.width+this.chart.border.width+3*s:0,u=this.chart.margin.bottom,g=i.height+s+this.legend.margin.top+this.legend.margin.bottom,f=i.width+s+this.legend.margin.left+this.legend.margin.right;"Bottom"===e?(i.x=this.alignLegend(i.x,n.width,i.width,t),i.y=r.y+(r.height-g)+s+this.legend.margin.top,i.y+=!a||l.opposedPosition||h||d||c?c&&""!==l.categoryField?o.height+2*s:0:l.majorTickLines.height+u+this.legend.border.width+2*s,Y(r,new Ce(0,0,0,g))):"Top"===e?(i.x=this.alignLegend(i.x,n.width,i.width,t),i.y=r.y+s+this.legend.margin.top,i.y-=!a||!l.opposedPosition||h||d||c?0:l.majorTickLines.height+this.chart.margin.top,Y(r,new Ce(0,0,g-=a?2*-s:0,0))):"Right"===e?(i.x=r.x+(r.width-i.width)-this.legend.margin.right,i.y=r.y+this.alignLegend(0,n.height-(r.y+u),i.height,t),f+=a&&l.opposedPosition&&!h&&!d&&c?this.chart.margin.left+this.chart.margin.right+l.majorTickLines.height:0,Y(r,new Ce(0,f,0,0))):"Left"===e?(i.x=i.x+this.legend.margin.left,i.y=r.y+this.alignLegend(0,n.height-(r.y+u),i.height,t),f+=!a||l.opposedPosition||h||d||!c?"Vertical"!==l.orientation&&""!==l.categoryField?p:0:i.x-this.chart.margin.left+s+l.majorTickLines.height,Y(r,new Ce(f,0,0,0))):(i.x=this.legend.location.x,i.y=this.legend.location.y,Y(r,new Ce(0,0,0,0)))},e.prototype.alignLegend=function(e,t,i,r){switch(r){case"Far":e=t-i-e;break;case"Center":e=(t-i)/2}return e},e.prototype.renderLegend=function(e,t,i,r){var n,o=0,s=(new sf.svgbase.Rect(0,0,0,0),new sf.svgbase.Rect(0,0,0,0)),a=this.findFirstLegendPosition(this.legendCollections),l=t.padding,h=t.enablePages,d=t.titlePosition,c=this.isPaging&&!t.enablePages&&this.isVertical?this.pageButtonSize:0,p=e.renderer.createGroup({id:this.legendID+"_g"}),u=this.createLegendElements(e,i,p,t,this.legendID,r);this.legendRegions=[];for(var g=0,f=0;f<this.legendCollections.length;f++)if(""!==this.legendCollections[f].text){g=Math.max(this.legendCollections[f].textSize.height,g);break}if(this.maxItemHeight=Math.max(g,t.shapeHeight),h||!this.isPaging||this.isVertical?this.isPaging||this.isVertical||(o=this.isTitle&&"Left"===d?this.fivePixel+this.legendTitleSize.width:0):(o=this.isTitle&&"Left"===d?this.legendTitleSize.width:0,o+=this.pageButtonSize+2*this.fivePixel),n=this.isTitle&&(this.isTop||this.isVertical)?this.legendTitleSize.height:0,"Gradient"===e.legendSettings.mode&&this.legendCollections.length>1)this.getLinearLegend(i,e,t,u),this.totalPages=1;else if(a!==this.legendCollections.length){var m=void 0,y=0,v=this.legendCollections[a],b=new Se(this.isBulletChartControl?i.x+o+l+t.shapeWidth/2:i.x+o+l+t.shapeWidth/2+t.containerPadding.left,this.isBulletChartControl?i.y+n+c+l+this.maxItemHeight/2:i.y+n+c+l+this.maxItemHeight/2+t.containerPadding.top),w=e.isRtlEnabled?"end":"start",x=new sf.svgbase.TextOption("",b.x,b.y,w),M=t.shapePadding+l+t.shapeWidth;if(this.totalPages=this.totalPages=this.isChartControl||this.isBulletChartControl||this.isStockChartControl?this.totalPages:0,this.pageXCollections=[],this.legendCollections[a].location=b,!t.enablePages&&this.isPaging){var N=b.x-this.fivePixel,I=b.y-this.fivePixel,S=this.isTitle&&!this.isVertical&&"Left"===d?this.legendTitleSize.width+this.fivePixel:0,C=this.isVertical?this.pageButtonSize+Math.abs(I-i.y):0,O=this.isTitle&&!this.isVertical&&"Right"===d?this.legendTitleSize.width+this.fivePixel:0;O+=this.isVertical?0:this.fivePixel+this.pageButtonSize+this.fivePixel,s=new sf.svgbase.Rect(N,I,i.width-O-S,i.height-C)}else s=i;for(var T=0,P=this.legendCollections;T<P.length;T++){var A=P[T];"accumulationchart"===this.chart.getModuleName()&&(A.fill=(this.chart||this.chart||this.chart).visibleSeries[0].points[A.pointIndex].color),"stockChart"===this.chart.getModuleName()&&(A.type=this.chart.visibleSeries[y].type),this.accessbilityText=this.isBulletChartControl?"Legend of bullet chart"+A.text:"Click to show or hide the "+A.text+" series",A.render&&""!==A.text&&((m=e.renderer.createGroup({id:this.legendID+this.generateId(A,"_g_",y)}))&&(m.setAttribute("tabindex",t.tabIndex.toString()),m.setAttribute("aria-label",t.description||this.accessbilityText)),this.library.getRenderPoint(A,b,M,v,s,y,a),this.renderSymbol(A,m,y),this.renderText(e,A,m,x,y),m&&m.setAttribute("style","outline: none; cursor: "+(!t.toggleVisibility&&("None"===e.selectionMode||"None"===e.highlightMode||"None"===e.selectionMode)||this.isBulletChartControl?"auto":"pointer")),u&&u.appendChild(m),v=A),y++}this.isPaging?this.renderPagingElements(e,i,x,p):this.totalPages=1}he(e.enableCanvas,e.svgObject,p,r)},e.prototype.getLinearLegend=function(e,t,i,r){var n="http://www.w3.org/2000/svg",o=this.legendCollections[0],s=this.legendCollections[1],a=this.chart.renderer.createDefs(),l=document.createElementNS(n,"linearGradient"),h=[],d=[];i.title&&(this.isVertical?(e.y+=this.legendTitleSize.height,e.height-=this.legendTitleSize.height):"Left"===i.titlePosition?(e.x+=this.legendTitleSize.width,e.width-=this.legendTitleSize.width):"Right"===i.titlePosition?e.width-=this.legendTitleSize.width:"Top"===i.titlePosition&&(e.y+=this.legendTitleSize.height,e.height-=this.legendTitleSize.height));for(var c=0,p=this.chart.rangeColorSettings;c<p.length;c++){var u=p[c];if(d.indexOf(u.start)<0&&d.push(u.start),u.colors.length>2){var g=u.end-u.start,f=u.colors.length-1;if(g>0){g/=f;for(var m=1;m<f;m++){var y=u.start+g*m;d.push(y)}}else for(m=1;m<f;m++)d.push(u.start)}d.indexOf(u.end)<0&&d.push(u.end);for(var v=0,b=u.colors;v<b.length;v++){var w=b[v];h.indexOf(w)<0&&h.push(w)}u.colors.length>0&&u.colors.length<2&&h.push(u.colors[0])}var x=this.isVertical?"0":"100",M=this.isVertical?"100":"0";l.setAttribute("id",this.generateId(o,"linearGradient",0)),l.setAttribute("x1","0%"),l.setAttribute("y1","0%"),l.setAttribute("x2",x+"%"),l.setAttribute("y2",M+"%");for(var N=d[d.length-1]-d[0],I=0;I<h.length;I++){var S=d[I]-d[0];S/=N;var C=document.createElementNS(n,"stop");C.setAttribute("offset",S.toString()),C.setAttribute("stop-color",h[I]),C.setAttribute("stop-opacity",1..toString()),l.appendChild(C)}var O,T,P,A,L=o.text.toString(),F=s.text.toString(),D=sf.svgbase.measureText(L,i.textStyle),E=sf.svgbase.measureText(F,i.textStyle),z=D.width>E.width?D.width:E.width,k=D.height>E.height?D.height:E.height,W=2*z+4*i.padding,R=e.width,j=e.height,U=e.x+z+2*i.padding,H=e.y+i.padding;if(this.isVertical){if(W=2*k+4*i.padding,R=e.width-2*i.padding,j=e.height-W,U=e.x+i.padding,H=e.y+k+2*i.padding,O=e.y+i.padding+k,T=H+j+k,A=P=e.x+.5*e.width-.5*z,R>30){var B=R-30;R=30,U+=B/2}}else if(R=e.width-W,j=e.height-2*i.padding,P=e.x+i.padding+(z-D.width),A=e.x+R+3*i.padding+z,T=O=e.y+.5*e.height+.25*k,j>30){var _=j-30;j=30,H+=_/2}var V=new sf.svgbase.TextOption("",P,O,"",L);V.id=this.legendID+this.generateId(o,"_text_",1);var Y=o.visible?i.textStyle.color||t.themeStyle.legendLabel:"#D3D3D3",Q=!this.isStockChartControl&&this.chart.enableCanvas;me(t.renderer,V,i.textStyle,Y,r,!1,!1,!1,!1,null,this.currentPageNumber&&Q?new sf.svgbase.Rect(0,-this.translatePage(null,this.currentPageNumber-1,this.currentPageNumber),0,0):null),(V=new sf.svgbase.TextOption("",A,T,"",F)).id=this.legendID+this.generateId(o,"_text_",2),me(t.renderer,V,i.textStyle,Y,r,!1,!1,!1,!1,null,this.currentPageNumber&&Q?new sf.svgbase.Rect(0,-this.translatePage(null,this.currentPageNumber-1,this.currentPageNumber),0,0):null);var q=t.renderer.drawRectangle({width:R,height:j,x:U,y:H,fill:"url(#"+this.generateId(o,"linearGradient",0)+")"});a.appendChild(l),r.appendChild(a),r.appendChild(q)},e.prototype.findFirstLegendPosition=function(e){for(var t=0,i=0,r=e;i<r.length;i++){var n=r[i];if(n.render&&""!==n.text)break;t++}return t},e.prototype.calculateLegendTitle=function(e,t){if(e.title){this.isTop="Top"===e.titlePosition;var i="Trim"===e.titleStyle.textOverflow?2*e.padding:0;this.isTop||this.isVertical?this.legendTitleCollections=ve(e.title,e.titleStyle,t.width-i):this.legendTitleCollections[0]=ue(e.maximumTitleWidth,e.title,e.titleStyle);var r=this.isTop?e.title:this.legendTitleCollections[0];this.legendTitleSize=sf.svgbase.measureText(r,e.titleStyle),this.legendTitleSize.height*=this.legendTitleCollections.length}else this.legendTitleSize=new sf.svgbase.Size(0,0)},e.prototype.renderLegendTitle=function(e,t,i,r){var n=t.padding,o=t.titleStyle.textAlignment;this.isTop="Top"===t.titlePosition;var s="Near"===o?"start":"Far"===o?"end":"middle",a=be(i,t.titleStyle);s=this.isTop||this.isVertical?s:"",a="Near"===o?a+n:"Far"===o?a-n:a,a=this.isTop||this.isVertical?a:i.x+("Left"===t.titlePosition?5:i.width-this.legendTitleSize.width-5);var l=i.height/2+this.legendTitleSize.height/4,h=i.y+(this.isTop||this.isVertical?this.legendTitleSize.height/this.legendTitleCollections.length:l),d=new sf.svgbase.TextOption(this.legendID+"_title",a,h,s,this.legendTitleCollections);me(e.renderer,d,t.titleStyle,t.titleStyle.color,r)},e.prototype.createLegendElements=function(e,t,i,r,n,o){var s=r.padding,a=new Ne(n+"_element",r.background,r.border,r.opacity,t),l=e.renderer.createGroup({id:n+"_collections"}),h=!this.isStockChartControl&&e.enableCanvas,d=e.renderer.createClipPath({id:n+"_clipPath"});return i?i.appendChild(e.renderer.drawRectangle(a)):e.renderer.drawRectangle(a),r.title&&this.renderLegendTitle(e,r,t,i),h||i.appendChild(l),this.legendTranslateGroup=e.renderer.createGroup({id:n+"_translate_g"}),h||l.appendChild(this.legendTranslateGroup),a.y+=s+(this.isTop?this.legendTitleSize.height:0),a.id+="_clipPath_rect",a.width=this.isChartControl||"bulletChart"===e.getModuleName()||this.isStockChartControl||!this.isVertical?t.width:this.maxWidth-s+r.containerPadding.left+r.containerPadding.right,h?this.pagingClipRect=a:(this.clipRect=e.renderer.drawRectangle(a),d.appendChild(this.clipRect)),he(h,e.svgObject,d,o),h||l.setAttribute("style","clip-path:url(#"+d.id+")"),this.legendTranslateGroup},e.prototype.renderSymbol=function(e,t,i){var r,n,o=this.isBulletChartControl?this.chart:null,s=e.visible?e.fill:"#D3D3D3",a=("chart"===this.chart.getModuleName()||"stockChart"===this.chart.getModuleName())&&"SeriesType"===e.shape&&e.type.toLowerCase().indexOf("line")>-1&&-1===e.type.toLowerCase().indexOf("area"),l=!("chart"!==this.chart.getModuleName()&&"stockChart"!==this.chart.getModuleName()||"Scatter"!==e.type&&"Bubble"!==e.type),h=!this.isStockChartControl&&this.chart.enableCanvas,d="SeriesType"===e.shape?e.type:e.shape,c=a?"Series"===this.legend.mode?this.chart.visibleSeries[i].width:this.chart.visibleSeries[0].width:this.isBulletChartControl&&"Multiply"===e.shape?4:1;if(d="Scatter"===d?e.markerShape:d,l&&i<this.chart.visibleSeries.length){var p=this.chart.visibleSeries[i].border;r=p.color?p.color:s,c=p.width?p.width:1}var u=new sf.svgbase.PathOption(this.legendID+this.generateId(e,"_shape_",i),s,c,l?r:s,1,"",""),g=sf.svgbase.measureText(e.text,this.legend.textStyle),f=this.legend.isInversed?e.location.x+g.width+this.legend.shapePadding:e.location.x,m=e.location.y;h?(n=-this.translatePage(null,this.currentPageNumber-1,this.currentPageNumber),ie({x:f,y:m},d,new sf.svgbase.Size(this.legend.shapeWidth,this.legend.shapeHeight),"",u,this.accessbilityText,this.chart.renderer,this.currentPageNumber?new sf.svgbase.Rect(0,n,0,0):null,this.isBulletChartControl,o),this.legendRegions.push({rect:new sf.svgbase.Rect(e.location.x,e.location.y,this.legend.shapeWidth,this.legend.shapeHeight+n),index:i})):t.appendChild(ie({x:f,y:m},d,new sf.svgbase.Size(this.legend.shapeWidth,this.legend.shapeHeight),e.url,u,this.accessbilityText,this.chart.renderer,null,this.isBulletChartControl,o)),("Line"===d&&e.markerVisibility&&"Image"!==e.markerShape||"Doughnut"===e.type&&"Doughnut"===d)&&(u.id=this.legendID+this.generateId(e,"_shape_marker_",i),d="Doughnut"===e.type?"Circle":e.markerShape,u.fill="Doughnut"===e.type?"#FFFFFF":u.fill,h?ie({x:f,y:m},d,new sf.svgbase.Size(this.legend.shapeWidth/2,this.legend.shapeHeight/2),"",u,this.accessbilityText,this.chart.renderer,this.currentPageNumber?new sf.svgbase.Rect(0,-this.translatePage(null,this.currentPageNumber-1,this.currentPageNumber),0,0):null,this.isBulletChartControl,o):t.appendChild(ie({x:f,y:m},d,new sf.svgbase.Size(this.legend.shapeWidth/2,this.legend.shapeHeight/2),"",u,this.accessbilityText,null,null,this.isBulletChartControl,o)))},e.prototype.renderText=function(e,t,i,r,n){var o=e.legendSettings,s=t.visible?o.textStyle.color||e.themeStyle.legendLabel:"#D3D3D3",a=!this.isStockChartControl&&this.chart.enableCanvas;r.id=this.legendID+this.generateId(t,"_text_",n),r.text=t.text,r.x=o.isInversed?t.location.x-o.shapeWidth/2:t.location.x+o.shapeWidth/2+o.shapePadding,r.y=t.location.y+this.maxItemHeight/4;var l=me(e.renderer,r,o.textStyle,s,i,!1,!1,!1,!1,null,this.currentPageNumber&&a?new sf.svgbase.Rect(0,-this.translatePage(null,this.currentPageNumber-1,this.currentPageNumber),0,0):null);if(l&&l.setAttribute("aria-label",o.description||this.accessbilityText),a){var h=sf.svgbase.measureText(r.text,o.textStyle);this.legendRegions[n].rect.y=r.y<this.legendRegions[n].rect.y?r.y:this.legendRegions[n].rect.y,this.legendRegions[n].rect.width+=h.width,this.legendRegions[n].rect.height=h.height,this.legendRegions[n].rect.y-=.5*h.height}},e.prototype.renderPagingElements=function(e,t,i,r){var n,o=e.renderer.createGroup({id:this.legendID+"_navigation"}),s=!this.isStockChartControl&&e.enableCanvas,a=this.isBulletChartControl?0:this.legendTitleSize.height,l=this.chart.theme.indexOf("Dark")>-1?"#FFFFFF":"#545454",h=e.legendSettings,d=new sf.svgbase.PathOption(this.legendID+"_pageup","transparent",5,l,1,"",""),c=this.pageButtonSize,p=h.enablePages||!this.isPaging||this.isVertical||this.isBulletChartControl?this.rowCount-1:1,u=this.isTitle&&"Left"===h.titlePosition?this.legendTitleSize.width:0;this.pagingRegions=[],this.backwardArrowOpacity=1!==this.currentPage?1:0,this.forwardArrowOpacity=this.currentPage===this.totalPages?0:1,s||r.appendChild(o),this.isChartControl||this.isBulletChartControl||this.isStockChartControl||!this.isVertical?this.totalPages=Math.ceil(this.totalPages/Math.max(1,this.rowCount-1)):this.totalPages=Math.ceil(this.totalPages/this.maxColumns),o&&o.setAttribute("style","cursor: pointer"),this.clipPathHeight=p*(this.maxItemHeight+h.padding),s?(this.pagingClipRect.height=this.legendBounds.height-this.clipPathHeight-(this.pagingClipRect.y-this.legendBounds.y)-h.border.width,this.pagingClipRect.y=this.pagingClipRect.y+this.clipPathHeight,this.pagingClipRect.x+=h.border.width,this.pagingClipRect.width-=h.border.width+h.border.width/2,this.chart.renderer.clearRect(new sf.svgbase.Rect(this.pagingClipRect.x,this.pagingClipRect.y,this.pagingClipRect.width,this.pagingClipRect.height))):this.clipRect.setAttribute("height",this.clipPathHeight.toString());var g=t.x+c/2,f=t.y+this.clipPathHeight+(a+t.height-this.clipPathHeight)/2;!this.isPaging||h.enablePages||this.isVertical||this.isBulletChartControl||(g=t.x+this.fivePixel+this.pageButtonSize+u,f=h.title&&this.isTop?t.y+8+a+c/1+.5:t.y+8+c+.5);var m=sf.svgbase.measureText(this.totalPages+"/"+this.totalPages,h.textStyle);s?ie({x:g,y:f},"LeftArrow",new sf.svgbase.Size(c,c),"",d,0,this.chart.renderer,new sf.svgbase.Rect(t.width-(2*(c+8)+8+m.width),0,0,0)):!this.isVertical||h.enablePages||this.isBulletChartControl?(d.opacity=this.isBulletChartControl?d.opacity:h.enablePages?1:this.backwardArrowOpacity,o.appendChild(ie({x:g,y:f},"LeftArrow",new sf.svgbase.Size(c,c),"",d))):(g=t.x+t.width/2,f=t.y+c/2+8+a,d.opacity=this.backwardArrowOpacity,o.appendChild(ie({x:g,y:f},"UpArrow",new sf.svgbase.Size(c,c),"",d))),this.pagingRegions.push(new sf.svgbase.Rect(g+t.width-(2*(c+8)+8+m.width)-.5*c,f-.5*c,c,c)),i.x=g+c/2+8,i.y=f+m.height/4,i.id=this.legendID+"_pagenumber",i.text="1/"+this.totalPages;var y=this.chart.theme.indexOf("Dark")>-1?"#FFFFFF":h.textStyle.color;s&&this.totalNoOfPages&&(i.text=this.currentPageNumber+"/"+this.totalNoOfPages),(h.enablePages||this.isBulletChartControl)&&(n=me(e.renderer,i,h.textStyle,y,o,!1,!1,!1,!1,null,new sf.svgbase.Rect(t.width-(2*(c+8)+8+m.width),0,0,0))),g=i.x+8+c/2+m.width,!this.isPaging||h.enablePages||this.isVertical||(g=t.x+t.width-this.fivePixel-this.pageButtonSize-(h.title&&"Right"===h.titlePosition?this.legendTitleSize.width+this.fivePixel:0)),d.id=this.legendID+"_pagedown",d.opacity=h.enablePages?1:this.forwardArrowOpacity,s?ie({x:g,y:f},"RightArrow",new sf.svgbase.Size(c,c),"",d,0,this.chart.renderer,new sf.svgbase.Rect(t.width-(2*(c+8)+8+m.width),0,0,0)):!this.isVertical||h.enablePages||this.isBulletChartControl?o.appendChild(ie({x:g,y:f},"RightArrow",new sf.svgbase.Size(c,c),"",d)):(g=t.x+t.width/2,f=t.y+t.height-c/2-8,o.appendChild(ie({x:g,y:f},"DownArrow",new sf.svgbase.Size(c,c),"",d))),this.pagingRegions.push(new sf.svgbase.Rect(g+(t.width-(2*(c+8)+8+m.width)-.5*c),f-.5*c,c,c)),s||!h.enablePages&&!this.isBulletChartControl?(1===this.currentPageNumber&&this.calTotalPage&&(h.enablePages||this.isBulletChartControl)&&(this.totalNoOfPages=this.totalPages,this.calTotalPage=!1),h.enablePages||this.isBulletChartControl||this.translatePage(null,this.currentPage-1,this.currentPage,h)):o.setAttribute("transform","translate("+(t.width-(2*(c+8)+8+m.width))+", 0)"),(h.enablePages||this.isBulletChartControl)&&this.translatePage(n,this.currentPage-1,this.currentPage,h)},e.prototype.translatePage=function(e,t,i,r){var n=this.clipPathHeight*t,o="translate(0,-"+n+")";return this.isChartControl||this.isBulletChartControl||this.isStockChartControl||!this.isVertical||(o="translate(-"+(n=(n=this.pageXCollections[t*this.maxColumns]-this.legendBounds.x)<0?0:n)+",0)"),this.chart.enableCanvas||this.legendTranslateGroup.setAttribute("transform",o),this.chart.enableCanvas||!r.enablePages&&!this.isBulletChartControl||(e.textContent=i+"/"+this.totalPages),this.currentPage=i,n},e.prototype.changePage=function(e,t){var i=this.chart.legendSettings,r=document.getElementById(this.legendID+"_pageup"),n=document.getElementById(this.legendID+"_pagedown"),o=i.enablePages||this.isBulletChartControl?document.getElementById(this.legendID+"_pagenumber"):null,s=i.enablePages||this.isBulletChartControl?parseInt(o.textContent.split("/")[0],10):this.currentPage;t&&s>1?this.translatePage(o,s-2,s-1,i):!t&&s<this.totalPages&&this.translatePage(o,s,s+1,i),!this.isPaging||i.enablePages||this.isBulletChartControl||(this.currentPage===this.totalPages?this.hideArrow(n):this.showArrow(n),1===this.currentPage?this.hideArrow(r):this.showArrow(r))},e.prototype.hideArrow=function(e){e.setAttribute("opacity","0")},e.prototype.showArrow=function(e){e.setAttribute("opacity","1")},e.prototype.generateId=function(e,t,i){return this.isChartControl||this.isStockChartControl?t+i:t+e.pointIndex},e.prototype.move=function(e){var t=this,i=this.chart.mouseX,r=this.chart.mouseY;if(e.target.textContent.indexOf("...")>-1){var n=e.target.id.split(this.legendID+"_text_");if(2===n.length){var o=parseInt(n[1],10),s=this.chart.element;isNaN(o)||(this.chart.isTouch&&H(this.chart.element.id+"_EJ2_Legend_Tooltip"),this.isChartControl?_(this.chart.series[o].name,i,r,s.offsetWidth,s.id+"_EJ2_Legend_Tooltip",re(this.chart.element.id+"_Secondary_Element")):_(this.chart.visibleSeries[0].points[o].x.toString(),i+10,r+10,s.offsetWidth,s.id+"_EJ2_Legend_Tooltip",re(this.chart.element.id+"_Secondary_Element")))}}else H(this.chart.element.id+"_EJ2_Legend_Tooltip");this.chart.isTouch&&(clearTimeout(this.clearTooltip),this.clearTooltip=+setTimeout((function(){H(t.chart.element.id+"_EJ2_Legend_Tooltip")}),1e3))},e}(),rt=function(e,t,i,r,n,o,s,a,l,h){this.location={x:0,y:0},this.text=e,this.fill=t,this.shape=i,this.url=o,this.visible=r,this.type=n,this.markerVisibility=a,this.markerShape=s,this.pointIndex=l,this.seriesIndex=h},nt=function(){function e(e,t){this.initDataManager(e,t)}return e.prototype.initDataManager=function(e,t){this.dataManager=e instanceof sf.data.DataManager?e:new sf.data.DataManager(e),this.query=t instanceof sf.data.Query?t:new sf.data.Query},e.prototype.generateQuery=function(){return this.query.clone()},e.prototype.getData=function(e){var t=this;if(this.dataManager.ready){var i=new sf.data.Deferred;return this.dataManager.ready.then((function(){t.dataManager.executeQuery(e).then((function(e){i.resolve(e)}))})).catch((function(e){i.reject(e)})),i.promise}return this.dataManager.executeQuery(e)},e}(),ot=function(){function e(e){this.accumulation=e}return Object.defineProperty(e.prototype,"center",{get:function(){return this.pieCenter||("Pie"===this.accumulation.visibleSeries[0].type?this.accumulation.pieSeriesModule.pieBaseCenter:null)},set:function(e){this.pieCenter=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"radius",{get:function(){return void 0!==this.pieRadius?this.pieRadius:this.accumulation.pieSeriesModule.pieBaseRadius},set:function(e){this.pieRadius=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"labelRadius",{get:function(){return void 0!==this.pieLabelRadius?this.pieLabelRadius:this.accumulation.pieSeriesModule.pieBaseLabelRadius},set:function(e){this.pieLabelRadius=e},enumerable:!0,configurable:!0}),e.prototype.isCircular=function(){return"Pie"===this.accumulation.type},e.prototype.isVariousRadius=function(){return this.accumulation.pieSeriesModule.isRadiusMapped},e.prototype.processExplode=function(e){if(e.target.id.indexOf("_Series_")>-1||e.target.id.indexOf("_datalabel_")>-1){var t=G(e.target.id).point;if(isNaN(t)||e.target.id.indexOf("_datalabel_")>-1&&"Outside"===this.accumulation.visibleSeries[0].points[t].labelPosition)return null;this.explodePoints(t,this.accumulation),this.deExplodeAll(t,this.accumulation.enableAnimation?300:0)}},e.prototype.invokeExplode=function(){for(var e=this.accumulation.visibleSeries[0],t=this.accumulation.enableAnimation?300:0,i=0,r=e.points;i<r.length;i++){var n=r[i];n.isExplode&&this.pointExplode(n.index,n,t)}if(this.accumulation.accumulationSelectionModule&&"None"!==this.accumulation.selectionMode&&this.accumulation.accumulationSelectionModule.selectedDataIndexes.length)for(var o=0,s=this.accumulation.accumulationSelectionModule.selectedDataIndexes;o<s.length;o++){var a=s[o];this.explodePoints(a.point,this.accumulation,!0),this.deExplodeAll(a.point,t)}},e.prototype.deExplodeAll=function(e,t){for(var i=this.accumulation.element.id+"_Series_0_Point_",r=0,n=this.accumulation.visibleSeries[0].points;r<n.length;r++){var o=n[r];(e!==o.index&&!o.isSliced||o.isClubbed)&&(o.isExplode=!1,this.deExplodeSlice(o.index,i,t))}},e.prototype.explodePoints=function(e,t,i){void 0===i&&(i=!1);var r=t.visibleSeries[0],n=r.points,o=Re(e,n),s=!0,a=this.accumulation.enableAnimation?300:0;if(sf.base.isNullOrUndefined(o))return null;var l=!i&&(o.isSliced||r.clubbedPoints.length&&n[n.length-1].index===r.clubbedPoints[r.clubbedPoints.length-1].index);"Pie"===r.type&&(l||o.isClubbed)&&(s=this.clubPointExplode(e,o,r,n,t,a,l)),s&&this.pointExplode(e,o,a,i)},e.prototype.getSum=function(e){var t=0;return e.map((function(e){t+=e.visible?e.y:0})),t},e.prototype.clubPointExplode=function(e,t,i,r,n,o,s){if(void 0===s&&(s=!1),t.isClubbed)return n.animateSeries=!1,r.splice(r.length-1,1),i.clubbedPoints.map((function(e){e.visible=!0,e.isExplode=!0})),n.visibleSeries[0].points=r.concat(i.clubbedPoints),this.deExplodeAll(e,o),i.sumOfPoints=this.getSum(n.visibleSeries[0].points),n.refreshChart(),!1;if(s||t.isSliced){n.animateSeries=!1,r.splice(r.length-i.clubbedPoints.length,i.clubbedPoints.length);var a=i.generateClubPoint();if(a.index=r.length,a.color=i.clubbedPoints[0].color,r.push(a),i.sumOfPoints=this.getSum(r),this.deExplodeAll(e,o),a.isExplode=!1,n.visibleSeries[0].points=r,n.refreshChart(),this.pointExplode(a.index,r[a.index],0,!0),a.isExplode=!1,this.deExplodeSlice(a.index,n.element.id+"_Series_0_Point_",o),t.isSliced)return!1}return!0},e.prototype.pointExplode=function(e,t,i,r){var n,o=this.accumulation.element.id+"_Series_0_Point_",s=this.accumulation;n=this.isCircular()?Q(t.midAngle,s.explodeDistance,this.center):{x:t.labelRegion&&t.labelRegion.x<t.region.x?-s.explodeDistance:s.explodeDistance,y:0},this.isExplode(o+e)||r?(t.isExplode=!0,this.explodeSlice(e,n,o,this.center||{x:0,y:0},i)):(t.isExplode=!1,this.deExplodeSlice(e,o,i))},e.prototype.isExplode=function(e){var t=re(e),i=t?t.getAttribute("transform"):null;return t&&("translate(0, 0)"===i||null===i||"translate(0)"===i)},e.prototype.deExplodeSlice=function(e,t,i){var r=re(t+e);r&&(r.parentNode.lastChild.hasAttribute("transform")&&r.parentNode.lastChild.removeAttribute("transform"));var n=r?r.getAttribute("transform"):null;if(this.accumulation.enableAnimation&&r&&n&&"translate(0, 0)"!==n&&"translate(0)"!==n){var o=/translate\((-?\d+\.?\d*),?\s*(-?\d+[.]?\d*)?\)/.exec(n);this.performAnimation(e,t,0,0,+o[1],+o[2]||0,i,!0)}else this.performAnimation(e,t,0,0,0,0,i,!0)},e.prototype.setTranslate=function(e,t,i,r){this.setElementTransform(t+e,i),this.accumulation.visibleSeries[0].dataLabel.visible&&(t=this.accumulation.element.id+"_datalabel_Series_0_",this.setElementTransform(t+"shape_"+e,i),this.setElementTransform(t+"text_"+e,i+r),this.setElementTransform(t+"connector_"+e,i))},e.prototype.setElementTransform=function(e,t){var i=re(e);i&&i.setAttribute("transform",t)},e.prototype.explodeSlice=function(e,t,i,r,n){this.performAnimation(e,i,0,0,t.x-r.x,t.y-r.y,n)},e.prototype.performAnimation=function(e,t,i,r,n,o,s,a){var l,h,d=this,c=this.accumulation,p=t.split("_"),u=parseInt(t.split("_")[p.length-3],10),g=c.visibleSeries[u].points[e];if(s<=0)return this.setTranslate(e,t,"translate("+n+", "+o+")",g.transform),null;new sf.base.Animation({}).animate(sf.base.createElement("div"),{duration:s,progress:function(s){l=J(s.timeStamp,i,n,s.duration),h=J(s.timeStamp,r,o,s.duration),d.setTranslate(e,t,"translate("+(a?n-l:l)+", "+(a?o-h:h)+")",g.transform)},end:function(){d.setTranslate(e,t,"translate("+(a?i:n)+", "+(a?i:o)+")",g.transform)}})},e}(),st=(Ue=function(e,t){return(Ue=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}Ue(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),at=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return st(t,e),t.prototype.initProperties=function(e,t){this.accumulation=e,this.size=Math.min(e.initialClipRect.width,e.initialClipRect.height),this.initAngles(t);var i=parseInt(t.radius,10);if(-1===t.radius.indexOf("%")&&"number"!=typeof i||isNaN(i)){var r=[];this.isRadiusMapped=!0;for(var n=0;n<Object.keys(t.points).length;n++)-1!==t.points[n].sliceRadius.indexOf("%")?r[n]=ge(t.points[n].sliceRadius,this.size/2):r[n]=parseInt(t.points[n].sliceRadius,10);var o=Math.min.apply(null,r),s=Math.max.apply(null,r);this.pieBaseRadius=this.seriesRadius=s,this.innerRadius=ge(t.innerRadius,this.seriesRadius),this.innerRadius=this.innerRadius>o?this.innerRadius/2:this.innerRadius}else this.isRadiusMapped=!1,this.pieBaseRadius=ge(t.radius,this.size/2),this.innerRadius=ge(t.innerRadius,this.pieBaseRadius),this.pieBaseLabelRadius="Inside"===t.dataLabel.position?(this.pieBaseRadius-this.innerRadius)/2+this.innerRadius:this.pieBaseRadius+ge(t.dataLabel.connectorStyle.length||"4%",this.size/2);this.radius=this.pieBaseRadius,this.labelRadius=this.pieBaseLabelRadius,e.explodeDistance=t.explode?ge(t.explodeOffset,this.pieBaseRadius):0,this.findCenter(e,t),this.center=this.pieBaseCenter,this.defaultLabelBound(t,t.dataLabel.visible,t.dataLabel.position),this.totalAngle-=.001},t.prototype.getLabelRadius=function(e,t){return"Inside"===e.dataLabel.position?(ge(t.sliceRadius,this.pieBaseRadius)-this.innerRadius)/2+this.innerRadius:ge(t.sliceRadius,this.seriesRadius)+ge(e.dataLabel.connectorStyle.length||"4%",this.size/2)},t.prototype.findCenter=function(e,t){this.accumulation=e,this.pieBaseCenter={x:ge(e.center.x,e.initialClipRect.width)+e.initialClipRect.x,y:ge(e.center.y,e.initialClipRect.height)+e.initialClipRect.y};var i=this.getSeriesBound(t),r=new Se(i.x+i.width/2,i.y+i.height/2);this.pieBaseCenter.x+=this.pieBaseCenter.x-r.x,this.pieBaseCenter.y+=this.pieBaseCenter.y-r.y,this.accumulation.origin=this.pieBaseCenter},t.prototype.initAngles=function(e){var t=sf.base.isNullOrUndefined(e.endAngle)?e.startAngle:e.endAngle;this.totalAngle=(t-e.startAngle)%360,this.startAngle=e.startAngle-90,this.totalAngle=this.totalAngle<=0?360+this.totalAngle:this.totalAngle,this.startAngle=(this.startAngle<0?this.startAngle+360:this.startAngle)%360},t.prototype.defaultLabelBound=function(e,t,i){var r=this.getSeriesBound(e);e.accumulationBound=r,e.labelBound=new sf.svgbase.Rect(r.x,r.y,r.width+r.x,r.height+r.y),t&&"Outside"===i&&(e.labelBound=new sf.svgbase.Rect(1/0,1/0,-1/0,-1/0))},t.prototype.getSeriesBound=function(e){var t=new sf.svgbase.Rect(1/0,1/0,-1/0,-1/0);this.initAngles(e);var i=this.startAngle,r=this.totalAngle,n=(this.startAngle+r)%360;n=0===n?360:n,e.findMaxBounds(t,this.getRectFromAngle(i)),e.findMaxBounds(t,this.getRectFromAngle(n)),e.findMaxBounds(t,new sf.svgbase.Rect(this.pieBaseCenter.x,this.pieBaseCenter.y,0,0));var o=(90*Math.floor(i/90)+90)%360,s=90*Math.floor(n/90)%360;s=0===s?360:s,(r>=90||s===o)&&(e.findMaxBounds(t,this.getRectFromAngle(o)),e.findMaxBounds(t,this.getRectFromAngle(s))),(0===i||i+r>=360)&&e.findMaxBounds(t,this.getRectFromAngle(0));for(var a=o===s?0:Math.floor(r/90),l=1;l<a;l++)((o+=90)<s||n<i||360===r)&&e.findMaxBounds(t,this.getRectFromAngle(o));return t.width-=t.x,t.height-=t.y,t},t.prototype.getRectFromAngle=function(e){var t=Q(e,this.pieBaseRadius,this.pieBaseCenter);return new sf.svgbase.Rect(t.x,t.y,0,0)},t.prototype.getPathArc=function(e,t,i,r,n){var o=i-t,s=(o=o<0?o+360:o)<180?0:1;return n||0!==n?this.getDoughnutPath(e,Q(t,r,e),Q(i,r,e),r,Q(t,n,e),Q(i,n,e),n,s):this.getPiePath(e,Q(t,r,e),Q(i,r,e),r,s)},t.prototype.getPiePath=function(e,t,i,r,n){return"M "+e.x+" "+e.y+" L "+t.x+" "+t.y+" A "+r+" "+r+" 0 "+n+" 1 "+i.x+" "+i.y+" Z"},t.prototype.getDoughnutPath=function(e,t,i,r,n,o,s,a){return"M "+t.x+" "+t.y+" A "+r+" "+r+" 0 "+a+" 1 "+i.x+" "+i.y+" L "+o.x+" "+o.y+" A "+s+" "+s+" 0 "+a+",0 "+n.x+" "+n.y+" Z"},t.prototype.doAnimation=function(e,t){var i,r=this,n=t.startAngle-90,o=this.accumulation.duration?this.accumulation.duration:t.animation.duration;this.pieBaseCenter.x+=1;var s=.75*Math.max(this.accumulation.availableSize.height,this.accumulation.availableSize.width);s+=.414*s;var a=function(e){var t;switch(e){case"Linear":t=J}return t}("Linear");new sf.base.Animation({}).animate(e,{duration:o,delay:t.animation.delay,progress:function(t){i=a(t.timeStamp,n,r.totalAngle,t.duration),e.setAttribute("d",r.getPathArc(r.pieBaseCenter,n,i,s,0))},end:function(){r.pieBaseCenter.x-=1,e.setAttribute("d",r.getPathArc(r.pieBaseCenter,0,359.99999,s,0)),r.accumulation.trigger("animationComplete",r.accumulation.isBlazor?{}:{series:t,accumulation:r.accumulation,chart:r.accumulation}),re(r.accumulation.element.id+"_datalabel_Series_"+t.index).style.visibility=r.accumulation.isDestroyed?"hidden":"visible"}})},t}(ot),lt=(He=function(e,t){return(He=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}He(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),ht=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return lt(t,e),t.prototype.renderPoint=function(e,t,i,r,n,o){var s=t.sumOfPoints;e.startAngle=this.startAngle;var a=e.visible?e.y:0,l=s?Math.abs(a)/s*this.totalAngle:null,h=Math.PI/180*(90-(360-this.startAngle)-90);this.radius=this.isRadiusMapped?ge(e.sliceRadius,this.seriesRadius):this.radius,r.d=this.getPathOption(e,l,this.startAngle%360),e.midAngle=(this.startAngle-l/2)%360,e.endAngle=this.startAngle%360,e.symbolLocation=Q(e.midAngle,(this.radius+this.innerRadius)/2,this.center),o?(n.appendChild(i.renderer.drawPath(r)),this.refresh(e,l,h,i,r)):(n.appendChild(i.renderer.drawPath(r)),e.degree=l,e.start=h)},t.prototype.findSeries=function(e){var t=0===this.innerRadius?this.radius+3:this.innerRadius-3,i=0===this.innerRadius?t+2:t-2;this.toggleInnerPoint(e,t,i)},t.prototype.toggleInnerPoint=function(e,t,i){var r,n=G(e.target.id,!0),o=e.target.id.substring(0,e.target.id.indexOf("Series")-1),s=document.getElementById(this.accumulation.element.id+"PointHover_Border"),a=n.series,l=n.point,h=re(o+"_Series_"+a+"_Point_"+l);if(!isNaN(n.series)&&h){if(!(sf.base.isNullOrUndefined(a)||isNaN(a)||sf.base.isNullOrUndefined(l)||isNaN(l))){var d=this.accumulation.visibleSeries[0].points[l],c=h.getAttribute("class")===o+"_ej2_deselected"?this.accumulation.tooltip.enable?.5:.3:this.accumulation.tooltip.enable?.5:1,p=this.getPathArc(this.accumulation.pieSeriesModule.center,d.startAngle%360,(d.startAngle+d.degree)%360,t,i);s&&o===this.accumulation.element.id&&(s.getAttribute("d")!==p||d.isExplode)&&(s.parentNode.removeChild(s),s=null);var u=re(o+"_Series_"+a);if(!s&&(!d.isExplode||d.isExplode&&"click"!==e.type)){var g=new sf.svgbase.PathOption(o+"PointHover_Border",d.color,1,d.color,c,"",p);if((r=this.accumulation.renderer.drawPath(g)).removeAttribute("transform"),"None"!==this.accumulation.selectionMode&&e.target.hasAttribute("class")&&this.accumulation.accumulationSelectionModule.addSvgClass(r,e.target.getAttribute("class")),u.appendChild(r),d.isExplode&&r){var f=h.getAttribute("transform");r.setAttribute("transform",f)}}}}else s&&(this.removeBorder(s,1e3),s=null)},t.prototype.removeBorder=function(e,t){e&&setTimeout((function(){e.parentNode&&e.parentNode.removeChild(e)}),t)},t.prototype.refresh=function(e,t,i,r,n){var o=this,s=re(n.id),a=r.duration?r.duration:300;new sf.base.Animation({}).animate(sf.base.createElement("div"),{duration:a,delay:0,progress:function(n){var a=J(n.timeStamp,e.degree,t-e.degree,n.duration),l=J(n.timeStamp,e.start,i-e.start,n.duration);l=(l/(Math.PI/180)+360)%360,s.setAttribute("d",o.getPathOption(e,a,l)),e.isExplode&&r.accBaseModule.explodePoints(e.index,r,!0),s.style.visibility="visible"},end:function(){s.style.visibility=e.visible?"visible":"hidden",s.setAttribute("d",n.d),e.degree=t,e.start=i}})},t.prototype.getPathOption=function(e,t,i){if(!t)return"";var r=this.getPathArc(this.center,i%360,(i+t)%360,this.isRadiusMapped?ge(e.sliceRadius,this.seriesRadius):this.radius,this.innerRadius);return this.startAngle+=t,r},t.prototype.animateSeries=function(e,t,i,r){var n=e.element.id+"SeriesGroup"+i.index;if(i.animation.enable&&e.animateSeries){var o=e.renderer.createClipPath({id:n+"_clipPath"}),s=new sf.svgbase.PathOption(n+"_slice","transparent",1,"transparent",1,"",""),a=e.renderer.drawPath(s);o.appendChild(a),e.svgObject.appendChild(o),r.setAttribute("style","clip-path:url(#"+o.id+"); -webkit-clip-path:url(#"+o.id+");"),this.doAnimation(a,i)}},t.prototype.getModuleName=function(){return"PieSeries"},t.prototype.destroy=function(){},t}(at),dt=function(){function e(e){this.control=e}return e.prototype.print=function(e){this.printWindow=window.open("","print","height="+window.outerHeight+",width="+window.outerWidth+",tabbar=no"),this.printWindow.moveTo(0,0),this.printWindow.resizeTo(screen.availWidth,screen.availHeight);var t={cancel:!1,htmlContent:this.getHTMLContent(e),name:"beforePrint"};this.control.trigger("beforePrint",t),t.cancel||sf.base.print(t.htmlContent,this.printWindow)},e.prototype.getHTMLContent=function(e){var t=sf.base.createElement("div");if(e)if(e instanceof Array)for(var i=0;i<e.length;i++){var r=e[i];t.appendChild(re(r).cloneNode(!0))}else e instanceof Element?t.appendChild(e.cloneNode(!0)):t.appendChild(re(e).cloneNode(!0));else t.appendChild(this.control.element.cloneNode(!0));return t},e.prototype.export=function(e,t,i,r,n,o,s,a,l){var h=this,d=this.getControlsValue(r,s);n=n||d.width,o=o||d.height;var c,p=this.control.svgObject,u=this.control.enableCanvas;u||(p=sf.base.createElement("canvas",{id:"ej2-canvas",attrs:{width:n.toString(),height:o.toString()}}));var g=!(sf.base.Browser.userAgent.toString().indexOf("HeadlessChrome")>-1);i=sf.base.isNullOrUndefined(i)?sf.pdfexport.PdfPageOrientation.Landscape:i;var f='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">'+d.svg.outerHTML+"</svg>",m=window.URL.createObjectURL(new Blob("SVG"===e?[f]:[(new XMLSerializer).serializeToString(d.svg)],{type:"image/svg+xml"}));if("SVG"===e)if("msie"===sf.base.Browser.info.name){var y=new Blob([(new XMLSerializer).serializeToString(d.svg)],{type:"application/octet-stream"});window.navigator.msSaveOrOpenBlob(y,t+"."+e.toLocaleLowerCase())}else this.triggerDownload(t,e,m,g);else if("msie"===sf.base.Browser.info.name){var v=p;u||(v=this.createCanvas()),c=v.toDataURL(),"PDF"===e?this.exportPdf(v,i,n,o,g,t,a,l):this.doexport(e,c,t)}else{var b=new Image,w=p.getContext("2d");b.onload=function(){w.drawImage(b,0,0),window.URL.revokeObjectURL(m),"PDF"===e?h.exportPdf(p,i,n,o,g,t,a,l):window.navigator.msSaveOrOpenBlob?window.navigator.msSaveOrOpenBlob(p.toBlob(null),t+"."+e.toLocaleLowerCase()):h.triggerDownload(t,e,p.toDataURL("image/"+e.toLowerCase()),g)},b.src=m}u||H(document.getElementById(this.control.element.id+"_canvas"))},e.prototype.getDataUrl=function(e){var t=this.getControlsValue([e]),i=this.control.svgObject,r=this.control.enableCanvas;r||(i=sf.base.createElement("canvas",{id:"ej2-canvas",attrs:{width:t.width.toString(),height:t.height.toString()}}));var n=window.URL.createObjectURL(new Blob([(new XMLSerializer).serializeToString(t.svg)],{type:"image/svg+xml"}));if("msie"===sf.base.Browser.info.name){var o=i;r||(o=this.createCanvas());var s={name:"afterExport",cancel:!1,dataUrl:i.toDataURL("image/png")};return e.trigger("afterExport",s),{element:o,dataUrl:o.toDataURL()}}var a=new Image,l=i.getContext("2d");return a.onload=function(){l.drawImage(a,0,0),window.URL.revokeObjectURL(n);var t={name:"afterExport",cancel:!1,dataUrl:i.toDataURL("image/png")};return e.trigger("afterExport",t),t.dataUrl},a.src=n,{element:i,blobUrl:n}},e.prototype.triggerDownload=function(e,t,i,r){sf.base.createElement("a",{attrs:{download:e+"."+t.toLocaleLowerCase(),href:i}}).dispatchEvent(new MouseEvent(r?"click":"move",{view:window,bubbles:!1,cancelable:!0}))},e.prototype.getControlsValue=function(e,t){var i=0,r=0,n=this.control.enableCanvas,o=new sf.svgbase.SvgRenderer("").createSvg({id:"Svg_Export_Element",width:200,height:200});return e.map((function(e){var s=e.svgObject.cloneNode(!0),a=e.renderer.createGroup({style:sf.base.isNullOrUndefined(t)||t?"transform: translateY("+r+"px)":"transform: translateX("+i+"px)"}),l=s.childNodes[0].getAttribute("fill");"Tailwind"!==e.theme&&"TailwindDark"!==e.theme||"rgba(255,255,255, 0.0)"!==l&&"transparent"!==l||s.childNodes[0].setAttribute("fill","rgba(255,255,255, 1)"),n||a.appendChild(s);var h=0,d=0;e.stockLegendModule&&e.legendSettings.visible&&("Bottom"===e.legendSettings.position||"Top"===e.legendSettings.position||"Auto"===e.legendSettings.position?h+=e.stockLegendModule.legendBounds.height:"Left"!==e.legendSettings.position&&"Right"!==e.legendSettings.position||(d+=e.stockLegendModule.legendBounds.width)),i=sf.base.isNullOrUndefined(t)||t?Math.max(e.availableSize.width+d,i):i+e.availableSize.width+d,r=sf.base.isNullOrUndefined(t)||t?r+e.availableSize.height+h:Math.max(e.availableSize.height+h,r),n||o.appendChild(a)})),n||(o.setAttribute("width",i+""),o.setAttribute("height",r+"")),{width:i,height:r,svg:o}},e.prototype.createCanvas=function(){var e=this.control;this.canvasRender(!0,e);var t=e.svgObject;return this.canvasRender(!1,e),t},e.prototype.canvasRender=function(e,t){t.enableCanvas=e,t.preRender(),t.render()},e.prototype.exportPdf=function(e,t,i,r,n,o,s,a){var l=new sf.pdfexport.PdfDocument,h=l.pageSettings.margins,d=l.pageSettings.width,c=l.pageSettings.height,p=e.toDataURL("image/jpeg").replace("image/jpeg","image/octet-stream");l.pageSettings.orientation=t;var u=d<i?i+h.left+h.right:d,g=c<r?r+h.top+h.bottom:c;if(void 0!==s){var f=new sf.pdfexport.PdfStandardFont(1,s.fontSize||15),m=new sf.pdfexport.PdfPageTemplateElement(u,40);m.graphics.drawString(s.content+"",f,null,new sf.pdfexport.PdfSolidBrush(new sf.pdfexport.PdfColor(0,0,0)),s.x,s.y,null),l.template.top=m}if(void 0!==a){f=new sf.pdfexport.PdfStandardFont(1,a.fontSize||15);var y=new sf.pdfexport.PdfPageTemplateElement(u,40);y.graphics.drawString(a.content+"",f,null,new sf.pdfexport.PdfSolidBrush(new sf.pdfexport.PdfColor(0,0,0)),a.x,a.y,null),l.template.bottom=y}l.pageSettings.size=new sf.pdfexport.SizeF(u,g),p=p.slice(p.indexOf(",")+1),l.pages.add().graphics.drawImage(new sf.pdfexport.PdfBitmap(p),0,0,i,r),n&&(l.save(o+".pdf"),l.destroy())},e.prototype.doexport=function(e,t,i){var r,n=e||"JPG";r=[t],this.exportImage(r,i,n,t)},e.prototype.exportImage=function(e,t,i,r){for(var n=[],o=e instanceof HTMLElement?0:e.length,s=0;s<o;s++){for(var a=e[s].replace(/^data:[a-z]*;,/,"").split(","),l=atob(a[1]),h=new ArrayBuffer(l.length),d=new Uint8Array(h),c=0;c<l.length;c++)d[c]=l.charCodeAt(c);n.push(h)}for(var p=0;p<n.length;p++){var u=new Blob([n[p]],{type:"application/octet-stream"});"msie"===sf.base.Browser.info.name&&window.navigator.msSaveOrOpenBlob(u,t+"."+i.toLocaleLowerCase())}},e}(),ct=(Be=function(e,t){return(Be=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}Be(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),pt=function(e,t,r,n){var o,s=arguments.length,a=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(s<3?o(a):s>3?o(t,r,a):o(t,r))||a);return s>3&&a&&Object.defineProperty(t,r,a),a},ut=function(e){function i(t,i){var r=e.call(this,t,i)||this;return r.animateselected=!1,r.explodeDistance=0,r.chartid=57724,r}return ct(i,e),i.prototype.animate=function(e){this.duration=e||700,this.animateselected=!0,this.animateSeries=!1;var t=0,i=[],r=[],n=[],o=this.visibleSeries[0],s=[];if(s=o.dataSource,o.sumOfPoints=0,o.points.length<Object.keys(o.dataSource).length)this.refresh();else if(o.points.length>Object.keys(o.dataSource).length){var a=this.visibleSeries[0];a.points=a.points.filter((function(e){return e.visible=!1,r.push(e.index),i.push(e.color),s.some((function(i){var r=i;return e.x===r.x&&(e.visible=!0,n.push(e.index),e.index=t,t++),e.x===r.x}))}));for(var l=r.filter((function(e){return n.indexOf(e)<0})),h=r.length-l.length,d=r.length-1;d>=h;d--)H("container_Series_0_Point_"+r[d]);for(d=0;d<a.points.length;d++)a.points[d].y=a.dataSource[d].y,a.points[d].color=i[d],a.sumOfPoints+=a.dataSource[d].y;this.redraw=this.enableAnimation,this.animateSeries=!1,this.calculateBounds(),this.renderElements()}else{for(d=0;d<o.points.length;d++)o.points[d].y=o.dataSource[d][o.yName],o.points[d].color=null!=o.dataSource[d][o.pointColorMapping]?o.dataSource[d][o.pointColorMapping]:o.points[d].color,o.sumOfPoints+=o.dataSource[d][o.yName];this.redraw=this.enableAnimation,this.animateSeries=!1,this.removeSvg(),this.refreshPoints(o.points),this.renderElements()}},Object.defineProperty(i.prototype,"type",{get:function(){return this.series&&this.series.length?this.series[0].type:"Pie"},enumerable:!0,configurable:!0}),i.prototype.preRender=function(){if(this.isBlazor=window.Blazor,this.allowServerDataBinding=!1,this.unWireEvents(),this.setCulture(),this.animateSeries=!0,""===this.element.id){var e=document.getElementsByClassName("e-accumulationchart").length;this.element.id="acc_chart_"+this.chartid+"_"+e}ye(this),this.wireEvents()},i.prototype.setTheme=function(){/*! Set theme for accumulation chart */this.themeStyle=function(e){var t,i="MaterialDark"===e?"#383838":"FabricDark"===e?"#242424":"#1b1b1b";switch(e){case"HighContrastLight":case"Highcontrast":case"HighContrast":t={axisLabel:"#ffffff",axisTitle:"#ffffff",axisLine:"#ffffff",majorGridLine:"#BFBFBF",minorGridLine:"#969696",majorTickLine:"#BFBFBF",minorTickLine:"#969696",chartTitle:"#ffffff",legendLabel:"#ffffff",background:"#000000",areaBorder:"#ffffff",errorBar:"#ffffff",crosshairLine:"#ffffff",crosshairFill:"#ffffff",crosshairLabel:"#000000",tooltipFill:"#ffffff",tooltipBoldLabel:"#000000",tooltipLightLabel:"#000000",tooltipHeaderLine:"#969696",markerShadow:"#BFBFBF",selectionRectFill:"rgba(255, 217, 57, 0.3)",selectionRectStroke:"#ffffff",selectionCircleStroke:"#FFD939"};break;case"MaterialDark":case"FabricDark":case"BootstrapDark":t={axisLabel:"#DADADA",axisTitle:"#ffffff",axisLine:" #6F6C6C",majorGridLine:"#414040",minorGridLine:"#514F4F",majorTickLine:"#414040",minorTickLine:" #4A4848",chartTitle:"#ffffff",legendLabel:"#DADADA",background:i,areaBorder:" #9A9A9A",errorBar:"#ffffff",crosshairLine:"#F4F4F4",crosshairFill:"#F4F4F4",crosshairLabel:"#282727",tooltipFill:"#F4F4F4",tooltipBoldLabel:"#282727",tooltipLightLabel:"#333232",tooltipHeaderLine:"#9A9A9A",markerShadow:null,selectionRectFill:"rgba(56,169,255, 0.1)",selectionRectStroke:"#38A9FF",selectionCircleStroke:"#282727"};break;case"Bootstrap4":t={axisLabel:"#212529",axisTitle:"#212529",axisLine:"#CED4DA",majorGridLine:"#CED4DA",minorGridLine:"#DEE2E6",majorTickLine:"#ADB5BD",minorTickLine:"#CED4DA",chartTitle:"#212529",legendLabel:"#212529",background:"#FFFFFF",areaBorder:"#DEE2E6",errorBar:"#000000",crosshairLine:"#6C757D",crosshairFill:"#495057",crosshairLabel:"#FFFFFF",tooltipFill:"rgba(0, 0, 0, 0.9)",tooltipBoldLabel:"rgba(255,255,255)",tooltipLightLabel:"rgba(255,255,255, 0.9)",tooltipHeaderLine:"rgba(255,255,255, 0.2)",markerShadow:null,selectionRectFill:"rgba(255,255,255, 0.1)",selectionRectStroke:"rgba(0, 123, 255)",selectionCircleStroke:"#495057"};break;case"Tailwind":t={axisLabel:"#6B728",axisTitle:"#374151",axisLine:" #D1D5DB",majorGridLine:"#E5E7EB",minorGridLine:"#E5E7EB",majorTickLine:"#D1D5DB",minorTickLine:" #D1D5DB",chartTitle:"#374151",legendLabel:"#374151",background:"rgba(255,255,255, 0.0)",areaBorder:" #E5E7EB",errorBar:"#374151",crosshairLine:"#1F2937",crosshairFill:"#111827",crosshairLabel:"#F9FAFB",tooltipFill:"#111827",tooltipBoldLabel:"#D1D5DB",tooltipLightLabel:"#F9FAFB",tooltipHeaderLine:"#6B7280",markerShadow:null,selectionRectFill:"rgba(79,70,229, 0.1)",selectionRectStroke:"#4F46E5",selectionCircleStroke:"#6B7280"};break;case"TailwindDark":t={axisLabel:"#9CA3AF",axisTitle:"#9CA3AF",axisLine:" #4B5563",majorGridLine:"#374151",minorGridLine:"#374151",majorTickLine:"#4B5563",minorTickLine:" #4B5563",chartTitle:"#D1D5DB",legendLabel:"#D1D5DB",background:"#1f2937",areaBorder:" #374151",errorBar:"#ffffff",crosshairLine:"#9CA3AF",crosshairFill:"#F9FAFB",crosshairLabel:"#1F2937",tooltipFill:"#F9FAFB",tooltipBoldLabel:"#6B7280",tooltipLightLabel:"#1F2937",tooltipHeaderLine:"#9CA3AF",markerShadow:null,selectionRectFill:"rgba(34,211,238, 0.1)",selectionRectStroke:"#22D3EE",selectionCircleStroke:"#282727"};break;case"Bootstrap5":t={axisLabel:"#495057",axisTitle:"#343A40",axisLine:"#D1D5DB",majorGridLine:"#E5E7EB",minorGridLine:"#E5E7EB",majorTickLine:"#D1D5DB",minorTickLine:" #D1D5DB",chartTitle:"#343A40",legendLabel:"#343A40",background:"#FFFFFF",areaBorder:" #DEE2E6",errorBar:"#1F2937",crosshairLine:"#1F2937",crosshairFill:"#212529",crosshairLabel:"#F9FAFB",tooltipFill:"#212529",tooltipBoldLabel:"#D1D5DB",tooltipLightLabel:"#F9FAFB",tooltipHeaderLine:"#6B7280",markerShadow:null,selectionRectFill:"rgba(79,70,229, 0.1)",selectionRectStroke:"#4F46E5",selectionCircleStroke:"#6B7280"};break;case"Bootstrap5Dark":t={axisLabel:"#CED4DA",axisTitle:"#E9ECEF",axisLine:"#495057",majorGridLine:"#343A40",minorGridLine:"#343A40",majorTickLine:"#495057",minorTickLine:" #495057",chartTitle:"#E9ECEF",legendLabel:"#E9ECEF",background:"#212529",areaBorder:" #444C54",errorBar:"#ADB5BD",crosshairLine:"#ADB5BD",crosshairFill:"#E9ECEF",crosshairLabel:"#212529",tooltipFill:"#E9ECEF",tooltipBoldLabel:"#D1D5DB",tooltipLightLabel:"#F9FAFB",tooltipHeaderLine:"#6B7280",markerShadow:null,selectionRectFill:"rgba(79,70,229, 0.1)",selectionRectStroke:"#4F46E5",selectionCircleStroke:"#6B7280"};break;case"Fluent":t={axisLabel:"#3B3A39",axisTitle:"#201F1E",axisLine:"#D2D0CE",majorGridLine:"#EDEBE9",minorGridLine:"#EDEBE9",majorTickLine:"#D2D0CE",minorTickLine:" #D2D0CE",chartTitle:"#201F1E",legendLabel:"#323130",background:"rgba(255, 255, 255, 0.0001)",areaBorder:"#EDEBE9",errorBar:"#A19F9D",crosshairLine:"#A19F9D",crosshairFill:"#FFFFFF",crosshairLabel:"#323130",tooltipFill:"#FFFFFF",tooltipBoldLabel:"#323130",tooltipLightLabel:"#323130",tooltipHeaderLine:"#D2D0CE",markerShadow:null,selectionRectFill:"rgba(79,70,229, 0.1)",selectionRectStroke:"#4F46E5",selectionCircleStroke:"#6B7280"};break;case"FluentDark":t={axisLabel:"#C8C6C4",axisTitle:"#F3F2F1",axisLine:"#3B3A39",majorGridLine:"#292827",minorGridLine:"#292827",majorTickLine:"#3B3A39",minorTickLine:"#3B3A39",chartTitle:"#F3F2F1",legendLabel:"#D2D0CE",background:"transparent",areaBorder:"#292827",errorBar:"#797775",crosshairLine:"#797775",crosshairFill:"#252423",crosshairLabel:"#F3F2F1",tooltipFill:"#252423",tooltipBoldLabel:"#F3F2F1",tooltipLightLabel:"#F3F2F1",tooltipHeaderLine:"#3B3A39",markerShadow:null,selectionRectFill:"rgba(79,70,229, 0.1)",selectionRectStroke:"#4F46E5",selectionCircleStroke:"#6B7280"};break;default:t={axisLabel:"#686868",axisTitle:"#424242",axisLine:"#b5b5b5",majorGridLine:"#dbdbdb",minorGridLine:"#eaeaea",majorTickLine:"#b5b5b5",minorTickLine:"#d6d6d6",chartTitle:"#424242",legendLabel:"#353535",background:"#FFFFFF",areaBorder:"Gray",errorBar:"#000000",crosshairLine:"#4f4f4f",crosshairFill:"#4f4f4f",crosshairLabel:"#e5e5e5",tooltipFill:"rgba(0, 8, 22, 0.75)",tooltipBoldLabel:"#ffffff",tooltipLightLabel:"#dbdbdb",tooltipHeaderLine:"#ffffff",markerShadow:null,selectionRectFill:"rgba(41, 171, 226, 0.1)",selectionRectStroke:"#29abe2",selectionCircleStroke:"#29abe2"}}return t}(this.theme)},i.prototype.render=function(){var e=this;-1===this.element.className.indexOf("e-accumulationchart")&&this.element.classList.add("e-accumulationchart");var t={chart:this.isBlazor?{}:this,accumulation:this.isBlazor?{}:this,theme:this.theme,name:"load",cancel:!1};this.trigger("load",t,(function(){e.theme=e.isBlazor?t.theme:e.theme,e.setTheme(),e.accBaseModule=new ot(e),e.pieSeriesModule=new ht(e),e.calculateVisibleSeries(),e.processData(),e.renderComplete(),e.allowServerDataBinding=!0}))},i.prototype.unWireEvents=function(){/*! Find the Events type */var e=sf.base.Browser.isPointer,t=sf.base.Browser.touchStartEvent,i=sf.base.Browser.touchMoveEvent,r=sf.base.Browser.touchEndEvent,n=e?"pointerleave":"mouseleave";/*! UnBind the Event handler */sf.base.EventHandler.remove(this.element,i,this.accumulationMouseMove),sf.base.EventHandler.remove(this.element,r,this.accumulationMouseEnd),sf.base.EventHandler.remove(this.element,t,this.accumulationMouseStart),sf.base.EventHandler.remove(this.element,"click",this.accumulationOnMouseClick),sf.base.EventHandler.remove(this.element,"contextmenu",this.accumulationRightClick),sf.base.EventHandler.remove(this.element,n,this.accumulationMouseLeave),window.removeEventListener(sf.base.Browser.isTouch&&"orientation"in window&&"onorientationchange"in window?"orientationchange":"resize",this.accumulationResizeBound)},i.prototype.wireEvents=function(){if(this.element){/*! Find the Events type */var e=sf.base.Browser.isPointer,t=sf.base.Browser.touchStartEvent,i=sf.base.Browser.touchEndEvent,r=sf.base.Browser.touchMoveEvent,n=e?"pointerleave":"mouseleave";/*! Bind the Event handler */sf.base.EventHandler.add(this.element,r,this.accumulationMouseMove,this),sf.base.EventHandler.add(this.element,i,this.accumulationMouseEnd,this),sf.base.EventHandler.add(this.element,t,this.accumulationMouseStart,this),sf.base.EventHandler.add(this.element,"click",this.accumulationOnMouseClick,this),sf.base.EventHandler.add(this.element,"contextmenu",this.accumulationRightClick,this),sf.base.EventHandler.add(this.element,n,this.accumulationMouseLeave,this),this.accumulationResizeBound=this.accumulationResize.bind(this),window.addEventListener(sf.base.Browser.isTouch&&"orientation"in window&&"onorientationchange"in window?"orientationchange":"resize",this.accumulationResizeBound),new sf.base.Touch(this.element),
/*! Apply the style for chart */this.setStyle(this.element)}},i.prototype.setMouseXY=function(e){var t,i,r=re(this.element.id+"_svg");if(r&&this.element){var n=r.getBoundingClientRect(),o=this.element.getBoundingClientRect();if(e.type.indexOf("touch")>-1){this.isTouch=!0;var s=e;i=s.changedTouches[0].clientY,t=s.changedTouches[0].clientX}else this.isTouch="touch"===e.pointerType||"2"===e.pointerType,t=e.clientX,i=e.clientY;this.mouseY=i-o.top-Math.max(n.top-o.top,0),this.mouseX=t-o.left-Math.max(n.left-o.left,0)}},i.prototype.accumulationMouseEnd=function(e){return this.setMouseXY(e),this.trigger("chartMouseUp",{target:e.target.id,x:this.mouseX,y:this.mouseY}),this.isTouch&&(this.titleTooltip(e,this.mouseX,this.mouseY,this.isTouch),this.accumulationDataLabelModule&&this.visibleSeries[0].dataLabel.visible&&this.accumulationDataLabelModule.move(e,this.mouseX,this.mouseY,this.isTouch),this.accumulationLegendModule&&this.legendSettings.visible&&this.accumulationLegendModule.move(e)),this.notify(sf.base.Browser.touchEndEvent,e),!1},i.prototype.accumulationMouseStart=function(e){return this.setMouseXY(e),this.trigger("chartMouseDown",{target:e.target.id,x:this.mouseX,y:this.mouseY}),!1},i.prototype.accumulationResize=function(){var e=this;this.animateSeries=!1;var t={accumulation:this.isBlazor?{}:this,previousSize:new sf.svgbase.Size(this.availableSize.width,this.availableSize.height),name:"resized",currentSize:new sf.svgbase.Size(0,0),chart:this.isBlazor?{}:this},i={name:"beforeResize",cancelResizedEvent:!1};return this.resizeTo&&clearTimeout(this.resizeTo),this.trigger("beforeResize",i),i.cancelResizedEvent||(this.resizeTo=+setTimeout((function(){e.isDestroyed?clearTimeout(e.resizeTo):(ye(e),t.currentSize=e.availableSize,e.trigger("resized",t),e.refreshSeries(),e.refreshChart())}),500)),!1},i.prototype.print=function(e){var t=document.getElementById(this.element.id+"_Series_0").style.clipPath;document.getElementById(this.element.id+"_Series_0").style.clipPath="",new dt(this).print(e),document.getElementById(this.element.id+"_Series_0").style.clipPath=t},i.prototype.export=function(e,t){this.exportModule&&(this.exportModule.export(e,t),this.afterExport&&this.exportModule.getDataUrl(this))},i.prototype.setStyle=function(e){e.style.touchAction="element",e.style.msTouchAction="element",e.style.msContentZooming="none",e.style.msUserSelect="none",e.style.webkitUserSelect="none",e.style.position="relative",e.style.display="block"},i.prototype.setAnnotationValue=function(e,t){var i,r=this.annotations[e],n=re(this.element.id+"_Annotation_Collections");t&&(r.content=t,n?(i=this.createElement("div"),H(this.element.id+"_Annotation_"+e),this.annotationModule.processAnnotation(r,e,i),n.appendChild(i.children[0])):this.annotationModule.renderAnnotations(re(this.element.id+"_Secondary_Element")))},i.prototype.accumulationMouseMove=function(e){return!!re(this.element.id+"_svg")&&(this.setMouseXY(e),this.trigger("chartMouseMove",{target:e.target.id,x:this.mouseX,y:this.mouseY}),this.pointMove&&this.triggerPointEvent("pointMove",e.target,e),this.accumulationLegendModule&&this.legendSettings.visible&&this.accumulationLegendModule.move(e),this.accumulationDataLabelModule&&this.visibleSeries[0]&&this.visibleSeries[0].dataLabel.visible&&this.accumulationDataLabelModule.move(e,this.mouseX,this.mouseY),this.isTouch||this.titleTooltip(e,this.mouseX,this.mouseY),this.enableBorderOnMouseMove&&"Pie"===this.type&&this.pieSeriesModule&&X(this.mouseX,this.mouseY,this.initialClipRect)&&this.pieSeriesModule.findSeries(e),this.notify(sf.base.Browser.touchMoveEvent,e),!1)},i.prototype.titleTooltip=function(e,t,i,r){var n=e.target.id,o=n===this.element.id+"_title"||n===this.element.id+"_subTitle"||n===this.element.id+"_chart_legend_title";e.target.textContent.indexOf("...")>-1&&o?_(n===this.element.id+"_title"?this.title:n===this.element.id+"_subTitle"?this.subTitle:this.legendSettings.title,t,i,this.element.offsetWidth,this.element.id+"_EJ2_Title_Tooltip",re(this.element.id+"_Secondary_Element"),r):H(this.element.id+"_EJ2_Title_Tooltip")},i.prototype.accumulationOnMouseClick=function(e){return this.setMouseXY(e),this.accumulationLegendModule&&this.legendSettings.visible&&this.accumulationLegendModule.click(e),"None"!==this.selectionMode&&this.accumulationSelectionModule&&this.accumulationSelectionModule.calculateSelectedElements(this,e),this.visibleSeries[0].explode&&this.accBaseModule.processExplode(e),this.enableBorderOnMouseMove&&this.pieSeriesModule&&"Pie"===this.type&&this.pieSeriesModule.findSeries(e),this.trigger("chartMouseClick",{target:e.target.id,x:this.mouseX,y:this.mouseY}),this.pointClick&&this.triggerPointEvent("pointClick",e.target,e),!1},i.prototype.triggerPointEvent=function(e,t,i){var r=i,n=G(t.id,!0);n.series>=0&&n.point>=0&&this.trigger(e,{series:this.isBlazor?{}:this.series[n.series],point:this.series[n.series].points[n.point],seriesIndex:n.series,pointIndex:n.point,x:this.mouseX,y:this.mouseY,pageX:r.pageX,pageY:r.pageY})},i.prototype.accumulationRightClick=function(e){return 2!==e.buttons&&"touch"!==e.pointerType||(e.preventDefault(),e.stopPropagation(),!1)},i.prototype.accumulationMouseLeave=function(e){this.setMouseXY(e),this.trigger("chartMouseLeave",{target:e.target.id,x:this.mouseX,y:this.mouseY}),this.notify(sf.base.Browser.isPointer?"pointerleave":"mouseleave",e);var t=document.getElementById(this.element.id+"PointHover_Border");return t&&(this.pieSeriesModule.removeBorder(t,1e3),t=null),!1},i.prototype.setCulture=function(){this.intl=new sf.base.Internationalization},i.prototype.createPieSvg=function(){var e;this.removeSvg(),(e=this).canvasRender=new sf.svgbase.CanvasRenderer(e.element.id),e.renderer=e.enableCanvas?e.canvasRender:new sf.svgbase.SvgRenderer(e.element.id),ye(e),e.stockChart&&"chart"===e.getModuleName()?e.svgObject=e.stockChart.chartObject:e.stockChart&&"rangeNavigator"===e.getModuleName()?e.svgObject=e.stockChart.selectorObject:e.enableCanvas?e.svgObject=e.renderer.createCanvas({id:e.element.id+"_canvas",width:e.availableSize.width,height:e.availableSize.height}):e.svgObject=e.renderer.createSvg({id:e.element.id+"_svg",width:e.availableSize.width,height:e.availableSize.height})},i.prototype.removeSvg=function(){if(this.redraw)return null;if(xe(this),H(this.element.id+"_Secondary_Element"),this.svgObject){for(;this.svgObject.childNodes.length>0;)this.svgObject.removeChild(this.svgObject.firstChild);!this.svgObject.hasChildNodes()&&this.svgObject.parentNode&&sf.base.remove(this.svgObject)}H("EJ2_legend_tooltip"),H("EJ2_datalabel_tooltip"),H(this.element.id+"PointHover_Border")},i.prototype.createSecondaryElement=function(){var e=fe(this.redraw,this.element.id+"_Secondary_Element")||this.createElement("div",{id:this.element.id+"_Secondary_Element",styles:"position: relative"});he(!1,this.element,e,this.redraw)},i.prototype.calculateVisibleSeries=function(){this.visibleSeries=[];for(var e=0,t=this.series.length;e<t;e++)if(this.series[e].index=e,this.series[e].type===this.type&&0===this.visibleSeries.length){this.visibleSeries.push(this.series[e]);break}},i.prototype.processData=function(e){void 0===e&&(e=!0),this.seriesCounts=0;for(var t=0,i=this.visibleSeries;t<i.length;t++){var r=i[t];r.dataModule=new nt(r.dataSource||this.dataSource,r.query),r.refreshDataManager(this,e)}},i.prototype.refreshChart=function(){this.doGrouppingProcess(),this.createPieSvg(),this.calculateBounds(),this.renderElements(),H("chartmeasuretext")},i.prototype.doGrouppingProcess=function(){var e=this.visibleSeries[0];sf.base.isNullOrUndefined(e.resultData)||sf.base.isNullOrUndefined(e.lastGroupTo)||e.lastGroupTo===e.groupTo||e.getPoints(e.resultData,this)},i.prototype.calculateBounds=function(){this.initialClipRect=new sf.svgbase.Rect(this.margin.left,this.margin.top,this.availableSize.width,this.availableSize.height),this.titleCollection=[],this.subTitleCollection=[];var e,t,i=0,r=0,n=0,o=0;if(this.titleCollection=ve(this.title,this.titleStyle,this.initialClipRect.width),i=this.title?sf.svgbase.measureText(this.title,this.titleStyle).height*this.titleCollection.length:i,this.subTitle){for(var s=0,a=this.titleCollection;s<a.length;s++){var l=a[s];n=(o=sf.svgbase.measureText(l,this.titleStyle).width)>n?o:n}this.subTitleCollection=ve(this.subTitle,this.subTitleStyle,n),r=sf.svgbase.measureText(this.subTitle,this.subTitleStyle).height*this.subTitleCollection.length}e=this.initialClipRect,t=new sf.svgbase.Rect(0,r+i,this.margin.right+this.margin.left,this.margin.bottom+this.margin.top),e.x+=t.x,e.y+=t.y,e.width-=t.x+t.width,e.height-=t.y+t.height,this.calculateLegendBounds()},i.prototype.calculateLegendBounds=function(){if(!this.accumulationLegendModule||!this.legendSettings.visible)return null;this.accumulationLegendModule.getLegendOptions(this,this.visibleSeries),this.accumulationLegendModule.calculateLegendBounds(this.initialClipRect,this.availableSize,null)},i.prototype.renderElements=function(){this.renderBorder(),this.createSecondaryElement(),this.renderSeries(),this.renderTitle(),this.renderLegend(),he(!1,this.element,this.svgObject,this.redraw),this.processSelection(),this.processExplode(),this.renderAnnotation(),this.setSecondaryElementPosition(),sf.base.updateBlazorTemplate(this.element.id+"_DataLabel","Template",this.series[0].dataLabel),this.trigger("loaded",{accumulation:this.isBlazor?{}:this,chart:this.isBlazor?{}:this}),this.animateSeries=!1},i.prototype.setSecondaryElementPosition=function(){var e=re(this.element.id+"_Secondary_Element");if(e){var t=this.element.getBoundingClientRect(),i=re(this.element.id+"_svg").getBoundingClientRect();e.style.left=Math.max(i.left-t.left,0)+"px",e.style.top=Math.max(i.top-t.top,0)+"px"}},i.prototype.renderAnnotation=function(){this.annotationModule&&this.annotationModule.renderAnnotations(re(this.element.id+"_Secondary_Element"))},i.prototype.processExplode=function(){return this.redraw?null:this.visibleSeries[0].explode?void this.accBaseModule.invokeExplode():null},i.prototype.renderSeries=function(){this.redraw||this.svgObject.appendChild(this.renderer.createGroup({id:this.element.id+"_SeriesCollection"}));for(var e=0,t=this.visibleSeries;e<t.length;e++){var i=t[e];i.visible&&this[Z(i.type)+"SeriesModule"]&&(this[Z(i.type)+"SeriesModule"].initProperties(this,i),i.renderSeries(this,this.redraw))}},i.prototype.renderBorder=function(){var e=this.border.width;he(!1,this.svgObject,this.renderer.drawRectangle(new Ne(this.element.id+"_border",this.background||this.themeStyle.background,this.border,1,new sf.svgbase.Rect(e/2,e/2,this.availableSize.width-e,this.availableSize.height-e))),this.redraw);var t=this.backgroundImage;if(t){var i=new Ie(this.availableSize.height-e,this.availableSize.width-e,t,0,0,this.element.id+"_background","visible","none");he(!1,this.svgObject,this.renderer.drawImage(i),this.redraw)}},i.prototype.renderLegend=function(){if(!this.accumulationLegendModule||!this.legendSettings.visible)return null;this.accumulationLegendModule.legendCollections.length&&("Pie"===this.visibleSeries[0].type&&this.accumulationLegendModule.getSmartLegendLocation(this.visibleSeries[0].labelBound,this.accumulationLegendModule.legendBounds,this.margin),this.accumulationLegendModule.renderLegend(this,this.legendSettings,this.accumulationLegendModule.legendBounds,this.redraw))},i.prototype.processSelection=function(){if(!this.accumulationSelectionModule||"None"===this.selectionMode)return null;var e=sf.base.extend([],this.accumulationSelectionModule.selectedDataIndexes,null,!0);this.accumulationSelectionModule.invokeSelection(this),e.length>0&&(this.accumulationSelectionModule.selectedDataIndexes=e,this.accumulationSelectionModule.redrawSelection(this))},i.prototype.renderTitle=function(){var e=this.margin;if(!this.title)return null;var t=this.titleStyle.textAlignment,i="Near"===t?"start":"Far"===t?"end":"middle",r=sf.svgbase.measureText(this.title,this.titleStyle),n=new sf.svgbase.Rect(e.left,0,this.availableSize.width-e.left-e.right,0),o=new sf.svgbase.TextOption(this.element.id+"_title",be(n,this.titleStyle),this.margin.top+3*r.height/4,i,this.titleCollection,"","auto"),s=me(this.renderer,o,this.titleStyle,this.titleStyle.color||this.themeStyle.chartTitle,this.svgObject,!1,this.redraw);s&&s.setAttribute("aria-label",this.title),this.subTitle&&this.renderSubTitle(o)},i.prototype.renderSubTitle=function(e){for(var t=0,i=0,r=this.titleStyle.textAlignment,n=sf.svgbase.measureText(this.subTitle,this.subTitleStyle),o=0,s=this.titleCollection;o<s.length;o++){var a=s[o];t=(i=sf.svgbase.measureText(a,this.titleStyle).width)>t?i:t}var l=new sf.svgbase.Rect("Center"===r?e.x-t/2:"Far"===r?e.x-t:e.x,0,t,0),h=new sf.svgbase.TextOption(this.element.id+"_subTitle",be(l,this.subTitleStyle),e.y*e.text.length+3*n.height/4+10,function(e){return"Near"===e?"start":"Far"===e?"end":"middle"}(this.subTitleStyle.textAlignment),this.subTitleCollection,"","auto");me(this.renderer,h,this.subTitleStyle,this.subTitleStyle.color||this.themeStyle.chartTitle,this.svgObject,!1,this.redraw)},i.prototype.getSeriesElement=function(){return this.svgObject.getElementsByTagName("g")[0]},i.prototype.refreshSeries=function(){for(var e=0,t=this.visibleSeries;e<t.length;e++){var i=t[e];this.refreshPoints(i.points)}},i.prototype.refreshPoints=function(e){for(var t=0,i=e;t<i.length;t++){var r=i[t];r.labelPosition=null,r.labelRegion=null,r.labelVisible=!0}},i.prototype.getModuleName=function(){return"accumulationchart"},i.prototype.destroy=function(){this.element&&(this.unWireEvents(),e.prototype.destroy.call(this),this.element.classList.remove("e-accumulationchart"),this.removeSvg(),this.svgObject=null)},i.prototype.requiredModules=function(){var e=[];return e.push({member:this.type+"Series",args:[this]}),this.legendSettings.visible&&e.push({member:"AccumulationLegend",args:[this]}),this.findDatalabelVisibility()&&e.push({member:"AccumulationDataLabel",args:[this]}),this.tooltip.enable&&e.push({member:"AccumulationTooltip",args:[this]}),"None"!==this.selectionMode&&e.push({member:"AccumulationSelection",args:[this]}),(this.enableExport||this.allowExport)&&e.push({member:"Export",args:[this]}),this.annotations.some((function(e){return null!==e.content}))&&e.push({member:"Annotation",args:[this]}),e},i.prototype.findDatalabelVisibility=function(){for(var e=0,t=this.series;e<t.length;e++){if(t[e].dataLabel.visible)return!0}return!1},i.prototype.changeVisibleSeries=function(e,t){for(var i=0,r=e;i<r.length;i++){var n=r[i];if(t===n.index)return n}return null},i.prototype.getPersistData=function(){return""},i.prototype.onPropertyChanged=function(t,i){for(var r={refreshElements:!1,refreshBounds:!1},n=0,o=Object.keys(t);n<o.length;n++){switch(o[n]){case"theme":this.animateSeries=!0;break;case"title":case"subTitle":case"height":case"width":case"margin":r.refreshBounds=!0;break;case"titleStyle":t.titleStyle&&(t.titleStyle.size||t.titleStyle.textOverflow)?r.refreshBounds=!0:r.refreshElements=!0;break;case"subTitleStyle":t.subTitleStyle&&(t.subTitleStyle.size||t.subTitleStyle.textOverflow)?r.refreshBounds=!0:r.refreshElements=!0;break;case"legendSettings":r.refreshBounds=!0,r.refreshElements=!0;break;case"dataSource":this.processData(!1),r.refreshBounds=!0;break;case"series":if(!this.animateselected){for(var s=this.series.length,a=!1,l=void 0,h=void 0,d=0;d<s;d++)l=t.series[d],this.isBlazor&&(l.startAngle||l.endAngle||l.explodeOffset||l.neckHeight||l.neckWidth||l.radius||l.innerRadius||l.groupMode||l.emptyPointSettings)&&(h=!0),t.series[d]&&(t.series[d].dataSource||t.series[d].yName||t.series[d].xName||t.series[d].dataLabel||h)&&(sf.base.extend(this.changeVisibleSeries(this.visibleSeries,d),l,null,!0),a=!0),t.series[d]&&!sf.base.isNullOrUndefined(t.series[d].explodeIndex)&&t.series[d].explodeIndex>=0&&t.series[d].explodeIndex!==i.series[d].explodeIndex?(this.accBaseModule.explodePoints(t.series[d].explodeIndex,this),this.accBaseModule.deExplodeAll(t.series[d].explodeIndex,this.enableAnimation?300:0)):t.series[d].explodeIndex<0&&this.accBaseModule.deExplodeAll(t.series[d].explodeIndex,this.enableAnimation?300:0);a&&(this.processData(!1),r.refreshBounds=!0)}this.animateselected=!1,this.redraw=!1;break;case"locale":case"currencyCode":e.prototype.refresh.call(this);break;case"background":case"border":case"annotations":case"enableSmartLabels":r.refreshElements=!0;break;case"isMultiSelect":case"selectedDataIndexes":case"selectionMode":this.accumulationSelectionModule&&(sf.base.isNullOrUndefined(this.accumulationSelectionModule.selectedDataIndexes)?this.accumulationSelectionModule.invokeSelection(this):this.accumulationSelectionModule.redrawSelection(this))}}!r.refreshBounds&&r.refreshElements?(this.createPieSvg(),this.renderElements()):r.refreshBounds&&(this.refreshSeries(),this.createPieSvg(),this.calculateBounds(),this.renderElements())},pt([sf.base.Property(null)],i.prototype,"width",void 0),pt([sf.base.Property(null)],i.prototype,"height",void 0),pt([sf.base.Property(null)],i.prototype,"title",void 0),pt([sf.base.Property(null)],i.prototype,"backgroundImage",void 0),pt([sf.base.Complex({},Ee)],i.prototype,"center",void 0),pt([sf.base.Property("")],i.prototype,"dataSource",void 0),pt([sf.base.Complex(t.chartTitleFont,d)],i.prototype,"titleStyle",void 0),pt([sf.base.Property(null)],i.prototype,"subTitle",void 0),pt([sf.base.Complex(t.chartSubTitleFont,d)],i.prototype,"subTitleStyle",void 0),pt([sf.base.Complex({},tt)],i.prototype,"legendSettings",void 0),pt([sf.base.Complex({},v)],i.prototype,"tooltip",void 0),pt([sf.base.Property("None")],i.prototype,"selectionMode",void 0),pt([sf.base.Property("None")],i.prototype,"highLightMode",void 0),pt([sf.base.Property("None")],i.prototype,"selectionPattern",void 0),pt([sf.base.Property("None")],i.prototype,"highlightPattern",void 0),pt([sf.base.Property(!0)],i.prototype,"enableBorderOnMouseMove",void 0),pt([sf.base.Property(!1)],i.prototype,"isMultiSelect",void 0),pt([sf.base.Property(!0)],i.prototype,"enableAnimation",void 0),pt([sf.base.Collection([],f)],i.prototype,"selectedDataIndexes",void 0),pt([sf.base.Complex({},p)],i.prototype,"margin",void 0),pt([sf.base.Property(!0)],i.prototype,"enableSmartLabels",void 0),pt([sf.base.Complex({color:"#DDDDDD",width:0},c)],i.prototype,"border",void 0),pt([sf.base.Property(null)],i.prototype,"background",void 0),pt([sf.base.Collection([{}],ke)],i.prototype,"series",void 0),pt([sf.base.Collection([{}],Fe)],i.prototype,"annotations",void 0),pt([sf.base.Property("Material")],i.prototype,"theme",void 0),pt([sf.base.Property(!1)],i.prototype,"useGroupingSeparator",void 0),pt([sf.base.Property(!0)],i.prototype,"enableExport",void 0),pt([sf.base.Property(!1)],i.prototype,"allowExport",void 0),pt([sf.base.Event()],i.prototype,"loaded",void 0),pt([sf.base.Event()],i.prototype,"load",void 0),pt([sf.base.Event()],i.prototype,"seriesRender",void 0),pt([sf.base.Event()],i.prototype,"legendRender",void 0),pt([sf.base.Event()],i.prototype,"textRender",void 0),pt([sf.base.Event()],i.prototype,"tooltipRender",void 0),pt([sf.base.Event()],i.prototype,"pointRender",void 0),pt([sf.base.Event()],i.prototype,"annotationRender",void 0),pt([sf.base.Event()],i.prototype,"beforePrint",void 0),pt([sf.base.Event()],i.prototype,"chartMouseMove",void 0),pt([sf.base.Event()],i.prototype,"chartMouseClick",void 0),pt([sf.base.Event()],i.prototype,"pointClick",void 0),pt([sf.base.Event()],i.prototype,"pointMove",void 0),pt([sf.base.Event()],i.prototype,"animationComplete",void 0),pt([sf.base.Event()],i.prototype,"chartMouseDown",void 0),pt([sf.base.Event()],i.prototype,"chartMouseLeave",void 0),pt([sf.base.Event()],i.prototype,"chartMouseUp",void 0),pt([sf.base.Event()],i.prototype,"beforeResize",void 0),pt([sf.base.Event()],i.prototype,"resized",void 0),pt([sf.base.Event()],i.prototype,"afterExport",void 0),pt([sf.base.Property("USD")],i.prototype,"currencyCode",void 0),i=pt([sf.base.NotifyPropertyChanges],i)}(sf.base.Component),gt=(_e=function(e,t){return(_e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}_e(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),ft=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return gt(t,e),t.prototype.initProperties=function(e,t){var i=e.initialClipRect;t.triangleSize=new sf.svgbase.Size(ge(t.width,i.width),ge(t.height,i.height)),t.neckSize=new sf.svgbase.Size(ge(t.neckWidth,i.width),ge(t.neckHeight,i.height)),this.defaultLabelBound(t,t.dataLabel.visible,t.dataLabel.position,e),"30%"===t.explodeOffset&&(t.explodeOffset="25px"),e.explodeDistance=ge(t.explodeOffset,i.width);var r=t.points;this.initializeSizeRatio(r,t)},t.prototype.initializeSizeRatio=function(e,t,i){void 0===i&&(i=!1);for(var r=t.sumOfPoints,n=Math.min(Math.max(t.gapRatio,0),1),o=1/(r*(1+n/(1-n))),s=n/(e.length-1),a=0,l=e.length-1;l>=0;l--){var h=i?e.length-1-l:l;if(e[h].visible){var d=o*e[h].y;e[h].yRatio=a,e[h].heightRatio=d,a+=d+s}}},t.prototype.setLabelLocation=function(e,t,i){var r=i.length-1,n="Funnel"===e.type?i.length-2:i.length-1,o=(i[0].x+i[n].x)/2,s=(i[1].x+i[n-1].x)/2;t.region=new sf.svgbase.Rect(o,i[0].y,s-o,i[n].y-i[0].y),t.symbolLocation={x:t.region.x+t.region.width/2,y:t.region.y+t.region.height/2},t.labelOffset={x:t.symbolLocation.x-(i[0].x+i[r].x)/2,y:t.symbolLocation.y-(i[0].y+i[r].y)/2}},t.prototype.findPath=function(e){for(var t="M",i=0;i<e.length;i++)t+=e[i].x+" "+e[i].y,i!==e.length-1&&(t+=" L");return t},t.prototype.defaultLabelBound=function(e,t,i,r){var n=(r.initialClipRect.width-e.triangleSize.width)/2,o=(r.initialClipRect.height-e.triangleSize.height)/2,s=new sf.svgbase.Rect(n,o,e.triangleSize.width,e.triangleSize.height);e.labelBound=new sf.svgbase.Rect(s.x,s.y,s.width+s.x,s.height+s.y),e.accumulationBound=s,t&&"Outside"===i&&(e.labelBound=new sf.svgbase.Rect(1/0,1/0,-1/0,-1/0))},t}(ot),mt=(Ve=function(e,t){return(Ve=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}Ve(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),yt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return mt(t,e),t.prototype.getSegmentData=function(e,t,i){var r,n,o,s,a,l,h,d,c=t.triangleSize,p=(i.initialClipRect.width-t.triangleSize.width)/2+i.initialClipRect.x,u=i.initialClipRect.y+(i.initialClipRect.height-c.height)/2,g=e.yRatio*c.height,f=g+e.heightRatio*c.height,m=t.neckSize;r=m.width+(c.width-m.width)*((c.height-m.height-g)/(c.height-m.height)),s=(n=c.width/2-r/2)+r,r=f>c.height-m.height||c.height===m.height?m.width:m.width+(c.width-m.width)*((c.height-m.height-f)/(c.height-m.height)),a=(o=c.width/2-r/2)+r,g>=c.height-m.height?(n=o=l=c.width/2-m.width/2,s=a=h=c.width/2+m.width/2):f>c.height-m.height&&(h=a=(l=o=c.width/2-r/2)+r,d=c.height-m.height);var y={x:p+0+a,y:f+=u},v={x:p+0+o,y:f};(d+=u)&&(y={x:p+0+h,y:d},v={x:p+0+l,y:d});var b=[{x:p+0+n,y:g+=u},{x:p+0+s,y:g},y,{x:p+0+a,y:f},{x:p+0+o,y:f},v];return this.setLabelLocation(t,e,b),this.findPath(b)},t.prototype.renderPoint=function(e,t,i,r,n,o){if(!e.visible)return H(r.id),null;var s=this.getSegmentData(e,t,i);e.midAngle=0,r.d=s,he(!1,n,i.renderer.drawPath(r),o),e.isExplode&&i.accBaseModule.explodePoints(e.index,i,!0)},t.prototype.getModuleName=function(){return"FunnelSeries"},t.prototype.destroy=function(){},t}(ft),vt=(Ye=function(e,t){return(Ye=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}Ye(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),bt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return vt(t,e),t.prototype.getSegmentData=function(e,t,i){var r=t.triangleSize,n=i.initialClipRect.y+(i.initialClipRect.height-r.height)/2,o=(i.initialClipRect.width-t.triangleSize.width)/2+i.initialClipRect.x,s=e.yRatio,a=e.yRatio+e.heightRatio,l=.5*(1-e.yRatio),h=.5*(1-a);s+=n/r.height,a+=n/r.height;var d=[{x:o+0+l*r.width,y:s*r.height},{x:o+0+(1-l)*r.width,y:s*r.height},{x:o+0+(1-h)*r.width,y:a*r.height},{x:o+0+h*r.width,y:a*r.height}];return this.setLabelLocation(t,e,d),this.findPath(d)},t.prototype.initializeSizeRatio=function(t,i){"Linear"===i.pyramidMode?e.prototype.initializeSizeRatio.call(this,t,i,!0):this.calculateSurfaceSegments(i)},t.prototype.calculateSurfaceSegments=function(e){for(var t=e.points.length,i=e.sumOfPoints,r=[],n=[],o=Math.min(0,Math.max(e.gapRatio,1))/(t-1),s=this.getSurfaceHeight(0,i),a=0,l=0;l<t;l++)e.points[l].visible&&(r[l]=a,n[l]=this.getSurfaceHeight(a,Math.abs(e.points[l].y)),a+=n[l]+o*s);var h=1/(a-o*s);for(l=0;l<t;l++)e.points[l].visible&&(e.points[l].yRatio=h*r[l],e.points[l].heightRatio=h*n[l])},t.prototype.getSurfaceHeight=function(e,t){return this.solveQuadraticEquation(1,2*e,-t)},t.prototype.solveQuadraticEquation=function(e,t,i){var r,n,o=t*t-4*e*i;if(o>=0){var s=Math.sqrt(o);return r=(-t-s)/(2*e),n=(-t+s)/(2*e),Math.max(r,n)}return 0},t.prototype.renderPoint=function(e,t,i,r,n,o){if(!e.visible)return sf.svgbase.removeElement(r.id),null;r.d=this.getSegmentData(e,t,i),e.midAngle=0,he(!1,n,i.renderer.drawPath(r),o),e.isExplode&&i.accBaseModule.explodePoints(e.index,i,!0)},t.prototype.getModuleName=function(){return"PyramidSeries"},t.prototype.destroy=function(){},t}(ft),wt=(Qe=function(e,t){return(Qe=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}Qe(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),xt=function(e){function t(t){var i=e.call(this,t)||this;return i.library=i,i.titleRect=new sf.svgbase.Rect(0,t.margin.top,0,0),i}return wt(t,e),t.prototype.getLegendOptions=function(e,t){this.legendCollections=[];for(var i=0;i<1;i++){var r=t[i].type;"Pie"!==r&&"Doughnut"!==r||(r="0"!==t[i].innerRadius&&"0%"!==t[i].innerRadius?"Doughnut":"Pie");for(var n=0,o=t[i].points;n<o.length;n++){var s=o[n];sf.base.isNullOrUndefined(s.x)||sf.base.isNullOrUndefined(s.y)||this.legendCollections.push(new rt(s.x.toString(),s.color,t[i].legendShape,s.visible,r,s.legendImageUrl,null,null,s.index,t[i].index))}}},t.prototype.getLegendBounds=function(e,t,i){this.calculateLegendTitle(i,t),this.isTitle=!!i.title;var r=0,n=0,o=i.padding,s=i.titlePosition,a=0,l=this.arrowWidth,h=i.enablePages?0:this.arrowHeight;this.isVertical?r=i.width?0:e.width/100*5:n=i.height?0:e.height/100*5,t.width+=r,t.height+=n;var d,c,p=i.shapePadding,u=0,g=i.shapeWidth,f=0,m=0,y=[],v=0,b=0;this.maxItemHeight=Math.max(sf.svgbase.measureText("MeasureText",i.textStyle).height,i.shapeHeight);for(var w=!1,x=0,M=this.legendCollections;x<M.length;x++){var N=M[x];c={fill:N.fill,text:N.text,shape:N.shape,name:"legendRender",cancel:!1},this.chart.trigger("legendRender",c),N.render=!c.cancel,N.text=c.text.indexOf("&")>-1?this.convertHtmlEntities(c.text):c.text,N.fill=c.fill,N.shape=c.shape,N.textSize=sf.svgbase.measureText(N.text,i.textStyle),N.render&&""!==N.text&&(w=!0,b=g+p+N.textSize.width+o,this.isVertical?(v=++m*(this.maxItemHeight+o)+o+this.legendTitleSize.height+h,m*(this.maxItemHeight+o)+o+h>t.height&&(v=Math.max(v,m*(this.maxItemHeight+o)+o+h),f+=u,y.push(u),this.totalPages=Math.max(m,this.totalPages||1),u=0,m=1),u=Math.max(b,u)):(i.enablePages||(a=this.isTitle&&"Top"!==s?this.legendTitleSize.width+this.fivePixel:0,a+=l),f+=b,t.width<o+f+a&&(u=Math.max(u,f+o+a-b),0===m&&b!==f&&(m=1),f=b,v=++m*(this.maxItemHeight+o)+o+this.legendTitleSize.height)))}d="Top"===s?this.legendTitleSize.height:0,this.isVertical?(f+=u,this.isPaging=t.width<f+o,v=Math.max(v,(this.totalPages||1)*(this.maxItemHeight+o)+o+h),this.isPaging=this.isPaging&&this.totalPages>1,y[y.length-1]!==u&&y.push(u)):(this.isPaging=t.height<v,v=!i.enablePages&&this.isPaging?this.maxItemHeight+o+o+d:v,this.totalPages=this.totalRowCount=m,v=Math.max(v,this.maxItemHeight+o+o+d),this.isPaging||(f+=this.isTitle&&"Top"!==s?this.fivePixel+this.legendTitleSize.width+this.fivePixel:0)),this.maxColumns=0;var I=this.isVertical?this.getMaxColumn(y,t.width,o,f+o):Math.max(f+o,u);w?this.setBounds(I,v,i,t):this.setBounds(0,0,i,t)},t.prototype.convertHtmlEntities=function(e){var t=e.replace("&amp;","&").replace("&lt;","<").replace("&gt;",">").replace("&quot;",'"').replace("&nbsp;"," ").replace("&cent;","¢").replace("&pound;","£").replace("&yen;","¥").replace("&euro;","€").replace("&copy;","©").replace("&reg;","®");return t=t.replace("&#38;","&").replace("&#60;","<").replace("&#62;",">").replace("&#34;",'"').replace("&#160;"," ").replace("&#162;","¢").replace("&#163;","£").replace("&#165;","¥").replace("&#8364;","€").replace("&#169;","©").replace("&#174;","®")},t.prototype.getMaxColumn=function(e,t,i,r){var n=i;this.maxColumnWidth=Math.max.apply(null,e);for(var o=0,s=e;o<s.length;o++){s[o];if(n+=this.maxColumnWidth,this.maxColumns++,n+i>t){n-=this.maxColumnWidth,this.maxColumns--;break}}return this.isPaging=n<r&&this.totalPages>1,n===i&&(n=t),this.maxColumns=Math.max(1,this.maxColumns),this.maxWidth=n,n},t.prototype.getAvailWidth=function(e,t){return this.isVertical&&(t=this.maxWidth),t-(2*this.legend.padding+this.legend.shapeWidth+this.legend.shapePadding)},t.prototype.getRenderPoint=function(e,t,i,r,n,o,s){var a=this.legend.padding;if(this.isVertical)o===s||r.location.y+1.5*this.maxItemHeight+2*a>n.y+n.height?(e.location.x=r.location.x+(o===s?0:this.maxColumnWidth),e.location.y=t.y,this.pageXCollections.push(e.location.x-this.legend.shapeWidth/2-a),this.totalPages++):(e.location.x=r.location.x,e.location.y=r.location.y+this.maxItemHeight+a);else{var l=r.location.x+i+r.textSize.width;l+(e.textSize.width+i)>n.x+n.width+this.legend.shapeWidth/2?(e.location.y=o===s?r.location.y:r.location.y+this.maxItemHeight+a,e.location.x=t.x):(e.location.y=r.location.y,e.location.x=o===s?r.location.x:l),this.totalPages=this.totalRowCount}var h=this.getAvailWidth(e.location.x,this.legendBounds.width);e.text=ue(+h.toFixed(4),e.text,this.legend.textStyle)},t.prototype.getSmartLegendLocation=function(e,t,i){var r;switch(this.position){case"Left":r=(e.x-t.width-i.left)/2,t.x=e.x-t.width<i.left?t.x:e.x-t.width-r;break;case"Right":r=(this.chart.availableSize.width-i.right-(e.x+e.width+t.width))/2,t.x=e.x+e.width+t.width>this.chart.availableSize.width-i.right?t.x:e.x+e.width+r;break;case"Top":this.getTitleRect(this.chart),r=(e.y-t.height-(this.titleRect.y+this.titleRect.height))/2,t.y=e.y-t.height<i.top?t.y:e.y-t.height-r;break;case"Bottom":r=(this.chart.availableSize.height-i.bottom-(e.y+e.height+t.height))/2,t.y=e.y+e.height+t.height>this.chart.availableSize.height-i.bottom?t.y:e.y+e.height+r}},t.prototype.getTitleRect=function(e){if(!e.title)return null;var t=sf.svgbase.measureText(e.title,e.titleStyle);this.titleRect=new sf.svgbase.Rect(e.availableSize.width/2-t.width/2,e.margin.top,t.width,t.height)},t.prototype.legendByIndex=function(e,t){for(var i=0,r=t;i<r.length;i++){var n=r[i];if(n.pointIndex===e)return n}return null},t.prototype.click=function(e){var t=e.target.id,i=this.chart,r=[this.legendID+"_text_",this.legendID+"_shape_",this.legendID+"_shape_marker_"];if(this.chart.accumulationSelectionModule)sf.base.extend([],this.chart.accumulationSelectionModule.selectedDataIndexes,null,!0);this.chart.animateSeries=!1;for(var n=0,o=r;n<o.length;n++){var s=o[n];if(t.indexOf(s)>-1){var a=parseInt(t.split(s)[1],10);if(this.chart.legendSettings.toggleVisibility&&!isNaN(a)){var l=this.chart.visibleSeries[0],h=Re(a,l.points),d=this.legendByIndex(a,this.legendCollections);h.visible=!h.visible,d.visible=h.visible,l.sumOfPoints+=h.visible?h.y:-h.y,i.redraw=i.enableAnimation,this.sliceVisibility(a,h.visible),i.removeSvg(),xe(i),this.chart.refreshPoints(l.points),this.chart.renderElements()}else this.chart.accumulationSelectionModule&&!isNaN(a)&&this.chart.accumulationSelectionModule.legendSelection(this.chart,0,a)}}t.indexOf(this.legendID+"_pageup")>-1?this.changePage(e,!0):t.indexOf(this.legendID+"_pagedown")>-1&&this.changePage(e,!1),i.redraw=!1},t.prototype.sliceVisibility=function(e,t){var i=this.chart.element.id+"_Series_0_Point_";this.chart.visibleSeries[0].dataLabel.visible&&(i=this.chart.element.id+"_datalabel_Series_0_",this.sliceAnimate(re(i+"g_"+e),t))},t.prototype.sliceAnimate=function(e,t){if(!e)return null;new sf.base.Animation({}).animate(e,{duration:300,delay:0,name:t?"FadeIn":"FadeOut",end:function(e){e.element.style.visibility=t?"visible":"hidden"}})},t.prototype.getModuleName=function(){return"AccumulationLegend"},t.prototype.destroy=function(){},t}(it),Mt=(qe=function(e,t){return(qe=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}qe(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),Nt=function(e){function t(t){var i=e.call(this,t)||this;if(i.rightSideRenderingPoints=[],i.leftSideRenderingPoints=[],i.id=t.element.id+"_datalabel_Series_",t.title){var r=sf.svgbase.measureText(t.title,t.titleStyle);i.titleRect=new sf.svgbase.Rect(t.availableSize.width/2-r.width/2,t.margin.top,r.width,r.height)}return i}return Mt(t,e),t.prototype.getDataLabelPosition=function(e,t,i,r){var n=this.isCircular()?this.isVariousRadius()?this.accumulation.pieSeriesModule.getLabelRadius(this.accumulation.visibleSeries[0],e):this.accumulation.pieSeriesModule.labelRadius:this.getLabelDistance(e,t);this.getLabelRegion(e,t.position,i,n,this.marginValue),e.labelAngle=e.midAngle,e.labelPosition=t.position,this.accumulation.enableSmartLabels&&this.getSmartLabel(e,t,i,r)},t.prototype.getLabelRegion=function(e,t,i,r,n,o){void 0===o&&(o=0);var s=o||e.midAngle,a=Q(s,r,this.isCircular()?this.center:this.getLabelLocation(e,t));a.y="Inside"===t?a.y-i.height/2:a.y,a.x="Inside"===t?a.x-i.width/2:a.x,e.labelRegion=new sf.svgbase.Rect(a.x,a.y,i.width+2*n,i.height+2*n),"Outside"===t&&(e.labelRegion.y-=e.labelRegion.height/2,s>=90&&s<=270?e.labelRegion.x-=e.labelRegion.width+10:e.labelRegion.x+=10)},t.prototype.getSmartLabel=function(e,t,i,r){var n=this.isCircular(),o=n?this.radius:this.getLabelDistance(e,t);o+=ge(n?t.connectorStyle.length||"4%":"0px",o);var s,a,l=this.findPreviousPoint(r,e.index,e.labelPosition);if("Inside"===t.position?(e.labelRegion.height-=4,e.labelRegion.width-=4,(l&&l.labelRegion&&(de(e.labelRegion,l.labelRegion)||this.isOverlapping(e,r))||!n&&(s=e.region,a=e.labelRegion,!(s.x<=a.x&&s.x+s.width>=a.x+a.width&&s.y<=a.y&&s.height+s.y>=a.y+a.height)))&&(e.labelPosition="Outside",n||(o=this.getLabelDistance(e,t)),this.getLabelRegion(e,e.labelPosition,i,o,this.marginValue),(l=this.findPreviousPoint(r,e.index,e.labelPosition))&&(de(e.labelRegion,l.labelRegion)||this.isConnectorLineOverlapping(e,l))&&this.setOuterSmartLabel(l,e,t.border.width,o,i,this.marginValue))):l&&l.labelRegion&&(de(e.labelRegion,l.labelRegion)||this.isOverlapping(e,r)||this.isConnectorLineOverlapping(e,l))&&this.setOuterSmartLabel(l,e,t.border.width,o,i,this.marginValue),this.isOverlapping(e,r)&&("Pyramid"===this.accumulation.type||"Funnel"===this.accumulation.type)){var h=e.midAngle||0,d=n?this.radius:this.getLabelDistance(e,t),c=Q(h,-d,this.isCircular()?this.center:this.getLabelLocation(e,"OutsideLeft"));e.labelRegion=new sf.svgbase.Rect(c.x,c.y,i.width+2*this.marginValue,i.height+2*this.marginValue),e.labelRegion.y-=e.labelRegion.height/2,e.labelRegion.x=e.labelRegion.x-10-e.labelRegion.width,l&&l.labelRegion&&(de(e.labelRegion,l.labelRegion)||this.isOverlapping(e,r)||this.isConnectorLineOverlapping(e,l))&&this.setOuterSmartLabel(l,e,t.border.width,d,i,this.marginValue)}},t.prototype.move=function(e,t,i,r){var n=this;if(e.target.textContent.indexOf("...")>-1){var o=e.target.id.split(this.id);if(2===o.length){var s=parseInt(o[1].split("_text_")[0],10),a=parseInt(o[1].split("_text_")[1],10);if(!isNaN(s)&&!isNaN(a)){r&&H(this.accumulation.element.id+"_EJ2_Datalabel_Tooltip");var l=We(s,this.accumulation.visibleSeries).points[a];_(l.text||l.y.toString(),t,i,this.areaRect.width,this.accumulation.element.id+"_EJ2_Datalabel_Tooltip",re(this.accumulation.element.id+"_Secondary_Element"))}}}else H(this.accumulation.element.id+"_EJ2_Datalabel_Tooltip");r&&(clearTimeout(this.clearTooltip),this.clearTooltip=+setTimeout((function(){H(n.accumulation.element.id+"_EJ2_Datalabel_Tooltip")}),1e3))},t.prototype.findPreviousPoint=function(e,t,i){for(var r=e[0],n=t-1;n>=0;n--)if((r=e[n]).visible&&r.labelVisible&&r.labelRegion&&r.labelPosition===i)return r;return null},t.prototype.isOverlapping=function(e,t){for(var i=e.index-1;i>=0;i--)if(t[i].visible&&t[i].labelVisible&&t[i].labelRegion&&e.labelRegion&&e.labelVisible&&de(e.labelRegion,t[i].labelRegion))return!0;return!1},t.prototype.textTrimming=function(e,t,i,r){if(de(e.labelRegion,t)){var n=e.labelRegion.width;"Right"===r?n=t.x-e.labelRegion.x:"Left"===r?(n=e.labelRegion.x-(t.x+t.width))<0&&(n+=e.labelRegion.width,e.labelRegion.x=t.x+t.width):"InsideRight"===r?n=t.x+t.width-e.labelRegion.x:"InsideLeft"===r?(n=e.labelRegion.x+e.labelRegion.width-t.x)<e.labelRegion.width&&(e.labelRegion.x=t.x):this.setPointVisibileFalse(e),e.labelVisible&&e.labelRegion&&(n<e.labelRegion.width&&(e.label=ue(n-2*this.marginValue,e.label,i),e.labelRegion.width=n),3===e.label.length&&e.label.indexOf("...")>-1&&this.setPointVisibileFalse(e))}},t.prototype.setPointVisibileFalse=function(e){e.labelVisible=!1,e.labelRegion=null},t.prototype.setPointVisibleTrue=function(e){e.labelVisible=!0},t.prototype.setOuterSmartLabel=function(e,t,i,r,n,o){if(this.isCircular()){var s=this.getOverlappedAngle(e.labelRegion,t.labelRegion,t.midAngle,2*i);for(this.getLabelRegion(t,"Outside",n,r,o,s),s>t.endAngle&&(s=t.midAngle),t.labelAngle=s;t.labelVisible&&(de(e.labelRegion,t.labelRegion)||s<=e.labelAngle||this.isConnectorLineOverlapping(t,e))&&!(s>t.endAngle);)t.labelAngle=s,this.getLabelRegion(t,"Outside",n,r,o,s),s+=.1}else this.setSmartLabelForSegments(t,e)},t.prototype.setSmartLabelForSegments=function(e,t){var i=e.labelRegion,r="Funnel"===this.accumulation.type?t.labelRegion.y-(i.y+i.height):e.labelRegion.y-(t.labelRegion.y+t.labelRegion.height);r<0&&(e.labelRegion.y+="Funnel"===this.accumulation.type?r:-r)},t.prototype.isConnectorLineOverlapping=function(e,t){var i;!this.isCircular()&&e.labelRegion.x<e.region.x&&(i="outsideLeft");var r=this.getLabelLocation(e,i),n=new Se(0,0);this.getEdgeOfLabel(e.labelRegion,e.labelAngle,n,0,e);var o=this.getLabelLocation(t),s=new Se(0,0);return this.getEdgeOfLabel(t.labelRegion,t.labelAngle,s,0,e),this.isLineRectangleIntersect(r,n,e.labelRegion)||this.isLineRectangleIntersect(r,n,t.labelRegion)||this.isLineRectangleIntersect(o,s,e.labelRegion)},t.prototype.isLineRectangleIntersect=function(e,t,i){var r=[new Se(Math.round(i.x),Math.round(i.y)),new Se(Math.round(i.x+i.width),Math.round(i.y)),new Se(Math.round(i.x+i.width),Math.round(i.y+i.height)),new Se(Math.round(i.x),Math.round(i.y+i.height))];e.x=Math.round(e.x),e.y=Math.round(e.y),t.x=Math.round(t.x),t.y=Math.round(t.y);for(var n=0;n<r.length;n++)if(this.isLinesIntersect(e,t,r[n],r[(n+1)%r.length]))return!0;return!1},t.prototype.isLinesIntersect=function(e,t,i,r){var n=t.y-e.y,o=e.x-t.x,s=n*e.x+o*e.y,a=r.y-i.y,l=i.x-r.x,h=a*i.x+l*i.y,d=n*l-a*o;if(0!==d){var c=(l*s-o*h)/d,p=(n*h-a*s)/d,u=Math.min(e.x,t.x)<=c&&c<=Math.max(e.x,t.x);return u=(u=(u=u&&Math.min(e.y,t.y)<=p&&p<=Math.max(e.y,t.y))&&Math.min(i.x,r.x)<=c&&c<=Math.max(i.x,r.x))&&Math.min(i.y,r.y)<=p&&p<=Math.max(i.y,r.y)}return!1},t.prototype.getOverlappedAngle=function(e,t,i,r){var n=e.x;return i>=90&&i<=270?(t.y=e.y-(r+t.height/2),n=e.x+e.width):t.y=e.y+e.height+r,function(e,t){var i=Math.atan2(t.y-e.y,t.x-e.x);return(i=i<0?6.283+i:i)*(180/Math.PI)}(this.center,new Se(n,t.y))},t.prototype.getConnectorPath=function(e,t,i,r){void 0===r&&(r=0);var n=i.connectorStyle,o=this.isCircular()?this.isVariousRadius()?this.accumulation.pieSeriesModule.getLabelRadius(this.accumulation.visibleSeries[0],t):this.labelRadius:this.getLabelDistance(t,i),s=this.getConnectorStartPoint(t,n),a=this.accumulation.enableSmartLabels?t.midAngle:r||t.midAngle,l=new Se(0,0),h=this.getEdgeOfLabel(e,a,l,n.width,t);if("Curve"===n.type){if(this.isCircular()){var d=o-(this.isVariousRadius()?ge(t.sliceRadius,this.accumulation.pieSeriesModule.seriesRadius):this.radius);return t.isLabelUpdated?l=this.getPerpendicularDistance(s,t):(l=Q(a,o-d/2,this.center),"Outside"===t.labelPosition&&"Inside"===i.position&&(l=Q(a,o-1.25*d,this.center))),"M "+s.x+" "+s.y+" Q "+l.x+" "+l.y+" "+h.x+" "+h.y}return this.getPolyLinePath(s,h)}return"M "+s.x+" "+s.y+" L "+l.x+" "+l.y+" L "+h.x+" "+h.y},t.prototype.getPolyLinePath=function(e,t){var i=[e,t];if(e.y===t.y)return"M "+e.x+" "+e.y+" L "+t.x+" "+t.y;for(var r="M",n=0;n<=16;n++){var o=n/16,s=this.getBezierPoint(o,i,0,2);r+=s.x+","+s.y,16!==n&&(r+=" L")}return r},t.prototype.getBezierPoint=function(e,t,i,r){if(1===r)return t[i];var n=this.getBezierPoint(e,t,i,r-1),o=this.getBezierPoint(e,t,i+1,r-1),s=(n.x,n.x),a=(n.y,n.y),l=(1-e)*s+e*(o.x,o.x),h=(1-e)*a+e*(o.y,o.y);return n.x,{x:l,y:h}},t.prototype.getEdgeOfLabel=function(e,t,i,r,n){void 0===r&&(r=1);var o=new Se(e.x,e.y);return t>=90&&t<=270?(o.x+=e.width+r/2,o.y+=e.height/2,i.x=o.x+10,i.y=o.y):n&&n.region&&n.region.x>n.labelRegion.x?(o.x+=2*r+e.width,o.y+=e.height/2,i.x=o.x+10,i.y=o.y):(o.x-=r/2,o.y+=e.height/2,i.x=o.x-10,i.y=o.y),o},t.prototype.getLabelDistance=function(e,t){if(e.labelPosition&&t.position!==e.labelPosition||t.connectorStyle.length){var i=ge(t.connectorStyle.length||"70px",this.accumulation.initialClipRect.width);if(i<this.accumulation.initialClipRect.width)return i}var r,n=e.labelPosition||t.position,o=this.accumulation.visibleSeries[0],s=(this.accumulation.initialClipRect.width-o.triangleSize.width)/2;switch(n){case"Inside":return 0;case"Outside":return r=e.symbolLocation.x+e.labelOffset.x,this.accumulation.initialClipRect.width-r-s}},t.prototype.getLabelLocation=function(e,t){if(void 0===t&&(t="Outside"),"Pie"!==this.accumulation.type){t="OutsideLeft"===t?"OutsideLeft":e.labelPosition||t;var i={x:e.symbolLocation.x,y:e.symbolLocation.y-e.labelOffset.y};switch(t){case"Inside":i.y=e.region.y+e.region.height/2;break;case"Outside":i.x+=e.labelOffset.x;break;case"OutsideLeft":i.x-=e.labelOffset.x}return i}return Q(e.midAngle,this.isVariousRadius()?ge(e.sliceRadius,this.accumulation.pieSeriesModule.seriesRadius):this.radius,this.center)},t.prototype.getConnectorStartPoint=function(e,t){var i;return!this.isCircular()&&e.region.x>e.labelRegion.x&&(i="OutsideLeft"),this.isCircular()?Q(e.midAngle,(this.isVariousRadius()?ge(e.sliceRadius,this.accumulation.pieSeriesModule.seriesRadius):this.radius)-t.width,this.center):this.getLabelLocation(e,i)},t.prototype.findAreaRect=function(){this.areaRect=new sf.svgbase.Rect(0,0,this.accumulation.availableSize.width,this.accumulation.availableSize.height);var e=this.accumulation.margin;Y(this.areaRect,new Ce(e.left,e.right,e.top,e.bottom))},t.prototype.renderDataLabel=function(e,t,i,r,n,o,s){var a=this.accumulation.element.id+"_datalabel_Series_"+n+"_",l=this.accumulation.renderer.createGroup({id:a+"g_"+e.index});e.label=e.originalText||e.y.toString();var h={width:t.border.width,color:t.border.color},d=sf.base.extend({},sf.base.getValue("properties",t.font),null,!0),c={cancel:!1,name:"textRender",series:this.accumulation.visibleSeries[0],point:e,text:e.label,border:h,color:t.fill,template:t.template,font:d};this.accumulation.trigger("textRender",c),e.argsData=c;var p=null!==c.template;e.labelVisible=!c.cancel,e.text=e.label=c.text,Number(e.label)&&(e.label=this.accumulation.intl.formatNumber(+e.label,{useGrouping:this.accumulation.useGroupingSeparator})),this.marginValue=c.border.width?5+c.border.width:1;var u,g=sf.base.createElement("div",{id:this.accumulation.element.id+"_Series_0_DataLabel_"+e.index,styles:"position: absolute;background-color:"+c.color+";"+(u=t.font,"font-size:"+u.size+"; font-style:"+u.fontStyle+"; font-weight:"+u.fontWeight+"; font-family:"+u.fontFamily+";opacity:"+u.opacity+"; color:"+u.color+";;border:")+c.border.width+"px solid "+c.border.color+";"});this.calculateLabelSize(p,g,e,r,c,l,a,t,s)},t.prototype.calculateLabelSize=function(e,t,i,r,n,o,s,a,l,h,d){var c=e?d?{width:h.width,height:h.height}:this.getTemplateSize(t,i,n,l,e,r,o,s,a):sf.svgbase.measureText(i.label,a.font);c.height+=4,c.width+=4,i.textSize=c,i.templateElement=t,this.getDataLabelPosition(i,a,c,r),i.labelRegion&&this.correctLabelRegion(i.labelRegion,i.textSize)},t.prototype.drawDataLabels=function(e,t,i,r,n){var o,s,a=e.leftSidePoints.concat(e.rightSidePoints);a.sort((function(e,t){return e.index-t.index})),"Pie"===e.type&&this.accumulation.enableSmartLabels&&this.extendedLabelsCalculation();for(var l=0,h=a;l<h.length;l++){var d=h[l];if(!sf.base.isNullOrUndefined(d.argsData)&&!sf.base.isNullOrUndefined(d.y)){this.finalizeDatalabels(d,a,t);var c=this.accumulation.element.id+"_datalabel_Series_0_",p=this.accumulation.renderer.createGroup({id:c+"g_"+d.index}),u=void 0,g=void 0;if(d.visible&&d.labelVisible){if(o=s=t.angle,d.argsData.template)this.setTemplateStyle(d.templateElement,d,r,t.font.color,d.color,n);else{u=new Se(d.labelRegion.x+this.marginValue,d.labelRegion.y+3*d.textSize.height/4+this.marginValue);var f=(g=re(c+"shape_"+d.index))?new Se(+g.getAttribute("x"),+g.getAttribute("y")):null;he(!1,p,this.accumulation.renderer.drawRectangle(new Ne(c+"shape_"+d.index,d.argsData.color,d.argsData.border,1,d.labelRegion,t.rx,t.ry)),n,!0,"x","y",f,null,!1,!1,null,this.accumulation.duration);var m=d.textSize.width,y=d.textSize.height,v=void 0;v=0!==o&&t.enableRotation?"rotate("+(s="Outside"===d.labelPosition?0:d.midAngle>=90&&d.midAngle<=270?d.midAngle+180:d.midAngle)+","+(u.x+m/2)+","+(u.y-y/4)+")":"rotate("+(s=o?o>360?o-360:o<-360?o+360:o:0)+","+(u.x+m/2)+","+u.y+")",d.transform=v,me(this.accumulation.renderer,new sf.svgbase.TextOption(c+"text_"+d.index,u.x,u.y,"start",d.label,v,"auto",s),d.argsData.font,d.argsData.font.color||this.getSaturatedColor(d,d.argsData.color),p,!1,n,!0,!1,this.accumulation.duration),g=null}if(this.accumulation.accumulationLegendModule&&this.accumulation.legendSettings.visible&&("Outside"===t.position||this.accumulation.enableSmartLabels)&&this.accumulation.visibleSeries[0].findMaxBounds(this.accumulation.visibleSeries[0].labelBound,d.labelRegion),"Outside"===d.labelPosition){var b=re(c+"connector_"+d.index),w=b?b.getAttribute("d"):"";he(!1,p,this.accumulation.renderer.drawPath(new sf.svgbase.PathOption(c+"connector_"+d.index,"transparent",t.connectorStyle.width,t.connectorStyle.color||d.color,1,t.connectorStyle.dashArray,this.getConnectorPath(sf.base.extend({},d.labelRegion,null,!0),d,t,d.labelAngle))),n,!0,null,null,null,w,!1,!1,null,this.accumulation.duration)}he(!1,i,p,n)}}}},t.prototype.finalizeDatalabels=function(e,t,i){if((this.isOverlapping(e,t)||this.titleRect&&e.labelRegion&&de(e.labelRegion,this.titleRect))&&this.isCircular()&&"Outside"===e.labelPosition&&this.setPointVisibileFalse(e),this.accumulation.accumulationLegendModule&&this.accumulation.legendSettings.visible&&e.labelVisible&&e.labelRegion){var r=this.accumulation.accumulationLegendModule.legendBounds,n=this.accumulation.legendSettings.border.width/2;this.textTrimming(e,new sf.svgbase.Rect(r.x-n,r.y-n,r.width+2*n,r.height+2*n),i.font,this.accumulation.accumulationLegendModule.position)}if(e.labelVisible&&e.labelRegion){var o=this.isCircular()?e.labelRegion.x>=this.center.x?"InsideRight":"InsideLeft":e.labelRegion.x>=e.region.x?"InsideRight":"InsideLeft";this.textTrimming(e,this.areaRect,i.font,o)}e.labelVisible&&e.labelRegion&&(e.labelRegion.y+e.labelRegion.height>this.areaRect.y+this.areaRect.height||e.labelRegion.y<this.areaRect.y||e.labelRegion.x<this.areaRect.x||e.labelRegion.x+e.labelRegion.width>this.areaRect.x+this.areaRect.width)&&this.setPointVisibileFalse(e)},t.prototype.getTemplateSize=function(e,t,i,r,n,o,s,a,l){var h=ae(e=se(e,t.index,i.template,this.accumulation,t,this.accumulation.visibleSeries[0],this.accumulation.element.id+"_DataLabel",0,i,n,o,s,a,l,r),r);return{width:h.width,height:h.height}},t.prototype.setTemplateStyle=function(e,t,i,r,n,o){if(e.style.left=t.labelRegion.x+"px",e.style.top=t.labelRegion.y+"px",e.style.color=r||this.getSaturatedColor(t,n),this.accumulation.isBlazor){var s=this.isCircular()?t.labelRegion.x>=this.center.x?"InsideRight":"InsideLeft":t.labelRegion.x>=t.region.x?"InsideRight":"InsideLeft";e.style.transform="InsideRight"===s?"translate(0%, -50%)":"translate(-100%, -50%)"}e.childElementCount&&(he(!1,i,e,o,!0,"left","top"),this.doTemplateAnimation(this.accumulation,e))},t.prototype.getSaturatedColor=function(e,t){var i;i="transparent"===(i=this.marginValue>=1?"transparent"===t?this.getLabelBackground(e):t:this.getLabelBackground(e))?window.getComputedStyle(document.body,null).backgroundColor:i;var r,n,o=(r=pe(i),(n=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(r))?new Oe(parseInt(n[1],16),parseInt(n[2],16),parseInt(n[3],16)):new Oe(255,255,255));return Math.round((299*o.r+587*o.g+114*o.b)/1e3)>=128?"black":"white"},t.prototype.doTemplateAnimation=function(e,t){var i=e.visibleSeries[0],r=i.animation.delay+i.animation.duration;i.animation.enable&&e.animateSeries&&(t.style.visibility="hidden",te(t,r,200,"ZoomIn"))},t.prototype.getLabelBackground=function(e){return"Outside"===e.labelPosition?this.accumulation.background||this.accumulation.themeStyle.background:e.color},t.prototype.correctLabelRegion=function(e,t,i){void 0===i&&(i=4),e.height-=i,e.width-=i,e.x+=i/2,e.y+=i/2,t.height-=i,t.width-=i},t.prototype.getModuleName=function(){return"AccumulationDataLabel"},t.prototype.destroy=function(){},t.prototype.extendedLabelsCalculation=function(){var e=this,t=this.accumulation.series[0];t.rightSidePoints.forEach((function(t,i,r){t.initialLabelRegion=t.labelRegion,t.isLabelUpdated=0,e.skipPoints(t,r,i)})),t.leftSidePoints.forEach((function(t,i,r){t.initialLabelRegion=t.labelRegion,t.isLabelUpdated=0,e.skipPoints(t,r,i)})),this.arrangeLeftSidePoints(t),this.isIncreaseAngle=!1,this.arrangeRightSidePoints(t)},t.prototype.arrangeRightSidePoints=function(e){var t,i,r,n,o=e.rightSidePoints.filter((function(e){return e.labelVisible&&"Outside"===e.labelPosition}));this.rightSideRenderingPoints=o;var s,a=o[o.length-1];a&&a.labelAngle>90&&a.labelAngle<270&&(this.isIncreaseAngle=!0,this.changeLabelAngle(a,89));for(var l=o.length-1;l>=0;l--)if(n=o[l],s=o[l+1],this.isOverlapWithNext(n,o,l)&&n.labelVisible||!(n.labelAngle<=90||n.labelAngle>=270))if(r=a.labelAngle+10,i=!0,t?this.isIncreaseAngle=!1:r>90&&r<270&&s.isLabelUpdated&&(this.isIncreaseAngle=!0),this.isIncreaseAngle)for(h=l+1;h>0;h--)this.decreaseAngle(o[h],o[h-1],e,!0);else for(var h=l+1;h<o.length;h++)this.increaseAngle(o[h-1],o[h],e,!0);else i&&s&&!s.isLabelUpdated&&(t=!0)},t.prototype.arrangeLeftSidePoints=function(e){var t,i,r,n,o=this,s=e.leftSidePoints.filter((function(e){return e.labelVisible&&"Outside"===e.labelPosition}));this.leftSideRenderingPoints=s;for(var a=0;a<s.length;a++)if(i=s[a],t=s[a-1],this.isOverlapWithPrevious(i,s,a)&&i.labelVisible||!(i.labelAngle<270))if(r=!0,n&&(this.isIncreaseAngle=!1),this.isIncreaseAngle)for(l=a;l<s.length;l++)this.increaseAngle(s[l-1],s[l],e,!1);else for(var l=a;l>0;l--)this.decreaseAngle(s[l],s[l-1],e,!1),s.filter((function(e,t){e.isLabelUpdated&&s[t].labelAngle-10<100&&(o.isIncreaseAngle=!0)}));else r&&t&&t.isLabelUpdated&&(n=!0)},t.prototype.decreaseAngle=function(e,t,i,r){if(sf.base.isNullOrUndefined(e)||sf.base.isNullOrUndefined(t))return null;var n=1;if(r)for(;de(e.labelRegion,t.labelRegion)||!this.isVariousRadius()&&!(t.labelRegion.height+t.labelRegion.y<e.labelRegion.y);){if((o=t.midAngle-n)<0&&(o=360+o),o<=270&&o>=90){o=270,this.isIncreaseAngle=!0;break}this.changeLabelAngle(t,o),n++}else for(e.labelAngle>270&&(this.changeLabelAngle(e,270),t.labelAngle=270);de(e.labelRegion,t.labelRegion)||!this.isVariousRadius()&&e.labelRegion.y+e.labelRegion.height>t.labelRegion.y;){var o;if(!((o=t.midAngle-n)<=270&&o>=90)){o=90,this.isIncreaseAngle=!0;break}if(this.changeLabelAngle(t,o),de(e.labelRegion,t.labelRegion)&&!i.leftSidePoints.indexOf(t)&&o-1<90&&o-1>270){this.changeLabelAngle(e,e.labelAngle+1),this.arrangeLeftSidePoints(i);break}n++}},t.prototype.increaseAngle=function(e,t,i,r){if(sf.base.isNullOrUndefined(e)||sf.base.isNullOrUndefined(t))return null;var n=1;if(r)for(;de(e.labelRegion,t.labelRegion)||!this.isVariousRadius()&&!(e.labelRegion.y+e.labelRegion.height<t.labelRegion.y);){if((o=t.midAngle+n)<270&&o>90){o=90,this.isIncreaseAngle=!0;break}if(this.changeLabelAngle(t,o),de(e.labelRegion,t.labelRegion)&&o+1>90&&o+1<270&&this.rightSideRenderingPoints.indexOf(t)===this.rightSideRenderingPoints.length-1){this.changeLabelAngle(e,e.labelAngle-1),t.labelRegion=t.initialLabelRegion,this.arrangeRightSidePoints(i);break}n++}else for(;de(e.labelRegion,t.labelRegion)||!this.isVariousRadius()&&e.labelRegion.y<t.labelRegion.y+t.labelRegion.height;){var o;if(!((o=t.midAngle+n)<270&&o>90)){o=270,this.isIncreaseAngle=!1;break}this.changeLabelAngle(t,o),n++}},t.prototype.changeLabelAngle=function(e,t){var i,r=this.accumulation.series[0].dataLabel;this.isVariousRadius()&&(i=this.accumulation.pieSeriesModule.getLabelRadius(this.accumulation.visibleSeries[0],e));var n="Outside"===e.labelPosition&&this.accumulation.enableSmartLabels&&"Inside"===r.position?this.radius+ge(r.connectorStyle.length||"4%",this.accumulation.pieSeriesModule.size/2):this.isVariousRadius()?i:this.accumulation.pieSeriesModule.labelRadius+10,o=this.isVariousRadius()?i:n;this.getLabelRegion(e,"Outside",e.textSize,o,this.marginValue,t),e.isLabelUpdated=1,e.labelAngle=t},t.prototype.isOverlapWithPrevious=function(e,t,i){for(var r=0;r<i;r++)if(r!==t.indexOf(e)&&t[r].visible&&t[r].labelVisible&&t[r].labelRegion&&e.labelRegion&&e.labelVisible&&de(e.labelRegion,t[r].labelRegion))return!0;return!1},t.prototype.isOverlapWithNext=function(e,t,i){for(var r=i;r<t.length;r++)if(r!==t.indexOf(e)&&t[r].visible&&t[r].labelVisible&&t[r].labelRegion&&e.labelRegion&&e.labelVisible&&de(e.labelRegion,t[r].labelRegion))return!0;return!1},t.prototype.skipPoints=function(e,t,i){if(i>0&&(e.midAngle<285&&e.midAngle>255||e.midAngle<105&&e.midAngle>75)){var r=t[i-1],n=e.endAngle%360-e.startAngle%360;(a=r.endAngle%360-r.startAngle%360)<=n&&n<5&&r.labelVisible&&this.setPointVisibleTrue(e)}else if(i>1&&(e.midAngle<300&&e.midAngle>240||e.midAngle<120&&e.midAngle>60)){var o=t[i-1],s=t[i-2],a=(n=e.endAngle%360-e.startAngle%360,o.endAngle%360-o.startAngle%360),l=s.endAngle%360-s.startAngle%360;n<3&&a<3&&l<3&&o.labelVisible&&e.labelVisible&&this.setPointVisibleTrue(e)}},t.prototype.getPerpendicularDistance=function(e,t){var i=10+10*Math.sin(t.midAngle*Math.PI/360);return t.midAngle>270&&t.midAngle<360?new Se(e.x+i*Math.cos((360-t.midAngle)*Math.PI/180),e.y-i*Math.sin((360-t.midAngle)*Math.PI/180)):t.midAngle>0&&t.midAngle<90?new Se(e.x+i*Math.cos(t.midAngle*Math.PI/180),e.y+i*Math.sin(t.midAngle*Math.PI/180)):t.midAngle>0&&t.midAngle<90?new Se(e.x-i*Math.cos((t.midAngle-90)*Math.PI/180),e.y+i*Math.sin((t.midAngle-90)*Math.PI/180)):new Se(e.x-i*Math.cos((t.midAngle-180)*Math.PI/180),e.y-i*Math.sin((t.midAngle-180)*Math.PI/180))},t}(ot),It=function(){function e(e){this.currentPoints=[],this.previousPoints=[],this.insideRegion=!1,this.chart=e,this.lierIndex=0}return e.prototype.getData=function(){for(var e,t,i,r,n=this.chart,o=null,s=null,a=n.visibleSeries.length-1;a>=0;a--){if(e="Scatter"===(s=n.visibleSeries[a]).type||"Scatter"===s.drawType||s.marker.visible?(s.marker.height+5)/2:0,t="Scatter"===s.type||"Scatter"===s.drawType||s.marker.visible?(s.marker.width+5)/2:0,i=n.mouseX,r=n.mouseY,s.dragSettings.enable&&s.isRectSeries)if("Bar"===s.type&&n.isTransposed||!n.isTransposed&&"Bar"!==s.type){var l=s.marker.height/2;r=s.yAxis.isInversed?r-l:r+l}else{var h=s.marker.width/2;i=s.yAxis.isInversed?i+h:i-h}if(s.visible&&X(i,r,s.clipRect,e,t)&&(o=this.getRectPoint(s,s.clipRect,i,r)),o)return new Te(o,s)}return new Te(o,s)},e.prototype.isSelected=function(e){return(e.selectionMode.indexOf("Drag")>-1||e.selectionMode.indexOf("Lasso")>-1)&&e.selectionModule&&null!==e.selectionModule.rectPoints},e.prototype.getRectPoint=function(e,t,i,r){var n,o,s,a,l,h,d=0;if(this.chart.isScrolling)return null;for(var c=0,p=e.points;c<p.length;c++){var u=p[c];if(u.regionData||u.regions&&u.regions.length){if(u.regionData&&"PolarRadar"===this.chart.chartAreaType&&e.drawType.indexOf("Column")>-1&&(n=i-(e.clipRect.width/2+e.clipRect.x),o=r-(e.clipRect.height/2+e.clipRect.y),d=2*Math.PI*(u.regionData.currentXPosition<0?1+u.regionData.currentXPosition:u.regionData.currentXPosition),s=(s=(Math.atan2(o,n)+.5*Math.PI-d)%(2*Math.PI))<0?2*Math.PI+s:s,s+=2*Math.PI*e.chart.primaryXAxis.startAngle,a=u.regionData.startAngle,a=(a-=d)<0?2*Math.PI+a:a,l=u.regionData.endAngle,l=(l-=d)<0?2*Math.PI+l:l,h=Math.sqrt(Math.pow(Math.abs(n),2)+Math.pow(Math.abs(o),2)),s>=a&&s<=l&&(h>=u.regionData.innerRadius&&h<=u.regionData.radius||h<=u.regionData.innerRadius&&h>=u.regionData.radius)&&h<=e.chart.radius))return u;if((e.dragSettings.enable&&e.isRectSeries||e.isRectSeries&&e.marker.visible)&&this.isPointInThresholdRegion(i,r,u,t,e))return this.insideRegion=!0,u;if(!this.insideRegion&&this.checkRegionContainsPoint(u.regions,t,i,r))return u;if(this.insideRegion&&this.checkRegionContainsPoint(u.regions,t,i,r))return u}}return null},e.prototype.checkRegionContainsPoint=function(e,t,i,r){var n=this;return e.some((function(e,o){return n.lierIndex=o,X(i,r,new sf.svgbase.Rect(("Cartesian"===n.chart.chartAreaType?t.x:0)+e.x,("Cartesian"===n.chart.chartAreaType?t.y:0)+e.y,e.width,e.height))}))},e.prototype.isPointInThresholdRegion=function(e,t,i,r,n){var o,s=this,a="Bar"===n.type,l=n.yAxis.isInversed,h=n.chart.isTransposed,d=0,c=0,p=o=20;return l&&h?a?(d=i.regions[0].height-10,o=i.regions[0].width):(c=-10,p=i.regions[0].height):l||i.yValue<0?a?(c=-10,p=i.regions[0].height):(d=i.regions[0].height-10,o=i.regions[0].width):h?a?(d=-10,o=i.regions[0].width):(c=i.regions[0].width-10,p=i.regions[0].height):a?(c=i.regions[0].width-10,p=i.regions[0].height):(d=-10,o=i.regions[0].width),i.regions.some((function(i){return X(e,t,new sf.svgbase.Rect(("Cartesian"===s.chart.chartAreaType?r.x:0)+i.x+c,("Cartesian"===s.chart.chartAreaType?r.y:0)+i.y+d,o,p))}))},e.prototype.getClosest=function(e,t,i){var r,n,o=i||e.xData;if(t>=e.xMin-.5&&t<=e.xMax+.5)for(var s=0;s<o.length;s++)n=o[s],(null==r||Math.abs(n-t)<Math.abs(r-t))&&(r=n);return-1!==e.xData.indexOf(r)?r:null},e.prototype.getClosestX=function(e,t,i){var r,n=t.clipRect;r=e.requireInvertedAxis?function(e,t,i){return(i.isInversed?e/t:1-e/t)*i.visibleRange.delta+i.visibleRange.min}(e.mouseY-n.y,n.height,t.xAxis):function(e,t,i){return(i.isInversed?1-e/t:e/t)*i.visibleRange.delta+i.visibleRange.min}(e.mouseX-n.x,n.width,t.xAxis);for(var o=this.getClosest(t,r,i),s=0,a=t.points;s<a.length;s++){var l=a[s];if(o===l.xValue&&l.visible)return new Te(l,t)}return null},e.prototype.mergeXvalues=function(e){for(var t=[],i=0;i<e.length;i++)t=t.concat(e[i].xData);return t.filter((function(e,i){return i===t.indexOf(e)}))},e}(),St=(Ge=function(e,t){return(Ge=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}Ge(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),Ct=function(e){function t(t){var i=e.call(this,t)||this;return i.element=i.chart.element,i.textStyle=t.tooltip.textStyle,i.control=t,i.template=t.tooltip.template,i}return St(t,e),t.prototype.getElement=function(e){return document.getElementById(e)},t.prototype.getTooltipElement=function(e){this.inverted=this.chart.requireInvertedAxis,this.header=null===this.control.tooltip.header?this.control.tooltip.shared?"<b>${point.x}</b>":"<b>${series.name}</b>":this.control.tooltip.header,this.formattedText=[];var t=document.getElementById(this.chart.element.id+"_tooltip"),i=this.chart.element.id.indexOf("stockChart")>-1;return!e&&!t||i?this.createElement():null},t.prototype.createElement=function(){var e=document.createElement("div");return e.id=this.element.id+"_tooltip",e.className="ejSVGTooltip",e.style.pointerEvents="none",e.style.position="absolute",e.style.zIndex="1",e},t.prototype.pushData=function(e,t,i,r){return!!e.series.enableTooltip&&(this.currentPoints.push(e),this.stopAnimation(),i&&!document.getElementById(i.id)&&(this.chart.stockChart?document.getElementById(this.chart.stockChart.element.id+"_Secondary_Element").appendChild(i):document.getElementById(this.element.id+"_Secondary_Element").appendChild(i)),!0)},t.prototype.removeHighlight=function(){for(var e,t=0,i=this.previousPoints.length;t<i;t++)(e=this.previousPoints[t]).series.isRectSeries?e.series.visible&&this.highlightPoint(e.series,e.point.index,!1):e.series.marker.visible||"Scatter"===e.series.type||"Bubble"===e.series.type||(this.previousPoints.shift(),i-=1)},t.prototype.highlightPoint=function(e,t,i){var r=this.getElement(this.element.id+"_Series_"+e.index+"_Point_"+t),n=this.control.accumulationSelectionModule,o=!!(n&&n.selectedDataIndexes.length>0);r&&(!o||o&&r.getAttribute("class")&&-1===r.getAttribute("class").indexOf("_ej2_chart_selection_series_")?r.setAttribute("opacity",(i?e.opacity/2:e.opacity).toString()):r.setAttribute("opacity",e.opacity.toString()))},t.prototype.highlightPoints=function(){for(var e=0,t=this.currentPoints;e<t.length;e++){var i=t[e];i.series.isRectSeries&&"Series"===i.series.category&&this.highlightPoint(i.series,i.point.index,!0)}},t.prototype.createTooltip=function(e,t,i,r,n,o,s,a,l,h,d){void 0===l&&(l=null),void 0===h&&(h=null);var c=this.currentPoints[0].series,p=e.tooltipModule||e.accumulationTooltipModule;if(p&&null!==i){var u=c.isRectSeries&&"Waterfall"!==c.type&&n&&n.y<0,g=this.chart.requireInvertedAxis&&c.isRectSeries,f=null;if(this.text.length<=1){var m=void 0,y=void 0,v=d||this.template;if(v&&"chart"===e.getModuleName()&&"#"!==v[0]&&"string"==typeof v){var b=document.createElement("div");b.id="testing_template",b.className="ejSVGTooltip",b.style.pointerEvents="none",b.style.position="absolute",b.style.zIndex="1",document.getElementById(this.chart.element.id+"_Secondary_Element").appendChild(b);var w=v.replaceAll("${x}",n.x).replaceAll("${y}",n.y);b.innerHTML=w,m=new sf.svgbase.Size(b.firstElementChild.offsetWidth,b.firstElementChild.offsetHeight),y=new sf.svgbase.Size(0,0),b.remove()}else m=sf.svgbase.measureText(this.text[0],e.tooltip.textStyle),y=""!==this.header&&"<b></b>"!==this.header?sf.svgbase.measureText(this.header,this.textStyle):new sf.svgbase.Size(0,0);m.width=Math.max(m.width,y.width)+(o.length>0?47:0);var x=32+(y.height>0?20:0);m.height=m.height+y.height+x,f=this.getCurrentPosition(u,g),u="Left"===(f=this.getPositionBySize(m,new sf.svgbase.Rect(0,0,a.width,a.height),i,f))||"Bottom"===f,g="Left"===f||"Right"===f}t?this.svgTooltip=new sf.svgbase.Tooltip({opacity:e.tooltip.opacity,header:this.headerText,content:this.text,fill:e.tooltip.fill,border:e.tooltip.border,enableAnimation:e.tooltip.enableAnimation,location:i,shared:e.tooltip.shared,shapes:o,clipBounds:"PolarRadar"===this.chart.chartAreaType?new Se(0,0):r,areaBounds:a,palette:this.findPalette(),template:d||this.template,data:h,theme:e.theme,offset:s,textStyle:e.tooltip.textStyle,isNegative:u,inverted:g,arrowPadding:this.text.length>1||this.chart.stockChart?0:12,availableSize:e.availableSize,duration:this.chart.tooltip.duration,isCanvas:this.chart.enableCanvas,isTextWrap:e.tooltip.enableTextWrap&&"chart"===e.getModuleName(),blazorTemplate:{name:"Template",parent:this.chart.tooltip},controlInstance:this.chart,tooltipPlacement:f,tooltipRender:function(){p.removeHighlight(),p.highlightPoints(),p.updatePreviousPoint(l)},animationComplete:function(e){e.tooltip.fadeOuted&&p.fadeOut(p.previousPoints)}},"#"+this.element.id+"_tooltip"):this.svgTooltip&&(this.svgTooltip.location=i,this.svgTooltip.content=this.text,this.svgTooltip.header=this.headerText,this.svgTooltip.offset=s,this.svgTooltip.palette=this.findPalette(),this.svgTooltip.shapes=o,this.svgTooltip.data=h,this.svgTooltip.template=this.template,this.svgTooltip.textStyle=e.tooltip.textStyle,this.svgTooltip.isNegative=u,this.svgTooltip.inverted=g,this.svgTooltip.clipBounds="PolarRadar"===this.chart.chartAreaType?new Se(0,0):r,this.svgTooltip.arrowPadding=this.text.length>1||this.chart.stockChart?0:12,this.svgTooltip.tooltipPlacement=f,this.svgTooltip.dataBind()),this.chart.isReact&&this.chart.renderReactTemplates()}},t.prototype.getPositionBySize=function(e,t,i,r){var n=this.isTooltipFitPosition("Top",new sf.svgbase.Rect(0,0,t.width,t.height),i,e),o=this.isTooltipFitPosition("Bottom",new sf.svgbase.Rect(0,0,t.width,t.height),i,e),s=this.isTooltipFitPosition("Right",new sf.svgbase.Rect(0,0,t.width,t.height),i,e),a=this.isTooltipFitPosition("Left",new sf.svgbase.Rect(0,0,t.width,t.height),i,e);if(!(n||o||s||a)){var l=[i.x-t.x,t.x+t.width-i.x,i.y-t.y,t.y+t.height-i.y],h=l.indexOf(Math.max.apply(this,l));return r=0===h?"Left":1===h?"Right":2===h?"Top":"Bottom"}return"Top"===r?n?"Top":o?"Bottom":s?"Right":"Left":"Bottom"===r?o?"Bottom":n?"Top":s?"Right":"Left":"Right"===r?s?"Right":a?"Left":n?"Top":"Bottom":a?"Left":s?"Right":n?"Top":"Bottom"},t.prototype.isTooltipFitPosition=function(e,t,i,r){var n=new Se(0,0),o=new Se(0,0);switch(e){case"Top":n.x=i.x-r.width/2,n.y=i.y-r.height,o.x=i.x+r.width/2,o.y=i.y;break;case"Bottom":n.x=i.x-r.width/2,n.y=i.y,o.x=i.x+r.width/2,o.y=i.y+r.height;break;case"Right":n.x=i.x,n.y=i.y-r.height/2,o.x=i.x+r.width,o.y=i.y+r.height/2;break;case"Left":n.x=i.x-r.width,n.y=i.y-r.height/2,o.x=i.x,o.y=i.y+r.height/2}return X(n.x,n.y,t)&&X(o.x,o.y,t)},t.prototype.getCurrentPosition=function(e,t){return t?e?"Left":"Right":e?"Bottom":"Top"},t.prototype.findPalette=function(){for(var e=[],t=0,i=this.currentPoints;t<i.length;t++){var r=i[t];e.push(this.findColor(r,r.series))}return e},t.prototype.findColor=function(e,t){return!t.isRectSeries||"Candle"!==t.type&&"Hilo"!==t.type&&"HiloOpenClose"!==t.type?(e.point.color&&"#ffffff"!==e.point.color?e.point.color:e.point.interior)||t.marker.fill||t.interior:e.point.color},t.prototype.updatePreviousPoint=function(e){e&&(this.currentPoints=this.currentPoints.concat(e)),this.previousPoints=sf.base.extend([],this.currentPoints,null,!0)},t.prototype.fadeOut=function(e){var t=this.chart.enableCanvas?this.getElement(this.element.id+"_tooltip_group"):this.getElement(this.element.id+"_tooltip_svg");t&&parseInt(t.getAttribute("opacity"),10)>0||(this.valueX=null,this.valueY=null,this.currentPoints=[],this.removeHighlight(),this.removeHighlightedMarker(e),this.svgTooltip=null,this.control.trigger("animationComplete",{}))},t.prototype.removeHighlightedMarker=function(e){if(this.chart.markerRender){for(var t=0,i=e;t<i.length;t++){var r=i[t];H(this.element.id+"_Series_"+r.series.index+"_Point_"+r.point.index+"_Trackball")}this.chart.markerRender.removeHighlightedMarker()}this.previousPoints=[]},t.prototype.removeText=function(){this.textElements=[];var e=this.getElement(this.element.id+"_tooltip_group");if(e&&e.childNodes.length>0)for(;e.lastChild&&1!==e.childNodes.length;)e.removeChild(e.lastChild)},t.prototype.stopAnimation=function(){var e;e=this.toolTipInterval,window.clearInterval(e)},t.prototype.removeTooltip=function(e){var t=this,i=this.getElement(this.element.id+"_tooltip"),r=i?this.getElement(i.id+"parent_template"):null,n=r&&"<div></div>"!==r.innerHTML;this.stopAnimation(),this.chart.isReact&&n&&this.chart.clearTemplate([r.id],[0]),i&&this.previousPoints.length>0&&(this.toolTipInterval=+setTimeout((function(){t.svgTooltip&&t.svgTooltip.fadeOut()}),e))},t}(It),Ot=(Xe=function(e,t){return(Xe=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}Xe(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),Tt=function(e){function t(t){var i=e.call(this,t)||this;return i.accumulation=t,i.addEventListener(),i.template=i.accumulation.tooltip.template,i}return Ot(t,e),t.prototype.addEventListener=function(){this.accumulation.isDestroyed||(this.accumulation.on(sf.base.Browser.isPointer?"pointerleave":"mouseleave",this.mouseLeaveHandler,this),this.accumulation.on(sf.base.Browser.touchMoveEvent,this.mouseMoveHandler,this),this.accumulation.on(sf.base.Browser.touchEndEvent,this.mouseUpHandler,this))},t.prototype.mouseLeaveHandler=function(e){this.removeTooltip(this.accumulation.tooltip.fadeOutDuration)},t.prototype.mouseUpHandler=function(e){var t=this.accumulation;t.tooltip.enable&&t.isTouch&&X(t.mouseX,t.mouseY,t.initialClipRect)&&(this.tooltip(e),this.removeTooltip(2e3))},t.prototype.mouseMoveHandler=function(e){var t=this.accumulation;t.tooltip.enable&&X(t.mouseX,t.mouseY,t.initialClipRect)&&this.tooltip(e)},t.prototype.tooltip=function(e){var t=this.getElement(this.element.id+"_tooltip_svg"),i=t&&parseInt(t.getAttribute("opacity"),10)>0,r=this.getTooltipElement(i);this.renderSeriesTooltip(e,this.accumulation,!i,r)},t.prototype.renderSeriesTooltip=function(e,t,i,r){var n=this.getPieData(e,t,t.mouseX,t.mouseY);t.initialClipRect;if(this.currentPoints=[],!n.point||this.previousPoints[0]&&this.previousPoints[0].point===n.point)!n.point&&this.isRemove&&(this.removeTooltip(this.accumulation.tooltip.fadeOutDuration),this.isRemove=!1);else{if(this.previousPoints[0]&&n.point.index===this.previousPoints[0].point.index&&n.series.index===this.previousPoints[0].series.index)return null;this.pushData(n,i,r,!1)&&this.triggerTooltipRender(n,i,this.getTooltipText(n,t.tooltip),this.findHeader(n))}},t.prototype.triggerTooltipRender=function(e,t,i,r,n){var o=this;void 0===n&&(n=!0);var s={cancel:!1,name:"tooltipRender",text:i,point:e.point,textStyle:this.textStyle,series:this.accumulation.isBlazor?{}:e.series,headerText:r,data:{pointX:e.point.x,pointY:e.point.y,seriesIndex:e.series.index,pointIndex:e.point.index,pointText:e.point.text,seriesName:e.series.name}},a=function(i){i.cancel?(o.removeHighlight(),sf.base.remove(o.getElement(o.element.id+"_tooltip"))):(o.formattedText=o.formattedText.concat(i.text),o.text=o.formattedText,o.headerText=i.headerText,o.createTooltip(o.chart,t,e.point.symbolLocation,e.series.clipRect,e.point,["Circle"],0,o.chart.initialClipRect,null,e.point,o.template?i.template:"")),o.isRemove=!0};a.bind(this,e),this.chart.trigger("tooltipRender",s,a)},t.prototype.getPieData=function(e,t,i,r){var n=G(e.target.id,!0);if(!isNaN(n.series)){var o=n.series,s=n.point;if(!(sf.base.isNullOrUndefined(o)||isNaN(o)||sf.base.isNullOrUndefined(s)||isNaN(s))){var a=this.getSeriesFromIndex(o,t.visibleSeries);if(a.enableTooltip)return new Pe(a.points[s],a)}}return new Pe(null,null)},t.prototype.getSeriesFromIndex=function(e,t){return t[0]},t.prototype.getTooltipText=function(e,t){var i=e.series,r=this.accumulation.useGroupingSeparator?"${point.x} : <b>${point.separatorY}</b>":"${point.x} : <b>${point.y}</b>";return r=t.format?t.format:r,this.parseTemplate(e.point,i,r)},t.prototype.findHeader=function(e){return""===this.header?"":(this.header=this.parseTemplate(e.point,e.series,this.header),""!==this.header.replace(/<b>/g,"").replace(/<\/b>/g,"").trim()?this.header:"")},t.prototype.parseTemplate=function(e,t,i){for(var r,n,o=0,s=Object.keys(e);o<s.length;o++){var a=s[o];r=new RegExp("${point."+a+"}","gm"),i=i.replace(r.source,e[a])}for(var l=0,h=Object.keys(Object.getPrototypeOf(t));l<h.length;l++){a=h[l];r=new RegExp("${series."+a+"}","gm"),n=t[a],i=i.replace(r.source,n)}return i},t.prototype.getModuleName=function(){return"AccumulationTooltip"},t.prototype.destroy=function(e){},t}(Ct),Pt=function(){function e(e){this.control=e}return e.prototype.seriesStyles=function(){var e,t,i=document.getElementById(this.styleId),r="{}",n=this.control.selectionPattern,o=this.control.highlightPattern;if(sf.base.isNullOrUndefined(i)||"None"!==n||"None"!==o){(i=document.createElement("style")).setAttribute("id",this.styleId);for(var s=0,a=this.control.visibleSeries;s<a.length;s++){var l=a[s],h=this.control.visibleSeries[l.index]||this.control.visibleSeries[l.index];if(!(sf.base.isNullOrUndefined(n)&&sf.base.isNullOrUndefined(o)||"None"===n&&"None"===o)){var d=this.styleId.indexOf("highlight")>0?o:n;if("Pie"===h.type||"Funnel"===h.type||"Pyramid"===h.type)for(var c=0;c<h.points.length;c++)t=h.opacity,r="{ fill:"+this.pattern(this.control,h.points[c].color,l.index,d,t)+"}";else h.type&&(t=h.opacity,r="{ fill:"+this.pattern(this.control,h.interior,l.index,d,t)+"}")}e=l.selectionStyle||this.styleId+"_series_"+l.index+",."+this.styleId+"_series_"+l.index+"> *",r=r.indexOf("None")>-1?"{}":r,i.innerHTML+=l.selectionStyle?"":"."+e+r}i.innerHTML+="."+this.unselected+" { opacity:0.3;} ",document.body.appendChild(i)}},e.prototype.pattern=function(e,t,i,r,n){var o=e.svgObject,s=[],a={id:e.element.id+"_"+r+"_Selection_"+i,patternUnits:"userSpaceOnUse"};switch(r){case"Dots":a.height=a.width=6,a.width=6,s[0]={x:0,y:0,width:7,height:7,transform:"translate(0,0)",fill:"#ffffff",opacity:n,name:"rect"},s[1]={cx:3,cy:3,r:2,"stroke-width":1,fill:t,name:"circle"};break;case"Pacman":a.height="18.384",a.width="17.917",s[0]={name:"rect",x:0,y:0,width:17.917,height:18.384,transform:"translate(0,0)",fill:"#ffffff",opacity:n},s[1]={name:"path",d:"M9.081,9.194l5.806-3.08c-0.812-1.496-2.403-3.052-4.291-3.052H8.835C6.138,3.063,3,6.151,3,8.723v1.679   c0,2.572,3.138,5.661,5.835,5.661h1.761c2.085,0,3.835-1.76,4.535-3.514L9.081,9.194z","stroke-width":1,stroke:t,fill:t};break;case"Chessboard":a.height=a.width=10,s[0]={x:0,y:0,width:10,height:10,fill:"#ffffff",opacity:n,name:"rect"},s[1]={x:0,y:0,width:5,height:5,fill:t,opacity:n,name:"rect"},s[2]={x:5,y:5,width:5,height:5,fill:t,opacity:n,name:"rect"};break;case"Crosshatch":a.height=a.width="8",s[0]={x:0,y:0,width:8,height:8,transform:"translate(0,0)",fill:"#ffffff",opacity:n,name:"rect"},s[1]={d:"M0 0L8 8ZM8 0L0 8Z","stroke-width":1,stroke:t,name:"path"};break;case"DiagonalForward":a.height=a.width=6,s[0]={x:0,y:0,width:6,height:6,transform:"translate(0,0)",fill:"#ffffff",opacity:n,name:"rect"},s[1]={d:"M 3 -3 L 9 3 M 6 6 L 0 0 M 3 9 L -3 3","stroke-width":2,stroke:t,name:"path"};break;case"DiagonalBackward":a.height=a.width=6,s[0]={x:0,y:0,width:6,height:6,transform:"translate(0,0)",fill:"#ffffff",opacity:n,name:"rect"},s[1]={d:"M 3 -3 L -3 3 M 0 6 L 6 0 M 9 3 L 3 9","stroke-width":2,stroke:t,name:"path"};break;case"Grid":a.height=a.width=6,s[0]={name:"rect",x:0,y:0,width:6,height:6,transform:"translate(0,0)",fill:"#ffffff",opacity:n},s[1]={name:"path",d:"M1 3.5L11 3.5 M0 3.5L11 3.5 M0 7.5L11 7.5 M0 11.5L11 11.5 M5.5 0L5.5 12 M11.5 0L11.5 12Z","stroke-width":1,stroke:t};break;case"Turquoise":a.height=a.width=17,s[0]={name:"rect",x:0,y:0,width:17,height:17,transform:"translate(0,0)",fill:"#ffffff",opacity:n},s[1]={name:"path",d:"M0.5739999999999998,2.643a2.123,2.111 0 1,0 4.246,0a2.123,2.111 0 1,0 -4.246,0","stroke-width":1,"stroke-miterlimit":10,stroke:t,fill:t},s[2]={name:"path",d:"M11.805,2.643a2.123,2.111 0 1,0 4.246,0a2.123,2.111 0 1,0 -4.246,0","stroke-width":1,"stroke-miterlimit":10,stroke:t,fill:t},s[3]={name:"path",d:"M6.19,2.643a2.123,2.111 0 1,0 4.246,0a2.123,2.111 0 1,0 -4.246,0","stroke-width":1,"stroke-miterlimit":10,stroke:t,fill:t},s[4]={name:"path",d:"M11.805,8.217a2.123,2.111 0 1,0 4.246,0a2.123,2.111 0 1,0 -4.246,0","stroke-width":1,"stroke-miterlimit":10,stroke:t,fill:t},s[5]={name:"path",d:"M6.19,8.217a2.123,2.111 0 1,0 4.246,0a2.123,2.111 0 1,0 -4.246,0","stroke-width":1,"stroke-miterlimit":10,stroke:t,fill:t},s[6]={name:"path",d:"M11.805,13.899a2.123,2.111 0 1,0 4.246,0a2.123,2.111 0 1,0 -4.246,0","stroke-width":1,"stroke-miterlimit":10,stroke:t,fill:t},s[7]={name:"path",d:"M6.19,13.899a2.123,2.111 0 1,0 4.246,0a2.123,2.111 0 1,0 -4.246,0","stroke-width":1,"stroke-miterlimit":10,stroke:t,fill:t};break;case"Star":a.height=a.width=21,s[0]={name:"rect",x:0,y:0,width:21,height:21,transform:"translate(0,0)",fill:"#ffffff",opacity:n},s[1]={name:"path",d:"M15.913,18.59L10.762 12.842 5.613 18.75 8.291 11.422 0.325 9.91 8.154 8.33 5.337 0.91 10.488 6.658 15.637 0.75 12.959 8.078 20.925 9.59 13.096 11.17 z","stroke-width":1,stroke:t,fill:t};break;case"Triangle":a.height=a.width=10,s[0]={name:"rect",x:0,y:0,width:10,height:10,transform:"translate(0,0)",fill:"#ffffff",opacity:n},s[1]={name:"path",d:"M4.987,0L7.48 4.847 9.974 9.694 4.987 9.694 0 9.694 2.493 4.847 z","stroke-width":1,stroke:t,fill:t};break;case"Circle":a.height=a.width=9,s[0]={name:"rect",x:0,y:0,width:9,height:9,transform:"translate(0,0)",fill:"#ffffff",opacity:n},s[1]={name:"circle",cx:5.125,cy:3.875,r:3.625,"stroke-width":1,fill:t};break;case"Tile":a.height=a.width=18,s[0]={name:"rect",x:0,y:0,width:18,height:18,transform:"translate(0,0)",fill:"#ffffff",opacity:n},s[1]={name:"path",d:"M0,9L0 0 9 0 z","stroke-width":1,stroke:t,fill:t},s[2]={name:"path",d:"M9,9L9 0 18 0 z","stroke-width":1,stroke:t,fill:t},s[3]={name:"path",d:"M0,18L0 9 9 9 z","stroke-width":1,stroke:t,fill:t},s[4]={name:"path",d:"M9,18L9 9 18 9 z","stroke-width":1,stroke:t,fill:t};break;case"HorizontalDash":a.height=a.width=12,s[0]={name:"rect",x:0,y:0,width:12,height:12,transform:"translate(0,0)",fill:"#ffffff",opacity:n},s[1]={name:"path",d:"M0,1.5 L10 1.5 M0,5.5 L10 5.5 M0,9.5 L10 9.5 z","stroke-width":1,stroke:t,fill:t};break;case"VerticalDash":a.height=a.width=12,s[0]={name:"rect",x:0,y:0,width:12,height:12,transform:"translate(0,0)",fill:"#ffffff",opacity:n},s[1]={name:"path",d:"M1.5,0 L1.5 10 M5.5,0 L5.5 10 M9.5,0 L9.5 10 z","stroke-width":1,stroke:t,fill:t};break;case"Rectangle":a.height=a.width=12,s[0]={name:"rect",width:12,height:12,fill:"#ffffff",opacity:n},s[1]={name:"rect",x:1,y:2,width:4,height:9,fill:t,opacity:n},s[2]={name:"rect",x:7,y:2,width:4,height:9,fill:t,opacity:n};break;case"Box":a.height=a.width=10,s[0]={name:"rect",width:13,height:13,fill:"#ffffff",opacity:n},s[1]={name:"rect",x:1.5,y:1.5,width:10,height:9,fill:t,opacity:n};break;case"HorizontalStripe":a.height=12,a.width=10,s[0]={name:"rect",x:0,y:0,width:10,height:12,transform:"translate(0,0)",fill:"#ffffff",opacity:n},s[1]={name:"path",d:"M0,0.5 L10 0.5 M0,4.5 L10 4.5 M0,8.5 L10 8.5 z","stroke-width":1,stroke:t,fill:t};break;case"VerticalStripe":a.height=10,a.width=12,s[0]={name:"rect",x:0,y:0,width:12,height:10,transform:"translate(0,0)",fill:"#ffffff",opacity:n},s[1]={name:"path",d:"M0.5,0 L0.5 10 M4.5,0 L4.5 10 M8.5,0 L8.5 10 z","stroke-width":1,stroke:t,fill:t};break;case"Bubble":a.height=a.width=20,s[0]={name:"rect",x:0,y:0,width:20,height:20,transform:"translate(0,0)",fill:"#ffffff",opacity:n},s[1]={name:"circle",cx:5.217,cy:11.325,r:3.429,"stroke-width":1,fill:"#D0A6D1"},s[2]={name:"circle",cx:13.328,cy:6.24,r:4.884,"stroke-width":1,fill:t},s[3]={name:"circle",cx:13.277,cy:14.66,r:3.018,"stroke-width":1,fill:"#D0A6D1"}}var l=e.svgRenderer||e.renderer,h=l.createPattern(a,"pattern");return this.loadPattern(e,s,h,l),o.appendChild(h),"url(#"+e.element.id+"_"+r+"_Selection_"+i+")"},e.prototype.loadPattern=function(e,t,i,r){var n;for(n=0;n<t.length;n++){var o=r.createPattern(t[n],t[n].name);i.appendChild(o)}},e.prototype.concatIndexes=function(e,t){return e.concat(t)},e.prototype.checkVisibility=function(e){if(!e)return!1;for(var t=!1,i=[],r=0,n=e;r<n.length;r++){var o=n[r];-1===i.indexOf(o.series)&&i.push(o.series)}for(var s=0,a=i;s<a.length;s++){o=a[s];if(this.control.series[o].visible){t=!0;break}}return t},e.prototype.addSvgClass=function(e,t){var i=e.getAttribute("class")||"";-1===(i+=""!==i?" ":"").indexOf(t)&&e.setAttribute("class",i+t)},e.prototype.removeSvgClass=function(e,t){var i=e.getAttribute("class")||"";i.indexOf(t)>-1&&e.setAttribute("class",i.replace(t,""))},e.prototype.getChildren=function(e){for(var t=[],i=0;i<e.childNodes.length;i++)"defs"!==e.childNodes[i].tagName&&t.push(e.childNodes[i]);return t},e}(),At=(Ze=function(e,t){return(Ze=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}Ze(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),Lt=function(e){function t(t){var i=e.call(this,t)||this;return i.renderer=t.renderer,i}return At(t,e),t.prototype.initPrivateVariables=function(e){this.styleId=e.element.id+"_ej2_chart_selection",this.unselected=e.element.id+"_ej2_deselected",this.selectedDataIndexes=[],this.rectPoints=null},t.prototype.invokeSelection=function(e){this.initPrivateVariables(e),this.series=sf.base.extend({},e.visibleSeries,null,!0),this.seriesStyles(),this.selectDataIndex(this.concatIndexes(e.selectedDataIndexes,this.selectedDataIndexes),e)},t.prototype.generateStyle=function(e){return e.selectionStyle||this.styleId+"_series_"+e.index},t.prototype.findElements=function(e,t,i){return[this.getElementByIndex(i)]},t.prototype.getElementByIndex=function(e){var t=this.control.element.id+"_Series_"+e.series+"_Point_"+e.point;return document.getElementById(t)},t.prototype.calculateSelectedElements=function(e,t){-1!==t.target.id.indexOf(e.element.id+"_")&&(t.target.id.indexOf("_Series_")>-1||t.target.id.indexOf("_datalabel_")>-1)&&this.performSelection(G(t.target.id),e,t.target)},t.prototype.performSelection=function(e,t,i){switch(i=i.id.indexOf("datalabel")>-1?t.getSeriesElement().childNodes[e.series].childNodes[e.point]:i,t.selectionMode){case"Point":isNaN(e.point)||(this.selection(t,e,[i]),this.blurEffect(t.element.id,t.visibleSeries))}},t.prototype.selection=function(e,t,i){e.isMultiSelect||this.removeMultiSelectEelments(e,this.selectedDataIndexes,t,e.series);var r=i[0]&&(i[0].getAttribute("class")||"");if(i[0]&&r.indexOf(this.getSelectionClass(i[0].id))>-1){if(this.removeStyles(i,t),this.addOrRemoveIndex(this.selectedDataIndexes,t),e.enableBorderOnMouseMove){var n=document.getElementById(i[0].id.split("_")[0]+"PointHover_Border");sf.base.isNullOrUndefined(n)||this.removeSvgClass(n,n.getAttribute("class"))}}else{if(this.applyStyles(i,t),e.enableBorderOnMouseMove){n=document.getElementById(i[0].id.split("_")[0]+"PointHover_Border");sf.base.isNullOrUndefined(n)||this.addSvgClass(n,i[0].getAttribute("class"))}this.addOrRemoveIndex(this.selectedDataIndexes,t,!0)}},t.prototype.redrawSelection=function(e){var t=sf.base.extend([],this.selectedDataIndexes,null,!0);this.removeSelectedElements(e,this.selectedDataIndexes),this.blurEffect(e.element.id,e.visibleSeries),this.selectDataIndex(t,e)},t.prototype.removeSelectedElements=function(e,t){for(var i=0,r=t;i<r.length;i++){var n=r[i];this.removeStyles([this.getElementByIndex(n)],n)}},t.prototype.legendSelection=function(e,t,i){var r=e.getSeriesElement().childNodes[t].childNodes[i];this.selection(e,new m(t,i),[r]),this.blurEffect(e.element.id,e.visibleSeries)},t.prototype.selectDataIndex=function(e,t){for(var i,r=0,n=e;r<n.length;r++){var o=n[r];(i=this.getElementByIndex(o))&&this.performSelection(o,t,i)}},t.prototype.removeMultiSelectEelments=function(e,t,i,r){for(var n,o=0;o<t.length;o++)n=r[t[o].series],this.checkEquals(t[o],i)||(this.removeStyles(this.findElements(e,n,t[o]),t[o]),t.splice(o,1),o--)},t.prototype.blurEffect=function(e,t){for(var i=this.checkPointVisibility(this.selectedDataIndexes),r=0,n=t;r<n.length;r++){var o=n[r];o.visible&&this.checkSelectionElements(document.getElementById(e+"_SeriesCollection"),this.generateStyle(o),i)}},t.prototype.checkSelectionElements=function(e,t,i){for(var r,n,o,s=e.childNodes[0].childNodes,a=0;a<s.length;a++)n=s[a].getAttribute("class")||"",o=s[a].parentNode.getAttribute("class")||"",-1===n.indexOf(t)&&-1===o.indexOf(t)&&i?this.addSvgClass(s[a],this.unselected):this.removeSvgClass(s[a],this.unselected),this.control.accumulationLegendModule&&this.control.legendSettings.visible&&(r=document.getElementById(this.control.element.id+"_chart_legend_shape_"+a))&&(-1===n.indexOf(t)&&-1===o.indexOf(t)&&i?this.addSvgClass(r,this.unselected):this.removeSvgClass(r,this.unselected))},t.prototype.applyStyles=function(e,t){for(var i=this.control.accumulationTooltipModule,r=0,n=e;r<n.length;r++){var o=n[r],s=void 0;if(o){this.control.accumulationLegendModule&&this.control.legendSettings.visible&&(s=document.getElementById(this.control.element.id+"_chart_legend_shape_"+t.point),this.removeSvgClass(s,this.unselected),this.addSvgClass(s,this.getSelectionClass(s.id))),this.removeSvgClass(o.parentNode,this.unselected),this.removeSvgClass(o,this.unselected);var a=i&&i.previousPoints.length>0&&i.previousPoints[0].point.index!==t.point?i.svgTooltip.opacity:this.series[t.series].opacity;o.setAttribute("opacity",a.toString()),this.addSvgClass(o,this.getSelectionClass(o.id))}}},t.prototype.getSelectionClass=function(e){return this.generateStyle(this.control.series[G(e).series])},t.prototype.removeStyles=function(e,t){for(var i,r=this.control.accumulationTooltipModule,n=0,o=e;n<o.length;n++){var s=o[n];if(s){this.control.accumulationLegendModule&&this.control.legendSettings.visible&&(i=document.getElementById(this.control.element.id+"_chart_legend_shape_"+t.point),this.removeSvgClass(i,this.getSelectionClass(i.id)));var a=r&&r.previousPoints.length>0&&r.previousPoints[0].point.index===t.point?r.svgTooltip.opacity:this.series[t.series].opacity;s.setAttribute("opacity",a.toString()),this.removeSvgClass(s,this.getSelectionClass(s.id))}}},t.prototype.addOrRemoveIndex=function(e,t,i){for(var r=0;r<e.length;r++)this.checkEquals(e[r],t)&&(e.splice(r,1),r--);i&&e.push(t)},t.prototype.checkEquals=function(e,t){return e.point===t.point&&e.series===t.series},t.prototype.checkPointVisibility=function(e){for(var t=!1,i=0,r=e;i<r.length;i++){if(Re(r[i].point,this.control.visibleSeries[0].points).visible){t=!0;break}}return t},t.prototype.getModuleName=function(){return"AccumulationSelection"},t.prototype.destroy=function(){},t}(Pt),Ft=function(){function e(e){this.control=e}return e.prototype.render=function(e,t){return this.isChart="chart"===this.control.getModuleName(),this.annotation=e,se(sf.base.createElement("div",{id:this.control.element.id+"_Annotation_"+t,styles:"position: absolute; z-index: 1"}),t,e.content,this.control)},e.prototype.setAnnotationPixelValue=function(e){var t="Chart"===this.annotation.region?new sf.svgbase.Rect(0,0,this.control.availableSize.width,this.control.availableSize.height):this.isChart?this.control.chartAxisLayoutPanel.seriesClipRect:this.control.series[0].accumulationBound;return e.x=("string"!=typeof this.annotation.x?"number"==typeof this.annotation.x?this.annotation.x:0:ge(this.annotation.x,t.width))+t.x,e.y=("number"==typeof this.annotation.y?this.annotation.y:ge(this.annotation.y,t.height))+t.y,!0},e.prototype.setAnnotationPointValue=function(e){var t=new Se(0,0);if(this.isChart){for(var r=this.control,n=this.annotation,o=n.xAxisName,s=n.yAxisName,a=r.requireInvertedAxis,l=this.control.stockChart,h=void 0,d=void 0,c=void 0,p=0,u=r.axisCollections;p<u.length;p++){var g=u[p];if(o===g.name||null==o&&"primaryXAxis"===g.name)if((h=g).valueType.indexOf("Category")>-1){var f="DateTimeCategory"===h.valueType?n.x.getTime().toString():n.x;if(h.labels.indexOf(f)<0)return!1;c=h.labels.indexOf(f)}else if("DateTime"===h.valueType){var m={skeleton:"full",type:"dateTime"};c="object"===i(this.annotation.x)||"object"===i(new Date(this.annotation.x))?Date.parse(r.intl.getDateParser(m)(r.intl.getDateFormat(m)(new Date(sf.data.DataUtil.parse.parseJson({val:n.x}).val)))):0}else c=+n.x;else(s===g.name||null==s&&"primaryYAxis"===g.name)&&(d=g)}return!!(h&&d&&V("Logarithmic"===h.valueType?B(c,h.logBase):c,h.visibleRange)&&V("Logarithmic"===d.valueType?B(+n.y,d.logBase):+n.y,d.visibleRange))&&(t=function(e,t,i,r,n){e="Logarithmic"===i.valueType?B(e>0?e:Math.pow(i.logBase,i.visibleRange.min),i.logBase):e,t="Logarithmic"===r.valueType?B(t>0?t:Math.pow(r.logBase,r.visibleRange.min),r.logBase):t,e=q(e,i),t=q(t,r);var o=n?i.rect.height:i.rect.width,s=n?r.rect.width:r.rect.height;return new Se(n?t*s:e*o,n?(1-e)*o:(1-t)*s)}(c,+n.y,h,d,a),e.x=t.x+(a?d.rect.x:h.rect.x),e.y=t.y+(a?h.rect.y:d.rect.y)+(l&&l.enablePeriodSelector?l.toolbarHeight+l.titleSize.height:0),!0)}return this.setAccumulationPointValue(e)},e.prototype.processAnnotation=function(e,t,i){var r=this.control,n=new Se(0,0),o=this.render(e,t),s=function(){o.style.transform="translate(-50%, -50%)"};s.bind(n,this),this["setAnnotation"+e.coordinateUnits+"Value"](n)?this.setElementStyle(n,o,i):this.control.redraw&&H(o.id),sf.base.updateBlazorTemplate((this.control.element.id+"Annotation"+t).replace(/[^a-zA-Z0-9]/g,""),"ContentTemplate",r.stockChart?r.stockChart.annotations[t]:this.control.annotations[t],void 0,s)},e.prototype.setAccumulationPointValue=function(e){for(var t,r=0,n=this.control.visibleSeries[0].points;r<n.length;r++){var o=n[r];if("object"===i(o.x)){if(Date.parse(o.x)===Date.parse(this.annotation.x)&&o.y===this.annotation.y){t=o;break}}else if(o.x==this.annotation.x&&o.y==this.annotation.y){t=o;break}}return!(!t||!t.visible)&&(e.x=t.symbolLocation.x,e.y=t.symbolLocation.y,!0)},e.prototype.setElementStyle=function(e,t,i){var r=ae(t,this.control.redraw),n={cancel:!1,name:"annotationRender",content:t,location:e};this.control.trigger("annotationRender",n),n.cancel||(n.content.style.left=this.setAlignmentValue(this.annotation.horizontalAlignment,r.width,n.location.x)+"px",n.content.style.top=this.setAlignmentValue(this.annotation.verticalAlignment,r.height,n.location.y)+"px",n.content.setAttribute("aria-label",this.annotation.description||"Annotation"),le(n.content,i,this.control.redraw,!0,"left","top"))},e.prototype.setAlignmentValue=function(e,t,i){switch(e){case"Top":case"Near":i-=t;break;case"Bottom":case"Far":i+=0;break;case"Middle":case"Center":i-=t/2}return i},e}(),Dt=(Ke=function(e,t){return(Ke=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}Ke(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),Et=function(e){function t(t){var i=e.call(this,t)||this;return i.pie=t,i}return Dt(t,e),t.prototype.renderAnnotations=function(e){var t=this;this.annotations=this.pie.annotations;var i=this.pie.redraw;this.parentElement=fe(i,this.pie.element.id+"_Annotation_Collections")||sf.base.createElement("div",{id:this.pie.element.id+"_Annotation_Collections"}),this.annotations.map((function(e,i){t.processAnnotation(e,i,t.parentElement)})),le(this.parentElement,e,i)},t.prototype.getModuleName=function(){return"Annotation"},t.prototype.destroy=function(){},t}(Ft),zt=function(){function e(e){this.chart=e}return e.prototype.export=function(e,t,i,r,n,o,s,a,l){var h=new dt(this.chart);r=r||[this.chart];var d={cancel:!1,name:"beforeExport",width:n,height:o};this.chart.trigger("beforeExport",d),d.cancel||h.export(e,t,i,r,n=d.width,o=d.height,s,a,l)},e.prototype.getDataUrl=function(e){return new dt(e).getDataUrl(e)},e.prototype.getModuleName=function(){return"Export"},e.prototype.destroy=function(){},e}();return ut.Inject(ht,yt,bt,Tt,xt,Lt,Nt,Et,zt),e.AccumulationChart=ut,e.AccumulationAnnotationSettings=Fe,e.AccumulationDataLabelSettings=De,e.PieCenter=Ee,e.AccPoints=ze,e.AccumulationSeries=ke,e.getSeriesFromIndex=We,e.pointByIndex=Re,e.PieSeries=ht,e.FunnelSeries=yt,e.PyramidSeries=bt,e.AccumulationLegend=xt,e.AccumulationDataLabel=Nt,e.AccumulationTooltip=Tt,e.AccumulationSelection=Lt,e.AccumulationAnnotation=Et,e.Export=zt,e}({}))},"./modules/base.js":function(e,t){function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}window.sf=window.sf||{},window.sf.base=function(e){"use strict";var t="ej2_instances",r=0,n=!1;function o(e,t){var i=t;return i.unshift(void 0),new(Function.prototype.bind.apply(e,i))}function s(e){var t,i=new Uint16Array(5);(window.msCrypto||window.crypto).getRandomValues(i);var r="ej2"+function(e){for(var t="",i=0;i<5;i++)t+=(i?",":"")+e[parseInt(i.toString(),10)];return t}(i),n=function(i){i.source===window&&"string"==typeof i.data&&i.data.length<=32&&i.data===r&&(e(),t())};return window.addEventListener("message",n,!1),window.postMessage(r,"*"),t=function(){window.removeEventListener("message",n),e=n=r=void 0}}function a(e,t){for(var i=t,r=e.replace(/\[/g,".").replace(/\]/g,"").split("."),n=0;n<r.length&&!f(i);n++)i=i[r[parseInt(n.toString(),10)]];return i}function l(e,t,i){var r,n,o=e.replace(/\[/g,".").replace(/\]/g,"").split("."),s=i||{},a=s,l=o.length;for(r=0;r<l;r++)n=o[parseInt(r.toString(),10)],r+1===l?a[""+n]=void 0===t?{}:t:g(a[""+n])&&(a[""+n]={}),a=a[""+n];return s}function h(e,t){delete e[""+t]}var d="undefined"!=typeof window?window:{};function c(e){return!g(e)&&e.constructor==={}.constructor}function p(e,t){if(!g(t))for(var i=e,r=t,n=0,o=Object.keys(t);n<o.length;n++){var s=o[n];g(i.deepMerge)||-1===i.deepMerge.indexOf(s)||!c(r[""+s])&&!Array.isArray(r[""+s])?i[""+s]=r[""+s]:u(i[""+s],i[""+s],r[""+s],!0)}}function u(e,t,r,n){var o=e&&"object"===i(e)?e:{},s=arguments.length;n&&(s-=1);for(var a=function(e){if(!l[e])return"continue";var t=l[e];Object.keys(t).forEach((function(e){var i,r=o[""+e],s=t[""+e],a=Array.isArray(s)&&Array.isArray(r)&&s.length!==r.length,l=!b()||!(r instanceof Event||a);n&&l&&(c(s)||Array.isArray(s))?c(s)?(i=r||{},Array.isArray(i)&&i.hasOwnProperty("isComplexArray")?u(i,{},s,n):o[""+e]=u(i,{},s,n)):(i=b()?r&&Object.keys(s).length:r||[],o[""+e]=u([],i,s,i&&i.length||s&&s.length)):o[""+e]=s}))},l=arguments,h=1;h<s;h++)a(h);return o}function g(e){return null==e}function f(e){return void 0===e}function m(e,t){var i;return function(){var r=this,n=arguments,o=function(){return i=null,e.apply(r,n)};clearTimeout(i),i=setTimeout(o,t)}}function y(e,t){return e===t||!(e===document||!e)&&y(e.parentNode,t)}function v(e){try{throw new Error(e)}catch(e){throw e.message+"\n"+e.stack}}function b(){return n}function w(){if("undefined"!=typeof window){var e=new Uint16Array(5);return(window.msCrypto||window.crypto).getRandomValues(e)}}var x,M,N={latn:{_digits:"0123456789",_type:"numeric"}},I={decimal:".",group:",",percentSign:"%",plusSign:"+",minusSign:"-",infinity:"∞",nan:"NaN",exponential:"E"},S=[0,1,2,3,4,5,6,7,8,9],C=function(){function e(){}return e.getMainObject=function(e,t){return a(b()?t:"main."+t,e)},e.getNumberingSystem=function(e){return a("supplemental.numberingSystems",e)||this.numberingSystems},e.reverseObject=function(e,t){for(var i={},r=0,n=t||Object.keys(e);r<n.length;r++){var o=n[r];i.hasOwnProperty(e[o])||(i[e[o]]=o)}return i},e.getSymbolRegex=function(e){var t=e.map((function(e){return e.replace(/([.*+?^=!:${}()|[\]/\\])/g,"\\$1")})).join("|");return new RegExp(t,"g")},e.getSymbolMatch=function(e){for(var t={},i=0,r=Object.keys(I);i<r.length;i++){var n=r[i];t[e[n]]=I[n]}return t},e.constructRegex=function(e){for(var t=e.length,i="",r=0;r<t;r++)i+=r!==t-1?e[parseInt(r.toString(),10)]+"|":e[parseInt(r.toString(),10)];return i},e.convertValueParts=function(e,t,i){return e.replace(t,(function(e){return i[e]}))},e.getDefaultNumberingSystem=function(e){var t={};return t.obj=a("numbers",e),t.nSystem=a("defaultNumberingSystem",t.obj),t},e.getCurrentNumericOptions=function(e,t,i,r){var n={},o=this.getDefaultNumberingSystem(e);if(!f(o.nSystem)||r){var s=r?a("obj.mapperDigits",o):a(o.nSystem+"._digits",t);f(s)||(n.numericPair=this.reverseObject(s,S),n.numberParseRegex=new RegExp(this.constructRegex(s),"g"),n.numericRegex="["+s[0]+"-"+s[9]+"]",i&&(n.numericRegex=s[0]+"-"+s[9],n.symbolNumberSystem=a(r?"numberSymbols":"symbols-numberSystem-"+o.nSystem,o.obj),n.symbolMatch=this.getSymbolMatch(n.symbolNumberSystem),n.numberSystem=o.nSystem))}return n},e.getNumberMapper=function(e,t,i){var r={mapper:{}},n=this.getDefaultNumberingSystem(e);if(!f(n.nSystem)){r.numberSystem=n.nSystem,r.numberSymbols=a("symbols-numberSystem-"+n.nSystem,n.obj),r.timeSeparator=a("timeSeparator",r.numberSymbols);var o=a(n.nSystem+"._digits",t);if(!f(o))for(var s=0,l=S;s<l.length;s++){var h=l[s];r.mapper[h]=o[h]}}return r},e.nPair="numericPair",e.nRegex="numericRegex",e.numberingSystems=N,e}(),O={DJF:"Fdj",ERN:"Nfk",ETB:"Br",NAD:"$",ZAR:"R",XAF:"FCFA",GHS:"GH₵",XDR:"XDR",AED:"د.إ.‏",BHD:"د.ب.‏",DZD:"د.ج.‏",EGP:"ج.م.‏",ILS:"₪",IQD:"د.ع.‏",JOD:"د.ا.‏",KMF:"CF",KWD:"د.ك.‏",LBP:"ل.ل.‏",LYD:"د.ل.‏",MAD:"د.م.‏",MRU:"أ.م.",OMR:"ر.ع.‏",QAR:"ر.ق.‏",SAR:"ر.س.‏",SDG:"ج.س.",SOS:"S",SSP:"£",SYP:"ل.س.‏",TND:"د.ت.‏",YER:"ر.ي.‏",CLP:"$",INR:"₹",TZS:"TSh",EUR:"€",AZN:"₼",RUB:"₽",BYN:"Br",ZMW:"K",BGN:"лв.",NGN:"₦",XOF:"CFA",BDT:"৳",CNY:"¥",BAM:"КМ",UGX:"USh",USD:"$",CZK:"Kč",GBP:"£",DKK:"kr.",KES:"Ksh",CHF:"CHF",MVR:"ރ.",BTN:"Nu.",XCD:"EC$",AUD:"$",BBD:"$",BIF:"FBu",BMD:"$",BSD:"$",BWP:"P",BZD:"$",CAD:"$",NZD:"$",FJD:"$",FKP:"£",GIP:"£",GMD:"D",GYD:"$",HKD:"$",IDR:"Rp",JMD:"$",KYD:"$",LRD:"$",MGA:"Ar",MOP:"MOP$",MUR:"Rs",MWK:"MK",MYR:"RM",PGK:"K",PHP:"₱",PKR:"Rs",RWF:"RF",SBD:"$",SCR:"SR",SEK:"kr",SGD:"$",SHP:"£",SLL:"Le",ANG:"NAf.",SZL:"E",TOP:"T$",TTD:"$",VUV:"VT",WST:"WS$",ARS:"$",BOB:"Bs",BRL:"R$",COP:"$",CRC:"₡",CUP:"$",DOP:"$",GTQ:"Q",HNL:"L",MXN:"$",NIO:"C$",PAB:"B/.",PEN:"S/",PYG:"₲",UYU:"$",VES:"Bs.S",IRR:"ريال",GNF:"FG",CDF:"FC",HTG:"G",XPF:"FCFP",HRK:"kn",HUF:"Ft",AMD:"֏",ISK:"kr",JPY:"¥",GEL:"₾",CVE:"​",KZT:"₸",KHR:"៛",KPW:"₩",KRW:"₩",KGS:"сом",AOA:"Kz",LAK:"₭",MZN:"MTn",MKD:"ден",MNT:"₮",BND:"$",MMK:"K",NOK:"kr",NPR:"रु",AWG:"Afl.",SRD:"$",PLN:"zł",AFN:"؋",STN:"Db",MDL:"L",RON:"lei",UAH:"₴",LKR:"රු.",ALL:"Lekë",RSD:"дин.",TJS:"смн",THB:"฿",TMT:"m.",TRY:"₺",UZS:"сўм",VND:"₫",TWD:"NT$"};x=e.HijriParser||(e.HijriParser={}),M=[28607,28636,28665,28695,28724,28754,28783,28813,28843,28872,28901,28931,28960,28990,29019,29049,29078,29108,29137,29167,29196,29226,29255,29285,29315,29345,29375,29404,29434,29463,29492,29522,29551,29580,29610,29640,29669,29699,29729,29759,29788,29818,29847,29876,29906,29935,29964,29994,30023,30053,30082,30112,30141,30171,30200,30230,30259,30289,30318,30348,30378,30408,30437,30467,30496,30526,30555,30585,30614,30644,30673,30703,30732,30762,30791,30821,30850,30880,30909,30939,30968,30998,31027,31057,31086,31116,31145,31175,31204,31234,31263,31293,31322,31352,31381,31411,31441,31471,31500,31530,31559,31589,31618,31648,31676,31706,31736,31766,31795,31825,31854,31884,31913,31943,31972,32002,32031,32061,32090,32120,32150,32180,32209,32239,32268,32298,32327,32357,32386,32416,32445,32475,32504,32534,32563,32593,32622,32652,32681,32711,32740,32770,32799,32829,32858,32888,32917,32947,32976,33006,33035,33065,33094,33124,33153,33183,33213,33243,33272,33302,33331,33361,33390,33420,33450,33479,33509,33539,33568,33598,33627,33657,33686,33716,33745,33775,33804,33834,33863,33893,33922,33952,33981,34011,34040,34069,34099,34128,34158,34187,34217,34247,34277,34306,34336,34365,34395,34424,34454,34483,34512,34542,34571,34601,34631,34660,34690,34719,34749,34778,34808,34837,34867,34896,34926,34955,34985,35015,35044,35074,35103,35133,35162,35192,35222,35251,35280,35310,35340,35370,35399,35429,35458,35488,35517,35547,35576,35605,35635,35665,35694,35723,35753,35782,35811,35841,35871,35901,35930,35960,35989,36019,36048,36078,36107,36136,36166,36195,36225,36254,36284,36314,36343,36373,36403,36433,36462,36492,36521,36551,36580,36610,36639,36669,36698,36728,36757,36786,36816,36845,36875,36904,36934,36963,36993,37022,37052,37081,37111,37141,37170,37200,37229,37259,37288,37318,37347,37377,37406,37436,37465,37495,37524,37554,37584,37613,37643,37672,37701,37731,37760,37790,37819,37849,37878,37908,37938,37967,37997,38027,38056,38085,38115,38144,38174,38203,38233,38262,38292,38322,38351,38381,38410,38440,38469,38499,38528,38558,38587,38617,38646,38676,38705,38735,38764,38794,38823,38853,38882,38912,38941,38971,39001,39030,39059,39089,39118,39148,39178,39208,39237,39267,39297,39326,39355,39385,39414,39444,39473,39503,39532,39562,39592,39621,39650,39680,39709,39739,39768,39798,39827,39857,39886,39916,39946,39975,40005,40035,40064,40094,40123,40153,40182,40212,40241,40271,40300,40330,40359,40389,40418,40448,40477,40507,40536,40566,40595,40625,40655,40685,40714,40744,40773,40803,40832,40862,40892,40921,40951,40980,41009,41039,41068,41098,41127,41157,41186,41216,41245,41275,41304,41334,41364,41393,41422,41452,41481,41511,41540,41570,41599,41629,41658,41688,41718,41748,41777,41807,41836,41865,41894,41924,41953,41983,42012,42042,42072,42102,42131,42161,42190,42220,42249,42279,42308,42337,42367,42397,42426,42456,42485,42515,42545,42574,42604,42633,42662,42692,42721,42751,42780,42810,42839,42869,42899,42929,42958,42988,43017,43046,43076,43105,43135,43164,43194,43223,43253,43283,43312,43342,43371,43401,43430,43460,43489,43519,43548,43578,43607,43637,43666,43696,43726,43755,43785,43814,43844,43873,43903,43932,43962,43991,44021,44050,44080,44109,44139,44169,44198,44228,44258,44287,44317,44346,44375,44405,44434,44464,44493,44523,44553,44582,44612,44641,44671,44700,44730,44759,44788,44818,44847,44877,44906,44936,44966,44996,45025,45055,45084,45114,45143,45172,45202,45231,45261,45290,45320,45350,45380,45409,45439,45468,45498,45527,45556,45586,45615,45644,45674,45704,45733,45763,45793,45823,45852,45882,45911,45940,45970,45999,46028,46058,46088,46117,46147,46177,46206,46236,46265,46295,46324,46354,46383,46413,46442,46472,46501,46531,46560,46590,46620,46649,46679,46708,46738,46767,46797,46826,46856,46885,46915,46944,46974,47003,47033,47063,47092,47122,47151,47181,47210,47240,47269,47298,47328,47357,47387,47417,47446,47476,47506,47535,47565,47594,47624,47653,47682,47712,47741,47771,47800,47830,47860,47890,47919,47949,47978,48008,48037,48066,48096,48125,48155,48184,48214,48244,48273,48303,48333,48362,48392,48421,48450,48480,48509,48538,48568,48598,48627,48657,48687,48717,48746,48776,48805,48834,48864,48893,48922,48952,48982,49011,49041,49071,49100,49130,49160,49189,49218,49248,49277,49306,49336,49365,49395,49425,49455,49484,49514,49543,49573,49602,49632,49661,49690,49720,49749,49779,49809,49838,49868,49898,49927,49957,49986,50016,50045,50075,50104,50133,50163,50192,50222,50252,50281,50311,50340,50370,50400,50429,50459,50488,50518,50547,50576,50606,50635,50665,50694,50724,50754,50784,50813,50843,50872,50902,50931,50960,50990,51019,51049,51078,51108,51138,51167,51197,51227,51256,51286,51315,51345,51374,51403,51433,51462,51492,51522,51552,51582,51611,51641,51670,51699,51729,51758,51787,51816,51846,51876,51906,51936,51965,51995,52025,52054,52083,52113,52142,52171,52200,52230,52260,52290,52319,52349,52379,52408,52438,52467,52497,52526,52555,52585,52614,52644,52673,52703,52733,52762,52792,52822,52851,52881,52910,52939,52969,52998,53028,53057,53087,53116,53146,53176,53205,53235,53264,53294,53324,53353,53383,53412,53441,53471,53500,53530,53559,53589,53619,53648,53678,53708,53737,53767,53796,53825,53855,53884,53913,53943,53973,54003,54032,54062,54092,54121,54151,54180,54209,54239,54268,54297,54327,54357,54387,54416,54446,54476,54505,54535,54564,54593,54623,54652,54681,54711,54741,54770,54800,54830,54859,54889,54919,54948,54977,55007,55036,55066,55095,55125,55154,55184,55213,55243,55273,55302,55332,55361,55391,55420,55450,55479,55508,55538,55567,55597,55627,55657,55686,55716,55745,55775,55804,55834,55863,55892,55922,55951,55981,56011,56040,56070,56100,56129,56159,56188,56218,56247,56276,56306,56335,56365,56394,56424,56454,56483,56513,56543,56572,56601,56631,56660,56690,56719,56749,56778,56808,56837,56867,56897,56926,56956,56985,57015,57044,57074,57103,57133,57162,57192,57221,57251,57280,57310,57340,57369,57399,57429,57458,57487,57517,57546,57576,57605,57634,57664,57694,57723,57753,57783,57813,57842,57871,57901,57930,57959,57989,58018,58048,58077,58107,58137,58167,58196,58226,58255,58285,58314,58343,58373,58402,58432,58461,58491,58521,58551,58580,58610,58639,58669,58698,58727,58757,58786,58816,58845,58875,58905,58934,58964,58994,59023,59053,59082,59111,59141,59170,59200,59229,59259,59288,59318,59348,59377,59407,59436,59466,59495,59525,59554,59584,59613,59643,59672,59702,59731,59761,59791,59820,59850,59879,59909,59939,59968,59997,60027,60056,60086,60115,60145,60174,60204,60234,60264,60293,60323,60352,60381,60411,60440,60469,60499,60528,60558,60588,60618,60648,60677,60707,60736,60765,60795,60824,60853,60883,60912,60942,60972,61002,61031,61061,61090,61120,61149,61179,61208,61237,61267,61296,61326,61356,61385,61415,61445,61474,61504,61533,61563,61592,61621,61651,61680,61710,61739,61769,61799,61828,61858,61888,61917,61947,61976,62006,62035,62064,62094,62123,62153,62182,62212,62242,62271,62301,62331,62360,62390,62419,62448,62478,62507,62537,62566,62596,62625,62655,62685,62715,62744,62774,62803,62832,62862,62891,62921,62950,62980,63009,63039,63069,63099,63128,63157,63187,63216,63246,63275,63305,63334,63363,63393,63423,63453,63482,63512,63541,63571,63600,63630,63659,63689,63718,63747,63777,63807,63836,63866,63895,63925,63955,63984,64014,64043,64073,64102,64131,64161,64190,64220,64249,64279,64309,64339,64368,64398,64427,64457,64486,64515,64545,64574,64603,64633,64663,64692,64722,64752,64782,64811,64841,64870,64899,64929,64958,64987,65017,65047,65076,65106,65136,65166,65195,65225,65254,65283,65313,65342,65371,65401,65431,65460,65490,65520,65549,65579,65608,65638,65667,65697,65726,65755,65785,65815,65844,65874,65903,65933,65963,65992,66022,66051,66081,66110,66140,66169,66199,66228,66258,66287,66317,66346,66376,66405,66435,66465,66494,66524,66553,66583,66612,66641,66671,66700,66730,66760,66789,66819,66849,66878,66908,66937,66967,66996,67025,67055,67084,67114,67143,67173,67203,67233,67262,67292,67321,67351,67380,67409,67439,67468,67497,67527,67557,67587,67617,67646,67676,67705,67735,67764,67793,67823,67852,67882,67911,67941,67971,68e3,68030,68060,68089,68119,68148,68177,68207,68236,68266,68295,68325,68354,68384,68414,68443,68473,68502,68532,68561,68591,68620,68650,68679,68708,68738,68768,68797,68827,68857,68886,68916,68946,68975,69004,69034,69063,69092,69122,69152,69181,69211,69240,69270,69300,69330,69359,69388,69418,69447,69476,69506,69535,69565,69595,69624,69654,69684,69713,69743,69772,69802,69831,69861,69890,69919,69949,69978,70008,70038,70067,70097,70126,70156,70186,70215,70245,70274,70303,70333,70362,70392,70421,70451,70481,70510,70540,70570,70599,70629,70658,70687,70717,70746,70776,70805,70835,70864,70894,70924,70954,70983,71013,71042,71071,71101,71130,71159,71189,71218,71248,71278,71308,71337,71367,71397,71426,71455,71485,71514,71543,71573,71602,71632,71662,71691,71721,71751,71781,71810,71839,71869,71898,71927,71957,71986,72016,72046,72075,72105,72135,72164,72194,72223,72253,72282,72311,72341,72370,72400,72429,72459,72489,72518,72548,72577,72607,72637,72666,72695,72725,72754,72784,72813,72843,72872,72902,72931,72961,72991,73020,73050,73080,73109,73139,73168,73197,73227,73256,73286,73315,73345,73375,73404,73434,73464,73493,73523,73552,73581,73611,73640,73669,73699,73729,73758,73788,73818,73848,73877,73907,73936,73965,73995,74024,74053,74083,74113,74142,74172,74202,74231,74261,74291,74320,74349,74379,74408,74437,74467,74497,74526,74556,74586,74615,74645,74675,74704,74733,74763,74792,74822,74851,74881,74910,74940,74969,74999,75029,75058,75088,75117,75147,75176,75206,75235,75264,75294,75323,75353,75383,75412,75442,75472,75501,75531,75560,75590,75619,75648,75678,75707,75737,75766,75796,75826,75856,75885,75915,75944,75974,76003,76032,76062,76091,76121,76150,76180,76210,76239,76269,76299,76328,76358,76387,76416,76446,76475,76505,76534,76564,76593,76623,76653,76682,76712,76741,76771,76801,76830,76859,76889,76918,76948,76977,77007,77036,77066,77096,77125,77155,77185,77214,77243,77273,77302,77332,77361,77390,77420,77450,77479,77509,77539,77569,77598,77627,77657,77686,77715,77745,77774,77804,77833,77863,77893,77923,77952,77982,78011,78041,78070,78099,78129,78158,78188,78217,78247,78277,78307,78336,78366,78395,78425,78454,78483,78513,78542,78572,78601,78631,78661,78690,78720,78750,78779,78808,78838,78867,78897,78926,78956,78985,79015,79044,79074,79104,79133,79163,79192,79222,79251,79281,79310,79340,79369,79399,79428,79458,79487,79517,79546,79576,79606,79635,79665,79695,79724,79753,79783,79812,79841,79871,79900,79930,79960,79990],x.getHijriDate=function(e){var t=e.getDate(),i=e.getMonth(),r=e.getFullYear(),n=i+1,o=r;n<3&&(o-=1,n+=12);var s=Math.floor(o/100),a=s-Math.floor(s/4)-2,l=Math.floor(365.25*(o+4716))+Math.floor(30.6001*(n+1))+t-a-1524,h=l+(a=(s=Math.floor((l-1867216.25)/36524.25))-Math.floor(s/4)+1)+1524,d=Math.floor((h-122.1)/365.25),c=Math.floor(365.25*d),p=Math.floor((h-c)/30.6001);t=h-c-Math.floor(30.6001*p),(i=Math.floor((h-c)/20.6001))>13&&(d+=1,i-=12),i-=1,r=d-4716;var u=l-24e5,g=l-1948084,f=Math.floor(g/10631);g-=10631*f;var m=Math.floor((g-.1335)/(10631/30)),y=30*f+m;g-=Math.floor(m*(10631/30)+.1335);var v=Math.floor((g+28.5001)/29.5);13===v&&(v=12);for(var b=g-Math.floor(29.5001*v-29),w=0;w<M.length&&!(M[parseInt(w.toString(),10)]>u);w++);var x=w+16260,N=Math.floor((x-1)/12),I=N+1,S=x-12*N,C=u-M[w-1]+1;return(C+"").length>2&&(C=b,S=v,I=y),{year:I,month:S,date:C}},x.toGregorian=function(e,t,i){var r=i+M[12*(e-1)+1+(t-1)-16260-1]-1+24e5,n=Math.floor(r+.5),o=Math.floor((n-1867216.25)/36524.25),s=1524+(o=n+1+o-Math.floor(o/4)),a=Math.floor((s-122.1)/365.25),l=Math.floor(365.25*a),h=Math.floor((s-l)/30.6001),d=s-l-Math.floor(30.6001*h),c=h-(h>13.5?13:1),p=a-(c>2.5?4716:4715);return p<=0&&c--,new Date(p+"/"+c+"/"+d)};var T=/\/MMMMM|MMMM|MMM|a|LLLL|LLL|EEEEE|EEEE|E|K|cccc|ccc|WW|W|G+|z+/gi,P=["sun","mon","tue","wed","thu","fri","sat"],A={m:"getMinutes",h:"getHours",H:"getHours",s:"getSeconds",d:"getDate",f:"getMilliseconds"},L={M:"month",d:"day",E:"weekday",c:"weekday",y:"year",m:"minute",h:"hour",H:"hour",s:"second",L:"month",a:"designator",z:"timeZone",Z:"timeZone",G:"era",f:"milliseconds"},F=function(){function t(){}return t.dateFormat=function(t,i,r){var n=this,o=e.IntlBase.getDependables(r,t,i.calendar),s=a("parserObject.numbers",o),l=o.dateObject,h={isIslamic:e.IntlBase.islamicRegex.test(i.calendar)};b()&&i.isServerRendered&&(i=e.IntlBase.compareBlazorDateFormats(i,t));var d=i.format||e.IntlBase.getResultantPattern(i.skeleton,o.dateObject,i.type,!1,b()?t:"");if(h.dateSeperator=b()?a("dateSeperator",l):e.IntlBase.getDateSeparator(o.dateObject),f(d))v("Format options or type given must be invalid");else{d=e.IntlBase.ConvertDateToWeekFormat(d),b()&&(d=d.replace(/tt/,"a")),h.pattern=d,h.numMapper=b()?u({},s):C.getNumberMapper(o.parserObject,C.getNumberingSystem(r));for(var c=0,p=d.match(T)||[];c<p.length;c++){var g=p[c],m=g.length,y=g[0];switch("K"===y&&(y="h"),y){case"E":case"c":b()?h.weekday=a("days."+e.IntlBase.monthIndex[m],l):h.weekday=o.dateObject[e.IntlBase.days]["stand-alone"][e.IntlBase.monthIndex[m]];break;case"M":case"L":b()?h.month=a("months."+e.IntlBase.monthIndex[m],l):h.month=o.dateObject[e.IntlBase.month]["stand-alone"][e.IntlBase.monthIndex[m]];break;case"a":h.designator=b()?a("dayPeriods",l):a("dayPeriods.format.wide",l);break;case"G":var w=m<=3?"eraAbbr":4===m?"eraNames":"eraNarrow";h.era=b()?a("eras",l):a("eras."+w,o.dateObject);break;case"z":h.timeZone=a("dates.timeZoneNames",o.parserObject)}}}return function(e){return isNaN(e.getDate())?null:n.intDateFormatter(e,h)}},t.intDateFormatter=function(t,i){for(var r="",n=i.pattern.match(e.IntlBase.dateParseRegex),o=this.getCurrentDateValue(t,i.isIslamic),s=0,a=n;s<a.length;s++){var l=a[s],h=l.length,d=l[0];"K"===d&&(d="h");var c=void 0,p="",u=void 0,f=void 0,m="";switch(d){case"M":case"L":c=o.month,h>2?r+=i.month[c]:u=!0;break;case"E":case"c":r+=i.weekday[P[t.getDay()]];break;case"H":case"h":case"m":case"s":case"d":case"f":if(u=!0,"d"===d)c=o.date;else if("f"===d){u=!1,f=!0;var y=(p=(p=t[A[d]]().toString()).substring(0,h)).length;if(h!==y){if(h>3)continue;for(var v=0;v<h-y;v++)p="0"+p.toString()}m+=p}else c=t[A[d]]();"h"===d&&(c=c%12||12);break;case"y":f=!0,m+=o.year,2===h&&(m=m.substr(m.length-2));break;case"a":var b=t.getHours()<12?"am":"pm";r+=i.designator[b];break;case"G":var w=t.getFullYear()<0?0:1,x=i.era[w];g(x)&&(x=i.era[w?0:1]),r+=x||"";break;case"'":r+="''"===l?"'":l.replace(/'/g,"");break;case"z":var M=t.getTimezoneOffset(),N=h<4?"+H;-H":i.timeZone.hourFormat;N=N.replace(/:/g,i.numMapper.timeSeparator),0===M?r+=i.timeZone.gmtZeroFormat:(f=!0,m=this.getTimeZoneValue(M,N)),m=i.timeZone.gmtFormat.replace(/\{0\}/,m);break;case":":r+=i.numMapper.numberSymbols.timeSeparator;break;case"/":r+=i.dateSeperator;break;case"W":u=!0,c=e.IntlBase.getWeekOfYear(t);break;default:r+=l}u&&(f=!0,m=this.checkTwodigitNumber(c,h)),f&&(r+=C.convertValueParts(m,e.IntlBase.latnParseRegex,i.numMapper.mapper))}return r},t.getCurrentDateValue=function(t,i){return i?e.HijriParser.getHijriDate(t):{year:t.getFullYear(),month:t.getMonth()+1,date:t.getDate()}},t.checkTwodigitNumber=function(e,t){var i=e+"";return 2===t&&2!==i.length?"0"+i:i},t.getTimeZoneValue=function(e,t){var i=this,r=t.split(";")[e>0?1:0],n=Math.abs(e);return r.replace(/HH?|mm/g,(function(e){var t=e.length,r=-1!==e.indexOf("H");return i.checkTwodigitNumber(Math.floor(r?n/60:n%60),t)}))},t}(),D={ms:"minimumSignificantDigits",ls:"maximumSignificantDigits",mf:"minimumFractionDigits",lf:"maximumFractionDigits"},E=["infinity","nan","group","decimal","exponential"],z=function(){function t(){}return t.numberFormatter=function(t,i,r){var n,o=this,s=u({},i),l={},h={},d=e.IntlBase.getDependables(r,t,"",!0),c=d.numericObject;h.numberMapper=b()?u({},c):C.getNumberMapper(d.parserObject,C.getNumberingSystem(r),!0),h.currencySymbol=b()?a("currencySymbol",c):e.IntlBase.getCurrencySymbol(d.numericObject,s.currency||e.defaultCurrencyCode,i.altSymbol),h.percentSymbol=b()?a("numberSymbols.percentSign",c):h.numberMapper.numberSymbols.percentSign,h.minusSymbol=b()?a("numberSymbols.minusSign",c):h.numberMapper.numberSymbols.minusSign;var p=h.numberMapper.numberSymbols;if(i.format&&!e.IntlBase.formatRegex.test(i.format))l=e.IntlBase.customFormat(i.format,h,d.numericObject);else{if(u(s,e.IntlBase.getProperNumericSkeleton(i.format||"N")),s.isCurrency="currency"===s.type,s.isPercent="percent"===s.type,b()||(n=e.IntlBase.getSymbolPattern(s.type,h.numberMapper.numberSystem,d.numericObject,s.isAccount)),s.groupOne=this.checkValueRange(s.maximumSignificantDigits,s.minimumSignificantDigits,!0),this.checkValueRange(s.maximumFractionDigits,s.minimumFractionDigits,!1,!0),f(s.fractionDigits)||(s.minimumFractionDigits=s.maximumFractionDigits=s.fractionDigits),f(s.useGrouping)&&(s.useGrouping=!0),s.isCurrency&&!b()&&(n=n.replace(/\u00A4/g,e.IntlBase.defaultCurrency)),b())l.nData=u({},{},a(s.type+"nData",c)),l.pData=u({},{},a(s.type+"pData",c)),"currency"===s.type&&i.currency&&e.IntlBase.replaceBlazorCurrency([l.pData,l.nData],h.currencySymbol,i.currency);else{var g=n.split(";");l.nData=e.IntlBase.getFormatData(g[1]||"-"+g[0],!0,h.currencySymbol),l.pData=e.IntlBase.getFormatData(g[0],!1,h.currencySymbol),s.useGrouping&&(s.groupSeparator=p[E[2]],s.groupData=this.getGroupingDetails(g[0]))}if(f(s.minimumFractionDigits)&&(s.minimumFractionDigits=l.nData.minimumFraction),f(s.maximumFractionDigits)){var m=l.nData.maximumFraction;s.maximumFractionDigits=f(m)&&s.isPercent?0:m}var y=s.minimumFractionDigits,v=s.maximumFractionDigits;f(y)||f(v)||y>v&&(s.maximumFractionDigits=y)}return u(l.nData,s),u(l.pData,s),function(e){return isNaN(e)?p[E[1]]:isFinite(e)?o.intNumberFormatter(e,l,h):p[E[0]]}},t.getGroupingDetails=function(t){var i={},r=t.match(e.IntlBase.negativeDataRegex);if(r&&r[4]){var n=r[4],o=n.lastIndexOf(",");if(-1!==o){var s=n.split(".")[0];i.primary=s.length-o-1;var a=n.lastIndexOf(",",o-1);-1!==a&&(i.secondary=o-1-a)}}return i},t.checkValueRange=function(e,t,i,r){var n=r?"f":"s",o=0,s=D["l"+n],a=D["m"+n];if(f(e)||(this.checkRange(e,s,r),o++),f(t)||(this.checkRange(t,a,r),o++),2===o){if(!(e<t))return!0;v(a+"specified must be less than the"+s)}else i&&1===o&&v("Both"+a+"and"+a+"must be present");return!1},t.checkRange=function(e,t,i){var r=i?[0,20]:[1,21];(e<r[0]||e>r[1])&&v(t+"value must be within the range"+r[0]+"to"+r[1])},t.intNumberFormatter=function(t,i,r){var n;if(!f(i.nData.type)){t<0?(t*=-1,n=i.nData):n=0===t&&i.zeroData||i.pData;var o="";return n.isPercent&&(t*=100),n.groupOne?o=this.processSignificantDigits(t,n.minimumSignificantDigits,n.maximumSignificantDigits):(o=this.processFraction(t,n.minimumFractionDigits,n.maximumFractionDigits),n.minimumIntegerDigits&&(o=this.processMinimumIntegers(o,n.minimumIntegerDigits))),"scientific"===n.type&&(o=(o=t.toExponential(n.maximumFractionDigits)).replace("e",r.numberMapper.numberSymbols[E[4]])),o=o.replace(".",r.numberMapper.numberSymbols[E[3]]),n.useGrouping&&(o=this.groupNumbers(o,n.groupData.primary,n.groupSeparator||",",r.numberMapper.numberSymbols[E[3]]||".",n.groupData.secondary)),o=C.convertValueParts(o,e.IntlBase.latnParseRegex,r.numberMapper.mapper),"N/A"===n.nlead?n.nlead:n.nlead+o+n.nend}},t.processSignificantDigits=function(e,t,i){var r=e+"";return r.length<t?e.toPrecision(t):+(r=e.toPrecision(i))+""},t.groupNumbers=function(e,t,i,r,n){for(var o=!g(n)&&0!==n,s=e.split(r),a=s[0],l=a.length,h="";l>t;)h=a.slice(l-t,l)+(h.length?i+h:""),l-=t,o&&(t=n,o=!1);return s[0]=a.slice(0,l)+(h.length?i:"")+h,s.join(r)},t.processFraction=function(e,t,i){var r=(e+"").split(".")[1],n=r?r.length:0;if(t&&n<t){var o="";if(0!==n){o+=e;for(var s=0;s<t-n;s++)o+="0";return o}return o=e.toFixed(t),e.toFixed(t)}return!g(i)&&(n>i||0===i)?e.toFixed(i):e+""},t.processMinimumIntegers=function(e,t){var i=e.split("."),r=i[0],n=r.length;if(n<t){for(var o=0;o<t-n;o++)r="0"+r;i[0]=r}return i.join(".")},t}(),k=/^[0-9]*$/,W={minute:"setMinutes",hour:"setHours",second:"setSeconds",day:"setDate",month:"setMonth",milliseconds:"setMilliseconds"},R=function(){function t(){}return t.dateParser=function(t,i,r){var n=this,o=e.IntlBase.getDependables(r,t,i.calendar),s=C.getCurrentNumericOptions(o.parserObject,C.getNumberingSystem(r),!1,b()),l={};b()&&i.isServerRendered&&(i=e.IntlBase.compareBlazorDateFormats(i,t));var h,d=i.format||e.IntlBase.getResultantPattern(i.skeleton,o.dateObject,i.type,!1,b()?t:""),c="";if(f(d))v("Format options or type given must be invalid");else{d=e.IntlBase.ConvertDateToWeekFormat(d),l={isIslamic:e.IntlBase.islamicRegex.test(i.calendar),pattern:d,evalposition:{},culture:t};for(var p=d.match(e.IntlBase.dateParseRegex)||[],u=p.length,m=0,y=0,w=!1,x=s.numericRegex,M=b()?o.parserObject.numbers:C.getNumberMapper(o.parserObject,C.getNumberingSystem(r)),N=0;N<u;N++){var I=p[parseInt(N.toString(),10)],S=I.length,O="K"===I[0]?"h":I[0],T=void 0,P=void 0,A=L[O],F=2===S?"":"?";switch(w&&(m=y,w=!1),O){case"E":case"c":var D=void 0;D=b()?a("days."+e.IntlBase.monthIndex[S],o.dateObject):o.dateObject[e.IntlBase.days]["stand-alone"][e.IntlBase.monthIndex[S]];var E=C.reverseObject(D);c+="("+Object.keys(E).join("|")+")";break;case"M":case"L":case"d":case"m":case"s":case"h":case"H":case"f":if(P=!0,("M"===O||"L"===O)&&S>2){var z=void 0;z=b()?a("months."+e.IntlBase.monthIndex[S],o.dateObject):o.dateObject.months["stand-alone"][e.IntlBase.monthIndex[S]],l[A]=C.reverseObject(z),c+="("+Object.keys(l[A]).join("|")+")"}else if("f"===O){if(S>3)continue;T=!0,c+="("+x+x+"?"+x+"?)"}else T=!0,c+="("+x+x+F+")";"h"===O&&(l.hour12=!0);break;case"W":c+="("+x+(1===S?"?":"")+x+")";break;case"y":P=T=!0,c+=2===S?"("+x+x+")":"("+x+"{"+S+",})";break;case"a":P=!0;var k=b()?a("dayPeriods",o.dateObject):a("dayPeriods.format.wide",o.dateObject);l[A]=C.reverseObject(k),c+="("+Object.keys(l[A]).join("|")+")";break;case"G":P=!0;var W=S<=3?"eraAbbr":4===S?"eraNames":"eraNarrow";l[A]=C.reverseObject(b()?a("eras",o.dateObject):a("eras."+W,o.dateObject)),c+="("+Object.keys(l[A]).join("|")+"?)";break;case"z":P=0!==(new Date).getTimezoneOffset(),l[A]=a("dates.timeZoneNames",o.parserObject);var R=l[A],j=(h=S<4)?"+H;-H":R.hourFormat;j=j.replace(/:/g,M.timeSeparator),c+="("+this.parseTimeZoneRegx(j,R,x)+")?",w=!0,y=h?6:12;break;case"'":c+="("+I.replace(/'/g,"")+")?";break;default:c+="([\\D])"}P&&(l.evalposition[""+A]={isNumber:T,pos:N+1+m,hourOnly:h}),N!==u-1||g(c)||(l.parserRegex=new RegExp("^"+c+"$","i"))}}return function(t){var i=n.internalDateParse(t,l,s);if(g(i)||!Object.keys(i).length)return null;if(l.isIslamic){var r={},o=i.year,a=i.day,h=i.month,d=o?o+"":"",c=2===d.length;o&&h&&a&&!c||(r=e.HijriParser.getHijriDate(new Date)),c&&(o=parseInt((r.year+"").slice(0,2)+d,10));var p=e.HijriParser.toGregorian(o||r.year,h||r.month,a||r.date);i.year=p.getFullYear(),i.month=p.getMonth()+1,i.day=p.getDate()}return n.getDateObject(i)}},t.getDateObject=function(e,t){var i=t||new Date;i.setMilliseconds(0);var r=e.year,n=e.designator,o=e.timeZone;if(!f(r)){if((r+"").length<=2)r+=100*Math.floor(i.getFullYear()/100);i.setFullYear(r)}for(var s=0,a=["hour","minute","second","milliseconds","month","day"];s<a.length;s++){var l=a[s],h=e[l];if(f(h)&&"day"===l&&i.setDate(1),!f(h))if("month"===l){if((h-=1)<0||h>11)return new Date("invalid");var d=i.getDate();i.setDate(1),i[W[l]](h);var c=new Date(i.getFullYear(),h+1,0).getDate();i.setDate(d<c?d:c)}else{if("day"===l){var p=new Date(i.getFullYear(),i.getMonth()+1,0).getDate();if(h<1||h>p)return null}i[W[l]](h)}}if(!f(n)){var u=i.getHours();"pm"===n?i.setHours(u+(12===u?0:12)):12===u&&i.setHours(0)}if(!f(o)){var g=o-i.getTimezoneOffset();0!==g&&i.setMinutes(i.getMinutes()+g)}return i},t.internalDateParse=function(e,t,i){var r=e.match(t.parserRegex),n={hour:0,minute:0,second:0};if(g(r))return null;for(var o=0,s=Object.keys(t.evalposition);o<s.length;o++){var a=s[o],l=t.evalposition[""+a],h=r[l.pos];if(l.isNumber)n[a]=this.internalNumberParser(h,i);else if("timeZone"!==a||f(h))h="month"!==a||t.isIslamic||"en"!==t.culture&&"en-GB"!==t.culture&&"en-US"!==t.culture?h:h[0].toUpperCase()+h.substring(1).toLowerCase(),n[a]=t[a][h];else{var d=l.pos,c=void 0,p=r[d+1],u=!f(p);l.hourOnly?c=60*this.getZoneValue(u,p,r[d+4],i):(c=60*this.getZoneValue(u,p,r[d+7],i),c+=this.getZoneValue(u,r[d+4],r[d+10],i)),g(c)||(n[""+a]=c)}}return t.hour12&&(n.hour12=!0),n},t.internalNumberParser=function(e,t){return e=C.convertValueParts(e,t.numberParseRegex,t.numericPair),k.test(e)?+e:null},t.parseTimeZoneRegx=function(e,t,i){var r,n,o=t.gmtFormat,s="("+i+")("+i+")";return r=e.replace("+","\\+"),n=(r=-1!==e.indexOf("HH")?r.replace(/HH|mm/g,"("+s+")"):r.replace(/H|m/g,"("+s+"?)")).split(";").map((function(e){return o.replace("{0}",e)})),r=n.join("|")+"|"+t.gmtZeroFormat},t.getZoneValue=function(e,t,i,r){var n=e?t:i;if(!n)return 0;var o=this.internalNumberParser(n,r);return e?-o:o},t}(),j=/^([^0-9]*)(([0-9,]*[0-9]+)(\.[0-9]+)?)([Ee][+-]?[0-9]+)?([^0-9]*)$/,U=/,/g,H=["minusSign","infinity"],B=function(){function t(){}return t.numberParser=function(t,i,r){var n,o=this,s=e.IntlBase.getDependables(r,t,"",!0),l={custom:!0};e.IntlBase.formatRegex.test(i.format)||!i.format?(u(l,e.IntlBase.getProperNumericSkeleton(i.format||"N")),l.custom=!1,l.fractionDigits||i.maximumFractionDigits&&(l.maximumFractionDigits=i.maximumFractionDigits)):u(l,e.IntlBase.customFormat(i.format,null,null));var h,d=a("numbers",s.parserObject);if(n=C.getCurrentNumericOptions(s.parserObject,C.getNumberingSystem(r),!0,b()),l.symbolRegex=C.getSymbolRegex(Object.keys(n.symbolMatch)),l.infinity=n.symbolNumberSystem[H[1]],b())l.nData=u({},{},a(l.type+"nData",d)),l.pData=u({},{},a(l.type+"pData",d)),"currency"===l.type&&i.currency&&e.IntlBase.replaceBlazorCurrency([l.pData,l.nData],a("currencySymbol",d),i.currency);else if(h=e.IntlBase.getSymbolPattern(l.type,n.numberSystem,s.numericObject,l.isAccount)){var c=(h=h.replace(/\u00A4/g,e.IntlBase.defaultCurrency)).split(";");l.nData=e.IntlBase.getFormatData(c[1]||"-"+c[0],!0,""),l.pData=e.IntlBase.getFormatData(c[0],!0,"")}return function(e){return o.getParsedNumber(e,l,n)}},t.getParsedNumber=function(e,t,i){var r,n,o,s,a,l;if(-1!==e.indexOf(t.infinity))return 1/0;e=C.convertValueParts(e,t.symbolRegex,i.symbolMatch),0===(e=-1!==(e=C.convertValueParts(e,i.numberParseRegex,i.numericPair)).indexOf("-")?e.replace("-.","-0."):e).indexOf(".")&&(e="0"+e);var h=e.match(j);if(g(h))return NaN;s=h[1],o=h[2];var d=h[5];return a=h[6],n=(r=t.custom?s===t.nData.nlead&&a===t.nData.nend:-1!==s.indexOf(t.nData.nlead)&&-1!==a.indexOf(t.nData.nend))?t.nData.isPercent:t.pData.isPercent,o=o.replace(U,""),d&&(o+=d),l=+o,("percent"===t.type||n)&&(l/=100),(t.custom||t.fractionDigits)&&(l=parseFloat(l.toFixed(t.custom?r?t.nData.maximumFractionDigits:t.pData.maximumFractionDigits:t.fractionDigits))),t.maximumFractionDigits&&(l=this.convertMaxFracDigits(o,t,l,r)),r&&(l*=-1),l},t.convertMaxFracDigits=function(e,t,i,r){var n=e.split(".");return n[1]&&n[1].length>t.maximumFractionDigits&&(i=+i.toFixed(t.custom?r?t.nData.maximumFractionDigits:t.pData.maximumFractionDigits:t.maximumFractionDigits)),i},t}(),_=function(){function e(e){this.ranArray=[],this.boundedEvents={},g(e)||(this.context=e)}return e.prototype.on=function(e,t,i,r){if(!g(t)){var n=i||this.context;this.notExist(e)?this.boundedEvents[""+e]=[{handler:t,context:n}]:g(r)?this.isHandlerPresent(this.boundedEvents[""+e],t)||this.boundedEvents[""+e].push({handler:t,context:n}):-1===this.ranArray.indexOf(r)&&(this.ranArray.push(r),this.boundedEvents[""+e].push({handler:t,context:n,id:r}))}},e.prototype.off=function(e,t,i){if(!this.notExist(e)){var r=a(e,this.boundedEvents);if(t){for(var n=0;n<r.length;n++)if(i){if(r[parseInt(n.toString(),10)].id===i){r.splice(n,1);var o=this.ranArray.indexOf(i);-1!==o&&this.ranArray.splice(o,1);break}}else if(t===r[parseInt(n.toString(),10)].handler){r.splice(n,1);break}}else delete this.boundedEvents[""+e]}},e.prototype.notify=function(e,t,i,r){if(this.notExist(e))i&&i.call(this,t);else{t&&(t.name=e);var n=a(e,this.boundedEvents).slice(0);if(window.Blazor)return this.blazorCallback(n,t,i,r,0);for(var o=0,s=n;o<s.length;o++){var l=s[o];l.handler.call(l.context,t)}i&&i.call(this,t)}},e.prototype.blazorCallback=function(e,t,i,r,n){var o=this,s=n===e.length-1;if(n<e.length){var a=e[parseInt(n.toString(),10)],l=a.handler.call(a.context,t);if(l&&"function"==typeof l.then){if(!i)return l;l.then((function(l){if(l="string"==typeof l&&o.isJson(l)?JSON.parse(l,o.dateReviver):l,u(t,t,l,!0),!i||!s)return o.blazorCallback(e,t,i,r,n+1);i.call(a.context,t)})).catch((function(e){r&&r.call(a.context,"string"==typeof e&&o.isJson(e)?JSON.parse(e,o.dateReviver):e)}))}else{if(!i||!s)return this.blazorCallback(e,t,i,r,n+1);i.call(a.context,t)}}},e.prototype.dateReviver=function(e,t){return b&&"string"==typeof t&&null!==t.match(/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}/)?new Date(t):t},e.prototype.isJson=function(e){try{JSON.parse(e)}catch(e){return!1}return!0},e.prototype.destroy=function(){this.boundedEvents=this.context=void 0},e.prototype.notExist=function(e){return!1===this.boundedEvents.hasOwnProperty(e)||this.boundedEvents[e].length<=0},e.prototype.isHandlerPresent=function(e,t){for(var i=0,r=e;i<r.length;i++){if(r[i].handler===t)return!0}return!1},e}(),V=new _;e.rightToLeft=!1;var Y={};e.defaultCulture="en-US",e.defaultCurrencyCode="USD";var Q=["numericObject","dateObject"],q=function(){function t(e){e&&(this.culture=e)}return t.prototype.getDateFormat=function(e){return F.dateFormat(this.getCulture(),e||{type:"date",skeleton:"short"},Y)},t.prototype.getNumberFormat=function(t){return t&&!t.currency&&(t.currency=e.defaultCurrencyCode),b()&&t&&!t.format&&(t.minimumFractionDigits=0),z.numberFormatter(this.getCulture(),t||{},Y)},t.prototype.getDateParser=function(e){return R.dateParser(this.getCulture(),e||{skeleton:"short",type:"date"},Y)},t.prototype.getNumberParser=function(e){return b()&&e&&!e.format&&(e.minimumFractionDigits=0),B.numberParser(this.getCulture(),e||{format:"N"},Y)},t.prototype.formatNumber=function(e,t){return this.getNumberFormat(t)(e)},t.prototype.formatDate=function(e,t){return this.getDateFormat(t)(e)},t.prototype.parseDate=function(e,t){return this.getDateParser(t)(e)},t.prototype.parseNumber=function(e,t){return this.getNumberParser(t)(e)},t.prototype.getDatePattern=function(t,i){return e.IntlBase.getActualDateTimeFormat(this.getCulture(),t,Y,i)},t.prototype.getNumberPattern=function(t,i){return e.IntlBase.getActualNumberFormat(this.getCulture(),t,Y,i)},t.prototype.getFirstDayOfWeek=function(){return e.IntlBase.getWeekData(this.getCulture(),Y)},t.prototype.getCulture=function(){return this.culture||e.defaultCulture},t}();var G={"en-US":{d:"M/d/y",D:"EEEE, MMMM d, y",f:"EEEE, MMMM d, y h:mm a",F:"EEEE, MMMM d, y h:mm:s a",g:"M/d/y h:mm a",G:"M/d/yyyy h:mm:ss tt",m:"MMMM d",M:"MMMM d",r:"ddd, dd MMM yyyy HH':'mm':'ss 'GMT'",R:"ddd, dd MMM yyyy HH':'mm':'ss 'GMT'",s:"yyyy'-'MM'-'dd'T'HH':'mm':'ss",t:"h:mm tt",T:"h:m:s tt",u:"yyyy'-'MM'-'dd HH':'mm':'ss'Z'",U:"dddd, MMMM d, yyyy h:mm:ss tt",y:"MMMM yyyy",Y:"MMMM yyyy"}};!function(t){t.negativeDataRegex=/^(('[^']+'|''|[^*#@0,.E])*)(\*.)?((([#,]*[0,]*0+)(\.0*[0-9]*#*)?)|([#,]*@+#*))(E\+?0+)?(('[^']+'|''|[^*#@0,.E])*)$/,t.customRegex=/^(('[^']+'|''|[^*#@0,.])*)(\*.)?((([0#,]*[0,]*[0#]*[0#\ ]*)(\.[0#]*)?)|([#,]*@+#*))(E\+?0+)?(('[^']+'|''|[^*#@0,.E])*)$/,t.latnParseRegex=/0|1|2|3|4|5|6|7|8|9/g;var i=/[0-9]/g;t.defaultCurrency="$";var r=["infinity","nan","group","decimal"],n=/G|M|L|H|c|'| a|yy|y|EEEE|E/g,o={G:"",M:"m",L:"m",H:"h",c:"d","'":'"'," a":" AM/PM",yy:"yy",y:"yyyy",EEEE:"dddd",E:"ddd"};t.dateConverterMapper=/dddd|ddd/gi;t.islamicRegex=/^islamic/;var s={sun:0,mon:1,tue:2,wed:3,thu:4,fri:5,sat:6};t.formatRegex=/(^[ncpae]{1})([0-1]?[0-9]|20)?$/i,t.currencyFormatRegex=/(^[ca]{1})([0-1]?[0-9]|20)?$/i,t.curWithoutNumberRegex=/(c|a)$/gi;var l={$:"isCurrency","%":"isPercent","-":"isNegative",0:"nlead",1:"nend"};function h(e,i,r,n,o){var s,l=r||"date";if(o)s=m({skeleton:e},o).format||m({skeleton:"d"},"en-US").format;else{if(-1!==t.basicPatterns.indexOf(e)){if(s=a(l+"Formats."+e,i),"dateTime"===l){var h=a("dateFormats."+e,i),d=a("timeFormats."+e,i);s=s.replace("{1}",h).replace("{0}",d)}}else s=a("dateTimeFormats.availableFormats."+e,i);f(s)&&"yMd"===e&&(s="M/d/y")}return s}function d(e,i,r,n){var o={},s=r||"gregorian";if(o.parserObject=C.getMainObject(e,i)||(b()?t.blazorDefaultObject:t.defaultObject),n)o.numericObject=a("numbers",o.parserObject);else{var l=b()?"dates":"dates.calendars."+s;o.dateObject=a(l,o.parserObject)}return o}function c(e,t,i,r){return a(e+"Formats-numberSystem-"+t+(r?".accounting":".standard"),i)||(r?a(e+"Formats-numberSystem-"+t+".standard",i):"")}function p(e){var i=e.match(t.dateConverterMapper);if(i&&b()){var r=3===i[0].length?"EEE":"EEEE";return e.replace(t.dateConverterMapper,r)}return e}function m(e,t){var i=e.format||e.skeleton,r=a((t||"en-US")+"."+i,G);return r||(r=a("en-US."+i,G)),r&&(r=p(r),e.format=r.replace(/tt/,"a")),e}function y(e){var i=e.match(t.formatRegex),r={},n=i[1].toUpperCase();return r.isAccount="A"===n,r.type=t.patternMatcher[n],e.length>1&&(r.fractionDigits=parseInt(i[2],10)),r}function v(e,r,n,o){var s=o?{}:{nlead:"",nend:""},a=e.match(t.customRegex);if(a){o||(s.nlead=w(a[1],n),s.nend=w(a[10],n),s.groupPattern=a[4]);var l=a[7];if(l&&r){var h=l.match(i);g(h)?s.minimumFraction=0:s.minimumFraction=h.length,s.maximumFraction=l.length-1}}return s}function w(e,i){return e?e.replace(t.defaultCurrency,i):""}function x(e,t,i){return a("currencies."+t+(i?"."+i:".symbol"),e)||a("currencies."+t+".symbol-alt-narrow",e)||"$"}function M(e,i,n){var o={type:"decimal",minimumFractionDigits:0,maximumFractionDigits:0},s=e.match(t.customRegex);if(g(s)||""===s[5]&&"N/A"!==e)return o.type=void 0,o;o.nlead=s[1],o.nend=s[10];var a=s[6],l=!!a.match(/\ $/g),h=-1!==a.replace(/\ $/g,"").indexOf(" ");o.useGrouping=-1!==a.indexOf(",")||h,a=a.replace(/,/g,"");var d=s[7];if(-1!==a.indexOf("0")&&(o.minimumIntegerDigits=a.length-a.indexOf("0")),g(d)||(o.minimumFractionDigits=d.lastIndexOf("0"),o.maximumFractionDigits=d.lastIndexOf("#"),-1===o.minimumFractionDigits&&(o.minimumFractionDigits=0),(-1===o.maximumFractionDigits||o.maximumFractionDigits<o.minimumFractionDigits)&&(o.maximumFractionDigits=o.minimumFractionDigits)),g(i)?u(o,N([o.nlead,o.nend],"%","%")):(u(o,N([o.nlead,o.nend],"$",i.currencySymbol)),o.isCurrency||u(o,N([o.nlead,o.nend],"%",i.percentSymbol))),!g(n)){var p=c(o.type,i.numberMapper.numberSystem,n,!1);o.useGrouping&&(o.groupSeparator=h?" ":i.numberMapper.numberSymbols[r[2]],o.groupData=z.getGroupingDetails(p.split(";")[0])),o.nlead=o.nlead.replace(/'/g,""),o.nend=l?" "+o.nend.replace(/'/g,""):o.nend.replace(/'/g,"")}return o}function N(e,t,i){for(var r={nlead:e[0],nend:e[1]},n=0;n<2;n++){var o=e[parseInt(n.toString(),10)],s=o.indexOf(t);if(-1!==s&&(s<o.indexOf("'")||s>o.lastIndexOf("'"))){r[l[n]]=o.substr(0,s)+i+o.substr(s+1),r[l[t]]=!0,r.type=r.isCurrency?"currency":"percent";break}}return r}function I(e,t,i){e+=".";for(var r=0;r<t;r++)e+="0";if(t<i)for(var n=i-t,o=0;o<n;o++)e+="#";return e}function S(e,t){for(var i=e.split("."),r="",n=0;n<t;n++)r+="0";return i[1]?r+"."+i[1]:r}function T(e){var t=e.split("."),i=t[0],r=3-i.length%3;e="";for(var n=(i=(r&&1===r?"#":2===r?"##":"")+i).length-1;n>0;n-=3)e=","+i[n-2]+i[n-1]+i[parseInt(n.toString(),10)]+e;return e=e.slice(1),t[1]?e+"."+t[1]:e}t.dateParseRegex=/([a-z])\1*|'([^']|'')+'|''|./gi,t.basicPatterns=["short","medium","long","full"],t.defaultObject={dates:{calendars:{gregorian:{months:{"stand-alone":{abbreviated:{1:"Jan",2:"Feb",3:"Mar",4:"Apr",5:"May",6:"Jun",7:"Jul",8:"Aug",9:"Sep",10:"Oct",11:"Nov",12:"Dec"},narrow:{1:"J",2:"F",3:"M",4:"A",5:"M",6:"J",7:"J",8:"A",9:"S",10:"O",11:"N",12:"D"},wide:{1:"January",2:"February",3:"March",4:"April",5:"May",6:"June",7:"July",8:"August",9:"September",10:"October",11:"November",12:"December"}}},days:{"stand-alone":{abbreviated:{sun:"Sun",mon:"Mon",tue:"Tue",wed:"Wed",thu:"Thu",fri:"Fri",sat:"Sat"},narrow:{sun:"S",mon:"M",tue:"T",wed:"W",thu:"T",fri:"F",sat:"S"},short:{sun:"Su",mon:"Mo",tue:"Tu",wed:"We",thu:"Th",fri:"Fr",sat:"Sa"},wide:{sun:"Sunday",mon:"Monday",tue:"Tuesday",wed:"Wednesday",thu:"Thursday",fri:"Friday",sat:"Saturday"}}},dayPeriods:{format:{wide:{am:"AM",pm:"PM"}}},eras:{eraNames:{0:"Before Christ","0-alt-variant":"Before Common Era",1:"Anno Domini","1-alt-variant":"Common Era"},eraAbbr:{0:"BC","0-alt-variant":"BCE",1:"AD","1-alt-variant":"CE"},eraNarrow:{0:"B","0-alt-variant":"BCE",1:"A","1-alt-variant":"CE"}},dateFormats:{full:"EEEE, MMMM d, y",long:"MMMM d, y",medium:"MMM d, y",short:"M/d/yy"},timeFormats:{full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},dateTimeFormats:{full:"{1} 'at' {0}",long:"{1} 'at' {0}",medium:"{1}, {0}",short:"{1}, {0}",availableFormats:{d:"d",E:"ccc",Ed:"d E",Ehm:"E h:mm a",EHm:"E HH:mm",Ehms:"E h:mm:ss a",EHms:"E HH:mm:ss",Gy:"y G",GyMMM:"MMM y G",GyMMMd:"MMM d, y G",GyMMMEd:"E, MMM d, y G",h:"h a",H:"HH",hm:"h:mm a",Hm:"HH:mm",hms:"h:mm:ss a",Hms:"HH:mm:ss",hmsv:"h:mm:ss a v",Hmsv:"HH:mm:ss v",hmv:"h:mm a v",Hmv:"HH:mm v",M:"L",Md:"M/d",MEd:"E, M/d",MMM:"LLL",MMMd:"MMM d",MMMEd:"E, MMM d",MMMMd:"MMMM d",ms:"mm:ss",y:"y",yM:"M/y",yMd:"M/d/y",yMEd:"E, M/d/y",yMMM:"MMM y",yMMMd:"MMM d, y",yMMMEd:"E, MMM d, y",yMMMM:"MMMM y"}}},islamic:{months:{"stand-alone":{abbreviated:{1:"Muh.",2:"Saf.",3:"Rab. I",4:"Rab. II",5:"Jum. I",6:"Jum. II",7:"Raj.",8:"Sha.",9:"Ram.",10:"Shaw.",11:"Dhuʻl-Q.",12:"Dhuʻl-H."},narrow:{1:"1",2:"2",3:"3",4:"4",5:"5",6:"6",7:"7",8:"8",9:"9",10:"10",11:"11",12:"12"},wide:{1:"Muharram",2:"Safar",3:"Rabiʻ I",4:"Rabiʻ II",5:"Jumada I",6:"Jumada II",7:"Rajab",8:"Shaʻban",9:"Ramadan",10:"Shawwal",11:"Dhuʻl-Qiʻdah",12:"Dhuʻl-Hijjah"}}},days:{"stand-alone":{abbreviated:{sun:"Sun",mon:"Mon",tue:"Tue",wed:"Wed",thu:"Thu",fri:"Fri",sat:"Sat"},narrow:{sun:"S",mon:"M",tue:"T",wed:"W",thu:"T",fri:"F",sat:"S"},short:{sun:"Su",mon:"Mo",tue:"Tu",wed:"We",thu:"Th",fri:"Fr",sat:"Sa"},wide:{sun:"Sunday",mon:"Monday",tue:"Tuesday",wed:"Wednesday",thu:"Thursday",fri:"Friday",sat:"Saturday"}}},dayPeriods:{format:{wide:{am:"AM",pm:"PM"}}},eras:{eraNames:{0:"AH"},eraAbbr:{0:"AH"},eraNarrow:{0:"AH"}},dateFormats:{full:"EEEE, MMMM d, y G",long:"MMMM d, y G",medium:"MMM d, y G",short:"M/d/y GGGGG"},timeFormats:{full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},dateTimeFormats:{full:"{1} 'at' {0}",long:"{1} 'at' {0}",medium:"{1}, {0}",short:"{1}, {0}",availableFormats:{d:"d",E:"ccc",Ed:"d E",Ehm:"E h:mm a",EHm:"E HH:mm",Ehms:"E h:mm:ss a",EHms:"E HH:mm:ss",Gy:"y G",GyMMM:"MMM y G",GyMMMd:"MMM d, y G",GyMMMEd:"E, MMM d, y G",h:"h a",H:"HH",hm:"h:mm a",Hm:"HH:mm",hms:"h:mm:ss a",Hms:"HH:mm:ss",M:"L",Md:"M/d",MEd:"E, M/d",MMM:"LLL",MMMd:"MMM d",MMMEd:"E, MMM d",MMMMd:"MMMM d",ms:"mm:ss",y:"y G",yyyy:"y G",yyyyM:"M/y GGGGG",yyyyMd:"M/d/y GGGGG",yyyyMEd:"E, M/d/y GGGGG",yyyyMMM:"MMM y G",yyyyMMMd:"MMM d, y G",yyyyMMMEd:"E, MMM d, y G",yyyyMMMM:"MMMM y G",yyyyQQQ:"QQQ y G",yyyyQQQQ:"QQQQ y G"}}}},timeZoneNames:{hourFormat:"+HH:mm;-HH:mm",gmtFormat:"GMT{0}",gmtZeroFormat:"GMT"}},numbers:{currencies:{USD:{displayName:"US Dollar",symbol:"$","symbol-alt-narrow":"$"},EUR:{displayName:"Euro",symbol:"€","symbol-alt-narrow":"€"},GBP:{displayName:"British Pound","symbol-alt-narrow":"£"}},defaultNumberingSystem:"latn",minimumGroupingDigits:"1","symbols-numberSystem-latn":{decimal:".",group:",",list:";",percentSign:"%",plusSign:"+",minusSign:"-",exponential:"E",superscriptingExponent:"×",perMille:"‰",infinity:"∞",nan:"NaN",timeSeparator:":"},"decimalFormats-numberSystem-latn":{standard:"#,##0.###"},"percentFormats-numberSystem-latn":{standard:"#,##0%"},"currencyFormats-numberSystem-latn":{standard:"¤#,##0.00",accounting:"¤#,##0.00;(¤#,##0.00)"},"scientificFormats-numberSystem-latn":{standard:"#E0"}}},t.blazorDefaultObject={numbers:{mapper:{0:"0",1:"1",2:"2",3:"3",4:"4",5:"5",6:"6",7:"7",8:"8",9:"9"},mapperDigits:"0123456789",numberSymbols:{decimal:".",group:",",plusSign:"+",minusSign:"-",percentSign:"%",nan:"NaN",timeSeparator:":",infinity:"∞"},timeSeparator:":",currencySymbol:"$",currencypData:{nlead:"$",nend:"",groupSeparator:",",groupData:{primary:3},maximumFraction:2,minimumFraction:2},percentpData:{nlead:"",nend:"%",groupSeparator:",",groupData:{primary:3},maximumFraction:2,minimumFraction:2},percentnData:{nlead:"-",nend:"%",groupSeparator:",",groupData:{primary:3},maximumFraction:2,minimumFraction:2},currencynData:{nlead:"($",nend:")",groupSeparator:",",groupData:{primary:3},maximumFraction:2,minimumFraction:2},decimalnData:{nlead:"-",nend:"",groupData:{primary:3},maximumFraction:2,minimumFraction:2},decimalpData:{nlead:"",nend:"",groupData:{primary:3},maximumFraction:2,minimumFraction:2}},dates:{dayPeriods:{am:"AM",pm:"PM"},dateSeperator:"/",days:{abbreviated:{sun:"Sun",mon:"Mon",tue:"Tue",wed:"Wed",thu:"Thu",fri:"Fri",sat:"Sat"},short:{sun:"Su",mon:"Mo",tue:"Tu",wed:"We",thu:"Th",fri:"Fr",sat:"Sa"},wide:{sun:"Sunday",mon:"Monday",tue:"Tuesday",wed:"Wednesday",thu:"Thursday",fri:"Friday",sat:"Saturday"}},months:{abbreviated:{1:"Jan",2:"Feb",3:"Mar",4:"Apr",5:"May",6:"Jun",7:"Jul",8:"Aug",9:"Sep",10:"Oct",11:"Nov",12:"Dec"},wide:{1:"January",2:"February",3:"March",4:"April",5:"May",6:"June",7:"July",8:"August",9:"September",10:"October",11:"November",12:"December"}},eras:{1:"AD"}}},t.monthIndex={3:"abbreviated",4:"wide",5:"narrow",1:"abbreviated"},t.month="months",t.days="days",t.patternMatcher={C:"currency",P:"percent",N:"decimal",A:"currency",E:"scientific"},t.getResultantPattern=h,t.getDependables=d,t.getSymbolPattern=c,t.ConvertDateToWeekFormat=p,t.compareBlazorDateFormats=m,t.getProperNumericSkeleton=y,t.getFormatData=v,t.changeCurrencySymbol=w,t.getCurrencySymbol=x,t.customFormat=function(e,t,i){for(var r={},n=e.split(";"),o=["pData","nData","zeroData"],s=0;s<n.length;s++)r[o[s]]=M(n[s],t,i);return g(r.nData)&&(r.nData=u({},r.pData),r.nData.nlead=g(t)?"-"+r.nData.nlead:t.minusSymbol+r.nData.nlead),r},t.customNumberFormat=M,t.isCurrencyPercent=N,t.getDateSeparator=function(e){var t=(a("dateFormats.short",e)||"").match(/[d‏M‏]([^d‏M])[d‏M‏]/i);return t?t[1]:"/"},t.getActualDateTimeFormat=function(e,t,i,r){var s=d(i,e,t.calendar);b()&&(t=m(t,e));var l=t.format||h(t.skeleton,s.dateObject,t.type);if(r){if(-1!==(l=l.replace(n,(function(e){return o[e]}))).indexOf("z")){var c=l.match(/z/g).length,p=void 0,u={timeZone:{}};u.numMapper=C.getNumberMapper(s.parserObject,C.getNumberingSystem(i)),u.timeZone=a("dates.timeZoneNames",s.parserObject);var g=(new Date).getTimezoneOffset(),f=c<4?"+H;-H":u.timeZone.hourFormat;f=f.replace(/:/g,u.numMapper.timeSeparator),0===g?p=u.timeZone.gmtZeroFormat:(p=F.getTimeZoneValue(g,f),p=u.timeZone.gmtFormat.replace(/\{0\}/,p)),l=l.replace(/[z]+/,'"'+p+'"')}l=l.replace(/ $/,"")}return l},t.getActualNumberFormat=function(i,r,n,o){var s,l,h=d(n,i,"",!0),p={custom:!0},g=h.numericObject,f={},m=(r.format||"").match(t.currencyFormatRegex),w=t.formatRegex.test(r.format)?y(r.format||"N"):{},M={};if(m){M.numberMapper=b()?u({},h.numericObject):C.getNumberMapper(h.parserObject,C.getNumberingSystem(n),!0);var N=b()?a("currencySymbol",h.numericObject):x(h.numericObject,r.currency||e.defaultCurrencyCode,r.altSymbol),O=c("currency",M.numberMapper.numberSystem,h.numericObject,/a/i.test(r.format)),P=(O=O.replace(/\u00A4/g,N)).split(";");f.hasNegativePattern=!!b()||P.length>1,f.nData=b()?a(w.type+"nData",g):v(P[1]||"-"+P[0],!0,N),f.pData=b()?a(w.type+"pData",g):v(P[0],!1,N),m[2]||r.minimumFractionDigits||r.maximumFractionDigits||(s=v(O.split(";")[0],!0,"",!0).minimumFraction)}if(t.formatRegex.test(r.format)||!r.format){if(u(p,y(r.format||"N")),p.custom=!1,l="###0",p.fractionDigits||r.minimumFractionDigits||r.maximumFractionDigits||s){p.fractionDigits&&(r.minimumFractionDigits=r.maximumFractionDigits=p.fractionDigits),l=I(l,s||p.fractionDigits||r.minimumFractionDigits||0,r.maximumFractionDigits||0)}if(r.minimumIntegerDigits&&(l=S(l,r.minimumIntegerDigits)),r.useGrouping&&(l=T(l)),"currency"===p.type||p.type&&b()){b()&&"currency"!==p.type&&(f.pData=a(p.type+"pData",g),f.nData=a(p.type+"nData",g));var A=l;l=f.pData.nlead+A+f.pData.nend,(f.hasNegativePattern||b())&&(l+=";"+f.nData.nlead+A+f.nData.nend)}"percent"!==p.type||b()||(l+=" %")}else l=r.format.replace(/'/g,'"');return Object.keys(M).length>0&&(l=o?l:function(e,t){if(-1!==e.indexOf(",")){var i=e.split(",");e=i[0]+a("numberMapper.numberSymbols.group",t)+i[1].replace(".",a("numberMapper.numberSymbols.decimal",t))}else e=e.replace(".",a("numberMapper.numberSymbols.decimal",t));return e}(l,M)),l},t.fractionDigitsPattern=I,t.minimumIntegerPattern=S,t.groupingPattern=T,t.getWeekData=function(e,t){var i="sun",r=a("supplemental.weekData.firstDay",t),n=e;return/en-/.test(n)&&(n=n.slice(3)),n=n.slice(0,2).toUpperCase()+n.substr(2),r&&(i=r[""+n]||r[n.slice(0,2)]||"sun"),s[""+i]},t.replaceBlazorCurrency=function(e,t,i){var r=a(i||"",O);if(t!==r)for(var n=0,o=e;n<o.length;n++){var s=o[n];s.nend=s.nend.replace(t,r),s.nlead=s.nlead.replace(t,r)}},t.getWeekOfYear=function(e){var t,i=new Date(e.getFullYear(),0,1),r=i.getDay();r=r>=0?r:r+7;var n=Math.floor((e.getTime()-i.getTime()-6e4*(e.getTimezoneOffset()-i.getTimezoneOffset()))/864e5)+1;if(r<4){if((t=Math.floor((n+r-1)/7)+1)>52){var o=new Date(e.getFullYear()+1,0,1).getDay();t=(o=o>=0?o:o+7)<4?1:53}}else t=Math.floor((n+r-1)/7);return t}}(e.IntlBase||(e.IntlBase={}));var X=/^(.*?):[ \t]*([^\r\n]*)$/gm,Z=function(){function e(e,t,r,n){this.mode=!0,this.emitError=!0,this.options={},"string"==typeof e?(this.url=e,this.type=t?t.toUpperCase():"GET",this.mode=!!g(r)||r):"object"===i(e)&&(this.options=e,p(this,this.options)),this.type=this.type?this.type.toUpperCase():"GET",this.contentType=void 0!==this.contentType?this.contentType:n}return e.prototype.send=function(e){var t=this;this.data=g(e)?this.data:e;var i={cancel:!1,httpRequest:null};return new Promise((function(e,r){t.httpRequest=new XMLHttpRequest,t.httpRequest.onreadystatechange=function(){t.stateChange(e,r)},g(t.onLoad)||(t.httpRequest.onload=t.onLoad),g(t.onProgress)||(t.httpRequest.onprogress=t.onProgress),g(t.onAbort)||(t.httpRequest.onabort=t.onAbort),g(t.onError)||(t.httpRequest.onerror=t.onError),g(t.onUploadProgress)||(t.httpRequest.upload.onprogress=t.onUploadProgress),t.httpRequest.open(t.type,t.url,t.mode),g(t.data)||null===t.contentType||t.httpRequest.setRequestHeader("Content-Type",t.contentType||"application/json; charset=utf-8"),t.beforeSend&&(i.httpRequest=t.httpRequest,t.beforeSend(i)),i.cancel||t.httpRequest.send(g(t.data)?null:t.data)}))},e.prototype.successHandler=function(e){return this.onSuccess&&this.onSuccess(e,this),e},e.prototype.failureHandler=function(e){return this.onFailure&&this.onFailure(this.httpRequest),e},e.prototype.stateChange=function(e,t){var i=this.httpRequest.responseText;if(this.dataType&&"json"===this.dataType.toLowerCase())if(""===i)i=void 0;else try{i=JSON.parse(i)}catch(e){}4===this.httpRequest.readyState&&(this.httpRequest.status>=200&&this.httpRequest.status<=299||304===this.httpRequest.status?e(this.successHandler(i)):this.emitError?t(new Error(this.failureHandler(this.httpRequest.statusText))):e())},e.prototype.getResponseHeader=function(e){var t,i;t={};for(var r=X.exec(this.httpRequest.getAllResponseHeaders());r;)t[r[1].toLowerCase()]=r[2],r=X.exec(this.httpRequest.getAllResponseHeaders());return g(i=t[e.toLowerCase()])?null:i},e}(),K=/android|webos|iphone|ipad|ipod|blackberry|iemobile|opera mini|mobile/i,J=/msie|trident/i,$=/Trident\/7\./,ee=/(ipad|iphone|ipod touch)/i,te=/(ipad|iphone|ipod touch);.*os 7_\d|(ipad|iphone|ipod touch);.*os 8_\d/i,ie=/android/i,re=/trident|windows phone|edge/i,ne=/(version)[ /]([\w.]+)/i,oe={OPERA:/(opera|opr)(?:.*version|)[ /]([\w.]+)/i,EDGE:/(edge)(?:.*version|)[ /]([\w.]+)/i,CHROME:/(chrome|crios)[ /]([\w.]+)/i,PANTHOMEJS:/(phantomjs)[ /]([\w.]+)/i,SAFARI:/(safari)[ /]([\w.]+)/i,WEBKIT:/(webkit)[ /]([\w.]+)/i,MSIE:/(msie|trident) ([\w.]+)/i,MOZILLA:/(mozilla)(?:.*? rv:([\w.]+)|)/i};"undefined"!=typeof window&&(window.browserDetails=window.browserDetails||{});var se=function(){function e(){}return e.extractBrowserDetail=function(){for(var t={culture:{}},i=[],r=0,n=Object.keys(oe);r<n.length;r++){var o=n[r];if(i=e.userAgent.match(oe[""+o])){if(t.name="opr"===i[1].toLowerCase()?"opera":i[1].toLowerCase(),t.name="crios"===i[1].toLowerCase()?"chrome":t.name,t.version=i[2],t.culture.name=t.culture.language=navigator.language,e.userAgent.match($)){t.name="msie";break}var s=e.userAgent.match(ne);"safari"===t.name&&s&&(t.version=s[2]);break}}return t},e.getEvent=function(t){var i={start:{isPointer:"pointerdown",isTouch:"touchstart",isDevice:"mousedown"},move:{isPointer:"pointermove",isTouch:"touchmove",isDevice:"mousemove"},end:{isPointer:"pointerup",isTouch:"touchend",isDevice:"mouseup"},cancel:{isPointer:"pointercancel",isTouch:"touchcancel",isDevice:"mouseleave"}};return e.isPointer?i[""+t].isPointer:e.isTouch?i[""+t].isTouch+(e.isDevice?"":" "+i[""+t].isDevice):i[""+t].isDevice},e.getTouchStartEvent=function(){return e.getEvent("start")},e.getTouchEndEvent=function(){return e.getEvent("end")},e.getTouchMoveEvent=function(){return e.getEvent("move")},e.getTouchCancelEvent=function(){return e.getEvent("cancel")},e.getValue=function(t,i){var r="undefined"!=typeof window?window.browserDetails:{};return"undefined"!=typeof navigator&&"MacIntel"===navigator.platform&&navigator.maxTouchPoints>1&&!0===e.isTouch&&(r.isIos=!0,r.isDevice=!0,r.isTouch=!0,r.isPointer=!0),void 0===r[""+t]?r[""+t]=i.test(e.userAgent):r[""+t]},Object.defineProperty(e,"userAgent",{get:function(){return e.uA},set:function(t){e.uA=t,window.browserDetails={}},enumerable:!0,configurable:!0}),Object.defineProperty(e,"info",{get:function(){return f(window.browserDetails.info)?window.browserDetails.info=e.extractBrowserDetail():window.browserDetails.info},enumerable:!0,configurable:!0}),Object.defineProperty(e,"isIE",{get:function(){return e.getValue("isIE",J)},enumerable:!0,configurable:!0}),Object.defineProperty(e,"isTouch",{get:function(){return f(window.browserDetails.isTouch)?window.browserDetails.isTouch="ontouchstart"in window.navigator||window&&window.navigator&&window.navigator.maxTouchPoints>0||"ontouchstart"in window:window.browserDetails.isTouch},enumerable:!0,configurable:!0}),Object.defineProperty(e,"isPointer",{get:function(){return f(window.browserDetails.isPointer)?window.browserDetails.isPointer="pointerEnabled"in window.navigator:window.browserDetails.isPointer},enumerable:!0,configurable:!0}),Object.defineProperty(e,"isMSPointer",{get:function(){return f(window.browserDetails.isMSPointer)?window.browserDetails.isMSPointer="msPointerEnabled"in window.navigator:window.browserDetails.isMSPointer},enumerable:!0,configurable:!0}),Object.defineProperty(e,"isDevice",{get:function(){return e.getValue("isDevice",K)},enumerable:!0,configurable:!0}),Object.defineProperty(e,"isIos",{get:function(){return e.getValue("isIos",ee)},enumerable:!0,configurable:!0}),Object.defineProperty(e,"isIos7",{get:function(){return e.getValue("isIos7",te)},enumerable:!0,configurable:!0}),Object.defineProperty(e,"isAndroid",{get:function(){return e.getValue("isAndroid",ie)},enumerable:!0,configurable:!0}),Object.defineProperty(e,"isWebView",{get:function(){return f(window.browserDetails.isWebView)?(window.browserDetails.isWebView=!(f(window.cordova)&&f(window.PhoneGap)&&f(window.phonegap)&&"object"!==window.forge),window.browserDetails.isWebView):window.browserDetails.isWebView},enumerable:!0,configurable:!0}),Object.defineProperty(e,"isWindows",{get:function(){return e.getValue("isWindows",re)},enumerable:!0,configurable:!0}),Object.defineProperty(e,"touchStartEvent",{get:function(){return f(window.browserDetails.touchStartEvent)?window.browserDetails.touchStartEvent=e.getTouchStartEvent():window.browserDetails.touchStartEvent},enumerable:!0,configurable:!0}),Object.defineProperty(e,"touchMoveEvent",{get:function(){return f(window.browserDetails.touchMoveEvent)?window.browserDetails.touchMoveEvent=e.getTouchMoveEvent():window.browserDetails.touchMoveEvent},enumerable:!0,configurable:!0}),Object.defineProperty(e,"touchEndEvent",{get:function(){return f(window.browserDetails.touchEndEvent)?window.browserDetails.touchEndEvent=e.getTouchEndEvent():window.browserDetails.touchEndEvent},enumerable:!0,configurable:!0}),Object.defineProperty(e,"touchCancelEvent",{get:function(){return f(window.browserDetails.touchCancelEvent)?window.browserDetails.touchCancelEvent=e.getTouchCancelEvent():window.browserDetails.touchCancelEvent},enumerable:!0,configurable:!0}),e.uA="undefined"!=typeof navigator?navigator.userAgent:"",e}(),ae=function(){function e(){}return e.addOrGetEventData=function(e){return"__eventList"in e?e.__eventList.events:(e.__eventList={},e.__eventList.events=[])},e.add=function(t,i,r,n,o){var s,a=e.addOrGetEventData(t);s=o?m(r,o):r,n&&(s=s.bind(n));for(var l=i.split(" "),h=0;h<l.length;h++)a.push({name:l[parseInt(h.toString(),10)],listener:r,debounce:s}),se.isIE?t.addEventListener(l[parseInt(h.toString(),10)],s):t.addEventListener(l[parseInt(h.toString(),10)],s,{passive:!1});return s},e.remove=function(t,i,r){for(var n=e.addOrGetEventData(t),o=i.split(" "),s=function(e){var i,s=-1;n&&0!==n.length&&n.some((function(t,n){return t.name===o[parseInt(e.toString(),10)]&&t.listener===r&&(s=n,i=t.debounce,!0)})),-1!==s&&n.splice(s,1),i&&t.removeEventListener(o[parseInt(e.toString(),10)],i)},a=0;a<o.length;a++)s(a)},e.clearEvents=function(t){var i,r;r=u([],r,i=e.addOrGetEventData(t));for(var n=0;n<r.length;n++)t.removeEventListener(r[parseInt(n.toString(),10)].name,r[parseInt(n.toString(),10)].debounce),i.shift()},e.trigger=function(t,i,r){for(var n=0,o=e.addOrGetEventData(t);n<o.length;n++){var s=o[n];s.name===i&&s.debounce.call(this,r)}},e}(),le=/^svg|^path|^g/;function he(e,t){var i=le.test(e)?document.createElementNS("http://www.w3.org/2000/svg",e):document.createElement(e);return void 0===t||(i.innerHTML=t.innerHTML?t.innerHTML:"",void 0!==t.className&&(i.className=t.className),void 0!==t.id&&(i.id=t.id),void 0!==t.styles&&i.setAttribute("style",t.styles),void 0!==t.attrs&&me(i,t.attrs)),i}function de(e,t){for(var i=pe(t),r=0,n=e;r<n.length;r++)for(var o=n[r],s=0,h=i;s<h.length;s++){var d=h[s];if(c(o)){var p=a("attributes.className",o);g(p)?l("attributes.className",d,o):new RegExp("\\b"+d+"\\b","i").test(p)||l("attributes.className",p+" "+d,o)}else o.classList.contains(d)||o.classList.add(d)}return e}function ce(e,t){for(var i=pe(t),r=0,n=e;r<n.length;r++){var o=n[r],s=c(o);if(s?a("attributes.className",o):""!==o.className)for(var h=0,d=i;h<d.length;h++){var p=d[h];if(s){var u=a("attributes.className",o).split(" "),g=u.indexOf(p);-1!==g&&u.splice(g,1),l("attributes.className",u.join(" "),o)}else o.classList.remove(p)}}return e}function pe(e){var t=[];return"string"==typeof e?t.push(e):t=e,t}function ue(e){var t=e;return""===t.style.visibility&&t.offsetWidth>0}function ge(e){e.querySelectorAll("script").forEach((function(e){var t=document.createElement("script");t.text=e.innerHTML,document.head.appendChild(t),fe(t)}))}function fe(e){var t=e.parentNode;if(t)return t.removeChild(e)}function me(e,t){for(var i=e,r=0,n=Object.keys(t);r<n.length;r++){var o=n[r];if(c(i)){var s=o;"tabindex"===o&&(s="tabIndex"),i.attributes[""+s]=t[""+o]}else i.setAttribute(o,t[""+o])}return i}function ye(e,t,i){return void 0===t&&(t=document),e=be(e),t.querySelector(e)}function ve(e,t,i){return void 0===t&&(t=document),e=be(e),t.querySelectorAll(e)}function be(e){var t=/(!|"|\$|%|&|'|\(|\)|\*|\/|:|;|<|=|\?|@|\]|\^|`|{|}|\||\+|~)/g;if(e.match(/#[0-9]/g)||e.match(t)){for(var i=e.split(","),r=0;r<i.length;r++){for(var n=i[parseInt(r.toString(),10)].split(" "),o=0;o<n.length;o++)if(n[parseInt(o.toString(),10)].indexOf("#")>-1&&!n[parseInt(o.toString(),10)].match(/\[.*\]/)){var s=n[parseInt(o.toString(),10)].split("#");if(s[1].match(/^\d/)||s[1].match(t)){var a=n[parseInt(o.toString(),10)].split(".");a[0]=a[0].replace(/#/,"[id='")+"']",n[parseInt(o.toString(),10)]=a.join(".")}}i[parseInt(r.toString(),10)]=n.join(" ")}return i.join(",")}return e}function we(e,t){var i=e;if("function"==typeof i.closest)return i.closest(t);for(;i&&1===i.nodeType;){if(Me(i,t))return i;i=i.parentNode}return null}function xe(e,t){void 0!==t&&Object.keys(t).forEach((function(i){e.style[i]=t[i]}))}function Me(e,t){var i=e.matches||e.msMatchesSelector||e.webkitMatchesSelector;return i?i.call(e,t):-1!==[].indexOf.call(document.querySelectorAll(t),e)}var Ne=new RegExp("]"),Ie=function(){function e(e,t){this.isRendered=!1,this.isComplexArraySetter=!1,this.isServerRendered=!1,this.allowServerDataBinding=!0,this.isProtectedOnChange=!0,this.properties={},this.changedProperties={},this.oldProperties={},this.bulkChanges={},this.refreshing=!1,this.ignoreCollectionWatch=!1,this.finalUpdate=function(){},this.childChangedProperties={},this.modelObserver=new _(this),f(t)||(this.element="string"==typeof t?document.querySelector(t):t,g(this.element)||(this.isProtectedOnChange=!1,this.addInstance())),f(e)||this.setProperties(e,!0),this.isDestroyed=!1}return e.prototype.setProperties=function(e,t){var i=this.isProtectedOnChange;this.isProtectedOnChange=!!t,p(this,e),!0!==t?(p(this.changedProperties,e),this.dataBind()):b()&&this.isRendered&&this.serverDataBind(e),this.finalUpdate(),this.changedProperties={},this.oldProperties={},this.isProtectedOnChange=i},e.callChildDataBind=function(e,t){for(var i=0,r=Object.keys(e);i<r.length;i++){var n=r[i];if(t[""+n]instanceof Array)for(var o=0,s=t[""+n];o<s.length;o++){var a=s[o];void 0!==a.dataBind&&a.dataBind()}else t[""+n].dataBind()}},e.prototype.clearChanges=function(){this.finalUpdate(),this.changedProperties={},this.oldProperties={},this.childChangedProperties={}},e.prototype.dataBind=function(){if(e.callChildDataBind(this.childChangedProperties,this),Object.getOwnPropertyNames(this.changedProperties).length){var t=this.isProtectedOnChange,i=this.changedProperties,r=this.oldProperties;this.clearChanges(),this.isProtectedOnChange=!0,this.onPropertyChanged(i,r),this.isProtectedOnChange=t}},e.prototype.serverDataBind=function(e){if(b()){e=e||{},u(this.bulkChanges,{},e,!0);this.allowServerDataBinding&&window.sfBlazor.updateModel&&(window.sfBlazor.updateModel(this),this.bulkChanges={})}},e.prototype.saveChanges=function(e,t,i){if(b()){var r={};r[""+e]=t,this.serverDataBind(r)}this.isProtectedOnChange||(this.oldProperties[""+e]=i,this.changedProperties[""+e]=t,this.finalUpdate(),this.finalUpdate=s(this.dataBind.bind(this)))},e.prototype.addEventListener=function(e,t){this.modelObserver.on(e,t)},e.prototype.removeEventListener=function(e,t){this.modelObserver.off(e,t)},e.prototype.trigger=function(e,t,i,r){var n=this;if(!0!==this.isDestroyed){var o=this.isProtectedOnChange;this.isProtectedOnChange=!1;var s=this.modelObserver.notify(e,t,i,r);if(Ne.test(e)){var l=a(e,this);if(l){if(window.Blazor){var h=l.call(this,t);h&&"function"==typeof h.then?i?h.then((function(e){i&&(e="string"==typeof e&&n.modelObserver.isJson(e)?JSON.parse(e):e,i.call(n,e))})).catch((function(e){r&&(e="string"==typeof e&&n.modelObserver.isJson(e)?JSON.parse(e):e,r.call(n,e))})):s=h:i&&i.call(this,t)}else l.call(this,t),i&&i.call(this,t)}else i&&i.call(this,t)}return this.isProtectedOnChange=o,s}},e.prototype.addInstance=function(){var e="e-"+this.getModuleName().toLowerCase();de([this.element],["e-lib",e]),g(this.element.ej2_instances)?l("ej2_instances",[this],this.element):this.element.ej2_instances.push(this)},e.prototype.destroy=function(){var e=this;this.element.ej2_instances=this.element.ej2_instances.filter((function(t){return t!==e})),ce([this.element],["e-"+this.getModuleName()]),0===this.element.ej2_instances.length&&ce([this.element],["e-lib"]),this.clearChanges(),this.modelObserver.destroy(),this.isDestroyed=!0},e}();function Se(e,t){var i,r,n="string"==typeof e?document.getElementById(e):e;for(r=0;r<n.ej2_instances.length;r++){if(i=n.ej2_instances[parseInt(r.toString(),10)],"string"==typeof t){if(t===i.getModuleName())return i}else if(i instanceof t)return i}}function Ce(e,t,i,r){return e.properties.hasOwnProperty(t)&&e.properties[t]instanceof r||(e.properties[""+t]=o(r,[e,t,i])),e.properties[""+t]}function Oe(e,t,i,r,n,s){for(var a=[],l=i?i.length:0,h=0;h<l;h++){var d=r;if(s&&(d=r(i[parseInt(h.toString(),10)],e)),n){var c=o(d,[e,t,{},!0]);c.setProperties(i[parseInt(h.toString(),10)],!0),a.push(c)}else a.push(o(d,[e,t,i[parseInt(h.toString(),10)],!1]))}return a}function Te(e,t){return function(){return this.properties.hasOwnProperty(t)||(this.properties[""+t]=e),this.properties[""+t]}}function Pe(e,t){return function(i){if(this.properties[""+t]!==i){var r=this.properties.hasOwnProperty(t)?this.properties[t]:e;this.saveChanges(t,i,r),this.properties[""+t]=i}}}function Ae(e,t,i){return function(){return Ce(this,t,e,i)}}function Le(e,t,i){return function(r){Ce(this,t,e,i).setProperties(r)}}function Fe(e,t,i){return function(){var r=i({});return this.properties.hasOwnProperty(t)?this.properties[""+t]:Ce(this,t,e,r)}}function De(e,t,i){return function(r){var n=i(r,this);Ce(this,t,e,n).setProperties(r)}}function Ee(e,t,i){return function(){var r=this;if(!this.properties.hasOwnProperty(t)){var n=Oe(this,t,e,i,!1);this.properties[""+t]=n}var o=void 0!==this.controlParent&&this.controlParent.ignoreCollectionWatch||this.ignoreCollectionWatch;return this.properties[t].hasOwnProperty("push")||o||["push","pop"].forEach((function(e){var n={value:Re(e,t,i,r.properties[""+t]).bind(r),configurable:!0};Object.defineProperty(r.properties[""+t],e,n)})),this.properties[t].hasOwnProperty("isComplexArray")||Object.defineProperty(this.properties[""+t],"isComplexArray",{value:!0}),this.properties[""+t]}}function ze(e,t,i){return function(r){this.isComplexArraySetter=!0;var n=Oe(this,t,e,i,!1),o=Oe(this,t,r,i,!0);this.isComplexArraySetter=!1,this.saveChanges(t,o,n),this.properties[""+t]=o}}function ke(e,t,i){return function(r){var n=this.properties.hasOwnProperty(t)?this.properties[t]:e,o=Oe(this,t,r,i,!0,!0);this.saveChanges(t,o,n),this.properties[""+t]=o}}function We(e,t,i){return function(){var r=i({});if(!this.properties.hasOwnProperty(t)){var n=Oe(this,t,e,r,!1);this.properties[""+t]=n}return this.properties[""+t]}}function Re(e,t,i,r){return function(){for(var i=[],n=0;n<arguments.length;n++)i[n]=arguments[n];var o=this.propName?this.getParentKey()+"."+t+"-":t+"-";switch(e){case"push":for(var s=0;s<i.length;s++){Array.prototype[""+e].apply(r,[i[parseInt(s.toString(),10)]]);var a=je(o+(r.length-1),i[parseInt(s.toString(),10)],!this.controlParent,e);this.serverDataBind(a,i[parseInt(s.toString(),10)],!1,e)}break;case"pop":Array.prototype[""+e].apply(r);var l=je(o+r.length,null,!this.controlParent,e);this.serverDataBind(l,{ejsAction:"pop"},!1,e)}return r}}function je(e,t,r,n){var o=e;if(r&&((o={})[""+e]=t,t&&"object"===i(t))){o[""+e].ejsAction=n}return o}function Ue(e){return function(t,i){var r={set:Pe(e,i),get:Te(e,i),enumerable:!0,configurable:!0};Object.defineProperty(t,i,r),Ve(t,i,"prop",e)}}function He(e,t){return function(i,r){var n={set:Le(e,r,t),get:Ae(e,r,t),enumerable:!0,configurable:!0};Object.defineProperty(i,r,n),Ve(i,r,"complexProp",e,t)}}function Be(){return function(e,t){var i={set:function(e){var i=this.properties[""+t];if(i!==e){var r=function e(t,i){if(!1===t.hasOwnProperty("parentObj"))return{context:t,prefix:i};var r=a("propName",t);return r&&(i=r+"-"+i),e(a("parentObj",t),i)}(this,t);!1===f(i)&&r.context.removeEventListener(r.prefix,i),r.context.addEventListener(r.prefix,e),this.properties[""+t]=e}},get:Te(void 0,t),enumerable:!0,configurable:!0};Object.defineProperty(e,t,i),Ve(e,t,"event")}}function _e(e){}function Ve(e,t,i,r,n){f(e.propList)&&(e.propList={props:[],complexProps:[],colProps:[],events:[],propNames:[],complexPropNames:[],colPropNames:[],eventNames:[]}),e.propList[i+"s"].push({propertyName:t,defaultValue:r,type:n}),e.propList[i+"Names"].push(t)}var Ye,Qe=(Ye=function(e,t){return(Ye=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}Ye(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),qe=function(e,t,r,n){var o,s=arguments.length,a=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(s<3?o(a):s>3?o(t,r,a):o(t,r))||a);return s>3&&a&&Object.defineProperty(t,r,a),a},Ge=function(t){function i(e){var i=t.call(this,e,void 0)||this;return i.easing={ease:"cubic-bezier(0.250, 0.100, 0.250, 1.000)",linear:"cubic-bezier(0.250, 0.250, 0.750, 0.750)",easeIn:"cubic-bezier(0.420, 0.000, 1.000, 1.000)",easeOut:"cubic-bezier(0.000, 0.000, 0.580, 1.000)",easeInOut:"cubic-bezier(0.420, 0.000, 0.580, 1.000)",elasticInOut:"cubic-bezier(0.5,-0.58,0.38,1.81)",elasticIn:"cubic-bezier(0.17,0.67,0.59,1.81)",elasticOut:"cubic-bezier(0.7,-0.75,0.99,1.01)"},i}var r;return Qe(i,t),r=i,i.prototype.animate=function(e,t){t=t||{};var i=this.getModel(t);if("string"==typeof e)for(var n=0,o=Array.prototype.slice.call(ve(e,document));n<o.length;n++){var s=o[n];i.element=s,r.delayAnimation(i)}else i.element=e,r.delayAnimation(i)},i.stop=function(e,t){e.style.animation="",e.removeAttribute("e-animate");var i=e.getAttribute("e-animation-id");if(i){var r=parseInt(i,10);cancelAnimationFrame(r),e.removeAttribute("e-animation-id")}t&&t.end&&t.end.call(this,t)},i.delayAnimation=function(t){"Disable"===e.animationMode?(t.begin&&t.begin.call(this,t),t.end&&t.end.call(this,t)):t.delay?setTimeout((function(){r.applyAnimation(t)}),t.delay):r.applyAnimation(t)},i.applyAnimation=function(e){var t=this;e.timeStamp=0;var i=0,r=0,n=0,o=e.duration;e.element.setAttribute("e-animate","true");!function s(a){try{if(a){n=0===n?a:n,e.timeStamp=a+e.timeStamp-n,n=a,!i&&e.begin&&e.begin.call(t,e),i+=1;var l=e.timeStamp/i;e.timeStamp<o&&e.timeStamp+l<o&&e.element.getAttribute("e-animate")?(e.element.style.animation=e.name+" "+e.duration+"ms "+e.timingFunction,e.progress&&e.progress.call(t,e),requestAnimationFrame(s)):(cancelAnimationFrame(r),e.element.removeAttribute("e-animation-id"),e.element.removeAttribute("e-animate"),e.element.style.animation="",e.end&&e.end.call(t,e))}else r=requestAnimationFrame(s),e.element.setAttribute("e-animation-id",r.toString())}catch(i){cancelAnimationFrame(r),e.element.removeAttribute("e-animation-id"),e.fail&&e.fail.call(t,i)}}()},i.prototype.getModel=function(e){return{name:e.name||this.name,delay:e.delay||this.delay,duration:void 0!==e.duration?e.duration:this.duration,begin:e.begin||this.begin,end:e.end||this.end,fail:e.fail||this.fail,progress:e.progress||this.progress,timingFunction:this.easing[e.timingFunction]?this.easing[e.timingFunction]:e.timingFunction||this.easing[this.timingFunction]}},i.prototype.onPropertyChanged=function(e,t){},i.prototype.getModuleName=function(){return"animation"},i.prototype.destroy=function(){},qe([Ue("FadeIn")],i.prototype,"name",void 0),qe([Ue(400)],i.prototype,"duration",void 0),qe([Ue("ease")],i.prototype,"timingFunction",void 0),qe([Ue(0)],i.prototype,"delay",void 0),qe([Be()],i.prototype,"progress",void 0),qe([Be()],i.prototype,"begin",void 0),qe([Be()],i.prototype,"end",void 0),qe([Be()],i.prototype,"fail",void 0),i=r=qe([_e],i)}(Ie);function Xe(e){var t=e.target,i=this.rippleOptions.selector,r=i?we(t,i):t;if(!(!r||this.rippleOptions&&we(t,this.rippleOptions.ignore))){var n=r.getBoundingClientRect(),o=e.pageX-document.body.scrollLeft,s=e.pageY-(!document.body.scrollTop&&document.documentElement?document.documentElement.scrollTop:document.body.scrollTop),a=Math.max(Math.abs(o-n.left),Math.abs(o-n.right)),l=Math.max(Math.abs(s-n.top),Math.abs(s-n.bottom)),h=Math.sqrt(a*a+l*l),d=2*h+"px",c=o-n.left-h,p=s-n.top-h;this.rippleOptions&&this.rippleOptions.isCenterRipple&&(c=0,p=0,d="100%"),r.classList.add("e-ripple");var u=he("div",{className:"e-ripple-element",styles:"width: "+d+";height: "+d+";left: "+c+"px;top: "+p+"px;transition-duration: "+this.rippleOptions.duration.toString()+"ms;"});r.appendChild(u),window.getComputedStyle(u).getPropertyValue("opacity"),u.style.transform="scale(1)",r!==this.parent&&ae.add(r,"mouseleave",Ke,{parent:this.parent,rippleOptions:this.rippleOptions})}}function Ze(e){Je(e,this)}function Ke(e){Je(e,this)}function Je(e,t){var i=t.rippleOptions.duration,r=e.target,n=t.rippleOptions.selector,o=n?we(r,n):r;if(o&&(!o||-1!==o.className.indexOf("e-ripple"))){var s=ve(".e-ripple-element",o),a=s[s.length-1];a&&(a.style.opacity="0.5"),t.parent!==o&&ae.remove(o,"mouseleave",Ke),setTimeout((function(){a&&a.parentNode&&a.parentNode.removeChild(a),o.getElementsByClassName("e-ripple-element").length||o.classList.remove("e-ripple"),t.done&&t.done(e)}),i)}}e.isRippleEnabled=!1,e.animationMode="";var $e,et=function(){function e(e){this.loadedModules=[],this.parent=e}return e.prototype.inject=function(e,t){var i=e.length;if(0!==i){this.loadedModules.length&&this.clearUnusedModule(e);for(var r=0;r<i;r++)for(var n=e[parseInt(r.toString(),10)],s=0,a=t;s<a.length;s++){var h=a[s],d=n.member;if(h&&h.prototype.getModuleName()===n.member&&!this.isModuleLoaded(d)){var c=o(h,n.args),p=this.getMemberName(d);n.isProperty?l(p,h,this.parent):l(p,c,this.parent);var u=n;u.member=p,this.loadedModules.push(u)}}}else this.clean()},e.prototype.clean=function(){for(var e=0,t=this.loadedModules;e<t.length;e++){var i=t[e];i.isProperty||a(i.member,this.parent).destroy()}this.loadedModules=[]},e.prototype.clearUnusedModule=function(e){for(var t=this,i=e.map((function(e){return t.getMemberName(e.member)})),r=0,n=this.loadedModules.filter((function(e){return-1===i.indexOf(e.member)}));r<n.length;r++){var o=n[r];o.isProperty||a(o.member,this.parent).destroy(),this.loadedModules.splice(this.loadedModules.indexOf(o),1),h(this.parent,o.member)}},e.prototype.getMemberName=function(e){return e[0].toLowerCase()+e.substring(1)+"Module"},e.prototype.isModuleLoaded=function(e){for(var t=0,i=this.loadedModules;t<i.length;t++){if(i[t].member===this.getMemberName(e))return!0}return!1},e}(),tt=function(){function e(e,t,i,r){this.isComplexArraySetter=!1,this.properties={},this.changedProperties={},this.childChangedProperties={},this.oldProperties={},this.finalUpdate=function(){},this.callChildDataBind=a("callChildDataBind",Ie),this.parentObj=e,this.controlParent=this.parentObj.controlParent||this.parentObj,this.propName=t,this.isParentArray=r,this.setProperties(i,!0)}return e.prototype.updateChange=function(e,t){!0===e?this.parentObj.childChangedProperties[""+t]=e:delete this.parentObj.childChangedProperties[""+t],this.parentObj.updateChange&&this.parentObj.updateChange(e,this.parentObj.propName)},e.prototype.updateTimeOut=function(){if(this.parentObj.updateTimeOut)this.parentObj.finalUpdate(),this.parentObj.updateTimeOut();else{var e=setTimeout(this.parentObj.dataBind.bind(this.parentObj));this.finalUpdate=function(){clearTimeout(e)}}},e.prototype.clearChanges=function(){this.finalUpdate(),this.updateChange(!1,this.propName),this.oldProperties={},this.changedProperties={}},e.prototype.setProperties=function(e,t){!0===t?(p(this,e),this.updateChange(!1,this.propName),this.clearChanges()):p(this,e)},e.prototype.dataBind=function(){if(this.callChildDataBind(this.childChangedProperties,this),this.isParentArray){var e=this.parentObj[this.propName].indexOf(this);Object.keys(this.changedProperties).length&&(l(this.propName+"."+e,this.changedProperties,this.parentObj.changedProperties),l(this.propName+"."+e,this.oldProperties,this.parentObj.oldProperties))}else this.parentObj.changedProperties[this.propName]=this.changedProperties,this.parentObj.oldProperties[this.propName]=this.oldProperties;this.clearChanges()},e.prototype.saveChanges=function(e,t,i,r){this.controlParent.isProtectedOnChange||(r||this.serverDataBind(e,t,!0),this.oldProperties[""+e]=i,this.changedProperties[""+e]=t,this.updateChange(!0,this.propName),this.finalUpdate(),this.updateTimeOut())},e.prototype.serverDataBind=function(e,t,i,r){if(b()&&!this.parentObj.isComplexArraySetter){var n,o={},s=i?this.getParentKey(!0)+"."+e:e;if(-1!==s.indexOf(".")){var a=s.split(".");n=o;for(var l=0;l<a.length;l++){var h=l===a.length-1;n[a[parseInt(l.toString(),10)]]=h?t:{},n=h?n:n[a[parseInt(l.toString(),10)]]}}else o[""+s]={},n=o[""+s],o[""+s][""+e]=t;if(this.isParentArray){n.ejsAction=r||"none"}this.controlParent.serverDataBind(o)}},e.prototype.getParentKey=function(e){var t="",i=this.propName;if(this.isParentArray){t=this.parentObj[this.propName].indexOf(this);var r=this.parentObj[this.propName].length;r=e?r:r>0?r-1:0,i+=t=-1!==t?"-"+t:"-"+r}return this.controlParent!==this.parentObj&&(i=this.parentObj.getParentKey()+"."+this.propName+t),i},e}(),it=["grid","pivotview","treegrid","spreadsheet","rangeNavigator","DocumentEditor","listbox","PdfViewer","richtexteditor","DashboardLayout","chart","stockChart","circulargauge","diagram","heatmap","lineargauge","maps","smithchart","barcode","sparkline","treemap","bulletChart","kanban","daterangepicker","schedule","gantt","signature","query-builder","drop-down-tree","carousel","filemanager","uploader","accordion","tab","treeview"],rt=[115,121,110,99,102,117,115,105,111,110,46,105,115,76,105,99,86,97,108,105,100,97,116,101,100],nt=function(){function e(e){var t;this.isValidated=!1,this.isLicensed=!0,this.version="20.4",this.platform=/JavaScript|ASPNET|ASPNETCORE|ASPNETMVC|FileFormats/i,this.errors={noLicense:"<span>This application was built using a trial version of Syncfusion Essential Studio. To remove the license validation message permanently, a valid license key must be included.</span>",trailExpired:"<span>This application was built using a trial version of Syncfusion Essential Studio. To remove the license validation message permanently, a valid license key must be included.</span>",versionMismatched:"<span>The included Syncfusion license key is invalid.</span>",platformMismatched:"<span>The included Syncfusion license key is invalid.</span>",invalidKey:"<span>The included Syncfusion license key is invalid.</span>"},this.manager=(t=null,{setKey:function(e){t=e},getKey:function(){return t}}),this.npxManager={getKey:function(){return"npxKeyReplace"}},this.manager.setKey(e)}return e.prototype.validate=function(){if(!this.isValidated&&d&&!a(st(rt),d)&&!a("Blazor",d)){var e=void 0,t=void 0;if(this.manager&&this.manager.getKey()||this.npxManager&&"npxKeyReplace"!==this.npxManager.getKey()){var i=this.getInfoFromKey();if(i&&i.length)for(var r=0,n=i;r<n.length;r++){var o=n[r];if(!this.platform.test(o.platform)||o.invalidPlatform)e=this.errors.platformMismatched;else if(-1===o.version.indexOf(this.version))e=(e=(e=this.errors.versionMismatched).replace("##LicenseVersion",o.version)).replace("##Requireversion",this.version+".x");else if(o.expiryDate){var s=new Date(o.expiryDate),h=new Date;if(!(s!==h&&s<h))break;e=this.errors.trailExpired}}else e=this.errors.invalidKey}else{var c=a(st([115,121,110,99,102,117,115,105,111,110,46,108,105,99,101,110,115,101,67,111,110,116,101,110,116]),d);t=a(st([115,121,110,99,102,117,115,105,111,110,46,99,108,97,105,109,65,99,99,111,117,110,116,85,82,76]),d),e=c&&""!==c?c:this.errors.noLicense}if(e&&"undefined"!=typeof document&&!g(document)){var p=he("div",{innerHTML:"<img src='data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPGcgY2xpcC1wYXRoPSJ1cmwoI2NsaXAwXzE5OV80KSI+CjxwYXRoIGQ9Ik0xMiAyMUMxNi45NzA2IDIxIDIxIDE2Ljk3MDYgMjEgMTJDMjEgNy4wMjk0NCAxNi45NzA2IDMgMTIgM0M3LjAyOTQ0IDMgMyA3LjAyOTQ0IDMgMTJDMyAxNi45NzA2IDcuMDI5NDQgMjEgMTIgMjFaIiBzdHJva2U9IiM3MzczNzMiIHN0cm9rZS13aWR0aD0iMiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIi8+CjxwYXRoIGQ9Ik0xMS4yNSAxMS4yNUgxMlYxNi41SDEyLjc1IiBmaWxsPSIjNjE2MDYzIi8+CjxwYXRoIGQ9Ik0xMS4yNSAxMS4yNUgxMlYxNi41SDEyLjc1IiBzdHJva2U9IiM3MzczNzMiIHN0cm9rZS13aWR0aD0iMiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIi8+CjxwYXRoIGQ9Ik0xMS44MTI1IDlDMTIuNDMzOCA5IDEyLjkzNzUgOC40OTYzMiAxMi45Mzc1IDcuODc1QzEyLjkzNzUgNy4yNTM2OCAxMi40MzM4IDYuNzUgMTEuODEyNSA2Ljc1QzExLjE5MTIgNi43NSAxMC42ODc1IDcuMjUzNjggMTAuNjg3NSA3Ljg3NUMxMC42ODc1IDguNDk2MzIgMTEuMTkxMiA5IDExLjgxMjUgOVoiIGZpbGw9IiM3MzczNzMiLz4KPC9nPgo8ZGVmcz4KPGNsaXBQYXRoIGlkPSJjbGlwMF8xOTlfNCI+CjxyZWN0IHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgZmlsbD0id2hpdGUiLz4KPC9jbGlwUGF0aD4KPC9kZWZzPgo8L3N2Zz4K' style=\"top: 6px;\n                    position: absolute;\n                    left: 16px;\n                    width: 24px;\n                    height: 24px;\"/>"+e+' <a style="text-decoration: none;color: #0D6EFD;font-weight: 500;" href='+($e=t&&""!==t?t:"https://www.syncfusion.com/account/claim-license-key?pl=SmF2YVNjcmlwdA==&vs=MjAuNA==")+">Claim your free account</a>"});p.setAttribute("style","position: fixed;\n                top: 10px;\n                left: 10px;\n                right: 10px;\n                font-size: 14px;\n                background: #EEF2FF;\n                color: #222222;\n                z-index: 999999999;\n                text-align: left;\n                border: 1px solid #EEEEEE;\n                padding: 10px 11px 10px 50px;\n                border-radius: 8px;\n                font-family: Helvetica Neue, Helvetica, Arial;"),document.body.appendChild(p),this.isLicensed=!1}this.isValidated=!0,l(st(rt),this.isValidated,d)}return this.isLicensed},e.prototype.getDecryptedData=function(e){try{return atob(e)}catch(e){return""}},e.prototype.getInfoFromKey=function(){try{var e="",t=[5439488,7929856,5111808,6488064,4587520,7667712,5439488,6881280,5177344,7208960,4194304,4456448,6619136,7733248,5242880,7077888,6356992,7602176,4587520,7274496,7471104,7143424],i=[],r=[],n=!1,o=!1;this.manager.getKey()?e=this.manager.getKey():(o=!0,e=this.npxManager.getKey().split("npxKeyReplace")[1]);for(var s=e.split(";"),a=0,l=s;a<l.length;a++){var h=l[a],d=this.getDecryptedData(h);if(d){var c=0,p="";if(o){var u=d[d.length-1],g=[];for(f=0;f<d.length;f++)g[parseInt(f.toString(),10)]=d[parseInt(f.toString(),10)].charCodeAt(0)-u.charCodeAt(0);for(f=0;f<g.length;f++)p+=String.fromCharCode(g[parseInt(f.toString(),10)])}else for(var f=0;f<d.length;f++,c++){c===t.length&&(c=0);var m=d.charCodeAt(f);p+=String.fromCharCode(m^t[parseInt(c.toString(),10)]>>16)}this.platform.test(p)?(i=p.split(";"),n=!1,i.length>3&&r.push({platform:i[0],version:i[1],expiryDate:i[2]})):p&&p.split(";").length>3&&(n=!0)}}return n&&!r.length?[{invalidPlatform:n}]:r.length?r:null}catch(e){return null}},e}(),ot=new nt;function st(e){for(var t="",i=0,r=e;i<r.length;i++){var n=r[i];t+=String.fromCharCode(n)}return t}function at(e){ot=new nt(e)}var lt,ht,dt=function(e){return e&&at(e),ot.validate()},ct=function(){var e='\n    <div style="\n    position: fixed;\n    width: 100%;\n    height: 100%;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n    background-color: rgba(0, 0, 0, 0.5);\n    z-index: 99999;\n    ">\n        <div style="\n    background: #FFFFFF;\n    height: 455px;\n    width: 840px;\n    font-family: Helvetica Neue, Helvetica, Arial;\n    color: #000000;\n    box-shadow: 0px 4.8px 14.4px rgb(0 0 0 / 18%), 0px 25.6px 57.6px rgb(0 0 0 / 22%);\n    display: block;\n    margin: 8% auto;\n    border-radius: 20px;\n    ">\n            <div style="\n    position: absolute;\nwidth: 838px;\nheight: 62px;\nbackground-color: #F9F9F9;\nborder: 1px solid #EEEEEE;\nborder-top-left-radius: 20px;\nborder-top-right-radius: 20px;\n">\n                <img src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTQ2IiBoZWlnaHQ9IjMyIiB2aWV3Qm94PSIwIDAgMTQ2IDMyIiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPgo8cGF0aCBkPSJNNDAuNTk2NSAxNS4wMDc4SDMyLjQyNUMzMS41NTU3IDE1LjAwNzggMzAuOTAzNyAxNS4xODEyIDMwLjUxMjUgMTUuNDg0NkMzMC4xMjEzIDE1LjgzMTQgMjkuOTA0IDE2LjMwODIgMjkuOTA0IDE3LjA0NTFDMjkuOTA0IDE3LjYwODYgMzAuMDc3OCAxOC4wNDIxIDMwLjQyNTYgMTguMzAyMkMzMC43NzMzIDE4LjYwNTYgMzEuMjk0OSAxOC43MzU2IDMxLjk5MDMgMTguNzM1NkgzNi4zMzY5QzM4LjExODkgMTguNzM1NiAzOS40MjI5IDE5LjA4MjQgNDAuMTYxOCAxOS43MzI2QzQwLjk0NDIgMjAuNDI2MiA0MS4yOTE5IDIxLjU1MzIgNDEuMjkxOSAyMy4xMTM3QzQxLjI5MTkgMjQuNzE3NiA0MC44NTcyIDI1Ljg4OCAzOS45ODc5IDI2LjY2ODJDMzkuMTE4NiAyNy40MDUxIDM3LjcyNzcgMjcuNzk1MyAzNS44NTg3IDI3Ljc5NTNIMjcuMDc4N1YyNS4wMjFIMzUuMzM3MkMzNi4yOTM0IDI1LjAyMSAzNi45NDU0IDI0Ljg5MSAzNy4zMzY2IDI0LjYzMDlDMzcuNzI3NyAyNC4zNzA4IDM3LjkwMTYgMjMuODk0IDM3LjkwMTYgMjMuMjg3MUMzNy45MDE2IDIyLjYzNjkgMzcuNzI3NyAyMi4xNjAxIDM3LjM4IDIxLjlDMzcuMDMyMyAyMS42Mzk5IDM2LjQyMzggMjEuNDY2NSAzNS41NTQ1IDIxLjQ2NjVIMzEuNjQyNkMyOS44NjA1IDIxLjQ2NjUgMjguNTEzMSAyMS4xMTk4IDI3LjY4NzMgMjAuMzgyOEMyNi44NjE0IDE5LjY0NTkgMjYuNDI2OCAxOC41MTg5IDI2LjQyNjggMTcuMDAxN0MyNi40MjY4IDE1LjM1NDUgMjYuODYxNCAxNC4xNDA4IDI3LjczMDcgMTMuMzYwNkMyOC42IDEyLjU4MDMgMjkuOTkwOSAxMi4yMzM1IDMxLjkwMzQgMTIuMjMzNUg0MC41OTY1VjE1LjAwNzhaIiBmaWxsPSIjMzU0M0E4Ii8+CjxwYXRoIGQ9Ik00OC4wNzI3IDI1LjI4MTFINTAuNTA2OFYxNi4zOTQ5SDUzLjU0OTNWMjcuNTM1MkM1My41NDkzIDI5LjA1MjQgNTMuMjAxNiAzMC4xNzk0IDUyLjUwNjIgMzAuOTE2M0M1MS44MTA3IDMxLjY1MzIgNTAuNzI0MSAzMiA0OS4yNDYzIDMySDQzLjMzNVYyOS42NTkySDQ4LjcyNDdDNDkuMjg5NyAyOS42NTkyIDQ5Ljc2NzkgMjkuNTI5MiA1MC4wNzIxIDI5LjIyNThDNTAuMzc2NCAyOC45NjU3IDUwLjU1MDIgMjguNTMyMiA1MC41NTAyIDI4LjAxMlYyNy44Mzg2SDQ3Ljg5ODlDNDYuMjAzNyAyNy44Mzg2IDQ0Ljk0MzIgMjcuNDkxOSA0NC4yNDc4IDI2Ljg0MTZDNDMuNTA4OSAyNi4xNDgxIDQzLjE2MTEgMjUuMDY0NCA0My4xNjExIDIzLjQ2MDVWMTYuMzk0OUg0Ni4xNjAyVjIzLjIwMDVDNDYuMTYwMiAyNC4wNjc0IDQ2LjI5MDYgMjQuNjMwOSA0Ni41NTE0IDI0Ljg5MUM0Ni43MjUzIDI1LjE1MTEgNDcuMjQ2OSAyNS4yODExIDQ4LjA3MjcgMjUuMjgxMVoiIGZpbGw9IiMzNTQzQTgiLz4KPHBhdGggZD0iTTU1Ljg5NjUgMTYuMzk0OUg2MS41OTA0QzYzLjMyOTEgMTYuMzk0OSA2NC41NDYxIDE2LjY5ODMgNjUuMjg1IDE3LjM0ODVDNjYuMDIzOSAxNy45OTg4IDY2LjM3MTYgMTkuMDgyNCA2Ni4zNzE2IDIwLjU1NjNWMjcuNzk1M0g2My4zMjkxVjIwLjk0NjRDNjMuMzI5MSAyMC4wNzk0IDYzLjE5ODcgMTkuNTE1OSA2Mi45Mzc5IDE5LjI5OTJDNjIuNjc3MSAxOS4wMzkxIDYyLjE1NTUgMTguOTA5MSA2MS4zMjk3IDE4LjkwOTFINTguODk1NlYyNy44Mzg2SDU1Ljg1M1YxNi4zOTQ5SDU1Ljg5NjVaIiBmaWxsPSIjMzU0M0E4Ii8+CjxwYXRoIGQ9Ik03NC45MzQyIDI1LjM2NzhINzguMTUwNlYyNy43OTUySDc0LjAyMTRDNzIuOTc4MiAyNy43OTUyIDcyLjEwODkgMjcuNjY1MiA3MS40NTcgMjcuNDkxOEM3MC44MDUgMjcuMjc1IDcwLjE5NjUgMjYuOTI4MyA2OS43MTgzIDI2LjQ1MTRDNjkuMTk2OCAyNS45MzEzIDY4Ljc2MjEgMjUuMjgxMSA2OC40NTc4IDI0LjU0NDJDNjguMTUzNiAyMy44MDcyIDY4LjAyMzIgMjIuOTgzNiA2OC4wMjMyIDIyLjE2QzY4LjAyMzIgMjEuMjkzMSA2OC4xNTM2IDIwLjQ2OTUgNjguNDU3OCAxOS42ODkyQzY4Ljc2MjEgMTguOTA5IDY5LjE1MzMgMTguMzAyMSA2OS43MTgzIDE3Ljc4MTlDNzAuMjM5OSAxNy4zMDUxIDcwLjgwNSAxNi45NTgzIDcxLjUwMDQgMTYuNzQxNkM3Mi4xOTU5IDE2LjUyNDkgNzMuMDIxNyAxNi40MzgyIDc0LjA2NDkgMTYuNDM4Mkg3OC4xOTQxVjE4LjkwOUg3NC45MzQyQzczLjQ5OTggMTguOTA5IDcyLjU0MzYgMTkuMTY5MSA3MS45Nzg1IDE5LjY0NTlDNzEuNDU2OSAyMC4xMjI3IDcxLjE1MjcgMjAuOTg5NyA3MS4xNTI3IDIyLjIwMzRDNzEuMTUyNyAyMi44OTY5IDcxLjI4MzEgMjMuNDYwNSA3MS41MDA0IDIzLjkzNzNDNzEuNzE3NyAyNC40MTQxIDcyLjA2NTUgMjQuNzYwOSA3Mi41MDAxIDI1LjA2NDNDNzIuNzE3NCAyNS4xOTQ0IDcyLjk3ODIgMjUuMjgxMSA3My4yODI1IDI1LjM2NzhDNzMuNjMwMiAyNS4zMjQ0IDc0LjE1MTggMjUuMzY3OCA3NC45MzQyIDI1LjM2NzhaIiBmaWxsPSIjMzU0M0E4Ii8+CjxwYXRoIGQ9Ik04MC44NDU2IDE4LjY0ODlINzguNjcyNFYxNi4zNTE1SDgwLjg0NTZWMTUuMTgxMUM4MC44NDU2IDE0LjAxMDggODEuMDYzIDEzLjIzMDUgODEuNDk3NiAxMi44NDA0QzgxLjkzMjMgMTIuNDUwMyA4Mi43NTgxIDEyLjIzMzUgODMuOTc1MSAxMi4yMzM1SDg2Ljg0MzhWMTQuNDAwOUg4NS40MDk1Qzg0Ljg4NzkgMTQuNDAwOSA4NC41NDAyIDE0LjQ4NzYgODQuMzIyOSAxNC42NjFDODQuMTA1NSAxNC44MzQ0IDgzLjk3NTEgMTUuMDk0NSA4My45NzUxIDE1LjQ0MTJWMTYuMzUxNUg4Ni44NDM4VjE4LjY0ODlIODMuOTc1MVYyNy43OTUzSDgwLjg0NTZWMTguNjQ4OVoiIGZpbGw9IiMzNTQzQTgiLz4KPHBhdGggZD0iTTk4LjQwNTYgMjcuNzk1M0g5Mi43MTE2QzkxLjAxNjUgMjcuNzk1MyA4OS44NDI5IDI3LjQ0ODUgODkuMDYwNSAyNi43OTgzQzg4LjMyMTYgMjYuMTQ4MSA4Ny45MzA0IDI1LjA2NDQgODcuOTMwNCAyMy41OTA2VjE2LjM5NDlIOTAuOTI5NVYyMy40MTcyQzkwLjkyOTUgMjQuMTk3NCA5MS4wNTk5IDI0LjY3NDMgOTEuMzIwNyAyNC45MzQ0QzkxLjU4MTUgMjUuMTk0NCA5Mi4xMDMxIDI1LjMyNDUgOTIuOTI4OSAyNS4zMjQ1SDk1LjM2M1YxNi4zOTQ5SDk4LjQwNTZWMjcuNzk1M1oiIGZpbGw9IiMzNTQzQTgiLz4KPHBhdGggZD0iTTEwMC42MjIgMjUuNDExMkgxMDcuMDExQzEwNy41NzcgMjUuNDExMiAxMDguMDExIDI1LjMyNDUgMTA4LjI3MiAyNS4xNTExQzEwOC41MzMgMjQuOTc3NyAxMDguNjYzIDI0LjY3NDMgMTA4LjY2MyAyNC4zMjc1QzEwOC42NjMgMjMuOTM3NCAxMDguNTMzIDIzLjY3NzMgMTA4LjI3MiAyMy40NjA1QzEwOC4wMTEgMjMuMjg3MSAxMDcuNTc3IDIzLjIwMDUgMTA3LjA1NSAyMy4yMDA1SDEwNC40NDdDMTAyLjg4MiAyMy4yMDA1IDEwMS44MzkgMjIuOTgzNyAxMDEuMzE4IDIyLjUwNjlDMTAwLjc1MiAyMi4wMzAxIDEwMC40OTIgMjEuMjA2NSAxMDAuNDkyIDE5Ljk5MjdDMTAwLjQ5MiAxOC43NzkgMTAwLjgzOSAxNy44Njg3IDEwMS40OTEgMTcuMjYxOEMxMDIuMTQzIDE2LjY5ODMgMTAzLjE4NyAxNi4zOTQ5IDEwNC41MzQgMTYuMzk0OUgxMTEuMDU0VjE4Ljc3OUgxMDUuNzA4QzEwNC44MzggMTguNzc5IDEwNC4yNzMgMTguODY1NyAxMDQuMDEyIDE4Ljk5NTdDMTAzLjc1MiAxOS4xNjkxIDEwMy42MjEgMTkuNDI5MiAxMDMuNjIxIDE5LjgxOTRDMTAzLjYyMSAyMC4xNjYxIDEwMy43NTIgMjAuNDI2MiAxMDMuOTY5IDIwLjU5OTZDMTA0LjE4NiAyMC43NzMgMTA0LjU3NyAyMC44NTk3IDEwNS4wNTYgMjAuODU5N0gxMDcuNzk0QzEwOS4wNTQgMjAuODU5NyAxMTAuMDExIDIxLjE2MzEgMTEwLjY2MyAyMS43MjY2QzExMS4zMTUgMjIuMjkwMiAxMTEuNjYyIDIzLjE1NzEgMTExLjY2MiAyNC4yNDA4QzExMS42NjIgMjUuMjgxMSAxMTEuMzU4IDI2LjE0ODEgMTEwLjc5MyAyNi43OTgzQzExMC4yMjggMjcuNDQ4NSAxMDkuNDQ2IDI3Ljc5NTMgMTA4LjUzMyAyNy43OTUzSDEwMC43MDlWMjUuNDExMkgxMDAuNjIyWiIgZmlsbD0iIzM1NDNBOCIvPgo8cGF0aCBkPSJNMTE2LjU3NCAxNS4wOTQ0SDExMy40MDFWMTIuMjc2OUgxMTYuNTc0VjE1LjA5NDRaTTExNi41NzQgMjcuNzk1M0gxMTMuNDAxVjE2LjM5NDlIMTE2LjU3NFYyNy43OTUzWiIgZmlsbD0iIzM1NDNBOCIvPgo8cGF0aCBkPSJNMTMwLjMwOSAyMi4xMTY3QzEzMC4zMDkgMjMuODkzOSAxMjkuNzQ0IDI1LjMyNDQgMTI4LjY1NyAyNi40MDgxQzEyNy41NzEgMjcuNDkxOCAxMjYuMDkzIDI4LjAxMiAxMjQuMjI0IDI4LjAxMkMxMjIuMzU1IDI4LjAxMiAxMjAuODc3IDI3LjQ5MTggMTE5Ljc5IDI2LjQwODFDMTE4LjcwNCAyNS4zMjQ0IDExOC4xMzkgMjMuODkzOSAxMTguMTM5IDIyLjExNjdDMTE4LjEzOSAyMC4zMzk0IDExOC43MDQgMTguOTA5IDExOS43OSAxNy44MjUzQzEyMC44NzcgMTYuNzQxNiAxMjIuMzk4IDE2LjIyMTQgMTI0LjIyNCAxNi4yMjE0QzEyNi4wNDkgMTYuMjIxNCAxMjcuNTI3IDE2Ljc0MTYgMTI4LjY1NyAxNy44MjUzQzEyOS43NDQgMTguODY1NiAxMzAuMzA5IDIwLjI5NjEgMTMwLjMwOSAyMi4xMTY3Wk0xMjEuMjY4IDIyLjExNjdDMTIxLjI2OCAyMy4yMDA0IDEyMS41MjkgMjQuMDY3MyAxMjIuMDUxIDI0LjY3NDJDMTIyLjU3MiAyNS4yODExIDEyMy4yNjggMjUuNTg0NSAxMjQuMTggMjUuNTg0NUMxMjUuMDkzIDI1LjU4NDUgMTI1Ljc4OSAyNS4yODExIDEyNi4zMSAyNC42NzQyQzEyNi44MzIgMjQuMDY3MyAxMjcuMDkzIDIzLjIwMDQgMTI3LjA5MyAyMi4xMTY3QzEyNy4wOTMgMjEuMDMzIDEyNi44MzIgMjAuMTY2MSAxMjYuMzEgMTkuNjAyNUMxMjUuNzg5IDE4Ljk5NTcgMTI1LjA5MyAxOC42OTIyIDEyNC4xMzcgMTguNjkyMkMxMjMuMjI0IDE4LjY5MjIgMTIyLjUyOSAxOC45OTU3IDEyMi4wMDcgMTkuNjAyNUMxMjEuNTI5IDIwLjE2NjEgMTIxLjI2OCAyMS4wMzMgMTIxLjI2OCAyMi4xMTY3WiIgZmlsbD0iIzM1NDNBOCIvPgo8cGF0aCBkPSJNMTMxLjc4NyAxNi4zOTQ5SDEzNy40ODFDMTM5LjIxOSAxNi4zOTQ5IDE0MC40MzYgMTYuNjk4MyAxNDEuMTc1IDE3LjM0ODVDMTQxLjkxNCAxNy45OTg4IDE0Mi4yNjIgMTkuMDgyNCAxNDIuMjYyIDIwLjU1NjNWMjcuNzk1M0gxMzkuMjE5VjIwLjk0NjRDMTM5LjIxOSAyMC4wNzk0IDEzOS4wODkgMTkuNTE1OSAxMzguODI4IDE5LjI5OTJDMTM4LjU2NyAxOS4wMzkxIDEzOC4wNDYgMTguOTA5MSAxMzcuMjIgMTguOTA5MUgxMzQuNzg2VjI3LjgzODZIMTMxLjc0M1YxNi4zOTQ5SDEzMS43ODdaIiBmaWxsPSIjMzU0M0E4Ii8+CjxwYXRoIGQ9Ik03LjEyODMxIDMuNzM3NDNIMFYxMC44NDY0SDcuMTI4MzFWMy43Mzc0M1oiIGZpbGw9IiMzNTQzQTgiLz4KPHBhdGggZD0iTTIzLjI1MTMgLTIuMTU3MjVlLTA1TDE4LjU1MTMgNS41MTY4NUwyNC4wODMxIDEwLjIwNDFMMjguNzgzMSA0LjY4NzI1TDIzLjI1MTMgLTIuMTU3MjVlLTA1WiIgZmlsbD0iI0ZGODYwMCIvPgo8cGF0aCBkPSJNMTUuNjA0MSAzLjczNzQzSDguNDc1ODNWMTAuODQ2NEgxNS42MDQxVjMuNzM3NDNaIiBmaWxsPSIjMzU0M0E4Ii8+CjxwYXRoIGQ9Ik03LjEyODMxIDEyLjE5MDJIMFYxOS4yOTkySDcuMTI4MzFWMTIuMTkwMloiIGZpbGw9IiMzNTQzQTgiLz4KPHBhdGggZD0iTTE1LjYwNDEgMTIuMTkwMkg4LjQ3NTgzVjE5LjI5OTJIMTUuNjA0MVYxMi4xOTAyWiIgZmlsbD0iIzM1NDNBOCIvPgo8cGF0aCBkPSJNMjQuMDc5NyAxMi4xOTAySDE2Ljk1MTRWMTkuMjk5MkgyNC4wNzk3VjEyLjE5MDJaIiBmaWxsPSIjRkY4NjAwIi8+CjxwYXRoIGQ9Ik03LjEyODMxIDIwLjY4NjNIMFYyNy43OTUzSDcuMTI4MzFWMjAuNjg2M1oiIGZpbGw9IiMzNTQzQTgiLz4KPHBhdGggZD0iTTE1LjYwNDEgMjAuNjg2M0g4LjQ3NTgzVjI3Ljc5NTNIMTUuNjA0MVYyMC42ODYzWiIgZmlsbD0iIzM1NDNBOCIvPgo8cGF0aCBkPSJNMjQuMTIzMiAyMC42ODYzSDE2Ljk5NDlWMjcuNzk1M0gyNC4xMjMyVjIwLjY4NjNaIiBmaWxsPSIjMzU0M0E4Ii8+CjxwYXRoIGQ9Ik0xNDYgMTUuODMxM0MxNDYgMTYuODcxNyAxNDUuMTc0IDE3LjY5NTMgMTQ0LjEzMSAxNy42OTUzQzE0My4wODggMTcuNjk1MyAxNDIuMjYyIDE2Ljg3MTcgMTQyLjI2MiAxNS44MzEzQzE0Mi4yNjIgMTQuNzkxIDE0My4wODggMTQuMDEwNyAxNDQuMTMxIDE0LjAxMDdDMTQ1LjEzMSAxMy45Njc0IDE0NiAxNC43OTEgMTQ2IDE1LjgzMTNaTTE0Mi45NTcgMTQuNzkxQzE0Mi42OTcgMTUuMDUxMSAxNDIuNTY2IDE1LjQ0MTIgMTQyLjU2NiAxNS44MzEzQzE0Mi41NjYgMTYuNjk4MyAxNDMuMjYyIDE3LjM5MTggMTQ0LjEzMSAxNy4zOTE4QzE0NSAxNy4zOTE4IDE0NS42OTYgMTYuNjk4MyAxNDUuNjk2IDE1LjgzMTNDMTQ1LjY5NiAxNS4wMDc3IDE0NSAxNC4yNzA4IDE0NC4xNzQgMTQuMjcwOEMxNDMuNjUzIDE0LjI3MDggMTQzLjI2MiAxNC40NDQyIDE0Mi45NTcgMTQuNzkxWk0xNDQuODcgMTYuOTE1SDE0NC40NzlMMTQzLjkxNCAxNi4wOTE0VjE2LjkxNUgxNDMuNjA5VjE0Ljc0NzZIMTQzLjk1N0MxNDQuNDM1IDE0Ljc0NzYgMTQ0LjY1MyAxNC45NjQ0IDE0NC42NTMgMTUuMzU0NUMxNDQuNjUzIDE1LjY1NzkgMTQ0LjQ3OSAxNS44NzQ3IDE0NC4xNzQgMTUuOTYxNEwxNDQuODcgMTYuOTE1Wk0xNDQuMDQ0IDE1LjY1NzlDMTQ0LjI2MSAxNS42NTc5IDE0NC4zOTIgMTUuNTI3OSAxNDQuMzkyIDE1LjM1NDVDMTQ0LjM5MiAxNS4xMzc4IDE0NC4yNjEgMTUuMDUxMSAxNDQuMDAxIDE1LjA1MTFIMTQzLjkxNFYxNS42NTc5SDE0NC4wNDRaIiBmaWxsPSIjMzU0M0E4Ii8+Cjwvc3ZnPgo=" style="\n    text-align: left;\n    width: 146px;\n    position: absolute;\n    top: 14px;\n    left: 31px;\n">\n            </div>\n            <div style="\n    position: relative;\n    top: 80px;\n    left: 32px;\n    font-size: 20px;\n    text-align: left;\n    font-weight: 700;\n    letter-spacing: 0.02em;\n    font-style: normal;\n    line-height: 125%;\n    ">Claim your FREE account and get a key in less than a minute</div>\n            <ul style="\n        font-size: 15px;\n        font-weight: 400;\n        color: #333333;\n        letter-spacing: 0.01em;\n        position: relative;\n        left: 32px;\n        top: 88px;\n        line-height: 180%;\n        ">\n                <li><span>Access to a 30-day free trial of any of our products.</span></li>\n                <li><span>Access to 24x5 support by developers via the <a href="https://support.syncfusion.com/create" style="text-decoration: none;\n                color: #0D6EFD;\n                font-weight: 500;">support tickets</a>, <a href="https://www.syncfusion.com/forums" style="text-decoration: none;\n                color: #0D6EFD;\n                font-weight: 500;">forum</a>, <a href="https://www.syncfusion.com/feedback" style="text-decoration: none;\n                color: #0D6EFD;\n                font-weight: 500;">feature &amp; feedback page</a> and chat.</span></li>\n                <li><span>200+ <a href="https://www.syncfusion.com/succinctly-free-ebooks" style="text-decoration: none;\n                color: #0D6EFD;\n                font-weight: 500;">ebooks </a>on the latest technologies, industry trends, and research topics.</span>\n                </li>\n                <li><span>Largest collection of over 7,000 flat and wireframe icons for free with Syncfusion <a href="https://www.syncfusion.com/succinctly-free-ebooks" style="text-decoration: none;\n                color: #0D6EFD;\n                font-weight: 500;">Metro Studio.</a></span></li>\n                <li><span>Free and unlimited access to Syncfusion technical <a href="https://www.syncfusion.com/blogs/" style="text-decoration: none;\n                color: #0D6EFD;\n                font-weight: 500;">blogs</a> and <a href="https://www.syncfusion.com/resources/techportal/whitepapers" style="text-decoration: none;\n                color: #0D6EFD;\n                font-weight: 500;">whitepapers.</a></span></li>\n            </ul>\n            <div style="\n            font-size: 18px;\n            font-weight: 700;\n            position: relative;\n            line-height: 125%;\n            letter-spacing: 0.02em;\n            top: 90px;\n            left: 32px;\n    ">Syncfusion is trusted by 29,000+ businesses worldwide</div>\n            <img src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iODIwIiBoZWlnaHQ9IjU2IiB2aWV3Qm94PSIwIDAgODIwIDU2IiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPg0KPHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik00MjcuNjE3IDIyLjU2NTlWMjQuNzIyNkM0MjYuNTU4IDI0LjM2MzggNDI1LjM5OCAyNC4xNTQ0IDQyNC40NzQgMjQuMTU0NEM0MjMuMzMzIDI0LjE1NDQgNDIyLjY5OCAyNC40OTEyIDQyMi42OTggMjUuMDk2M0M0MjIuNjk4IDI1LjQ4MjQgNDIyLjk3NiAyNS43MzgzIDQyMy43NzMgMjYuMDg1NEw0MjUuOTE3IDI3LjAxNzRDNDI3LjYzMyAyNy43NjM5IDQyOC40OTcgMjguODUzIDQyOC40OTcgMzAuMjY4MUM0MjguNDk3IDMyLjQ1MjIgNDI2LjU0NiAzMy44MyA0MjMuNDUyIDMzLjgzQzQyMi4zMjQgMzMuODMgNDIxLjAxOCAzMy42NzM2IDQxOS42MzYgMzMuMzcwOVYzMS4xNDE2QzQyMS4wMDYgMzEuNTAyOCA0MjIuMjYyIDMxLjY5NTcgNDIzLjIzOSAzMS42OTU3QzQyNC41MTggMzEuNjk1NyA0MjUuMjAzIDMxLjM1MDYgNDI1LjIwMyAzMC43MDc0QzQyNS4yMDMgMzAuMzIwOCA0MjQuOTM1IDMwLjAzNjcgNDI0LjMyMiAyOS43NzE3TDQyMS45NzUgMjguNzU5M0M0MjAuMjM2IDI4LjAwNzggNDE5LjQzMyAyNi45OTU0IDQxOS40MzMgMjUuNTUyMUM0MTkuNDMzIDIzLjQ4MzcgNDIxLjMxNCAyMi4xNjQ5IDQyNC4yNjUgMjIuMTY0OUM0MjUuMjk4IDIyLjE2NDkgNDI2LjU3IDIyLjMxNzEgNDI3LjYxNyAyMi41NjU5VjIyLjU2NTlaTTQzMC4xNjcgMjIuMzkwOUg0MzMuNjM1VjMzLjYwMzlINDMwLjE2N1YyMi4zOTA5Wk00NDQuOTExIDIyLjM5MDlWMjQuNDQ1MUg0MzkuNjc1VjI2Ljk3NDJINDQ0LjI0OVYyOC44MzIzSDQzOS42NzVWMzEuNDU0M0g0NDQuOTc4VjMzLjYwMzlINDM2LjMwNVYyMi4zOTA5SDQ0NC45MTFaTTQ2MS4yOTQgMjIuMzkwOVYzMy42MDM5SDQ1Ny45MzlWMjYuMjIzNkw0NTQuNjUyIDMzLjY5MTVINDUyLjUzMUw0NDkuMjY2IDI2LjIyMzZWMzMuNjAzOUg0NDYuOTQ5VjIyLjM5MDlINDUxLjE4NEw0NTQuMTc4IDI5LjIxMTRMNDU3LjE1NiAyMi4zOTA5SDQ2MS4yOTRWMjIuMzkwOVpNNDcyLjU3OSAyMi4zOTA5VjI0LjQ0NTFINDY3LjMzNVYyNi45NzQySDQ3MS45MDhWMjguODMyM0g0NjcuMzM1VjMxLjQ1NDNINDcyLjYzOFYzMy42MDM5SDQ2My45NTdWMjIuMzkwOUg0NzIuNTc5Wk00ODQuNzk0IDIyLjM5MDlWMzMuNjAzOUg0ODEuMDkzTDQ3Ni45MjYgMjYuNDEyM1YzMy42MDM5SDQ3NC42MDhWMjIuMzkwOUg0NzguNDA3TDQ4Mi40ODQgMjkuNDg3NlYyMi4zOTA5SDQ4NC43OTRaTTQ5NC44NTggMjIuNTY1OVYyNC43MjI2QzQ5My44MDcgMjQuMzY2MyA0OTIuNjQgMjQuMTU0NCA0OTEuNzMyIDI0LjE1NDRDNDkwLjU3MyAyNC4xNTQ0IDQ4OS45MzkgMjQuNDg1OCA0ODkuOTM5IDI1LjA5M0M0ODkuOTM5IDI1LjQ4ODYgNDkwLjE5OCAyNS43MjUgNDkxLjAyMyAyNi4wODU5TDQ5My4xNTcgMjcuMDE3OEM0OTQuODg1IDI3Ljc3MjIgNDk1LjczOSAyOC44NTE4IDQ5NS43MzkgMzAuMjgzNUM0OTUuNzM5IDMyLjQ1NTkgNDkzLjc4NiAzMy44MzA4IDQ5MC42OTkgMzMuODMwOEM0ODkuNTY5IDMzLjgzMDggNDg4LjI1OSAzMy42NzM2IDQ4Ni44NzggMzMuMzcxN1YzMS4xNDI0QzQ4OC4yNDcgMzEuNTAyOCA0ODkuNDk5IDMxLjY5NjUgNDkwLjQ3IDMxLjY5NjVDNDkxLjc0IDMxLjY5NjUgNDkyLjQ0NCAzMS4zNTE1IDQ5Mi40NDQgMzAuNzI4NUM0OTIuNDQ0IDMwLjMxNjMgNDkyLjE5NyAzMC4wNTA0IDQ5MS41NTUgMjkuNzcyNUw0ODkuMjE4IDI4Ljc2MDFDNDg3LjQ2NyAyOC4wMDI4IDQ4Ni42NzQgMjcuMDAyIDQ4Ni42NzQgMjUuNTUzM0M0ODYuNjc0IDIzLjQ4NjIgNDg4LjU1NiAyMi4xNjY1IDQ5MS41IDIyLjE2NjVDNDkyLjUzNiAyMi4xNjUzIDQ5My44MTMgMjIuMzE3MSA0OTQuODU4IDIyLjU2NTlWMjIuNTY1OVoiIGZpbGw9IiMwMEEwQjAiLz4NCjxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNMzUyLjQxMyAyNi44MTlDMzUwLjk5MiAyNS4yNzU5IDM0OS42MzggMjMuODMxNSAzNDguMzQ5IDIyLjE1NzRMMzQ3LjkyIDIxLjU5OTVDMzQ5LjQwNiAyMS4zNjkzIDM1MC42OTUgMjAuMzg0OCAzNTAuNjk1IDE4Ljc0MzNDMzUwLjY5NSAxNy4yMzMxIDM0OS41MzkgMTYuMjQ4MiAzNDcuODIxIDE2LjI0ODJDMzQ2LjU5OCAxNi4yNDgyIDM0NS43MDYgMTYuMzEzNyAzNDUuMjQzIDE2LjMxMzdDMzQ0LjcxNSAxNi4zMTM3IDM0NC4yODUgMTYuMzEzNyAzNDMuNzkgMTYuMjgwOEMzNDMuODU2IDE4LjE1MjEgMzQzLjg4OSAxOC4yODM0IDM0My44ODkgMTkuNDMyMlYyMy42MzQzQzM0My44ODkgMjQuNDU1MyAzNDMuODU2IDI1LjI3NTkgMzQzLjc5IDI2LjgxODZDMzQ0LjE1MyAyNi43MjAyIDM0NC41MTcgMjYuNzIwMiAzNDQuNzgxIDI2LjcyMDJDMzQ1LjA0NSAyNi43MjAyIDM0NS40MDkgMjYuNzUzMSAzNDUuNzA2IDI2LjgxODZDMzQ1LjY0IDI1Ljc2NzkgMzQ1LjYwNyAyNC4wMjgzIDM0NS42MDcgMjMuNjM0M1YyMS4yMDUxQzM0Ny4xNiAyMy4yMDc3IDM0OS4yMDkgMjUuNjY5NSAzNTAuMDAxIDI2LjgxODZDMzUwLjM5OCAyNi43MjAyIDM1MC43MjggMjYuNzIwMiAzNTEuMTI0IDI2LjcyMDJDMzUxLjQ1NSAyNi43MjA2IDM1MS45MTggMjYuNzIwNiAzNTIuNDEzIDI2LjgxOVYyNi44MTlaTTM0OC44NzggMTkuMDA2QzM0OC44NzggMjAuMDIzNCAzNDguMzE3IDIxLjIwNTQgMzQ2Ljc5NyAyMS4yMDU0QzM0Ni40IDIxLjIwNTQgMzQ2LjAwMyAyMS4yMDU0IDM0NS42MDcgMjEuMTcyNVYxNy4wNjg4QzM0Ni4wMDMgMTYuOTcwNCAzNDYuNDk5IDE2LjkwNDYgMzQ2Ljc2MyAxNi45MDQ2QzM0OC4wODUgMTYuOTA0OSAzNDguODc4IDE3LjY2IDM0OC44NzggMTkuMDA2VjE5LjAwNlpNMzgyLjM4IDI2Ljg4NDVDMzgxLjgxOSAyNi4yOTM2IDM4MC45NiAyNS4zNDE3IDM4MC4xMzQgMjQuNDIyM0MzODAuODI4IDIzLjY2NzIgMzgxLjU1NSAyMi41NTEgMzgxLjk4NCAyMS41OTkxQzM4MS43MTkgMjEuNDY3OCAzODEuMzU2IDIxLjIwNTEgMzgxLjA5MiAyMC45NzUzQzM4MC45OTMgMjEuNzk1OSAzODAuNDMyIDIyLjg3OTIgMzc5LjYzOSAyMy44MzE1QzM3OC41MTUgMjIuNTE4NSAzNzguMjE4IDIyLjE1NzQgMzc3LjE5MyAyMC43Nzg1QzM3OC41ODEgMTkuODkyMSAzNzkuMjQyIDE4Ljg3NDMgMzc5LjI0MiAxOC4wNTM3QzM3OS4yNDIgMTcuMTAxNyAzNzguNTgxIDE2LjExNjkgMzc2Ljk2MiAxNi4xMTY5QzM3NS4yMTEgMTYuMTE2OSAzNzQuMzUyIDE3LjIwMDIgMzc0LjM1MiAxOC40ODAzQzM3NC4zNTIgMTkuMjM1NCAzNzQuNTUgMTkuODkxNyAzNzUuMzc2IDIwLjk3NTNDMzc0LjA1NCAyMS42OTc1IDM3Mi43NjYgMjIuNzQ3OSAzNzIuNzY2IDI0LjQyMjNDMzcyLjc2NiAyNi4wNjM5IDM3NC4wODcgMjYuOTE3NCAzNzUuNzA3IDI2LjkxNzRDMzc3LjE5MyAyNi45MTc0IDM3OC4xNTEgMjYuMzI2NiAzNzguOTEyIDI1LjYzNjlMMzc5LjkwMiAyNi44MTlDMzgwLjIgMjYuNzg2MSAzODAuNTMxIDI2LjcyMDYgMzgwLjg2MSAyNi43MjA2QzM4MS4zMjQgMjYuNzIwNiAzODEuODUyIDI2Ljc4NjEgMzgyLjM4IDI2Ljg4NDVWMjYuODg0NVpNMzgzLjM3MiA0MC4wMTU4QzM4MS45MTggMzguNDczIDM4MC41OTcgMzcuMDYxMiAzNzkuMzA4IDM1LjM4NzFMMzc4Ljg3OCAzNC44Mjg4QzM4MC4zMzIgMzQuNTk5MSAzODEuNjU0IDMzLjYxNSAzODEuNjU0IDMxLjk0MDFDMzgxLjY1NCAzMC40NjMyIDM4MC40OTggMjkuNDQ1NCAzNzguNzc5IDI5LjQ0NTRDMzc3LjU1NyAyOS40NDU0IDM3Ni42MzIgMjkuNTQzNSAzNzYuMTY5IDI5LjU0MzVDMzc1LjY3MyAyOS41NDM1IDM3NS4yNDQgMjkuNTQzNSAzNzQuNzQ4IDI5LjQ3NzZDMzc0LjgxNCAzMS4zODIyIDM3NC44NDggMzEuNDgwMiAzNzQuODQ4IDMyLjYyOTRWMzYuODMxMUMzNzQuODQ4IDM3LjY1MjQgMzc0LjgxNCAzOC41MDUyIDM3NC43NDggNDAuMDE1NEMzNzUuMTEyIDM5Ljk0OTYgMzc1LjQ3NSAzOS45NDk2IDM3NS43MDcgMzkuOTQ5NkMzNzYuMDA0IDM5Ljk0OTYgMzc2LjM2OCAzOS45NDk2IDM3Ni42MzIgNDAuMDE1NEMzNzYuNTY1IDM4Ljk5OCAzNzYuNTMzIDM3LjI1ODEgMzc2LjUzMyAzNi44MzExVjM0LjQzNDhDMzc4LjExOSAzNi40MDQyIDM4MC4xNjcgMzguODk5NiAzODAuOTYgNDAuMDE1NEMzODEuMzU2IDM5Ljk0OTYgMzgxLjY4NyAzOS45NDk2IDM4Mi4wODMgMzkuOTQ5NkMzODIuMzggMzkuOTUgMzgyLjg3NiAzOS45NSAzODMuMzcyIDQwLjAxNThaTTM2Mi4xNiAyNi44MTlDMzYwLjk3MSAyNS41NzE1IDM1OC44ODkgMjIuOTc4IDM1OC4wNjMgMjEuOTkzNUwzNTcuMjM3IDIwLjk3NTdDMzU4LjA5NiAxOS45NTgzIDM1OC42OSAxOS4zMzQxIDM1OS4zMTkgMTguNTc5QzM2MC4wNDUgMTcuNzkxIDM2MC43MDYgMTYuOTcwNCAzNjEuNDk5IDE2LjI0ODJDMzYxLjEzNiAxNi4zMTM3IDM2MC45MzcgMTYuMzEzNyAzNjAuNzM5IDE2LjMxMzdDMzYwLjU0MSAxNi4zMTM3IDM2MC4zNDMgMTYuMzEzNyAzNjAuMTQ0IDE2LjI0ODJDMzU5LjkxMyAxNi42MDkzIDM1OS41NSAxNy4wNjg4IDM1OS4xNTMgMTcuNTI4N0MzNTguNzU2IDE3Ljk1NTYgMzU4LjM2IDE4LjM4MjIgMzU4LjA2MyAxOC43NDMzQzM1Ny4yMzYgMTkuNjk1MiAzNTYuNzc0IDIwLjE1NDcgMzU1LjU4NSAyMS4yNzA5VjE5LjQ2NTVDMzU1LjU4NSAxOC40MTUxIDM1NS41ODUgMTcuNzI1NSAzNTUuNjUxIDE2LjI0ODJDMzU1LjMyMSAxNi4zMTM3IDM1NC45NTcgMTYuMzEzNyAzNTQuNzI2IDE2LjMxMzdDMzU0LjQ2MSAxNi4zMTM3IDM1NC4wMzIgMTYuMzEzNyAzNTMuNzY4IDE2LjI0ODJDMzUzLjgzMyAxNy44MjM5IDM1My44NjcgMTguMjgzNCAzNTMuODY3IDE5LjQzMjVWMjMuNjM0N0MzNTMuODY3IDI0LjY4NSAzNTMuODMzIDI1LjMwODggMzUzLjc2OCAyNi44MTlDMzU0LjE2NCAyNi43MjA2IDM1NC40OTUgMjYuNzIwNiAzNTQuNzI2IDI2LjcyMDZDMzU0Ljk1NyAyNi43MjA2IDM1NS4zNTMgMjYuNzUzNSAzNTUuNjUxIDI2LjgxOUMzNTUuNTg1IDI1LjE0NDkgMzU1LjU4NSAyNC4xNTk3IDM1NS41ODUgMjMuNjM0N1YyMS40MzUyQzM1Ni44MDcgMjIuODc5NiAzNTguNjkgMjUuMjQzMyAzNTkuNzQ4IDI2LjgxOUMzNjAuMTMgMjYuNzU2MyAzNjAuNTE3IDI2LjcyMzQgMzYwLjkwNSAyNi43MjA2QzM2MS4yMDIgMjYuNzIwNiAzNjEuNjY1IDI2LjcyMDYgMzYyLjE2IDI2LjgxOVYyNi44MTlaTTM3Mi42MDEgNDAuMDE1OEMzNzIuNTY4IDM5Ljg1MTkgMzcyLjUzNSAzOS43MjA2IDM3Mi41MzUgMzkuNTIzNEMzNzIuNTM1IDM5LjM5MjggMzcyLjU2OCAzOS4yMjgxIDM3Mi42MDEgMzkuMDk2NEMzNzEuMjggMzkuMTI5NyAzNjguOTAxIDM5LjE5NTIgMzY4LjM3MiAzOS4xOTUyVjM0LjY2NDlDMzY5LjY5NCAzNC42NjQ5IDM3MC45ODIgMzQuNjY0OSAzNzIuMjcgMzQuNzk2M0MzNzIuMjM4IDM0LjYzMjQgMzcyLjIwNCAzNC40Njc3IDM3Mi4yMDQgMzQuMzM2NEMzNzIuMjA0IDM0LjIwNTggMzcyLjIwNCAzNC4wNDE5IDM3Mi4yNyAzMy44NDQ3QzM3MS4zNDYgMzMuOTQyOCAzNjkuMTk4IDMzLjk3NiAzNjguMzcyIDMzLjk3NlYzMC4yNjZDMzY5LjgyNiAzMC4yNjYgMzcwLjY4NSAzMC4yNjYgMzcxLjE4IDMwLjI5OTNMMzcyLjUwMiAzMC4zNjUxQzM3Mi40MzYgMzAuMTY3OSAzNzIuNDM2IDMwLjA2OTIgMzcyLjQzNiAyOS45MDUzQzM3Mi40MzYgMjkuNzQxNCAzNzIuNDM2IDI5LjcwODEgMzcyLjUwMiAyOS40NDU4QzM3MS40MTEgMjkuNDc4MyAzNjkuOTI1IDI5LjU0MzggMzY5LjI2NCAyOS41NDM4QzM2OC44MDIgMjkuNTQzOCAzNjcuMzQ4IDI5LjUxMTMgMzY2LjU4NyAyOS40NDU4QzM2Ni42NTQgMzAuMjY2NCAzNjYuNjg2IDMxLjYxMjMgMzY2LjY4NiAzMi41NjQyVjM2Ljg2NTFDMzY2LjY4NiAzNy40ODg1IDM2Ni42MiAzOC43MzU3IDM2Ni41ODcgNDAuMDE2MkMzNjcuNTEzIDM5Ljk1MDMgMzY4LjgwMiAzOS45NTAzIDM2OS4yNjQgMzkuOTUwM0MzNzAuMDI0IDM5Ljk1IDM3MS42NDMgMzkuOTUgMzcyLjYwMSA0MC4wMTU4Wk0zNjQuNjA1IDM5LjEyOTRDMzY0LjQ0IDM4LjgwMDggMzY0LjM0MSAzOC4zMDg4IDM2NC4yNzUgMzguMDQ2MUMzNjIuOTIgMzkuMTYxOSAzNjEuOTk1IDM5LjM5MjQgMzYwLjkzOCAzOS4zOTI0QzM1OC41OTIgMzkuMzkyNCAzNTcuMzM3IDM3LjI5MTMgMzU3LjMzNyAzNC42NjQ5QzM1Ny4zMzcgMzEuNzQzNiAzNTguNzU3IDMwLjAzNjIgMzYxLjE2OSAzMC4wMzYyQzM2Mi40MjUgMzAuMDM2MiAzNjMuNjE0IDMwLjU5NDUgMzY0LjE3NiAzMS4xNTI4QzM2NC4yMDggMzAuODg5OCAzNjQuMzA4IDMwLjM2NDggMzY0LjQ3MyAzMC4wNjg4QzM2My4zMTYgMjkuNTExMyAzNjIuMjU5IDI5LjM0NjYgMzYxLjEwMiAyOS4zNDY2QzM1Ny4yMzcgMjkuMzQ2NiAzNTUuNDUzIDMxLjc0MzYgMzU1LjQ1MyAzNC44Mjg4QzM1NS40NTMgMzguMzA5MSAzNTcuNzk4IDQwLjE0NzEgMzYwLjczOSA0MC4xNDcxQzM2Mi40MjUgNDAuMTQ3MSAzNjMuODEyIDM5LjYyMjIgMzY0LjYwNSAzOS4xMjk0VjM5LjEyOTRaTTM0Mi4zMDMgMjYuODE5QzM0MC41MTkgMjMuNDA0OSAzMzguOCAxOS4xMzczIDMzNy41NzggMTYuMTE2OUgzMzcuMzhDMzM2LjU4NyAxOC4wMjA3IDMzNS4xMzMgMjEuMjcwOSAzMzQuNzM3IDIyLjE4OTlDMzM0LjI3NCAyMy4zMDYxIDMzMy4yNSAyNS41MDU2IDMzMi41ODkgMjYuODE4NkMzMzIuODAzIDI2Ljc1MzggMzMzLjAyNiAyNi43MjA2IDMzMy4yNSAyNi43MjAyQzMzMy40NDggMjYuNzIwMiAzMzMuNjEzIDI2Ljc1MzEgMzMzLjg0NSAyNi44MTg2QzMzNC4xNzUgMjUuOTMyMiAzMzQuNjM4IDI0LjgxNiAzMzUuMTMzIDIzLjYzNDNDMzM1Ljc5NCAyMy42MDE0IDMzNi4zODkgMjMuNTY4OCAzMzYuOTg0IDIzLjU2ODhDMzM3LjYxMiAyMy41Njg4IDMzOC4yNzIgMjMuNjAxNCAzMzguOTMzIDIzLjYzNDNMMzM5LjU5NCAyNS4yMUwzNDAuMjU1IDI2LjgxODZDMzQwLjcxNyAyNi43MjAyIDM0MS4wOCAyNi43MjAyIDM0MS4zMTIgMjYuNzIwMkMzNDEuNjA5IDI2LjcyMDYgMzQxLjg3MyAyNi43MjA2IDM0Mi4zMDMgMjYuODE5VjI2LjgxOVpNMzUzLjYzNiAyOS40NDU0QzM1My40MzggMjkuNTExMyAzNTMuMjczIDI5LjU0MzUgMzUzLjEwNyAyOS41NDM1QzM1Mi45MDkgMjkuNTQzNSAzNTIuNzQ0IDI5LjUxMDkgMzUyLjU0NiAyOS40NDU0QzM1Mi42NDQgMzAuNzU4NCAzNTIuNjc4IDMyLjA3MTQgMzUyLjY3OCAzMy4zNTE5VjM2LjczMzRDMzUyLjE0OSAzNi4yNzM2IDM1MC44NiAzNS4wOTE5IDM0OS4zNzQgMzMuNzEzQzM0Ny44NiAzMi4zMDc0IDM0Ni4zOTQgMzAuODUxMSAzNDQuOTc5IDI5LjM0NjZIMzQ0Ljc0OEMzNDQuNzgxIDMwLjgyNDMgMzQ0LjgxNCAzMi40IDM0NC44MTQgMzMuODExNFYzNS44Nzk5QzM0NC44MTQgMzcuNjUyOCAzNDQuODE0IDM4LjYwNDcgMzQ0LjcxNSA0MC4wMTYyQzM0NC45OCAzOS45NTAzIDM0NS4xMTIgMzkuOTUwMyAzNDUuMzEgMzkuOTUwM0MzNDUuNDQyIDM5Ljk1MDMgMzQ1LjU3NSAzOS45NTAzIDM0NS44MDYgNDAuMDE2MkMzNDUuNzQgMzguNjcwNiAzNDUuNzA3IDM2LjQ3MDggMzQ1LjcwNyAzNS44Nzk5VjMyLjU5NjhDMzQ4LjE4NSAzNC44NjI1IDM1MS4yMjQgMzcuODgyNiAzNTMuNDcxIDQwLjE0NzVIMzUzLjYwM0MzNTMuNjAzIDM4LjkzMjkgMzUzLjUzNyAzNy43MTc5IDM1My41MzcgMzYuNTA0VjM0LjYzMjdDMzUzLjUzNiAzMi40MzI1IDM1My41MzYgMzEuMzQ5MyAzNTMuNjM2IDI5LjQ0NTRaTTM0Mi41NjcgNDAuMDE1OEMzNDIuNTM0IDM5Ljg1MTkgMzQyLjUwMSAzOS43MjA2IDM0Mi41MDEgMzkuNTIzNEMzNDIuNTAxIDM5LjM5MjggMzQyLjUzNCAzOS4yMjgxIDM0Mi41NjcgMzkuMDk2NEMzNDEuMjQ2IDM5LjEyOTcgMzM4Ljg2NyAzOS4xOTUyIDMzOC4zNzEgMzkuMTk1MlYzNC42NjQ5QzMzOS42NiAzNC42NjQ5IDM0MC45NDggMzQuNjY0OSAzNDIuMjM3IDM0Ljc5NjNDMzQyLjIwNCAzNC42MzI0IDM0Mi4xNzEgMzQuNDY3NyAzNDIuMTcxIDM0LjMzNjRDMzQyLjE3MSAzNC4yMDU4IDM0Mi4xNzEgMzQuMDQxOSAzNDIuMjM3IDMzLjg0NDdDMzQxLjMxMiAzMy45NDI4IDMzOS4xOTcgMzMuOTc2IDMzOC4zNzEgMzMuOTc2VjMwLjI2NkMzMzkuNzkyIDMwLjI2NiAzNDAuNjUxIDMwLjI2NiAzNDEuMTc5IDMwLjI5OTNMMzQyLjQ2OCAzMC4zNjUxQzM0Mi40MzUgMzAuMTY3OSAzNDIuNDM1IDMwLjA2OTIgMzQyLjQzNSAyOS45MDUzQzM0Mi40MzUgMjkuNzQxNCAzNDIuNDM1IDI5LjY3NTUgMzQyLjQ2OCAyOS40NDU4QzM0MS4zNzggMjkuNDc4MyAzMzkuODkxIDI5LjU0MzggMzM5LjIzIDI5LjU0MzhDMzM4Ljc2NyAyOS41NDM4IDMzNy4zMTQgMjkuNTExMyAzMzYuNTU0IDI5LjQ0NThDMzM2LjYyIDMwLjI2NjQgMzM2LjY1MyAzMS42MTIzIDMzNi42NTMgMzIuNTY0MlYzNi44NjUxQzMzNi42NTMgMzcuNDg4NSAzMzYuNTg3IDM4LjczNTcgMzM2LjU1NCA0MC4wMTYyQzMzNy41MTIgMzkuOTUwMyAzMzguNzY3IDM5Ljk1MDMgMzM5LjIzIDM5Ljk1MDNDMzM5Ljk5IDM5Ljk1IDM0MS42NDIgMzkuOTUgMzQyLjU2NyA0MC4wMTU4VjQwLjAxNThaTTMzMS4yMDEgMjYuODE5QzMzMC42NzMgMjMuMjQwNiAzMzAuMjEgMTkuNDk4NCAzMjkuODQ3IDE2LjExNjlDMzI5Ljc0OCAxNi4xNDk4IDMyOS43MTQgMTYuMTQ5OCAzMjkuNjQ5IDE2LjExNjlDMzI4Ljk1NSAxNy4zMzE1IDMyOC4xNjIgMTguNjQ0NSAzMjcuNTY3IDE5LjU2MzlDMzI3LjAwNiAyMC40NTAzIDMyNi4zNDUgMjEuNTAwNyAzMjUuNTg1IDIyLjYxNjlDMzIzLjk5OSAyMC41ODE3IDMyMi4zNDcgMTguMDIxMSAzMjEuMjU2IDE2LjExNjlDMzIxLjE5IDE2LjE0OTggMzIxLjE1NyAxNi4xMTY5IDMyMS4wOTEgMTYuMTE2OUMzMjAuNzI4IDE5LjQ5OCAzMjAuMjMyIDIzLjI3MzIgMzE5LjczNiAyNi44MTlDMzIwLjAwMSAyNi43MjA2IDMyMC4xNjYgMjYuNzIwNiAzMjAuMjk4IDI2LjcyMDZDMzIwLjQ5NiAyNi43MjA2IDMyMC42MjggMjYuNzUzNSAzMjAuODU5IDI2LjgxOUMzMjAuOTkyIDI0LjQ1NTMgMzIxLjI1NiAyMi4xMjQ0IDMyMS41NTMgMTkuNjYyM0MzMjIuODQyIDIxLjUzMzYgMzIzLjk2NSAyMy4xNDIyIDMyNS4yMjEgMjQuODQ5M0MzMjYuMjc4IDIzLjIwNzcgMzI3LjM2OCAyMS40MzQ4IDMyOC41NTggMTkuNjI5NEMzMjguODg4IDIyLjE1NyAzMjkuMTg2IDI0LjQ1NTMgMzI5LjM1MSAyNi44MTlDMzI5Ljc4IDI2LjcyMDYgMzMwLjA3OCAyNi43MjA2IDMzMC4yNzYgMjYuNzIwNkMzMzAuNTQgMjYuNzIwNiAzMzAuODA1IDI2LjcyMDYgMzMxLjIwMSAyNi44MTlWMjYuODE5Wk0zMzQuOTY4IDMyLjIwMjhDMzM0Ljk2OCAzMC4yOTg5IDMzMy40NDggMjkuNDQ1NCAzMzEuNTk4IDI5LjQ0NTRDMzMwLjc3MiAyOS40NDU0IDMyOS44OCAyOS41NDM1IDMyOS4yNTIgMjkuNTQzNUMzMjkuMDIxIDI5LjU0MzUgMzI4LjUyNSAyOS41NDM1IDMyNy45OTcgMjkuNDc3NkMzMjguMDMgMzAuNTI4MyAzMjguMDk2IDMxLjQxNDggMzI4LjA5NiAzMi40MzIyVjM2LjkyOTVDMzI4LjA5NiAzNy45MTQ4IDMyOC4wMyAzOC45OTggMzI3Ljk5NyA0MC4wMTU0QzMyOC40MjYgMzkuOTQ5NiAzMjguNzI0IDM5Ljk0OTYgMzI4LjkyMiAzOS45NDk2QzMyOS4xNTMgMzkuOTQ5NiAzMjkuNDg0IDM5Ljk0OTYgMzI5Ljg4IDQwLjAxNTRDMzI5LjgxNSAzOS4wMzE5IDMyOS43ODIgMzguMDQ2NSAzMjkuNzgxIDM3LjA2MDlWMzUuNDJDMzMwLjE0NSAzNS40NTI2IDMzMC41MDggMzUuNDUyNiAzMzAuOTA1IDM1LjQ1MjZDMzMyLjgyIDM1LjQ1MjYgMzM0Ljk2OCAzNC43MzA0IDMzNC45NjggMzIuMjAyOFYzMi4yMDI4Wk0zMjYuMDE0IDM2Ljg5NzNDMzI2LjAxNCAzNS4yNTU4IDMyNC45MjQgMzQuNTMzNiAzMjMuMDQgMzMuNzQ1NkMzMjEuNjg2IDMzLjE4OCAzMjAuOTkyIDMyLjY5NTYgMzIwLjk5MiAzMS42NDQ1QzMyMC45OTIgMzAuNjYgMzIxLjc1MiAzMC4wMzYyIDMyMy4wMDggMzAuMDM2MkMzMjMuODM0IDMwLjAzNjIgMzI0LjU2MSAzMC4zMzE1IDMyNS4yMjIgMzAuODU2OEMzMjUuMjg3IDMwLjQ5NTcgMzI1LjQ1MyAzMC4xMzQ3IDMyNS42NTEgMjkuODM5NEMzMjQuODU4IDI5LjQ3ODMgMzIzLjk5OSAyOS4zNDcgMzIzLjA3NCAyOS4zNDdDMzIwLjM2NSAyOS4zNDcgMzE5LjUwNSAzMC44OTA1IDMxOS41MDUgMzIuMjAzNUMzMTkuNTA1IDMzLjgxMTggMzIwLjI5OSAzNC41NjcyIDMyMi4zNDcgMzUuMzU1M0MzMjMuNjM2IDM1Ljg0NyAzMjQuMjk2IDM2LjQ3MTEgMzI0LjI5NiAzNy41NTQ0QzMyNC4yOTYgMzguNzAzNSAzMjMuNDM3IDM5LjQyNTcgMzIyLjI0OCAzOS40MjU3QzMyMS41NTQgMzkuNDI1NyAzMjAuMzY1IDM5LjA2NDYgMzE5LjUzOSAzOC4zMDk5QzMxOS41MDUgMzguNzM2MSAzMTkuNTA1IDM5LjEzMDQgMzE5LjM3MyAzOS40OTE1QzMxOS45MDIgMzkuNzU0NiAzMjEuMTI1IDQwLjE0NzkgMzIyLjIxNSA0MC4xNDc5QzMyNC45OSA0MC4xNDcxIDMyNi4wMTQgMzguNDM5NyAzMjYuMDE0IDM2Ljg5NzNWMzYuODk3M1pNMzc4LjE1MiAxNy45ODgyQzM3OC4xNTIgMTguOTczIDM3Ny40NTggMTkuNjYyMyAzNzYuNzY0IDIwLjIyMDJDMzc2LjMwMSAxOS41NjM5IDM3NS43NCAxOC42NzcxIDM3NS43NCAxNy45ODgyQzM3NS43NCAxNy4yMzMxIDM3Ni4yNjggMTYuODA2MSAzNzYuOTk1IDE2LjgwNjFDMzc3Ljk4NyAxNi44MDY1IDM3OC4xNTIgMTcuNjkyNiAzNzguMTUyIDE3Ljk4ODJWMTcuOTg4MlpNMzc4LjQ4MiAyNS4wMTMyQzM3OC4xMTkgMjUuMzQxNyAzNzcuMjYgMjUuOTY1NSAzNzYuNTMzIDI1Ljk2NTVDMzc1LjU3NCAyNS45NjU1IDM3NC40MTggMjUuMjc1OSAzNzQuNDE4IDIzLjc5ODZDMzc0LjQxOCAyMi40ODU1IDM3NS4yNzcgMjEuODk0NyAzNzUuODA2IDIxLjU2NjVDMzc3LjAyOCAyMy4yNDA2IDM3Ny4wOTUgMjMuMzM5MSAzNzguNDgyIDI1LjAxMzJaTTM3OS44MDQgMzIuMjAyOEMzNzkuODA0IDMzLjI1MzUgMzc5LjI3NSAzNC40MDI2IDM3Ny43NTUgMzQuNDAyNkMzNzcuMzI2IDM0LjQwMjYgMzc2LjkyOSAzNC40MDI2IDM3Ni41MzMgMzQuMzY5M1YzMC4yNjU2QzM3Ni45MjkgMzAuMTY3NiAzNzcuNDI1IDMwLjEzNDMgMzc3LjcyMiAzMC4xMzQzQzM3OS4wMTEgMzAuMTM0MyAzNzkuODA0IDMwLjg4OTggMzc5LjgwNCAzMi4yMDI4Wk0zMzguNjAyIDIyLjgxNDFDMzM3LjkwOSAyMi44NDY2IDMzNy41NDUgMjIuODQ2NiAzMzcuMDgyIDIyLjg0NjZDMzM2LjUyMSAyMi44NDY2IDMzNi4xOSAyMi44NDY2IDMzNS40NjMgMjIuODE0MUwzMzcuMDgyIDE5LjAwNkwzMzguNjAyIDIyLjgxNDFaTTMzMy4xNTEgMzIuMzAwOEMzMzMuMTUxIDMzLjgxMTEgMzMyLjI1OCAzNC43OTU5IDMzMC44MDUgMzQuNzk1OUMzMzAuNTA3IDM0Ljc5NTkgMzMwLjE3NyAzNC43OTU5IDMyOS43OCAzNC43MzAxVjMwLjIzMjdDMzMwLjI0MyAzMC4xNjY5IDMzMC42MzkgMzAuMTMzOSAzMzEuMDM2IDMwLjEzMzlDMzMyLjQyNCAzMC4xMzQzIDMzMy4xNTEgMzEuMDIxMSAzMzMuMTUxIDMyLjMwMDhaTTM2OS41MjggMjMuNjY3NkMzNjkuNTI4IDIyLjAyNiAzNjguNDM4IDIxLjMwMzkgMzY2LjU1NSAyMC41MTYyQzM2NS4yIDE5Ljk1ODMgMzY0LjUwNiAxOS40OTg4IDM2NC41MDYgMTguNDE1MUMzNjQuNTA2IDE3LjQ2MzIgMzY1LjI2NiAxNi44MDY1IDM2Ni41MjEgMTYuODA2NUMzNjcuMzQ4IDE2LjgwNjUgMzY4LjA3NSAxNy4xMDE3IDM2OC43MzUgMTcuNjI3NUMzNjguODAyIDE3LjI2NjQgMzY4Ljk2NyAxNi45MDQ5IDM2OS4xMzEgMTYuNjQyMkMzNjguMzcyIDE2LjI4MTEgMzY3LjQ3OSAxNi4xMTcyIDM2Ni41ODcgMTYuMTE3MkMzNjMuOTQ0IDE2LjExNzIgMzYyLjk4NiAxNy42NiAzNjIuOTg2IDE5LjAwNkMzNjIuOTg2IDIwLjU4MTcgMzYzLjgxMiAyMS4zMzY4IDM2NS44NjEgMjIuMTI0NEMzNjcuMTQ5IDIyLjYxNjkgMzY3LjgxIDIzLjI0MDYgMzY3LjgxIDI0LjM1NjhDMzY3LjgxIDI1LjQ3MyAzNjYuOTUxIDI2LjE5NTIgMzY1Ljc2MiAyNi4xOTUyQzM2NS4wMzUgMjYuMTk1MiAzNjMuODc5IDI1LjgzNDEgMzYzLjA1MiAyNS4xMTE5QzM2My4wMiAyNS41Mzg5IDM2Mi45ODYgMjUuOSAzNjIuODg3IDI2LjI2MTFDMzYzLjM4MyAyNi41MjM4IDM2NC42MDYgMjYuOTE3NCAzNjUuNzI5IDI2LjkxNzRDMzY4LjUwNCAyNi45MTc0IDM2OS41MjggMjUuMjQzMyAzNjkuNTI4IDIzLjY2NzZWMjMuNjY3NloiIGZpbGw9IiMwMzY1NTUiLz4NCjxwYXRoIGQ9Ik02NDAuNDE2IDIwLjU1NzNDNjM4LjY3MSAxOS44MzU0IDYzNy42MzEgMTkuNTU1MSA2MzYuNTk4IDE5LjU1NTFDNjM1LjUxNCAxOS41NTUxIDYzNC44MTkgMTkuOTE3IDYzNC44MTkgMjAuNDc2NUM2MzQuODE5IDIyLjE2NDUgNjQwLjk2MiAyMS42ODkzIDY0MC45NjIgMjUuNTkzNkM2NDAuOTYyIDI3Ljc0NjQgNjM5LjAyNCAyOC45OTc0IDYzNi4zMzIgMjguOTk3NEM2MzQuMjIgMjguOTk3NCA2MzMuMTggMjguNDg4IDYzMS45ODMgMjcuOTExNlYyNS40OTYyQzYzMy43MSAyNi41NjM1IDYzNC43NjggMjYuOTQwMSA2MzYuMTAxIDI2Ljk0MDFDNjM3LjI1NiAyNi45NDAxIDYzNy44NzkgMjYuNTYzNSA2MzcuODc5IDI1LjkwNjNDNjM3Ljg3OSAyNC4wNjg1IDYzMS43MzcgMjQuNzQxNSA2MzEuNzM3IDIwLjcyMTNDNjMxLjczNyAxOC43ODI3IDYzMy41MzQgMTcuNDk5IDYzNi4zMzIgMTcuNDk5QzYzNy42ODIgMTcuNDk5IDYzOC45MDEgMTcuNzYzNSA2NDAuNDE2IDE4LjM3MDdWMjAuNTU3M1pNNjQ5LjAxNiAyOC40ODQxQzY0Ny45OTIgMjguODMwNiA2NDcuMTI2IDI4Ljk5NTQgNjQ2LjI2MiAyOC45OTU0QzY0My40MDIgMjguOTk1NCA2NDEuNTUyIDI3LjQ0MjIgNjQxLjU1MiAyNS4wNzkyQzY0MS41NTIgMjIuNzU5NCA2NDMuNDczIDIxLjEyMDIgNjQ2LjE1NiAyMS4xMjAyQzY0Ni45ODUgMjEuMTIwMiA2NDguMDQ0IDIxLjMxODIgNjQ4Ljg5MSAyMS42MTIzVjIzLjM4ODFDNjQ4LjIyMSAyMy4wNTYyIDY0Ny40NDQgMjIuODc0MSA2NDYuODA5IDIyLjg3NDFDNjQ1LjI3MyAyMi44NzQxIDY0NC4yODYgMjMuNzM0MyA2NDQuMjg2IDI1LjA2MTlDNjQ0LjI4NiAyNi40MDggNjQ1LjI1NiAyNy4yOTQgNjQ2LjcyIDI3LjI5NEM2NDcuMzM3IDI3LjI5NCA2NDcuODg2IDI3LjE2MjMgNjQ5LjAxNiAyNi43NjhMNjQ5LjAxNiAyOC40ODQxWk02NzEuMzIgMjQuMjA5QzY3MS40MjUgMjMuMTU0OCA2NzIuMDgxIDIyLjU0NTcgNjczLjA4NyAyMi41NDU3QzY3NC4wNzYgMjIuNTQ1NyA2NzQuNzQ2IDIzLjE3MjEgNjc0Ljg1MiAyNC4yMDlINjcxLjMyWk02NzIuOTEgMjEuMTIyOUM2NzAuNCAyMS4xMjI5IDY2OC42MTQgMjIuNzc1NSA2NjguNjE0IDI1LjEwMTJDNjY4LjYxNCAyNy40NDQxIDY3MC40NzEgMjguOTk1NCA2NzMuMzM1IDI4Ljk5NTRDNjczLjk3IDI4Ljk5NTQgNjc1LjUwNCAyOC45OTU0IDY3Ni45NjYgMjcuOTg3VjI2LjUwNDJDNjc1Ljc2OSAyNy4yOTkzIDY3NC45NzcgMjcuNTczMSA2NzMuOTU1IDI3LjU3MzFDNjcyLjM0MSAyNy41NzMxIDY3MS4zNTQgMjYuNzk0OSA2NzEuMjY1IDI1LjQ2NjZINjc3LjExQzY3Ny4yMzIgMjIuNjkzOSA2NzUuMjc5IDIxLjEyMjkgNjcyLjkxIDIxLjEyMjlWMjEuMTIyOVpNNjc4LjA5OSAyOC44NTcySDY4MC42NTRWMjEuMjYyN0g2NzguMDk5VjI4Ljg1NzJaTTY4Ny43NjcgMjYuNzgxNUM2ODcuMjM0IDI3LjIyODEgNjg2Ljc5MiAyNy40MDcyIDY4Ni4yNDYgMjcuNDA3MkM2ODUuMDQzIDI3LjQwNzIgNjg0LjI4MSAyNi40ODM4IDY4NC4yODEgMjUuMTAwNEM2ODQuMjgxIDIzLjU4NDEgNjg1LjA0MyAyMi43MTAxIDY4Ni4zMzEgMjIuNzEwMUM2ODYuNzkyIDIyLjcxMDEgNjg3LjM5NCAyMi45MDggNjg3Ljc2NyAyMy4xNTU5VjI2Ljc4MTVaTTY4Ny43NjcgMTcuNjM5MVYyMS41OTU4QzY4Ny4wNzYgMjEuMjg0NyA2ODYuMzg4IDIxLjEyMDIgNjg1LjY0NCAyMS4xMjAyQzY4My4zMTMgMjEuMTIwMiA2ODEuNyAyMi43MjY2IDY4MS43IDI1LjA1MDdDNjgxLjcgMjcuMzI0OCA2ODMuMzEzIDI4Ljk5NzQgNjg1LjUgMjguOTk3NEM2ODYuMzY3IDI4Ljk5NzQgNjg3LjAzNyAyOC43ODU2IDY4Ny43NjcgMjguMjQzNVYyOC44NTQ5SDY5MC4zMjJWMTcuNjM5MUg2ODcuNzY3Wk02OTQuMTA1IDI0LjIwOUM2OTQuMjExIDIzLjE1NDggNjk0Ljg2NCAyMi41NDU3IDY5NS44NjggMjIuNTQ1N0M2OTYuODU4IDIyLjU0NTcgNjk3LjUzNSAyMy4xNzIxIDY5Ny42NDEgMjQuMjA5SDY5NC4xMDVaTTY5NS42OTQgMjEuMTIyOUM2OTMuMTg0IDIxLjEyMjkgNjkxLjQgMjIuNzc1NSA2OTEuNCAyNS4xMDEyQzY5MS40IDI3LjQ0NDEgNjkzLjI1OSAyOC45OTU0IDY5Ni4xMTkgMjguOTk1NEM2OTYuNzUzIDI4Ljk5NTQgNjk4LjI5IDI4Ljk5NTQgNjk5Ljc1NSAyNy45ODdWMjYuNTA0MkM2OTguNTU3IDI3LjI5OTMgNjk3Ljc2MyAyNy41NzMxIDY5Ni43MzYgMjcuNTczMUM2OTUuMTMxIDI3LjU3MzEgNjk0LjE0IDI2Ljc5NDkgNjk0LjA1MSAyNS40NjY2SDY5OS44OTRDNzAwLjAxNSAyMi42OTM5IDY5OC4wNjEgMjEuMTIyOSA2OTUuNjk0IDIxLjEyMjkiIGZpbGw9IiMwMDlFNEQiLz4NCjxwYXRoIGQ9Ik03MDMuNzIxIDIzLjQzNjhINzAzLjc1OEM3MDQuNTE3IDIxLjg1NjIgNzA1LjM2NiAyMS4xMTUgNzA2LjM1MiAyMS4xMTVDNzA2Ljg2MiAyMS4xMTUgNzA3LjMwMyAyMS4yOTY0IDcwOC4wNDQgMjEuODA3Nkw3MDcuMzQxIDIzLjkxMzNDNzA2LjY3IDIzLjUxODYgNzA2LjIyOSAyMy4zNTM1IDcwNS44MjMgMjMuMzUzNUM3MDQuODg2IDIzLjM1MzUgNzA0LjI4NiAyNC4xNzc1IDcwMy43MjEgMjUuNTcwNFYyOC44NDY2SDcwMS4xNjJWMjEuMjU0MUg3MDMuNzIxVjIzLjQzNjhaTTY4MC43NzUgMTguMDY3NEM2ODEuMDE1IDE4LjY1NzUgNjgwLjU4MyAxOS40ODA1IDY3OS44MTQgMTkuOTA0QzY3OS4wNDEgMjAuMzI3MSA2NzguMjI0IDIwLjE5MjggNjc3Ljk4NiAxOS42MDI3QzY3Ny43NDMgMTkuMDExNyA2NzguMTczIDE4LjE4NzcgNjc4Ljk0NSAxNy43NjY2QzY3OS43MTYgMTcuMzQxMSA2ODAuNTMzIDE3LjQ3NTkgNjgwLjc3NSAxOC4wNjc0WiIgZmlsbD0iIzAwOUU0RCIvPg0KPHBhdGggZD0iTTY1OC4yMiAyNC4wMjMxQzY1OC4yMiAyMS45NjUxIDY1Ni43MTkgMjEuMTIyNiA2NTUuMjM5IDIxLjEyMjZDNjU0LjIzMiAyMS4xMjI2IDY1My40MDQgMjEuNTE4NCA2NTIuNjY0IDIyLjM5MjFINjUyLjYyOVYxNy42MzkySDY1MC4wNzFWMjguODM1M0g2NTIuNjI5VjI0LjAyMzFDNjUzLjIyOCAyMy4yMTYxIDY1My43MzggMjIuODcxMSA2NTQuMzM4IDIyLjg3MTFDNjU1LjEzNCAyMi44NzExIDY1NS42NjIgMjMuMzk4NiA2NTUuNjYyIDI0LjUzMjlWMjcuMjAwOEM2NTYuNTIgMjYuNzg5NiA2NTcuMzkzIDI2LjUzNzQgNjU4LjIyIDI2LjQ0MzhWMjQuMDIzMVpNNjY0LjYzNiAyMS4xMTk5QzY2My41OTQgMjEuMTE5OSA2NjIuNzk5IDIxLjQ4MTEgNjYxLjk4NCAyMi4zNDkzVjIxLjI2MjRINjU5LjQyOFYyNi40MjM0QzY2MC4zMTMgMjYuNTA1OCA2NjEuNDQzIDI2Ljg4NDcgNjYxLjk4NCAyNy41MTA0VjIzLjk2MzRDNjYyLjY1NyAyMy4wMjMyIDY2My4xMzQgMjIuNzA5NyA2NjMuNzcgMjIuNzA5N0M2NjQuNDk0IDIyLjcwOTcgNjY1LjA0NSAyMy4xNTU2IDY2NS4wNDUgMjQuMjI2NFYyOC44MzcySDY2Ny42MDJWMjQuMDI4OUM2NjcuNjAyIDIxLjc5MjYgNjY1LjkwOCAyMS4xMTk5IDY2NC42MzYgMjEuMTE5OVYyMS4xMTk5Wk02NjkuMDE1IDMxLjAxODFINjY2LjA0M1YzMi45ODY0SDY2OC45MDlWMzMuODMxMkg2NjYuMDQzVjM1Ljg2MTlINjY5LjEwM1YzNi43MDU1SDY2NS4wNDZWMzAuMTc1Mkg2NjkuMDE1TDY2OS4wMTUgMzEuMDE4MVpNNjcxLjQ0MiAzNi43MDkzSDY3Mi4zNTJWMzAuMTczM0g2NzEuNDQyVjM2LjcwOTNaTTY3Ni44NTkgMzMuMDQ4NEM2NzcuNTA0IDMzLjA0ODQgNjc3LjkwNCAzMy40NjMxIDY3Ny45MzUgMzQuMTE0Mkg2NzUuNjE2QzY3NS43NDIgMzMuNDM0MiA2NzYuMTYxIDMzLjA0ODQgNjc2Ljg1OSAzMy4wNDg0Wk02NzUuNiAzNC42ODFINjc4Ljg0MkM2NzguODQyIDMzLjA4NjkgNjc4LjA2MiAzMi4zMTggNjc2LjgzOCAzMi4zMThDNjc1LjU2OSAzMi4zMTggNjc0LjY4OCAzMy4xOTI0IDY3NC42ODggMzQuNDk2OUM2NzQuNjg4IDM1LjY4OSA2NzUuNDg0IDM2Ljc4OTggNjc2LjkxNyAzNi43ODk4QzY3Ny42OTggMzYuNzg5OCA2NzguMjAzIDM2LjYyODEgNjc4Ljc2MyAzNi4yODJWMzUuNDU2QzY3OC4yMjIgMzUuNzg1NiA2NzcuNjk4IDM1Ljk3NTggNjc3LjE0NyAzNS45NzU4QzY3Ni4yNjUgMzUuOTc1OCA2NzUuNzQyIDM1LjUzNSA2NzUuNiAzNC42ODA2VjM0LjY4MVpNNjg0Ljc4NiAzMy41MzA5QzY4NC4yNjMgMzMuMTk2NiA2ODMuOTE0IDMzLjA5ODUgNjgzLjUxNSAzMy4wOTg1QzY4Mi42ODIgMzMuMDk4NSA2ODIuMTA1IDMzLjY5NDUgNjgyLjEwNSAzNC41NjdDNjgyLjEwNSAzNS40NTYgNjgyLjcxOSAzNS45OTE2IDY4My42NjggMzUuOTkxNkM2ODQuMDU4IDM1Ljk5MTYgNjg0LjQzIDM1Ljg5NzMgNjg0Ljg4OCAzNS43MDU5VjM2LjU0MjZDNjg0LjU4MiAzNi42Nzc0IDY4My45OTcgMzYuNzg5OCA2ODMuNTE1IDM2Ljc4OThDNjgyLjEzNiAzNi43ODk4IDY4MS4xOCAzNS45MDYyIDY4MS4xOCAzNC42NDMyQzY4MS4xOCAzMy4yMTc4IDY4Mi4wNTQgMzIuMzE4IDY4My40NTMgMzIuMzE4QzY4My45ODcgMzIuMzE4IDY4NC4zNDYgMzIuNDMzOSA2ODQuNzg3IDMyLjYxNDVMNjg0Ljc4NiAzMy41MzA5Wk02ODguOTM0IDMyLjQwMDRINjkwLjM5NVYzMy4xNjUxSDY4OC45MzRWMzUuMzc1MkM2ODguOTM0IDM1Ljg4MTEgNjg5LjMyNyAzNi4wMjc0IDY4OS41OTMgMzYuMDI3NEM2ODkuOTIyIDM2LjAyNzQgNjkwLjI2MiAzNS45MiA2OTAuNjMgMzUuNzA3OVYzNi41MDM3QzY5MC4zMSAzNi42Njc4IDY4OS44MiAzNi43ODk4IDY4OS41MTkgMzYuNzg5OEM2ODguNTI4IDM2Ljc4OTggNjg4LjAyNyAzNi4yMTYxIDY4OC4wMjcgMzUuNDM5MVYzMy4xNjUxSDY4Ny4yMjRWMzMuMDcwM0w2ODguOTM0IDMxLjUxMDJWMzIuNDAwNFpNNjkzLjg3NiAzMi40MDA0VjMzLjM5NjlINjkzLjg5NUM2OTQuMzU5IDMyLjYzNDUgNjk0LjggMzIuMzE4IDY5NS4yMyAzMi4zMThDNjk1LjYwMSAzMi4zMTggNjk1Ljk0NyAzMi40ODAxIDY5Ni4zMjkgMzIuODE2Nkw2OTUuODQ3IDMzLjU2NDRDNjk1LjU3IDMzLjMwOTEgNjk1LjIxMSAzMy4xMzMxIDY5NC45OTUgMzMuMTMzMUM2OTQuMzY4IDMzLjEzMzEgNjkzLjg3NiAzMy43MjY4IDY5My44NzYgMzQuNDYyNlYzNi43MDkzSDY5Mi45NjdWMzIuNDAwNEg2OTMuODc2Wk03MDUuNjU3IDMzLjUzMDlDNzA1LjEzMSAzMy4xOTY2IDcwNC43ODIgMzMuMDk4NSA3MDQuMzgxIDMzLjA5ODVDNzAzLjU0OSAzMy4wOTg1IDcwMi45NzcgMzMuNjk0NSA3MDIuOTc3IDM0LjU2N0M3MDIuOTc3IDM1LjQ1NiA3MDMuNTkyIDM1Ljk5MTYgNzA0LjUzNSAzNS45OTE2QzcwNC45MjUgMzUuOTkxNiA3MDUuMjk1IDM1Ljg5NzMgNzA1Ljc2IDM1LjcwNTlWMzYuNTQyNkM3MDUuNDQ3IDM2LjY3NzQgNzA0Ljg2MiAzNi43ODk4IDcwNC4zOCAzNi43ODk4QzcwMy4wMDQgMzYuNzg5OCA3MDIuMDQ0IDM1LjkwNjIgNzAyLjA0NCAzNC42NDMyQzcwMi4wNDQgMzMuMjE3OCA3MDIuOTIyIDMyLjMxOCA3MDQuMzIgMzIuMzE4QzcwNC44NTUgMzIuMzE4IDcwNS4yMTIgMzIuNDMzOSA3MDUuNjU3IDMyLjYxNDVMNzA1LjY1NyAzMy41MzA5Wk02OTguNzQyIDM2LjcwOTNINjk5LjY1MlYzMi40MDA4SDY5OC43NDJWMzYuNzA5M1oiIGZpbGw9IiMwMDlFNEQiLz4NCjxwYXRoIGQ9Ik02OTkuNjg0IDMwLjg1MjVDNjk5Ljc3MyAzMS4wNjA0IDY5OS42MTggMzEuMzU0NCA2OTkuMzQ0IDMxLjUwNDFDNjk5LjA2OCAzMS42NTQzIDY5OC43NzYgMzEuNjA2MiA2OTguNjkzIDMxLjM5NzhDNjk4LjYxIDMxLjE4NzQgNjk4Ljc2MSAzMC44OTU4IDY5OS4wMzggMzAuNzQ1NkM2OTkuMzExIDMwLjU5MzUgNjk5LjYwMSAzMC42NDIxIDY5OS42ODQgMzAuODUyNVYzMC44NTI1Wk02NTguOTQgMzEuMjAwOUM2NTguNzc5IDMxLjIwMDkgNjU4LjcxMSAzMS4yMjU1IDY1OC42NDYgMzEuMjkzOEM2NTguNjIgMzEuMzIwMyA2NTguNjEgMzEuMzQ3MiA2NTguNiAzMS40MDExTDY1Ny43ODQgMzQuMjg3QzY1Ny41OTMgMzUuMjk5MiA2NTYuMjU5IDM2LjMwOTkgNjU0LjUyMSAzNi4zMDk5SDY1Mi4xMDRMNjUyLjUyMyAzNC44MjdINjU0LjA3NkM2NTQuMjM0IDM0LjgyNyA2NTQuMzU4IDM0Ljc3MjEgNjU0LjQ2MiAzNC42NjQzQzY1NC41IDM0LjYyMjUgNjU0LjU1IDM0LjU1NyA2NTQuNTU2IDM0LjQ4OTZMNjU1LjIwMSAzMS45NjgxQzY1NS4zOTEgMzAuOTU1NSA2NTYuNTM4IDI5LjgzNjkgNjU4LjI3NiAyOS44MzY5SDY2MC43NTFMNjYwLjQzNSAzMS4yMDA5SDY1OC45NFpNNjU5LjQ5NyAzMi45NTk2TDY1OS43NzMgMzIuMDI1OUg2NjIuMjg4QzY2Mi41OTggMzAuNjcyIDY2Mi4zNTQgMjkuNDE3NyA2NjEuNDczIDI4LjU5NjFDNjU5LjY4OSAyNi45MzMyIDY1NS45NTcgMjcuNDk4MyA2NTMuMTc3IDI5Ljk3NzlDNjUyLjc0MyAzMC4zNjMgNjUyLjM3NiAzMC43NzkzIDY1Mi4wNDIgMzEuMjA0OEg2NTMuNTU2TDY1My4yMDQgMzIuMTQwNEg2NTEuMzk1QzY1MS4yMjIgMzIuNDM1NCA2NTEuMDYgMzIuNzI4MSA2NTAuOTM2IDMzLjAyNUg2NTMuMDgxTDY1Mi43MzcgMzMuOTYwN0g2NTAuNjNDNjUwLjI2OSAzNS4zOTAxIDY1MC40OTkgMzYuNzIzMyA2NTEuNDA2IDM3LjU2OTlDNjUzLjE2NyAzOS4yMTE2IDY1Ni44ODggMzguNjM0NiA2NTkuNjY3IDM2LjE1NTRDNjYwLjE1MyAzNS43MjQyIDY2MC41NTUgMzUuMjU4NyA2NjAuOTE4IDM0Ljc4MDhINjU4Ljk3M0w2NTkuMjY5IDMzLjg0NzFINjYxLjU0M0M2NjEuNzEgMzMuNTUwMSA2NjEuODYzIDMzLjI1NjUgNjYxLjk4MyAzMi45NTk2SDY1OS40OTdaIiBmaWxsPSIjMDA5RTREIi8+DQo8ZyBjbGlwLXBhdGg9InVybCgjY2xpcDBfNThfMTExKSI+DQo8cGF0aCBkPSJNNzc1LjA2OCA0MS4yMjc0Qzc2Ni4yODUgNDIuMDQ2MyA3NTcuMTMxIDQwLjc1NjQgNzU1Ljg0OCAzMy44MTlDNzU1LjIyMSAzMC4zOTkgNzU2Ljc2NSAyNi43NzI1IDc1OC44MSAyNC41MTg0VjIzLjMxNDhDNzU1LjEyNiAyNi41OCA3NTMuMTMgMzAuNzExNSA3NTQuMjggMzUuNTkyQzc1NS43NDggNDEuODUxOCA3NjMuNjAzIDQ1LjM5NjcgNzc1LjU5NSA0NC4yMTk1Qzc4MC4zNDIgNDMuNzU0NSA3ODYuNTUgNDIuMjEyIDc5MC44NjkgMzkuODE0NFYzNi40MTA5Qzc4Ni45NDkgMzguNzcxMyA3ODAuNDY4IDQwLjcyMTEgNzc1LjA2OCA0MS4yMjc0VjQxLjIyNzRaTTc5OC4yMDUgMjMuMjMzNUM3OTYuMTIyIDEyLjk1MzMgNzc2LjM3MyAxMi4zMDE2IDc2My42NDMgMjAuMTMzOFYyMC45OTg5Qzc3Ni4zNTkgMTQuMzkxNSA3OTQuMzk1IDE0LjQzMTcgNzk2LjAzNyAyMy45MDE2Qzc5Ni41ODkgMjcuMDM0MiA3OTQuODQzIDMwLjI5NzggNzkxLjcyMyAzMi4xNzdWMzQuNjM0MkM3OTUuNDc2IDMzLjI0MzIgNzk5LjMyNCAyOC43NDQyIDc5OC4yMDUgMjMuMjMzNVYyMy4yMzM1WiIgZmlsbD0iIzBFN0RDMiIvPg0KPHBhdGggZD0iTTc5MC4xNTkgMjEuNzM2OEg3ODcuODU2VjMyLjEwM0M3ODcuODU2IDMzLjMxNzkgNzg4LjQzNyAzNC4zNzQ0IDc5MC4xNTkgMzQuNTQzMlYyMS43MzY4Wk03NjIuNzM5IDI1LjUyMTdINzYwLjQzMkw3NjAuNDMxIDMyLjI5NDNDNzYwLjQzMSAzMy41MTM0IDc2MS4wMTMgMzQuNTY4OCA3NjIuNzM5IDM0LjczNDRWMjUuNTIxN1YyNS41MjE3Wk03NjAuNDMyIDIyLjA1MjFINzYyLjczMlYyNC4yNTg0SDc2MC40MzJWMjIuMDUyMVpNNzc2LjUzIDM0LjYyNzJDNzc0LjY2NiAzNC42MjcyIDc3My44NzcgMzMuMzE3NyA3NzMuODc3IDMyLjAyOFYyMy4wMzU1SDc3Ni4xNlYyNS41MjE3SDc3Ny44NzlWMjcuMzg1M0g3NzYuMTZWMzEuODg1NEM3NzYuMTYgMzIuNDExMyA3NzYuNDA3IDMyLjcwNDQgNzc2Ljk1IDMyLjcwNDRINzc3Ljg3OVYzNC42MjcyTDc3Ni41MyAzNC42MjcyVjM0LjYyNzJaTTc4MC43MzEgMzAuNzk2MUM3ODAuNzMxIDMxLjk3NjggNzgxLjQ2MSAzMi44NDQ2IDc4Mi43NTQgMzIuODQ0NkM3ODMuNzY2IDMyLjg0NDYgNzg0LjI2NiAzMi41NjA1IDc4NC44NSAzMS45NzY4TDc4Ni4yNjEgMzMuMzM0OUM3ODUuMzU3IDM0LjIzNzkgNzg0LjQwOSAzNC43ODcgNzgyLjczNyAzNC43ODdDNzgwLjU1MiAzNC43ODcgNzc4LjQ1OSAzMy41ODE5IDc3OC40NTkgMzAuMDY4NkM3NzguNDU5IDI3LjA2NTEgNzgwLjI4OCAyNS4zNjczIDc4Mi42ODYgMjUuMzY3M0M3ODUuMTI0IDI1LjM2NzMgNzg2LjUyNSAyNy4zNTQ5IDc4Ni41MjUgMjkuOTYzOVYzMC43OTYzSDc4MC43MzFWMzAuNzk2MVpNNzgyLjU4NiAyNy4yNzU2Qzc4MS44MDUgMjcuMjc1NiA3ODEuMjA0IDI3LjY4MjMgNzgwLjk1IDI4LjIzMDlDNzgwLjgwMiAyOC41NjA3IDc4MC43NDcgMjguODE3NyA3ODAuNzMxIDI5LjIyMjlINzg0LjI0OUM3ODQuMjA0IDI4LjIzMDkgNzgzLjc1OSAyNy4yNzU2IDc4Mi41ODYgMjcuMjc1NlpNNzY4LjkzOSAyNy4zODUzQzc2OS42MDggMjcuMzg1MyA3NjkuODg3IDI3LjcxOTggNzY5Ljg4NyAyOC4yNjI2VjM0LjY0MDZINzcyLjE3VjI4LjI0OTJDNzcyLjE3IDI2Ljk1NDIgNzcxLjQ4NyAyNS41MjQxIDc2OS40ODIgMjUuNTI0MUw3NjQuNzY2IDI1LjUyMTdWMzQuNjQwNkg3NjcuMDVWMjcuMzg1M0g3NjguOTM5VjI3LjM4NTNaTTc5Mi42MzcgMjMuNTg5MUM3OTIuMTI5IDIzLjU4OTEgNzkxLjcyNCAyMy4xNzU0IDc5MS43MjQgMjIuNjYyOUM3OTEuNzI0IDIyLjE1MjkgNzkyLjEyOSAyMS43MzY4IDc5Mi42MzcgMjEuNzM2OEM3OTMuMTQyIDIxLjczNjggNzkzLjU1NiAyMi4xNTI5IDc5My41NTYgMjIuNjYyOUM3OTMuNTU2IDIzLjE3NTQgNzkzLjE0MiAyMy41ODkxIDc5Mi42MzcgMjMuNTg5MVpNNzkyLjYzNyAyMS44OTEyQzc5Mi4yMTggMjEuODkxMiA3OTEuODgyIDIyLjI0MDcgNzkxLjg4MiAyMi42NjI5Qzc5MS44ODIgMjMuMDg3NiA3OTIuMjE4IDIzLjQzMDkgNzkyLjYzNyAyMy40MzA5Qzc5My4wNTUgMjMuNDMwOSA3OTMuNDAyIDIzLjA4NzYgNzkzLjQwMiAyMi42NjI5Qzc5My40MDIgMjIuMjQwNyA3OTMuMDU1IDIxLjg5MTIgNzkyLjYzNyAyMS44OTEyWk03OTMuMDQzIDIzLjIxOEg3OTIuODcyQzc5Mi44NjQgMjMuMjE3OSA3OTIuODU3IDIzLjIxNTcgNzkyLjg1MSAyMy4yMTE2Qzc5Mi44NDUgMjMuMjA3NSA3OTIuODQgMjMuMjAxNyA3OTIuODM3IDIzLjE5NDlMNzkyLjYwNSAyMi43OTdDNzkyLjU5OCAyMi43ODg1IDc5Mi41NzkgMjIuNzc4OCA3OTIuNTczIDIyLjc3ODhINzkyLjQ2N1YyMy4xNzU0Qzc5Mi40NjcgMjMuMTk1IDc5Mi40NTMgMjMuMjE4MSA3OTIuNDI4IDIzLjIxODFINzkyLjI3NEM3OTIuMjUxIDIzLjIxODEgNzkyLjIzNSAyMy4xOTUgNzkyLjIzNSAyMy4xNzU0VjIyLjE3NDlDNzkyLjIzNSAyMi4xMTY0IDc5Mi4yNTQgMjIuMDkyNCA3OTIuMzA1IDIyLjA4NUM3OTIuMzYxIDIyLjA3OSA3OTIuNTA1IDIyLjA3MTYgNzkyLjU4NiAyMi4wNzE2Qzc5Mi44NzIgMjIuMDcxNiA3OTMuMDM5IDIyLjE1NjYgNzkzLjAzOSAyMi40MjQ0VjIyLjQ0NEM3OTMuMDM5IDIyLjYwOTQgNzkyLjk1OSAyMi42OTk1IDc5Mi44MzMgMjIuNzM5N0w3OTMuMDc0IDIzLjE1NDdDNzkzLjA3OCAyMy4xNjQgNzkzLjA4IDIzLjE3MzkgNzkzLjA4IDIzLjE4NEM3OTMuMDggMjMuMTk5NyA3OTMuMDcyIDIzLjIxOCA3OTMuMDQzIDIzLjIxOFYyMy4yMThaTTc5Mi44MjEgMjIuNDI0NEM3OTIuODIxIDIyLjMxMjcgNzkyLjc1MiAyMi4yNzczIDc5Mi42MDUgMjIuMjc3M0g3OTIuNDU5VjIyLjU5NDdDNzkyLjQ4MiAyMi41OTQ3IDc5Mi41ODYgMjIuNTk5NiA3OTIuNjA1IDIyLjU5OTZDNzkyLjc1MiAyMi41OTk2IDc5Mi44MjEgMjIuNTUgNzkyLjgyMSAyMi40NDRWMjIuNDI0NFoiIGZpbGw9IiMwRTdEQzIiLz4NCjwvZz4NCjxnIGNsaXAtcGF0aD0idXJsKCNjbGlwMV81OF8xMTEpIj4NCjxwYXRoIGQ9Ik01MzMuNzczIDIwLjk5MTFDNTI5LjI2MyAyMC45OTExIDUyNS41OTkgMjQuNjU0NyA1MjUuNTk5IDI5LjE2NDRDNTI1LjU5OSAzMy42NzQxIDUyOS4yNjMgMzcuMzM3NyA1MzMuNzczIDM3LjMzNzdDNTM4LjI4MiAzNy4zMzc3IDU0MS45NDYgMzMuNjc0MSA1NDEuOTQ2IDI5LjE2NDRDNTQxLjk0NiAyNC42NTQ3IDUzOC4yODIgMjAuOTkxMSA1MzMuNzczIDIwLjk5MTFaTTUzMy43NzMgMzYuNTE4NkM1MjkuNzEzIDM2LjUxODYgNTI2LjQxOSAzMy4yMTUgNTI2LjQxOSAyOS4xNjQ0QzUyNi40MTkgMjUuMTEzNyA1MjkuNzEzIDIxLjgxMDIgNTMzLjc3MyAyMS44MTAyQzUzNy44MzIgMjEuODEwMiA1NDEuMTI3IDI1LjExMzcgNTQxLjEyNyAyOS4xNjQ0QzU0MS4xMjcgMzMuMjE1IDUzNy44MzIgMzYuNTE4NiA1MzMuNzczIDM2LjUxODZaIiBmaWxsPSJibGFjayIvPg0KPHBhdGggZD0iTTUzNi42OSAyMy45MjUyQzUzNi42NjMgMjMuOTA3MiA1MzYuNjI3IDIzLjg5ODIgNTM2LjU5MSAyMy44OTgyQzUzNi40ODMgMjMuODk4MiA1MzYuNDAyIDIzLjk3OTIgNTM2LjQwMiAyNC4wODczVjI2LjY0MzdDNTM2LjQwMiAyNi43MzM3IDUzNi4zMyAyNi44MDU3IDUzNi4yNCAyNi44MDU3SDUzMS4yOUM1MzEuMiAyNi44MDU3IDUzMS4xMzcgMjYuNzMzNyA1MzEuMTI4IDI2LjY0MzdWMjQuMDg3M0M1MzEuMTI4IDI0LjA1MTMgNTMxLjExOSAyNC4wMjQyIDUzMS4xMDEgMjMuOTg4MkM1MzEuMDQ3IDIzLjg5ODIgNTMwLjkzIDIzLjg3MTIgNTMwLjgzOSAyMy45MjUyQzUyOS4wMTIgMjUuMDUwNCA1MjcuOTA1IDI3LjAwMzcgNTI3LjkwNSAyOS4xNjQxQzUyNy45MDUgMzEuMzI0NCA1MjkuMDEyIDMzLjI3NzcgNTMwLjg1NyAzNC40MDI5QzUzMC44ODUgMzQuNDIwOSA1MzAuOTIxIDM0LjQyOTkgNTMwLjk1NyAzNC40Mjk5QzUzMS4wNjUgMzQuNDI5OSA1MzEuMTQ2IDM0LjM0ODkgNTMxLjE0NiAzNC4yNDA5VjMxLjY4NDVDNTMxLjE0NiAzMS41OTQ0IDUzMS4yMTggMzEuNTMxNCA1MzEuMzA4IDMxLjUyMjRINTM2LjI1OEM1MzYuMzQ4IDMxLjUyMjQgNTM2LjQyIDMxLjU5NDQgNTM2LjQyIDMxLjY4NDVWMzQuMjQwOUM1MzYuNDIgMzQuMjc2OSA1MzYuNDI5IDM0LjMwMzkgNTM2LjQ0NyAzNC4zMzk5QzUzNi41MDEgMzQuNDI5OSA1MzYuNjE4IDM0LjQ1NjkgNTM2LjcwOCAzNC40MDI5QzUzOC41NTQgMzMuMjc3NyA1MzkuNjYxIDMxLjMyNDQgNTM5LjY2MSAyOS4xNjQxQzUzOS42NjEgMjcuMDAzNyA1MzguNTM2IDI1LjA1MDQgNTM2LjY5IDIzLjkyNTJWMjMuOTI1MlpNNTMwLjE5MSAzMi4zNjg2TDUzMC4yMTggMzIuNjc0Nkw1MzAuMDIgMzIuNDMxNkM1MjguNDk5IDMwLjUxNDMgNTI4LjQ5OSAyNy44MDQ4IDUzMC4wMiAyNS44ODc1TDUzMC4xOTEgMjUuNjcxNUw1MzAuMjE4IDI1LjY0NDVMNTMwLjE5MSAyNS45NTk2QzUzMC4xNjQgMjYuMjExNiA1MzAuMTU1IDI2LjQ3MjYgNTMwLjE1NSAyNi43MzM3VjMxLjU4NTRDNTMwLjE1NSAzMS44NDY1IDUzMC4xNzMgMzIuMTA3NSA1MzAuMTkxIDMyLjM2ODZaTTUzNi40MDIgMzAuMzg4M0M1MzYuNDAyIDMwLjQ3ODMgNTM2LjMzIDMwLjU1MDMgNTM2LjI0IDMwLjU1MDNINTMxLjI5QzUzMS4yIDMwLjU1MDMgNTMxLjEzNyAzMC40NzgzIDUzMS4xMjggMzAuMzg4M1YyNy45Mzk5QzUzMS4xMjggMjcuODQ5OSA1MzEuMiAyNy43Nzc4IDUzMS4yOSAyNy43Nzc4SDUzNi4yNEM1MzYuMzMgMjcuNzc3OCA1MzYuNDAyIDI3Ljg0OTkgNTM2LjQwMiAyNy45Mzk5VjMwLjM4ODNaTTUzNy41MTkgMzIuNDMxNkw1MzcuMzIxIDMyLjY3NDZMNTM3LjM0OCAzMi4zNjg2QzUzNy4zNzUgMzIuMTE2NSA1MzcuMzg0IDMxLjg1NTUgNTM3LjM4NCAzMS41OTQ0VjI2LjczMzdDNTM3LjM4NCAyNi40NzI2IDUzNy4zNzUgMjYuMjExNiA1MzcuMzQ4IDI1Ljk1OTZMNTM3LjMzOSAyNS44MjQ1TDUzNy4zMyAyNS42ODA1VjI1LjY0NDVMNTM3LjUxOSAyNS44ODc1QzUzOC4yNTcgMjYuODA1NyA1MzguNjYyIDI3Ljk3NTkgNTM4LjY2MiAyOS4xNTUxQzUzOC42NjIgMzAuMzM0MiA1MzguMjU3IDMxLjUxMzQgNTM3LjUxOSAzMi40MzE2VjMyLjQzMTZaIiBmaWxsPSJibGFjayIvPg0KPHBhdGggZD0iTTU1NC4yNzYgMjkuMDIwMkM1NTQuMjMxIDI5LjAwMjIgNTU0LjE3NyAyOC45ODQyIDU1NC4xNzcgMjguOTMwMkM1NTQuMTc3IDI4Ljg5NDIgNTU0LjE5NSAyOC44NjcyIDU1NC4yMzEgMjguODQ5MkM1NTQuMjk0IDI4LjgyMjIgNTU1Ljg1MSAyOC4yNjQxIDU1NS44NTEgMjYuNDI3OEM1NTUuODUxIDI0LjM4NDUgNTU0LjQ3NCAyMy4xNjkzIDU1Mi4xNTIgMjMuMTY5M0g1NDYuNTI2VjM1LjE3NzJINTUyLjY2NUM1NTQuNDU2IDM1LjE3NzIgNTU2LjM4MiAzMy45MDggNTU2LjM4MiAzMS44NjQ2QzU1Ni4zODIgMjkuOTExMyA1NTQuOTA2IDI5LjIyNzIgNTU0LjI3NiAyOS4wMjAyVjI5LjAyMDJaTTU0OS4zNjEgMjUuNjI2N0M1NDkuMzYxIDI1LjU4MTcgNTQ5LjM5NyAyNS41NDU2IDU0OS40NDIgMjUuNTQ1Nkg1NTEuNjc1QzU1Mi40MTMgMjUuNTQ1NiA1NTIuOTE3IDI2LjA0MDcgNTUyLjkxNyAyNi43Nzg4QzU1Mi45MTcgMjcuMzU0OSA1NTIuNDY3IDI3Ljk3NiA1NTEuNjIxIDI3Ljk3Nkg1NDkuNDQyQzU0OS4zOTcgMjcuOTc2IDU0OS4zNjEgMjcuOTQgNTQ5LjM2MSAyNy44OTVWMjUuNjI2N1pNNTUxLjY3NSAzMi44MDk4SDU0OS40NDJDNTQ5LjM5NyAzMi44MDk4IDU0OS4zNjEgMzIuNzczOCA1NDkuMzYxIDMyLjcyODhWMzAuMzM0NEM1NDkuMzYxIDMwLjI4OTQgNTQ5LjM5NyAzMC4yNTM0IDU0OS40NDIgMzAuMjUzNEg1NTEuNjIxQzU1Mi42OTIgMzAuMjUzNCA1NTMuMzA0IDMwLjcxMjUgNTUzLjMwNCAzMS41MjI2QzU1My4zMDQgMzIuMzU5NyA1NTIuNzM3IDMyLjgwOTggNTUxLjY3NSAzMi44MDk4VjMyLjgwOThaTTU3NS4zODQgMjcuOTQ5TDU3NC45NTIgMjcuODU5QzU3My45OCAyNy42NTIgNTczLjAzNSAyNy4zOTA5IDU3My4wMzUgMjYuNTUzOEM1NzMuMDM1IDI1LjcxNjcgNTczLjgxOCAyNS4zMzg2IDU3NC41OTIgMjUuMzM4NkM1NzUuNTAxIDI1LjMzODYgNTc2LjQwMSAyNS43NDM3IDU3Ny4wODYgMjYuNDQ1OEw1NzguODY4IDI0LjY4MTVDNTc4LjEwMyAyMy44MzU0IDU3Ni43NDQgMjIuODYzMiA1NzQuNTQ3IDIyLjg2MzJDNTcxLjkwMSAyMi44NjMyIDU3MC4xMTggMjQuMzY2NSA1NzAuMTE4IDI2LjYwNzhDNTcwLjExOCAyOC45NzUyIDU3MS45ODIgMjkuODY2MyA1NzMuNTQ4IDMwLjE5OTRMNTczLjk3MSAzMC4yODk0QzU3NS40OTIgMzAuNjEzNSA1NzYuMjEyIDMwLjg1NjUgNTc2LjIxMiAzMS43MjA2QzU3Ni4yMTIgMzIuNDk0NyA1NzUuNTE5IDMzLjAwNzggNTc0LjQ5MyAzMy4wMDc4QzU3My4yODcgMzMuMDA3OCA1NzIuMjE2IDMyLjQ3NjcgNTcxLjQwNiAzMS40Nzc2TDU2OS41NzggMzMuMjY4OUM1NzAuNTUxIDM0LjQyMTEgNTcxLjgzOCAzNS40NjUyIDU3NC41MjkgMzUuNDY1MkM1NzYuODI1IDM1LjQ2NTIgNTc5LjE1NiAzNC4xMzMgNTc5LjE1NiAzMS41NzY2QzU3OS4xNDcgMjguOTU3MiA1NzcuMzY1IDI4LjM2MzEgNTc1LjM4NCAyNy45NDlWMjcuOTQ5Wk01OTkuMTAzIDIzLjE2OTNWMjcuNTYyQzU5OS4xMDMgMjcuNjA3IDU5OS4wNjcgMjcuNjQzIDU5OS4wMjIgMjcuNjQzSDU5NS4zMzFDNTk1LjI4NiAyNy42NDMgNTk1LjI1IDI3LjYwNyA1OTUuMjUgMjcuNTYyVjIzLjE2OTNINTkyLjIyNlYzNS4xNzcySDU5NS4yNVYzMC40NjA0QzU5NS4yNSAzMC40MTU0IDU5NS4yODYgMzAuMzc5NCA1OTUuMzMxIDMwLjM3OTRINTk5LjAyMkM1OTkuMDY3IDMwLjM3OTQgNTk5LjEwMyAzMC40MTU0IDU5OS4xMDMgMzAuNDYwNFYzNS4xNzcySDYwMi4xNDZWMjMuMTY5M0g1OTkuMTAzWk01ODYuMTQxIDMyLjcxOThDNTg0Ljc4MiAzMi43MTk4IDU4My4zMTUgMzEuNTg1NiA1ODMuMzE1IDI5LjA5MjJDNTgzLjMxNSAyNi44MTQ4IDU4NC42OTIgMjUuNjI2NyA1ODYuMDUxIDI1LjYyNjdDNTg3LjA0MSAyNS42MjY3IDU4Ny43MzQgMjYuMDQwNyA1ODguMjgzIDI2Ljk1ODlMNTkwLjYwNiAyNS40MTk2QzU4OS40MTggMjMuNjczMyA1ODguMDA0IDIyLjg4MTIgNTg2LjAzMyAyMi44ODEyQzU4Mi4xNzEgMjIuODgxMiA1ODAuNDQzIDI2LjAwNDcgNTgwLjQ0MyAyOS4wOTIyQzU4MC40NDMgMzIuODQ1OCA1ODIuNzI5IDM1LjQ2NTIgNTg1Ljk5NyAzNS40NjUyQzU4OC40MjcgMzUuNDY1MiA1ODkuNTM1IDM0LjU3NDEgNTkwLjY5NiAzMi45MjY4TDU4OC4zNTUgMzEuMzUxNkM1ODcuODMzIDMyLjE5NzcgNTg3LjI2NiAzMi43MTk4IDU4Ni4xNDEgMzIuNzE5OFpNNTYzLjE3OCAyMi44NjMyQzU1OS44NzUgMjIuODYzMiA1NTcuNjYxIDI1LjM5MjYgNTU3LjY2MSAyOS4xNjQyQzU1Ny42NjEgMzIuOTM1OCA1NTkuODc1IDM1LjQ2NTIgNTYzLjE3OCAzNS40NjUyQzU2Ni40ODIgMzUuNDY1MiA1NjguNjk2IDMyLjkzNTggNTY4LjY5NiAyOS4xNjQyQzU2OC42OTYgMjUuMzkyNiA1NjYuNDgyIDIyLjg2MzIgNTYzLjE3OCAyMi44NjMyVjIyLjg2MzJaTTU2My4xNzggMzIuNzE5OEM1NjEuNTU4IDMyLjcxOTggNTYwLjUxNCAzMS4zMjQ2IDU2MC41MTQgMjkuMTY0MkM1NjAuNTE0IDI3LjAxMjkgNTYxLjU1OCAyNS42MjY3IDU2My4xNzggMjUuNjI2N0M1NjQuODA4IDI1LjYyNjcgNTY1Ljg2MSAyNy4wMTI5IDU2NS44NjEgMjkuMTY0MkM1NjUuODYxIDMxLjMyNDYgNTY0LjgwOCAzMi43MTk4IDU2My4xNzggMzIuNzE5OFoiIGZpbGw9IiNGODAwMDAiLz4NCjwvZz4NCjxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNMTQ2LjM0NCAyMi4xODExQzE0Ny41OTUgMjIuMjg1NCAxNDguODQ1IDIxLjU1NTMgMTQ5LjYyNyAyMC42Mjk4QzE1MC4zOTUgMTkuNjc4MSAxNTAuOTAzIDE4LjQwMDUgMTUwLjc3MyAxNy4wOTY5QzE0OS42NjYgMTcuMTQ5MSAxNDguMjk4IDE3LjgyNjkgMTQ3LjUxNyAxOC43Nzg2QzE0Ni44IDE5LjU5OTkgMTQ2LjE4OCAyMC45Mjk2IDE0Ni4zNDQgMjIuMTgxMVpNMTQ3Ljg0MSAyMy4wNzk3QzE0OC42NTMgMjIuNzYwNiAxNDkuNjU4IDIyLjM2NTYgMTUwLjc2IDIyLjQyOTFDMTUxLjQ2MyAyMi40ODEyIDE1My40OTUgMjIuNjg5OCAxNTQuNzk4IDI0LjYxOTJDMTU0Ljc5MiAyNC42MjM3IDE1NC43NzggMjQuNjMyMyAxNTQuNzU5IDI0LjY0NUMxNTQuNDM2IDI0Ljg1NDggMTUyLjM5IDI2LjE4NzEgMTUyLjQxNCAyOC44MTY5QzE1Mi40MzkgMzEuOTQ5OSAxNTQuOTg4IDMzLjExODMgMTU1LjMyMiAzMy4yNzExQzE1NS4zNDQgMzMuMjgxMSAxNTUuMzU2IDMzLjI4NjcgMTU1LjM1OCAzMy4yODgzQzE1NS4zNTYgMzMuMjkyNiAxNTUuMzU0IDMzLjMwMSAxNTUuMzUgMzMuMzEzM0MxNTUuMjgzIDMzLjUyODggMTU0Ljg0NSAzNC45NDg5IDE1My44NDcgMzYuNDA0QzE1Mi45MjIgMzcuNzU5OCAxNTEuOTcxIDM5LjA4OTUgMTUwLjQ2IDM5LjExNTZDMTQ5Ljc0OSAzOS4xMjgzIDE0OS4yNyAzOC45MjExIDE0OC43NzIgMzguNzA1NEMxNDguMjQ3IDM4LjQ3ODUgMTQ3LjcwMSAzOC4yNDIyIDE0Ni44NCAzOC4yNDIyQzE0NS45NDcgMzguMjQyMiAxNDUuMzc2IDM4LjQ4NDggMTQ0LjgyNiAzOC43MTg0QzE0NC4zNDggMzguOTIxNCAxNDMuODg3IDM5LjExNzQgMTQzLjI0NSAzOS4xNDE3QzE0MS43ODYgMzkuMTkzOCAxNDAuNjc5IDM3LjcwNzcgMTM5Ljc1NCAzNi4zNTE5QzEzNy44NjYgMzMuNjE0MyAxMzYuNDIgMjguNjM0NCAxMzguMzc0IDI1LjI3MUMxMzkuMzI1IDIzLjU4OTMgMTQxLjA1NyAyMi41MzM0IDE0Mi45MTkgMjIuNTA3M0MxNDMuNzMyIDIyLjQ5MjUgMTQ0LjUwNyAyMi44MDA2IDE0NS4xODQgMjMuMDcwMUMxNDUuNzAyIDIzLjI3NTggMTQ2LjE2MiAyMy40NTg5IDE0Ni41NCAyMy40NTg5QzE0Ni44NzcgMjMuNDU4OSAxNDcuMzE5IDIzLjI4NTEgMTQ3Ljg0MSAyMy4wNzk3WiIgZmlsbD0iYmxhY2siLz4NCjxwYXRoIGQ9Ik0zNi44NTg3IDM3LjUyNDFIMzEuOTg3NEwzNS4wMzQyIDE5LjY2NjhIMzkuOTA1MkwzNi44NTg3IDM3LjUyNDFaIiBmaWxsPSIjMDA1NzlGIi8+DQo8cGF0aCBkPSJNNTQuNTE1NyAyMC4xMDQxQzUzLjU1NDkgMTkuNzQyOCA1Mi4wMzA5IDE5LjM0MzggNTAuMTQ2NiAxOS4zNDM4QzQ1LjMzNjEgMTkuMzQzOCA0MS45NDg2IDIxLjc3NTMgNDEuOTI3OCAyNS4yNTE2QzQxLjg4NzggMjcuODE2NSA0NC4zNTMxIDI5LjI0MSA0Ni4xOTcgMzAuMDk2MkM0OC4wODE2IDMwLjk3MDEgNDguNzIyMyAzMS41NDA1IDQ4LjcyMjMgMzIuMzE5NEM0OC43MDMxIDMzLjUxNTcgNDcuMTk5NCAzNC4wNjcyIDQ1Ljc5NjkgMzQuMDY3MkM0My44NTIxIDM0LjA2NzIgNDIuODEgMzMuNzgyOSA0MS4yMjY0IDMzLjExNzNMNDAuNTg1IDMyLjgzMkwzOS45MDMzIDM2Ljg0MDZDNDEuMDQ1OCAzNy4zMzM5IDQzLjE1MDcgMzcuNzcxNyA0NS4zMzYxIDM3Ljc5MDlDNTAuNDQ3MyAzNy43OTA5IDUzLjc3NDkgMzUuMzk3MSA1My44MTQzIDMxLjY5MjVDNTMuODMzOCAyOS42NTk3IDUyLjUzMiAyOC4xMDIgNDkuNzI1NCAyNi44MjkyQzQ4LjAyMTcgMjYuMDEyMSA0Ni45NzgzIDI1LjQ2MTIgNDYuOTc4MyAyNC42MjUyQzQ2Ljk5ODMgMjMuODY1MiA0Ny44NjA4IDIzLjA4NjggNDkuNzg0IDIzLjA4NjhDNTEuMzY3NyAyMy4wNDg2IDUyLjUzMTIgMjMuNDA5NCA1My40MTI2IDIzLjc3MDVMNTMuODUzMiAyMy45NjAxTDU0LjUxNTcgMjAuMTA0MVoiIGZpbGw9IiMwMDU3OUYiLz4NCjxwYXRoIGQ9Ik02MC45OTI0IDMxLjE5NzlDNjEuMzkzNiAzMC4xNzIgNjIuOTM3MiAyNi4yMDE2IDYyLjkzNzIgMjYuMjAxNkM2Mi45MTcgMjYuMjM5NyA2My4zMzc2IDI1LjE1NjggNjMuNTc4MSAyNC40OTE5TDYzLjkxODYgMjYuMDMwNkM2My45MTg2IDI2LjAzMDYgNjQuODQxIDMwLjMwNTEgNjUuMDQxNCAzMS4xOTc5QzY0LjI4IDMxLjE5NzkgNjEuOTU0NiAzMS4xOTc5IDYwLjk5MjQgMzEuMTk3OVpNNjcuMDA1NCAxOS42NjY4SDYzLjIzNzRDNjIuMDc1NSAxOS42NjY4IDYxLjE5MjcgMTkuOTg5NSA2MC42OTE0IDIxLjE0ODRMNTMuNDU1OCAzNy41MjM5SDU4LjU2NzFDNTguNTY3MSAzNy41MjM5IDU5LjQwODUgMzUuMzE5OSA1OS41ODk0IDM0Ljg0NTJDNjAuMTUwMSAzNC44NDUyIDY1LjEyMjMgMzQuODQ1MiA2NS44NDM3IDM0Ljg0NTJDNjUuOTgzNSAzNS40NzIxIDY2LjQyNDkgMzcuNTIzOSA2Ni40MjQ5IDM3LjUyMzlINzAuOTM1Mkw2Ny4wMDU0IDE5LjY2NjhWMTkuNjY2OFoiIGZpbGw9IiMwMDU3OUYiLz4NCjxwYXRoIGQ9Ik0yNy45MTggMTkuNjY2OEwyMy4xNDc1IDMxLjg0MzhMMjIuNjI2MiAyOS4zNzQxQzIxLjc0NDIgMjYuNTI0NSAxOC45NzgxIDIzLjQyODQgMTUuODkxNCAyMS44ODlMMjAuMjYxIDM3LjUwNTJIMjUuNDEyMkwzMy4wNjkgMTkuNjY2OEgyNy45MThWMTkuNjY2OFoiIGZpbGw9IiMwMDU3OUYiLz4NCjxwYXRoIGQ9Ik0xOC43MTg0IDE5LjY2NjhIMTAuODgxMUwxMC44MDA5IDIwLjAyNzZDMTYuOTE0NSAyMS41MDk1IDIwLjk2MzUgMjUuMDgxNSAyMi42MjcgMjkuMzc0OUwyMC45MjMyIDIxLjE2NzlDMjAuNjQyNyAyMC4wMjc0IDE5Ljc4MDcgMTkuNzA0NCAxOC43MTg0IDE5LjY2NjhaIiBmaWxsPSIjRkFBNjFBIi8+DQo8ZyBjbGlwLXBhdGg9InVybCgjY2xpcDJfNThfMTExKSI+DQo8cGF0aCBkPSJNMjIxLjE1OCAxNy40OTlWMTguOTM1NkgyMzEuMzA2VjE3LjQ5OUgyMjEuMTU4Wk0yMzIuNzQ0IDE3LjQ5OVYxOC45MzU2SDI0Ny4yMDZDMjQ3LjIwNiAxOC45MzU2IDI0NS43MjkgMTcuNDk5IDI0My43NzMgMTcuNDk5SDIzMi43NDRaTTI1MC4wNDMgMTcuNDk5VjE4LjkzNTZIMjU4Ljc5M0wyNTguMjczIDE3LjQ5OUgyNTAuMDQzWk0yNjUuMDY1IDE3LjQ5OUwyNjQuNTQ2IDE4LjkzNTZIMjczLjIxNlYxNy40OTlIMjY1LjA2NVpNMjIxLjE1OCAyMC4yOTI5VjIxLjcyOTZIMjMxLjMwNlYyMC4yOTI5SDIyMS4xNThaTTIzMi43NDQgMjAuMjk1VjIxLjcyOTdIMjQ4Ljg4NEMyNDguODg0IDIxLjcyOTcgMjQ4LjY5NiAyMC42MjM5IDI0OC4zNjcgMjAuMjk1SDIzMi43NDRaTTI1MC4wNDMgMjAuMjk1VjIxLjcyOTdIMjU5Ljc1MkwyNTkuMjcxIDIwLjI5NUgyNTAuMDQzWk0yNjQuMDI3IDIwLjI5NUwyNjMuNTQ2IDIxLjcyOTdIMjczLjIxNlYyMC4yOTVIMjY0LjAyN1YyMC4yOTVaTTIyNC4wNzQgMjMuMDg2OVYyNC41MjU3SDIyOC40NjlWMjMuMDg2OUgyMjQuMDc0VjIzLjA4NjlaTTIzNS42NjEgMjMuMDg2OVYyNC41MjU3SDI0MC4wNTZWMjMuMDg2OUgyMzUuNjYxVjIzLjA4NjlaTTI0NC4zMzEgMjMuMDg2OVYyNC41MjU3SDI0OC43MjZDMjQ4LjcyNiAyNC41MjU3IDI0OS4wMDUgMjMuNzY1OSAyNDkuMDA1IDIzLjA4NjlIMjQ0LjMzMVYyMy4wODY5Wk0yNTIuOTYgMjMuMDg2OVYyNC41MjU3SDI2MC43NTJMMjYwLjIzMiAyMy4wODY5SDI1Mi45NlYyMy4wODY5Wk0yNjMuMDY5IDIzLjA4NjlMMjYyLjU0OCAyNC41MjU3SDI3MC4zNzlWMjMuMDg2OUgyNjMuMDY5VjIzLjA4NjlaTTIyNC4wNzQgMjUuODgzVjI3LjMxOTdIMjI4LjQ2OVYyNS44ODNIMjI0LjA3NFYyNS44ODNaTTIzNS42NjEgMjUuODgzVjI3LjMxOTdIMjQ2Ljg4N0MyNDYuODg3IDI3LjMxOTcgMjQ3LjgyNiAyNi41ODI1IDI0OC4xMjUgMjUuODgzSDIzNS42NjFaTTI1Mi45NiAyNS44ODNWMjcuMzE5N0gyNTcuMzU1VjI2LjUyTDI1Ny42MzQgMjcuMzE5N0gyNjUuNjg0TDI2NS45ODQgMjYuNTJWMjcuMzE5N0gyNzAuMzc5VjI1Ljg4M0gyNjIuMTI5TDI2MS42OTEgMjcuMDk5OUwyNjEuMjUxIDI1Ljg4M0gyNTIuOTZaTTIyNC4wNzQgMjguNjc3VjMwLjExMzdIMjI4LjQ2OVYyOC42NzdIMjI0LjA3NFpNMjM1LjY2MSAyOC42NzdWMzAuMTEzN0gyNDguMTI1QzI0Ny44MjYgMjkuNDE2NSAyNDYuODg3IDI4LjY3NyAyNDYuODg3IDI4LjY3N0gyMzUuNjYxWk0yNTIuOTYgMjguNjc3VjMwLjExMzdIMjU3LjM1NVYyOC42NzdIMjUyLjk2Wk0yNTguMTUzIDI4LjY3N0wyNTguNjg1IDMwLjExMzdIMjY0LjcyMUwyNjUuMjI2IDI4LjY3N0gyNTguMTUzWk0yNjUuOTg0IDI4LjY3N1YzMC4xMTM3SDI3MC4zNzlWMjguNjc3SDI2NS45ODRaTTIyNC4wNzQgMzEuNDcxVjMyLjkwNzZIMjI4LjQ2OVYzMS40NzFIMjI0LjA3NFpNMjM1LjY2MSAzMS40NzFWMzIuOTA3NkgyNDAuMDU2VjMxLjQ3MUgyMzUuNjYxWk0yNDQuMzMxIDMxLjQ3MVYzMi45MDc2SDI0OS4wMDVDMjQ5LjAwNSAzMi4yMjk2IDI0OC43MjYgMzEuNDcxIDI0OC43MjYgMzEuNDcxSDI0NC4zMzFWMzEuNDcxWk0yNTIuOTYgMzEuNDcxVjMyLjkwNzZIMjU3LjM1NVYzMS40NzFIMjUyLjk2Wk0yNTkuMTUxIDMxLjQ3MUwyNTkuNjY2IDMyLjkwNzZIMjYzLjcxM0wyNjQuMjMyIDMxLjQ3MUgyNTkuMTUxWk0yNjUuOTg0IDMxLjQ3MVYzMi45MDc2SDI3MC4zNzlWMzEuNDcxSDI2NS45ODRaTTIyMS4yMzcgMzQuMjY1VjM1LjcwMzdIMjMxLjM4NlYzNC4yNjVIMjIxLjIzN1pNMjMyLjc0NCAzNC4yNjVWMzUuNzAzN0gyNDguMzY3QzI0OC42OTYgMzUuMzc0MyAyNDguODg0IDM0LjI2NSAyNDguODg0IDM0LjI2NUgyMzIuNzQ0VjM0LjI2NVpNMjUwLjEyMyAzNC4yNjVWMzUuNzAzN0gyNTcuMzU1VjM0LjI2NUgyNTAuMTIzWk0yNjAuMTUxIDM0LjI2NUwyNjAuNjggMzUuNzAzN0gyNjIuNzM5TDI2My4yMzYgMzQuMjY1SDI2MC4xNTFaTTI2NS45ODQgMzQuMjY1VjM1LjcwMzdIMjczLjI5NVYzNC4yNjVIMjY1Ljk4NFpNMjIxLjIzNyAzNy4wNjFWMzguNDk3N0gyMzEuMzg2VjM3LjA2MUgyMjEuMjM3Wk0yMzIuNzQ0IDM3LjA2MVYzOC40OTU2SDI0My43NzNDMjQ1LjcyOSAzOC40OTU2IDI0Ny4yMDYgMzcuMDYxIDI0Ny4yMDYgMzcuMDYxSDIzMi43NDRaTTI1MC4xMjMgMzcuMDYxVjM4LjQ5NzdIMjU3LjM1NVYzNy4wNjFIMjUwLjEyM1pNMjYxLjE1NSAzNy4wNjFMMjYxLjY2NCAzOC40OTM2TDI2MS43NTIgMzguNDk1NkwyNjIuMjY5IDM3LjA2MUgyNjEuMTU1VjM3LjA2MVpNMjY1Ljk4NCAzNy4wNjFWMzguNDk3N0gyNzMuMjk1VjM3LjA2MUgyNjUuOTg0WiIgZmlsbD0iIzFGNzBDMSIvPg0KPC9nPg0KPGRlZnM+DQo8Y2xpcFBhdGggaWQ9ImNsaXAwXzU4XzExMSI+DQo8cmVjdCB3aWR0aD0iNDQuNDQ3MyIgaGVpZ2h0PSIyOS42MzE1IiBmaWxsPSJ3aGl0ZSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNzUzLjk1NSAxNC44MTU1KSIvPg0KPC9jbGlwUGF0aD4NCjxjbGlwUGF0aCBpZD0iY2xpcDFfNThfMTExIj4NCjxyZWN0IHdpZHRoPSI3Ni41NDgxIiBoZWlnaHQ9IjE2LjM1MDciIGZpbGw9IndoaXRlIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSg1MjUuNTk5IDIwLjk4ODkpIi8+DQo8L2NsaXBQYXRoPg0KPGNsaXBQYXRoIGlkPSJjbGlwMl81OF8xMTEiPg0KPHJlY3Qgd2lkdGg9IjUyLjEzNzIiIGhlaWdodD0iMjAuOTk4NyIgZmlsbD0id2hpdGUiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDIyMS4xNTggMTcuNDk5KSIvPg0KPC9jbGlwUGF0aD4NCjwvZGVmcz4NCjwvc3ZnPg0K" style="\n            width: 742.5px;\n            position: relative;\n            top: 107px;\n            left: 32px;\n            ">\n            <a href='+$e+' style="\n        float: left;\n        border-radius: 56px;\n        background: #0D6EFD;\n        padding-top: 8px;\n        width: 280px;\n        height: 38px;\n        text-align: center;\n        position: relative;\n        top: 127px;\n        left: 274px;\n        font-size: 16px;\n        color: white;\n        text-decoration: none;\n        letter-spacing: 0.02em;\n    ">Claim your FREE account</a>\n            <div style="\n    font-size: 14px;\n    position: relative;\n    top: 180px;\n    left: 19px;\n    letter-spacing: 0.02em;\n    font-weight: 500;\n    line-height: 125%;\n">have a Syncfusion account? <a href="https://www.syncfusion.com/account/login?ReturnUrl=/account/login" style="text-decoration: none;\ncolor: #0D6EFD;\nfont-weight: 500;">Sign In</a></div>\n        </div>\n    </div>';if("undefined"!=typeof document&&!g(document)){var t=he("div",{innerHTML:e});document.body.appendChild(t)}},pt=(lt=function(e,t){return(lt=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}lt(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),ut=function(e,t,r,n){var o,s=arguments.length,a=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(s<3?o(a):s>3?o(t,r,a):o(t,r))||a);return s>3&&a&&Object.defineProperty(t,r,a),a},gt=0,ft=0,mt=0,yt=!0,vt=!1;e.versionBasedStatePersistence=!1;var bt=function(t){function r(i,r){var n=t.call(this,i,r)||this;return n.randomId=w(),n.isStringTemplate=!1,n.needsID=!1,n.isReactHybrid=!1,g(n.enableRtl)&&n.setProperties({enableRtl:e.rightToLeft},!0),g(n.locale)&&n.setProperties({locale:e.defaultCulture},!0),n.moduleLoader=new et(n),n.localObserver=new _(n),V.on("notifyExternalChange",n.detectFunction,n,n.randomId),"undefined"==typeof window||"undefined"==typeof document||dt()||-1!==it.indexOf(n.getModuleName())&&(mt+=1)>5&&(yt=!1),f(r)||n.appendTo(),n}return pt(r,t),r.prototype.requiredModules=function(){return[]},r.prototype.destroy=function(){this.isDestroyed||(this.enablePersistence&&this.setPersistData(),this.localObserver.destroy(),this.refreshing||(ce([this.element],["e-control"]),this.trigger("destroyed",{cancel:!1}),t.prototype.destroy.call(this),this.moduleLoader.clean(),V.off("notifyExternalChange",this.detectFunction,this.randomId)))},r.prototype.refresh=function(){this.refreshing=!0,this.moduleLoader.clean(),this.destroy(),this.clearChanges(),this.localObserver=new _(this),this.preRender(),this.injectModules(),this.render(),this.refreshing=!1},r.prototype.accessMount=function(){this.mount&&!this.isReactHybrid&&this.mount()},r.prototype.getRootElement=function(){return this.isReactHybrid?this.actualElement:this.element},r.prototype.getLocalData=function(){var t=this.getModuleName()+this.element.id;return e.versionBasedStatePersistence?window.localStorage.getItem(t+this.ej2StatePersistenceVersion):window.localStorage.getItem(t)},r.prototype.appendTo=function(e){if(g(e)||"string"!=typeof e?g(e)||(this.element=e):this.element=ye(e,document),!g(this.element)){var i="e-"+this.getModuleName().toLowerCase();de([this.element],["e-control",i]),this.isProtectedOnChange=!1,this.needsID&&!this.element.id&&(this.element.id=this.getUniqueID(this.getModuleName())),this.enablePersistence&&(this.mergePersistData(),window.addEventListener("unload",this.setPersistData.bind(this)));var r=a("ej2_instances",this.element);r&&-1!==r.indexOf(this)||t.prototype.addInstance.call(this),this.preRender(),this.injectModules(),yt||vt||(ct(),vt=!0),this.render(),this.mount?this.accessMount():this.trigger("created")}},r.prototype.renderComplete=function(e){if(b()){window.sfBlazor.renderComplete(this.element,e)}this.isRendered=!0},r.prototype.dataBind=function(){this.injectModules(),t.prototype.dataBind.call(this)},r.prototype.on=function(e,t,i){if("string"==typeof e)this.localObserver.on(e,t,i);else for(var r=0,n=e;r<n.length;r++){var o=n[r];this.localObserver.on(o.event,o.handler,o.context)}},r.prototype.off=function(e,t){if("string"==typeof e)this.localObserver.off(e,t);else for(var i=0,r=e;i<r.length;i++){var n=r[i];this.localObserver.off(n.event,n.handler)}},r.prototype.notify=function(e,t){!0!==this.isDestroyed&&this.localObserver.notify(e,t)},r.prototype.getInjectedModules=function(){return this.injectedModules},r.Inject=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.prototype.injectedModules||(this.prototype.injectedModules=[]);for(var i=0;i<e.length;i++)-1===this.prototype.injectedModules.indexOf(e[parseInt(i.toString(),10)])&&this.prototype.injectedModules.push(e[parseInt(i.toString(),10)])},r.prototype.createElement=function(e,t,i){return he(e,t)},r.prototype.triggerStateChange=function(e,t){this.isReactHybrid&&(this.setState(),this.currentContext={calls:e,args:t})},r.prototype.injectModules=function(){this.injectedModules&&this.injectedModules.length&&this.moduleLoader.inject(this.requiredModules(),this.injectedModules)},r.prototype.detectFunction=function(e){var t=Object.keys(e);t.length&&(this[t[0]]=e[t[0]])},r.prototype.mergePersistData=function(){var t;g(t=e.versionBasedStatePersistence?window.localStorage.getItem(this.getModuleName()+this.element.id+this.ej2StatePersistenceVersion):window.localStorage.getItem(this.getModuleName()+this.element.id))||""===t||this.setProperties(JSON.parse(t),!0)},r.prototype.setPersistData=function(){this.isDestroyed||(e.versionBasedStatePersistence?window.localStorage.setItem(this.getModuleName()+this.element.id+this.ej2StatePersistenceVersion,this.getPersistData()):window.localStorage.setItem(this.getModuleName()+this.element.id,this.getPersistData()))},r.prototype.renderReactTemplates=function(e){g(e)||e()},r.prototype.clearTemplate=function(e,t){},r.prototype.getUniqueID=function(e){return this.isHistoryChanged()&&(gt=0),ht=this.pageID(location.href),ft=history.length,e+"_"+ht+"_"+gt++},r.prototype.pageID=function(e){var t=0;if(0===e.length)return t;for(var i=0;i<e.length;i++){t=(t<<5)-t+e.charCodeAt(i),t&=t}return Math.abs(t)},r.prototype.isHistoryChanged=function(){return ht!==this.pageID(location.href)||ft!==history.length},r.prototype.addOnPersist=function(e){for(var t=this,i={},r=0,n=e;r<n.length;r++){var o,s=n[r];f(o=a(s,this))||l(s,this.getActualProperties(o),i)}return JSON.stringify(i,(function(e,i){return t.getActualProperties(i)}))},r.prototype.getActualProperties=function(e){return e instanceof tt?a("properties",e):e},r.prototype.ignoreOnPersist=function(e){return JSON.stringify(this.iterateJsonProperties(this.properties,e))},r.prototype.iterateJsonProperties=function(e,t){for(var r={},n=function(n){if(-1===t.indexOf(n)){var s=e[n];if("object"!==i(s)||s instanceof Array)r[""+n]=s;else{var a=t.filter((function(e){return new RegExp(n+".").test(e)})).map((function(e){return e.replace(n+".","")}));r[""+n]=o.iterateJsonProperties(o.getActualProperties(s),a)}}},o=this,s=0,a=Object.keys(e);s<a.length;s++){n(a[s])}return r},ut([Ue(!1)],r.prototype,"enablePersistence",void 0),ut([Ue()],r.prototype,"enableRtl",void 0),ut([Ue()],r.prototype,"locale",void 0),r=ut([_e],r)}(Ie);"undefined"!=typeof window&&window.addEventListener("popstate",(function(){gt=0}));var wt,xt,Mt,Nt,It=(wt=function(e,t){return(wt=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}wt(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),St=function(e,t,r,n){var o,s=arguments.length,a=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(s<3?o(a):s>3?o(t,r,a):o(t,r))||a);return s>3&&a&&Object.defineProperty(t,r,a),a},Ct={left:0,top:0,bottom:0,right:0},Ot={isDragged:!1},Tt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return It(t,e),St([Ue(0)],t.prototype,"left",void 0),St([Ue(0)],t.prototype,"top",void 0),t}(tt),Pt=function(e){function t(t,i){var n=e.call(this,i,t)||this;return n.dragLimit=r.getDefaultPosition(),n.borderWidth=r.getDefaultPosition(),n.padding=r.getDefaultPosition(),n.diffX=0,n.prevLeft=0,n.prevTop=0,n.dragProcessStarted=!1,n.eleTop=0,n.tapHoldTimer=0,n.externalInitialize=!1,n.diffY=0,n.parentScrollX=0,n.parentScrollY=0,n.droppables={},n.bind(),n}var r;return It(t,e),r=t,t.prototype.bind=function(){this.toggleEvents(),se.isIE&&de([this.element],"e-block-touch"),this.droppables[this.scope]={}},t.getDefaultPosition=function(){return u({},Ct)},t.prototype.toggleEvents=function(e){var t;f(this.handle)||(t=ye(this.handle,this.element));var i=this.enableTapHold&&se.isDevice&&se.isTouch?this.mobileInitialize:this.initialize;e?ae.remove(t||this.element,se.touchStartEvent,i):ae.add(t||this.element,se.touchStartEvent,i,this)},t.prototype.mobileInitialize=function(e){var t=this,i=e.currentTarget;this.tapHoldTimer=setTimeout((function(){t.externalInitialize=!0,t.removeTapholdTimer(),t.initialize(e,i)}),this.tapHoldThreshold),ae.add(document,se.touchMoveEvent,this.removeTapholdTimer,this),ae.add(document,se.touchEndEvent,this.removeTapholdTimer,this)},t.prototype.removeTapholdTimer=function(){clearTimeout(this.tapHoldTimer),ae.remove(document,se.touchMoveEvent,this.removeTapholdTimer),ae.remove(document,se.touchEndEvent,this.removeTapholdTimer)},t.prototype.getScrollableParent=function(e,t){return g(e)?null:e[{vertical:"scrollHeight",horizontal:"scrollWidth"}[""+t]]>e[{vertical:"clientHeight",horizontal:"clientWidth"}[""+t]]&&("vertical"===t?e.scrollTop>0:e.scrollLeft>0)?("vertical"===t?(this.parentScrollY=this.parentScrollY+(0===this.parentScrollY?e.scrollTop:e.scrollTop-this.parentScrollY),this.tempScrollHeight=e.scrollHeight):(this.parentScrollX=this.parentScrollX+(0===this.parentScrollX?e.scrollLeft:e.scrollLeft-this.parentScrollX),this.tempScrollWidth=e.scrollWidth),g(e)?e:this.getScrollableParent(e.parentNode,t)):this.getScrollableParent(e.parentNode,t)},t.prototype.getScrollableValues=function(){this.parentScrollX=0,this.parentScrollY=0;this.element.classList.contains("e-dialog")&&this.element.classList.contains("e-dlg-modal"),this.getScrollableParent(this.element.parentNode,"vertical"),this.getScrollableParent(this.element.parentNode,"horizontal")},t.prototype.initialize=function(e,t){if(this.currentStateTarget=e.target,!this.isDragStarted()){if(this.isDragStarted(!0),this.externalInitialize=!1,this.target=e.currentTarget||t,this.dragProcessStarted=!1,this.abort){var i=this.abort;"string"==typeof i&&(i=[i]);for(var r=0;r<i.length;r++)if(!g(we(e.target,i[parseInt(r.toString(),10)])))return void(this.isDragStarted()&&this.isDragStarted(!0))}this.preventDefault&&!f(e.changedTouches)&&"touchstart"!==e.type&&e.preventDefault(),this.element.setAttribute("aria-grabbed","true");var n=this.getCoordinates(e);if(this.initialPosition={x:n.pageX,y:n.pageY},!this.clone){var o=this.element.getBoundingClientRect();this.getScrollableValues(),e.clientX===e.pageX&&(this.parentScrollX=0),e.clientY===e.pageY&&(this.parentScrollY=0),this.relativeXPosition=n.pageX-(o.left+this.parentScrollX),this.relativeYPosition=n.pageY-(o.top+this.parentScrollY)}this.externalInitialize?this.intDragStart(e):(ae.add(document,se.touchMoveEvent,this.intDragStart,this),ae.add(document,se.touchEndEvent,this.intDestroy,this)),this.toggleEvents(!0),"touchstart"!==e.type&&this.isPreventSelect&&document.body.classList.add("e-prevent-select"),this.externalInitialize=!1,ae.trigger(document.documentElement,se.touchStartEvent,e)}},t.prototype.intDragStart=function(e){this.removeTapholdTimer();var t=!f(e.changedTouches);if(!t||1===e.changedTouches.length){var i,r=this.getCoordinates(e),n=getComputedStyle(this.element);this.margin={left:parseInt(n.marginLeft,10),top:parseInt(n.marginTop,10),right:parseInt(n.marginRight,10),bottom:parseInt(n.marginBottom,10)};var o=this.element;if(this.clone&&this.dragTarget){var s=we(e.target,this.dragTarget);g(s)||(o=s)}this.isReplaceDragEle&&(o=this.currentStateCheck(e.target,o)),this.offset=this.calculateParentPosition(o),this.position=this.getMousePosition(e,this.isDragScroll);var a=this.initialPosition.x-r.pageX,l=this.initialPosition.y-r.pageY;if(Math.sqrt(a*a+l*l)>=this.distance||this.externalInitialize){var h=this.getHelperElement(e);if(!h||g(h))return;t&&e.preventDefault();var d=this.helperElement=h;if(this.parentClientRect=this.calculateParentPosition(d.offsetParent),this.dragStart){var c={event:e,element:o,target:this.getProperTargetElement(e),bindEvents:b()?this.bindDragEvents.bind(this):null,dragElement:d};this.trigger("dragStart",c)}this.dragArea?this.setDragArea():(this.dragLimit={left:0,right:0,bottom:0,top:0},this.borderWidth={top:0,left:0}),i={left:this.position.left-this.parentClientRect.left,top:this.position.top-this.parentClientRect.top},this.clone&&!this.enableTailMode&&(this.diffX=this.position.left-this.offset.left,this.diffY=this.position.top-this.offset.top),this.getScrollableValues();var p=getComputedStyle(o),u=parseFloat(p.marginTop);this.clone&&0!==u&&(i.top+=u),this.eleTop=isNaN(parseFloat(p.top))?0:parseFloat(p.top)-this.offset.top,this.enableScrollHandler&&!this.clone&&(i.top-=this.parentScrollY,i.left-=this.parentScrollX);var m=this.getProcessedPositionValue({top:i.top-this.diffY+"px",left:i.left-this.diffX+"px"});this.dragArea&&"string"!=typeof this.dragArea&&this.dragArea.classList.contains("e-kanban-content")&&"relative"===this.dragArea.style.position&&(i.top+=this.dragArea.scrollTop),this.dragElePosition={top:i.top,left:i.left},xe(d,this.getDragPosition({position:"absolute",left:m.left,top:m.top})),ae.remove(document,se.touchMoveEvent,this.intDragStart),ae.remove(document,se.touchEndEvent,this.intDestroy),b()||this.bindDragEvents(d)}}},t.prototype.bindDragEvents=function(e){ue(e)?(ae.add(document,se.touchMoveEvent,this.intDrag,this),ae.add(document,se.touchEndEvent,this.intDragStop,this),this.setGlobalDroppables(!1,this.element,e)):(this.toggleEvents(),document.body.classList.remove("e-prevent-select"))},t.prototype.elementInViewport=function(e){for(this.top=e.offsetTop,this.left=e.offsetLeft,this.width=e.offsetWidth,this.height=e.offsetHeight;e.offsetParent;)e=e.offsetParent,this.top+=e.offsetTop,this.left+=e.offsetLeft;return this.top>=window.pageYOffset&&this.left>=window.pageXOffset&&this.top+this.height<=window.pageYOffset+window.innerHeight&&this.left+this.width<=window.pageXOffset+window.innerWidth},t.prototype.getProcessedPositionValue=function(e){return this.queryPositionInfo?this.queryPositionInfo(e):e},t.prototype.calculateParentPosition=function(e){if(g(e))return{left:0,top:0};var t=e.getBoundingClientRect(),i=getComputedStyle(e);return{left:t.left+window.pageXOffset-parseInt(i.marginLeft,10),top:t.top+window.pageYOffset-parseInt(i.marginTop,10)}},t.prototype.intDrag=function(e){if(f(e.changedTouches)||1===e.changedTouches.length){var t,i;this.clone&&e.changedTouches&&se.isDevice&&se.isTouch&&e.preventDefault(),this.position=this.getMousePosition(e,this.isDragScroll);var r=this.getDocumentWidthHeight("Height");r<this.position.top&&(this.position.top=r);var n=this.getDocumentWidthHeight("Width");if(n<this.position.left&&(this.position.left=n),this.drag){var o=this.getProperTargetElement(e);this.trigger("drag",{event:e,element:this.element,target:o})}var s=this.checkTargetElement(e);if(s.target&&s.instance){var a=!0;this.hoverObject&&(this.hoverObject.instance!==s.instance?this.triggerOutFunction(e,s):a=!1),a&&(s.instance.dragData[this.scope]=this.droppables[this.scope],s.instance.intOver(e,s.target),this.hoverObject=s)}else this.hoverObject&&this.triggerOutFunction(e,s);var l=this.droppables[this.scope].helper;this.parentClientRect=this.calculateParentPosition(this.helperElement.offsetParent);var h=this.parentClientRect.left,d=this.parentClientRect.top,c=this.getCoordinates(e),p=c.pageX,u=c.pageY,m=this.position.left-this.diffX,y=this.position.top-this.diffY,v=getComputedStyle(l);if(this.dragArea){if(this.pageX!==p||this.skipDistanceCheck){var b=l.offsetWidth+(parseFloat(v.marginLeft)+parseFloat(v.marginRight));t=this.dragLimit.left>m&&m>0?this.dragLimit.left:this.dragLimit.right+window.pageXOffset<m+b&&m>0?m-(m-this.dragLimit.right)+window.pageXOffset-b:m<0?this.dragLimit.left:m}if(this.pageY!==u||this.skipDistanceCheck){var w=l.offsetHeight+(parseFloat(v.marginTop)+parseFloat(v.marginBottom));i=this.dragLimit.top>y&&y>0?this.dragLimit.top:this.dragLimit.bottom+window.pageYOffset<y+w&&y>0?y-(y-this.dragLimit.bottom)+window.pageYOffset-w:y<0?this.dragLimit.top:y}}else t=m,i=y;var x,M,N=d+this.borderWidth.top,I=h+this.borderWidth.left;this.dragProcessStarted&&(g(i)&&(i=this.prevTop),g(t)&&(t=this.prevLeft)),this.helperElement.classList.contains("e-treeview")?this.dragArea?(this.dragLimit.top=this.clone?this.dragLimit.top:0,x=i-N<0?this.dragLimit.top:i-this.borderWidth.top,M=t-I<0?this.dragLimit.left:t-this.borderWidth.left):(x=i-this.borderWidth.top,M=t-this.borderWidth.left):this.dragArea?(this.dragLimit.top=this.clone?this.dragLimit.top:0,x=i-N<0?this.dragLimit.top:i-N,M=t-I<0?this.dragElePosition.left:t-I):(x=i-N,M=t-I);var S=parseFloat(getComputedStyle(this.element).marginTop);if(S>0&&(this.clone&&(x+=S,y<0&&(S+y>=0?x=S+y:x-=S),x=this.dragLimit.bottom<x?this.dragLimit.bottom:x),i-N<0))if(y+S+(l.offsetHeight-N)>=0){var C=this.dragLimit.top+y-N;C+S+N<0?x-=S+N:x=C}else x-=S+N;if(this.dragArea&&this.helperElement.classList.contains("e-treeview"))x=x+(w=l.offsetHeight+(parseFloat(v.marginTop)+parseFloat(v.marginBottom)))>this.dragLimit.bottom?this.dragLimit.bottom-w:x;this.enableScrollHandler&&!this.clone&&(x-=this.parentScrollY,M-=this.parentScrollX),this.dragArea&&"string"!=typeof this.dragArea&&this.dragArea.classList.contains("e-kanban-content")&&"relative"===this.dragArea.style.position&&(x+=this.dragArea.scrollTop);var O=this.getProcessedPositionValue({top:x+"px",left:M+"px"});xe(l,this.getDragPosition(O)),this.elementInViewport(l)||!this.enableAutoScroll||this.helperElement.classList.contains("e-treeview")||this.helperElement.scrollIntoView();var T=document.querySelectorAll(":hover");if(this.enableAutoScroll&&this.helperElement.classList.contains("e-treeview")){0===T.length&&(T=this.getPathElements(e));var P=this.getScrollParent(T,!1);this.elementInViewport(this.helperElement)?this.getScrollPosition(P,x):this.elementInViewport(this.helperElement)||(0===(T=[].slice.call(document.querySelectorAll(":hover"))).length&&(T=this.getPathElements(e)),P=this.getScrollParent(T,!0),this.getScrollPosition(P,x))}this.dragProcessStarted=!0,this.prevLeft=t,this.prevTop=i,this.position.left=t,this.position.top=i,this.pageX=p,this.pageY=u}},t.prototype.getScrollParent=function(e,t){for(var i,r=t?e.reverse():e,n=r.length-1;n>=0;n--)if(("auto"===(i=window.getComputedStyle(r[parseInt(n.toString(),10)])["overflow-y"])||"scroll"===i)&&r[parseInt(n.toString(),10)].scrollHeight>r[parseInt(n.toString(),10)].clientHeight)return r[parseInt(n.toString(),10)];if("visible"===(i=window.getComputedStyle(document.scrollingElement)["overflow-y"]))return document.scrollingElement.style.overflow="auto",document.scrollingElement},t.prototype.getScrollPosition=function(e,t){e&&e===document.scrollingElement?e.clientHeight+document.scrollingElement.scrollTop-this.helperElement.clientHeight<t&&e.getBoundingClientRect().height+this.parentClientRect.top>t?e.scrollTop+=this.helperElement.clientHeight:e.scrollTop>t-this.helperElement.clientHeight&&(e.scrollTop-=this.helperElement.clientHeight):e&&e!==document.scrollingElement&&(e.clientHeight+e.getBoundingClientRect().top-this.helperElement.clientHeight+document.scrollingElement.scrollTop<t?e.scrollTop+=this.helperElement.clientHeight:e.getBoundingClientRect().top>t-this.helperElement.clientHeight-document.scrollingElement.scrollTop&&(e.scrollTop-=this.helperElement.clientHeight))},t.prototype.getPathElements=function(e){var t=e.clientX>0?e.clientX:0,i=e.clientY>0?e.clientY:0;return document.elementsFromPoint(t,i)},t.prototype.triggerOutFunction=function(e,t){this.hoverObject.instance.intOut(e,t.target),this.hoverObject.instance.dragData[this.scope]=null,this.hoverObject=null},t.prototype.getDragPosition=function(e){var t=u({},e);return this.axis&&("x"===this.axis?delete t.top:"y"===this.axis&&delete t.left),t},t.prototype.getDocumentWidthHeight=function(e){var t=document.body,i=document.documentElement;return Math.max(t["scroll"+e],i["scroll"+e],t["offset"+e],i["offset"+e],i["client"+e])},t.prototype.intDragStop=function(e){if(this.dragProcessStarted=!1,f(e.changedTouches)||1===e.changedTouches.length){if(-1!==["touchend","pointerup","mouseup"].indexOf(e.type)){if(this.dragStop){var t=this.getProperTargetElement(e);this.trigger("dragStop",{event:e,element:this.element,target:t,helper:this.helperElement})}this.intDestroy(e)}else this.element.setAttribute("aria-grabbed","false");var i=this.checkTargetElement(e);i.target&&i.instance&&(i.instance.dragStopCalled=!0,i.instance.dragData[this.scope]=this.droppables[this.scope],i.instance.intDrop(e,i.target)),this.setGlobalDroppables(!0),document.body.classList.remove("e-prevent-select")}},t.prototype.intDestroy=function(e){this.dragProcessStarted=!1,this.toggleEvents(),document.body.classList.remove("e-prevent-select"),this.element.setAttribute("aria-grabbed","false"),ae.remove(document,se.touchMoveEvent,this.intDragStart),ae.remove(document,se.touchEndEvent,this.intDragStop),ae.remove(document,se.touchEndEvent,this.intDestroy),ae.remove(document,se.touchMoveEvent,this.intDrag),this.isDragStarted()&&this.isDragStarted(!0)},t.prototype.onPropertyChanged=function(e,t){},t.prototype.getModuleName=function(){return"draggable"},t.prototype.isDragStarted=function(e){return e&&(Ot.isDragged=!Ot.isDragged),Ot.isDragged},t.prototype.setDragArea=function(){var e,t,r,n=0,o=0;if(r="string"===i(this.dragArea)?ye(this.dragArea):this.dragArea){var s=r.getBoundingClientRect();e=r.scrollWidth?r.scrollWidth:s.right-s.left,t=r.scrollHeight?this.dragArea&&!g(this.helperElement)&&this.helperElement.classList.contains("e-treeview")?r.clientHeight:r.scrollHeight:s.bottom-s.top;for(var a=["Top","Left","Bottom","Right"],l=getComputedStyle(r),h=0;h<a.length;h++){var d=a[parseInt(h.toString(),10)],c=l["border"+d+"Width"],p=l["padding"+d],u=d.toLowerCase();this.borderWidth[""+u]=isNaN(parseFloat(c))?0:parseFloat(c),this.padding[""+u]=isNaN(parseFloat(p))?0:parseFloat(p)}n=this.dragArea&&!g(this.helperElement)&&this.helperElement.classList.contains("e-treeview")?s.top+document.scrollingElement.scrollTop:s.top,o=s.left,this.dragLimit.left=o+this.borderWidth.left+this.padding.left,this.dragLimit.top=r.offsetTop+this.borderWidth.top+this.padding.top,this.dragLimit.right=o+e-(this.borderWidth.right+this.padding.right),this.dragLimit.bottom=n+t-(this.borderWidth.bottom+this.padding.bottom)}},t.prototype.getProperTargetElement=function(e){var t,i=this.getCoordinates(e),r=this.helperElement.style.pointerEvents||"",n=-1!==e.type.indexOf("pointer")&&"safari"===se.info.name&&parseInt(se.info.version)>12;return y(e.target,this.helperElement)||-1!==e.type.indexOf("touch")||n?(this.helperElement.style.pointerEvents="none",t=document.elementFromPoint(i.clientX,i.clientY),this.helperElement.style.pointerEvents=r):t=e.target,t},t.prototype.currentStateCheck=function(e,t){return g(this.currentStateTarget)||this.currentStateTarget===e?g(t)?e:t:this.currentStateTarget},t.prototype.getMousePosition=function(e,t){var i,r,n=void 0!==e.srcElement?e.srcElement:e.target,o=this.getCoordinates(e),s=g(n.offsetParent);if(t?(i=this.clone?o.pageX:o.pageX+(s?0:n.offsetParent.scrollLeft)-this.relativeXPosition,r=this.clone?o.pageY:o.pageY+(s?0:n.offsetParent.scrollTop)-this.relativeYPosition):(i=this.clone?o.pageX:o.pageX+window.pageXOffset-this.relativeXPosition,r=this.clone?o.pageY:o.pageY+window.pageYOffset-this.relativeYPosition),this.element&&this.element.classList.length>0&&-1===this.element.classList.value.indexOf("e-dialog")&&document.scrollingElement){var a=document.scrollingElement.scrollHeight>0&&document.scrollingElement.scrollHeight>document.scrollingElement.clientHeight&&document.scrollingElement.scrollTop>0;i=document.scrollingElement.scrollWidth>0&&document.scrollingElement.scrollWidth>document.scrollingElement.clientWidth&&document.scrollingElement.scrollLeft>0?i-document.scrollingElement.scrollLeft:i,r=a?r-document.scrollingElement.scrollTop:r}return{left:i-(this.margin.left+this.cursorAt.left),top:r-(this.margin.top+this.cursorAt.top)}},t.prototype.getCoordinates=function(e){return e.type.indexOf("touch")>-1?e.changedTouches[0]:e},t.prototype.getHelperElement=function(e){var t;return this.clone?this.helper?t=this.helper({sender:e,element:this.target}):(t=he("div",{className:"e-drag-helper e-block-touch",innerHTML:"Draggable"}),document.body.appendChild(t)):t=this.element,t},t.prototype.setGlobalDroppables=function(e,t,i){this.droppables[this.scope]=e?null:{draggable:t,helper:i,draggedElement:this.element}},t.prototype.checkTargetElement=function(e){var t=this.getProperTargetElement(e),i=this.getDropInstance(t);if(!i&&t&&!g(t.parentNode)){var r=we(t.parentNode,".e-droppable")||t.parentElement;r&&(i=this.getDropInstance(r))}return{target:t,instance:i}},t.prototype.getDropInstance=function(e){var t,i=e&&e.ej2_instances;if(i)for(var r=0,n=i;r<n.length;r++){var o=n[r];if("droppable"===o.getModuleName()){t=o;break}}return t},t.prototype.destroy=function(){this.toggleEvents(!0),e.prototype.destroy.call(this)},St([He({},Tt)],t.prototype,"cursorAt",void 0),St([Ue(!0)],t.prototype,"clone",void 0),St([Ue()],t.prototype,"dragArea",void 0),St([Ue()],t.prototype,"isDragScroll",void 0),St([Ue()],t.prototype,"isReplaceDragEle",void 0),St([Ue(!0)],t.prototype,"isPreventSelect",void 0),St([Be()],t.prototype,"drag",void 0),St([Be()],t.prototype,"dragStart",void 0),St([Be()],t.prototype,"dragStop",void 0),St([Ue(1)],t.prototype,"distance",void 0),St([Ue()],t.prototype,"handle",void 0),St([Ue()],t.prototype,"abort",void 0),St([Ue()],t.prototype,"helper",void 0),St([Ue("default")],t.prototype,"scope",void 0),St([Ue("")],t.prototype,"dragTarget",void 0),St([Ue()],t.prototype,"axis",void 0),St([Ue()],t.prototype,"queryPositionInfo",void 0),St([Ue(!1)],t.prototype,"enableTailMode",void 0),St([Ue(!1)],t.prototype,"skipDistanceCheck",void 0),St([Ue(!0)],t.prototype,"preventDefault",void 0),St([Ue(!1)],t.prototype,"enableAutoScroll",void 0),St([Ue(!1)],t.prototype,"enableTapHold",void 0),St([Ue(750)],t.prototype,"tapHoldThreshold",void 0),St([Ue(!1)],t.prototype,"enableScrollHandler",void 0),t=r=St([_e],t)}(Ie),At=(xt=function(e,t){return(xt=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}xt(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),Lt=function(e,t,r,n){var o,s=arguments.length,a=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(s<3?o(a):s>3?o(t,r,a):o(t,r))||a);return s>3&&a&&Object.defineProperty(t,r,a),a},Ft=function(e){function t(t,i){var r=e.call(this,i,t)||this;return r.mouseOver=!1,r.dragData={},r.dragStopCalled=!1,r.bind(),r}return At(t,e),t.prototype.bind=function(){this.wireEvents()},t.prototype.wireEvents=function(){ae.add(this.element,se.touchEndEvent,this.intDrop,this)},t.prototype.onPropertyChanged=function(e,t){},t.prototype.getModuleName=function(){return"droppable"},t.prototype.intOver=function(e,t){if(!this.mouseOver){var i=this.dragData[this.scope];this.trigger("over",{event:e,target:t,dragData:i}),this.mouseOver=!0}},t.prototype.intOut=function(e,t){this.mouseOver&&(this.trigger("out",{evt:e,target:t}),this.mouseOver=!1)},t.prototype.intDrop=function(e,t){if(this.dragStopCalled){this.dragStopCalled=!1;var i,r=!0,n=this.dragData[this.scope],o=!!n&&(n.helper&&ue(n.helper));o&&(i=this.isDropArea(e,n.helper,t),this.accept&&(r=Me(n.helper,this.accept))),o&&this.drop&&i.canDrop&&r&&this.trigger("drop",{event:e,target:i.target,droppedElement:n.helper,dragData:n}),this.mouseOver=!1}},t.prototype.isDropArea=function(e,t,i){var r={canDrop:!0,target:i||e.target},n="touchend"===e.type;if(n||r.target===t){t.style.display="none";var o=n?e.changedTouches[0]:e,s=document.elementFromPoint(o.clientX,o.clientY);r.canDrop=!1,r.canDrop=y(s,this.element),r.canDrop&&(r.target=s),t.style.display=""}return r},t.prototype.destroy=function(){ae.remove(this.element,se.touchEndEvent,this.intDrop),e.prototype.destroy.call(this)},Lt([Ue()],t.prototype,"accept",void 0),Lt([Ue("default")],t.prototype,"scope",void 0),Lt([Be()],t.prototype,"drop",void 0),Lt([Be()],t.prototype,"over",void 0),Lt([Be()],t.prototype,"out",void 0),t=Lt([_e],t)}(Ie),Dt=(Mt=function(e,t){return(Mt=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}Mt(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),Et=function(e,t,r,n){var o,s=arguments.length,a=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(s<3?o(a):s>3?o(t,r,a):o(t,r))||a);return s>3&&a&&Object.defineProperty(t,r,a),a},zt={backspace:8,tab:9,enter:13,shift:16,control:17,alt:18,pause:19,capslock:20,space:32,escape:27,pageup:33,pagedown:34,end:35,home:36,leftarrow:37,uparrow:38,rightarrow:39,downarrow:40,insert:45,delete:46,f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123,semicolon:186,plus:187,comma:188,minus:189,dot:190,forwardslash:191,graveaccent:192,openbracket:219,backslash:220,closebracket:221,singlequote:222},kt=function(e){function t(t,r){var n=e.call(this,r,t)||this;return n.keyPressHandler=function(e){for(var t=e.altKey,r=e.ctrlKey,o=e.shiftKey,s=e.which,a=0,l=Object.keys(n.keyConfigs);a<l.length;a++)for(var h=l[a],d=0,c=n.keyConfigs[""+h].split(",");d<c.length;d++){var p=c[d],u=i.getKeyConfigData(p.trim());t===u.altKey&&r===u.ctrlKey&&o===u.shiftKey&&s===u.keyCode&&(e.action=h,n.keyAction&&n.keyAction(e))}},n.bind(),n}var i;return Dt(t,e),i=t,t.prototype.destroy=function(){this.unwireEvents(),e.prototype.destroy.call(this)},t.prototype.onPropertyChanged=function(e,t){},t.prototype.bind=function(){this.wireEvents()},t.prototype.getModuleName=function(){return"keyboard"},t.prototype.wireEvents=function(){this.element.addEventListener(this.eventName,this.keyPressHandler)},t.prototype.unwireEvents=function(){this.element.removeEventListener(this.eventName,this.keyPressHandler)},t.getKeyConfigData=function(e){if(e in this.configCache)return this.configCache[""+e];var t=e.toLowerCase().split("+"),r={altKey:-1!==t.indexOf("alt"),ctrlKey:-1!==t.indexOf("ctrl"),shiftKey:-1!==t.indexOf("shift"),keyCode:null};return t[t.length-1].length>1&&Number(t[t.length-1])?r.keyCode=Number(t[t.length-1]):r.keyCode=i.getKeyCode(t[t.length-1]),i.configCache[""+e]=r,r},t.getKeyCode=function(e){return zt[""+e]||e.toUpperCase().charCodeAt(0)},t.configCache={},Et([Ue({})],t.prototype,"keyConfigs",void 0),Et([Ue("keyup")],t.prototype,"eventName",void 0),Et([Be()],t.prototype,"keyAction",void 0),t=i=Et([_e],t)}(Ie),Wt=function(){function t(t,i,r){this.controlName=t,this.localeStrings=i,this.setLocale(r||e.defaultCulture)}return t.prototype.setLocale=function(e){var i=this.intGetControlConstant(t.locale,e);this.currentLocale=i||this.localeStrings},t.load=function(e){this.locale=u(this.locale,e,{},!0)},t.prototype.getConstant=function(e){return g(this.currentLocale[""+e])?this.localeStrings[""+e]||"":this.currentLocale[""+e]},t.prototype.intGetControlConstant=function(e,t){return e[""+t]?e[""+t][this.controlName]:null},t.locale={},t}(),Rt=(Nt=function(e,t){return(Nt=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}Nt(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),jt=function(e,t,r,n){var o,s=arguments.length,a=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(s<3?o(a):s>3?o(t,r,a):o(t,r))||a);return s>3&&a&&Object.defineProperty(t,r,a),a},Ut=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Rt(t,e),jt([Ue(50)],t.prototype,"swipeThresholdDistance",void 0),t}(tt),Ht=/(Up|Down)/,Bt=function(e){function t(t,i){var r=e.call(this,i,t)||this;return r.touchAction=!0,r.tapCount=0,r.startEvent=function(e){if(!0===r.touchAction){var t=r.updateChangeTouches(e);void 0!==e.changedTouches&&(r.touchAction=!1),r.isTouchMoved=!1,r.movedDirection="",r.startPoint=r.lastMovedPoint={clientX:t.clientX,clientY:t.clientY},r.startEventData=t,r.hScrollLocked=r.vScrollLocked=!1,r.tStampStart=Date.now(),r.timeOutTapHold=setTimeout((function(){r.tapHoldEvent(e)}),r.tapHoldThreshold),ae.add(r.element,se.touchMoveEvent,r.moveEvent,r),ae.add(r.element,se.touchEndEvent,r.endEvent,r),ae.add(r.element,se.touchCancelEvent,r.cancelEvent,r)}},r.moveEvent=function(e){var t=r.updateChangeTouches(e);r.movedPoint=t,r.isTouchMoved=!(t.clientX===r.startPoint.clientX&&t.clientY===r.startPoint.clientY);var i={};r.isTouchMoved&&(clearTimeout(r.timeOutTapHold),r.calcScrollPoints(e),i=u(i,{},{startEvents:r.startEventData,originalEvent:e,startX:r.startPoint.clientX,startY:r.startPoint.clientY,distanceX:r.distanceX,distanceY:r.distanceY,scrollDirection:r.scrollDirection,velocity:r.getVelocity(t)}),r.trigger("scroll",i),r.lastMovedPoint={clientX:t.clientX,clientY:t.clientY})},r.cancelEvent=function(e){clearTimeout(r.timeOutTapHold),clearTimeout(r.timeOutTap),r.tapCount=0,r.swipeFn(e),ae.remove(r.element,se.touchCancelEvent,r.cancelEvent)},r.endEvent=function(e){r.swipeFn(e),r.isTouchMoved||"function"==typeof r.tap&&(r.trigger("tap",{originalEvent:e,tapCount:++r.tapCount}),r.timeOutTap=setTimeout((function(){r.tapCount=0}),r.tapThreshold)),r.modeclear()},r.swipeFn=function(e){clearTimeout(r.timeOutTapHold),clearTimeout(r.timeOutTap);var t=r.updateChangeTouches(e),i=t.clientX-r.startPoint.clientX,n=t.clientY-r.startPoint.clientY;i=Math.floor(i<0?-1*i:i),n=Math.floor(n<0?-1*n:i),r.isTouchMoved=i>1||n>1,/Firefox/.test(se.userAgent)&&0===t.clientX&&0===t.clientY&&"mouseup"===e.type&&(r.isTouchMoved=!1),r.endPoint=t,r.calcPoints(e);var o={originalEvent:e,startEvents:r.startEventData,startX:r.startPoint.clientX,startY:r.startPoint.clientY,distanceX:r.distanceX,distanceY:r.distanceY,swipeDirection:r.movedDirection,velocity:r.getVelocity(t)};if(r.isTouchMoved){var s=void 0,a=r.swipeSettings.swipeThresholdDistance;s=u(s,r.defaultArgs,o);var l=!1,h=r.element,d=r.isScrollable(h),c=Ht.test(r.movedDirection);(a<r.distanceX&&!c||a<r.distanceY&&c)&&(l=!d||r.checkSwipe(h,c)),l&&r.trigger("swipe",s)}r.modeclear()},r.modeclear=function(){r.modeClear=setTimeout((function(){r.touchAction=!0}),"function"!=typeof r.tap?0:20),r.lastTapTime=(new Date).getTime(),ae.remove(r.element,se.touchMoveEvent,r.moveEvent),ae.remove(r.element,se.touchEndEvent,r.endEvent),ae.remove(r.element,se.touchCancelEvent,r.cancelEvent)},r.bind(),r}return Rt(t,e),t.prototype.onPropertyChanged=function(e,t){},t.prototype.bind=function(){this.wireEvents(),se.isIE&&this.element.classList.add("e-block-touch")},t.prototype.destroy=function(){this.unwireEvents(),e.prototype.destroy.call(this)},t.prototype.wireEvents=function(){ae.add(this.element,se.touchStartEvent,this.startEvent,this)},t.prototype.unwireEvents=function(){ae.remove(this.element,se.touchStartEvent,this.startEvent)},t.prototype.getModuleName=function(){return"touch"},t.prototype.isScrollable=function(e){var t=getComputedStyle(e),i=t.overflow+t.overflowX+t.overflowY;return!!/(auto|scroll)/.test(i)},t.prototype.tapHoldEvent=function(e){var t;this.tapCount=0,this.touchAction=!0,ae.remove(this.element,se.touchMoveEvent,this.moveEvent),ae.remove(this.element,se.touchEndEvent,this.endEvent),t={originalEvent:e},this.trigger("tapHold",t),ae.remove(this.element,se.touchCancelEvent,this.cancelEvent)},t.prototype.calcPoints=function(e){var t=this.updateChangeTouches(e);this.defaultArgs={originalEvent:e},this.distanceX=Math.abs(Math.abs(t.clientX)-Math.abs(this.startPoint.clientX)),this.distanceY=Math.abs(Math.abs(t.clientY)-Math.abs(this.startPoint.clientY)),this.distanceX>this.distanceY?this.movedDirection=t.clientX>this.startPoint.clientX?"Right":"Left":this.movedDirection=t.clientY<this.startPoint.clientY?"Up":"Down"},t.prototype.calcScrollPoints=function(e){var t=this.updateChangeTouches(e);this.defaultArgs={originalEvent:e},this.distanceX=Math.abs(Math.abs(t.clientX)-Math.abs(this.lastMovedPoint.clientX)),this.distanceY=Math.abs(Math.abs(t.clientY)-Math.abs(this.lastMovedPoint.clientY)),(this.distanceX>this.distanceY||!0===this.hScrollLocked)&&!1===this.vScrollLocked?(this.scrollDirection=t.clientX>this.lastMovedPoint.clientX?"Right":"Left",this.hScrollLocked=!0):(this.scrollDirection=t.clientY<this.lastMovedPoint.clientY?"Up":"Down",this.vScrollLocked=!0)},t.prototype.getVelocity=function(e){var t=e.clientX,i=e.clientY,r=Date.now(),n=t-this.startPoint.clientX,o=i-this.startPoint.clientX,s=r-this.tStampStart;return Math.sqrt(n*n+o*o)/s},t.prototype.checkSwipe=function(e,t){var i=["scroll","offset"],r=t?["Height","Top"]:["Width","Left"];return e[i[0]+r[0]]<=e[i[1]+r[0]]||(0===e[i[0]+r[1]]||e[i[1]+r[0]]+e[i[0]+r[1]]>=e[i[0]+r[0]])},t.prototype.updateChangeTouches=function(e){return e.changedTouches&&0!==e.changedTouches.length?e.changedTouches[0]:e},jt([Be()],t.prototype,"tap",void 0),jt([Be()],t.prototype,"tapHold",void 0),jt([Be()],t.prototype,"swipe",void 0),jt([Be()],t.prototype,"scroll",void 0),jt([Ue(350)],t.prototype,"tapThreshold",void 0),jt([Ue(750)],t.prototype,"tapHoldThreshold",void 0),jt([He({},Ut)],t.prototype,"swipeSettings",void 0),t=jt([_e],t)}(Ie),_t=new RegExp("\\n|\\r|\\s\\s+","g"),Vt=new RegExp(/'|"/g),Yt=new RegExp("if ?\\("),Qt=new RegExp("else if ?\\("),qt=new RegExp("else"),Gt=new RegExp("for ?\\("),Xt=new RegExp("(/if|/for)"),Zt=new RegExp("\\((.*)\\)",""),Kt=new RegExp("^[0-9]+$","g"),Jt=new RegExp("[\\w\"'.\\s+]+","g"),$t=new RegExp('"(.*?)"',"g"),ei=new RegExp("[\\w\"'@#$.\\s-+]+","g"),ti=new RegExp("\\${([^}]*)}","g"),ii=/^\..*/gm,ri=/\\/gi,ni=/\\\\/gi,oi=new RegExp("[\\w\"'@#$.\\s+]+","g"),si=/\window\./gm;function ai(e,t,i){var r=function(e,t,i,r){var n=0,o=[],s=e.match(/class="([^"]+|)\s{2}/g),a="";s&&s.forEach((function(t){a=t.replace(/\s\s+/g," "),e=e.replace(t,a)}));return e.replace(_t,"").replace($t,"'$1'").replace(ti,(function(e,s,a,l){var h=s.match(Zt);if(h){var d=h[1];if(Qt.test(s))s='";} '+s.replace(h[1],d.replace(Jt,(function(e){return li(e=e.trim(),!Vt.test(e)&&-1===o.indexOf(e),t,o,r)})))+'{ \n str = str + "';else if(Yt.test(s))s='"; '+s.replace(h[1],d.replace(ei,(function(e){return ci(e,t,o,r)})))+'{ \n str = str + "';else if(Gt.test(s)){var c=h[1].split(" of ");s='"; '+s.replace(h[1],(function(e){return o.push(c[0]),o.push(c[0]+"Index"),"var i"+(n+=1)+"=0; i"+n+" < "+li(c[1],!0,t,o,r)+".length; i"+n+"++"}))+"{ \n "+c[0]+"= "+li(c[1],!0,t,o,r)+"[i"+n+"]; \n var "+c[0]+"Index=i"+n+'; \n str = str + "'}else{var p=s.split("("),u=i&&i.hasOwnProperty(p[0])?"this.":"global";u=/\./.test(p[0])?"":u;var g=h[1].split(",");0===h[1].length||/data/.test(g[0])||/window./.test(g[0])||(h[1]="global"===u?t+"."+h[1]:h[1]);if(si.test(s)&&/\]\./gm.test(s)||/@|\$|#/gm.test(s)){/@|\$|#|\]\./gm.test(s)&&(s='"+ '+("global"===u?"":u)+s.replace(h[1],d.replace(oi,(function(e){return ci(e,t,o,r)})))+'+ "')}else s='" + '+("global"===u?"":u)+s.replace(d,li(h[1].replace(/,( |)data.|,/gi,","+t+".").replace(/,( |)data.window/gi,",window"),"global"!==u,t,o,r))+'+"'}}else qt.test(s)?s='"; '+s.replace(qt,'} else { \n str = str + "'):s.match(Xt)?s=s.replace(Xt,'"; \n } \n str = str + "'):/@|#|\$/gm.test(s)?(s.match(ri)&&(s=di(s)),s='"+'+hi(s,-1===o.indexOf(s),t,o)+'"]+"'):s=s.match(ri)?'"+'+hi(s=di(s),-1===o.indexOf(s),t,o)+'"]+"':""!==s?'"+'+li(s.replace(/,/gi,"+"+t+"."),-1===o.indexOf(s),t,o,r)+'+"':" ";return s}))}(e,"data",t,i);return new Function("data",'var str="'+r+"\";var valueRegEx = (/value=\\'([A-Za-z0-9 _]*)((.)([\\w)(!-;?-■\\s]+)['])/g);\n    var hrefRegex = (/(?:href)([\\s='\"./]+)([\\w-./?=&\\\\#\"]+)((.)([\\w)(!-;/?-■\\s]+)['])/g);\n    if(str.match(valueRegEx)){\n        var check = str.match(valueRegEx);\n        var str1 = str;\n        for (var i=0; i < check.length; i++) {\n            var check1 = str.match(valueRegEx)[i].split('value=')[1];\n            var change = check1.match(/^'/) !== null ? check1.replace(/^'/, '\"') : check1;\n            change =change.match(/.$/)[0] === '\\'' ? change.replace(/.$/,'\"') : change;\n            str1 = str1.replace(check1, change);\n        }\n        str = str.replace(str, str1);\n    }\n    else if (str.match(/(?:href='')/) === null) {\n        if(str.match(hrefRegex)) {\n            var check = str.match(hrefRegex);\n            var str1 = str;\n            for (var i=0; i < check.length; i++) {\n                var check1 = str.match(hrefRegex)[i].split('href=')[1];\n                if (check1) {\n                    var change = check1.match(/^'/) !== null ? check1.replace(/^'/, '\"') : check1;\n                    change =change.match(/.$/)[0] === '\\'' ? change.replace(/.$/,'\"') : change;\n                    str1 = str1.replace(check1, change);\n                }\n            }\n            str = str.replace(str, str1);\n        }\n    }\n     return str;").bind(t)}function li(e,t,i,r,n){return!t||Kt.test(e)||-1!==r.indexOf(e.split(".")[0])||n?e:i+"."+e}function hi(e,t,i,r){return t&&!Kt.test(e)&&-1===r.indexOf(e.split(".")[0])?i+'["'+e:e}function di(e){return e=e.match(ni)?e:e.replace(ri,"\\\\")}function ci(e,t,i,r){e=e.trim();if(/\window\./gm.test(e))return e;var n=/'|"/gm;return/@|\$|#/gm.test(e)&&(e=hi(e,-1===i.indexOf(e),t,i)+'"]'),ii.test(e)?function(e,t,i,r){return!t||Kt.test(e)||-1!==r.indexOf(e.split(".")[0])||/^\..*/gm.test(e)?e:i+"."+e}(e,!n.test(e)&&-1===i.indexOf(e),t,i):li(e,!n.test(e)&&-1===i.indexOf(e),t,i,r)}var pi=/^[\n\r.]+<tr|^<tr/,ui=/^[\n\r.]+<svg|^<path|^<g/,gi={};function fi(){return"-"+Math.random().toString(36).substr(2,5)}var mi={compile:(new(function(){function e(){}return e.prototype.compile=function(e,t,i){return void 0===t&&(t={}),ai(e,t)},e}())).compile},yi=["script","style","iframe[src]",'link[href*="javascript:"]','object[type="text/x-scriptlet"]','object[data^="data:text/html;base64"]','img[src^="data:text/html;base64"]','[src^="javascript:"]','[dynsrc^="javascript:"]','[lowsrc^="javascript:"]','[type^="application/x-shockwave-flash"]'],vi=[{attribute:"href",selector:'[href*="javascript:"]'},{attribute:"background",selector:'[background^="javascript:"]'},{attribute:"style",selector:'[style*="javascript:"]'},{attribute:"style",selector:'[style*="expression("]'},{attribute:"href",selector:'a[href^="data:text/html;base64"]'}],bi=["onchange","onclick","onmouseover","onmouseout","onkeydown","onload","onerror","onblur","onfocus","onbeforeload","onbeforeunload","onkeyup","onsubmit","onafterprint","onbeforeonload","onbeforeprint","onblur","oncanplay","oncanplaythrough","onchange","onclick","oncontextmenu","ondblclick","ondrag","ondragend","ondragenter","ondragleave","ondragover","ondragstart","ondrop","ondurationchange","onemptied","onended","onerror","onerror","onfocus","onformchange","onforminput","onhaschange","oninput","oninvalid","onkeydown","onkeypress","onkeyup","onload","onloadeddata","onloadedmetadata","onloadstart","onmessage","onmousedown","onmousemove","onmouseout","onmouseover","onmouseup","onmousewheel","onoffline","onoine","ononline","onpagehide","onpageshow","onpause","onplay","onplaying","onpopstate","onprogress","onratechange","onreadystatechange","onredo","onresize","onscroll","onseeked","onseeking","onselect","onstalled","onstorage","onsubmit","onsuspend","ontimeupdate","onundo","onunload","onvolumechange","onwaiting","onmouseenter","onmouseleave","onmousewheel","onstart","onpropertychange"],wi=function(){function e(){}return e.beforeSanitize=function(){return{selectors:{tags:yi,attributes:vi}}},e.sanitize=function(e){var t=this.beforeSanitize();return this.serializeValue(t,e)},e.serializeValue=function(e,t){this.removeAttrs=e.selectors.attributes,this.removeTags=e.selectors.tags,this.wrapElement=document.createElement("div"),this.wrapElement.innerHTML=t,this.removeXssTags(),this.removeJsEvents(),this.removeXssAttrs();var i=this.wrapElement.innerHTML;return this.removeElement(),i.replace("&amp;","&")},e.removeElement=function(){for(var e=this.wrapElement.children,t=0;t<e.length;t++)for(var i=e[parseInt(t.toString(),10)].attributes,r=0;r<i.length;r++)this.wrapElement.children[parseInt(t.toString(),10)].removeAttribute(i[parseInt(r.toString(),10)].localName)},e.removeXssTags=function(){var e=this.wrapElement.querySelectorAll(this.removeTags.join(","));e.length>0&&e.forEach((function(e){fe(e)}))},e.removeJsEvents=function(){var e=this.wrapElement.querySelectorAll("["+bi.join("],[")+"]");e.length>0&&e.forEach((function(e){bi.forEach((function(t){e.hasAttribute(t)&&e.removeAttribute(t)}))}))},e.removeXssAttrs=function(){var e=this;this.removeAttrs.forEach((function(t,i){var r=e.wrapElement.querySelectorAll(t.selector);r.length>0&&r.forEach((function(e){e.removeAttribute(t.attribute)}))}))},e}();return e.blazorCultureFormats=G,e.Ajax=Z,e.Animation=Ge,e.rippleEffect=function(t,i,r){var n=function(e){return{selector:e&&e.selector?e.selector:null,ignore:e&&e.ignore?e.ignore:null,rippleFlag:e&&e.rippleFlag,isCenterRipple:e&&e.isCenterRipple,duration:e&&e.duration?e.duration:350}}(i);return!1===n.rippleFlag||void 0===n.rippleFlag&&!e.isRippleEnabled?function(){}:(t.setAttribute("data-ripple","true"),ae.add(t,"mousedown",Xe,{parent:t,rippleOptions:n}),ae.add(t,"mouseup",Ze,{parent:t,rippleOptions:n,done:r}),ae.add(t,"mouseleave",Ke,{parent:t,rippleOptions:n}),se.isPointer&&ae.add(t,"transitionend",Ke,{parent:t,rippleOptions:n}),function(){t.removeAttribute("data-ripple"),ae.remove(t,"mousedown",Xe),ae.remove(t,"mouseup",Ze),ae.remove(t,"mouseleave",Ke),ae.remove(t,"transitionend",Ke)})},e.enableRipple=function(t){return e.isRippleEnabled=t,e.isRippleEnabled},e.setGlobalAnimation=function(t){e.animationMode=t},e.Base=Ie,e.getComponent=Se,e.removeChildInstance=function(e){for(var t=[].slice.call(e.getElementsByClassName("e-control")),i=0;i<t.length;i++){var r=t[parseInt(i.toString(),10)].classList[1].split("e-")[1],n=Se(t[parseInt(i.toString(),10)],r);f(n)||n.destroy()}},e.Browser=se,e.enableVersionBasedPersistence=function(t){e.versionBasedStatePersistence=t},e.Component=bt,e.ChildProperty=tt,e.Position=Tt,e.Draggable=Pt,e.Droppable=Ft,e.EventHandler=ae,e.onIntlChange=V,e.cldrData=Y,e.Internationalization=q,e.setCulture=function(t){e.defaultCulture=t,V.notify("notifyExternalChange",{locale:e.defaultCulture})},e.setCurrencyCode=function(t){e.defaultCurrencyCode=t,V.notify("notifyExternalChange",{currencyCode:e.defaultCurrencyCode})},e.loadCldr=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var i=0,r=e;i<r.length;i++){var n=r[i];u(Y,n,{},!0)}},e.enableRtl=function(t){void 0===t&&(t=!0),e.rightToLeft=t,V.notify("notifyExternalChange",{enableRtl:e.rightToLeft})},e.getNumericObject=function(t,i){var r=e.IntlBase.getDependables(Y,t,"",!0)[Q[0]],n=e.IntlBase.getDependables(Y,t,"")[Q[1]],o=a("defaultNumberingSystem",r),s=b()?a("numberSymbols",r):a("symbols-numberSystem-"+o,r),l=e.IntlBase.getSymbolPattern(i||"decimal",o,r,!1);return u(s,e.IntlBase.getFormatData(l,!0,"",!0),{dateSeparator:e.IntlBase.getDateSeparator(n)})},e.getNumberDependable=function(t,i){var r=e.IntlBase.getDependables(Y,t,"",!0);return e.IntlBase.getCurrencySymbol(r.numericObject,i)},e.getDefaultDateObject=function(t){return e.IntlBase.getDependables(Y,"",t,!1)[Q[1]]},e.KeyboardEvents=kt,e.L10n=Wt,e.ModuleLoader=et,e.Property=Ue,e.Complex=He,e.ComplexFactory=function(e){return function(t,i){var r={set:De({},i,e),get:Fe({},i,e),enumerable:!0,configurable:!0};Object.defineProperty(t,i,r),Ve(t,i,"complexProp",{},e)}},e.Collection=function(e,t){return function(i,r){var n={set:ze(e,r,t),get:Ee(e,r,t),enumerable:!0,configurable:!0};Object.defineProperty(i,r,n),Ve(i,r,"colProp",e,t)}},e.CollectionFactory=function(e){return function(t,i){var r={set:ke([],i,e),get:We([],i,e),enumerable:!0,configurable:!0};Object.defineProperty(t,i,r),Ve(t,i,"colProp",{},e)}},e.Event=Be,e.NotifyPropertyChanges=_e,e.CreateBuilder=function(e){var t=function(e){return this.element=e,this};return function(i){return t.prototype.hasOwnProperty("create")||((t.prototype=function e(t){if(f(t.prototype.builderObject)){t.prototype.builderObject={properties:{},propCollections:[],add:function(){this.isPropertyArray=!0,this.propCollections.push(u({},this.properties,{}))}};for(var i=/complex/,r=0,n=Object.keys(t.prototype.propList);r<n.length;r++)for(var o=n[r],s=function(r){i.test(o)?t.prototype.builderObject[r.propertyName]=function(t){var i,n={};return p(n,e(r.type)),t(n),i=n.isPropertyArray?n.propCollections:u({},n.properties,{}),this.properties[r.propertyName]=i,n.properties={},n.propCollections=[],n.isPropertyArray=!1,this}:t.prototype.builderObject[r.propertyName]=function(e){return this.properties[r.propertyName]=e,this}},a=0,l=t.prototype.propList[""+o];a<l.length;a++){s(l[a])}}return t.prototype.builderObject}(e)).create=function(){var t=u({},{},this.properties);return this.properties={},new e(t,this.element)}),new t(i)}},e.SwipeSettings=Ut,e.Touch=Bt,e.blazorTemplates=gi,e.getRandomId=fi,e.compile=function(e,t,i){var r=mi.compile(e,t,i);return function(e,t,i,n,o,s,a,l){var h=r(e,t,i,a,l);if(b()&&!o){var d=n+fi();if(gi[""+n]||(gi[""+n]=[]),g(s))e.BlazorTemplateId=d,gi[""+n].push(e);else for(var c=0,p=Object.keys(gi[""+n][parseInt(s.toString(),10)]);c<p.length;c++){var u=p[c];"BlazorTemplateId"!==u&&e[""+u]&&(gi[""+n][parseInt(s.toString(),10)][""+u]=e[""+u]),"BlazorTemplateId"===u&&(d=gi[""+n][parseInt(s.toString(),10)][""+u])}return"rowTemplate"===i?[he("tr",{id:d,className:"e-blazor-template"})]:[he("div",{id:d,className:"e-blazor-template"})]}return"string"==typeof h?ui.test(h)?he("svg",{innerHTML:h}).childNodes:he(pi.test(h)?"table":"div",{innerHTML:h}).childNodes:h}},e.updateBlazorTemplate=function(e,t,i,r,n){if(b()){window.sfBlazor.updateTemplate(t,gi[""+e],e,i,n),!1!==r&&(gi[""+e]=[])}},e.resetBlazorTemplate=function(e,t,i){var r=document.getElementById(e);if(r)for(var n=r.getElementsByClassName("blazor-inner-template"),o=0;o<n.length;o++){var s=" ";s=g(i)?n[parseInt(o.toString(),10)].getAttribute("data-templateId"):n[parseInt(i.toString(),10)].getAttribute("data-templateId");var a=document.getElementById(s);if(a)for(var l=a.childNodes.length,h=0;h<l;h++)g(i)?n[parseInt(o.toString(),10)].appendChild(a.childNodes[0]):(n[parseInt(i.toString(),10)].appendChild(a.childNodes[0]),o=n.length)}},e.setTemplateEngine=function(e){mi.compile=e.compile},e.getTemplateEngine=function(){return mi.compile},e.disableBlazorMode=function(){n=!1},e.createInstance=o,e.setImmediate=s,e.getValue=a,e.setValue=l,e.deleteObject=h,e.containerObject=d,e.isObject=c,e.getEnumValue=function(e,t){return e[t]},e.merge=p,e.extend=u,e.isNullOrUndefined=g,e.isUndefined=f,e.getUniqueID=function(e){return e+"_"+r++},e.debounce=m,e.queryParams=function(e){for(var t=[],i=0,r=Object.keys(e);i<r.length;i++){var n=r[i];t.push(encodeURIComponent(n)+"="+encodeURIComponent(""+e[""+n]))}return t.join("&")},e.isObjectArray=function(e){var t=Object.prototype.toString;return"[object Array]"===t.call(e)&&"[object Object]"===t.call(e[0])},e.compareElementParent=y,e.throwError=v,e.print=function(e,t){var i=document.createElement("div"),r=[].slice.call(document.getElementsByTagName("head")[0].querySelectorAll("base, link, style")),n=[].slice.call(document.getElementsByTagName("body")[0].querySelectorAll("link, style"));if(n.length)for(var o=0,s=n.length;o<s;o++)r.push(n[parseInt(o.toString(),10)]);var a="";g(t)&&(t=window.open("","print","height=452,width=1024,tabbar=no")),i.appendChild(e.cloneNode(!0));var l=0;for(s=r.length;l<s;l++)a+=r[parseInt(l.toString(),10)].outerHTML;t.document.write("<!DOCTYPE html> <html><head>"+a+"</head><body>"+i.innerHTML+"<script> (function() { window.ready = true; })(); <\/script></body></html>"),t.document.close(),t.focus();var h=setInterval((function(){t.ready&&(t.print(),t.close(),clearInterval(h))}),500);return t},e.formatUnit=function(e){var t=e+"";return t.match(/auto|cm|mm|in|px|pt|pc|%|em|ex|ch|rem|vw|vh|vmin|vmax/)?t:t+"px"},e.enableBlazorMode=function(){n=!0},e.isBlazor=b,e.getElement=function(e){return e instanceof Node||!b()||g(e.xPath)?e:document.evaluate(e.xPath,document,null,XPathResult.FIRST_ORDERED_NODE_TYPE,null).singleNodeValue},e.getInstance=function(e,i){var r="string"==typeof e?document.querySelector(e):e;if(r[""+t])for(var n=0,o=r[""+t];n<o.length;n++){var s=o[n];if(s instanceof i)return s}return null},e.addInstance=function(e,i){var r="string"==typeof e?document.querySelector(e):e;r[""+t]?r[""+t].push(i):r[""+t]=[i]},e.uniqueID=w,e.createElement=he,e.addClass=de,e.removeClass=ce,e.isVisible=ue,e.prepend=function(e,t,i){for(var r=document.createDocumentFragment(),n=0,o=e;n<o.length;n++){var s=o[n];r.appendChild(s)}return t.insertBefore(r,t.firstElementChild),i&&ge(t),e},e.append=function(e,t,i){for(var r=document.createDocumentFragment(),n=0,o=e;n<o.length;n++){var s=o[n];r.appendChild(s)}return t.appendChild(r),i&&ge(t),e},e.detach=fe,e.remove=function(e){var t=e.parentNode;ae.clearEvents(e),t.removeChild(e)},e.attributes=me,e.select=ye,e.selectAll=ve,e.closest=we,e.siblings=function(e){for(var t=[],i=0,r=Array.prototype.slice.call(e.parentNode.childNodes);i<r.length;i++){var n=r[i];n.nodeType===Node.ELEMENT_NODE&&e!==n&&t.push(n)}return t},e.getAttributeOrDefault=function(e,t,i){var r,n=c(e);return g(r=n?a("attributes."+t,e):e.getAttribute(t))&&i&&(n?e.attributes[""+t]=i:e.setAttribute(t,i.toString()),r=i),r},e.setStyleAttribute=xe,e.classList=function(e,t,i){de([e],t),ce([e],i)},e.matches=Me,e.includeInnerHTML=function(e,t){e.innerHTML=t},e.containsClass=function(e,t){return c(e)?new RegExp("\\b"+t+"\\b","i").test(e.attributes.className):e.classList.contains(t)},e.cloneNode=function(e,t){return c(e)?t?u({},{},e,!0):void 0:e.cloneNode(t)},e.Observer=_,e.SanitizeHtmlHelper=wi,e.componentList=it,e.registerLicense=at,e.validateLicense=dt,e.getVersion=function(){return ot.version},e.createLicenseOverlay=ct,e}({})},"./modules/chart.js":function(e,t,i){function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}window.sf=window.sf||{};sf.charts=sf.base.extend({},sf.charts,function(e){"use strict";var t;!function(e){e.axisLabelFont={size:"12px",fontWeight:"Normal",color:null,fontStyle:"Normal",fontFamily:"Segoe UI"},e.axisTitleFont={size:"14px",fontWeight:"Normal",color:null,fontStyle:"Normal",fontFamily:"Segoe UI"},e.chartTitleFont={size:"15px",fontWeight:"500",color:null,fontStyle:"Normal",fontFamily:"Segoe UI"},e.chartSubTitleFont={size:"11px",fontWeight:"500",color:null,fontStyle:"Normal",fontFamily:"Segoe UI"},e.crosshairLabelFont={size:"13px",fontWeight:"Normal",color:null,fontStyle:"Normal",fontFamily:"Segoe UI"},e.tooltipLabelFont={size:"13px",fontWeight:"Normal",color:null,fontStyle:"Normal",fontFamily:"Segoe UI"},e.legendLabelFont={size:"13px",fontWeight:"Normal",color:null,fontStyle:"Normal",fontFamily:"Segoe UI"},e.legendTitleFont={size:"13px",fontWeight:"Normal",color:null,fontStyle:"Normal",fontFamily:"Segoe UI"},e.stripLineLabelFont={size:"12px",fontWeight:"Regular",color:"#353535",fontStyle:"Normal",fontFamily:"Segoe UI"},e.stockEventFont={size:"13px",fontWeight:"Normal",color:null,fontStyle:"Normal",fontFamily:"Segoe UI"}}(t||(t={}));var i,n,o,s,a=(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),l=function(e,t,i,n){var o,s=arguments.length,a=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(s<3?o(a):s>3?o(t,i,a):o(t,i))||a);return s>3&&a&&Object.defineProperty(t,i,a),a},h=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),l([sf.base.Property("Line")],t.prototype,"type",void 0),l([sf.base.Property(null)],t.prototype,"color",void 0),l([sf.base.Property(1)],t.prototype,"width",void 0),l([sf.base.Property(null)],t.prototype,"length",void 0),l([sf.base.Property("")],t.prototype,"dashArray",void 0),t}(sf.base.ChildProperty),d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),l([sf.base.Property("Normal")],t.prototype,"fontStyle",void 0),l([sf.base.Property("16px")],t.prototype,"size",void 0),l([sf.base.Property("Normal")],t.prototype,"fontWeight",void 0),l([sf.base.Property("")],t.prototype,"color",void 0),l([sf.base.Property("Center")],t.prototype,"textAlignment",void 0),l([sf.base.Property("Segoe UI")],t.prototype,"fontFamily",void 0),l([sf.base.Property(1)],t.prototype,"opacity",void 0),l([sf.base.Property("Wrap")],t.prototype,"textOverflow",void 0),t}(sf.base.ChildProperty),c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),l([sf.base.Property("")],t.prototype,"color",void 0),l([sf.base.Property(1)],t.prototype,"width",void 0),t}(sf.base.ChildProperty),p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),l([sf.base.Property(0)],t.prototype,"x",void 0),l([sf.base.Property(0)],t.prototype,"y",void 0),t}(sf.base.ChildProperty),u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),l([sf.base.Complex({},c)],t.prototype,"border",void 0),l([sf.base.Property("transparent")],t.prototype,"background",void 0),l([sf.base.Property(1)],t.prototype,"opacity",void 0),l([sf.base.Property(null)],t.prototype,"backgroundImage",void 0),l([sf.base.Property(null)],t.prototype,"width",void 0),t}(sf.base.ChildProperty),g=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),l([sf.base.Property(sf.base.Browser.isDevice?5:10)],t.prototype,"left",void 0),l([sf.base.Property(sf.base.Browser.isDevice?5:10)],t.prototype,"right",void 0),l([sf.base.Property(sf.base.Browser.isDevice?5:10)],t.prototype,"top",void 0),l([sf.base.Property(sf.base.Browser.isDevice?5:10)],t.prototype,"bottom",void 0),t}(sf.base.ChildProperty),f=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),l([sf.base.Property(0)],t.prototype,"left",void 0),l([sf.base.Property(0)],t.prototype,"right",void 0),l([sf.base.Property(0)],t.prototype,"top",void 0),l([sf.base.Property(0)],t.prototype,"bottom",void 0),t}(sf.base.ChildProperty),m=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),l([sf.base.Property(!0)],t.prototype,"enable",void 0),l([sf.base.Property(1e3)],t.prototype,"duration",void 0),l([sf.base.Property(0)],t.prototype,"delay",void 0),t}(sf.base.ChildProperty),y=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),l([sf.base.Property(0)],t.prototype,"series",void 0),l([sf.base.Property(0)],t.prototype,"point",void 0),t}(sf.base.ChildProperty),v=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),l([sf.base.Property(0)],t.prototype,"topLeft",void 0),l([sf.base.Property(0)],t.prototype,"topRight",void 0),l([sf.base.Property(0)],t.prototype,"bottomLeft",void 0),l([sf.base.Property(0)],t.prototype,"bottomRight",void 0),t}(sf.base.ChildProperty),b=function(e,t){this.series=e,this.point=t},w=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),l([sf.base.Property(null)],t.prototype,"fill",void 0),l([sf.base.Complex({color:"transparent",width:0},c)],t.prototype,"border",void 0),l([sf.base.Property("Gap")],t.prototype,"mode",void 0),t}(sf.base.ChildProperty),x=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),l([sf.base.Property(!1)],t.prototype,"enable",void 0),l([sf.base.Property(null)],t.prototype,"minY",void 0),l([sf.base.Property(null)],t.prototype,"maxY",void 0),l([sf.base.Property(null)],t.prototype,"fill",void 0),t}(sf.base.ChildProperty),M=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return a(i,e),l([sf.base.Property(!1)],i.prototype,"enable",void 0),l([sf.base.Property(!0)],i.prototype,"enableMarker",void 0),l([sf.base.Property(!1)],i.prototype,"shared",void 0),l([sf.base.Property(null)],i.prototype,"fill",void 0),l([sf.base.Property(null)],i.prototype,"header",void 0),l([sf.base.Property(.75)],i.prototype,"opacity",void 0),l([sf.base.Complex(t.tooltipLabelFont,d)],i.prototype,"textStyle",void 0),l([sf.base.Property(null)],i.prototype,"format",void 0),l([sf.base.Property(null)],i.prototype,"template",void 0),l([sf.base.Property(!0)],i.prototype,"enableAnimation",void 0),l([sf.base.Property(300)],i.prototype,"duration",void 0),l([sf.base.Property(1e3)],i.prototype,"fadeOutDuration",void 0),l([sf.base.Property("Move")],i.prototype,"fadeOutMode",void 0),l([sf.base.Property(!1)],i.prototype,"enableTextWrap",void 0),l([sf.base.Property(!0)],i.prototype,"showNearestPoint",void 0),l([sf.base.Complex({color:"#cccccc",width:.5},c)],i.prototype,"border",void 0),i}(sf.base.ChildProperty),N=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),l([sf.base.Property("Years")],t.prototype,"intervalType",void 0),l([sf.base.Property(1)],t.prototype,"interval",void 0),l([sf.base.Property(null)],t.prototype,"text",void 0),l([sf.base.Property(!1)],t.prototype,"selected",void 0),t}(sf.base.ChildProperty),I=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),l([sf.base.Property(43)],t.prototype,"height",void 0),l([sf.base.Property("Bottom")],t.prototype,"position",void 0),l([sf.base.Collection([],N)],t.prototype,"periods",void 0),t}(sf.base.ChildProperty),S=function(){function e(e,t){e<t?(this.mStart=e,this.mEnd=t):(this.mStart=t,this.mEnd=e)}return Object.defineProperty(e.prototype,"start",{get:function(){return this.mStart},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"end",{get:function(){return this.mEnd},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"delta",{get:function(){return this.mEnd-this.mStart},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"median",{get:function(){return this.mStart+(this.mEnd-this.mStart)/2},enumerable:!0,configurable:!0}),e}(),C=function(){function e(e){this.isColumn=0,this.chart=e}return e.prototype.calculateNumericNiceInterval=function(e,t,i){var r=Be(i,e),n=t/r;if(!sf.base.isNullOrUndefined(e.desiredIntervals)&&this.isAutoIntervalOnBothAxis(e))return n;for(var o=Math.pow(10,Math.floor(re(n,10))),s=0,a=e.intervalDivs;s<a.length;s++){var l=o*a[s];if(r<t/l)break;n=l}return n},e.prototype.isAutoIntervalOnBothAxis=function(e){return!(e.zoomFactor<1||e.zoomPosition>0)||!e.enableAutoIntervalOnZooming},e.prototype.getActualRange=function(e,t){this.initializeDoubleRange(e),!e.startFromZero&&this.isColumn>0?(e.actualRange.interval=e.interval||this.calculateNumericNiceInterval(e,e.doubleRange.delta,t),e.actualRange.max=e.doubleRange.end+e.actualRange.interval,e.doubleRange.start-e.actualRange.interval<0&&e.doubleRange.start>0?e.actualRange.min=0:e.actualRange.min=e.doubleRange.start-e.actualRange.interval):(e.actualRange.interval=e.interval||this.calculateNumericNiceInterval(e,e.doubleRange.delta,t),e.actualRange.min=e.doubleRange.start,e.actualRange.max=e.doubleRange.end)},e.prototype.initializeDoubleRange=function(e){null!==e.minimum?this.min=e.minimum:null!==this.min&&this.min!==Number.POSITIVE_INFINITY||(this.min=0),null!==e.maximum?this.max=e.maximum:null!==this.max&&this.max!==Number.NEGATIVE_INFINITY||(this.max=5),this.min===this.max&&(this.max=e.valueType.indexOf("Category")>-1?this.max:this.min+1),e.doubleRange=new S(this.min,this.max),e.actualRange={}},e.prototype.calculateRangeAndInterval=function(e,t){this.calculateRange(t),this.getActualRange(t,e),this.applyRangePadding(t,e),this.calculateVisibleLabels(t,this.chart)},e.prototype.calculateRange=function(e){if(/*! Generate axis range */this.min=null,this.max=null,!Ue(e))for(var t=0,i=e.series;t<i.length;t++){var r=i[t];r.visible&&(this.paddingInterval=0,sf.base.isNullOrUndefined(r.points)||(e.maxPointLength=r.points.length),e.maxPointLength=r.points.length,((r.type.indexOf("Column")>-1||r.type.indexOf("Histogram")>-1)&&"Horizontal"===e.orientation||r.type.indexOf("Bar")>-1&&"Vertical"===e.orientation)&&("Double"!==r.xAxis.valueType&&"DateTime"!==r.xAxis.valueType||"Auto"!==r.xAxis.rangePadding||(this.paddingInterval=.5*Fe(r.xAxis,e.series))),"Horizontal"===e.orientation&&(this.chart.requireInvertedAxis?this.yAxisRange(e,r):this.findMinMax(r.xMin-this.paddingInterval,r.xMax+this.paddingInterval)),"Vertical"===e.orientation&&(this.isColumn+="Column"===r.type||"Bar"===r.type||"Column"===r.drawType?1:0,this.chart.requireInvertedAxis?this.findMinMax(r.xMin-this.paddingInterval,r.xMax+this.paddingInterval):this.yAxisRange(e,r)))}},e.prototype.yAxisRange=function(e,t){t.dragSettings.enable&&this.chart.dragY&&(this.chart.dragY>=e.visibleRange.max&&(t.yMax=this.chart.dragY+e.visibleRange.interval),this.chart.dragY<=e.visibleRange.min&&(t.yMin=this.chart.dragY-e.visibleRange.interval)),this.findMinMax(t.yMin,t.yMax)},e.prototype.findMinMax=function(e,t){(null===this.min||this.min>e)&&(this.min=e),(null===this.max||this.max<t)&&(this.max=t),this.max===this.min&&this.max<0&&this.min<0&&(this.max=0)},e.prototype.applyRangePadding=function(e,t){var i=e.actualRange.min,r=e.actualRange.max;if(!Ue(e)){var n=e.actualRange.interval,o=e.getRangePadding(this.chart);"Additional"===o||"Round"===o?this.findAdditional(e,i,r,n,t):"Normal"===o?this.findNormal(e,i,r,n,t):this.updateActualRange(e,i,r,n)}e.actualRange.delta=e.actualRange.max-e.actualRange.min,this.calculateVisibleRange(t,e)},e.prototype.updateActualRange=function(e,t,i,r){e.actualRange={min:null!=e.minimum?e.minimum:t,max:null!=e.maximum?e.maximum:i,interval:null!=e.interval?e.interval:r,delta:e.actualRange.delta}},e.prototype.findAdditional=function(e,t,i,r,n){var o,s;if(o=Math.floor(t/r)*r,s=Math.ceil(i/r)*r,"Additional"===e.rangePadding&&(o-=r,s+=r),!sf.base.isNullOrUndefined(e.desiredIntervals)){var a=s-o;r=this.calculateNumericNiceInterval(e,a,n)}this.updateActualRange(e,o,s,r)},e.prototype.findNormal=function(e,t,i,r,n){var o,s,a=t;t<0?(a=0,.365*r>=r+(o=t+.05*t)%r&&(o-=r),o%r<0&&(o=o-r-o%r)):(o=t<5/6*i?0:t-.5*(i-t))%r>0&&(o-=o%r),.365*r>=r-(s=i>0?i+.05*(i-a):i-.05*(i-a))%r&&(s+=r),s%r>0&&(s=s+r-s%r),e.doubleRange=new S(o,s),0===o&&(r=this.calculateNumericNiceInterval(e,e.doubleRange.delta,n),s=Math.ceil(s/r)*r),this.updateActualRange(e,o,s,r)},e.prototype.calculateVisibleRange=function(e,t){if(t.visibleRange={max:t.actualRange.max,min:t.actualRange.min,delta:t.actualRange.delta,interval:t.actualRange.interval},"Cartesian"===this.chart.chartAreaType){var i=!sf.base.isNullOrUndefined(t.zoomingScrollBar)&&t.zoomingScrollBar.isLazyLoad;(t.zoomFactor<1||t.zoomPosition>0)&&!i&&(t.calculateVisibleRangeOnZooming(e),t.visibleRange.interval=t.enableAutoIntervalOnZooming?this.calculateNumericNiceInterval(t,t.doubleRange.delta,e):t.visibleRange.interval)}if(t.maximum&&"Vertical"===t.orientation&&"Auto"===t.rangePadding){for(var r=void 0,n=t.visibleRange.min;n<=t.visibleRange.max&&r!==n;n+=t.visibleRange.interval)r=n;r<t.visibleRange.max&&(t.visibleRange.max=r+t.visibleRange.interval)}t.triggerRangeRender(this.chart,t.visibleRange.min,t.visibleRange.max,t.visibleRange.interval)},e.prototype.calculateVisibleLabels=function(e,t){/*! Generate axis labels */e.visibleLabels=[];var i,r=e.visibleRange.min;!("chart"===t.getModuleName()&&"PolarRadar"===t.chartAreaType)&&(e.zoomFactor<1||e.zoomPosition>0||this.paddingInterval)&&(r=e.visibleRange.min-e.visibleRange.min%e.visibleRange.interval);var n,o=this.getFormat(e),s=null!==o.match("{value}"),a=0,l=0;for(e.labelFormat&&e.labelFormat.indexOf("n")>-1&&(l=parseInt(e.labelFormat.substring(1,e.labelFormat.length),10)),e.format=t.intl.getNumberFormat({format:s?"":o,useGrouping:t.useGroupingSeparator}),e.startLabel=e.format(e.visibleRange.min),e.endLabel=e.format(e.visibleRange.max),e.visibleRange.interval&&(e.visibleRange.interval+"").indexOf(".")>=0&&(a=(e.visibleRange.interval+"").split(".")[1].length);r<=e.visibleRange.max&&n!==r;r+=e.visibleRange.interval)n=r,i=sf.base.extend({},sf.base.getValue("properties",e.labelStyle),null,!0),se(r,e.visibleRange)&&je(t,r,this.formatValue(e,s,o,r),i,e);r&&(r+"").indexOf(".")>=0&&(r+"").split(".")[1].length>10&&(r=(r+"").split(".")[1].length>(l||a)?+r.toFixed(l||a):r)<=e.visibleRange.max&&je(t,r,this.formatValue(e,s,o,r),i,e),e.getMaxLabelWidth&&e.getMaxLabelWidth(this.chart)},e.prototype.getFormat=function(e){return e.labelFormat?0===e.labelFormat.indexOf("p")&&-1===e.labelFormat.indexOf("{value}")&&e.isStack100?"{value}%":e.labelFormat:e.isStack100?"{value}%":""},e.prototype.formatValue=function(e,t,i,r){return t?i.replace("{value}",e.format(r)):e.format(r)},e}(),O=/~\d+~/g,T=/\^\d+\^/g,P="onZooming",A=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),L=function(e,t,i,n){var o,s=arguments.length,a=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(s<3?o(a):s>3?o(t,i,a):o(t,i))||a);return s>3&&a&&Object.defineProperty(t,i,a),a},F=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return A(t,e),L([sf.base.Property("0")],t.prototype,"x",void 0),L([sf.base.Property("0")],t.prototype,"y",void 0),L([sf.base.Property(null)],t.prototype,"content",void 0),L([sf.base.Property("Center")],t.prototype,"horizontalAlignment",void 0),L([sf.base.Property("Pixel")],t.prototype,"coordinateUnits",void 0),L([sf.base.Property("Chart")],t.prototype,"region",void 0),L([sf.base.Property("Middle")],t.prototype,"verticalAlignment",void 0),L([sf.base.Property(null)],t.prototype,"xAxisName",void 0),L([sf.base.Property(null)],t.prototype,"yAxisName",void 0),L([sf.base.Property(null)],t.prototype,"description",void 0),t}(sf.base.ChildProperty),D=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return A(t,e),L([sf.base.Property("")],t.prototype,"color",void 0),L([sf.base.Property(1)],t.prototype,"width",void 0),L([sf.base.Property("Rectangle")],t.prototype,"type",void 0),t}(sf.base.ChildProperty),E=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return A(t,e),L([sf.base.Property(null)],t.prototype,"start",void 0),L([sf.base.Property(null)],t.prototype,"end",void 0),L([sf.base.Property("")],t.prototype,"text",void 0),L([sf.base.Property(null)],t.prototype,"maximumTextWidth",void 0),L([sf.base.Property(null)],t.prototype,"customAttributes",void 0),L([sf.base.Property("")],t.prototype,"type",void 0),t}(sf.base.ChildProperty),z=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return A(i,e),L([sf.base.Property(!0)],i.prototype,"visible",void 0),L([sf.base.Property(!1)],i.prototype,"startFromAxis",void 0),L([sf.base.Property(null)],i.prototype,"start",void 0),L([sf.base.Property(null)],i.prototype,"end",void 0),L([sf.base.Property(null)],i.prototype,"size",void 0),L([sf.base.Property("#808080")],i.prototype,"color",void 0),L([sf.base.Property(null)],i.prototype,"dashArray",void 0),L([sf.base.Property("Auto")],i.prototype,"sizeType",void 0),L([sf.base.Property(!1)],i.prototype,"isRepeat",void 0),L([sf.base.Property(null)],i.prototype,"repeatEvery",void 0),L([sf.base.Property(null)],i.prototype,"repeatUntil",void 0),L([sf.base.Property(!1)],i.prototype,"isSegmented",void 0),L([sf.base.Property(null)],i.prototype,"segmentStart",void 0),L([sf.base.Property(null)],i.prototype,"segmentEnd",void 0),L([sf.base.Property(null)],i.prototype,"segmentAxisName",void 0),L([sf.base.Complex({color:"transparent",width:1},c)],i.prototype,"border",void 0),L([sf.base.Property("")],i.prototype,"text",void 0),L([sf.base.Property(null)],i.prototype,"rotation",void 0),L([sf.base.Property("Middle")],i.prototype,"horizontalAlignment",void 0),L([sf.base.Property("Middle")],i.prototype,"verticalAlignment",void 0),L([sf.base.Complex(t.stripLineLabelFont,d)],i.prototype,"textStyle",void 0),L([sf.base.Property("Behind")],i.prototype,"zIndex",void 0),L([sf.base.Property(1)],i.prototype,"opacity",void 0),i}(sf.base.ChildProperty),k=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return A(i,e),L([sf.base.Property("Center")],i.prototype,"alignment",void 0),L([sf.base.Property("Wrap")],i.prototype,"overflow",void 0),L([sf.base.Complex(t.axisLabelFont,d)],i.prototype,"textStyle",void 0),L([sf.base.Complex({color:null,width:1,type:"Rectangle"},D)],i.prototype,"border",void 0),L([sf.base.Collection([],E)],i.prototype,"categories",void 0),i}(sf.base.ChildProperty),W=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return A(t,e),L([sf.base.Property(null)],t.prototype,"minimum",void 0),L([sf.base.Property(null)],t.prototype,"maximum",void 0),t}(sf.base.ChildProperty),R=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return A(t,e),L([sf.base.Property(!1)],t.prototype,"enable",void 0),L([sf.base.Property(null)],t.prototype,"pointsLength",void 0),L([sf.base.Complex({},W)],t.prototype,"range",void 0),t}(sf.base.ChildProperty),j=(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),U=function(e,t,i,n){var o,s=arguments.length,a=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(s<3?o(a):s>3?o(t,i,a):o(t,i))||a);return s>3&&a&&Object.defineProperty(t,i,a),a},H=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.axes=[],t.nearSizes=[],t.farSizes=[],t.insideFarSizes=[],t.insideNearSizes=[],t}return j(t,e),t.prototype.computeSize=function(e,t,i,r){var n=0,o="Inside"===e.labelPosition&&r.axes.indexOf(e)>-1?-5:5;e.visible&&e.internalVisibility&&(n+=e.findTickSize(e.crossInAxis)+t+e.findLabelSize(e.crossInAxis,o,i,r)+.5*e.lineStyle.width),e.isAxisOpposedPosition?this.farSizes.push(n):this.nearSizes.push(n)},U([sf.base.Property("100%")],t.prototype,"height",void 0),U([sf.base.Complex({},c)],t.prototype,"border",void 0),t}(sf.base.ChildProperty),B=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.axes=[],t.nearSizes=[],t.farSizes=[],t.insideFarSizes=[],t.insideNearSizes=[],t.padding=0,t}return j(t,e),t.prototype.computeSize=function(e,t,i,r){var n=0;e.visible&&e.internalVisibility&&(n+=e.findTickSize(e.crossInAxis)+t+e.findLabelSize(e.crossInAxis,5,i,r)+.5*e.lineStyle.width),e.isAxisOpposedPosition?this.farSizes.push(n):this.nearSizes.push(n)},U([sf.base.Property("100%")],t.prototype,"width",void 0),U([sf.base.Complex({},c)],t.prototype,"border",void 0),t}(sf.base.ChildProperty),_=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return j(t,e),U([sf.base.Property(1)],t.prototype,"width",void 0),U([sf.base.Property("")],t.prototype,"dashArray",void 0),U([sf.base.Property(null)],t.prototype,"color",void 0),t}(sf.base.ChildProperty),V=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return j(t,e),U([sf.base.Property(.7)],t.prototype,"width",void 0),U([sf.base.Property("")],t.prototype,"dashArray",void 0),U([sf.base.Property(null)],t.prototype,"color",void 0),t}(sf.base.ChildProperty),Y=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return j(t,e),U([sf.base.Property(1)],t.prototype,"width",void 0),U([sf.base.Property("")],t.prototype,"dashArray",void 0),U([sf.base.Property(null)],t.prototype,"color",void 0),t}(sf.base.ChildProperty),Q=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return j(t,e),U([sf.base.Property(1)],t.prototype,"width",void 0),U([sf.base.Property(5)],t.prototype,"height",void 0),U([sf.base.Property(null)],t.prototype,"color",void 0),t}(sf.base.ChildProperty),q=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return j(t,e),U([sf.base.Property(.7)],t.prototype,"width",void 0),U([sf.base.Property(5)],t.prototype,"height",void 0),U([sf.base.Property(null)],t.prototype,"color",void 0),t}(sf.base.ChildProperty),G=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return j(i,e),U([sf.base.Property(!1)],i.prototype,"enable",void 0),U([sf.base.Property(null)],i.prototype,"fill",void 0),U([sf.base.Complex(t.crosshairLabelFont,d)],i.prototype,"textStyle",void 0),i}(sf.base.ChildProperty),X=function(e){function i(t,i,r,n){var o=e.call(this,t,i,r,n)||this;return o.visibleLabels=[],o.series=[],o.rect=new sf.svgbase.Rect(void 0,void 0,0,0),o.axisBottomLine=null,o.intervalDivs=[10,5,2,1],o.isStack100=!1,o.crossAt=null,o.updatedRect=null,o.multiLevelLabelHeight=0,o.isChart=!0,o.isIntervalInDecimal=!0,o.titleCollection=[],o.titleSize=new sf.svgbase.Size(0,0),o.internalVisibility=!0,o.isRTLEnabled=!1,o.angle=o.labelRotation,o}return j(i,e),i.prototype.findTickSize=function(e){return"Inside"===this.tickPosition?0:!e||e.visibleRange&&!this.isInside(e.visibleRange)?this.majorTickLines.height:0},i.prototype.isInside=function(e){return oe(this.crossAt,e)||!this.isAxisOpposedPosition&&this.crossAt>=e.max||this.isAxisOpposedPosition&&this.crossAt<=e.min},i.prototype.findLabelSize=function(e,t,i,r){var n,o,s=0,a="Horizontal"===this.orientation;if(this.title){var l=this.titleRotation;if(sf.base.isNullOrUndefined(l)?(this.titleSize=sf.svgbase.measureText(this.title,this.titleStyle),s=this.titleSize.height+t):(this.titleSize=te(this.titleStyle,this.title,l,r),s=("Vertical"===this.orientation?this.titleSize.width:this.titleSize.height)+t),this.rect.width||this.rect.height){var h=a?this.rect.width:this.rect.height;this.titleCollection=Ot(this.title,this.titleStyle,h),s*=this.titleCollection.length}}var d=s+t+this.titlePadding+this.labelPadding+("Vertical"===this.orientation?this.maxLabelSize.width:this.maxLabelSize.height)+this.multiLevelLabelHeight;if(e&&this.placeNextToAxisLine){var c=e.visibleRange,p="Horizontal"===e.orientation?e.rect.width:e.rect.height;if(!c||!p)return 0;this.isInside(c)&&(d=(n=(o=this.findDifference(e))*((p-((n=o*(p/c.delta))<d?d-n:0))/c.delta))<d?d-n:0)}return this.isAxisOpposedPosition?i.insideFarSizes.push(d):i.insideNearSizes.push(d),"Inside"===this.labelPosition?s+t:d},i.prototype.updateCrossValue=function(){var e=this.crossAt;if(null===e||!this.isInside(this.crossInAxis.visibleRange))return this.updatedRect=this.rect,null;var t=this.crossInAxis.visibleRange;this.isAxisOpposedPosition?this.crossAt<t.min&&(e=t.min):this.crossAt>t.max&&(e=t.max),this.updatedRect=sf.base.extend({},this.rect,null,!0),"Horizontal"===this.orientation?(e=this.crossInAxis.rect.height-ye(e,this.crossInAxis)*this.crossInAxis.rect.height,this.updatedRect.y=this.crossInAxis.rect.y+e):(e=ye(e,this.crossInAxis)*this.crossInAxis.rect.width,this.updatedRect.x=this.crossInAxis.rect.x+e)},i.prototype.findDifference=function(e){var t=0;return t=this.isAxisOpposedPosition?e.isAxisInverse?e.visibleRange.min:e.visibleRange.max:e.isAxisInverse?e.visibleRange.max:e.visibleRange.min,Math.abs(this.crossAt-t)},i.prototype.calculateVisibleRangeOnZooming=function(e){if(He(this)){var t=this.actualRange,i=void 0,r=void 0;r=this.isAxisInverse?(i=this.actualRange.max-this.zoomPosition*this.actualRange.delta)-this.zoomFactor*this.actualRange.delta:(i=this.actualRange.min+this.zoomPosition*this.actualRange.delta)+this.zoomFactor*this.actualRange.delta,i<t.min&&(r+=t.min-i,i=t.min),r>t.max&&(i-=r-t.max,r=t.max),this.doubleRange=new S(i,r),this.visibleRange={min:this.doubleRange.start,max:this.doubleRange.end,delta:this.doubleRange.delta,interval:this.visibleRange.interval}}},i.prototype.triggerRangeRender=function(e,t,i,r){var n={cancel:!1,name:"axisRangeCalculated",axis:this,minimum:t,maximum:i,interval:r};e.trigger("axisRangeCalculated",n),n.cancel||(this.visibleRange={min:n.minimum,max:n.maximum,interval:n.interval,delta:n.maximum-n.minimum})},i.prototype.getRangePadding=function(e){var t=this.rangePadding;if("Auto"!==t)return t;switch(this.orientation){case"Horizontal":t=e.requireInvertedAxis?this.isStack100||this.baseModule.chart.stockChart?"Round":"Normal":"None";break;case"Vertical":t=e.requireInvertedAxis?"None":this.isStack100||this.baseModule.chart.stockChart?"Round":"Normal"}return t},i.prototype.getMaxLabelWidth=function(e){var t,i,r=0,n=!1;this.angle=this.labelRotation,this.maxLabelSize=new sf.svgbase.Size(0,0);for(var o,s=this.labelIntersectAction,a=0,l=this.visibleLabels.length;a<l;a++){(i=$((o=this.visibleLabels[a]).originalText))?(o.size=sf.svgbase.measureText(o.originalText.replace(/<br>/g," "),this.labelStyle),o.breakLabelSize=sf.svgbase.measureText(this.enableTrim?o.text.join("<br>"):o.originalText,this.labelStyle)):o.size=sf.svgbase.measureText(o.text,this.labelStyle);var h=i?o.breakLabelSize.width:o.size.width;h>this.maxLabelSize.width&&(this.maxLabelSize.width=h,this.rotatedLabel=o.text);var d=i?o.breakLabelSize.height:o.size.height;if(d>this.maxLabelSize.height&&(this.maxLabelSize.height=d),i&&(o.text=this.enableTrim?o.text:o.originalText.split("<br>")),"None"!==s&&"Hide"!==s&&"Trim"!==s&&("None"!==s||this.angle%360==0)&&"Horizontal"===this.orientation&&this.rect.width>0&&!n){var c=i?o.breakLabelSize.width:o.size.width;switch(t=ye(o.value,this)*this.rect.width+this.rect.x,t-=c/2,"Shift"===this.edgeLabelPlacement&&(0===a&&t<this.rect.x&&(t=this.rect.x),a===this.visibleLabels.length-1&&t+c>this.rect.x+this.rect.width&&(t=this.rect.x+this.rect.width-c)),s){case"MultipleRows":a>0&&this.findMultiRows(a,t,o,i);break;case"Rotate45":case"Rotate90":a>0&&(this.isAxisInverse?t+c>=r:t<=r)&&(this.angle="Rotate45"===s?45:90,n=!0);break;default:if(i){for(var p=void 0,u=[],g=void 0,f=0;f<o.text.length;f++)if((p=Pt(o.text[f],this.rect.width/this.visibleLabels.length,this.labelStyle)).length>1)for(var m=0;m<p.length;m++)g=p[m],u.push(g);else u.push(p[0]);o.text=u}else o.text=Pt(o.text,this.rect.width/this.visibleLabels.length,this.labelStyle);var y=o.size.height*o.text.length;y>this.maxLabelSize.height&&(this.maxLabelSize.height=y)}r=this.isAxisInverse?t:t+c}}if(0!==this.angle&&"Horizontal"===this.orientation){this.rotatedLabel=sf.base.isNullOrUndefined(this.rotatedLabel)?"":this.rotatedLabel;var v=-360===this.angle||0===this.angle||-180===this.angle||180===this.angle||360===this.angle;"Outside"===this.labelPosition&&!v&&$(this.rotatedLabel)?this.maxLabelSize=new sf.svgbase.Size(this.maxLabelSize.height,this.maxLabelSize.width):e.stockChart||(this.maxLabelSize=te(this.labelStyle,this.rotatedLabel,this.angle,e))}else if(0!==this.angle&&"Vertical"===this.orientation){this.rotatedLabel=sf.base.isNullOrUndefined(this.rotatedLabel)?"":this.rotatedLabel;v=-360===this.angle||0===this.angle||-180===this.angle||180===this.angle||360===this.angle;"Outside"===this.labelPosition&&!v&&$(this.rotatedLabel)?this.maxLabelSize=new sf.svgbase.Size(this.maxLabelSize.height,this.maxLabelSize.width):e.stockChart||(this.maxLabelSize=te(this.labelStyle,this.rotatedLabel,this.angle,e))}e.multiLevelLabelModule&&this.multiLevelLabels.length>0&&e.multiLevelLabelModule.getMultilevelLabelsHeight(this)},i.prototype.findMultiRows=function(e,t,i,r){for(var n,o,s,a=[],l=e-1;l>=0;l--)n=this.visibleLabels[l],s=r?n.breakLabelSize.width:n.size.width,o=ye(n.value,this)*this.rect.width+this.rect.x,(this.isAxisInverse?t+i.size.width>o-.5*s:t<o+.5*s)?(a.push(n.index),i.index=i.index>n.index?i.index:n.index+1):i.index=a.indexOf(n.index)>-1?i.index:n.index;var h=(r?i.breakLabelSize.height:i.size.height)*i.index+5*(i.index-1);h>this.maxLabelSize.height&&(this.maxLabelSize.height=h)},i.prototype.getModule=function(e){"Double"===this.valueType?this.baseModule=new C(e):this.baseModule=e[Ae(this.valueType)+"Module"]},i.prototype.setIsInversedAndOpposedPosition=function(e){void 0===e&&(e=!1),this.isAxisOpposedPosition=this.opposedPosition||!e&&this.isRTLEnabled&&"Vertical"===this.orientation,this.isAxisInverse=this.isInversed||this.isRTLEnabled&&"Horizontal"===this.orientation},U([sf.base.Complex(t.axisLabelFont,d)],i.prototype,"labelStyle",void 0),U([sf.base.Complex({},G)],i.prototype,"crosshairTooltip",void 0),U([sf.base.Property("")],i.prototype,"title",void 0),U([sf.base.Complex(t.axisTitleFont,d)],i.prototype,"titleStyle",void 0),U([sf.base.Property("")],i.prototype,"labelFormat",void 0),U([sf.base.Property("")],i.prototype,"skeleton",void 0),U([sf.base.Property("DateTime")],i.prototype,"skeletonType",void 0),U([sf.base.Property("Center")],i.prototype,"lineBreakAlignment",void 0),U([sf.base.Property(0)],i.prototype,"plotOffset",void 0),U([sf.base.Property(null)],i.prototype,"plotOffsetLeft",void 0),U([sf.base.Property(null)],i.prototype,"plotOffsetTop",void 0),U([sf.base.Property(null)],i.prototype,"plotOffsetRight",void 0),U([sf.base.Property(null)],i.prototype,"plotOffsetBottom",void 0),U([sf.base.Property(!1)],i.prototype,"isIndexed",void 0),U([sf.base.Property(10)],i.prototype,"logBase",void 0),U([sf.base.Property(0)],i.prototype,"columnIndex",void 0),U([sf.base.Property(0)],i.prototype,"rowIndex",void 0),U([sf.base.Property(1)],i.prototype,"span",void 0),U([sf.base.Property(null)],i.prototype,"desiredIntervals",void 0),U([sf.base.Property(3)],i.prototype,"maximumLabels",void 0),U([sf.base.Property(1)],i.prototype,"zoomFactor",void 0),U([sf.base.Property(0)],i.prototype,"zoomPosition",void 0),U([sf.base.Property(!0)],i.prototype,"enableScrollbarOnZooming",void 0),U([sf.base.Property(!1)],i.prototype,"opposedPosition",void 0),U([sf.base.Property(!0)],i.prototype,"enableAutoIntervalOnZooming",void 0),U([sf.base.Property("Auto")],i.prototype,"rangePadding",void 0),U([sf.base.Property("Double")],i.prototype,"valueType",void 0),U([sf.base.Property("None")],i.prototype,"edgeLabelPlacement",void 0),U([sf.base.Property("Auto")],i.prototype,"intervalType",void 0),U([sf.base.Property("BetweenTicks")],i.prototype,"labelPlacement",void 0),U([sf.base.Property("Outside")],i.prototype,"tickPosition",void 0),U([sf.base.Property("Outside")],i.prototype,"labelPosition",void 0),U([sf.base.Property("")],i.prototype,"name",void 0),U([sf.base.Property(!0)],i.prototype,"visible",void 0),U([sf.base.Property(0)],i.prototype,"minorTicksPerInterval",void 0),U([sf.base.Property(0)],i.prototype,"labelRotation",void 0),U([sf.base.Property(null)],i.prototype,"titleRotation",void 0),U([sf.base.Property(null)],i.prototype,"crossesAt",void 0),U([sf.base.Property(!0)],i.prototype,"placeNextToAxisLine",void 0),U([sf.base.Property(null)],i.prototype,"crossesInAxis",void 0),U([sf.base.Property(null)],i.prototype,"minimum",void 0),U([sf.base.Property(null)],i.prototype,"maximum",void 0),U([sf.base.Property(null)],i.prototype,"interval",void 0),U([sf.base.Property(34)],i.prototype,"maximumLabelWidth",void 0),U([sf.base.Property(!1)],i.prototype,"enableTrim",void 0),U([sf.base.Property(5)],i.prototype,"labelPadding",void 0),U([sf.base.Property(5)],i.prototype,"titlePadding",void 0),U([sf.base.Complex({},Q)],i.prototype,"majorTickLines",void 0),U([sf.base.Complex({},q)],i.prototype,"minorTickLines",void 0),U([sf.base.Complex({},_)],i.prototype,"majorGridLines",void 0),U([sf.base.Complex({},V)],i.prototype,"minorGridLines",void 0),U([sf.base.Complex({},Y)],i.prototype,"lineStyle",void 0),U([sf.base.Property(sf.base.Browser.isDevice?"Rotate45":"Trim")],i.prototype,"labelIntersectAction",void 0),U([sf.base.Property(!1)],i.prototype,"isInversed",void 0),U([sf.base.Property(100)],i.prototype,"coefficient",void 0),U([sf.base.Property(0)],i.prototype,"startAngle",void 0),U([sf.base.Property(!0)],i.prototype,"startFromZero",void 0),U([sf.base.Property(null)],i.prototype,"description",void 0),U([sf.base.Property(2)],i.prototype,"tabIndex",void 0),U([sf.base.Collection([],z)],i.prototype,"stripLines",void 0),U([sf.base.Collection([],k)],i.prototype,"multiLevelLabels",void 0),U([sf.base.Complex({color:null,width:0,type:"Rectangle"},D)],i.prototype,"border",void 0),U([sf.base.Complex({},R)],i.prototype,"scrollbarSettings",void 0),i}(sf.base.ChildProperty),Z=function(e,t,i,r,n,o,s){void 0===n&&(n=new sf.svgbase.Size(0,0)),void 0===o&&(o=new sf.svgbase.Size(0,0)),void 0===s&&(s=1),this.text=e,this.originalText=r,this.value=t,this.labelStyle=i,this.size=n,this.breakLabelSize=o,this.index=s},K=(s=function(e,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}s(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});function J(e,t,i){for(var r=sf.base.extend([],e,null),n=0;n<r.length;n++)for(var o=0;o<t.length;o++)r[n][t[o]]instanceof Date&&(r[n][t[o]]=r[n][t[o]].getTime());return r.sort((function(e,r){for(var n=0,o=0,s=0;s<t.length;s++)n+=e[t[s]],o+=r[t[s]];return!i&&n<o||i&&n>o?-1:n===o?0:1})),r}function $(e){return-1!==e.indexOf("<br>")}function ee(e){for(var t,i=sf.base.extend([],e.points,null,!0),r=[],n=0,o=0;o<i.length;o++)t=i[o],sf.base.isNullOrUndefined(t.x)||""===t.x||(t.index=n++,r.push(t));return r}function te(e,t,i,r){var n,o,s,a,l,h=new sf.svgbase.SvgRenderer(r.element.id),d=[],c={id:"rotate_text",x:r.initialClipRect.x,y:r.initialClipRect.y,"font-size":e.size,"font-style":e.fontStyle,"font-family":e.fontFamily,"font-weight":e.fontWeight,transform:"rotate("+i+", 0, 0)","text-anchor":"middle"};n=$(t)?(d=t.split("<br>"))[0]:t;var p=h.createText(c,n);if(r.delayRedraw||r.redraw||r.element.appendChild(r.svgObject),"string"!=typeof d&&d.length>1)for(var u=1,g=d.length;u<g;u++)o=sf.svgbase.measureText(d[u],e).height,s=c.y+u*o,a=d[u],l=h.createTSpan({x:c.x,id:c.id,y:s},a),p.appendChild(l);r.svgObject.appendChild(p);var f=p.getBoundingClientRect();return sf.base.remove(p),r.delayRedraw||r.redraw||sf.base.remove(r.svgObject),new sf.svgbase.Size(f.right-f.left,f.bottom-f.top)}function ie(e){if(!e)return null;var t="string"==typeof e?Ge(e):e;t&&sf.base.remove(t)}function re(e,t){return Math.log(e)/Math.log(t)}function ne(e,t,i,r,n,o,s,a){var l=document.getElementById(n),h=sf.svgbase.measureText(e,{fontFamily:"Segoe UI",size:"12px",fontStyle:"Normal",fontWeight:"Regular"}),d=h.width+5;(t=t+d>r?t-(d+15):t,i=a?i-h.height/2:i+15,l)?(l.innerHTML=e,l.style.top=i.toString()+"px",l.style.left=(t+15).toString()+"px"):(l=sf.base.createElement("div",{innerHTML:e,id:n,styles:"top:"+i.toString()+"px;left:"+(t+15).toString()+'px;background-color: rgb(255, 255, 255) !important; color:black !important; position:absolute;border:1px solid rgb(112, 112, 112); padding-left : 3px; padding-right : 2px;padding-bottom : 2px; padding-top : 2px; font-size:12px; font-family: "Segoe UI"'}),o.appendChild(l),parseInt(l.style.left.replace("px",""),10)<0&&(l.style.left="0px"));s&&setTimeout((function(){ie(n)}),1500)}function oe(e,t){return e<t.max&&e>t.min}function se(e,t){return e<=t.max&&e>=t.min}function ae(e,t){return"Logarithmic"===t.valueType?re(e,t.logBase):e}function le(e,t,i,r){var n=ae(t.xValue,r.xAxis),o=e?ae(e.xValue,r.xAxis):n,s=i?ae(i.xValue,r.xAxis):n,a=Math.floor(r.xAxis.visibleRange.min),l=Math.ceil(r.xAxis.visibleRange.max);return o>=a&&o<=l||n>=a&&n<=l||s>=a&&s<=l||a>=o&&a<=s}function he(e){for(var t=0,i=0,r=e;i<r.length;i++){t+=r[i]}return t}function de(e,t,i,r,n){var o=0;if(null!==r)for(var s=t+1;s<i;s++)-1===r.indexOf(s)&&(o+=e[s][n.yName]);else for(s=t+1;s<i;s++)sf.base.isNullOrUndefined(e[s][n.yName])||(o+=e[s][n.yName]);return o}function ce(e,t){return e.x+=t.left,e.y+=t.top,e.width-=t.left+t.right,e.height-=t.top+t.bottom,e}function pe(e,t,i){var r=e*Math.PI/180;return new jt(Math.cos(r)*t+i.x,Math.sin(r)*t+i.y)}function ue(e){return e*(Math.PI/180)}function ge(e,t,i,r){for(var n=[],o=0;o<4;o++){var s=e[o],a=s.x-t,l=s.y-i,h=a*Math.cos(ue(r))-l*Math.sin(ue(r)),d=a*Math.sin(ue(r))+l*Math.cos(ue(r));s.x=h+t,s.y=d+i,n.push(new jt(s.x,s.y))}return n}function fe(e,t){var i,r,n,o,s,a,l,h,d=[e,t];for(o=0;o<d.length;o++){var c=d[o];for(s=0;s<c.length;s++){var p=(s+1)%c.length,u=c[s],g=c[p],f=new jt(g.y-u.y,u.x-g.x);for(i=r=void 0,a=0;a<e.length;a++)n=f.x*e[a].x+f.y*e[a].y,(sf.base.isNullOrUndefined(i)||n<i)&&(i=n),(sf.base.isNullOrUndefined(r)||n>r)&&(r=n);for(l=h=void 0,a=0;a<t.length;a++)n=f.x*t[a].x+f.y*t[a].y,(sf.base.isNullOrUndefined(l)||n<l)&&(l=n),(sf.base.isNullOrUndefined(h)||n>h)&&(h=n);if(r<l||h<i)return!1}}return!0}function me(e,t){for(var i=[],r=0;r<=t-1;r++)i.push(e[r]);return i}function ye(e,t){var i=t.visibleRange,r=(e-i.min)/i.delta;return(t.isChart?t.isAxisInverse:t.isInversed)?1-r:r}function ve(e,t,i,r,n,o){e="Logarithmic"===i.valueType?re(e>1?e:1,i.logBase):e,t="Logarithmic"===r.valueType?re(t>1?t:1,r.logBase):t,e+="Category"===i.valueType&&"BetweenTicks"===i.labelPlacement&&"Radar"!==o.type?.5:0;var s=o.chart.radius*ye(t,r),a=be(we(e,i),o.chart.primaryXAxis.startAngle);return{x:o.clipRect.width/2+o.clipRect.x+s*a.x,y:o.clipRect.height/2+o.clipRect.y+s*a.y}}function be(e,t){t=t<0?t+360:t;var i=Math.PI*(1.5-2*e);return i+=t*Math.PI/180,{x:Math.cos(i),y:Math.sin(i)}}function we(e,t){var i,r,n=t.visibleRange;return"Category"!==t.valueType?(i=n.max-("DateTime"===t.valueType?t.dateTimeInterval:n.interval)-n.min,r=t.visibleLabels.length-1,i=0===i?1:i):(i=1===t.visibleLabels.length?1:t.visibleLabels[t.visibleLabels.length-1].value-t.visibleLabels[0].value,r=t.visibleLabels.length),t.isAxisInverse?(e-n.min)/i*(1-1/r):1-(e-n.min)/i*(1-1/r)}var xe=function(e,t,i,r,n,o){this.verticalStandardMean=e,this.horizontalStandardMean=i,this.verticalSquareRoot=t,this.horizontalSquareRoot=r,this.verticalMean=n,this.horizontalMean=o},Me=function(e,t,i,r,n){this.startAngle=e,this.endAngle=t,this.innerRadius=i,this.radius=r,this.currentXPosition=n};function Ne(e,t,i,r,n){var o=Ge(e),s="top:"+i.toString()+"px;left:"+r.toString()+"px;color:black !important; background:#FFFFFF !important; position:absolute;border:1px solid #707070;font-size:"+n+";border-radius:2px; z-index:1";o?(o.setAttribute("innerHTML","&nbsp;"+t+"&nbsp;"),o.setAttribute("styles",s)):(o=sf.base.createElement("div",{id:e,innerHTML:"&nbsp;"+t+"&nbsp;",styles:s}),document.body.appendChild(o))}function Ie(e,t,i,r,n,o){for(var s,a,l,h,d,c,p=t.isAxisOpposedPosition,u=n?"start":"auto",g=e.availableSize.width,f=t.scrollbarSettings.enable||t.zoomingScrollBar&&t.zoomingScrollBar.svgObject?t.scrollBarHeight:0,m=0;m<2;m++){if(s=sf.svgbase.measureText(m?t.endLabel:t.startLabel,t.labelStyle),n?(d=m?new jt(o.x-f,o.y+3):new jt(t.rect.x-f,o.y+o.height-3),l=o.x+(p?o.width+5+f:-(s.width+5+5+f)),h=o.y+(m?0:o.height-s.height-5),l+=l<0||g<l+s.width+5?p?-s.width/2:s.width/2:0,c=Se(3,3,new sf.svgbase.Rect(l,h,s.width+5,s.height+5),d,5,!1,!1,!p,d.x,d.y+(m?-3:3))):(d=new jt(m?o.x+o.width-3:o.x+3,o.y+o.height+f),l=o.x+(m?o.width-s.width-5:0),h=p?o.y-s.height-10-f:o.y+o.height+5+f,c=Se(3,3,new sf.svgbase.Rect(l,h,s.width+5,s.height+5),d,5,p,!p,!1,d.x+(m?3:-3),d.y)),l+=2.5,h=h+s.height/4*3+2.5,a=e.renderer.drawPath({id:e.element.id+"_Zoom_"+r+"_AxisLabel_Shape_"+m,fill:e.themeStyle.crosshairFill,width:2,color:e.themeStyle.crosshairFill,opacity:1,"stroke-dasharray":null,d:c},null),i.appendChild(a),"Fluent"===e.theme||"FluentDark"===e.theme){var y=e.element.id+"_shadow";a.setAttribute("filter",sf.base.Browser.isIE?"":"url(#"+y+")");var v='<filter id="'+y+'" height="130%"><feGaussianBlur in="SourceAlpha" stdDeviation="3"/>';v+='<feOffset dx="3" dy="3" result="offsetblur"/><feComponentTransfer><feFuncA type="linear" slope="0.5"/>',v+='</feComponentTransfer><feMerge><feMergeNode/><feMergeNode in="SourceGraphic"/></feMerge></filter>';var b=e.renderer.createDefs();b.setAttribute("id",e.element.id+"SVG_tooltip_definition"),i.appendChild(b),b.innerHTML=v,a.setAttribute("stroke","#cccccc"),a.setAttribute("stroke-width","0.5")}It(e.renderer,new sf.svgbase.TextOption(e.element.id+"_Zoom_"+r+"_AxisLabel_"+m,l,h,u,m?t.endLabel:t.startLabel),{color:e.themeStyle.crosshairLabel,fontFamily:"Segoe UI",fontWeight:"Regular",size:"11px"},e.themeStyle.crosshairLabel,i)}return i}function Se(e,t,i,r,n,o,s,a,l,h){var d="",c=i.x,p=i.y,u=i.x+i.width,g=i.y+i.height;return o?(d=(d=(d=d.concat("M "+c+" "+(p+t)+" Q "+c+" "+p+" "+(c+e)+" "+p)).concat(" L "+(u-e)+" "+p+" Q "+u+" "+p+" "+u+" "+(p+t))).concat(" L "+u+" "+(g-t)+" Q "+u+" "+g+" "+(u-e)+" "+g),0!==n&&(d=(d=d.concat(" L "+(r.x+n/2)+" "+g)).concat(" L "+l+" "+(g+n)+" L "+(r.x-n/2)+" "+g)),d=r.x-n/2>c||0===n?d.concat(" L "+(c+e)+" "+g+" Q "+c+" "+g+" "+c+" "+(g-t)+" z"):d.concat(" L "+c+" "+(g+t)+" z")):d=s?(d=(d=(d=(d=(d=d.concat("M "+c+" "+(p+t)+" Q "+c+" "+p+" "+(c+e)+" "+p+" L "+(r.x-n/2)+" "+p)).concat(" L "+l+" "+r.y)).concat(" L "+(r.x+n/2)+" "+p)).concat(" L "+(u-e)+" "+p+" Q "+u+" "+p+" "+u+" "+(p+t))).concat(" L "+u+" "+(g-t)+" Q "+u+" "+g+" "+(u-e)+" "+g)).concat(" L "+(c+e)+" "+g+" Q "+c+" "+g+" "+c+" "+(g-t)+" z"):a?(d=(d=(d=(d=(d=d.concat("M "+c+" "+(p+t)+" Q "+c+" "+p+" "+(c+e)+" "+p)).concat(" L "+(u-e)+" "+p+" Q "+u+" "+p+" "+u+" "+(p+t)+" L "+u+" "+(r.y-n/2))).concat(" L "+(u+n)+" "+h)).concat(" L "+u+" "+(r.y+n/2))).concat(" L "+u+" "+(g-t)+" Q "+u+" "+g+" "+(u-e)+" "+g)).concat(" L "+(c+e)+" "+g+" Q "+c+" "+g+" "+c+" "+(g-t)+" z"):(d=(d=(d=(d=(d=d.concat("M "+(c+e)+" "+p+" Q "+c+" "+p+" "+c+" "+(p+t)+" L "+c+" "+(r.y-n/2))).concat(" L "+(c-n)+" "+h)).concat(" L "+c+" "+(r.y+n/2))).concat(" L "+c+" "+(g-t)+" Q "+c+" "+g+" "+(c+e)+" "+g)).concat(" L "+(u-e)+" "+g+" Q "+u+" "+g+" "+u+" "+(g-t))).concat(" L "+u+" "+(p+t)+" Q "+u+" "+p+" "+(u-e)+" "+p+" z"),d}function Ce(e,t,i,r,n){return void 0===r&&(r=0),void 0===n&&(n=0),e>=i.x-r&&e<=i.x+i.width+r&&t>=i.y-n&&t<=i.y+i.height+n}function Oe(e,t,i){return(i.isAxisInverse?1-e/t:e/t)*i.visibleRange.delta+i.visibleRange.min}function Te(e,t,i){return(i.isAxisInverse?e/t:1-e/t)*i.visibleRange.delta+i.visibleRange.min}function Pe(e,t){void 0===t&&(t=!1);var i=e.clipRect;!t||"Polar"!==e.type&&"Radar"!==e.type?e.chart.requireInvertedAxis?(i.x=e.yAxis.rect.x,i.y=e.xAxis.rect.y,i.width=e.yAxis.rect.width,i.height=e.xAxis.rect.height):(i.x=e.xAxis.rect.x,i.y=e.yAxis.rect.y,i.width=e.xAxis.rect.width,i.height=e.yAxis.rect.height):"Scatter"===e.drawType?(i.x=e.xAxis.rect.x,i.y=e.yAxis.rect.y,i.width=e.xAxis.rect.width,i.height=e.yAxis.rect.height):(i.x=e.xAxis.rect.x/2,i.y=e.yAxis.rect.y/2,i.width=e.xAxis.rect.width,i.height=e.yAxis.rect.height)}function Ae(e){return e.substr(0,1).toLowerCase()+e.substr(1)}function Le(e,t,i){var r,n,o,s;return i?(r=t.rect.x,n=e.rect.y,o=t.rect.width,s=e.rect.height):(r=e.rect.x,n=t.rect.y,o=e.rect.width,s=t.rect.height),new sf.svgbase.Rect(r,n,o,s)}function Fe(e,t){for(var i,r,n,o=Number.MAX_VALUE,s=0;s<t.length;s++){var a=t[s];if(i=[],a.visible&&(e.name===a.xAxisName||"primaryXAxis"===e.name&&null===a.xAxisName||e.name===a.chart.primaryXAxis.name&&!a.xAxisName))if((i=a.points.map((function(e){return e.xValue}))).sort((function(e,t){return e-t})),1===i.length)n="DateTime"===e.valueType&&a.xMin===a.xMax?a.xMin-2592e6:a.xMin,0!==(r=i[0]-(sf.base.isNullOrUndefined(n)?e.visibleRange.min:n))&&(o=Math.min(o,r));else for(var l=0;l<i.length;l++){var h=i[l];l>0&&h&&0!==(r=h-i[l-1])&&(o=Math.min(o,r))}}return o===Number.MAX_VALUE&&(o=1),o}function De(e){var t;switch(e){case"Linear":t=Ee}return t}function Ee(e,t,i,r){return-i*Math.cos(e/r*(Math.PI/2))+i+t}function ze(e,t,i,r,n,o,s){var a=o.x,l=o.y,h=0;e.style.visibility="hidden",new sf.base.Animation({}).animate(e,{duration:i,delay:t,progress:function(t){t.timeStamp>t.delay&&(t.element.style.visibility="visible",h=(t.timeStamp-t.delay)/t.duration,e.setAttribute("transform","translate("+a+" "+l+") scale("+h+") translate("+-a+" "+-l+")"))},end:function(){e.style.visibility="","Scatter"!==r.type&&"Bubble"!==r.type||s||n!==r.points.length-1||r.chart.trigger("animationComplete",{series:r.chart.isBlazor?{}:r})}})}function ke(e,t,i,r,n){var o=function(t){e.setAttribute("x",t.x+""),e.setAttribute("y",t.y+""),e.setAttribute("width",t.width+""),e.setAttribute("height",t.height+"")};new sf.base.Animation({}).animate(sf.base.createElement("div"),{duration:i,delay:t,progress:function(e){o(new sf.svgbase.Rect(Ee(e.timeStamp,n.x,r.x-n.x,e.duration),Ee(e.timeStamp,n.y,r.y-n.y,e.duration),Ee(e.timeStamp,n.width,r.width-n.width,e.duration),Ee(e.timeStamp,n.height,r.height-n.height,e.duration)))},end:function(){o(r)}})}function We(e,t,i,r,n){if(!i||!r&&!e)return null;var o=300;n&&(o=n);var s,a,l,h=r||e.getAttribute("d"),d=h.split(/(?=[LMCZAQ])/),c=t.split(/(?=[LMCZAQ])/),p=[],u=[];e.setAttribute("d",h),new sf.base.Animation({}).animate(sf.base.createElement("div"),{duration:o,progress:function(t){s="",d.map((function(e,i){if(p=e.split(" "),u=c[i]?c[i].split(" "):p,"Z"===p[0]?s+="Z ":s+=p[0]+" "+Ee(t.timeStamp,+p[1],+u[1]-+p[1],t.duration)+" "+Ee(t.timeStamp,+p[2],+u[2]-+p[2],t.duration)+" ","C"===p[0]||"Q"===p[0])for(a=3,l="Q"===p[0]?4:6;a<l;)s+=Ee(t.timeStamp,+p[a],+u[a]-+p[a],t.duration)+" "+Ee(t.timeStamp,+p[++a],+u[a]-+p[a],t.duration)+" ",++a;"A"===p[0]&&(s+="0 0 1 "+Ee(t.timeStamp,+p[6],+u[6]-+p[6],t.duration)+" "+Ee(t.timeStamp,+p[7],+u[7]-+p[7],t.duration)+" ")})),e.setAttribute("d",s)},end:function(){e.setAttribute("d",t)}})}function Re(e,t,i,r){void 0===r&&(r="drawClipPath");var n=Mt(e,t.id,t,i);if(n){var o=i.createDefs();return o.appendChild(n),o}return i[r](t)}function je(e,t,i,r,n){var o={cancel:!1,name:"axisLabelRender",axis:n,text:i,value:t,labelStyle:r};if(e.trigger("axisLabelRender",o),!o.cancel){var s=-1!==o.text.indexOf("<br>"),a=n.enableTrim?s?wt(n.maximumLabelWidth,o.text,n.labelStyle):bt(n.maximumLabelWidth,o.text,n.labelStyle):o.text;n.visibleLabels.push(new Z(a,o.value,o.labelStyle,o.text))}}function Ue(e){return null!=e.minimum&&null!=e.maximum}function He(e){return e.zoomFactor<1&&e.zoomPosition>=0}function Be(e,t){var i="Horizontal"===t.orientation?e.width:e.height;if(sf.base.isNullOrUndefined(t.desiredIntervals)){var r=("Horizontal"===t.orientation?.533:1)*t.maximumLabels;return r=Math.max(i*(r/100),1)}return t.desiredIntervals}function _e(e,t,i,r,n){new sf.base.Animation({}).animate(e,{duration:i,delay:t,name:r,progress:function(e){e.element.style.visibility="visible"},end:function(e){n?sf.base.remove(e.element):e.element.style.visibility="visible"}})}function Ve(e,t,i,r,n,o,s,a,l,h){var d=s||new sf.svgbase.SvgRenderer(""),c=Ye(e,i,t,n,r,l,h);return d["draw"+c.functionName](c.renderOption,a?new Int32Array([a.x,a.y]):null)}function Ye(e,t,i,r,n,o,s){var a,l,h,d="Path",c=o,p=c&&"Circle"===i?t.width-2:t.width,u=c&&"Circle"===i?t.height-2:t.height,g=c?s.targetWidth:0,f=e.x,m=e.y,y=e.y+-u/2,v=e.x+-p/2;switch(i){case"Bubble":case"Circle":d="Ellipse",sf.base.merge(r,{rx:p/2,ry:u/2,cx:f,cy:m});break;case"Cross":a="M "+v+" "+m+" L "+(f+p/2)+" "+m+" M "+f+" "+(m+u/2)+" L "+f+" "+(m+-u/2),sf.base.merge(r,{d:a,stroke:r.fill});break;case"Multiply":a="M "+(f-g)+" "+(m-g)+" L "+(f+g)+" "+(m+g)+" M "+(f-g)+" "+(m+g)+" L "+(f+g)+" "+(m-g),sf.base.merge(r,{d:a,stroke:r.fill});break;case"HorizontalLine":a="M "+v+" "+m+" L "+(f+p/2)+" "+m,sf.base.merge(r,{d:a});break;case"VerticalLine":a="M "+f+" "+(m+u/2)+" L "+f+" "+(m+-u/2),sf.base.merge(r,{d:a});break;case"Diamond":a="M "+v+" "+m+" L "+f+" "+(m+-u/2)+" L "+(f+p/2)+" "+m+" L "+f+" "+(m+u/2)+" L "+v+" "+m+" z",sf.base.merge(r,{d:a});break;case"ActualRect":a="M "+v+" "+(m+-u/8)+" L "+(f+g)+" "+(m+-u/8)+" L "+(f+g)+" "+(m+u/8)+" L "+v+" "+(m+u/8)+" L "+v+" "+(m+-u/8)+" z",sf.base.merge(r,{d:a});break;case"TargetRect":a="M "+(v+g)+" "+(m+-u/2)+" L "+(f+g/2)+" "+(m+-u/2)+" L "+(f+g/2)+" "+(m+u/2)+" L "+(v+g)+" "+(m+u/2)+" L "+(v+g)+" "+(m+-u/2)+" z",sf.base.merge(r,{d:a});break;case"Rectangle":case"Hilo":case"HiloOpenClose":case"Candle":case"Waterfall":case"BoxAndWhisker":case"StepArea":case"StackingStepArea":case"Square":case"Flag":a="M "+v+" "+(m+-u/2)+" L "+(f+p/2)+" "+(m+-u/2)+" L "+(f+p/2)+" "+(m+u/2)+" L "+v+" "+(m+u/2)+" L "+v+" "+(m+-u/2)+" z",sf.base.merge(r,{d:a});break;case"Pyramid":case"Triangle":a="M "+v+" "+(m+u/2)+" L "+f+" "+(m+-u/2)+" L "+(f+p/2)+" "+(m+u/2)+" L "+v+" "+(m+u/2)+" z",sf.base.merge(r,{d:a});break;case"Funnel":case"InvertedTriangle":a="M "+(f+p/2)+" "+(m-u/2)+" L "+f+" "+(m+u/2)+" L "+(f-p/2)+" "+(m-u/2)+" L "+(f+p/2)+" "+(m-u/2)+" z",sf.base.merge(r,{d:a});break;case"Pentagon":for(var b=0;b<=5;b++)l=p/2*Math.cos(Math.PI/180*(72*b)),h=u/2*Math.sin(Math.PI/180*(72*b)),a=0===b?"M "+(f+l)+" "+(m+h)+" ":a.concat("L "+(f+l)+" "+(m+h)+" ");a=a.concat("Z"),sf.base.merge(r,{d:a});break;case"Image":d="Image",sf.base.merge(r,{href:n,height:u,width:p,x:v,y:y})}return{renderOption:r=vt(e,new sf.svgbase.Size(p,u),i,r).renderOption,functionName:d}}function Qe(e,t,i){var r=t.x<i.x?i.x:t.x>i.x+i.width?i.x+i.width:t.x,n=t.y<i.y?i.y:t.y>i.y+i.height?i.y+i.height:t.y;return new sf.svgbase.Rect(r>e.x?e.x:r,n>e.y?e.y:n,Math.abs(r-e.x),Math.abs(n-e.y))}function qe(e,t,i){return e>i?i:e<t?t:e}function Ge(e){return document.getElementById(e)}function Xe(e){var t=null;try{t=document.querySelectorAll(e).length?sf.base.compile(document.querySelector(e).innerHTML.trim()):sf.base.compile(e)}catch(i){t=sf.base.compile(e)}return t}function Ze(e,t,i,r,n,o,s,a,l,h){var d=e.getBoundingClientRect();t.accumulationDataLabelModule.calculateLabelSize(i,e,o,r,n,s,a,l,h,d,!0)}function Ke(e,t,i,r,n,o){var s=document.getElementById(t.element.id+"_Series_"+(void 0===r.index?r.category:r.index)+"_DataLabelCollections");s&&(0===i.index&&(t.dataLabelCollections=[]),t.dataLabelModule.calculateTemplateLabelSize(s,e,i,r,r.marker.dataLabel,n,r.clipRect,o,!0))}function Je(e,t,i,r,n,o,s,a,l,h,d,c,p,u,g){var f,m=Xe(i);try{var y=window.Blazor?s?n:{point:n}:{chart:r,series:o,point:n},v=m?m(y,r,s?s+"_template":"template",s||e.id.replace(/[^a-zA-Z0-9]/g,"")):[];if(v.length)for(var b=(f=Array.prototype.slice.call(v)).length,w=0;w<b;w++)e.appendChild(f[w]);var x=void 0;"accumulationchart"===r.getModuleName()?(x=Ze.bind(this,e,r,h,d,l,d[t],c,p,u,g),r.isReact&&r.renderReactTemplates(x)):"chart"===r.getModuleName()&&(x=n&&o?Ke.bind(this,e,r,n,o,a,g):x,r.isReact&&r.renderReactTemplates(x))}catch(t){return e}return e}function $e(e){return"font-size:"+e.size+"; font-style:"+e.fontStyle+"; font-weight:"+e.fontWeight+"; font-family:"+e.fontFamily+";opacity:"+e.opacity+"; color:"+e.color+";"}function et(e,t,i){void 0===t&&(t=!1),i||document.body.appendChild(e);var r=e.getBoundingClientRect();return t?sf.base.remove(e):i||ie(e.id),r}function tt(e,t){for(var i,r=0,n=e.length;r<n;r++)e[r].id.indexOf(t)>-1&&(i=e[r]);return i}function it(e,t,i,r,n){e="Logarithmic"===i.valueType?re(e>0?e:Math.pow(i.logBase,i.visibleRange.min),i.logBase):e,t="Logarithmic"===r.valueType?re(t>0?t:Math.pow(r.logBase,r.visibleRange.min),r.logBase):t,e=ye(e,i),t=ye(t,r);var o=n?i.rect.height:i.rect.width,s=n?r.rect.width:r.rect.height;return new jt(n?t*s:e*o,n?(1-e)*o:(1-t)*s)}function rt(e,t,i,r,n,o){if(void 0===i&&(i=!1),void 0===r&&(r=!1),void 0===n&&(n="x"),void 0===o&&(o="y"),!(e&&e.hasChildNodes()&&t))return null;nt(!1,t,e,i,r,n,o)}function nt(e,t,i,r,n,o,s,a,l,h,d,c,p){if(void 0===n&&(n=!1),void 0===o&&(o="x"),void 0===s&&(s="y"),void 0===h&&(h=!1),void 0===d&&(d=!1),void 0===c&&(c=null),e)return null;var u=t.querySelector("#"+i.id),g=u||Ge(i.id),f=i,m=p||300;if(r&&n&&g)if(a=a||("DIV"===g.tagName?new jt(+g.style[o].split("px")[0],+g.style[s].split("px")[0]):new jt(+g.getAttribute(o),+g.getAttribute(s))),l&&"undefined"!==l)We(i,i.getAttribute("d"),r,l,m);else if(d&&c)ke(f,0,m,new sf.svgbase.Rect(+g.getAttribute("x"),+g.getAttribute("y"),+g.getAttribute("width"),+g.getAttribute("height")),c);else{var y="DIV"===f.tagName?new jt(+f.style[o].split("px")[0],+f.style[s].split("px")[0]):new jt(+f.getAttribute(o),+f.getAttribute(s));Nt(f,m,a,y,o,s)}else r&&n&&!g&&h&&_e(f,0,600,"FadeIn");u?t.replaceChild(f,g):t.appendChild(f)}function ot(e,t,i,r,n){var o=Math.abs(e-i),s=Math.abs(t-r),a=Math.max(st(Math.min(e,i),o,n.x,n.width),n.x),l=Math.max(st(Math.min(t,r),s,n.y,n.height),n.y);return new sf.svgbase.Rect(a,l,Math.min(o,n.width),Math.min(s,n.height))}function st(e,t,i,r){return e<i?e=i:e+t>r+i&&(e=r+i-t),e}function at(e,t,i){var r=t.marker.dataLabel.format?t.marker.dataLabel.format:t.yAxis.labelFormat,n=[],o=null!==r.match("{value}");switch(t.seriesType){case"XY":"PolarRadar"===t.chart.chartAreaType?-1!==t.drawType.indexOf("Stacking")?("Logarithmic"===t.yAxis.valueType&&ae(t.stackedValues.endValues[e.index],t.yAxis)||se(t.stackedValues.endValues[e.index],t.yAxis.visibleRange))&&n.push(e.text||e.yValue.toString()):("Logarithmic"===t.yAxis.valueType&&ae(e.yValue,t.yAxis)||se(e.yValue,t.yAxis.visibleRange))&&n.push(e.text||e.yValue.toString()):n.push(e.text||e.yValue.toString());break;case"HighLow":n.push(e.text||Math.max(e.high,e.low).toString()),n.push(e.text||Math.min(e.high,e.low).toString());break;case"HighLowOpenClose":n.push(e.text||Math.max(e.high,e.low).toString()),n.push(e.text||Math.min(e.high,e.low).toString()),n.push(e.text||Math.max(e.open,e.close).toString()),n.push(e.text||Math.min(e.open,e.close).toString());break;case"BoxPlot":n.push(e.text||e.median.toString()),n.push(e.text||e.maximum.toString()),n.push(e.text||e.minimum.toString()),n.push(e.text||e.upperQuartile.toString()),n.push(e.text||e.lowerQuartile.toString());for(var s=0,a=e.outliers;s<a.length;s++){var l=a[s];n.push(e.text||l.toString())}}if((r||i.useGroupingSeparator)&&!e.text){t.yAxis.format=i.intl.getNumberFormat({format:o?"":r,useGrouping:i.useGroupingSeparator});for(var h=0;h<n.length;h++)n[h]=o?r.replace("{value}",t.yAxis.format(parseFloat(n[h]))):t.yAxis.format(parseFloat(n[h]))}return n}function lt(e){window.clearInterval(e)}function ht(e,t,i){var r=new sf.svgbase.Rect(e.x+i.x,e.y+i.y,e.width,e.height);return t.some((function(e){return r.x<e.x+e.width&&r.x+r.width>e.x&&r.y<e.y+e.height&&r.height+r.y>e.y}))}function dt(e,t){return e.x<t.x+t.width&&e.x+e.width>t.x&&e.y<t.y+t.height&&e.height+e.y>t.y}function ct(e,t,i){return new sf.svgbase.Rect(e.x-t.width/2-i.left,e.y-t.height/2-i.top,t.width+i.left+i.right,t.height+i.top+i.bottom)}function pt(e){return"#"+ut(e.r)+ut(e.g)+ut(e.b)}function ut(e){var t=e.toString(16);return 1===t.length?"0"+t:t}function gt(e){var t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?new Bt(parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16)):new Bt(255,255,255)}function ft(e){e="transparent"===e?"white":e,document.body.appendChild(sf.base.createElement("text",{id:"chartmeasuretext"}));var t=document.getElementById("chartmeasuretext");t.style.color=e,e=window.getComputedStyle(t).color,sf.base.remove(t);var i=/^(rgb|hsl)(a?)[(]\s*([\d.]+\s*%?)\s*,\s*([\d.]+\s*%?)\s*,\s*([\d.]+\s*%?)\s*(?:,\s*([\d.]+)\s*)?[)]$/.exec(e);return pt(new Bt(parseInt(i[3],10),parseInt(i[4],10),parseInt(i[5],10)))}function mt(e,t){(e=(e=ft(e)).replace(/[^0-9a-f]/gi,"")).length<6&&(e=e[0]+e[0]+e[1]+e[1]+e[2]+e[2]),t=t||0;for(var i,r="#",n=0;n<3;n++)i=parseInt(e.substr(2*n,2),16),r+=("00"+(i=Math.round(Math.min(Math.max(0,i+i*t),255))).toString(16)).substr(i.toString(16).length);return r}function yt(e){var t=Math.floor(e.length/2);return e.length%2?e[t]:(e[t-1]+e[t])/2}function vt(e,t,i,r){var n="",o=t.height,s=t.width,a=e.x,l=e.y;switch(i){case"MultiColoredLine":case"Line":case"StackingLine":case"StackingLine100":n="M "+(a+3/4*-s)+" "+l+" L "+(a+s*(3/4))+" "+l,sf.base.merge(r,{d:n});break;case"StepLine":r.fill="transparent",n="M "+(a+-s/2-2.5)+" "+(l+o/2)+" L "+(a+-s/2+s/10)+" "+(l+o/2)+" L "+(a+-s/2+s/10)+" "+l+" L "+(a+-s/10)+" "+l+" L "+(a+-s/10)+" "+(l+o/2)+" L "+(a+s/5)+" "+(l+o/2)+" L "+(a+s/5)+" "+(l+-o/2)+" L "+(a+s/2)+" "+(l+-o/2)+"L "+(a+s/2)+" "+(l+o/2)+" L"+(a+s/2+2.5)+" "+(l+o/2),sf.base.merge(r,{d:n});break;case"UpArrow":r.fill=r.stroke,r.stroke="transparent",n="M "+(a+-s/2)+" "+(l+o/2)+" L "+a+" "+(l-o/2)+" L "+(a+s/2)+" "+(l+o/2)+"L "+(a+s/2-2)+" "+(l+o/2)+" L "+a+" "+(l-o/2+4)+"L"+(a-s/2+2)+" "+(l+o/2)+" Z",sf.base.merge(r,{d:n});break;case"DownArrow":n="M "+(a-s/2)+" "+(l-o/2)+" L "+a+" "+(l+o/2)+" L "+(a+s/2)+" "+(l-o/2)+"L "+(a+s/2-2)+" "+(l-o/2)+" L "+a+" "+(l+o/2-4)+"L"+(a-s/2+2)+" "+(l-o/2)+" Z",sf.base.merge(r,{d:n});break;case"RightArrow":n="M "+(a+-s/2)+" "+(l-o/2)+" L "+(a+s/2)+" "+l+" L "+(a+-s/2)+" "+(l+o/2)+" L "+(a+-s/2)+" "+(l+o/2-2)+" L "+(a+s/2-4)+" "+l+" L"+(a+-s/2)+" "+(l-o/2+2)+" Z",sf.base.merge(r,{d:n});break;case"LeftArrow":r.fill=r.stroke,r.stroke="transparent",n="M "+(a+s/2)+" "+(l-o/2)+" L "+(a+-s/2)+" "+l+" L "+(a+s/2)+" "+(l+o/2)+" L "+(a+s/2)+" "+(l+o/2-2)+" L "+(a+-s/2+4)+" "+l+" L"+(a+s/2)+" "+(l-o/2+2)+" Z",sf.base.merge(r,{d:n});break;case"Column":case"Pareto":case"StackingColumn":case"StackingColumn100":case"RangeColumn":case"Histogram":n="M "+(a-s/5*3)+" "+(l-o/5)+" L "+(a+-s/10*3)+" "+(l-o/5)+" L "+(a+-s/10*3)+" "+(l+o/2)+" L "+(a-s/5*3)+" "+(l+o/2)+" Z M "+(a+-s/10-s/20)+" "+(l-o/4-5)+" L "+(a+s/10+s/20)+" "+(l-o/4-5)+" L "+(a+s/10+s/20)+" "+(l+o/2)+" L "+(a+-s/10-s/20)+" "+(l+o/2)+" Z M "+(a+s/10*3)+" "+l+" L "+(a+s/5*3)+" "+l+" L "+(a+s/5*3)+" "+(l+o/2)+" L "+(a+s/10*3)+" "+(l+o/2)+" Z",sf.base.merge(r,{d:n});break;case"Bar":case"StackingBar":case"StackingBar100":n="M "+(a+-s/2+-2.5)+" "+(l-o/5*3)+" L "+(a+s/10*3)+" "+(l-o/5*3)+" L "+(a+s/10*3)+" "+(l-o/10*3)+" L "+(a-s/2-2.5)+" "+(l-o/10*3)+" Z M "+(a+-s/2+-2.5)+" "+(l-o/5+.5)+" L "+(a+s/2+2.5)+" "+(l-o/5+.5)+" L "+(a+s/2+2.5)+" "+(l+o/10+.5)+" L "+(a-s/2-2.5)+" "+(l+o/10+.5)+" Z M "+(a-s/2-2.5)+" "+(l+o/5+1)+" L "+(a+-s/4)+" "+(l+o/5+1)+" L "+(a+-s/4)+" "+(l+o/2+1)+" L "+(a-s/2-2.5)+" "+(l+o/2+1)+" Z",sf.base.merge(r,{d:n});break;case"Spline":r.fill="transparent",n="M "+(a-s/2)+" "+(l+o/5)+" Q "+a+" "+(l-o)+" "+a+" "+(l+o/5)+" M "+a+" "+(l+o/5)+" Q "+(a+s/2)+" "+(l+o/2)+" "+(a+s/2)+" "+(l-o/2),sf.base.merge(r,{d:n});break;case"Area":case"MultiColoredArea":case"RangeArea":case"StackingArea":case"StackingArea100":n="M "+(a-s/2-2.5)+" "+(l+o/2)+" L "+(a+-s/4+-1.25)+" "+(l-o/2)+" L "+a+" "+(l+o/4)+" L "+(a+s/4+1.25)+" "+(l+-o/2+o/4)+" L "+(a+o/2+2.5)+" "+(l+o/2)+" Z",sf.base.merge(r,{d:n});break;case"SplineArea":case"SplineRangeArea":n="M "+(a-s/2)+" "+(l+o/5)+" Q "+a+" "+(l-o)+" "+a+" "+(l+o/5)+" Z M "+a+" "+(l+o/5)+" Q "+(a+s/2)+" "+(l+o/2)+" "+(a+s/2)+" "+(l-o/2)+"  Z",sf.base.merge(r,{d:n});break;case"Pie":case"Doughnut":r.stroke="transparent",n=function(e,t,i,r,n,o){var s=pe(270,i,new jt(e,t)),a=pe(270,i,new jt(e+n/10,t));return"M "+e+" "+t+" L "+(e+i)+" "+t+" A "+i+" "+i+" 0 1 1 "+s.x+" "+s.y+" Z M "+(e+n/10)+" "+(t-r/10)+" L"+(e+i)+" "+(t-r/10)+" A "+i+" "+i+" 0 0 0 "+a.x+" "+a.y+" Z"}(a,l,Math.min(o,s)/2,o,s),sf.base.merge(r,{d:n})}return{renderOption:r}}function bt(e,t,i){var r=t,n=sf.svgbase.measureText(t,i).width;if(n>e)for(var o=t.length-1;o>=0;--o)if(r=t.substring(0,o)+"...",(n=sf.svgbase.measureText(r,i).width)<=e)return r;return r}function wt(e,t,i){for(var r=[],n=t.split("<br>"),o=0;o<n.length;o++){t=n[o];var s=sf.svgbase.measureText(t,i).width;if(s>e){for(var a=t.length-1;a>=0;--a)if(t=t.substring(0,a)+"...",(s=sf.svgbase.measureText(t,i).width)<=e){r.push(t);break}}else r.push(t)}return r}function xt(e,t){return null!=e?-1!==e.indexOf("%")?t/100*parseInt(e,10):parseInt(e,10):null}function Mt(e,t,i,r){if(!e)return null;var n=Ge(t);return n&&i&&r.setElementAttributes(i,"clipPath"===n.tagName?n.childNodes[0]:n),n}function Nt(e,t,i,r,n,o){void 0===n&&(n="x"),void 0===o&&(o="y");var s="DIV"===e.tagName,a=function(t,i){s?(e.style[n]=t+"px",e.style[o]=i+"px"):(e.setAttribute(n,t+""),e.setAttribute(o,i+""))};a(i.x,i.y),new sf.base.Animation({}).animate(sf.base.createElement("div"),{duration:t,progress:function(e){a(Ee(e.timeStamp,i.x,r.x-i.x,e.duration),Ee(e.timeStamp,i.y,r.y-i.y,e.duration))},end:function(){a(r.x,r.y)}})}function It(e,t,i,r,n,o,s,a,l,h,d,c,p,u){void 0===o&&(o=!1),void 0===l&&(l=!1);var g,f,m,y,v;g={id:t.id,x:t.x,y:t.y,fill:r||"black","font-size":i.size,"font-style":i.fontStyle,"font-family":i.fontFamily,"font-weight":i.fontWeight,"text-anchor":t.anchor,labelRotation:t.labelRotation,transform:t.transform,opacity:i.opacity,"dominant-baseline":t.baseLine};var b="string"==typeof t.text?t.text:o?t.text[t.text.length-1]:t.text[0],w=d?d.x:0,x=d?d.y:0,M=e.createText(g,b,w,x);if(M.style.fontFamily=i.fontFamily,M.style.fontStyle=i.fontStyle,M.style.fontSize=i.size,M.style.fontWeight=i.fontWeight,M.style.color=i.color,M.style.textAnchor=t.anchor,"string"!=typeof t.text&&t.text.length>1)for(var N=1,I=t.text.length;N<I;N++)m=sf.svgbase.measureText(t.text[N],i).height,y=t.y+(o?-N*m:N*m),v=o?t.text[t.text.length-(N+1)]:t.text[N],u?f=e.createText(g,v,null,null,y,!0):(f=e.createTSpan({x:t.x,id:t.id,y:y},v),M.appendChild(f));return p||nt(e instanceof sf.svgbase.CanvasRenderer,n,M,s,a,"x","y",null,null,l,!1,null,h),M}function St(e){var t=e.element.clientWidth||e.element.offsetWidth,i=e.element.clientHeight;e.stockChart&&(t=e.stockChart.availableSize.width,i=e.stockChart.availableSize.height);var r,n=450;if("rangeNavigator"===e.getModuleName()){var o=e,s=o.tooltip.enable?35:0,a=o.periodSelectorSettings.periods.length?o.periodSelectorSettings.height:0;r=o.margin.top+o.margin.bottom+s;var l=sf.svgbase.measureText("tempString",o.labelStyle).height;n=(e.series.length?sf.base.Browser.isDevice?80:120:(o.enableGrouping?55+l:40)+r)+a,o.disableRangeSelector&&(n=a)}if(e.availableSize=new sf.svgbase.Size(xt(e.width,t)||t||600,xt(e.height,i||n)||i||n),t&&e.availableSize.width>t&&(e.availableSize.width=t),"chart"===e.getModuleName()){var h=1,d=1;""!==e.width&&null!==e.width&&"100%"!==e.width||(h=e.element.getBoundingClientRect().width>0?e.element.getBoundingClientRect().width/e.availableSize.width:1,d=e.element.getBoundingClientRect().height>0?e.element.getBoundingClientRect().height/e.availableSize.height:1,e.availableSize.width=e.availableSize.width*h,e.availableSize.height=e.availableSize.height*d,e.scaleX=h,e.scaleY=d)}}function Ct(e){e.canvasRender=new sf.svgbase.CanvasRenderer(e.element.id),e.renderer=e.enableCanvas?e.canvasRender:new sf.svgbase.SvgRenderer(e.element.id),St(e),e.stockChart&&"chart"===e.getModuleName()?e.svgObject=e.stockChart.chartObject:e.stockChart&&"rangeNavigator"===e.getModuleName()?e.svgObject=e.stockChart.selectorObject:e.enableCanvas?e.svgObject=e.renderer.createCanvas({id:e.element.id+"_canvas",width:e.availableSize.width,height:e.availableSize.height}):e.svgObject=e.renderer.createSvg({id:e.element.id+"_svg",width:e.availableSize.width,height:e.availableSize.height}),e.enableCanvas&&(e.renderer.ctx.direction=e.enableRtl?"rtl":"ltr")}function Ot(e,t,i){var r=[];switch(t.textOverflow){case"Wrap":r=Pt(e,i,t);break;case"Trim":r.push(bt(i,e,t));break;default:r.push(e)}return r}function Tt(e,t){return"Near"===t.textAlignment?e.x:"Center"===t.textAlignment?e.x+e.width/2:e.x+e.width}function Pt(e,t,i,r,n){if(r)return At(e,t,i);for(var o=e.split(" "),s="",a=[],l=void 0,h=0,d=o.length;h<d;h++)l=o[h],sf.svgbase.measureText(s.concat(""===s?"":" "+l),i).width<t?s=s.concat((""===s?"":" ")+l):""!==s?(a.push(n?s:bt(t,s,i)),s=l):(a.push(n?l:bt(t,l,i)),l=""),s&&h===d-1&&a.push(n?s:bt(t,s,i));return a}function At(e,t,i){var r=sf.svgbase.measureText(e,i).width,n=[];if(r>t){for(var o="",s=0,a=1;a<e.length;)o=e.substring(s,a),(r=sf.svgbase.measureText(o,i).width)<t?a++:r===t?(s=a,n.push(o),a++,o=""):r>t&&(o=o.slice(0,-1),s=a-1,n.push(o),o="");o.length>0&&n.push(o)}else n.push(e);return n}function Lt(e,t){for(var i=e.replace(t," "),r=e.match(t),n=" ",o=" ",s=0,a={0:"₀",1:"₁",2:"₂",3:"₃",4:"₄",5:"₅",6:"₆",7:"₇",8:"₈",9:"₉"},l={0:"⁰",1:"¹",2:"²",3:"³",4:"⁴",5:"⁵",6:"⁶",7:"⁷",8:"⁸",9:"⁹"},h=0;h<=i.length-1;h++)if(" "===i[h]){n=t===O?r[s].replace(/~/g,""):r[s].replace(/\^/g,"");for(var d=0;d<n.length;d++)o+=t===O?a[n[d]]:l[n[d]];s++}else o+=i[h];return o.trim()}function Ft(e){for(var t=0;t<e.annotations.length;t++)sf.base.resetBlazorTemplate((e.element.id+"_Annotation_"+t).replace(/[^a-zA-Z0-9]/g,""),"ContentTemplate");sf.base.resetBlazorTemplate(e.element.id+"_tooltipparent_template_blazorTemplate","Template"),sf.base.resetBlazorTemplate(e.element.id+"_DataLabel")}var Dt=function(e){this.id=e},Et=function(e,t){this.startValues=e,this.endValues=t},zt=function(e){function t(t,i,r,n,o,s,a,l,h){var d=e.call(this,t,i,r.width,r.color,n,h)||this;return d.y=o.y,d.x=o.x,d.height=o.height,d.width=o.width,d.rx=s||0,d.ry=a||0,d.transform=l||"",d.stroke=0!==r.width&&""!==d.stroke?r.color:"transparent",d}return K(t,e),t}(sf.svgbase.PathOption),kt=function(e,t,i,r,n,o,s,a){this.height=e,this.width=t,this.href=i,this.x=r,this.y=n,this.id=o,this.visibility=s,this.preserveAspectRatio=a},Wt=function(e){function t(t,i,r,n,o,s,a){var l=e.call(this,t,i,r.width,r.color,n)||this;return l.cy=s,l.cx=o,l.r=a,l}return K(t,e),t}(sf.svgbase.PathOption),Rt=function(e,t,i){this.id=e,this.points=t,this.fill=i},jt=function(e,t){this.x=e,this.y=t},Ut=function(e,t){this.x=0,this.y=0,this.x=e,this.y=t},Ht=function(e,t,i,r){this.left=e,this.right=t,this.top=i,this.bottom=r},Bt=function(e,t,i){this.r=e,this.g=t,this.b=i},_t=function(e,t,i){void 0===i&&(i=0),this.point=e,this.series=t,this.lierIndex=i},Vt=function(e,t,i){void 0===i&&(i=0),this.point=e,this.series=t,this.index=i},Yt=function(e,t){this.controlPoint1=e,this.controlPoint2=t};function Qt(e,t){return Number(t)===e.start?e.colors[0]:Number(t)===e.end?e.colors[e.colors.length-1]:pt(qt(Number(t),e))}function qt(e,t){var i,r,n=t.start,o=t.end,s=0,a=o-n;if(s=(e-n)/a,t.colors.length<=2)i="#"===t.colors[0].charAt(0)?t.colors[0]:ft(t.colors[0]),r="#"===t.colors[t.colors.length-1].charAt(0)?t.colors[t.colors.length-1]:ft(t.colors[t.colors.length-1]);else{i="#"===t.colors[0].charAt(0)?t.colors[0]:ft(t.colors[0]),r="#"===t.colors[t.colors.length-1].charAt(0)?t.colors[t.colors.length-1]:ft(t.colors[t.colors.length-1]);for(var l=a/(t.colors.length-1),h=t.colors.length-1,d=[],c={},p=1;p<h;p++)c={b:n+p*l,color:t.colors[p]},d.push(c);for(var u=0;u<d.length;u++)n<=e&&e<=d[u].b&&0===u?(r="#"===d[u].color.charAt(0)?d[u].color:ft(d[u].color),s=e<=d[u].b?1-Math.abs((e-d[u].b)/l):(e-d[u].b)/l):d[u].b<=e&&e<=o&&u===d.length-1&&(i="#"===d[u].color.charAt(0)?d[u].color:ft(d[u].color),s=e<d[u].b?1-Math.abs((e-d[u].b)/l):(e-d[u].b)/l),u!==d.length-1&&u<d.length&&d[u].b<=e&&e<=d[u+1].b&&(i="#"===d[u].color.charAt(0)?d[u].color:ft(d[u].color),r="#"===d[u+1].color.charAt(0)?d[u+1].color:ft(d[u+1].color),s=Math.abs(e-d[u+1].b)/l)}return Gt(s,i,r)}function Gt(e,t,i){var r=i.split("#")[1],n=t.split("#")[1],o=Xt(e,parseInt(n.substr(0,2),16),parseInt(r.substr(0,2),16)),s=Xt(e,parseInt(n.substr(2,2),16),parseInt(r.substr(2,2),16)),a=Xt(e,parseInt(n.substr(4,2),16),parseInt(r.substr(4,2),16));return new Bt(o,s,a)}function Xt(e,t,i){var r=i-t;return Math.round(t+r*e)}function Zt(e,t){switch(e){case"Near":return t?"end":"start";case"Far":return t?"start":"end";default:return"middle"}}var Kt,Jt,$t,ei,ti,ii,ri,ni,oi,si,ai,li,hi,di,ci,pi,ui,gi,fi,mi,yi,vi,bi,wi,xi,Mi,Ni,Ii,Si,Ci,Oi,Ti,Pi,Ai,Li,Fi,Di,Ei,zi,ki,Wi,Ri,ji,Ui,Hi,Bi,_i,Vi,Yi,Qi,qi,Gi,Xi,Zi,Ki,Ji,$i,er=function(){function e(e){this.chart=e,this.padding=5}return e.prototype.measureAxis=function(e){var t=this.chart,i=t.chartArea.width?xt(t.chartArea.width,t.availableSize.width):null;this.crossAt(t),this.seriesClipRect=new sf.svgbase.Rect(e.x,e.y,e.width,e.height),this.initialClipRect=e,this.leftSize=0,this.rightSize=0,this.topSize=0,this.bottomSize=0,this.measureRowAxis(t,this.initialClipRect),this.initialClipRect=ce(this.initialClipRect,new Ht(this.leftSize,this.rightSize,0,0)),this.measureColumnAxis(t,this.initialClipRect),this.initialClipRect=ce(this.initialClipRect,new Ht(0,0,this.topSize,this.bottomSize)),this.chart.delayRedraw||this.calculateAxisSize(this.initialClipRect),this.leftSize=0,this.rightSize=0,this.topSize=0,this.bottomSize=0,this.measureRowAxis(t,this.initialClipRect),this.seriesClipRect=ce(this.seriesClipRect,new Ht(this.leftSize,this.rightSize,0,0)),this.measureColumnAxis(t,this.initialClipRect),this.seriesClipRect=ce(this.seriesClipRect,new Ht(0,0,this.topSize,this.bottomSize)),i&&this.calculateFixedChartArea(t,i),this.chart.delayRedraw||(t.refreshAxis(),this.calculateAxisSize(this.seriesClipRect))},e.prototype.calculateFixedChartArea=function(e,t){this.seriesClipRect.width=t,this.seriesClipRect.x=e.availableSize.width-e.margin.right-t-("Right"===e.legendSettings.position?e.legendModule.legendBounds.width:0);for(var i=0,r=e.rows;i<r.length;i++){var n=r[i];this.seriesClipRect.x-=he(n.farSizes)}},e.prototype.measureRowAxis=function(e,t){var i;this.calculateRowSize(t);for(var r=0,n=e.rows;r<n.length;r++){(i=n[r]).nearSizes=[],i.farSizes=[],i.insideNearSizes=[],i.insideFarSizes=[],this.arrangeAxis(i),this.measureDefinition(i,e,new sf.svgbase.Size(e.availableSize.width,i.computedHeight)),this.leftSize<he(i.nearSizes)&&(this.leftSize=he(i.nearSizes)),this.rightSize<he(i.farSizes)&&(this.rightSize=he(i.farSizes))}},e.prototype.measureColumnAxis=function(e,t){var i;this.calculateColumnSize(t);for(var r=0,n=e.columns;r<n.length;r++){(i=n[r]).farSizes=[],i.nearSizes=[],i.insideNearSizes=[],i.insideFarSizes=[],this.arrangeAxis(i),this.measureDefinition(i,e,new sf.svgbase.Size(i.computedWidth,e.availableSize.height)),this.bottomSize<he(i.nearSizes)&&(this.bottomSize=he(i.nearSizes)),this.topSize<he(i.farSizes)&&(this.topSize=he(i.farSizes))}},e.prototype.measureDefinition=function(e,t,i){for(var r=0,n=e.axes;r<n.length;r++){var o=n[r];o.scrollBarHeight=t.scrollBarModule&&t.zoomModule&&t.zoomSettings.enableScrollbar&&o.enableScrollbarOnZooming&&t.zoomModule.isZoomed&&(o.zoomFactor<1||o.zoomPosition>0)?16:0,o.scrollBarHeight=t.scrollBarModule&&(t.zoomModule&&t.zoomSettings.enableScrollbar&&o.enableScrollbarOnZooming&&t.zoomModule.isZoomed&&(o.zoomFactor<1||o.zoomPosition>0)||o.scrollbarSettings.enable)?16:0,o.getModule(t),o.baseModule.calculateRangeAndInterval(i,o),e.computeSize(o,o.scrollBarHeight,e,t)}e.farSizes.length>0&&(e.farSizes[e.farSizes.length-1]-=10),e.nearSizes.length>0&&(e.nearSizes[e.nearSizes.length-1]-=10)},e.prototype.calculateAxisSize=function(e){var t,i,r,n,o,s,a,l=this.chart,h=0,d=0,c=0;this.calculateRowSize(e);for(var p=0,u=l.rows.length;p<u;p++){h=0,d=0;for(var g=0,f=(t=l.rows[p]).axes.length;g<f;g++){if(a=(n=t.axes[g]).plotOffset,0===n.rect.height){n.rect.height=t.computedHeight,c=0;for(var m=p+1,y=p+n.span;m<y;m++)c+=(r=l.rows[m]).computedHeight;n.rect.y=t.computedTop-c+(n.plotOffsetTop?n.plotOffsetTop:a),n.rect.height=n.rect.height+c-this.getAxisOffsetValue(n.plotOffsetTop,n.plotOffsetBottom,n.plotOffset),n.rect.width=0}n.isAxisOpposedPosition?(o="Inside"===n.labelPosition&&"Vertical"===n.orientation?e.x+e.width-he(me(t.insideFarSizes,d)):e.x+e.width+he(me(t.farSizes,d)),n.rect.x=n.rect.x>=o?n.rect.x:o,d++):(o="Inside"===n.labelPosition&&"Vertical"===n.orientation?e.x+he(me(t.insideNearSizes,h)):e.x-he(me(t.nearSizes,h)),n.rect.x=n.rect.x<=o?n.rect.x:o,h++)}}this.calculateColumnSize(e);for(p=0,u=l.columns.length;p<u;p++){h=0,d=0;g=0;for(var v=(i=l.columns[p]).axes.length;g<v;g++){if(a=(n=i.axes[g]).plotOffset,0===n.rect.width){m=p;for(var b=p+n.span;m<b;m++)r=l.columns[m],n.rect.width+=r.computedWidth;n.rect.x=i.computedLeft+(n.plotOffsetLeft?n.plotOffsetLeft:a),n.rect.width-=this.getAxisOffsetValue(n.plotOffsetLeft,n.plotOffsetRight,n.plotOffset),n.rect.height=0}n.isAxisOpposedPosition?(s="Inside"===n.labelPosition&&"Horizontal"===n.orientation?e.y+he(me(i.insideFarSizes,d)):e.y-he(me(i.farSizes,d)),n.rect.y=n.rect.y<=s?n.rect.y:s,d++):(s="Inside"===n.labelPosition&&"Horizontal"===n.orientation?e.y+e.height-he(me(i.insideNearSizes,h)):e.y+e.height+he(me(i.nearSizes,h)),n.rect.y=n.rect.y>=s?n.rect.y:s,h++)}}},e.prototype.measure=function(){for(var e,t,i,r,n,o=this.chart,s=0,a=o.axisCollections;s<a.length;s++){var l=a[s];if("Vertical"===l.orientation){o.verticalAxes.push(l),r=this.getActualRow(l),e=o.rows[r],this.pushAxis(e,l),n=r+l.span>o.rows.length?o.rows.length:r+l.span;for(var h=r+1;h<n;h++)(i=o.rows[h]).axes[e.axes.length-1]=l,o.rows[h]=i;o.rows[r]=e}else{o.horizontalAxes.push(l),r=this.getActualColumn(l),t=o.columns[r],this.pushAxis(t,l),n=r+l.span>o.columns.length?o.columns.length:r+l.span;for(h=r+1;h<n;h++)(i=o.columns[h]).axes[t.axes.length-1]=l,o.columns[h]=i;o.columns[r]=t}l.isRTLEnabled=o.enableRtl,l.setIsInversedAndOpposedPosition()}},e.prototype.getAxisOffsetValue=function(e,t,i){return e?e+(t||i):t?t+i:2*i},e.prototype.crossAt=function(e){for(var t=0,i=e.axisCollections;t<i.length;t++){var r=i[t];if(null!==r.crossesAt)if(r.crossesInAxis)for(var n=2,o=e.axisCollections.length;n<o;n++)r.crossesInAxis!==e.axisCollections[n].name||(r.crossInAxis=e.axisCollections[n],r.crossAt=this.updateCrossAt(r.crossInAxis,r.crossesAt));else e.requireInvertedAxis?r.crossInAxis="Horizontal"===r.orientation?e.primaryXAxis:e.primaryYAxis:r.crossInAxis="Horizontal"===r.orientation?e.primaryYAxis:e.primaryXAxis,r.crossAt=this.updateCrossAt(r.crossInAxis,r.crossesAt)}},e.prototype.updateCrossAt=function(e,t){switch(e.valueType){case"DateTime":var i={skeleton:"full",type:"dateTime"},r=this.chart.intl.getDateParser(i),n=this.chart.intl.getDateFormat(i);return Date.parse(r(n(new Date(sf.data.DataUtil.parse.parseJson({val:t}).val))));case"Category":return parseFloat(t)?parseFloat(t):e.labels.indexOf(t);case"Logarithmic":return re(t,e.logBase);default:return t}},e.prototype.pushAxis=function(e,t){for(var i=0,r=e.axes.length;i<=r;i++)if(!e.axes[i]){e.axes[i]=t;break}},e.prototype.arrangeAxis=function(e){for(var t=[],i=0,r=e.axes.length;i<=r;i++)e.axes[i]&&t.push(e.axes[i]);e.axes=t},e.prototype.getActualColumn=function(e){var t=this.chart.columns.length,i=e.columnIndex;return i>=t?t-1:i<0?0:i},e.prototype.getActualRow=function(e){var t=this.chart.rows.length,i=e.rowIndex;return i>=t?t-1:i<0?0:i},e.prototype.calculateRowSize=function(e){for(/*! Calculate row size */var t,i=this.chart,r=e.y+e.height,n=0,o=Math.max(0,e.height),s=0,a=i.rows.length;s<a;s++)n=-1!==(t=i.rows[s]).height.indexOf("%")?Math.min(o,e.height*parseInt(t.height,10)/100):Math.min(o,parseInt(t.height,10)),n=s!==a-1?n:o,t.computedHeight=n,r-=n,t.computedTop=r,o-=n},e.prototype.calculateColumnSize=function(e){for(/*! Calculate column size */var t,i=this.chart,r=e.x,n=0,o=Math.max(0,e.width),s=0,a=i.columns.length;s<a;s++)n=-1!==(t=i.columns[s]).width.indexOf("%")?Math.min(o,e.width*parseInt(t.width,10)/100):Math.min(o,parseInt(t.width,10)),n=s!==a-1?n:o,t.computedWidth=n,t.computedLeft=r,r+=n,o-=n},e.prototype.renderAxes=function(){var e,t,i,r=this.chart,n=r.renderer.createGroup({id:r.element.id+"AxisInsideCollection"}),o=r.renderer.createGroup({id:r.element.id+"AxisOutsideCollection"});o&&o.setAttribute("aria-hidden","true");for(var s=0,a=r.axisCollections.length;s<a;s++){var l=!0;e=r.axisCollections[s],this.element=r.renderer.createGroup({id:r.element.id+"AxisGroup"+s+"Inside"}),this.element&&this.element.setAttribute("aria-hidden","true"),(t=r.renderer.createGroup({id:r.element.id+"AxisGroup"+s+"Outside"}))&&t.setAttribute("aria-hidden","true");for(var h=0,d=e.series;h<d.length;h++){var c=d[h];if(e.name!==c.yAxisName&&e.name!==c.xAxisName);else if(l=c.visible)break}l&&(i=this.findAxisPosition(e),"Horizontal"===e.orientation?(e.updateCrossValue(),e.visible&&e.internalVisibility&&e.lineStyle.width>0&&this.drawAxisLine(e,s,e.plotOffset,0,0,0,e.plotOffsetLeft,e.plotOffsetRight,i?t:this.element,e.updatedRect),(e.majorGridLines.width>0||e.majorTickLines.width>0)&&this.drawXAxisGridLine(e,s,i||"Inside"===e.tickPosition?t:this.element,e.updatedRect),e.visible&&e.internalVisibility&&(this.drawXAxisLabels(e,s,i||"Inside"===e.labelPosition?t:this.element,e.placeNextToAxisLine?e.updatedRect:e.rect),this.drawXAxisBorder(e,s,i||"Inside"===e.labelPosition?t:this.element,e.placeNextToAxisLine?e.updatedRect:e.rect),this.drawXAxisTitle(e,s,i?t:this.element,e.placeNextToAxisLine?e.updatedRect:e.rect))):(e.updateCrossValue(),e.visible&&e.internalVisibility&&e.lineStyle.width>0&&this.drawAxisLine(e,s,0,e.plotOffset,e.plotOffsetBottom,e.plotOffsetTop,0,0,i?t:this.element,e.updatedRect),(e.majorGridLines.width>0||e.majorTickLines.width>0)&&this.drawYAxisGridLine(e,s,i||"Inside"===e.tickPosition?t:this.element,e.updatedRect),e.visible&&e.internalVisibility&&(this.drawYAxisLabels(e,s,i||"Inside"===e.labelPosition?t:this.element,e.placeNextToAxisLine?e.updatedRect:e.rect),this.drawYAxisBorder(e,s,i||"Inside"===e.labelPosition?t:this.element,e.placeNextToAxisLine?e.updatedRect:e.rect),this.drawYAxisTitle(e,s,i?t:this.element,e.placeNextToAxisLine?e.updatedRect:e.rect))),this.chart.enableCanvas||(n.appendChild(this.element),t&&t.childNodes.length>0&&o.appendChild(t)),r.scrollBarModule&&(r.zoomSettings.enableScrollbar&&e.enableScrollbarOnZooming||e.scrollbarSettings.enable)&&this.renderScrollbar(r,e))}this.element=r.renderer.createGroup({id:r.element.id+"DefinitionLine"});var p=0;for(a=r.rows.length;p<a;p++){var u=r.rows[p];u.border.color&&this.drawBottomLine(u,p,!0)}for(p=0,a=r.columns.length;p<a;p++){var g=r.columns[p];g.border.color&&this.drawBottomLine(g,p,!1)}return this.chart.enableCanvas||n.appendChild(this.element),nt(r.enableCanvas,r.svgObject,n,r.redraw),o},e.prototype.renderScrollbar=function(e,t){(!sf.base.isNullOrUndefined(e.zoomModule)&&e.zoomModule.isZoomed&&(t.zoomFactor<1||t.zoomPosition>0)||t.scrollbarSettings.enable&&(t.zoomFactor<=1||t.zoomPosition>=0))&&(!t.zoomingScrollBar.isScrollUI||e.visibleSeries[0].type.indexOf("Bar")>=0)?(e.scrollElement||(e.scrollElement=Mt(e.redraw,e.element.id+"_scrollElement")||sf.base.createElement("div",{id:e.element.id+"_scrollElement"})),nt(!1,e.scrollElement,t.zoomingScrollBar.render(!0),!0)):1===t.zoomFactor&&0===t.zoomPosition&&t.zoomingScrollBar.svgObject&&!t.scrollbarSettings.enable&&t.zoomingScrollBar.destroy(),t.zoomingScrollBar.isScrollUI&&(t.zoomingScrollBar.isScrollUI=!1)},e.prototype.findAxisPosition=function(e){return null!==e.crossAt&&e.isInside(e.crossInAxis.visibleRange)},e.prototype.drawBottomLine=function(e,t,i){var r,n,o,s,a,l,h=this.chart;i?(s=a=(e=e).computedTop+e.computedHeight,o=(n=this.seriesClipRect.x)+this.seriesClipRect.width,l="Row"):(n=o=(e=e).computedLeft,a=(s=this.seriesClipRect.y)+this.seriesClipRect.height,l="Column"),r={id:h.element.id+"_AxisBottom_"+l+t,x1:n,y1:s,x2:o,y2:a,"stroke-width":e.border.width,stroke:e.border.color},this.htmlObject=h.renderer.drawLine(r),this.element.appendChild(this.htmlObject)},e.prototype.drawAxisLine=function(e,t,i,r,n,o,s,a,l,h){var d,c=this.chart,p=Ge(c.element.id+"AxisLine_"+t),u=p?p.getAttribute("d"):"";p=null,d={id:c.element.id+"AxisLine_"+t,d:"M "+(h.x-i-s)+" "+(h.y-r-o)+" L "+(h.x+h.width+i+a)+" "+(h.y+h.height+r+n),"stroke-dasharray":e.lineStyle.dashArray,"stroke-width":e.lineStyle.width,stroke:e.lineStyle.color||c.themeStyle.axisLine},this.htmlObject=c.renderer.drawPath(d),nt(c.enableCanvas,l,this.htmlObject,c.redraw,!0,"x","y",null,u)},e.prototype.drawYAxisGridLine=function(e,t,i,r){var n,o,s="Logarithmic"===e.valueType,a=e.valueType.indexOf("Category")>-1,l=0,h="",d="",c=e.isAxisOpposedPosition,p=c?e.majorTickLines.height:-e.majorTickLines.height,u=c?.5*e.lineStyle.width:.5*-e.lineStyle.width,g="Category"===e.valueType&&"BetweenTicks"===e.labelPlacement?.5:0,f=sf.base.isNullOrUndefined(e.crossesAt)?c?e.scrollBarHeight:-e.scrollBarHeight:0,m="Inside"===e.tickPosition,y=m?r.x-p-u:r.x+p+u+f,v=e.visibleLabels.length,b=this.chart.themeStyle;e.valueType.indexOf("Category")>-1&&"BetweenTicks"===e.labelPlacement&&v>0&&(v+=1);for(var w=e.minorGridLines,x=e.minorTickLines,M=0;M<v;M++)(l=-1*(l=ye(n=e.visibleLabels[M]?e.visibleLabels[M].value-g:e.visibleLabels[M-1].value+e.visibleRange.interval-g,e)*r.height)+(r.y+r.height))>=r.y&&r.y+r.height>=l&&((oe(n,e.visibleRange)||this.isBorder(e,M,l))&&(h="M "+this.seriesClipRect.x+" "+l+" L "+(this.seriesClipRect.x+this.seriesClipRect.width)+" "+l,this.renderGridLine(e,t,h,e.majorGridLines,"_MajorGridLine_",M,this.element,b.majorGridLine,e.majorGridLines.dashArray)),d="M "+(r.x+u+(m?f:0))+" "+l+" L "+y+" "+l,this.renderGridLine(e,t,d,e.majorTickLines,"_MajorTickLine_",M,i,b.majorTickLine),(w.width>0||x.width>0)&&e.minorTicksPerInterval>0&&(0!==M||!He(e)||s||a||this.renderMinorGridOnZooming(e,n,r,M,t,b,i),o=this.drawAxisMinorLine(e,n,r,M),this.renderGridLine(e,t,o[0],w,"_MinorGridLine_",M,this.element,b.minorGridLine,w.dashArray),this.renderGridLine(e,t,o[1],x,"_MinorTickLine_",M,i,b.minorTickLine),M===v-1&&He(e)&&s&&!a&&this.renderMinorGridOnZooming(e,n+e.visibleRange.interval,r,M,t,b,i)))},e.prototype.isBorder=function(e,t,i){var r=this.chart.chartArea.border,n=this.seriesClipRect,o=e.orientation,s="Horizontal"===o?n.x:n.y,a="Horizontal"===o?n.width:n.height,l="Horizontal"===o?0:e.visibleLabels.length-1,h="Horizontal"===o?e.visibleLabels.length-1:0;return e.plotOffset>0||((i===s||i===s+a)&&(r.width<=0||"transparent"===r.color)||(i!==s&&t===l||i!==s+a&&t===h))},e.prototype.drawYAxisLabels=function(e,t,i,r){var n,o,s,a,l=this.chart,h=0,d=0,c=e.labelPadding,p="Inside"===e.labelPosition,u=e.isAxisOpposedPosition,g=(e.labelPosition===e.tickPosition?e.majorTickLines.height:0)+c+.5*e.lineStyle.width,f=e.angle%360,m=-90===f||90===f||270===f||-270===f;g+=m?p?5:-5:0,g=u?g:-g;var y,v,b,w,x,M,N,I=l.renderer.createGroup({id:l.element.id+"AxisLabels"+t}),S=sf.base.isNullOrUndefined(e.crossesAt)?e.scrollBarHeight*(u?1:-1):0,C=e.isAxisInverse,O=C?r.y:r.y+r.height,T=!u&&!p||u&&p;w=p?T?g:-g:T?g+S:-g+S;var P=[],A=[];e.visibleLabels.map((function(e){P.push(e.size.width),A.push(e.breakLabelSize.width)}));for(var L=Math.max.apply(Math,P),F=Math.max.apply(Math,A),D=0,E=e.visibleLabels.length;D<E;D++){switch(n=e.visibleLabels[D],o=(a=$(e.visibleLabels[D].originalText))?e.visibleLabels[D].breakLabelSize:e.visibleLabels[D].size,d=ye(e.visibleLabels[D].value,e)*r.height+(l.stockChart?7:0),d=Math.floor(-1*d+(r.y+r.height)),y=o.height/8*e.visibleLabels[D].text.length/2,v=o.height/4*3+3,x=r.height/e.visibleLabels.length,M=("Trim"===e.labelIntersectAction||"Wrap"===e.labelIntersectAction)&&0!==f&&o.width>x?x:o.width,d=a?"Inside"===e.labelPosition?d-o.height/2-y+v:d-y:"Inside"===e.labelPosition?d+v:d,"Inside"===e.labelPosition&&(0===D&&!e.isInversed||D===E-1&&e.isInversed)&&(l.stockChart?d-=v:d-=v-(e.opposedPosition?-g:g)),b=e.majorGridLines.width>e.majorTickLines.width?e.majorGridLines.width:e.majorTickLines.width,"Far"===e.labelStyle.textAlignment?d=d-b-10:"Near"===e.labelStyle.textAlignment?d=d+b+10:"Center"===e.labelStyle.textAlignment&&(d=d),N=p?w+(0===f?o.width:a?F:L)/2:w-(0===f?o.width:a?F:L)/2,h=u?r.x-N:r.x+N,m&&(h+=u?-10:10),N=w,s=new sf.svgbase.TextOption(l.element.id+t+"_AxisLabel_"+D,h,d,"middle",n.text,"","middle"),e.edgeLabelPlacement){case"None":break;case"Hide":((0===D||C&&D===E-1)&&s.y>r.y||(D===E-1||C&&0===D)&&s.y-.5*o.height<r.y)&&(s.text="");break;case"Shift":(0===D||C&&D===E-1)&&s.y>r.y?s.y=d=r.y+r.height:(D===E-1||C&&0===D)&&s.y-.5*o.height<r.y&&(s.y=d=r.y+.5*o.height)}var z=s.y,k=s.y-M;a&&(z=s.y-M/2,k=s.y+M/2),(90!==f&&270!==f||"Hide"!==e.labelIntersectAction||0===D||!(C?k<=O:z>=O))&&(O=C?z:k,s.transform="rotate("+f+","+h+","+d+")",It(l.renderer,s,n.labelStyle,n.labelStyle.color||l.themeStyle.axisLabel,I,!1,l.redraw,!0,!0,null,null,0,null,l.enableCanvas))}this.chart.enableCanvas||(l.delayRedraw?e.visible&&e.internalVisibility&&this.createZoomingLabel(this.chart,I,e,t,r):nt(l.enableCanvas,i,I,l.redraw))},e.prototype.getAxisLabelXvalue=function(e,t,i){var r=t.lineBreakAlignment,n="Inside"===t.labelPosition,o=t.isAxisOpposedPosition;return o&&n||!o&&!n?"Right"===r?e:"Center"===r?e-i/2:e-i:"Left"===r?e:"Center"===r?e+i/2:e+i},e.prototype.drawYAxisBorder=function(e,t,i,r){if(e.border.width>0){var n=void 0,o=void 0,s="Outside"===e.labelPosition?e.scrollBarHeight:0,a=e.isAxisOpposedPosition;s*=a?1:-1;for(var l=r.height/e.visibleRange.delta*("DateTime"===e.valueType?e.dateTimeInterval:e.visibleRange.interval),h=void 0,d=e.maxLabelSize.width+10+(e.tickPosition===e.labelPosition?e.majorTickLines.height:0),c="",p="Category"===e.valueType&&"BetweenTicks"===e.labelPlacement?-.5:0,u=a&&"Inside"===e.labelPosition||!a&&"Outside"===e.labelPosition?r.x-d+s:r.x+d+s,g=0,f=e.visibleLabels.length;g<f;g++)switch(o=ye(e.visibleLabels[g].value+p,e),o=(e.isAxisInverse?1-o:o)*r.height,"Category"===e.valueType&&"BetweenTicks"===e.labelPlacement?(n=-1*o+(r.y+r.height),h=-1*o-l+(r.y+r.height)):(n=-1*o+l/2+(r.y+r.height),h=-1*o-l/2+(r.y+r.height)),e.border.type){case"Rectangle":case"WithoutTopBorder":n>r.y+r.height?c+="M "+u+" "+(r.y+r.height)+" L "+u+" "+h+" ":Math.floor(r.y)>h?c+="M "+(r.x+s)+" "+n+" L "+u+" "+n+" L "+u+" "+r.y+" ":(c+="M "+(r.x+s)+" "+n+" L "+u+" "+n+" L "+u+" "+h+" ",g===e.visibleLabels.length-1&&(c+="M "+(r.x+s)+" "+h+" L "+u+" "+h+" "));break;case"WithoutTopandBottomBorder":n>r.y+r.height||h<Math.floor(r.y)||(c+="M "+(r.x+s)+" "+n+" L "+u+" "+n+" M "+u+" "+h+" L "+(r.x+s)+" "+h)}""!==(c+="Rectangle"===e.border.type?"M "+(r.x+s)+" "+r.y+" L "+(r.x+s)+" "+(r.y+r.height)+" ":"")&&this.createAxisBorderElement(e,t,c,i)}e.multiLevelLabels.length>0&&this.chart.multiLevelLabelModule&&this.chart.multiLevelLabelModule.renderYAxisMultiLevelLabels(e,t,i,r)},e.prototype.drawYAxisTitle=function(e,t,i,r){if(e.title){var n=this.chart,o=e.isAxisOpposedPosition,s=null==e.titleRotation?-90:e.titleRotation;s=o?-s:s;var a=("Inside"===e.tickPosition?0:e.majorTickLines.height+e.titlePadding)+("Inside"===e.labelPosition?0:e.maxLabelSize.width+e.multiLevelLabelHeight+this.padding);a=o?a+e.scrollBarHeight:-a-e.scrollBarHeight,(-90!==s&&!o||90!==s&&o)&&(a+=e.isAxisOpposedPosition?e.titleSize.width/2:-e.titleSize.width/2);var l=r.x+a,h=r.y+.5*r.height,d=e.titleSize.height*(e.titleCollection.length-1),c=new sf.svgbase.TextOption(n.element.id+"_AxisTitle_"+t,l,h-e.labelPadding-d,"middle",e.titleCollection,"rotate("+s+","+l+","+h+")",null,s);It(n.renderer,c,e.titleStyle,e.titleStyle.color||n.themeStyle.axisTitle,i,null,null,null,null,null,null,0,null,n.enableCanvas).setAttribute("aria-hidden","true")}},e.prototype.drawXAxisGridLine=function(e,t,i,r){var n,o,s="Logarithmic"===e.valueType,a=e.valueType.indexOf("Category")>-1,l=0,h="",d="",c=e.isAxisOpposedPosition,p=c?-e.majorTickLines.height:e.majorTickLines.height,u=c?.5*-e.lineStyle.width:.5*e.lineStyle.width,g=sf.base.isNullOrUndefined(e.crossesAt)?c?-e.scrollBarHeight:e.scrollBarHeight:0,f=e.valueType.indexOf("Category")>-1&&"BetweenTicks"===e.labelPlacement?.5:0,m=e.visibleLabels.length,y="Inside"===e.tickPosition,v=y?r.y-p-u:r.y+p+u+g,b=this.chart.themeStyle;e.valueType.indexOf("Category")>-1&&m>0&&"BetweenTicks"===e.labelPlacement&&(m+=1);for(var w=0;w<m;w++)(l=ye(n="DateTimeCategory"!==e.valueType?e.visibleLabels[w]?e.visibleLabels[w].value-f:e.visibleLabels[w-1].value+e.visibleRange.interval-f:e.visibleLabels[w]?e.visibleLabels[w].value-f:e.visibleRange.max,e)*r.width+r.x)>=r.x&&r.x+r.width>=l&&((oe(n,e.visibleRange)||this.isBorder(e,w,l))&&(h="M "+l+" "+(this.seriesClipRect.y+this.seriesClipRect.height)+" L "+l+" "+this.seriesClipRect.y,this.renderGridLine(e,t,h,e.majorGridLines,"_MajorGridLine_",w,this.element,b.majorGridLine,e.majorGridLines.dashArray)),d="M "+l+" "+(r.y+u+(y?g:0))+" L "+l+" "+v,this.renderGridLine(e,t,d,e.majorTickLines,"_MajorTickLine_",w,i,b.majorTickLine),e.minorTicksPerInterval>0&&(e.minorGridLines.width>0||e.minorTickLines.width>0)&&(0!==w||!He(e)||s||a||this.renderMinorGridOnZooming(e,n,r,w,t,b,i),o=this.drawAxisMinorLine(e,n,r,w),this.renderGridLine(e,t,o[0],e.minorGridLines,"_MinorGridLine_",w,this.element,b.minorGridLine,e.minorGridLines.dashArray),this.renderGridLine(e,t,o[1],e.minorTickLines,"_MinorTickLine_",w,i,b.minorTickLine),w===m-1&&He(e)&&s&&!a&&this.renderMinorGridOnZooming(e,n+e.visibleRange.interval,r,w,t,b,i)))},e.prototype.renderMinorGridOnZooming=function(e,t,i,r,n,o,s){var a=this.drawAxisMinorLine(e,t,i,r,!0);this.renderGridLine(e,n,a[0],e.minorGridLines,"_MinorGridLine_",-1,this.element,o.minorGridLine,e.minorGridLines.dashArray),this.renderGridLine(e,n,a[1],e.minorTickLines,"_MinorTickLine_",-1,s,o.minorTickLine)},e.prototype.drawAxisMinorLine=function(e,t,i,r,n){var o,s=t,a=0,l=0,h=e.visibleRange,d="Inside"===e.tickPosition,c=[],p=e.isAxisOpposedPosition?-e.minorTickLines.height:e.minorTickLines.height,u=1,g=1,f=d?i.y-p:i.y+p,m=d?i.x+p:i.x-p,y="",v="",b=e.isAxisInverse;if("Logarithmic"===e.valueType&&(g=(o=Math.pow(e.logBase,s-h.interval))+(u=(Math.pow(e.logBase,s)-o)/(e.minorTicksPerInterval+1))),"Horizontal"===e.orientation)for(var w=0;w<e.minorTicksPerInterval;w++)s=this.findLogNumeric(e,g,s,r,n),g+=u,oe(s,h)&&(l=(s-h.min)/(h.max-h.min),l=Math.ceil((b?1-l:l)*i.width),a=Math.floor(l+i.x),y=y.concat("M "+a+" "+this.seriesClipRect.y+"L "+a+" "+(this.seriesClipRect.y+this.seriesClipRect.height)),a=Math.floor(l+i.x),v=v.concat("M "+a+" "+i.y+"L "+a+" "+(f+e.scrollBarHeight)));else for(w=0;w<e.minorTicksPerInterval;w++)oe(s=this.findLogNumeric(e,g,s,r,n),h)&&(l=(s-h.min)/(h.max-h.min),l=-1*Math.ceil((b?1-l:l)*i.height),a=Math.floor(l+i.y+i.height),y=y.concat("M "+this.seriesClipRect.x+" "+a+"L "+(this.seriesClipRect.x+this.seriesClipRect.width)+" "+a+" "),a=Math.floor(l+i.y+i.height),v=v.concat("M "+i.x+" "+a+"L "+(m-e.scrollBarHeight)+" "+a+" ")),g+=u;return c.push(y),c.push(v),c},e.prototype.findLogNumeric=function(e,t,i,r,n){var o,s=e.visibleRange;if("Logarithmic"===e.valueType)i=re(t,e.logBase);else if("DateTime"===e.valueType)o=e.dateTimeInterval/(e.minorTicksPerInterval+1),i=n?i-o:i+o;else if("DateTimeCategory"===e.valueType){var a="BetweenTicks"===e.labelPlacement?.5:0;i+=((e.visibleLabels[r+1]?e.visibleLabels[r+1].value-a:e.visibleRange.max)-(e.visibleLabels[r]?e.visibleLabels[r].value-a:e.visibleRange.min))/(e.minorTicksPerInterval+1)}else o=s.interval/(e.minorTicksPerInterval+1),i=n?i-o:i+o;return i},e.prototype.drawXAxisLabels=function(e,t,i,r){var n,o,s,a,l,h,d,c,p,u=this.chart,g=0,f=0,m=e.labelPadding,y=u.renderer.createGroup({id:u.element.id+"AxisLabels"+t}),v="Inside"===e.labelPosition,b=e.isAxisOpposedPosition,w=e.labelPosition===e.tickPosition?e.majorTickLines.height:0,x=w+m+.5*e.lineStyle.width,M=e.angle%360,N=0===M||-180===M||180===M,I=e.isAxisInverse,S=I?r.x+r.width:r.x,C=0,O=e.visibleLabels.length,T=e.scrollbarSettings.enable||!v&&sf.base.isNullOrUndefined(e.crossesAt)&&(e.zoomFactor<1||e.zoomPosition>0)?e.scrollBarHeight:0,P=[],A=!1;x+=90===M||270===M||-90===M||-270===M?v?5:-5:0;for(var L=!b&&!v||b&&v,F=L?360>=M&&M>=180||-1>=M&&M>=-180:1<=M&&M<=180||-181>=M&&M>=-360,D=0,E=O;D<E;D++){p=$((c=e.visibleLabels[D]).originalText),g=ye(c.value,e)*r.width+r.x,o=c.size,d=r.width/O,h=p?c.breakLabelSize.width:o.width,C=("Trim"===e.labelIntersectAction||"Wrap"===e.labelIntersectAction)&&0===M&&h>d?d:h,n=o.height/4,g-=p||0!==M?0:C/2,0!==M&&(g-=p?"Left"===e.lineBreakAlignment?c.breakLabelSize.width/2:"Right"===e.lineBreakAlignment?-c.breakLabelSize.width/2:0:-90===M||270===M?-n:90===M||-270===M?n:0),"Far"===e.labelStyle.textAlignment?g=g+C-10:"Near"===e.labelStyle.textAlignment?g=g-C+10:"Center"===e.labelStyle.textAlignment&&(g=g),p&&"Center"!==e.lineBreakAlignment&&0===M&&(g+="Left"===e.lineBreakAlignment?-C/2:C/2);var z=p?N?o.height:c.breakLabelSize.width/2:0;if(x=p?w+m+.5*e.lineStyle.width:x,v&&M?f=p?b?r.y+x+z:r.y-x-z:b?r.y+x+n:r.y-x-n:(s=p?L?x+T+(M?z:3*n):-(x+T+z):L?x+T+(M?1:3)*n:-(x+T+(M?n:c.index>1?2*n:0)),f=r.y+s*c.index),a=p?this.getAnchor(e):u.enableRtl?F?"":"end":u.isRtlEnabled||F?"end":"",l=new sf.svgbase.TextOption(u.element.id+t+"_AxisLabel_"+D,g,f,a),e.edgeLabelPlacement)switch(e.edgeLabelPlacement){case"None":break;case"Hide":if((0===D||I&&D===E-1)&&l.x<r.x||(D===E-1||I&&0===D)&&l.x+C>r.x+r.width)continue;break;case"Shift":(0===D||I&&D===E-1)&&l.x<r.x?(d-=r.x-l.x,l.x=g=N?r.x:r.x+x):(D===E-1||I&&0===D)&&l.x+C>r.x+r.width&&(o.width>d&&"Trim"===e.labelIntersectAction?d-=l.x+C-(r.x+r.width):d=C,l.x=g=N?r.x+r.width-d:r.x+r.width-d/2),this.chart.primaryYAxis.opposedPosition&&0===D&&l.x<=r.x&&(d-=r.x-l.x,l.x+=r.x+C/2,g+=r.x+C/2)}l.text=this.getLabelText(c,e,d);var k=void 0,W=void 0;if(p&&0===M?"Right"===e.lineBreakAlignment?(k=l.x-C,W=l.x):"Center"===e.lineBreakAlignment?(k=l.x-C/2,W=l.x+C/2):(k=l.x,W=l.x+C):(k=l.x,W=l.x+C),0!==M||"Hide"!==e.labelIntersectAction||0===D||!(I?W>=S:k<=S)){if(S=p?"Right"===e.lineBreakAlignment?I?l.x-C:l.x:"Center"===e.lineBreakAlignment?I?l.x-C/2:l.x+C/2:I?l.x:l.x+C:I?l.x:l.x+C,0!==M){var R=void 0,j=void 0;if(p){var U=0,H=0;R=c.breakLabelSize.height,H=c.breakLabelSize.height-4,"Center"===e.lineBreakAlignment?U=-c.breakLabelSize.width/2:"Right"===e.lineBreakAlignment&&(U=-c.breakLabelSize.width),L&&(H=c.breakLabelSize.height/(l.text.length+1)),j=new sf.svgbase.Rect(l.x+U,l.y-H,c.breakLabelSize.width,R)}else R=f-(l.y-(c.size.height/2+10)),j=new sf.svgbase.Rect(l.x,l.y-(c.size.height/2-5),c.size.width,R);var B=this.getRectanglePoints(j),_=p?j.x+j.width/2:g,V=p?j.y+j.height/2:f-R/2;if(l.transform=p?"rotate("+M+","+_+","+V+")":"rotate("+M+","+g+","+f+")",P.push(ge(B,_,V,M)),A=!1,"None"!==e.labelIntersectAction)for(var Y=D;Y>0;Y--)if(P[D]&&P[Y-1]&&fe(P[D],P[Y-1])){A=!0,P[D]=null;break}}It(u.renderer,l,c.labelStyle,c.labelStyle.color||u.themeStyle.axisLabel,y,e.isAxisOpposedPosition!==("Inside"===e.labelPosition),u.redraw,!0,null,null,null,c.size,A,u.enableCanvas)}}this.chart.enableCanvas||(u.delayRedraw?e.visible&&e.internalVisibility&&this.createZoomingLabel(this.chart,y,e,t,r):i.appendChild(y))},e.prototype.getAnchor=function(e){return"Center"===e.lineBreakAlignment?"middle":this.chart.enableRtl?"Left"===e.lineBreakAlignment?"end":"start":"Left"===e.lineBreakAlignment?"start":"end"},e.prototype.getRectanglePoints=function(e){return[new jt(e.x,e.y),new jt(e.x+e.width,e.y),new jt(e.x+e.width,e.y+e.height),new jt(e.x,e.y+e.height)]},e.prototype.getLabelText=function(e,t,i){if($(e.originalText)){for(var r=[],n=void 0,o=0;o<e.text.length;o++)n=this.findAxisLabel(t,e.text[o],i),r.push(n);return r}return this.findAxisLabel(t,e.text,i)},e.prototype.drawXAxisBorder=function(e,t,i,r){if(e.border.width>0){for(var n="Outside"===e.labelPosition?e.scrollBarHeight:0,o=e.isAxisOpposedPosition,s=void 0,a=r.y+(o?-1:1)*n,l=void 0,h=r.width/e.visibleRange.delta*("DateTime"===e.valueType?e.dateTimeInterval:e.visibleRange.interval),d=void 0,c=e.maxLabelSize.height+(e.tickPosition===e.labelPosition?e.majorTickLines.height:0),p="",u="Category"===e.valueType&&"BetweenTicks"===e.labelPlacement?-.5:0,g=o&&"Inside"===e.labelPosition||!o&&"Outside"===e.labelPosition?r.y+c+10+n:r.y-c-10-n,f=0,m=e.visibleLabels.length;f<m;f++)switch(l=ye(e.visibleLabels[f].value+u,e),l=(e.isAxisInverse?1-l:l)*r.width,"Category"===e.valueType&&"BetweenTicks"===e.labelPlacement?(s=l+r.x,d=l+h+r.x):(s=l-.5*h+r.x,d=l+.5*h+r.x),e.border.type){case"Rectangle":case"WithoutTopBorder":s<r.x&&"OnTicks"!==e.labelPlacement?p+="M "+r.x+" "+g+" L "+d+" "+g+" ":Math.floor(d)>r.width+r.x&&1!==e.visibleLabels.length&&f!==e.visibleLabels.length-1?p+="M "+s+" "+a+" L "+s+" "+g+" L "+(r.width+r.x)+" "+g+" ":(p+="M "+(s=0===f&&"OnTicks"===e.labelPlacement?r.x:s)+" "+a+" L "+s+" "+g+" L "+(d=f===e.visibleLabels.length-1&&"OnTicks"===e.labelPlacement?d-.5*h:d)+" "+g+" ",0===f&&(p+="M "+s+" "+a+" L "+s+" "+g+" M "+s+" "+g+" L "+r.x+" "+g),f===e.visibleLabels.length-1&&(p+="M "+d+" "+a+" L "+d+" "+g+" M "+d+" "+g+" L "+(r.width+r.x)+" "+g));break;case"WithoutTopandBottomBorder":s<r.x||Math.floor(d)>r.width+r.x||(p+="M "+s+" "+a+" L "+s+" "+g+" M "+d+" "+a+" L "+d+" "+g)}""!==(p+="Rectangle"===e.border.type?"M  "+r.x+" "+a+"L "+(r.x+r.width)+" "+a:"")&&this.createAxisBorderElement(e,t,p,i)}this.chart.multiLevelLabelModule&&e.multiLevelLabels.length>0&&this.chart.multiLevelLabelModule.renderXAxisMultiLevelLabels(e,t,i,r)},e.prototype.createAxisBorderElement=function(e,t,i,r){var n=Ge(this.chart.element.id+"_BorderLine_"+t),o=n?n.getAttribute("d"):"",s=this.chart.renderer.drawPath(new sf.svgbase.PathOption(this.chart.element.id+"_BorderLine_"+t,"transparent",e.border.width,e.border.color||this.chart.themeStyle.axisLine,1,"",i));s.style.pointerEvents="none",nt(this.chart.enableCanvas,r,s,this.chart.redraw,!1,"x","y",null,o,!0)},e.prototype.findAxisLabel=function(e,t,i){return"Trim"===e.labelIntersectAction?e.angle%360!=0||e.enableTrim?t:bt(i,t,e.labelStyle):t},e.prototype.drawXAxisTitle=function(e,t,i,r){if(e.title){var n=this.chart,o=sf.svgbase.measureText(e.title,e.titleStyle),s=sf.base.isNullOrUndefined(e.crossesAt)?e.scrollBarHeight:0,a=("Inside"===e.tickPosition?0:e.majorTickLines.height+e.titlePadding)+("Inside"===e.labelPosition?0:e.maxLabelSize.height+e.multiLevelLabelHeight+e.labelPadding),l=e.titleSize.height*(e.titleCollection.length-1);a=e.isAxisOpposedPosition?-(a+o.height/4+s+l):a+3*o.height/4+s;var h=e.titleRotation?e.titleRotation:0,d=r.x+.5*r.width,c=r.y+a;0!==h&&(c+=e.opposedPosition?-(e.titleSize.height/2+o.height/4):e.titleSize.height/2-o.height/4);var p=new sf.svgbase.TextOption(n.element.id+"_AxisTitle_"+t,d,c,"middle",e.titleCollection,"rotate("+h+","+d+","+c+")",null,h);It(n.renderer,p,e.titleStyle,e.titleStyle.color||n.themeStyle.axisTitle,i,null,null,null,null,null,null,0,null,n.enableCanvas).setAttribute("aria-hidden","true")}},e.prototype.renderGridLine=function(e,t,i,r,n,o,s,a,l){void 0===l&&(l=null);var h,d,c=this.chart;r.width>0&&e.visible&&e.internalVisibility&&i&&(h=(d=Ge(c.element.id+n+t+"_"+o))?d.getAttribute("d"):null,d=null,this.htmlObject=c.renderer.drawPath(new sf.svgbase.PathOption(c.element.id+n+t+"_"+o,"transparent",r.width,r.color||a,null,l,i)),nt(c.enableCanvas,s,this.htmlObject,c.redraw,!0,"x","y",null,h,!0))},e.prototype.findParentNode=function(e,t,i){return document.getElementById(e+"AxisGroup"+i+"Inside").contains(document.getElementById(t.id))?document.getElementById(e+"AxisGroup"+i+"Inside"):document.getElementById(e+"AxisGroup"+i+"Outside")},e.prototype.createZoomingLabel=function(e,t,i,r,n){var o=this.findParentNode(e.element.id,t,r);t.setAttribute("opacity","0.3");var s=e.renderer.createGroup({id:e.element.id+"AxisLabels_Zoom"+r});s=Ie(e,i,s,r,"Vertical"===i.orientation,n),o.replaceChild(t,document.getElementById(t.id)),Ge(e.element.id+"AxisLabels_Zoom"+r)?o.replaceChild(s,document.getElementById(s.id)):o.appendChild(s)},e}(),tr=function(){function e(e){this.currentPoints=[],this.previousPoints=[],this.insideRegion=!1,this.commonXvalues=[],this.chart=e,this.lierIndex=0}return e.prototype.getData=function(){for(var e,t,i,r,n=this.chart,o=null,s=null,a=n.visibleSeries.length-1;a>=0;a--){if(e="Scatter"===(s=n.visibleSeries[a]).type||"Scatter"===s.drawType||s.marker.visible?(s.marker.height+5)/2:0,t="Scatter"===s.type||"Scatter"===s.drawType||s.marker.visible?(s.marker.width+5)/2:0,i=n.mouseX,r=n.mouseY,s.dragSettings.enable&&s.isRectSeries)if("Bar"===s.type&&n.isTransposed||!n.isTransposed&&"Bar"!==s.type){var l=s.marker.height/2;r=s.yAxis.isAxisInverse?r-l:r+l}else{var h=s.marker.width/2;i=s.yAxis.isAxisInverse?i+h:i-h}if(s.visible&&Ce(i,r,s.clipRect,e,t)&&(o=this.getRectPoint(s,s.clipRect,i,r)),o)return new _t(o,s)}return new _t(o,s)},e.prototype.isSelected=function(e){return(e.selectionMode.indexOf("Drag")>-1||e.selectionMode.indexOf("Lasso")>-1)&&e.selectionModule&&null!==e.selectionModule.rectPoints},e.prototype.getRectPoint=function(e,t,i,r){var n,o,s,a,l,h,d=0;if(this.chart.isScrolling)return null;for(var c=0,p=e.points;c<p.length;c++){var u=p[c];if(u.regionData||u.regions&&u.regions.length){if(u.regionData&&"PolarRadar"===this.chart.chartAreaType&&e.drawType.indexOf("Column")>-1&&(n=i-(e.clipRect.width/2+e.clipRect.x),o=r-(e.clipRect.height/2+e.clipRect.y),d=2*Math.PI*(u.regionData.currentXPosition<0?1+u.regionData.currentXPosition:u.regionData.currentXPosition),s=(s=(Math.atan2(o,n)+.5*Math.PI-d)%(2*Math.PI))<0?2*Math.PI+s:s,s+=2*Math.PI*e.chart.primaryXAxis.startAngle,a=u.regionData.startAngle,a=(a-=d)<0?2*Math.PI+a:a,l=u.regionData.endAngle,l=(l-=d)<0?2*Math.PI+l:l,h=Math.sqrt(Math.pow(Math.abs(n),2)+Math.pow(Math.abs(o),2)),s>=a&&s<=l&&(h>=u.regionData.innerRadius&&h<=u.regionData.radius||h<=u.regionData.innerRadius&&h>=u.regionData.radius)&&h<=e.chart.radius))return u;if((e.dragSettings.enable&&e.isRectSeries||e.isRectSeries&&e.marker.visible)&&this.isPointInThresholdRegion(i,r,u,t,e))return this.insideRegion=!0,u;if(!this.insideRegion&&this.checkRegionContainsPoint(u.regions,t,i,r))return u;if(this.insideRegion&&this.checkRegionContainsPoint(u.regions,t,i,r))return u}}return null},e.prototype.checkRegionContainsPoint=function(e,t,i,r){var n=this;return e.some((function(e,o){return n.lierIndex=o,Ce(i,r,new sf.svgbase.Rect(("Cartesian"===n.chart.chartAreaType?t.x:0)+e.x,("Cartesian"===n.chart.chartAreaType?t.y:0)+e.y,e.width,e.height))}))},e.prototype.isPointInThresholdRegion=function(e,t,i,r,n){var o,s=this,a="Bar"===n.type,l=n.yAxis.isAxisInverse,h=n.chart.isTransposed,d=0,c=0,p=o=20;return l&&h?a?(d=i.regions[0].height-10,o=i.regions[0].width):(c=-10,p=i.regions[0].height):l||i.yValue<0?a?(c=-10,p=i.regions[0].height):(d=i.regions[0].height-10,o=i.regions[0].width):h?a?(d=-10,o=i.regions[0].width):(c=i.regions[0].width-10,p=i.regions[0].height):a?(c=i.regions[0].width-10,p=i.regions[0].height):(d=-10,o=i.regions[0].width),i.regions.some((function(i){return Ce(e,t,new sf.svgbase.Rect(("Cartesian"===s.chart.chartAreaType?r.x:0)+i.x+c,("Cartesian"===s.chart.chartAreaType?r.y:0)+i.y+d,o,p))}))},e.prototype.getClosest=function(e,t,i){var r,n,o=i||e.xData,s=o.length;if(t>=e.xMin-.5&&t<=e.xMax+.5)for(var a=0;a<s;a++)n=o[a],(null==r||Math.abs(n-t)<Math.abs(r-t))&&(r=n);return-1!==e.xData.indexOf(r)?r:null},e.prototype.binarySearch=function(e,t){for(var i,r=0,n=t.length,o=-1,s=!1;!1===s&&r<=n;)t[i=Math.floor((r+n)/2)].xValue===e?(s=!0,o=i):t[i].xValue>e?n=i-1:r=i+1;return-1!==o?t[o]:null},e.prototype.getClosestX=function(e,t,i){var r,n=t.clipRect;r=e.requireInvertedAxis?Te(e.mouseY-n.y,n.height,t.xAxis):Oe(e.mouseX-n.x,n.width,t.xAxis);var o=this.getClosest(t,r,i),s=o||0===o?this.binarySearch(o,J(t.points,["xValue"])):null;return s&&s.visible?new _t(s,t):null},e.prototype.mergeXvalues=function(e){if(e.length&&(!this.commonXvalues.length||this.commonXvalues.length!==e[0].xData.length)){this.commonXvalues=e[0].xData;for(var t=1;t<e.length;t++)this.commonXvalues=this.getDistinctValues(this.commonXvalues,e[t].xData)}return this.commonXvalues},e.prototype.commonXValue=function(e){for(var t=[],i=0;i<e.length;i++)for(var r=0;e[i].points&&r<e[i].points.length;r++){var n=e[i].points[r];n&&(0===n.index||n.index===e[i].points.length-1||n.symbolLocations&&n.symbolLocations.length>0)&&t.push(n.xValue)}return t},e.prototype.getDistinctValues=function(e,t){void 0===e&&(e=[]),void 0===t&&(t=[]);var i,r={},n=[];for(i=0;i<e.length;i++){r[o=e[i]]||(r[o]=!0,n.push(o))}for(i=0;i<t.length;i++){var o;r[o=t[i]]||(r[o]=!0,n.push(o))}return n},e}(),ir=(Kt=function(e,t){return(Kt=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}Kt(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),rr=function(e,t,i,n){var o,s=arguments.length,a=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(s<3?o(a):s>3?o(t,i,a):o(t,i))||a);return s>3&&a&&Object.defineProperty(t,i,a),a},nr=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ir(t,e),rr([sf.base.Property(!1)],t.prototype,"visible",void 0),rr([sf.base.Property(!0)],t.prototype,"showZero",void 0),rr([sf.base.Property(null)],t.prototype,"name",void 0),rr([sf.base.Property("transparent")],t.prototype,"fill",void 0),rr([sf.base.Property(null)],t.prototype,"format",void 0),rr([sf.base.Property(1)],t.prototype,"opacity",void 0),rr([sf.base.Property(0)],t.prototype,"angle",void 0),rr([sf.base.Property(!1)],t.prototype,"enableRotation",void 0),rr([sf.base.Property("Auto")],t.prototype,"position",void 0),rr([sf.base.Property(5)],t.prototype,"rx",void 0),rr([sf.base.Property(5)],t.prototype,"ry",void 0),rr([sf.base.Property("Center")],t.prototype,"alignment",void 0),rr([sf.base.Complex({width:null,color:null},c)],t.prototype,"border",void 0),rr([sf.base.Complex({left:5,right:5,top:5,bottom:5},g)],t.prototype,"margin",void 0),rr([sf.base.Complex({size:"11px",color:"",fontStyle:"Normal",fontWeight:"Normal",fontFamily:"Segoe UI"},d)],t.prototype,"font",void 0),rr([sf.base.Property(null)],t.prototype,"template",void 0),rr([sf.base.Property("Hide")],t.prototype,"labelIntersectAction",void 0),t}(sf.base.ChildProperty),or=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ir(t,e),rr([sf.base.Property(!1)],t.prototype,"visible",void 0),rr([sf.base.Property("Circle")],t.prototype,"shape",void 0),rr([sf.base.Property("")],t.prototype,"imageUrl",void 0),rr([sf.base.Property(5)],t.prototype,"height",void 0),rr([sf.base.Property(!1)],t.prototype,"isFilled",void 0),rr([sf.base.Property(5)],t.prototype,"width",void 0),rr([sf.base.Complex({width:2,color:null},c)],t.prototype,"border",void 0),rr([sf.base.Complex({x:0,y:0},p)],t.prototype,"offset",void 0),rr([sf.base.Property(null)],t.prototype,"fill",void 0),rr([sf.base.Property(1)],t.prototype,"opacity",void 0),rr([sf.base.Complex({},nr)],t.prototype,"dataLabel",void 0),t}(sf.base.ChildProperty),sr=function(){this.symbolLocations=null,this.regions=null,this.percentage=null,this.regionData=null,this.isSelect=!1,this.marker={visible:!1},this.isPointInRange=!0},ar=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.clipRect=new sf.svgbase.Rect(0,0,0,0),t}return ir(t,e),t.prototype.setDataSource=function(e,t){e&&(this.points=e.points),t.trendLineModule.initDataSource(this),t.visibleSeriesCount++},rr([sf.base.Property("")],t.prototype,"name",void 0),rr([sf.base.Property("0")],t.prototype,"dashArray",void 0),rr([sf.base.Property(!0)],t.prototype,"visible",void 0),rr([sf.base.Property("Linear")],t.prototype,"type",void 0),rr([sf.base.Property(2)],t.prototype,"period",void 0),rr([sf.base.Property(2)],t.prototype,"polynomialOrder",void 0),rr([sf.base.Property(0)],t.prototype,"backwardForecast",void 0),rr([sf.base.Property(0)],t.prototype,"forwardForecast",void 0),rr([sf.base.Complex({},m)],t.prototype,"animation",void 0),rr([sf.base.Complex({},or)],t.prototype,"marker",void 0),rr([sf.base.Property(!0)],t.prototype,"enableTooltip",void 0),rr([sf.base.Property(null)],t.prototype,"intercept",void 0),rr([sf.base.Property("")],t.prototype,"fill",void 0),rr([sf.base.Property(1)],t.prototype,"width",void 0),rr([sf.base.Property("SeriesType")],t.prototype,"legendShape",void 0),t}(sf.base.ChildProperty),lr=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ir(t,e),rr([sf.base.Property(1)],t.prototype,"width",void 0),rr([sf.base.Property(10)],t.prototype,"length",void 0),rr([sf.base.Property(null)],t.prototype,"color",void 0),rr([sf.base.Property(1)],t.prototype,"opacity",void 0),t}(sf.base.ChildProperty),hr=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ir(t,e),rr([sf.base.Property(null)],t.prototype,"value",void 0),rr([sf.base.Property(null)],t.prototype,"color",void 0),rr([sf.base.Property("0")],t.prototype,"dashArray",void 0),t}(sf.base.ChildProperty),dr=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ir(t,e),rr([sf.base.Property(!1)],t.prototype,"visible",void 0),rr([sf.base.Property("Fixed")],t.prototype,"type",void 0),rr([sf.base.Property("Both")],t.prototype,"direction",void 0),rr([sf.base.Property("Vertical")],t.prototype,"mode",void 0),rr([sf.base.Property(null)],t.prototype,"color",void 0),rr([sf.base.Property(1)],t.prototype,"verticalError",void 0),rr([sf.base.Property(1)],t.prototype,"width",void 0),rr([sf.base.Property(1)],t.prototype,"horizontalError",void 0),rr([sf.base.Property(3)],t.prototype,"verticalPositiveError",void 0),rr([sf.base.Property(3)],t.prototype,"verticalNegativeError",void 0),rr([sf.base.Property(1)],t.prototype,"horizontalPositiveError",void 0),rr([sf.base.Property(1)],t.prototype,"horizontalNegativeError",void 0),rr([sf.base.Complex(null,lr)],t.prototype,"errorBarCap",void 0),t}(sf.base.ChildProperty),cr=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.rangeColorPoints=[],t.isAdvancedColor=void 0,t.currentViewData=[],t.clipRect=new sf.svgbase.Rect(0,0,0,0),t.seriesType="XY",t.isRectTypeSeries=!1,t}return ir(t,e),t.prototype.processJsonData=function(){var e=0,t=new sr,i=this instanceof pr&&"Histogram"===this.type?"x":this.xName,r=this instanceof pr&&this.marker.dataLabel.name?this.marker.dataLabel.name:"";this instanceof pr&&("Waterfall"!==this.type&&"Histogram"!==this.type||(this.currentViewData=this.chart[Ae(this.type)+"SeriesModule"].processInternalData(sf.base.extend([],this.currentViewData,null,!0),this)),"Pareto"===this.category&&(this.currentViewData=J(sf.base.extend([],this.currentViewData,null,!0),[this.yName],!0),"Line"===this.type&&(this.currentViewData=this.chart.paretoSeriesModule.performCumulativeCalculation(this.currentViewData,this))),this.isRectTypeSeries=this.type.indexOf("Column")>-1||this.type.indexOf("Bar")>-1||this.type.indexOf("Histogram")>-1);var n=(this.currentViewData||[]).length;if(this.points=[],this.xMin=1/0,this.xMax=-1/0,this.yMin=1/0,this.yMax=-1/0,this.sizeMax=-1/0,this.getSeriesType(),"Category"===this.xAxis.valueType)for(;e<n;)t=this.dataPoint(e,r,i),this.pushCategoryData(t,e,t.x),this.pushData(t,e),this.setEmptyPoint(t,e),this.rangeColorsInterior(t),e++;else if(this.xAxis.valueType.indexOf("DateTime")>-1)for(var o={skeleton:"full",type:"dateTime"},s=this.chart.intl.getDateParser(o),a=this.chart.intl.getDateFormat(o);e<n;)t=this.dataPoint(e,r,i),sf.base.isNullOrUndefined(t.x)||""===t.x?t.visible=!1:(t.x=new Date(sf.data.DataUtil.parse.parseJson({val:t.x}).val),"DateTime"===this.xAxis.valueType?t.xValue=Date.parse(t.x.toString()):this.chart.isBlazor?this.pushCategoryData(t,e,Date.parse(t.x.toString()).toString()):this.pushCategoryData(t,e,Date.parse(s(a(t.x))).toString()),this.pushData(t,e),this.setEmptyPoint(t,e)),e++;else for(;e<n;)(t=this.dataPoint(e,r,i)).xValue=t.x,this.pushData(t,e),this.setEmptyPoint(t,e),e++;if(this instanceof pr){if(this.type.indexOf("Spline")>-1||this.drawType.indexOf("Spline")>-1&&"PolarRadar"===this.chart.chartAreaType){var l=this.type.indexOf("Area")>-1||this.drawType.indexOf("Area")>-1,h=this.type.indexOf("Range")>-1;this.chart["spline"+(l?h?"RangeArea":"Area":"")+"SeriesModule"].findSplinePoint(this)}else this.type.indexOf("Histogram")>-1&&(this.xAxis.maximum||this.xAxis.minimum)&&this.chart.histogramSeriesModule.calculateBinValues(this);this.type.indexOf("Histogram")>-1&&1===this.points.length&&(this.xMin=this.xMin-this.histogramValues.binWidth,this.xMax=this.xMax+this.histogramValues.binWidth)}},t.prototype.rangeColorsInterior=function(e){this.chart.rangeColorSettings&&this.chart.rangeColorSettings.length>0&&1===this.chart.visibleSeries.length&&("Column"===this.chart.series[0].type||"Bar"===this.chart.series[0].type||"Scatter"===this.chart.series[0].type||"Bubble"===this.chart.series[0].type)&&(this.rangeColorPoints[e.interior]?void 0!==this.rangeColorPoints[e.interior]&&this.rangeColorPoints[e.interior].push(e):this.rangeColorPoints[e.interior]=[])},t.prototype.pushData=function(e,t){e.index=t,e.yValue=e.y,this.xMin=Math.min(this.xMin,e.xValue),this.xMax=Math.max(this.xMax,e.xValue),this.xData.push(e.xValue)},t.prototype.dataPoint=function(e,t,i){this.points[e]=new sr;var r=this.points[e],n=this.currentViewData[e],o=this.enableComplexProperty?sf.base.getValue:this.getObjectValue;return r.x=o(i,n),r.high=o(this.high,n),r.low=o(this.low,n),r.open=o(this.open,n),r.close=o(this.close,n),r.volume=o(this.volume,n),r.interior=o(this.pointColorMapping,n),this instanceof pr&&(r.y=o(this.yName,n),r.size=o(this.size,n),r.text=o(t,n),r.tooltip=o(this.tooltipMappingName,n),this.isAdvancedColorSupported()&&(this.rangeColorName=this.colorName.length>0?this.colorName:this.yName,r.colorValue=o(this.rangeColorName,n),r.interior=this.getPointFillColor(r.interior,r.colorValue))),r},t.prototype.isAdvancedColorSupported=function(){return sf.base.isNullOrUndefined(this.isAdvancedColor)&&(this.chart.rangeColorSettings&&this.chart.rangeColorSettings.length>0&&1===this.chart.visibleSeries.length&&("Column"===this.chart.series[0].type||"Bar"===this.chart.series[0].type||"Scatter"===this.chart.series[0].type||"Bubble"===this.chart.series[0].type)?this.isAdvancedColor=!0:this.isAdvancedColor=!1),this.isAdvancedColor},t.prototype.getPointFillColor=function(e,t){var i=e;if(t&&this.chart.rangeColorSettings&&this.chart.rangeColorSettings.length>0)for(var r=0,n=this.chart.rangeColorSettings;r<n.length;r++){var o=n[r];t>=o.start&&t<=o.end&&(i=o.colors.length>1?Qt(o,t):o.colors[0])}return i},t.prototype.getObjectValue=function(e,t){return t[e]},t.prototype.setEmptyPoint=function(e,t){if(!this.findVisibility(e))return e.visible=!0,null;switch(e.isEmpty=!0,this instanceof pr&&e.isPointInRange?this.emptyPointSettings.mode:"Drop"){case"Zero":e.visible=!0,this instanceof pr&&this.seriesType.indexOf("HighLow")>-1?(e.high=e.low=0,this.seriesType.indexOf("HighLowOpenClose")>-1&&(e.open=e.close=0)):e.y=e.yValue=this.yData[t]=0;break;case"Average":this instanceof pr&&(this.seriesType.indexOf("HighLow")>-1?(e.high=sf.base.isNullOrUndefined(e.high)||isNaN(+e.high)?this.getAverage(this.high,t):e.high,e.low=sf.base.isNullOrUndefined(e.low)||isNaN(+e.low)?this.getAverage(this.low,t):e.low,this.seriesType.indexOf("HighLowOpenClose")>-1&&(e.open=sf.base.isNullOrUndefined(e.open)||isNaN(+e.open)?this.getAverage(this.open,t):e.open,e.close=sf.base.isNullOrUndefined(e.close)||isNaN(+e.close)?this.getAverage(this.close,t):e.close)):e.y=e.yValue=this.yData[t]=this.getAverage(this.yName,t)),e.visible=!0;break;case"Drop":case"Gap":this.yData[t]=null,e.visible=!1}},t.prototype.findVisibility=function(e){var t,i=this instanceof pr?this.seriesType:"HighLowOpenClose",r=this.yAxis.minimum,n=this.yAxis.maximum;switch(i){case"XY":return"PolarRadar"===this.chart.chartAreaType&&(!sf.base.isNullOrUndefined(r)&&e.yValue<r||!sf.base.isNullOrUndefined(n)&&e.yValue>n)?(e.isPointInRange=!1,!0):(this.setXYMinMax(e.yValue),this.yData.push(e.yValue),this instanceof pr&&"Bubble"===this.type&&(this.sizeMax=Math.max(this.sizeMax,sf.base.isNullOrUndefined(e.size)||isNaN(+e.size)?this.sizeMax:e.size)),sf.base.isNullOrUndefined(e.x)||sf.base.isNullOrUndefined(e.y)||isNaN(+e.y));case"HighLow":return this.setHiloMinMax(e.high,e.low),sf.base.isNullOrUndefined(e.x)||sf.base.isNullOrUndefined(e.low)||isNaN(+e.low)||sf.base.isNullOrUndefined(e.high)||isNaN(+e.high);case"HighLowOpenClose":return this.setHiloMinMax(e.high,e.low),sf.base.isNullOrUndefined(e.x)||sf.base.isNullOrUndefined(e.low)||isNaN(+e.low)||sf.base.isNullOrUndefined(e.open)||isNaN(+e.open)||sf.base.isNullOrUndefined(e.close)||isNaN(+e.close)||sf.base.isNullOrUndefined(e.high)||isNaN(+e.high);case"BoxPlot":return t=(e.y||[null]).filter((function(e){return!sf.base.isNullOrUndefined(e)&&!isNaN(e)})).sort((function(e,t){return e-t})),e.y=t,this.yMin=Math.min(this.yMin,Math.min.apply(Math,t)),this.yMax=Math.max(this.yMax,Math.max.apply(Math,t)),!t.length}},t.prototype.setXYMinMax=function(e){var t,i="Logarithmic"===this.yAxis.valueType||"Logarithmic"===this.xAxis.valueType,r=e<0||"None"===this.yAxis.rangePadding;t=this.isRectTypeSeries&&!Ue(this.yAxis)?i||r?e:0:e,this.yMin=i?Math.min(this.yMin,sf.base.isNullOrUndefined(t)||isNaN(t)||0===t||"0"===t.toString()||""===t.toString()?this.yMin:t):Math.min(this.yMin,sf.base.isNullOrUndefined(t)||isNaN(t)?this.yMin:t),this.yMax=Math.max(this.yMax,sf.base.isNullOrUndefined(e)||isNaN(e)?this.yMax:e)},t.prototype.setHiloMinMax=function(e,t){this.yMin=Math.min(this.yMin,Math.min(sf.base.isNullOrUndefined(t)||isNaN(t)?this.yMin:t,sf.base.isNullOrUndefined(e)||isNaN(e)?this.yMin:e)),this.yMax=Math.max(this.yMax,Math.max(sf.base.isNullOrUndefined(t)||isNaN(t)?this.yMax:t,sf.base.isNullOrUndefined(e)||isNaN(e)?this.yMax:e))},t.prototype.getSeriesType=function(){var e;if(this instanceof pr){var t="PolarRadar"===this.chart.chartAreaType?this.drawType:this.type;if(t)switch(t){case"RangeColumn":case"RangeArea":case"SplineRangeArea":case"Hilo":e="HighLow";break;case"HiloOpenClose":case"Candle":e="HighLowOpenClose";break;case"BoxAndWhisker":e="BoxPlot";break;default:e="XY"}}this.seriesType=e},t.prototype.pushCategoryData=function(e,t,i){if(!this.chart.tooltip.shared&&!this.visible)return null;this.xAxis.isIndexed?(this.xAxis.labels[t]?this.xAxis.labels[t]+=", "+i:this.xAxis.labels.push(i),e.xValue=t):(void 0===this.xAxis.indexLabels[i]&&(this.xAxis.indexLabels[i]=this.xAxis.labels.length,this.xAxis.labels.push(i)),e.xValue=this.xAxis.indexLabels[i])},t.prototype.getAverage=function(e,t,i){return void 0===i&&(i=this.currentViewData),((i[t-1]&&i[t-1][e]||0)+(i[t+1]&&i[t+1][e]||0))/2},t.prototype.refreshDataManager=function(e){var t,i=this;this.chart=e;(t=e.isAngular?Object.keys(this.dataSource).length?this.dataSource:e.dataSource:this.dataSource||e.dataSource)instanceof sf.data.DataManager||!sf.base.isNullOrUndefined(this.query)?this.dataModule.getData(this.dataModule.generateQuery().requiresCount()).then((function(e){return i.dataManagerSuccess(e)})):this.dataManagerSuccess({result:t,count:t.length},!1)},t.prototype.dataManagerSuccess=function(e,t){if(void 0===t&&(t=!0),this.currentViewData=e.count?e.result:[],this.chart.allowServerDataBinding=!1,this instanceof pr){this.chart.stockChart&&(this.chart.stockChart.series[this.index].localData=this.currentViewData);var i={name:"seriesRender",series:this,data:this.currentViewData,fill:this.interior};this.chart.trigger("seriesRender",i),this.interior=i.fill,this.currentViewData=i.data}!this.chart.stockChart||this instanceof pr||(this.currentViewData=this.chart.stockChart.findCurrentData(this.chart.stockChart.series[0].localData,this.chart.stockChart.series[0].xName)),this.processJsonData(),this.recordsCount=e.count,this.refreshChart(t),this.currentViewData=null},t.prototype.refreshChart=function(e){var t=this.chart;if(this instanceof pr&&(t.visibleSeriesCount+=e?1:0),t.refreshTechnicalIndicator(this),this instanceof pr&&"TrendLine"!==this.category)for(var i=0,r=this.trendlines;i<r.length;i++){r[i].setDataSource(this,t)}t.visibleSeries.length===t.visibleSeriesCount&&(t.refreshBound(),t.trigger("loaded",{chart:t.isBlazor?{}:t}),this.chart.stockChart&&this.chart.stockChart.initialRender&&(this.chart.stockChart.initialRender=!1,this.chart.stockChart.stockChartDataManagerSuccess())),this instanceof pr&&(t.visibleSeriesCount+=e?0:1)},rr([sf.base.Property("")],t.prototype,"xName",void 0),rr([sf.base.Property("")],t.prototype,"colorName",void 0),rr([sf.base.Property("")],t.prototype,"high",void 0),rr([sf.base.Property("")],t.prototype,"low",void 0),rr([sf.base.Property("")],t.prototype,"open",void 0),rr([sf.base.Property("")],t.prototype,"close",void 0),rr([sf.base.Property("")],t.prototype,"volume",void 0),rr([sf.base.Property("")],t.prototype,"pointColorMapping",void 0),rr([sf.base.Property(!0)],t.prototype,"visible",void 0),rr([sf.base.Property(null)],t.prototype,"xAxisName",void 0),rr([sf.base.Property(null)],t.prototype,"yAxisName",void 0),rr([sf.base.Complex(null,m)],t.prototype,"animation",void 0),rr([sf.base.Property(null)],t.prototype,"fill",void 0),rr([sf.base.Property(1)],t.prototype,"width",void 0),rr([sf.base.Property("0")],t.prototype,"dashArray",void 0),rr([sf.base.Property("")],t.prototype,"dataSource",void 0),rr([sf.base.Property()],t.prototype,"query",void 0),rr([sf.base.Collection([],hr)],t.prototype,"segments",void 0),rr([sf.base.Property("X")],t.prototype,"segmentAxis",void 0),rr([sf.base.Property(!1)],t.prototype,"enableComplexProperty",void 0),t}(sf.base.ChildProperty),pr=function(e){function t(t,i,r,n){var o=e.call(this,t,i,r,n)||this;return o.visibleSeriesCount=0,o.category="Series",o.isRectSeries=!1,o.drawPoints=[],o.lowDrawPoints=[],o.delayedAnimation=!1,o.rangeColorName=o.colorName.length>0?o.colorName:o.yName,o}return ir(t,e),t.prototype.refreshAxisLabel=function(){if("Category"!==this.xAxis.valueType)return null;this.xAxis.labels=[],this.xAxis.indexLabels={};for(var e=0,t=this.xAxis.series;e<t.length;e++){var i=t[e];if(i.visible&&"TrendLine"!==i.category){i.xMin=1/0,i.xMax=-1/0;for(var r=0,n=i.points;r<n.length;r++){var o=n[r];i.pushCategoryData(o,o.index,o.x),i.xMin=Math.min(i.xMin,o.xValue),i.xMax=Math.max(i.xMax,o.xValue)}}}},t.prototype.findSeriesCollection=function(e,t,i){for(var r=[],n=0,o=t.axes;n<o.length;n++)for(var s=0,a=o[n].series;s<a.length;s++)for(var l=a[s],h=0,d=e.axes;h<d.length;h++)for(var c=0,p=d[h].series;c<p.length;c++){var u=p[c];u===l&&u.visible&&this.rectSeriesInChart(u,i)&&r.push(u)}return r},t.prototype.rectSeriesInChart=function(e,t){var i=e.type.toLowerCase();return-1!==i.indexOf("column")||-1!==i.indexOf("bar")||-1!==i.indexOf("histogram")||-1!==i.indexOf("hiloopenclose")||-1!==i.indexOf("candle")||-1!==i.indexOf("pareto")||-1!==i.indexOf("hilo")||-1!==e.drawType.indexOf("Column")||-1!==i.indexOf("waterfall")||-1!==i.indexOf("boxandwhisker")||t},t.prototype.calculateStackedValue=function(e,t){for(var i=0,r=t.columns;i<r.length;i++)for(var n=r[i],o=0,s=t.rows;o<s.length;o++){var a=s[o];this.calculateStackingValues(this.findSeriesCollection(n,a,!0),e)}},t.prototype.calculateStackingValues=function(e,t){var i,r,n,o,s,a=[],l=[],h=[],d=[];t&&(d=this.findFrequencies(e));for(var c=[],p=[],u=[],g=0,f=e;g<f.length;g++){var m=f[g];if(-1!==m.type.indexOf("Stacking")||-1!==m.drawType.indexOf("Stacking")&&"PolarRadar"===m.chart.chartAreaType){l[n=-1!==m.type.indexOf("StackingArea")?"StackingArea100":-1!==m.type.indexOf("StackingLine")?"StackingLine100":m.stackingGroup]||(l[n]=[],h[n]=[]),a=m.yData,i=[],r=[],c.push(m);for(var y=0,v=(u=ee(m)).length;y<v;y++)o=0,s=+a[y],void 0===l[n][u[y].xValue]&&(l[n][u[y].xValue]=0),void 0===h[n][u[y].xValue]&&(h[n][u[y].xValue]=0),t?(s=s/d[n][u[y].xValue]*100,s=isNaN(s)?0:s,u[y].percentage=+s.toFixed(2)):p[y]=p[y]?p[y]+Math.abs(s):Math.abs(s),s>=0?(o=l[n][u[y].xValue],l[n][u[y].xValue]+=s):(o=h[n][u[y].xValue],h[n][u[y].xValue]+=s),i.push(o),r.push(s+o),t&&r[y]>100&&(r[y]=100);m.stackedValues=new Et(i,r);var b="Logarithmic"===m.yAxis.valueType,w=-1!==m.type.indexOf("Column")||-1!==m.type.indexOf("Bar");m.yMin=b&&w&&m.yMin<1?m.yMin:Math.min.apply(0,i),m.yMax=Math.max.apply(0,r),m.yMin>Math.min.apply(0,r)&&(m.yMin=t?-100:b&&w&&m.yMin<1?m.yMin:Math.min.apply(0,r)),m.yMax<Math.max.apply(0,i)&&(m.yMax=0)}}this.findPercentageOfStacking(c,p,t)},t.prototype.findPercentageOfStacking=function(e,t,i){for(var r=0,n=e;r<n.length;r++){var o=n[r];if(i)return null;for(var s=0,a=ee(o);s<a.length;s++){var l=a[s];l.percentage=Math.abs(+(l.y/t[l.index]*100).toFixed(2))}}},t.prototype.findFrequencies=function(e){for(var t,i=[],r=[],n=0,o=e;n<o.length;n++){var s=o[n];if(s.yAxis.isStack100=-1!==s.type.indexOf("100"),r=ee(s),-1!==s.type.indexOf("Stacking")){i[t=-1!==s.type.indexOf("StackingArea")?"StackingArea100":-1!==s.type.indexOf("StackingLine")?"StackingLine100":s.stackingGroup]||(i[t]=[]);for(var a=0,l=r.length;a<l;a++)void 0===i[t][r[a].xValue]&&(i[t][r[a].xValue]=0),s.yData[a]>0?i[t][r[a].xValue]+=s.yData[a]:i[t][r[a].xValue]-=s.yData[a]}}return i},t.prototype.renderSeries=function(e){var t=Ae(this.type);e[(t=t.replace("100",""))+"SeriesModule"]&&("Indicator"!==this.category&&"TrendLine"!==this.category&&this.createSeriesElements(e),this.visiblePoints=ee(this),e[t+"SeriesModule"].render(this,this.xAxis,this.yAxis,e.requireInvertedAxis),"Indicator"!==this.category&&(this.errorBar.visible&&this.chart.errorBarModule.render(this),this.marker.dataLabel.visible&&e.dataLabelModule.render(this,this.chart,this.marker.dataLabel),this.appendSeriesElement(e.seriesElements,e)),this.chart.enableCanvas||this.performAnimation(e,t,this.errorBar,this.marker,this.marker.dataLabel))},t.prototype.createSeriesElements=function(e){if("Indicator"!==this.category){var t=e.element.id,i=this.marker.border.width+8+5,r="Bubble"===this.type?e.svgRenderer:e.renderer,n=void 0===this.index?this.category:this.index,o=void 0,s=void 0,a=void 0;if("Scatter"===this.type||"Scatter"===this.drawType?(o=e.primaryYAxis.maximum||e.primaryXAxis.maximum?0:(this.marker.height+i)/2,s=e.primaryYAxis.maximum||e.primaryXAxis.maximum?0:(this.marker.width+i)/2):(o=0,s=0),"PolarRadar"===e.chartAreaType){var l="Scatter"===this.drawType?Math.max(this.marker.width,this.marker.height):0;a=new Wt(t+"_ChartSeriesClipRect_"+n,"transparent",{width:1,color:"Gray"},1,this.clipRect.width/2+this.clipRect.x,this.clipRect.height/2+this.clipRect.y,e.radius+l),this.clipRectElement=Re(e.redraw,a,r,"drawCircularClipPath")}else a=new zt(t+"_ChartSeriesClipRect_"+n,"transparent",{width:1,color:"Gray"},1,{x:-s,y:-o,width:this.clipRect.width+2*s,height:this.clipRect.height+2*o}),this.clipRectElement=Re(e.redraw,a,r);var h="Cartesian"===e.chartAreaType?"translate("+this.clipRect.x+","+this.clipRect.y+")":"";this.symbolElement=null,this.seriesElement=r.createGroup({id:t+"SeriesGroup"+n,transform:h,"clip-path":"url(#"+t+"_ChartSeriesClipRect_"+n+")"}),this.seriesElement&&(this.seriesElement.setAttribute("aria-label",this.name+","+this.type+" series with "+this.points.length+" data points"),this.seriesElement.setAttribute("aria-hidden","false")),this.chart.enableCanvas&&"Bubble"!==this.type||(this.seriesElement.setAttribute("tabindex",0===n?"0":""),this.seriesElement.setAttribute("style","outline: none"),this.seriesElement.appendChild(this.clipRectElement))}},t.prototype.appendSeriesElement=function(e,t){var i=this.marker,r=i.dataLabel,n=t.redraw;"TrendLine"!==this.category&&(nt(t.enableCanvas,t.seriesElements,this.seriesElement,n),this.errorBar.visible&&("PolarRadar"===t.chartAreaType?nt(t.enableCanvas,t.seriesElements,this.seriesElement,n):nt(t.enableCanvas,t.seriesElements,this.errorBarElement,n)),"Scatter"!==this.type&&"Bubble"!==this.type&&"Scatter"!==this.drawType||nt(t.enableCanvas,t.seriesElements,this.seriesElement,n));i.visible&&("Cartesian"===t.chartAreaType||"Scatter"!==this.drawType&&"PolarRadar"===t.chartAreaType)&&"Scatter"!==this.type&&"Bubble"!==this.type&&"Candle"!==this.type&&"Hilo"!==this.type&&"HiloOpenClose"!==this.type&&this.symbolElement&&nt(t.enableCanvas,t.seriesElements,this.symbolElement,n),r.visible&&this.textElement&&(nt(t.enableCanvas,t.dataLabelElements,this.shapeElement,n),nt(t.enableCanvas,t.dataLabelElements,this.textElement,n)),!t.enableCanvas&&t.dataLabelElements.hasChildNodes()&&t.seriesElements.appendChild(t.dataLabelElements)},t.prototype.performAnimation=function(e,t,i,r,n){this.animation.enable&&e.animateSeries&&(e[t+"SeriesModule"].doAnimation(this),i.visible&&e.errorBarModule.doErrorBarAnimation(this),r.visible&&e.markerRender.doMarkerAnimation(this),n.visible&&"edge"!==sf.base.Browser.info.name&&!sf.base.Browser.isIE&&e.dataLabelModule.doDataLabelAnimation(this))},t.prototype.setPointColor=function(e,t){return t=e.interior||t,e.isEmpty&&this.emptyPointSettings.fill||t},t.prototype.setBorderColor=function(e,t){return t.width=e.isEmpty&&this.emptyPointSettings.border.width||t.width,t.color=e.isEmpty&&this.emptyPointSettings.border.color||t.color,t},rr([sf.base.Property("")],t.prototype,"name",void 0),rr([sf.base.Property("")],t.prototype,"yName",void 0),rr([sf.base.Property("Line")],t.prototype,"drawType",void 0),rr([sf.base.Property(!0)],t.prototype,"isClosed",void 0),rr([sf.base.Property("#2ecd71")],t.prototype,"bearFillColor",void 0),rr([sf.base.Property("#e74c3d")],t.prototype,"bullFillColor",void 0),rr([sf.base.Property(!1)],t.prototype,"enableSolidCandles",void 0),rr([sf.base.Property("")],t.prototype,"size",void 0),rr([sf.base.Property(null)],t.prototype,"binInterval",void 0),rr([sf.base.Property(!1)],t.prototype,"showNormalDistribution",void 0),rr([sf.base.Property("")],t.prototype,"stackingGroup",void 0),rr([sf.base.Complex({color:null,width:0},c)],t.prototype,"border",void 0),rr([sf.base.Property(1)],t.prototype,"opacity",void 0),rr([sf.base.Property(0)],t.prototype,"zOrder",void 0),rr([sf.base.Property("")],t.prototype,"groupName",void 0),rr([sf.base.Property("Line")],t.prototype,"type",void 0),rr([sf.base.Complex(null,dr)],t.prototype,"errorBar",void 0),rr([sf.base.Complex(null,or)],t.prototype,"marker",void 0),rr([sf.base.Complex({},x)],t.prototype,"dragSettings",void 0),rr([sf.base.Collection([],ar)],t.prototype,"trendlines",void 0),rr([sf.base.Property(!0)],t.prototype,"enableTooltip",void 0),rr([sf.base.Property("")],t.prototype,"tooltipFormat",void 0),rr([sf.base.Property("")],t.prototype,"tooltipMappingName",void 0),rr([sf.base.Property("SeriesType")],t.prototype,"legendShape",void 0),rr([sf.base.Property("")],t.prototype,"legendImageUrl",void 0),rr([sf.base.Property(null)],t.prototype,"selectionStyle",void 0),rr([sf.base.Property(null)],t.prototype,"unSelectedStyle",void 0),rr([sf.base.Property(null)],t.prototype,"nonHighlightStyle",void 0),rr([sf.base.Property(1)],t.prototype,"minRadius",void 0),rr([sf.base.Property(3)],t.prototype,"maxRadius",void 0),rr([sf.base.Property("Natural")],t.prototype,"splineType",void 0),rr([sf.base.Property(.5)],t.prototype,"cardinalSplineTension",void 0),rr([sf.base.Complex(null,w)],t.prototype,"emptyPointSettings",void 0),rr([sf.base.Property(!0)],t.prototype,"showMean",void 0),rr([sf.base.Property("Normal")],t.prototype,"boxPlotMode",void 0),rr([sf.base.Property(null)],t.prototype,"columnWidth",void 0),rr([sf.base.Property(null)],t.prototype,"columnWidthInPixel",void 0),rr([sf.base.Property(0)],t.prototype,"columnSpacing",void 0),rr([sf.base.Property("#C64E4A")],t.prototype,"negativeFillColor",void 0),rr([sf.base.Property("#4E81BC")],t.prototype,"summaryFillColor",void 0),rr([sf.base.Property()],t.prototype,"intermediateSumIndexes",void 0),rr([sf.base.Property()],t.prototype,"sumIndexes",void 0),rr([sf.base.Complex({color:"black",width:2},h)],t.prototype,"connector",void 0),rr([sf.base.Complex(null,v)],t.prototype,"cornerRadius",void 0),t}(cr),ur=function(){function e(e,t){this.initDataManager(e,t)}return e.prototype.initDataManager=function(e,t){this.dataManager=e instanceof sf.data.DataManager?e:new sf.data.DataManager(e),this.query=t instanceof sf.data.Query?t:new sf.data.Query},e.prototype.generateQuery=function(){return this.query.clone()},e.prototype.getData=function(e){var t=this;if(this.dataManager.ready){var i=new sf.data.Deferred;return this.dataManager.ready.then((function(){t.dataManager.executeQuery(e).then((function(e){i.resolve(e)}))})).catch((function(e){i.reject(e)})),i.promise}return this.dataManager.executeQuery(e)},e}(),gr=(Jt=function(e,t){return(Jt=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}Jt(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),fr=function(e){function t(t){var i=e.call(this,t)||this;return i.elementId=t.element.id,i.commonXvalues=[],i}return gr(t,e),t.prototype.addEventListener=function(){this.chart.isDestroyed||(this.chart.on(sf.base.Browser.touchMoveEvent,this.mouseMoveHandler,this),this.chart.on(sf.base.Browser.touchEndEvent,this.mouseUpHandler,this))},t.prototype.removeEventListener=function(){this.chart.isDestroyed||(this.chart.off(sf.base.Browser.touchMoveEvent,this.mouseMoveHandler),this.chart.off(sf.base.Browser.touchEndEvent,this.mouseUpHandler))},t.prototype.mouseUpHandler=function(){var e=this.chart;!e.isTouch||e.crosshair.enable||this.isSelected(e)||this.markerMove(!0)},t.prototype.mouseMoveHandler=function(){var e=this.chart;"None"===e.highlightMode&&!e.tooltip.enable||e.isTouch&&!e.startMove||this.isSelected(e)||this.markerMove(!1)},t.prototype.markerMove=function(e){var t,i,r,n,o=this,s=this.chart;if(this.currentPoints=[],s.tooltip.shared&&s.tooltip.enable){if(!Ce(s.mouseX,s.mouseY,s.chartAxisLayoutPanel.seriesClipRect))return null;if(s.tooltip.enable)for(var a="PolarRadar"===s.chartAreaType?this.getData():null,l=(this.mergeXvalues(this.chart.visibleSeries),0),h=s.visibleSeries;l<h.length;l++){var d=h[l];d.enableTooltip&&"Indicator"!==d.category&&("Cartesian"===s.chartAreaType&&d.visible?t=this.getClosestX(s,d,this.commonXValue(this.chart.visibleSeries)):"PolarRadar"===s.chartAreaType&&d.visible&&null!==a.point&&(t=new _t(d.points[a.point.index],d)),t&&(this.currentPoints.push(t),t=null))}}else t=this.getData(),n=t.series,i=this.previousPoints[0],r=n&&("Bubble"===n.type||"Scatter"===n.drawType||"Scatter"===n.type||"Candle"!==n.type&&"Hilo"!==n.type&&"HiloOpenClose"!==n.type&&n.marker.visible&&0!==n.marker.width&&0!==n.marker.height),t.lierIndex=this.lierIndex,t.point&&r&&(!i||i.point!==t.point||i&&i.lierIndex>3&&i.lierIndex!==this.lierIndex)&&this.currentPoints.push(t),t.point&&r&&s.isPointMouseDown&&this.currentPoints.push(t);var c=this.previousPoints.length;if(this.currentPoints.length>0&&(0===c||s.isPointMouseDown||c>0&&this.previousPoints[0].point!==this.currentPoints[0].point)){if(this.previousPoints.length>0)for(var p=0,u=this.previousPoints;p<u.length;p++){var g=u[p];sf.base.isNullOrUndefined(g)||this.removeHighlightedMarker(g.series,g.point)}for(var f=function(e){(e&&e.point||"Candle"!==n.type&&"Hilo"!==n.type&&"HiloOpenClose"!==n.type)&&(lt(m.markerExplode),m.isRemove=!0,e.point.symbolLocations.map((function(t,i){e.series.isRectSeries&&!e.point.marker.visible||o.drawTrackBall(e.series,e.point,t,i)})))},m=this,y=0,v=this.currentPoints;y<v.length;y++){f(v[y])}this.previousPoints=sf.base.extend([],this.currentPoints,null,!0)}s.tooltip.enable||!(0===this.currentPoints.length&&this.isRemove||e&&this.isRemove)&&Ce(s.mouseX,s.mouseY,s.chartAxisLayoutPanel.seriesClipRect)||(this.isRemove=!1,sf.base.isNullOrUndefined(this.previousPoints[0])||(this.markerExplode=+setTimeout((function(){o.removeHighlightedMarker(o.previousPoints[0].series,o.previousPoints[0].point)}),2e3))),this.currentPoints=[]},t.prototype.animationDuration=function(){var e=200;return this.chart.maxPointCount>100?e=10:this.chart.maxPointCount>50&&(e=100),e},t.prototype.drawTrackBall=function(e,t,i,r){var n=t.marker,o=e.marker,s=n.shape||o.shape;if("None"===s)return null;var a,l=e.symbolElement||e.seriesElement;this.chart.highlightModule&&"None"!==this.chart.highlightMode&&(a=this.chart.highlightModule.generateStyle(e)),this.chart.selectionModule&&"None"!==this.chart.selectionMode&&(a=this.chart.selectionModule.generateStyle(e));var h=this.elementId+"_Series_"+e.index+"_Point_"+t.index+"_Trackball"+(r||""),d=new sf.svgbase.Size((n.width||o.width)+5,(n.height||o.height)+5),c=n.border||e.border,p="BoxAndWhisker"===e.type||"Bubble"===e.type||"Scatter"===e.type,u=c.color&&"transparent"!==c.color?c.color:n.fill||t.interior||(p?t.color:e.interior),g=gt(ft(u)),f=n.border?n.border.width:o.border.width,m=e.chart.themeStyle.markerShadow||"rgba("+g.r+","+g.g+","+g.b+",0.2)",y=document.getElementById(this.elementId+"_Series_"+e.index+"_Point_"+t.index+"_Symbol");sf.base.isNullOrUndefined(y)||y.setAttribute("visibility","hidden");for(var v=0;v<2;v++){var b=new sf.svgbase.PathOption(h+"_"+v,v?n.fill||t.color||(p?e.interior:"#ffffff"):"transparent",f+(v?0:8),v?u:m,n.opacity||o.opacity,null,null),w=Ve(i,s,d,n.imageUrl,b,0,this.chart.svgRenderer,e.clipRect);w.setAttribute("class","EJ2-Trackball_Series_"+e.index+"_Point_"+t.index);var x=-1!==l.id.indexOf("Symbol")?"_Symbol":"",M=document.getElementById(this.elementId+"_Series_"+e.index+"_Point_"+t.index+x);""===a||sf.base.isNullOrUndefined(a)||sf.base.isNullOrUndefined(M)||!M.hasAttribute("class")||a!==M.getAttribute("class")||w.classList.add(a),w.setAttribute("clip-path",l.getAttribute("clip-path")),w.setAttribute("transform",l.getAttribute("transform")),this.chart.svgObject.appendChild(w)}this.doAnimation(e,t,!1)},t.prototype.doAnimation=function(e,t,i){void 0===i&&(i=!1);for(var r=this.animationDuration(),n=e.animation.delay,o=document.getElementsByClassName("EJ2-Trackball_Series_"+e.index+"_Point_"+t.index),s=0,a=o.length;s<a;s++)this.trackballAnimate(o[s],n,r,e,t.index,t.symbolLocations[0],!1,i)},t.prototype.trackballAnimate=function(e,t,i,r,n,o,s,a){var l=o.x,h=o.y,d="Polar"!==r.type&&"Radar"!==r.type?r.clipRect.x:0,c="Polar"!==r.type&&"Radar"!==r.type?r.clipRect.y:0,p=0;e.style.visibility="hidden";var u=a?-8:1,g=e.getAttribute("transform");new sf.base.Animation({}).animate(e,{duration:i,delay:t,progress:function(t){t.timeStamp>t.delay&&(t.element.style.visibility="visible",p=(t.timeStamp-t.delay)/t.duration,e.setAttribute("transform","translate("+(l+d)+" "+(h+c)+") scale("+p/u+") translate("+-l+" "+-h+")"))},end:function(){e.style.visibility="",e.setAttribute("transform",g),s||n!==r.points.length-1||r.chart.trigger("animationComplete",{series:r.chart.isBlazor?{}:r}),a&&sf.base.remove(e)}})},t.prototype.removeHighlightedMarker=function(e,t,i){if(void 0===e&&(e=null),void 0===t&&(t=null),void 0===i&&(i=!1),sf.base.isNullOrUndefined(e)||sf.base.isNullOrUndefined(t))for(var r=0,n=e.points;r<n.length;r++){var o=n[r],s=document.getElementsByClassName("EJ2-Trackball_Series_"+e.index+"_Point_"+o.index);for(a=document.getElementById(this.elementId+"_Series_"+e.index+"_Point_"+o.index+"_Symbol"),h=0,d=s.length;h<d;h++)sf.base.isNullOrUndefined(a)||a.setAttribute("visibility","visible"),sf.base.remove(s[0])}else{for(var a=document.getElementById(this.elementId+"_Series_"+e.index+"_Point_"+t.index+"_Symbol"),l=document.getElementsByClassName("EJ2-Trackball_Series_"+e.index+"_Point_"+t.index),h=0,d=l.length;h<d;h++)sf.base.remove(l[0]);sf.base.isNullOrUndefined(a)||a.setAttribute("visibility","visible")}i&&(this.previousPoints=[])},t}(tr),mr=($t=function(e,t){return($t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}$t(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),yr=function(e){function t(t){var i=e.call(this,t)||this;return i.addEventListener(),i}return mr(t,e),t.prototype.render=function(e){var t=this,i=e.chart.redraw;this.createElement(e,i);for(var r=function(r){r.visible&&r.symbolLocations&&r.symbolLocations.length&&r.symbolLocations.map((function(n,o){"None"!==e.marker.shape&&t.renderMarker(e,r,n,o,i)}))},n=0,o=e.points;n<o.length;n++){r(o[n])}},t.prototype.renderMarker=function(e,t,i,r,n){var o,s,a,l,h=void 0===e.index?e.category:e.index,d=e.marker,c={color:d.border.color,width:d.border.width},p=d.border.color;i.x=i.x+d.offset.x,i.y=i.y-d.offset.y;var u,g="BoxAndWhisker"===e.type,f=d.fill||(g||e.marker.isFilled?t.interior||e.interior:"#ffffff"),m=g?tt(e.seriesElement.childNodes,"Series_"+e.index+"_Point_"+t.index):e.symbolElement;c.color=p||e.setPointColor(t,e.interior);var y=this.elementId+"_Series_"+h+"_Point_"+t.index+"_Symbol"+(r||""),v={cancel:!1,name:"pointRender",series:e,point:t,fill:t.isEmpty&&e.emptyPointSettings.fill||f,border:{color:"BoxAndWhisker"===e.type?sf.base.isNullOrUndefined(p)||"transparent"===p?mt(f,-.6):p:c.color,width:c.width},height:d.height,width:d.width,shape:d.shape};if(v.border=e.setBorderColor(t,{width:v.border.width,color:v.border.color}),e.isRectSeries&&"BoxAndWhisker"!==e.type||(this.chart.trigger("pointRender",v),t.color=v.fill),t.color=v.fill,v.cancel)i=null,t.marker={visible:!1};else{var b=void 0;b="RangeArea"===e.type||"RangeColumn"===e.type||"RangeColumn"===e.drawType||"SplineRangeArea"===e.type?r?t.low:t.high:g?t.outliers[r]:t.y;var w=v.point.marker.fill||v.fill,x=void 0;x=sf.base.isNullOrUndefined(v.point.marker.border)?{color:v.border.color,width:v.border.width}:{color:v.point.marker.border.color||v.border.color,width:v.point.marker.border.width||v.border.width};var M=v.point.marker.width||v.width,N=v.point.marker.height||v.height,I=v.point.marker.opacity||d.opacity,S=v.point.marker.shape||v.shape,C=v.point.marker.imageUrl||d.imageUrl;l=new sf.svgbase.PathOption(y,w,x.width,x.color,I,null),(null!=m||this.chart.enableCanvas)&&(n&&Ge(l.id)&&(a="Circle"===S?"c":"",o={x:+(u=Ge(l.id)).getAttribute(a+"x"),y:+u.getAttribute(a+"y")},s=u.getAttribute("d")),(u=Ve(i,S,new sf.svgbase.Size(M,N),C,l,(t.x.toString(),b.toString()),this.chart.renderer,e.clipRect))&&u.setAttribute("aria-label",t.x+": "+t.y+", "+e.name),nt(this.chart.enableCanvas,m,u,n,!0,a+"x",a+"y",o,s,!1,!1,null,e.chart.duration)),t.marker={border:x,fill:w,height:N,visible:!0,shape:S,width:M,imageUrl:C}}},t.prototype.createElement=function(e,t){var i,r,n=e.marker,o=n.border.width+8+5,s=e.chart.svgRenderer,a=void 0===e.index?e.category:e.index,l="Cartesian"===e.chart.chartAreaType?"translate("+e.clipRect.x+","+e.clipRect.y+")":"";if(n.visible){var h=(n.height+o)/2,d=(n.width+o)/2;if(i="Cartesian"===e.chart.chartAreaType?Re(t,r=new zt(this.elementId+"_ChartMarkerClipRect_"+a,"transparent",{width:1,color:"Gray"},1,{x:-d,y:-h,width:e.clipRect.width+2*d,height:e.clipRect.height+2*h}),s):Re(t,r=new Wt(this.elementId+"_ChartMarkerClipRect_"+a,"transparent",{width:1,color:"Gray"},1,e.clipRect.width/2+e.clipRect.x,e.clipRect.height/2+e.clipRect.y,e.chart.radius+Math.max(h,d)),s,"drawCircularClipPath"),r={id:this.elementId+"SymbolGroup"+a,transform:l,"clip-path":"url(#"+this.elementId+"_ChartMarkerClipRect_"+a+")"},e.symbolElement=s.createGroup(r),e.symbolElement.appendChild(i),this.chart.enableCanvas)document.getElementById(this.chart.element.id+"_tooltip_svg").appendChild(e.symbolElement)}},t.prototype.getRangeLowPoint=function(e,t){var i=e.x,r=e.y;return t.chart.requireInvertedAxis?(r+=e.height/2,i+=t.yAxis.isAxisInverse?e.width:0):(r+=t.yAxis.isAxisInverse?0:e.height,i+=e.width/2),{x:i,y:r}},t.prototype.doMarkerAnimation=function(e){if("Scatter"!==e.type&&"Bubble"!==e.type&&"Candle"!==e.type&&"Hilo"!==e.type&&"HiloOpenClose"!==e.type&&("PolarRadar"!==e.chart.chartAreaType||"Scatter"!==e.drawType))for(var t=e.symbolElement.childNodes,i=e.animation.delay+e.animation.duration,r=e.chart.animated?e.chart.duration:200,n=1,o="RangeArea"===e.type||"RangeColumn"===e.type||"SplineRangeArea"===e.type?2:1,s=0;s<e.points.length;s++)if(e.points[s].symbolLocations){if(!e.points[s].symbolLocations.length||!t[n])continue;if(ze(t[n],i,r,e,s,e.points[s].symbolLocations[0],!1),2===o){var a=this.getRangeLowPoint(e.points[s].regions[0],e);ze(t[n+1],i,r,e,s,a,!1)}n+=o}},t}(fr),vr=(ei=function(e,t){return(ei=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}ei(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),br=function(e,t,i,n){var o,s=arguments.length,a=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(s<3?o(a):s>3?o(t,i,a):o(t,i))||a);return s>3&&a&&Object.defineProperty(t,i,a),a},wr=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return vr(t,e),br([sf.base.Property(0)],t.prototype,"x",void 0),br([sf.base.Property(0)],t.prototype,"y",void 0),t}(sf.base.ChildProperty),xr=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return vr(i,e),br([sf.base.Property(!0)],i.prototype,"visible",void 0),br([sf.base.Property(null)],i.prototype,"height",void 0),br([sf.base.Property(null)],i.prototype,"width",void 0),br([sf.base.Complex({x:0,y:0},wr)],i.prototype,"location",void 0),br([sf.base.Property("Auto")],i.prototype,"position",void 0),br([sf.base.Property("Series")],i.prototype,"mode",void 0),br([sf.base.Property(8)],i.prototype,"padding",void 0),br([sf.base.Property(null)],i.prototype,"itemPadding",void 0),br([sf.base.Property("Center")],i.prototype,"alignment",void 0),br([sf.base.Complex(t.legendLabelFont,d)],i.prototype,"textStyle",void 0),br([sf.base.Property(10)],i.prototype,"shapeHeight",void 0),br([sf.base.Property(10)],i.prototype,"shapeWidth",void 0),br([sf.base.Complex({},c)],i.prototype,"border",void 0),br([sf.base.Complex({left:0,right:0,top:0,bottom:0},g)],i.prototype,"margin",void 0),br([sf.base.Complex({left:0,right:0,top:0,bottom:0},f)],i.prototype,"containerPadding",void 0),br([sf.base.Property(8)],i.prototype,"shapePadding",void 0),br([sf.base.Property("transparent")],i.prototype,"background",void 0),br([sf.base.Property(1)],i.prototype,"opacity",void 0),br([sf.base.Property(!0)],i.prototype,"toggleVisibility",void 0),br([sf.base.Property(!1)],i.prototype,"enableHighlight",void 0),br([sf.base.Property(null)],i.prototype,"description",void 0),br([sf.base.Property(3)],i.prototype,"tabIndex",void 0),br([sf.base.Property(null)],i.prototype,"title",void 0),br([sf.base.Complex(t.legendTitleFont,d)],i.prototype,"titleStyle",void 0),br([sf.base.Property("Top")],i.prototype,"titlePosition",void 0),br([sf.base.Property("Normal")],i.prototype,"textWrap",void 0),br([sf.base.Property("Ellipsis")],i.prototype,"textOverflow",void 0),br([sf.base.Property(100)],i.prototype,"maximumTitleWidth",void 0),br([sf.base.Property(null)],i.prototype,"maximumLabelWidth",void 0),br([sf.base.Property(!0)],i.prototype,"enablePages",void 0),br([sf.base.Property(!1)],i.prototype,"isInversed",void 0),br([sf.base.Property(!1)],i.prototype,"reverse",void 0),i}(sf.base.ChildProperty),Mr=function(){function e(e){this.maxItemHeight=0,this.rowHeights=[],this.pageHeights=[],this.columnHeights=[],this.pageXCollections=[],this.chartRowCount=1,this.legendTitleCollections=[],this.legendRegions=[],this.pagingRegions=[],this.chart=e,this.legend=e.legendSettings,this.legendID=e.element.id+"_chart_legend",this.isChartControl="chart"===e.getModuleName(),this.isAccChartControl="accumulationchart"===e.getModuleName(),this.isBulletChartControl="bulletChart"===e.getModuleName(),this.isStockChartControl="stockChart"===e.getModuleName(),this.bulletChart=this.chart,this.fivePixel=5,this.rowCount=0,this.pageButtonSize=8,this.maxColumns=0,this.maxWidth=0,this.currentPage=1,this.backwardArrowOpacity=0,this.forwardArrowOpacity=1,this.arrowWidth=2*(this.fivePixel+this.pageButtonSize+this.fivePixel),this.arrowHeight=this.arrowWidth,this.isTop=!1,this.isTitle=!1,this.currentPageNumber=1}return e.prototype.calculateLegendBounds=function(e,t,i){var r=this.legend,n=this.isBulletChartControl?"40%":"20%";this.getPosition(r.position,t),this.legendBounds=new sf.svgbase.Rect(e.x,e.y,0,0),this.isVertical="Left"===this.position||"Right"===this.position,this.itemPadding=this.legend.itemPadding?this.legend.itemPadding:this.isVertical?this.legend.padding:20,this.isVertical?(this.legendBounds.height=xt(r.height,t.height-(e.y-this.chart.margin.top))||e.height,this.legendBounds.width=xt(r.width||n,t.width)):(this.legendBounds.width=xt(r.width,t.width)||e.width,this.legendBounds.height=xt(r.height||n,t.height)),this.library.getLegendBounds(t,this.legendBounds,r),this.isBulletChartControl||(this.legendBounds.width+=this.legend.containerPadding.left+this.legend.containerPadding.right,this.legendBounds.height+=this.legend.containerPadding.top+this.legend.containerPadding.bottom),this.getLocation(this.position,r.alignment,this.legendBounds,e,t,i)},e.prototype.getPosition=function(e,t){var i=this.chart,r=this.chart;this.isChartControl||this.isBulletChartControl||this.isStockChartControl?this.position="Auto"!==e?e:"Bottom":("Auto"===e&&((i||r).visibleSeries&&"Funnel"===(i||r).visibleSeries[0].type||"Pyramid"===(i||r).visibleSeries[0].type)&&(e="Top"),this.position="Auto"!==e?e:t.width>t.height?"Right":"Bottom")},e.prototype.setBounds=function(e,t,i,r){var n=i.title&&"Top"===i.titlePosition?this.legendTitleSize.height+this.fivePixel:0;this.isVertical&&this.isPaging&&!i.enablePages&&!this.isBulletChartControl&&(n=i.title&&"Top"===i.titlePosition?this.legendTitleSize.height+this.fivePixel:0,n+=this.pageButtonSize+this.fivePixel),e=Math.min(e,r.width),t=Math.min(t,r.height),"Gradient"===i.mode?(r.width=i.width?r.width:this.isVertical?e:.75*r.width,r.height=i.height?r.height:this.isVertical?.75*r.height:t):(r.width=i.width?r.width:e,r.height=i.height?r.height:t),this.isBulletChartControl||this.isTop&&"None"!==i.titleStyle.textOverflow&&(this.calculateLegendTitle(i,r),r.height+="Wrap"===i.titleStyle.textOverflow&&this.legendTitleCollections.length>1?this.legendTitleSize.height-this.legendTitleSize.height/this.legendTitleCollections.length:0),this.rowCount=Math.max(1,Math.ceil((r.height-i.padding-n)/(this.maxItemHeight+i.padding)))},e.prototype.getLocation=function(e,t,i,r,n,o){var s=this.legend.border.width,a=this.isBulletChartControl,l=this.bulletChart,h="Inside"===l.labelPosition,d="Inside"===l.tickPosition,c="Vertical"===l.orientation,p=a&&""!==l.categoryField?o.width+this.chart.border.width+3*s:0,u=this.chart.margin.bottom,g=i.height+s+this.legend.margin.top+this.legend.margin.bottom,f=i.width+s+this.legend.margin.left+this.legend.margin.right;"Bottom"===e?(i.x=this.alignLegend(i.x,n.width,i.width,t),i.y=r.y+(r.height-g)+s+this.legend.margin.top,i.y+=!a||l.opposedPosition||h||d||c?c&&""!==l.categoryField?o.height+2*s:0:l.majorTickLines.height+u+this.legend.border.width+2*s,ce(r,new Ht(0,0,0,g))):"Top"===e?(i.x=this.alignLegend(i.x,n.width,i.width,t),i.y=r.y+s+this.legend.margin.top,i.y-=!a||!l.opposedPosition||h||d||c?0:l.majorTickLines.height+this.chart.margin.top,ce(r,new Ht(0,0,g-=a?2*-s:0,0))):"Right"===e?(i.x=r.x+(r.width-i.width)-this.legend.margin.right,i.y=r.y+this.alignLegend(0,n.height-(r.y+u),i.height,t),f+=a&&l.opposedPosition&&!h&&!d&&c?this.chart.margin.left+this.chart.margin.right+l.majorTickLines.height:0,ce(r,new Ht(0,f,0,0))):"Left"===e?(i.x=i.x+this.legend.margin.left,i.y=r.y+this.alignLegend(0,n.height-(r.y+u),i.height,t),f+=!a||l.opposedPosition||h||d||!c?"Vertical"!==l.orientation&&""!==l.categoryField?p:0:i.x-this.chart.margin.left+s+l.majorTickLines.height,ce(r,new Ht(f,0,0,0))):(i.x=this.legend.location.x,i.y=this.legend.location.y,ce(r,new Ht(0,0,0,0)))},e.prototype.alignLegend=function(e,t,i,r){switch(r){case"Far":e=t-i-e;break;case"Center":e=(t-i)/2}return e},e.prototype.renderLegend=function(e,t,i,r){var n,o=0,s=(new sf.svgbase.Rect(0,0,0,0),new sf.svgbase.Rect(0,0,0,0)),a=this.findFirstLegendPosition(this.legendCollections),l=t.padding;this.itemPadding=this.isBulletChartControl?t.padding:this.itemPadding;var h=t.enablePages,d=t.titlePosition,c=this.isPaging&&!t.enablePages&&this.isVertical?this.pageButtonSize:0,p=e.renderer.createGroup({id:this.legendID+"_g"}),u=this.createLegendElements(e,i,p,t,this.legendID,r);this.legendRegions=[],this.chartRowCount=1;var g=0;if(n=this.isTitle&&(this.isTop||this.isVertical)?this.legendTitleSize.height:0,this.isChartControl||this.isAccChartControl&&!this.isVertical){for(var f=1,m=this.rowHeights[0]+l,y=1;y<this.rowHeights.length;y++)m+this.rowHeights[y]+l>this.legendBounds.height-this.pageButtonSize-this.maxItemHeight/2&&(this.pageHeights[f-1]=m+n,f++,m=0),m+=this.rowHeights[y]+(this.isVertical?this.itemPadding:l);this.pageHeights[f-1]=m+n,this.totalPages=f}for(y=0;y<this.legendCollections.length;y++)if(""!==this.legendCollections[y].text){g=Math.max(this.legendCollections[y].textSize.height,g);break}if(this.isChartControl||this.isAccChartControl||(this.maxItemHeight=Math.max(g,t.shapeHeight)),h||!this.isPaging||this.isVertical?!this.isTitle||this.isPaging||this.isVertical||(o=d===(this.isRtlEnable?"Right":"Left")?this.fivePixel+this.legendTitleSize.width:0):(o=this.isTitle&&"Left"===d?this.legendTitleSize.width:0,o+=this.pageButtonSize+2*this.fivePixel),"Gradient"===e.legendSettings.mode&&this.legendCollections.length>1)this.getLinearLegend(i,e,t,u),this.totalPages=1;else if(a!==this.legendCollections.length){var v=void 0,b=0,w=this.legendCollections[a],x=this.isBulletChartControl?0:o+l+t.shapeWidth/2+t.containerPadding.left,M=this.isBulletChartControl?i.x+o+l+t.shapeWidth/2:this.isRtlEnable?i.x+("accumulationchart"===this.chart.getModuleName()&&this.isVertical?this.maxWidth:i.width)-x:i.x+x,N=new jt(M,this.isBulletChartControl?i.y+n+c+l+this.maxItemHeight/2:i.y+n+c+l+this.maxItemHeight/2+t.containerPadding.top),I=e.isRtlEnabled||e.enableRtl?"end":"start",S=new sf.svgbase.TextOption("",N.x,N.y,I),C=t.shapePadding+this.itemPadding+t.shapeWidth;this.totalPages=this.totalPages=this.isAccChartControl||this.isChartControl||this.isBulletChartControl||this.isStockChartControl?this.totalPages:0,this.pageXCollections=[],this.legendCollections[a].location=N;var O=void 0;if(!t.enablePages&&this.isPaging){var T=N.x-this.fivePixel,P=N.y-this.fivePixel,A=this.isTitle&&!this.isVertical&&"Left"===d?this.legendTitleSize.width+this.fivePixel:0,L=this.isVertical?this.pageButtonSize+Math.abs(P-i.y):0,F=this.isTitle&&!this.isVertical&&"Right"===d?this.legendTitleSize.width+this.fivePixel:0;F+=this.isVertical?0:this.fivePixel+this.pageButtonSize+this.fivePixel,s=new sf.svgbase.Rect(T,P,i.width-F-A,i.height-L)}else s=i;var D=void 0;for(y=0;y<this.legendCollections.length;y++)D=this.legendCollections[y],O=this.isReverse?this.legendCollections.length-1-b:b,"accumulationchart"===this.chart.getModuleName()&&(D.fill=(this.chart||this.chart||this.chart).visibleSeries[0].points[D.pointIndex].color),"stockChart"===this.chart.getModuleName()&&(D.type=this.chart.visibleSeries[b].type),this.accessbilityText=this.isBulletChartControl?"Legend of bullet chart"+D.text:"Click to show or hide the "+D.text+" series",D.render&&""!==D.text&&((v=e.renderer.createGroup({id:this.legendID+this.generateId(D,"_g_",O)}))&&(v.setAttribute("tabindex",0===y?"0":""),v.setAttribute("aria-label",t.description||"Show "+D.text)),this.library.getRenderPoint(D,N,C,w,s,b,a),this.renderSymbol(D,v,O),this.renderText(e,D,v,S,b,O),v&&(v.style.cssText="pointer-events: bounding-box; cursor: "+(!t.toggleVisibility&&("None"===e.selectionMode||"None"===e.highlightMode||"None"===e.selectionMode)||this.isBulletChartControl?"auto":"pointer")),u&&u.appendChild(v),w=D),b++;this.isPaging&&this.totalPages>1?this.renderPagingElements(e,i,S,p):this.totalPages=1}nt(e.enableCanvas,e.svgObject,p,r)},e.prototype.getLinearLegend=function(e,t,i,r){var n="http://www.w3.org/2000/svg",o=this.legendCollections[0],s=this.legendCollections[1],a=this.chart.renderer.createDefs(),l=document.createElementNS(n,"linearGradient"),h=[],d=[];i.title&&(this.isVertical?(e.y+=this.legendTitleSize.height,e.height-=this.legendTitleSize.height):"Left"===i.titlePosition?(e.x+=this.legendTitleSize.width,e.width-=this.legendTitleSize.width):"Right"===i.titlePosition?e.width-=this.legendTitleSize.width:"Top"===i.titlePosition&&(e.y+=this.legendTitleSize.height,e.height-=this.legendTitleSize.height));for(var c=0,p=this.chart.rangeColorSettings;c<p.length;c++){var u=p[c];if(d.indexOf(u.start)<0&&d.push(u.start),u.colors.length>2){var g=u.end-u.start,f=u.colors.length-1;if(g>0){g/=f;for(var m=1;m<f;m++){var y=u.start+g*m;d.push(y)}}else for(m=1;m<f;m++)d.push(u.start)}d.indexOf(u.end)<0&&d.push(u.end);for(var v=0,b=u.colors;v<b.length;v++){var w=b[v];h.indexOf(w)<0&&h.push(w)}u.colors.length>0&&u.colors.length<2&&h.push(u.colors[0])}var x=this.isRtlEnable&&!this.isVertical?"100%":"0%",M=this.isVertical||this.isRtlEnable?"0%":"100%",N=this.isVertical?"100%":"0%";l.setAttribute("id",this.generateId(o,"linearGradient",0)),l.setAttribute("x1",x),l.setAttribute("y1","0%"),l.setAttribute("x2",M),l.setAttribute("y2",N);for(var I=d[d.length-1]-d[0],S=0;S<h.length;S++){var C=d[S]-d[0];C/=I;var O=document.createElementNS(n,"stop");O.setAttribute("offset",C.toString()),O.setAttribute("stop-color",h[S]),O.setAttribute("stop-opacity",1..toString()),l.appendChild(O)}var T,P,A,L,F=o.text.toString(),D=s.text.toString(),E=sf.svgbase.measureText(F,i.textStyle),z=sf.svgbase.measureText(D,i.textStyle),k=E.width>z.width?E.width:z.width,W=E.height>z.height?E.height:z.height,R=2*k+4*i.padding,j=e.width,U=e.height,H=e.x+k+2*i.padding,B=e.y+i.padding;if(this.isVertical){if(R=2*W+4*i.padding,j=e.width-2*i.padding,U=e.height-R,H=e.x+i.padding,B=e.y+W+2*i.padding,T=e.y+i.padding+W,P=B+U+W,L=A=e.x+.5*e.width-.5*k,j>30){var _=j-30;j=30,H+=_/2}}else if(j=e.width-R,U=e.height-2*i.padding,A=e.x+(this.isRtlEnable?j+3*i.padding+k:i.padding+(k-E.width)),L=e.x+(this.isRtlEnable?i.padding+(k-z.width):j+3*i.padding+k),P=T=e.y+.5*e.height+.25*W,U>30){var V=U-30;U=30,B+=V/2}var Y=t.enableRtl?"end":"",Q=new sf.svgbase.TextOption("",A,T,Y,F);Q.id=this.legendID+this.generateId(o,"_text_",1);var q=o.visible?i.textStyle.color||t.themeStyle.legendLabel:"#D3D3D3",G=!this.isStockChartControl&&this.chart.enableCanvas;It(t.renderer,Q,i.textStyle,q,r,!1,!1,!1,!1,null,this.currentPageNumber&&G?new sf.svgbase.Rect(0,-this.translatePage(G,null,this.currentPageNumber-1,this.currentPageNumber),0,0):null),(Q=new sf.svgbase.TextOption("",L,P,Y,D)).id=this.legendID+this.generateId(o,"_text_",2),It(t.renderer,Q,i.textStyle,q,r,!1,!1,!1,!1,null,this.currentPageNumber&&G?new sf.svgbase.Rect(0,-this.translatePage(G,null,this.currentPageNumber-1,this.currentPageNumber),0,0):null);var X=t.renderer.drawRectangle({width:j,height:U,x:H,y:B,fill:"url(#"+this.generateId(o,"linearGradient",0)+")"});a.appendChild(l),r.appendChild(a),r.appendChild(X)},e.prototype.findFirstLegendPosition=function(e){for(var t=0,i=0,r=e;i<r.length;i++){var n=r[i];if(n.render&&""!==n.text)break;t++}return t},e.prototype.calculateLegendTitle=function(e,t){if(e.title){this.isTop="Top"===e.titlePosition;var i="Trim"===e.titleStyle.textOverflow?2*e.padding:0;this.isTop||this.isVertical?this.legendTitleCollections=Ot(e.title,e.titleStyle,t.width-i):this.legendTitleCollections[0]=bt(e.maximumTitleWidth,e.title,e.titleStyle);var r=this.isTop?e.title:this.legendTitleCollections[0];this.legendTitleSize=sf.svgbase.measureText(r,e.titleStyle),this.legendTitleSize.height*=this.legendTitleCollections.length}else this.legendTitleSize=new sf.svgbase.Size(0,0)},e.prototype.renderLegendTitle=function(e,t,i,r){var n=t.padding,o=t.titleStyle.textAlignment;this.isTop="Top"===t.titlePosition;var s=Zt(t.titleStyle.textAlignment,e.enableRtl),a=Tt(i,t.titleStyle);s=this.isTop||this.isVertical?s:e.enableRtl?"end":"",a="Near"===o?a+n:"Far"===o?a-n:a,a=this.isTop||this.isVertical?a:i.x+("Left"===t.titlePosition?5:i.width-this.legendTitleSize.width-5);var l=i.height/2+this.legendTitleSize.height/4,h=i.y+(this.isTop||this.isVertical?this.legendTitleSize.height/this.legendTitleCollections.length:l),d=new sf.svgbase.TextOption(this.legendID+"_title",a,h,s,this.legendTitleCollections);It(e.renderer,d,t.titleStyle,t.titleStyle.color,r)},e.prototype.createLegendElements=function(e,t,i,r,n,o){var s=r.padding,a=new zt(n+"_element",r.background,r.border,r.opacity,t),l=e.renderer.createGroup({id:n+"_collections"}),h=!this.isStockChartControl&&e.enableCanvas,d=e.renderer.createClipPath({id:n+"_clipPath"});return a.width=this.isRtlEnable&&"accumulationchart"===this.chart.getModuleName()&&this.isVertical?this.maxWidth:t.width,i?i.appendChild(e.renderer.drawRectangle(a)):e.renderer.drawRectangle(a),r.title&&this.renderLegendTitle(e,r,t,i),h||i.appendChild(l),this.legendTranslateGroup=e.renderer.createGroup({id:n+"_translate_g"}),h||l.appendChild(this.legendTranslateGroup),a.y+=this.isTop?this.legendTitleSize.height:0,a.id+="_clipPath_rect",a.width=this.isChartControl||"bulletChart"===e.getModuleName()||this.isStockChartControl||!this.isVertical?t.width:this.maxWidth-s+r.containerPadding.left+r.containerPadding.right,h?this.pagingClipRect=a:(this.clipRect=e.renderer.drawRectangle(a),d.appendChild(this.clipRect)),nt(h,e.svgObject,d,o),h||(l.style.cssText="clip-path:url(#"+d.id+")"),this.legendTranslateGroup},e.prototype.renderSymbol=function(e,t,i){var r,n,o=this.isBulletChartControl?this.chart:null,s=e.visible?e.fill:"#D3D3D3",a=("chart"===this.chart.getModuleName()||"stockChart"===this.chart.getModuleName())&&"SeriesType"===e.shape&&e.type.toLowerCase().indexOf("line")>-1&&-1===e.type.toLowerCase().indexOf("area"),l=!("chart"!==this.chart.getModuleName()&&"stockChart"!==this.chart.getModuleName()||"Scatter"!==e.type&&"Bubble"!==e.type),h=!this.isStockChartControl&&this.chart.enableCanvas,d="SeriesType"===e.shape?e.type:e.shape,c=a?"Series"===this.legend.mode?this.chart.visibleSeries[i].width:this.chart.visibleSeries[0].width:this.isBulletChartControl&&"Multiply"===e.shape?4:1;if(d="Scatter"===d?e.markerShape:d,l&&i<this.chart.visibleSeries.length){var p=this.chart.visibleSeries[i],u=p.border,g="HorizontalLine"===d||"VerticalLine"===d;r=g?s:u.color?u.color:s,c=g?p.width:u.width?u.width:1}var f=new sf.svgbase.PathOption(this.legendID+this.generateId(e,"_shape_",i),s,c,l?r:s,1,e.dashArray,""),m=sf.svgbase.measureText(e.text,this.legend.textStyle),y=this.legend.isInversed&&!this.isRtlEnable?e.location.x+m.width+this.legend.shapePadding:e.location.x,v=e.location.y;h?(n=-this.translatePage(h,null,this.currentPageNumber-1,this.currentPageNumber),Ve({x:y,y:v},d,new sf.svgbase.Size(this.legend.shapeWidth,this.legend.shapeHeight),"",f,this.accessbilityText,this.chart.renderer,this.currentPageNumber?new sf.svgbase.Rect(0,n,0,0):null,this.isBulletChartControl,o),this.legendRegions.push({rect:new sf.svgbase.Rect(e.location.x,e.location.y,this.legend.shapeWidth,this.legend.shapeHeight+n),index:i})):t.appendChild(Ve({x:y,y:v},d,new sf.svgbase.Size(this.legend.shapeWidth,this.legend.shapeHeight),e.url,f,this.accessbilityText,this.chart.renderer,null,this.isBulletChartControl,o)),("Line"===d&&e.markerVisibility&&"Image"!==e.markerShape||"Doughnut"===e.type&&"Doughnut"===d)&&(f.id=this.legendID+this.generateId(e,"_shape_marker_",i),d="Doughnut"===e.type?"Circle":e.markerShape,f.fill="Doughnut"===e.type?"#FFFFFF":f.fill,h?Ve({x:y,y:v},d,new sf.svgbase.Size(this.legend.shapeWidth/2,this.legend.shapeHeight/2),"",f,this.accessbilityText,this.chart.renderer,this.currentPageNumber?new sf.svgbase.Rect(0,-this.translatePage(h,null,this.currentPageNumber-1,this.currentPageNumber),0,0):null,this.isBulletChartControl,o):t.appendChild(Ve({x:y,y:v},d,new sf.svgbase.Size(this.legend.shapeWidth/2,this.legend.shapeHeight/2),"",f,this.accessbilityText,null,null,this.isBulletChartControl,o)))},e.prototype.renderText=function(e,t,i,r,n,o){var s=e.legendSettings,a=t.visible?s.textStyle.color||e.themeStyle.legendLabel:"#D3D3D3",l=!this.isStockChartControl&&this.chart.enableCanvas;r.id=this.legendID+this.generateId(t,"_text_",o),r.text=t.textCollection.length>0?t.textCollection:t.text,s.isInversed&&!this.isRtlEnable?r.x=t.location.x-s.shapeWidth/2:this.isRtlEnable?r.x=t.location.x-(sf.svgbase.measureText(t.text,s.textStyle).width+s.shapeWidth/2+s.shapePadding):r.x=t.location.x+s.shapeWidth/2+s.shapePadding,r.y=t.location.y+this.maxItemHeight/4;It(e.renderer,r,s.textStyle,a,i,!1,!1,!1,!1,null,this.currentPageNumber&&l?new sf.svgbase.Rect(0,-this.translatePage(l,null,this.currentPageNumber-1,this.currentPageNumber),0,0):null);if(l){var h=sf.svgbase.measureText(t.text,s.textStyle);this.legendRegions[n].rect.y=r.y<this.legendRegions[n].rect.y?r.y:this.legendRegions[n].rect.y,this.legendRegions[n].rect.width+=h.width,this.legendRegions[n].rect.height=h.height,this.legendRegions[n].rect.y-=.5*h.height,this.legendRegions[n].rect.x-=this.isRtlEnable?this.legendRegions[n].rect.width:0}},e.prototype.renderPagingElements=function(e,t,i,r){var n,o=e.renderer.createGroup({id:this.legendID+"_navigation"}),s=!this.isStockChartControl&&e.enableCanvas,a=this.isBulletChartControl?0:this.legendTitleSize.height,l=this.chart.theme.indexOf("Dark")>-1?"#FFFFFF":"#545454",h=e.legendSettings,d=this.legendID+(this.isRtlEnable?"_pagedown":"_pageup"),c=this.legendID+(this.isRtlEnable?"_pageup":"_pagedown"),p=new sf.svgbase.PathOption(d,"transparent",5,l,1,"",""),u=this.pageButtonSize,g=h.enablePages||!this.isPaging||this.isVertical||this.isBulletChartControl?this.rowCount-1:1,f=this.isTitle&&"Left"===h.titlePosition?this.legendTitleSize.width:0;this.pagingRegions=[],this.backwardArrowOpacity=1!==this.currentPage?1:0,this.forwardArrowOpacity=this.currentPage===this.totalPages?0:1,s||r.appendChild(o),this.isChartControl||this.isAccChartControl||(this.isBulletChartControl||this.isStockChartControl||!this.isVertical?this.totalPages=Math.ceil(this.totalPages/Math.max(1,this.rowCount-1)):this.totalPages=Math.ceil(this.totalPages/this.maxColumns)),o&&(o.style.cursor="pointer"),!this.isChartControl&&!this.isAccChartControl||!h.enablePages&&this.isPaging?this.clipPathHeight=g*(this.maxItemHeight+h.padding):this.clipPathHeight=this.pageHeights[0],s?(this.pagingClipRect.height=this.legendBounds.height-this.clipPathHeight-(this.pagingClipRect.y-this.legendBounds.y)-h.border.width,this.pagingClipRect.y=this.pagingClipRect.y+this.clipPathHeight,this.pagingClipRect.x+=h.border.width,this.pagingClipRect.width-=h.border.width+h.border.width/2,this.chart.renderer.clearRect(new sf.svgbase.Rect(this.pagingClipRect.x,this.pagingClipRect.y,this.pagingClipRect.width,this.pagingClipRect.height))):this.clipRect.setAttribute("height",this.clipPathHeight.toString());var m=t.x+u/2,y=t.y+this.clipPathHeight+(a+t.height-this.clipPathHeight)/2;!this.isPaging||h.enablePages||this.isVertical||this.isBulletChartControl||(m=t.x+this.fivePixel+this.pageButtonSize+f,y=h.title&&this.isTop?t.y+8+a+u/1+.5:t.y+8+u+.5);var v=sf.svgbase.measureText(this.totalPages+"/"+this.totalPages,h.textStyle),b=this.isRtlEnable?h.border.width+u/2:t.width-(2*(u+8)+8+v.width);s?Ve({x:m,y:y},"LeftArrow",new sf.svgbase.Size(u,u),"",p,0,this.chart.renderer,new sf.svgbase.Rect(b,0,0,0)):!this.isVertical||h.enablePages||this.isBulletChartControl?(p.opacity=this.isBulletChartControl?p.opacity:h.enablePages?1:this.isRtlEnable?this.forwardArrowOpacity:this.backwardArrowOpacity,o.appendChild(Ve({x:m,y:y},"LeftArrow",new sf.svgbase.Size(u,u),"",p))):(m=t.x+t.width/2,y=t.y+u/2+8+a,p.opacity=this.backwardArrowOpacity,o.appendChild(Ve({x:m,y:y},"UpArrow",new sf.svgbase.Size(u,u),"",p))),this.pagingRegions.push(new sf.svgbase.Rect(this.isRtlEnable?m:m+t.width-(2*(u+8)+8+v.width)-.5*u,y-.5*u,u,u)),i.x=m+u/2+8,i.y=y+v.height/4,i.id=this.legendID+"_pagenumber",i.text=this.isRtlEnable?this.totalPages+"/1":"1/"+this.totalPages;var w=this.chart.theme.indexOf("Dark")>-1?"#FFFFFF":h.textStyle.color;s&&this.totalNoOfPages&&(i.text=this.isRtlEnable?this.totalNoOfPages+"/"+this.currentPageNumber:this.currentPageNumber+"/"+this.totalNoOfPages),(h.enablePages||this.isBulletChartControl)&&(n=It(e.renderer,i,h.textStyle,w,o,!1,!1,!1,!1,null,new sf.svgbase.Rect(b,0,0,0))),m=i.x+8+u/2+v.width,!this.isPaging||h.enablePages||this.isVertical||(m=t.x+t.width-this.fivePixel-this.pageButtonSize-(h.title&&"Right"===h.titlePosition?this.legendTitleSize.width+this.fivePixel:0)),p.id=c,p.opacity=h.enablePages?1:this.isRtlEnable?this.backwardArrowOpacity:this.forwardArrowOpacity,s?Ve({x:m,y:y},"RightArrow",new sf.svgbase.Size(u,u),"",p,0,this.chart.renderer,new sf.svgbase.Rect(b,0,0,0)):!this.isVertical||h.enablePages||this.isBulletChartControl?o.appendChild(Ve({x:m,y:y},"RightArrow",new sf.svgbase.Size(u,u),"",p)):(m=t.x+t.width/2,y=t.y+t.height-u/2-8,o.appendChild(Ve({x:m,y:y},"DownArrow",new sf.svgbase.Size(u,u),"",p))),this.pagingRegions.push(new sf.svgbase.Rect(this.isRtlEnable?m:m+(t.width-(2*(u+8)+8+v.width)-.5*u),y-.5*u,u,u)),s||!h.enablePages&&!this.isBulletChartControl?(1===this.currentPageNumber&&this.calTotalPage&&(h.enablePages||this.isBulletChartControl)&&(this.totalNoOfPages=this.totalPages,this.calTotalPage=!1),h.enablePages||this.isBulletChartControl||this.translatePage(s,null,this.currentPage-1,this.currentPage,h)):o.setAttribute("transform","translate("+b+", 0)"),(h.enablePages||this.isBulletChartControl)&&this.translatePage(s,n,this.currentPage-1,this.currentPage,h)},e.prototype.getPageHeight=function(e,t){for(var i=0,r=0;r<t;r++)i+=e[r];return i},e.prototype.translatePage=function(e,t,i,r,n){var o=this.isChartControl||this.isAccChartControl?i?this.getPageHeight(this.pageHeights,i):0:this.clipPathHeight*i;e||!this.isChartControl&&!this.isAccChartControl||this.clipRect.setAttribute("height",this.pageHeights[i].toString());var s="translate(0,-"+o+")";if(!this.isChartControl&&!this.isBulletChartControl&&!this.isStockChartControl&&this.isVertical){var a=this.pageXCollections[i*this.maxColumns];o=(o=this.isRtlEnable?this.legendBounds.x+this.maxWidth-a:a-this.legendBounds.x)<0?0:o,s=(this.isRtlEnable?"translate(":"translate(-")+o+",0)"}return this.chart.enableCanvas||this.legendTranslateGroup.setAttribute("transform",s),this.chart.enableCanvas||!n.enablePages&&!this.isBulletChartControl||(t.textContent=this.isRtlEnable?this.totalPages+"/"+r:r+"/"+this.totalPages),this.currentPage=r,o},e.prototype.changePage=function(e,t){var i=this.chart.legendSettings,r=document.getElementById(this.legendID+"_pageup"),n=document.getElementById(this.legendID+"_pagedown"),o=!this.isStockChartControl&&this.chart.enableCanvas,s=i.enablePages||this.isBulletChartControl?document.getElementById(this.legendID+"_pagenumber"):null,a=i.enablePages||this.isBulletChartControl?parseInt(s.textContent.split("/")[this.isRtlEnable?1:0],10):this.currentPage;t&&a>1?this.translatePage(o,s,a-2,a-1,i):!t&&a<this.totalPages&&this.translatePage(o,s,a,a+1,i),!this.isPaging||i.enablePages||this.isBulletChartControl||(this.currentPage===this.totalPages?this.hideArrow(n):this.showArrow(n),1===this.currentPage?this.hideArrow(r):this.showArrow(r))},e.prototype.hideArrow=function(e){e.setAttribute("opacity","0")},e.prototype.showArrow=function(e){e.setAttribute("opacity","1")},e.prototype.generateId=function(e,t,i){return this.isChartControl||this.isStockChartControl?t+i:t+e.pointIndex},e.prototype.move=function(e){var t=this,i=this.chart.mouseX,r=this.chart.mouseY;if(e.target.textContent.indexOf("...")>-1){var n=e.target.id.split(this.legendID+"_text_");if(2===n.length){var o=parseInt(n[1],10),s=this.chart.element;isNaN(o)||(this.chart.isTouch&&ie(this.chart.element.id+"_EJ2_Legend_Tooltip"),this.isChartControl?ne(this.chart.series[o].name,i,r,s.offsetWidth,s.id+"_EJ2_Legend_Tooltip",Ge(this.chart.element.id+"_Secondary_Element")):ne(this.chart.visibleSeries[0].points[o].x.toString(),i+10,r+10,s.offsetWidth,s.id+"_EJ2_Legend_Tooltip",Ge(this.chart.element.id+"_Secondary_Element")))}}else ie(this.chart.element.id+"_EJ2_Legend_Tooltip");this.chart.isTouch&&(clearTimeout(this.clearTooltip),this.clearTooltip=+setTimeout((function(){ie(t.chart.element.id+"_EJ2_Legend_Tooltip")}),1e3))},e}(),Nr=function(e,t,i,r,n,o,s,a,l,h,d){this.location={x:0,y:0},this.textCollection=[],this.text=e,this.fill=t,this.shape=i,this.url=o,this.visible=r,this.type=n,this.markerVisibility=a,this.markerShape=s,this.pointIndex=l,this.seriesIndex=h,this.dashArray=d},Ir=(ti=function(e,t){return(ti=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}ti(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),Sr=function(e,t,i,n){var o,s=arguments.length,a=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(s<3?o(a):s>3?o(t,i,a):o(t,i))||a);return s>3&&a&&Object.defineProperty(t,i,a),a},Cr=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.clipRect=new sf.svgbase.Rect(0,0,0,0),t}return Ir(t,e),t.prototype.setDataSource=function(e,t){e&&(this.xData=e.xData,this.yData=e.yData,this.points=e.points);var i=Ae(this.type);this.visible&&t[i+"IndicatorModule"].initDataSource(this,t),t.visibleSeriesCount+=this.targetSeries.length},Sr([sf.base.Property("Sma")],t.prototype,"type",void 0),Sr([sf.base.Property(14)],t.prototype,"period",void 0),Sr([sf.base.Property(14)],t.prototype,"kPeriod",void 0),Sr([sf.base.Property(3)],t.prototype,"dPeriod",void 0),Sr([sf.base.Property(80)],t.prototype,"overBought",void 0),Sr([sf.base.Property(20)],t.prototype,"overSold",void 0),Sr([sf.base.Property(2)],t.prototype,"standardDeviation",void 0),Sr([sf.base.Property("Close")],t.prototype,"field",void 0),Sr([sf.base.Property(12)],t.prototype,"slowPeriod",void 0),Sr([sf.base.Property(26)],t.prototype,"fastPeriod",void 0),Sr([sf.base.Property(!0)],t.prototype,"showZones",void 0),Sr([sf.base.Complex({color:"#ff9933",width:2},h)],t.prototype,"macdLine",void 0),Sr([sf.base.Property("Both")],t.prototype,"macdType",void 0),Sr([sf.base.Property("#2ecd71")],t.prototype,"macdPositiveColor",void 0),Sr([sf.base.Property("#e74c3d")],t.prototype,"macdNegativeColor",void 0),Sr([sf.base.Property("rgba(211,211,211,0.25)")],t.prototype,"bandColor",void 0),Sr([sf.base.Complex({color:"#ffb735",width:1},h)],t.prototype,"upperLine",void 0),Sr([sf.base.Complex({color:"#f2ec2f",width:1},h)],t.prototype,"lowerLine",void 0),Sr([sf.base.Complex({color:"#f2ec2f",width:1},h)],t.prototype,"periodLine",void 0),Sr([sf.base.Property("")],t.prototype,"seriesName",void 0),t}(cr),Or=function(){function e(e){this.control=e}return e.prototype.print=function(e){this.printWindow=window.open("","print","height="+window.outerHeight+",width="+window.outerWidth+",tabbar=no"),this.printWindow.moveTo(0,0),this.printWindow.resizeTo(screen.availWidth,screen.availHeight);var t={cancel:!1,htmlContent:this.getHTMLContent(e),name:"beforePrint"};this.control.trigger("beforePrint",t),t.cancel||sf.base.print(t.htmlContent,this.printWindow)},e.prototype.getHTMLContent=function(e){var t=sf.base.createElement("div");if(e)if(e instanceof Array)for(var i=0;i<e.length;i++){var r=e[i];t.appendChild(Ge(r).cloneNode(!0))}else e instanceof Element?t.appendChild(e.cloneNode(!0)):t.appendChild(Ge(e).cloneNode(!0));else t.appendChild(this.control.element.cloneNode(!0));return t},e.prototype.export=function(e,t,i,r,n,o,s,a,l){var h=this,d=this.getControlsValue(r,s);n=n||d.width,o=o||d.height;var c,p=this.control.svgObject,u=this.control.enableCanvas;u||(p=sf.base.createElement("canvas",{id:"ej2-canvas",attrs:{width:n.toString(),height:o.toString()}}));var g=!(sf.base.Browser.userAgent.toString().indexOf("HeadlessChrome")>-1);i=sf.base.isNullOrUndefined(i)?sf.pdfexport.PdfPageOrientation.Landscape:i;var f='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">'+d.svg.outerHTML+"</svg>",m=window.URL.createObjectURL(new Blob("SVG"===e?[f]:[(new XMLSerializer).serializeToString(d.svg)],{type:"image/svg+xml"}));if("SVG"===e)if("msie"===sf.base.Browser.info.name){var y=new Blob([(new XMLSerializer).serializeToString(d.svg)],{type:"application/octet-stream"});window.navigator.msSaveOrOpenBlob(y,t+"."+e.toLocaleLowerCase())}else this.triggerDownload(t,e,m,g);else if("msie"===sf.base.Browser.info.name){var v=p;u||(v=this.createCanvas()),c=v.toDataURL(),"PDF"===e?this.exportPdf(v,i,n,o,g,t,a,l):this.doexport(e,c,t)}else{var b=new Image,w=p.getContext("2d");b.onload=function(){w.drawImage(b,0,0),window.URL.revokeObjectURL(m),"PDF"===e?h.exportPdf(p,i,n,o,g,t,a,l):window.navigator.msSaveOrOpenBlob?window.navigator.msSaveOrOpenBlob(p.toBlob(null),t+"."+e.toLocaleLowerCase()):h.triggerDownload(t,e,p.toDataURL("image/"+e.toLowerCase()),g)},b.src=m}u||ie(document.getElementById(this.control.element.id+"_canvas"))},e.prototype.getDataUrl=function(e){var t=this.getControlsValue([e]),i=this.control.svgObject,r=this.control.enableCanvas;r||(i=sf.base.createElement("canvas",{id:"ej2-canvas",attrs:{width:t.width.toString(),height:t.height.toString()}}));var n=window.URL.createObjectURL(new Blob([(new XMLSerializer).serializeToString(t.svg)],{type:"image/svg+xml"}));if("msie"===sf.base.Browser.info.name){var o=i;r||(o=this.createCanvas());var s={name:"afterExport",cancel:!1,dataUrl:i.toDataURL("image/png")};return e.trigger("afterExport",s),{element:o,dataUrl:o.toDataURL()}}var a=new Image,l=i.getContext("2d");return a.onload=function(){l.drawImage(a,0,0),window.URL.revokeObjectURL(n);var t={name:"afterExport",cancel:!1,dataUrl:i.toDataURL("image/png")};return e.trigger("afterExport",t),t.dataUrl},a.src=n,{element:i,blobUrl:n}},e.prototype.triggerDownload=function(e,t,i,r){sf.base.createElement("a",{attrs:{download:e+"."+t.toLocaleLowerCase(),href:i}}).dispatchEvent(new MouseEvent(r?"click":"move",{view:window,bubbles:!1,cancelable:!0}))},e.prototype.getControlsValue=function(e,t){var i,r=0,n=0,o=this.control.enableCanvas,s=new sf.svgbase.SvgRenderer("").createSvg({id:"Svg_Export_Element",width:200,height:200});return e.map((function(e){var a=e.svgObject.cloneNode(!0),l=e.renderer.createGroup({style:sf.base.isNullOrUndefined(t)||t?"transform: translateY("+n+"px)":"transform: translateX("+r+"px)"});"transparent"===(i=a.childNodes[0]?a.childNodes[0].getAttribute("fill"):"transparent")&&(i=e.theme.indexOf("Dark")>-1||"HighContrast"===e.theme?"rgba(0, 0, 0, 1)":"rgba(255, 255, 255, 1)"),o||l.appendChild(a);var h=0,d=0;e.stockLegendModule&&e.legendSettings.visible&&("Bottom"===e.legendSettings.position||"Top"===e.legendSettings.position||"Auto"===e.legendSettings.position?h+=e.stockLegendModule.legendBounds.height:"Left"!==e.legendSettings.position&&"Right"!==e.legendSettings.position||(d+=e.stockLegendModule.legendBounds.width)),r=sf.base.isNullOrUndefined(t)||t?Math.max(e.availableSize.width+d,r):r+e.availableSize.width+d,n=sf.base.isNullOrUndefined(t)||t?n+e.availableSize.height+h:Math.max(e.availableSize.height+h,n),o||s.appendChild(l)})),o||(s.setAttribute("width",r+""),s.setAttribute("height",n+""),s.setAttribute("style","background-color: "+i+";")),{width:r,height:n,svg:s}},e.prototype.createCanvas=function(){var e=this.control;this.canvasRender(!0,e);var t=e.svgObject;return this.canvasRender(!1,e),t},e.prototype.canvasRender=function(e,t){t.enableCanvas=e,t.preRender(),t.render()},e.prototype.exportPdf=function(e,t,i,r,n,o,s,a){var l=new sf.pdfexport.PdfDocument,h=l.pageSettings.margins,d=l.pageSettings.width,c=l.pageSettings.height,p=e.toDataURL("image/jpeg").replace("image/jpeg","image/octet-stream");l.pageSettings.orientation=t;var u=d<i?i+h.left+h.right:d,g=c<r?r+h.top+h.bottom:c;if(void 0!==s){var f=new sf.pdfexport.PdfStandardFont(1,s.fontSize||15),m=new sf.pdfexport.PdfPageTemplateElement(u,40);m.graphics.drawString(s.content+"",f,null,new sf.pdfexport.PdfSolidBrush(new sf.pdfexport.PdfColor(0,0,0)),s.x,s.y,null),l.template.top=m}if(void 0!==a){f=new sf.pdfexport.PdfStandardFont(1,a.fontSize||15);var y=new sf.pdfexport.PdfPageTemplateElement(u,40);y.graphics.drawString(a.content+"",f,null,new sf.pdfexport.PdfSolidBrush(new sf.pdfexport.PdfColor(0,0,0)),a.x,a.y,null),l.template.bottom=y}l.pageSettings.size=new sf.pdfexport.SizeF(u,g),p=p.slice(p.indexOf(",")+1),l.pages.add().graphics.drawImage(new sf.pdfexport.PdfBitmap(p),0,0,i,r),n&&(l.save(o+".pdf"),l.destroy())},e.prototype.doexport=function(e,t,i){var r,n=e||"JPG";r=[t],this.exportImage(r,i,n,t)},e.prototype.exportImage=function(e,t,i,r){for(var n=[],o=e instanceof HTMLElement?0:e.length,s=0;s<o;s++){for(var a=e[s].replace(/^data:[a-z]*;,/,"").split(","),l=atob(a[1]),h=new ArrayBuffer(l.length),d=new Uint8Array(h),c=0;c<l.length;c++)d[c]=l.charCodeAt(c);n.push(h)}for(var p=0;p<n.length;p++){var u=new Blob([n[p]],{type:"application/octet-stream"});"msie"===sf.base.Browser.info.name&&window.navigator.msSaveOrOpenBlob(u,t+"."+i.toLocaleLowerCase())}},e}(),Tr=(ii=function(e,t){return(ii=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}ii(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),Pr=function(e,t,i,n){var o,s=arguments.length,a=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(s<3?o(a):s>3?o(t,i,a):o(t,i))||a);return s>3&&a&&Object.defineProperty(t,i,a),a},Ar=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Tr(t,e),Pr([sf.base.Property()],t.prototype,"start",void 0),Pr([sf.base.Property()],t.prototype,"end",void 0),Pr([sf.base.Property([])],t.prototype,"colors",void 0),Pr([sf.base.Property("")],t.prototype,"label",void 0),t}(sf.base.ChildProperty),Lr=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Tr(t,e),Pr([sf.base.Property(!1)],t.prototype,"enable",void 0),Pr([sf.base.Property("")],t.prototype,"dashArray",void 0),Pr([sf.base.Complex({color:null,width:1},c)],t.prototype,"line",void 0),Pr([sf.base.Property("Both")],t.prototype,"lineType",void 0),Pr([sf.base.Property("")],t.prototype,"verticalLineColor",void 0),Pr([sf.base.Property("")],t.prototype,"horizontalLineColor",void 0),Pr([sf.base.Property(1)],t.prototype,"opacity",void 0),t}(sf.base.ChildProperty),Fr=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Tr(t,e),Pr([sf.base.Property(!1)],t.prototype,"enableSelectionZooming",void 0),Pr([sf.base.Property(!1)],t.prototype,"enablePinchZooming",void 0),Pr([sf.base.Property(!1)],t.prototype,"showToolbar",void 0),Pr([sf.base.Property(!1)],t.prototype,"enableMouseWheelZooming",void 0),Pr([sf.base.Property(!0)],t.prototype,"enableDeferredZooming",void 0),Pr([sf.base.Property("XY")],t.prototype,"mode",void 0),Pr([sf.base.Property(["Zoom","ZoomIn","ZoomOut","Pan","Reset"])],t.prototype,"toolbarItems",void 0),Pr([sf.base.Property(!1)],t.prototype,"enablePan",void 0),Pr([sf.base.Property(!1)],t.prototype,"enableScrollbar",void 0),t}(sf.base.ChildProperty),Dr=function(e){function i(t,i){var r=e.call(this,t,i)||this;return r.rotatedDataLabelCollections=[],r.animated=!1,r.isPointMouseDown=!1,r.isScrolling=!1,r.checkResize=0,r.visible=0,r.clickCount=0,r.maxPointCount=0,r.singleClickTimer=0,r.chartAreaType="Cartesian",r.isRtlEnabled=!1,r.scaleX=1,r.scaleY=1,r.chartid=57723,r.isLegendClicked=!1,r.isZoomed=!1,r.previousTargetId="",r.currentPointIndex=0,r.currentSeriesIndex=0,r.currentLegendIndex=0,sf.base.setValue("mergePersistData",r.mergePersistChartData,r),r}return Tr(i,e),i.prototype.mergePersistChartData=function(){var e=window.localStorage.getItem(this.getModuleName()+this.element.id);if(!sf.base.isNullOrUndefined(e)&&""!==e){var t=JSON.parse(e),i=Object.keys(t);this.isProtectedOnChange=!0;for(var n=0,o=i;n<o.length;n++){var s=o[n];"object"!==r(this[s])||sf.base.isNullOrUndefined(this[s])?this[s]=t[s]:sf.base.extend(this[s],t[s])}this.isProtectedOnChange=!1}},i.prototype.isIdHasSpecialCharacter=function(e){var t=/^[A-Za-z ]+$/,i=/^[0-9 ]+$/,r="";if(t.test(e))return e;var n=0;i.test(e[0])&&(r+="\\3"+e[0],n=1);for(var o=n;o<e.length;o++)t.test(e[o])||-1!==e.indexOf("-")||-1!==e.indexOf("_")||-1!==e.indexOf("\\")||i.test(e[o])?r+=e[o]:r+="\\"+e[o];return r},i.prototype.preRender=function(){this.element.id=this.isIdHasSpecialCharacter(this.element.id);this.isBlazor=window.Blazor,this.allowServerDataBinding=!1,this.unWireEvents(),this.initPrivateVariable(),this.setCulture(),this.wireEvents(),this.stockChart&&(null===this.stockChart.tooltip.header&&(this.tooltip.header="<b>${point.x}</b>"),null===this.stockChart.tooltip.format&&(this.tooltip.format="High : <b>${point.high}</b><br/>Low : <b>${point.low}</b><br/>Open : <b>${point.open}</b><br/>Close : <b>${point.close}</b>",""!==this.stockChart.series[0].volume&&(this.tooltip.format+="<br/>Volume : <b>${point.volume}</b>")),this.animateSeries=!1),this.element.setAttribute("dir",this.enableRtl?"rtl":"")},i.prototype.initPrivateVariable=function(){if(this.animateSeries=!0,this.delayRedraw=!1,this.dragY=null,this.horizontalAxes=[],this.verticalAxes=[],this.refreshAxis(),this.refreshDefinition(this.rows),this.refreshDefinition(this.columns),this.tooltipModule&&(this.tooltipModule.previousPoints=[]),this.element.setAttribute("tabindex","0"),this.element.setAttribute("aria-label",this.description||this.title),this.element.setAttribute("class",this.element.getAttribute("class")+" e-chart-focused"),""===this.element.id){var e=document.getElementsByClassName("e-chart").length;this.element.id="chart_"+this.chartid+"_"+e}this.svgId=this.stockChart?this.stockChart.element.id+"_stockChart_chart":this.element.id+(this.enableCanvas?"_canvas":"_svg")},i.prototype.render=function(){var e=this;this.svgRenderer=new sf.svgbase.SvgRenderer(this.element.id);var t={chart:this.isBlazor?{}:this,theme:this.theme,name:"load",cancel:!1};this.stockChart?(this.isRtlEnabled="rtl"===window.getComputedStyle(document.querySelector("body")).direction,this.cartesianChartRendering(t)):this.trigger("load",t,(function(){t.cancel||e.cartesianChartRendering(t)})),this.applyZoomkit()},i.prototype.cartesianChartRendering=function(e){this.theme=this.isBlazor?e.theme:this.theme,this.setTheme(),this.createChartSvg(),this.markerRender=new yr(this),this.calculateAreaType(),this.calculateVisibleSeries(),this.initTechnicalIndicators(),this.initTrendLines(),this.calculateVisibleAxis(),this.processData(),this.renderComplete(),this.allowServerDataBinding=!0},i.prototype.getLocalizedLabel=function(e){return this.localeObject.getConstant(e)},i.prototype.animate=function(e){this.redraw=!0,this.animated=!0,this.duration=e||1e3},i.prototype.refreshBound=function(){if(this.rotatedDataLabelCollections=[],this.legendModule&&this.legendSettings.visible&&this.legendModule.getLegendOptions(this.visibleSeries,this),this.tooltip.enable&&this.tooltipModule&&(this.tooltipModule.previousPoints=[]),this.calculateStackValues(),this.calculateBounds(),this.stockChart&&!this.stockChart.rangeFound&&(this.stockChart.enablePeriodSelector||this.stockChart.enableSelector))return null;this.renderElements(),ie("chartmeasuretext"),this.removeSelection(),this.markerRender&&this.markerRender.mergeXvalues(this.visibleSeries)},i.prototype.calculateStackValues=function(){for(var e,t=!1,i=0,r=this.visibleSeries.length;i<r;i++)(e=this.visibleSeries[i]).position=e.rectCount=void 0,-1===e.type.indexOf("Stacking")&&(-1===e.drawType.indexOf("Stacking")||"PolarRadar"!==this.chartAreaType)||t||(e.calculateStackedValue(e.type.indexOf("100")>-1,this),t=!0)},i.prototype.removeSelection=function(){for(var e=0,t=this.visibleSeries;e<t.length;e++){var i=t[e];if(i.visible)for(var r=0,n=i.points;r<n.length;r++){n[r].isSelect=!1}}Ge(this.element.id+"_ej2_drag_multi_group")?(this.selectionMode.indexOf("Drag")>-1&&(this.selectionModule.filterArray=[]),ie(this.element.id+"_ej2_drag_multi_group"),this.selectionModule.calculateDragSelectedElements(this,new sf.svgbase.Rect(0,0,0,0),!0)):Ge(this.element.id+"_ej2_drag_group")&&("Lasso"!==this.selectionMode&&(this.selectionModule.filterArray=[]),ie(this.element.id+"_ej2_drag_group"),this.selectionModule.calculateDragSelectedElements(this,new sf.svgbase.Rect(0,0,0,0),!0))},i.prototype.renderElements=function(){this.renderBorder(),this.renderTitle(),this.renderAreaBorder(),this.renderSeriesElements(this.renderAxes()),this.renderLegend(),this.applyZoomkit(),this.performSelection(),this.setSecondaryElementPosition();for(var e=0,t=this.visibleSeries;e<t.length;e++){var i=t[e];sf.base.updateBlazorTemplate(this.element.id+"_DataLabel","Template",i.marker.dataLabel)}this.renderAnnotation()},i.prototype.renderAxes=function(){var e;return this.yAxisElements=this.renderer.createGroup({id:this.element.id+"yAxisCollection"}),this.rows.length>0&&this.columns.length>0&&(e=this.chartAxisLayoutPanel.renderAxes()),this.stripLineModule&&this.stripLineModule.renderStripLine(this,"Behind",this.axisCollections),e},i.prototype.renderLegend=function(){if(this.legendModule&&this.legendModule.legendCollections.length&&this.legendSettings.visible){this.legendModule.calTotalPage=!0;var e=this.legendSettings.border.width,t=this.legendModule.legendBounds,i=new sf.svgbase.Rect(t.x,t.y,t.width,t.height);this.enableCanvas&&(i=new sf.svgbase.Rect(i.x-e/2,i.y-e/2,i.width+e,i.height+e),this.renderer.canvasClip(i)),this.legendModule.renderLegend(this,this.legendSettings,t),this.enableCanvas&&this.renderer.canvasRestore()}this.redraw||(this.stockChart?Ge(this.stockChart.chartObject.id)||this.stockChart.mainObject.appendChild(this.svgObject):this.element.appendChild(this.svgObject))},i.prototype.setSecondaryElementPosition=function(){var e=Ge(this.element.id+"_Secondary_Element");if(e){var t=this.element.getBoundingClientRect(),i=Ge(this.svgId).getBoundingClientRect();e.style.left=Math.max(i.left-t.left,0)+"px",e.style.top=Math.max(i.top-t.top,0)+"px"}},i.prototype.initializeModuleElements=function(){this.dataLabelCollections=[];var e=this.element.id;this.series.length&&(this.seriesElements=this.svgRenderer.createGroup({id:e+"SeriesCollection"})),this.indicators.length&&(this.indicatorElements=this.renderer.createGroup({id:e+"IndicatorCollection"})),this.hasTrendlines()&&(this.trendLineElements=this.renderer.createGroup({id:e+"TrendLineCollection"})),this.dataLabelElements=this.renderer.createGroup({id:e+"DataLabelCollection"})},i.prototype.hasTrendlines=function(){for(var e,t=0,i=this.series;t<i.length;t++){if(e=!!i[t].trendlines.length)break}return e},i.prototype.renderSeriesElements=function(e){this.initializeModuleElements();var t=this.element.id;if("g"!==this.element.tagName){var i=Mt(this.redraw,t+"_Secondary_Element")||this.createElement("div");i.id=t+"_Secondary_Element",i.style.cssText="position: relative",nt(!1,this.element,i,this.redraw)}if(this.enableCanvas){var r=document.getElementById(t+"_Secondary_Element");r=r||this.createElement("div",{id:t+"_Secondary_Element",attrs:{style:"position: relative; left:0px; top:0px"}});var n=this.svgRenderer.createSvg({id:t+"_tooltip_svg",width:this.availableSize.width,height:this.availableSize.height});n.style.cssText="position: absolute; pointer-events: none",r.appendChild(n)}this.tooltip.enable&&nt(this.enableCanvas,this.svgObject,this.renderer.createGroup({id:t+"_UserInteraction",style:"pointer-events:none;"}),this.redraw),this.rows.length>0&&this.columns.length>0&&(this.initializeIndicator(),this.initializeTrendLine(),this.renderSeries(),this.trendLineElements&&nt(this.enableCanvas,this.svgObject,this.trendLineElements,this.redraw),this.appendElementsAfterSeries(e))},i.prototype.renderSeries=function(){this.enableCanvas&&this.renderer.canvasClip(this.chartAxisLayoutPanel.seriesClipRect);for(var e=0,t=this.visibleSeries;e<t.length;e++){var i=t[e];("TrendLine"===i.category?this.series[i.sourceIndex].trendlines[i.index].visible:i.visible)&&(this.visible++,Pe(i,this.enableCanvas),this.enableCanvas&&this.renderCanvasSeries(i),i.renderSeries(this))}this.enableCanvas&&this.renderer.canvasRestore(),this.visible=0;var r={id:this.element.id+"_ChartAreaClipRect_",x:this.chartAxisLayoutPanel.seriesClipRect.x,y:this.chartAxisLayoutPanel.seriesClipRect.y,width:this.chartAxisLayoutPanel.seriesClipRect.width,height:this.chartAxisLayoutPanel.seriesClipRect.height,fill:"transparent","stroke-width":1,stroke:"Gray"};if(this.seriesElements){var n;n="PolarRadar"===this.chartAreaType?Re(this.redraw,r,this.renderer,"drawCircularClipPath"):Re(this.redraw,r,this.renderer),this.enableCanvas||this.seriesElements.appendChild(n);var o=document.getElementById(this.element.id+"_series_svg");o?nt(!1,o,this.seriesElements,this.redraw):nt(this.enableCanvas,this.svgObject,this.seriesElements,this.redraw)}},i.prototype.renderCanvasSeries=function(e){var t;t=this.enableCanvas?t:this.svgObject;!this.enableCanvas&&this.enableCanvas},i.prototype.initializeIndicator=function(){for(var e=0,t=this.indicators;e<t.length;e++){var i=t[e];this[Ae(i.type)+"IndicatorModule"]&&this[Ae(i.type)+"IndicatorModule"].createIndicatorElements(this,i,i.index)}this.indicatorElements&&nt(this.enableCanvas,this.svgObject,this.indicatorElements,this.redraw)},i.prototype.initializeTrendLine=function(){for(var e=0,t=this.visibleSeries;e<t.length;e++){var i=t[e];i.trendlines.length&&this.trendLineModule.getTrendLineElements(i,this)}},i.prototype.appendElementsAfterSeries=function(e){"PolarRadar"===this.chartAreaType&&nt(this.enableCanvas,this.svgObject,this.yAxisElements,this.redraw),nt(this.enableCanvas,this.svgObject,e,this.redraw),(this.zoomModule&&this.zoomSettings.enableScrollbar&&this.scrollElement.childElementCount||this.scrollElement&&this.scrollElement.childElementCount)&&nt(!1,Ge(this.element.id+"_Secondary_Element"),this.scrollElement,this.redraw),this.stripLineModule&&this.stripLineModule.renderStripLine(this,"Over",this.axisCollections),this.tooltip.enable||nt(this.enableCanvas,this.svgObject,this.renderer.createGroup({id:this.element.id+"_UserInteraction",style:"pointer-events:none;"}),this.redraw),this.stockChart&&this.stockChart.calculateStockEvents()},i.prototype.applyZoomkit=function(){"PolarRadar"!==this.chartAreaType&&(this.redraw||!this.zoomModule||this.zoomSettings.enablePan&&!this.zoomModule.performedUI||this.zoomModule.applyZoomToolkit(this,this.axisCollections))},i.prototype.renderAnnotation=function(){this.annotationModule&&this.annotationModule.renderAnnotations(Ge((this.stockChart?this.stockChart.element.id:this.element.id)+"_Secondary_Element"))},i.prototype.performSelection=function(){var e=[];this.selectionModule&&(e=sf.base.extend([],this.selectionModule.selectedDataIndexes,null,!0),this.selectionModule.invokeSelection(this)),this.highlightModule&&this.highlightModule.invokeHighlight(this),e.length>0&&(this.selectionModule.selectedDataIndexes=e,this.selectionModule.redrawSelection(this,this.selectionMode))},i.prototype.processData=function(e){void 0===e&&(e=!0),this.visibleSeriesCount=0;for(var t=!0,i=0,r=0,n=this.visibleSeries;r<n.length;r++){(c=n[r]).visible||this.legendSettings.visible?"Indicator"!==c.category&&"TrendLine"!==c.category&&this.initializeDataModule(c):this.visibleSeriesCount++}for(var o=0,s=this.indicators;o<s.length;o++){var a=s[o];if(a.dataSource){var l=a;this.initializeDataModule(l),t=!1}}if(e&&(!this.visibleSeries.length||this.visibleSeriesCount===this.visibleSeries.length&&t)&&(this.refreshBound(),this.trigger("loaded",{chart:this.isBlazor?{}:this})),!this.stockChart&&this.visibleSeries.length>0)for(var h=0,d=this.visibleSeries;h<d.length;h++){var c=d[h];sf.base.isNullOrUndefined(c.points)||(this.maxPointCount=Math.max(i,c.points.length),i=c.points.length)}},i.prototype.initializeDataModule=function(e){var t;e.xData=[],e.yData=[];t=this.isAngular?Object.keys(e.dataSource).length?e.dataSource:this.dataSource:e.dataSource||this.dataSource,e.dataModule=new ur(t,e.query),e.points=[],e.refreshDataManager(this)},i.prototype.calculateBounds=function(){var e=this.margin,t=0,i=0,r=0,n=e.left,o=this.availableSize.width-n-e.right-this.border.width;if(this.titleCollection=[],this.subTitleCollection=[],this.title&&(this.titleCollection=Ot(this.title,this.titleStyle,o),t=sf.svgbase.measureText(this.title,this.titleStyle).height*this.titleCollection.length+15,this.subTitle)){for(var s=0,a=0,l=this.titleCollection;a<l.length;a++){var h=l[a];s=(r=sf.svgbase.measureText(h,this.titleStyle).width)>s?r:s}this.subTitleCollection=Ot(this.subTitle,this.subTitleStyle,s),i=sf.svgbase.measureText(this.subTitle,this.subTitleStyle).height*this.subTitleCollection.length+15}var d=e.top+i+t+.5*this.chartArea.border.width,c=this.availableSize.height-d-this.border.width-e.bottom;this.stockChart&&this.stockChart.legendSettings.visible&&this.stockChart.stockLegendModule&&("Top"===this.stockChart.legendSettings.position?d+=this.stockChart.stockLegendModule.legendBounds.height:"Left"===this.stockChart.legendSettings.position&&(n+=this.stockChart.stockLegendModule.legendBounds.width)),this.initialClipRect=new sf.svgbase.Rect(n,d,o,c),this.legendModule&&this.legendSettings.visible&&this.legendModule.calculateLegendBounds(this.initialClipRect,this.availableSize,null),this.chartAxisLayoutPanel.measureAxis(this.initialClipRect)},i.prototype.print=function(e){new Or(this).print(e)},i.prototype.initTrendLines=function(){this.isProtectedOnChange=!0;for(var e=0,t=this.visibleSeries;e<t.length;e++)for(var i=t[e],r=0,n=0,o=i.trendlines;n<o.length;n++){var s=o[n];this.trendLineModule&&(s.index=r,s.sourceIndex=i.index,this.trendLineModule.initSeriesCollection(s,this),s.targetSeries&&(s.targetSeries.xAxisName=i.xAxisName,s.targetSeries.yAxisName=i.yAxisName,this.visibleSeries.push(s.targetSeries))),r++}this.isProtectedOnChange=!1},i.prototype.calculateAreaType=function(){var e=this.series[0];this.chartArea.border.width=this.stockChart?0:this.chartArea.border.width,e&&(this.requireInvertedAxis=-1!==e.type.indexOf("Bar")&&!this.isTransposed||-1===e.type.indexOf("Bar")&&this.isTransposed&&"PolarRadar"!==this.chartAreaType),this.chartAxisLayoutPanel="PolarRadar"===this.chartAreaType?this.polarSeriesModule||this.radarSeriesModule:new er(this)},i.prototype.calculateVisibleAxis=function(){var e,t=[this.primaryXAxis,this.primaryYAxis];t="Cartesian"===this.chartAreaType?t.concat(this.axes):t,this.paretoSeriesModule&&"Pareto"===this.series[0].type&&(t=t.concat(this.paretoSeriesModule.paretoAxes)),this.axisCollections=[],this.zoomModule&&(this.zoomModule.isPanning=this.zoomModule.isAxisZoomed(t)&&this.zoomSettings.enablePan,this.svgObject.setAttribute("cursor",this.zoomModule.isPanning?"pointer":"auto"),this.scrollBarModule&&(this.scrollBarModule.axes=t)),this.scrollSettingEnabled&&this.scrollBarModule&&(this.scrollBarModule.axes=t);for(var i=0,r=t.length;i<r;i++){(e=t[i]).series=[],e.labels=[],e.indexLabels={};for(var n=0,o=this.visibleSeries;n<o.length;n++){var s=o[n];this.initAxis(s,e,!0)}for(var a=0,l=this.indicators;a<l.length;a++){var h=l[a];this.initAxis(h,e,!1)}this.scrollBarModule&&!e.zoomingScrollBar&&this.scrollBarModule.injectTo(e,this),null!=e.orientation&&this.axisCollections.push(e)}this.rows.length>0&&this.columns.length>0&&this.chartAxisLayoutPanel.measure()},i.prototype.initAxis=function(e,t,i){e.xAxisName===t.name||null==e.xAxisName&&"primaryXAxis"===t.name?(t.orientation=this.requireInvertedAxis?"Vertical":"Horizontal",e.xAxis=t,i&&t.series.push(e)):(e.yAxisName===t.name||null==e.yAxisName&&"primaryYAxis"===t.name)&&(t.orientation=this.requireInvertedAxis?"Horizontal":"Vertical",e.yAxis=t,i&&t.series.push(e))},i.prototype.initTechnicalIndicators=function(){for(var e=0,t=0,i=this.indicators;t<i.length;t++){var r=i[t],n=r,o=Ae(n.type);if(this[o+"IndicatorModule"]){n.index=e,this[o+"IndicatorModule"].initSeriesCollection(n,this);for(var s=0,a=n.targetSeries;s<a.length;s++){var l=a[s];(r.seriesName||r.dataSource)&&this.visibleSeries.push(l)}}e++}},i.prototype.refreshTechnicalIndicator=function(e){if(this.indicators.length){if(e instanceof pr&&"Indicator"!==e.category)for(var t=0,i=this.indicators;t<i.length;t++){var r=i[t];r.seriesName!==e.name||r.dataSource||r.setDataSource(e,this)}else e instanceof Cr&&e.setDataSource(e instanceof pr?e:null,this)}},i.prototype.calculateVisibleSeries=function(){var e;this.visibleSeries=[];for(var t=this.palettes.length?this.palettes:function(e){var t;switch(e){case"Fabric":t=["#4472c4","#ed7d31","#ffc000","#70ad47","#5b9bd5","#c1c1c1","#6f6fe2","#e269ae","#9e480e","#997300"];break;case"Bootstrap4":case"Bootstrap":t=["#a16ee5","#f7ce69","#55a5c2","#7ddf1e","#ff6ea6","#7953ac","#b99b4f","#407c92","#5ea716","#b91c52"];break;case"HighContrastLight":case"Highcontrast":case"HighContrast":t=["#79ECE4","#E98272","#DFE6B6","#C6E773","#BA98FF","#FA83C3","#00C27A","#43ACEF","#D681EF","#D8BC6E"];break;case"MaterialDark":t=["#9ECB08","#56AEFF","#C57AFF","#61EAA9","#EBBB3E","#F45C5C","#8A77FF","#63C7FF","#FF84B0","#F7C928"];break;case"FabricDark":t=["#4472c4","#ed7d31","#ffc000","#70ad47","#5b9bd5","#c1c1c1","#6f6fe2","#e269ae","#9e480e","#997300"];break;case"BootstrapDark":t=["#a16ee5","#f7ce69","#55a5c2","#7ddf1e","#ff6ea6","#7953ac","#b99b4f","#407c92","#5ea716","#b91c52"];break;case"Tailwind":t=["#5A61F6","#65A30D","#334155","#14B8A6","#8B5CF6","#0369A1","#F97316","#9333EA","#F59E0B","#15803D"];break;case"TailwindDark":t=["#8B5CF6","#22D3EE","#F87171","#4ADE80","#E879F9","#FCD34D","#F97316","#2DD4BF","#F472B6","#10B981"];break;case"Bootstrap5":t=["#262E0B","#668E1F","#AF6E10","#862C0B","#1F2D50","#64680B","#311508","#4C4C81","#0C7DA0","#862C0B"];break;case"Bootstrap5Dark":t=["#5ECB9B","#A860F1","#EBA844","#557EF7","#E9599B","#BFC529","#3BC6CF","#7A68EC","#74B706","#EA6266"];break;case"FluentDark":t=["#8AB113","#2A72D5","#43B786","#584EC6","#E85F9C","#6E7A89","#EA6266","#EBA844","#26BC7A","#BC4870"];break;case"Fluent":t=["#614570","#4C6FB1","#CC6952","#3F579A","#4EA09B","#6E7A89","#D4515C","#E6AF5D","#639751","#9D4D69"];break;default:t=["#00bdae","#404041","#357cd2","#e56590","#f8b883","#70ad47","#dd8abd","#7f84e8","#7bb4eb","#ea7a57"]}return t}(this.theme),i=t.length,r=this.series.sort((function(e,t){return e.zOrder-t.zOrder})),n=0,o=r.length;n<o;n++){switch((e=r[n]).category="Pareto"===r[0].type?"Pareto":"Series",e.index=n,e.interior=e.fill||t[n%i],e.visible||(this.isSecondaryAxis(e.xAxis)&&(e.xAxis.internalVisibility=e.xAxis.series.some((function(e){return e.visible}))),this.isSecondaryAxis(e.yAxis)&&(e.yAxis.internalVisibility=e.yAxis.series.some((function(e){return e.visible})))),e.type){case"Bar":case"StackingBar":case"StackingBar100":if(-1===r[0].type.indexOf("Bar"))continue;break;case"Polar":case"Radar":if("PolarRadar"!==this.chartAreaType)continue;if("PolarRadar"===this.chartAreaType&&(null===e.xAxisName&&null!==e.yAxisName||null!==e.xAxisName&&null===e.yAxisName||null!==e.xAxisName&&null!==e.yAxisName))continue;break;case"Pareto":this.visibleSeries.push(e),this.paretoSeriesModule.initSeries(e,this);continue;default:if("PolarRadar"===this.chartAreaType||r[0].type.indexOf("Bar")>-1)continue}this.visibleSeries.push(e),r[n]=e}},i.prototype.isSecondaryAxis=function(e){return this.axes.indexOf(e)>-1},i.prototype.renderTitle=function(){var e,t=this.margin;if(this.title){var i=Zt(this.titleStyle.textAlignment,this.enableRtl),r=sf.svgbase.measureText(this.title,this.titleStyle);e=new sf.svgbase.Rect(t.left,0,this.availableSize.width-t.left-t.right,0);var n=new sf.svgbase.TextOption(this.element.id+"_ChartTitle",Tt(e,this.titleStyle),this.margin.top+3*r.height/4,i,this.titleCollection,"","auto"),o=Mt(this.redraw,this.element.id+"_ChartTitle",n,this.renderer)||It(this.renderer,n,this.titleStyle,this.titleStyle.color||this.themeStyle.chartTitle,this.svgObject,null,null,null,null,null,null,0,null,this.enableCanvas);o&&(o.setAttribute("tabindex","0"),o.setAttribute("class","e-chart-focused")),this.subTitle&&this.renderSubTitle(n)}},i.prototype.renderSubTitle=function(e){for(var t=0,i=0,r=this.titleStyle.textAlignment,n=0,o=this.titleCollection;n<o.length;n++){var s=o[n];t=(i=sf.svgbase.measureText(s,this.titleStyle).width)>t?i:t}var a=sf.svgbase.measureText(this.subTitle,this.subTitleStyle),l=new sf.svgbase.Rect("Center"===r?e.x-.5*t:"Far"===r?e.x-t:e.x,0,t,0),h=new sf.svgbase.TextOption(this.element.id+"_ChartSubTitle",Tt(l,this.subTitleStyle),e.y*e.text.length+3*a.height/4+10,Zt(this.subTitleStyle.textAlignment,this.enableRtl),this.subTitleCollection,"","auto");Mt(this.redraw,this.element.id+"_ChartSubTitle",h,this.renderer)||It(this.renderer,h,this.subTitleStyle,this.subTitleStyle.color||this.themeStyle.chartTitle,this.svgObject,null,null,null,null,null,null,0,null,this.enableCanvas)},i.prototype.renderBorder=function(){var e=0,t=0,i=this.border.width,r=this.backgroundImage,n=r?"transparent":this.background||this.themeStyle.background;this.stockChart&&this.stockChart.legendSettings.visible&&this.stockChart.stockLegendModule&&("Top"===this.stockChart.legendSettings.position?t+=this.stockChart.stockLegendModule.legendBounds.height:"Left"===this.stockChart.legendSettings.position&&(e+=this.stockChart.stockLegendModule.legendBounds.width));var o=new zt(this.element.id+"_ChartBorder",n,this.border,1,new sf.svgbase.Rect(.5*i+e,.5*i+t,this.availableSize.width-i,this.availableSize.height-i));if(this.htmlObject=Mt(this.redraw,this.element.id+"_ChartBorder",o,this.renderer)||this.renderer.drawRectangle(o),this.htmlObject.setAttribute("aria-hidden","true"),nt(this.enableCanvas,this.svgObject,this.htmlObject,this.redraw),r){var s=new kt(this.availableSize.height-i,this.availableSize.width-i,r,0,0,this.element.id+"_ChartBackground","visible","none");this.htmlObject=Mt(this.redraw,this.element.id+"_ChartBackground",s,this.renderer)||this.renderer.drawImage(s),nt(this.enableCanvas,this.svgObject,this.htmlObject,this.redraw)}},i.prototype.renderAreaBorder=function(){if("PolarRadar"===this.chartAreaType)return null;var e=Ge(this.element.id+"_ChartAreaBorder"),t=e?new sf.svgbase.Rect(+e.getAttribute("x"),+e.getAttribute("y"),+e.getAttribute("width"),+e.getAttribute("height")):null,i=new zt(this.element.id+"_ChartAreaBorder",this.chartArea.background,{width:this.chartArea.border.width,color:this.chartArea.border.color||this.themeStyle.areaBorder},this.chartArea.opacity,this.chartAxisLayoutPanel.seriesClipRect);this.htmlObject=this.renderer.drawRectangle(i),this.htmlObject.setAttribute("aria-hidden","true"),nt(this.enableCanvas,this.svgObject,this.htmlObject,this.redraw,!0,"x","y",null,null,!0,!0,t),this.htmlObject=null;var r=this.chartArea.backgroundImage;if(r){var n=this.chartArea.border.width,o=new kt(this.initialClipRect.height-n,this.initialClipRect.width-n,r,this.initialClipRect.x,this.initialClipRect.y,this.element.id+"_ChartAreaBackground","visible","none");this.htmlObject=this.renderer.drawImage(o),nt(this.enableCanvas,this.svgObject,this.htmlObject,this.redraw,!0,"x","y",null,null,!0,!0)}},i.prototype.addSeries=function(e){for(var t=0,i=e;t<i.length;t++){var r=i[t];r=new pr(this,"series",r),this.series.push(r)}this.refresh()},i.prototype.removeSeries=function(e){this.redraw=!1,this.visibleSeries[e]&&(this.visibleSeries[e].xAxis.orientation=null,this.visibleSeries[e].yAxis.orientation=null);for(var t=0;t<this.axes.length;t++)null===this.axes[t].orientation&&this.axes.splice(t,1);this.series.splice(e,1),this.refresh()},i.prototype.clearSeries=function(){this.series=[],this.refresh()},i.prototype.addAxes=function(e){for(var t=0,i=e;t<i.length;t++){var r=i[t];r=new X(this,"axes",r),this.isBlazor&&(r.interval=isNaN(r.interval)?null:r.interval,r.desiredIntervals=isNaN(r.desiredIntervals)?null:r.desiredIntervals),this.axes.push(r)}this.refresh()},i.prototype.removeAxis=function(e){this.redraw=!1,this.axes.splice(e,1),this.refresh()},i.prototype.destroy=function(){this.scrollBarModule&&this.scrollBarModule.destroy(),this.markerRender&&(this.markerRender.removeEventListener(),this.markerRender=null),this.horizontalAxes=[],this.verticalAxes=[],this.visibleSeries=[],this.axisCollections=[],this.rotatedDataLabelCollections=[],this.seriesElements=null,this.chartAxisLayoutPanel=null,this.dataLabelCollections=null,this.dataLabelElements=null,this.yAxisElements=null,this.element&&(this.unWireEvents(),this.isReact&&this.clearTemplate(),e.prototype.destroy.call(this),this.enableCanvas||(this.removeSvg(),this.svgObject=null))},i.prototype.getModuleName=function(){return"chart"},i.prototype.getPersistData=function(){return this.addOnPersist(["loaded","animationComplete","primaryXAxis","primaryYAxis"])},i.prototype.createChartSvg=function(){this.removeSvg(),Ct(this)},i.prototype.unWireEvents=function(){var e=sf.base.Browser.touchStartEvent,t=sf.base.Browser.touchMoveEvent,i=sf.base.Browser.touchEndEvent,r=sf.base.Browser.isPointer?"pointerleave":"mouseleave";/*! UnBind the Event handler */sf.base.EventHandler.remove(this.element,e,this.chartOnMouseDown),sf.base.EventHandler.remove(this.element,t,this.mouseMove),sf.base.EventHandler.remove(this.element,i,this.mouseEnd),sf.base.EventHandler.remove(this.element,"click",this.chartOnMouseClick),sf.base.EventHandler.remove(this.element,"dblclick",this.chartOnDoubleClick),sf.base.EventHandler.remove(this.element,"contextmenu",this.chartRightClick),sf.base.EventHandler.remove(this.element,r,this.mouseLeave),sf.base.EventHandler.remove(this.element,"keydown",this.chartKeyDown),sf.base.EventHandler.remove(document.body,"keydown",this.documentKeyHandler),sf.base.EventHandler.remove(this.element,"keyup",this.chartKeyUp),window.removeEventListener(sf.base.Browser.isTouch&&"orientation"in window&&"onorientationchange"in window?"orientationchange":"resize",this.resizeBound),this.touchObject&&(this.touchObject.destroy(),this.touchObject=null)},i.prototype.wireEvents=function(){if(this.element){/*! Find the Events type */var e=sf.base.Browser.isPointer?"pointerleave":"mouseleave";/*! Bind the Event handler */sf.base.EventHandler.add(this.element,sf.base.Browser.touchStartEvent,this.chartOnMouseDown,this),sf.base.EventHandler.add(this.element,sf.base.Browser.touchMoveEvent,this.mouseMove,this),sf.base.EventHandler.add(this.element,sf.base.Browser.touchEndEvent,this.mouseEnd,this),sf.base.EventHandler.add(this.element,"click",this.chartOnMouseClick,this),sf.base.EventHandler.add(this.element,"dblclick",this.chartOnDoubleClick,this),sf.base.EventHandler.add(this.element,"contextmenu",this.chartRightClick,this),sf.base.EventHandler.add(this.element,e,this.mouseLeave,this),sf.base.EventHandler.add(this.element,"keydown",this.chartKeyDown,this),sf.base.EventHandler.add(document.body,"keydown",this.documentKeyHandler,this),sf.base.EventHandler.add(this.element,"keyup",this.chartKeyUp,this),this.resizeBound=this.chartResize.bind(this),window.addEventListener(sf.base.Browser.isTouch&&"orientation"in window&&"onorientationchange"in window?"orientationchange":"resize",this.resizeBound),this.longPressBound=this.longPress.bind(this),this.touchObject=new sf.base.Touch(this.element,{tapHold:this.longPressBound,tapHoldThreshold:500}),/*! Apply the style for chart */this.setStyle(this.element)}},i.prototype.chartRightClick=function(e){return!this.crosshair.enable||!this.crosshairModule||2!==e.buttons&&0!==e.which&&"touch"!==e.pointerType||(e.preventDefault(),e.stopPropagation(),!1)},i.prototype.setStyle=function(e){var t=this.zoomSettings,i=t.enableSelectionZooming||t.enablePinchZooming||"None"!==this.selectionMode||this.crosshair.enable||"None"!==this.highlightMode;e.style.touchAction=i?"none":"element",e.style.msTouchAction=i?"none":"element",e.style.msContentZooming="none",e.style.msUserSelect="none",e.style.webkitUserSelect="none",e.style.position="relative",e.style.display="block",e.style.overflow="hidden",e.style.height=e.style.height||this.height&&-1===this.height.indexOf("%")?e.style.height:"inherit"},i.prototype.isOrientation=function(){return"orientation"in window&&"onorientationchange"in window},i.prototype.longPress=function(e){return this.mouseX=e&&e.originalEvent.changedTouches?e.originalEvent.changedTouches[0].clientX:0,this.mouseY=e&&e.originalEvent.changedTouches?e.originalEvent.changedTouches[0].clientY:0,this.startMove=!0,this.setMouseXY(this.mouseX,this.mouseY),this.notify("tapHold",e),!1},i.prototype.setMouseXY=function(e,t){if(Ge(this.svgId)){var i=Ge(this.svgId).getBoundingClientRect(),r=this.element.getBoundingClientRect();this.mouseY=t-r.top-Math.max(i.top-r.top,0)/this.scaleX,this.mouseX=e-r.left-Math.max(i.left-r.left,0)/this.scaleY}},i.prototype.export=function(e,t){this.exportModule&&(this.exportModule.export(e,t),this.afterExport&&this.exportModule.getDataUrl(this))},i.prototype.chartResize=function(){var e=this;this.animateSeries=!1;var t={chart:this.isBlazor?{}:this,name:"resized",currentSize:new sf.svgbase.Size(0,0),previousSize:new sf.svgbase.Size(this.availableSize.width,this.availableSize.height)},i={name:"beforeResize",cancelResizedEvent:!1};return this.resizeTo&&clearTimeout(this.resizeTo),this.trigger("beforeResize",i),i.cancelResizedEvent||(this.resizeTo=+setTimeout((function(){e.isDestroyed||e.stockChart?clearTimeout(e.resizeTo):(e.createChartSvg(),t.currentSize=e.availableSize,e.trigger("resized",t),e.refreshAxis(),e.refreshBound(),e.trigger("loaded",{chart:e.isBlazor?{}:e}))}),500)),!1},i.prototype.mouseMove=function(e){var t,i,r;return"touchmove"===e.type?(this.isTouch=!0,t=(r=e).changedTouches[0].clientX,i=r.changedTouches[0].clientY):(this.isTouch="touch"===e.pointerType||"2"===e.pointerType||this.isTouch,t=e.clientX,i=e.clientY),Ge(this.svgId)&&(this.setMouseXY(t,i),this.chartOnMouseMove(e)),!1},i.prototype.mouseLeave=function(e){var t,i,r;return"touchleave"===e.type?(this.isTouch=!0,t=(r=e).changedTouches[0].clientX,i=r.changedTouches[0].clientY):(this.isTouch="touch"===e.pointerType||"2"===e.pointerType,t=e.clientX,i=e.clientY),this.setMouseXY(t,i),this.chartOnMouseLeave(e),!1},i.prototype.chartOnMouseLeave=function(e){var t=e.target,i=sf.base.Browser.isPointer?"pointerleave":"mouseleave";return this.trigger("chartMouseLeave",{target:t.id,x:this.mouseX,y:this.mouseY}),ie(this.element.id+"_EJ2_AxisLabel_Tooltip"),this.isChartDrag=this.isPointMouseDown=!1,this.notify(i,e),!1},i.prototype.chartOnDoubleClick=function(e){var t=e.target;return this.trigger("chartDoubleClick",{target:t.id,x:this.mouseX,y:this.mouseY}),!1},i.prototype.chartKeyDown=function(e){var t="";return(this.isZoomed&&"Tab"===e.code||"Space"===e.code)&&e.preventDefault(),this.tooltip.enable&&("Tab"===e.code&&this.previousTargetId.indexOf("Series")>-1||"Escape"===e.code)&&(t="ESC"),"None"!==this.highlightMode&&"Tab"===e.code&&this.previousTargetId.indexOf("_chart_legend_")>-1&&this.highlightModule&&this.highlightModule.removeLegendHighlightStyles(),!e.ctrlKey||"+"!==e.key&&"Equal"!==e.code&&"-"!==e.key&&"Minus"!==e.code?82===e.keyCode&&this.isZoomed?(e.preventDefault(),this.isZoomed=!1,t="R"):e.code.indexOf("Arrow")>-1&&(e.preventDefault(),t=this.isZoomed?e.code:""):(e.preventDefault(),this.isZoomed=this.zoomModule&&(this.zoomSettings.enableDeferredZooming||this.zoomSettings.enableSelectionZooming||this.zoomSettings.enablePinchZooming||this.zoomSettings.enableMouseWheelZooming),t=this.isZoomed?e.code:""),e.ctrlKey&&"p"===e.key&&(e.preventDefault(),t="CtrlP"),""!==t&&this.chartKeyboardNavigations(e,e.target.id,t),!1},i.prototype.chartKeyUp=function(e){var t,i,r,n,o="",s=e.target.id,a=e.target,l=Ge(this.element.id+"_ChartTitle"),h=Ge(this.element.id+"SeriesCollection"),d=Ge(this.element.id+"_chart_legend_translate_g"),c=Ge(this.element.id+"_chart_legend_pageup");(l&&l.setAttribute("class","e-chart-focused"),h&&h.firstElementChild&&h.firstElementChild.children[1])&&((n=(r=h.firstElementChild.children[1]).getAttribute("class"))&&-1===n.indexOf("e-chart-focused")?n+=" e-chart-focused":n||(n="e-chart-focused"),r.setAttribute("class",n));d&&((n=(r=d.firstElementChild).getAttribute("class"))&&-1===n.indexOf("e-chart-focused")?n+=" e-chart-focused":n||(n="e-chart-focused"),r.setAttribute("class",n));if(c&&c.setAttribute("class","e-chart-focused"),"Tab"===e.code){if(""!==this.previousTargetId)if(this.previousTargetId.indexOf("_Series_")>-1&&-1===s.indexOf("_Series_")){t=Ge(this.element.id+"SeriesCollection");var p=this.previousTargetId.indexOf("_Symbol")>-1?Ge(this.element.id+"SymbolGroup"+this.currentSeriesIndex).children[this.currentPointIndex+1]:this.previousTargetId.indexOf("_Point_")>-1?t.children[this.currentSeriesIndex].children[this.currentPointIndex+1]:t.children[this.currentSeriesIndex];this.setTabIndex(p,t.firstElementChild),this.currentPointIndex=0,this.currentSeriesIndex=0}else this.previousTargetId.indexOf("_chart_legend_page")>-1&&-1===s.indexOf("_chart_legend_page")&&-1===s.indexOf("_chart_legend_g_")?this.setTabIndex(e.target,Ge(this.element.id+"_chart_legend_pageup")):this.previousTargetId.indexOf("_chart_legend_g_")>-1&&-1===s.indexOf("_chart_legend_g_")&&(t=Ge(this.element.id+"_chart_legend_translate_g"),this.setTabIndex(t.children[this.currentLegendIndex],t.firstElementChild));this.previousTargetId=s,s.indexOf("SeriesGroup")>-1&&(this.currentSeriesIndex=+s.split("SeriesGroup")[1],a.removeAttribute("tabindex"),a.blur(),-1===a.children[1].id.indexOf("_Point_")&&(i=Ge(this.element.id+"SymbolGroup"+s.split("SeriesGroup")[1])),s=this.focusChild(null!=i?i.children[1]:a.children[1])),o="None"!==this.highlightMode||this.tooltip.enable?"Tab":""}else if(e.code.indexOf("Arrow")>-1){if(e.preventDefault(),this.previousTargetId=s,s.indexOf("_chart_legend_page")>-1)"ArrowLeft"===e.code?(Ge(this.element.id+"_chart_legend_pagedown").removeAttribute("tabindex"),this.focusChild(Ge(this.element.id+"_chart_legend_pageup"))):"ArrowRight"===e.code&&(Ge(this.element.id+"_chart_legend_pageup").removeAttribute("tabindex"),this.focusChild(Ge(this.element.id+"_chart_legend_pagedown")));else if(s.indexOf("_chart_legend_")>-1){var u=a.parentElement.children;u[this.currentLegendIndex].removeAttribute("tabindex"),this.currentLegendIndex+="ArrowUp"===e.code||"ArrowRight"===e.code?1:-1,this.currentLegendIndex=this.getActualIndex(this.currentLegendIndex,u.length);var g=u[this.currentLegendIndex];this.focusChild(g),s=g.children[1].id,o="None"!==this.highlightMode?"ArrowMove":""}else if(s.indexOf("_Series_")>-1){t=a.parentElement.parentElement;var f=e.target;if(a.removeAttribute("tabindex"),a.blur(),"ArrowRight"===e.code||"ArrowLeft"===e.code){for(var m=[],y=0;y<t.children.length;y++)t.children[y].id.indexOf("SeriesGroup")>-1&&m.push(+t.children[y].id.split("SeriesGroup")[1]);this.currentSeriesIndex=m.indexOf(this.currentSeriesIndex)+("ArrowRight"===e.code?1:-1),this.currentPointIndex=0,this.currentSeriesIndex=m[this.getActualIndex(this.currentSeriesIndex,m.length)],t=Ge(this.element.id+"SeriesGroup"+this.currentSeriesIndex),i=Ge(this.element.id+"SymbolGroup"+this.currentSeriesIndex),f=-1===t.children[1].id.indexOf("_Point_")&&i?i.children[1]:t.children[1]}else this.currentPointIndex+="ArrowUp"===e.code?1:-1,s.indexOf("_Symbol")>-1?(this.currentPointIndex=this.getActualIndex(this.currentPointIndex,Ge(this.element.id+"SymbolGroup"+this.currentSeriesIndex).childElementCount-1),f=Ge(this.element.id+"_Series_"+this.currentSeriesIndex+"_Point_"+this.currentPointIndex+"_Symbol")):s.indexOf("_Point_")>-1&&(this.currentPointIndex=this.getActualIndex(this.currentPointIndex,Ge(this.element.id+"SeriesGroup"+this.currentSeriesIndex).childElementCount-1),f=Ge(this.element.id+"_Series_"+this.currentSeriesIndex+"_Point_"+this.currentPointIndex));s=this.focusChild(f),o=this.tooltip.enable||"None"!==this.highlightMode?"ArrowMove":""}}else"Enter"!==e.code&&"Space"!==e.code||!(s.indexOf("_chart_legend_")>-1||s.indexOf("_Point_")>-1)||(s=s.indexOf("_chart_legend_page")>-1?s:s.indexOf("_chart_legend_")>-1?a.children[1].id:s,o="Enter");return""!==o&&this.chartKeyboardNavigations(e,s,o),!1},i.prototype.setTabIndex=function(e,t){e&&e.removeAttribute("tabindex"),t&&t.setAttribute("tabindex","0")},i.prototype.getActualIndex=function(e,t){return e>t-1?0:e<0?t-1:e},i.prototype.focusChild=function(e){e.setAttribute("tabindex","0");var t=e.getAttribute("class");return e.setAttribute("tabindex","0"),t&&-1===t.indexOf("e-chart-focused")?t="e-chart-focused "+t:t||(t="e-chart-focused"),e.setAttribute("class",t),e.focus(),e.id},i.prototype.documentKeyHandler=function(e){e.altKey&&74===e.keyCode&&!sf.base.isNullOrUndefined(this.element)&&this.element.focus()},i.prototype.chartKeyboardNavigations=function(e,t,i){switch(this.isLegendClicked=!1,i){case"Tab":case"ArrowMove":if(this.highlightModule&&this.highlightModule.removeLegendHighlightStyles(),t.indexOf("_Point_")>-1){var r=+t.split("_Series_")[1].split("_Point_")[0],n=+t.split("_Series_")[1].replace("_Symbol","").split("_Point_")[1],o=this.visibleSeries[r].points[n].symbolLocations[0];this.mouseX=o.x+this.initialClipRect.x,this.mouseY=o.y+this.initialClipRect.y,this.highlightModule&&(this.highlightModule.highlightChart(document.getElementById(t),"mousemove"),this.highlightModule.completeSelection(document.getElementById(t),"mousemove")),this.tooltipModule&&this.tooltipModule.tooltip()}if(this.highlightModule&&"None"!==this.highlightMode){t=t.indexOf("_chart_legend_g_")>-1?document.getElementById(t).firstChild.id:t;for(var s=this.element.id+"_chart_legend",a=[s+"_text_",s+"_shape_marker_",s+"_shape_"],l=0;l<a.length;l++){var h=a[l];if(t.indexOf(h)>-1){document.getElementById(t).setAttribute("class",""),this.highlightModule.legendSelection(this,parseInt(t.split(h)[1],10),document.getElementById(t),"mousemove");break}}}break;case"Enter":case"Space":t.indexOf("_chart_legend_")>-1?(this.isLegendClicked=!0,this.legendModule.click(e),this.focusChild(document.getElementById(t).parentElement)):this.selectionModule.calculateSelectedElements(document.getElementById(t),"click");break;case"CtrlP":this.print();break;case"ESC":this.tooltipModule.removeTooltip(1);break;case"Equal":case"Minus":this.zoomModule.isZoomed=this.zoomModule.performedUI=!0,this.zoomModule.isPanning=this.isChartDrag=!1,"Equal"===i?this.zoomModule.toolkit.zoomInOutCalculation(1,this,this.axisCollections,this.zoomSettings.mode):this.zoomModule.toolkit.zoomInOutCalculation(-1,this,this.axisCollections,this.zoomSettings.mode),this.zoomModule.performZoomRedraw(this),this.element.focus();break;case"ArrowUp":case"ArrowDown":case"ArrowLeft":case"ArrowRight":var d="ArrowUp"===i?10:"ArrowDown"===i?-10:0,c="ArrowLeft"===i?-10:"ArrowRight"===i?10:0;this.zoomModule.isPanning=this.isChartDrag=!0,this.zoomModule.doPan(this,this.axisCollections,c,d),this.zoomModule.performZoomRedraw(this),this.element.focus();break;case"R":this.zoomModule.toolkit.reset(e)}},i.prototype.chartOnMouseClick=function(e){var t=this,i=e.target;this.trigger("chartMouseClick",{target:i.id,x:this.mouseX,y:this.mouseY}),this.clickCount++;var r=0;if(this.isAngular){r=this.pointDoubleClick.observers.length>0?400:0}else r=this.pointDoubleClick?400:0;return 1===this.clickCount&&this.pointClick?this.singleClickTimer=+setTimeout((function(){t.clickCount=0,t.triggerPointEvent("pointClick",e)}),r):2===this.clickCount&&this.pointDoubleClick&&(clearTimeout(this.singleClickTimer),this.clickCount=0,this.triggerPointEvent("pointDoubleClick",e)),this.axisLabelClick&&this.triggerAxisLabelClickEvent("axisLabelClick",e),this.notify("click",e),!1},i.prototype.triggerPointEvent=function(e,t){var i=t,r=new tr(this).getData();r.series&&r.point&&this.trigger(e,{series:this.isBlazor?{}:r.series,point:r.point,seriesIndex:r.series.index,pointIndex:r.point.index,x:this.mouseX,y:this.mouseY,pageX:i.pageX,pageY:i.pageY})},i.prototype.triggerAxisLabelClickEvent=function(e,t){var i=t.target,r=t;if(-1!==i.id.indexOf("_AxisLabel_")){var n=i.id.split("_AxisLabel_"),o=+n[0].slice(-1),s=+n[1],a=this.axisCollections[o];!a.visible||0!==o&&1!==o||this.trigger(e,{chart:this,axis:a,text:a.visibleLabels[s].text,labelID:i.id,index:s,location:new jt(r.pageX,r.pageY),value:a.visibleLabels[s].value})}},i.prototype.chartOnMouseMove=function(e){var t=e.target;return this.trigger("chartMouseMove",{target:t.id,x:this.mouseX,y:this.mouseY}),this.pointMove&&this.triggerPointEvent("pointMove",e),this.isTouch||(this.titleTooltip(e,this.mouseX,this.mouseY),this.axisTooltip(e,this.mouseX,this.mouseY)),this.dataEditingModule&&this.dataEditingModule.pointMouseMove(e),this.notify(sf.base.Browser.touchMoveEvent,e),this.isTouch=!1,!1},i.prototype.titleTooltip=function(e,t,i,r){var n=e.target.id,o=n===this.element.id+"_ChartTitle"||n===this.element.id+"_ChartSubTitle"||n.indexOf("_AxisTitle")>-1||n.indexOf("_legend_title")>-1,s=0;(n.indexOf("_AxisTitle")>-1&&(s=parseInt(n.replace(this.element.id,"").replace("AxisLabel_","").split("_")[2],10)),o&&e.target.textContent.indexOf("...")>-1)?ne(n===this.element.id+"_ChartTitle"?this.title:n.indexOf("_AxisTitle")>-1?this.axisCollections[s].title:n.indexOf("_ChartSubTitle")>-1?this.subTitle:this.legendSettings.title,t,i,this.element.offsetWidth,this.element.id+"_EJ2_Title_Tooltip",Ge(this.element.id+"_Secondary_Element"),r):ie(this.element.id+"_EJ2_Title_Tooltip")},i.prototype.axisTooltip=function(e,t,i,r){var n=e.target.id;if((n.indexOf("AxisLabel")>-1||n.indexOf("Axis_MultiLevelLabel")>-1)&&e.target.textContent.indexOf("...")>-1){var o=this.legendSettings.visible||""===this.primaryXAxis.title;ne(this.findAxisLabel(n),t,i,this.element.offsetWidth,this.element.id+"_EJ2_AxisLabel_Tooltip",Ge(this.element.id+"_Secondary_Element"),r,o)}else ie(this.element.id+"_EJ2_AxisLabel_Tooltip")},i.prototype.findAxisLabel=function(e){var t;return e.indexOf("AxisLabel")>-1?(t=e.replace(this.element.id,"").replace("AxisLabel_","").split("_"),this.axisCollections[parseInt(t[0],10)].visibleLabels[parseInt(t[1],10)].originalText):(t=e.replace(this.element.id,"").replace("Axis_MultiLevelLabel_Level_","").replace("Text_","").split("_"),this.axisCollections[parseInt(t[0],10)].multiLevelLabels[parseInt(t[1],10)].categories[parseInt(t[2],10)].text)},i.prototype.chartOnMouseDown=function(e){var t,i,r,n,o=sf.base.Browser.isDevice?20:30,s=this.element.getBoundingClientRect(),a=e.target;this.trigger("chartMouseDown",{target:a.id,x:this.mouseX,y:this.mouseY}),"touchstart"===e.type?(this.isTouch=!0,t=(n=e).changedTouches[0].clientX,i=n.changedTouches[0].clientY,r=n.target):(this.isTouch="touch"===e.pointerType,t=e.clientX,i=e.clientY,r=e.target);var l=Ge(this.svgId).getBoundingClientRect();return this.mouseDownX=this.previousMouseMoveX=t-s.left-Math.max(l.left-s.left,0),this.mouseDownY=this.previousMouseMoveY=i-s.top-Math.max(l.top-s.top,0),this.isTouch&&(this.isDoubleTap=(new Date).getTime()<this.threshold&&-1===r.id.indexOf(this.element.id+"_Zooming_")&&(this.mouseDownX-o>=this.mouseX||this.mouseDownX+o>=this.mouseX)&&(this.mouseDownY-o>=this.mouseY||this.mouseDownY+o>=this.mouseY)&&(this.mouseX-o>=this.mouseDownX||this.mouseX+o>=this.mouseDownX)&&(this.mouseY-o>=this.mouseDownY||this.mouseY+o>=this.mouseDownY)),this.dataEditingModule&&this.dataEditingModule.pointMouseDown(),this.notify(sf.base.Browser.touchStartEvent,e),!1},i.prototype.mouseEnd=function(e){var t,i,r;return"touchend"===e.type?(i=(r=e).changedTouches[0].clientX,this.isTouch=!0,t=r.changedTouches[0].clientY):(t=e.clientY,i=e.clientX,this.isTouch="touch"===e.pointerType||"2"===e.pointerType),this.setMouseXY(i,t),this.chartOnMouseUp(e),!1},i.prototype.chartOnMouseUp=function(e){var t=e.target;return this.trigger("chartMouseUp",{target:t.id,x:this.mouseX,y:this.mouseY}),this.isChartDrag=!1,this.isTouch&&(this.titleTooltip(e,this.mouseX,this.mouseY,this.isTouch),this.axisTooltip(e,this.mouseX,this.mouseY,this.isTouch),this.threshold=(new Date).getTime()+300),this.dataEditingModule&&this.dataEditingModule.pointMouseUp(),!this.enableCanvas&&this.seriesElements&&this.seriesElements.removeAttribute("clip-path"),this.notify(sf.base.Browser.touchEndEvent,e),!1},i.prototype.setCulture=function(){this.intl=new sf.base.Internationalization,this.setLocaleConstants(),this.localeObject=new sf.base.L10n(this.getModuleName(),this.defaultLocalConstants,this.locale)},i.prototype.setAnnotationValue=function(e,t){var i,r=Ge(this.element.id+"_Annotation_Collections"),n=this.annotations[e];null!==t&&(n.content=t,r?(ie(this.element.id+"_Annotation_"+e),i=this.createElement("div"),this.annotationModule.processAnnotation(n,e,i),r.appendChild(i.children[0])):this.annotationModule.renderAnnotations(Ge(this.element.id+"_Secondary_Element")))},i.prototype.setLocaleConstants=function(){this.defaultLocalConstants={ZoomIn:"Zoom in",Zoom:"Zoom",ZoomOut:"Zoom out",Pan:"Pan",Reset:"Reset",ResetZoom:"Reset Zoom"}},i.prototype.setTheme=function(){/*! Set theme */this.themeStyle=function(e,t){var i,r="MaterialDark"===e?"#383838":"FabricDark"===e?"#242424":"#1b1b1b";switch(e){case"HighContrastLight":case"Highcontrast":case"HighContrast":i={axisLabel:"#ffffff",axisTitle:"#ffffff",axisLine:"#ffffff",majorGridLine:"#BFBFBF",minorGridLine:"#969696",majorTickLine:"#BFBFBF",minorTickLine:"#969696",chartTitle:"#ffffff",legendLabel:"#ffffff",background:t?"#000000":"transparent",areaBorder:"#ffffff",errorBar:"#ffffff",crosshairLine:"#ffffff",crosshairFill:"#ffffff",crosshairLabel:"#000000",tooltipFill:"#ffffff",tooltipBoldLabel:"#000000",tooltipLightLabel:"#000000",tooltipHeaderLine:"#969696",markerShadow:"#BFBFBF",selectionRectFill:"rgba(255, 217, 57, 0.3)",selectionRectStroke:"#ffffff",selectionCircleStroke:"#FFD939",tabColor:"#969696"};break;case"MaterialDark":case"FabricDark":case"BootstrapDark":i={axisLabel:"#DADADA",axisTitle:"#ffffff",axisLine:" #6F6C6C",majorGridLine:"#414040",minorGridLine:"#514F4F",majorTickLine:"#414040",minorTickLine:" #4A4848",chartTitle:"#ffffff",legendLabel:"#DADADA",background:t?r:"transparent",areaBorder:" #9A9A9A",errorBar:"#ffffff",crosshairLine:"#F4F4F4",crosshairFill:"#F4F4F4",crosshairLabel:"#282727",tooltipFill:"#F4F4F4",tooltipBoldLabel:"#282727",tooltipLightLabel:"#333232",tooltipHeaderLine:"#9A9A9A",markerShadow:null,selectionRectFill:"rgba(56,169,255, 0.1)",selectionRectStroke:"#38A9FF",selectionCircleStroke:"#282727",tabColor:"rgb(102, 175, 233)"};break;case"Bootstrap4":i={axisLabel:"#212529",axisTitle:"#212529",axisLine:"#CED4DA",majorGridLine:"#CED4DA",minorGridLine:"#DEE2E6",majorTickLine:"#ADB5BD",minorTickLine:"#CED4DA",chartTitle:"#212529",legendLabel:"#212529",background:t?"#FFFFFF":"transparent",areaBorder:"#DEE2E6",errorBar:"#000000",crosshairLine:"#6C757D",crosshairFill:"#495057",crosshairLabel:"#FFFFFF",tooltipFill:"#020202",tooltipBoldLabel:"rgba(255,255,255)",tooltipLightLabel:"rgba(255,255,255, 0.9)",tooltipHeaderLine:"rgba(255,255,255, 0.2)",markerShadow:null,selectionRectFill:"rgba(255,255,255, 0.1)",selectionRectStroke:"rgba(0, 123, 255)",selectionCircleStroke:"#495057",tabColor:"rgb(102, 175, 233)"};break;case"Tailwind":i={axisLabel:"#6B728",axisTitle:"#374151",axisLine:" #D1D5DB",majorGridLine:"#E5E7EB",minorGridLine:"#E5E7EB",majorTickLine:"#D1D5DB",minorTickLine:" #D1D5DB",chartTitle:"#374151",legendLabel:"#374151",background:t?"rgba(255,255,255, 0.0)":"transparent",areaBorder:" #E5E7EB",errorBar:"#374151",crosshairLine:"#1F2937",crosshairFill:"#111827",crosshairLabel:"#F9FAFB",tooltipFill:"#111827",tooltipBoldLabel:"#D1D5DB",tooltipLightLabel:"#F9FAFB",tooltipHeaderLine:"#6B7280",markerShadow:null,selectionRectFill:"rgba(79,70,229, 0.1)",selectionRectStroke:"#4F46E5",selectionCircleStroke:"#6B7280",tabColor:"rgb(79, 70, 229)"};break;case"TailwindDark":i={axisLabel:"#9CA3AF",axisTitle:"#9CA3AF",axisLine:" #4B5563",majorGridLine:"#374151",minorGridLine:"#374151",majorTickLine:"#4B5563",minorTickLine:" #4B5563",chartTitle:"#D1D5DB",legendLabel:"#D1D5DB",background:t?"#1f2937":"transparent",areaBorder:" #374151",errorBar:"#ffffff",crosshairLine:"#9CA3AF",crosshairFill:"#F9FAFB",crosshairLabel:"#1F2937",tooltipFill:"#F9FAFB",tooltipBoldLabel:"#6B7280",tooltipLightLabel:"#1F2937",tooltipHeaderLine:"#9CA3AF",markerShadow:null,selectionRectFill:"rgba(34,211,238, 0.1)",selectionRectStroke:"#22D3EE",selectionCircleStroke:"#282727",tabColor:"rgb(34, 211, 238)"};break;case"Bootstrap5":i={axisLabel:"#495057",axisTitle:"#343A40",axisLine:"#D1D5DB",majorGridLine:"#E5E7EB",minorGridLine:"#E5E7EB",majorTickLine:"#D1D5DB",minorTickLine:" #D1D5DB",chartTitle:"#343A40",legendLabel:"#343A40",background:t?"#FFFFFF":"transparent",areaBorder:" #DEE2E6",errorBar:"#1F2937",crosshairLine:"#1F2937",crosshairFill:"#212529",crosshairLabel:"#F9FAFB",tooltipFill:"#212529",tooltipBoldLabel:"#F9FAFB",tooltipLightLabel:"#F9FAFB",tooltipHeaderLine:"#9CA3AF",markerShadow:null,selectionRectFill:"rgba(79,70,229, 0.1)",selectionRectStroke:"#4F46E5",selectionCircleStroke:"#6B7280",tabColor:"#0d6efd"};break;case"Bootstrap5Dark":i={axisLabel:"#CED4DA",axisTitle:"#E9ECEF",axisLine:"#495057",majorGridLine:"#343A40",minorGridLine:"#343A40",majorTickLine:"#495057",minorTickLine:" #495057",chartTitle:"#E9ECEF",legendLabel:"#E9ECEF",background:t?"#212529":"transparent",areaBorder:" #444C54",errorBar:"#ADB5BD",crosshairLine:"#ADB5BD",crosshairFill:"#E9ECEF",crosshairLabel:"#212529",tooltipFill:"#E9ECEF",tooltipBoldLabel:"#212529",tooltipLightLabel:"#212529",tooltipHeaderLine:"#ADB5BD",markerShadow:null,selectionRectFill:"rgba(79,70,229, 0.1)",selectionRectStroke:"#4F46E5",selectionCircleStroke:"#6B7280",tabColor:"rgb(13, 110, 253)"};break;case"Fluent":i={axisLabel:"#3B3A39",axisTitle:"#201F1E",axisLine:"#D2D0CE",majorGridLine:"#EDEBE9",minorGridLine:"#EDEBE9",majorTickLine:"#D2D0CE",minorTickLine:" #D2D0CE",chartTitle:"#201F1E",legendLabel:"#323130",background:t?"#FFFFFF":"transparent",areaBorder:"#EDEBE9",errorBar:"#A19F9D",crosshairLine:"#A19F9D",crosshairFill:"#FFFFFF",crosshairLabel:"#323130",tooltipFill:"#FFFFFF",tooltipBoldLabel:"#323130",tooltipLightLabel:"#323130",tooltipHeaderLine:"#D2D0CE",markerShadow:null,selectionRectFill:"rgba(79,70,229, 0.1)",selectionRectStroke:"#4F46E5",selectionCircleStroke:"#6B7280",tabColor:"#0078d4"};break;case"FluentDark":i={axisLabel:"#C8C6C4",axisTitle:"#F3F2F1",axisLine:"#3B3A39",majorGridLine:"#414040",minorGridLine:"#414040",majorTickLine:"#3B3A39",minorTickLine:"#3B3A39",chartTitle:"#F3F2F1",legendLabel:"#D2D0CE",background:t?"#383838":"transparent",areaBorder:"#414040",errorBar:"#D2D0CE",crosshairLine:"#D2D0CE",crosshairFill:"#252423",crosshairLabel:"#F3F2F1",tooltipFill:"#252423",tooltipBoldLabel:"#F3F2F1",tooltipLightLabel:"#F3F2F1",tooltipHeaderLine:"#3B3A39",markerShadow:null,selectionRectFill:"rgba(79,70,229, 0.1)",selectionRectStroke:"#4F46E5",selectionCircleStroke:"#6B7280",tabColor:"#0078d4"};break;default:i={axisLabel:"#686868",axisTitle:"#424242",axisLine:"#b5b5b5",majorGridLine:"#dbdbdb",minorGridLine:"#eaeaea",majorTickLine:"#b5b5b5",minorTickLine:"#d6d6d6",chartTitle:"#424242",legendLabel:"#353535",background:t?"#FFFFFF":"transparent",areaBorder:"Gray",errorBar:"#000000",crosshairLine:"#4f4f4f",crosshairFill:"#4f4f4f",crosshairLabel:"#e5e5e5",tooltipFill:"#000816",tooltipBoldLabel:"#ffffff",tooltipLightLabel:"#dbdbdb",tooltipHeaderLine:"#ffffff",markerShadow:null,selectionRectFill:"rgba(41, 171, 226, 0.1)",selectionRectStroke:"#29abe2",selectionCircleStroke:"#29abe2",tabColor:"rgb(158, 158, 158)"}}return i}(this.theme,this.enableCanvas);var e=document.createElement("style");e.setAttribute("id",this.element.id+"Keyboard_chart_focus"),e.innerHTML=".e-chart-focused:focus, path[class*=_ej2_chart_selection_series]:focus,path[id*=_Point_]:focus, text[id*=_ChartTitle]:focus {outline: none } .e-chart-focused:focus-visible, path[class*=_ej2_chart_selection_series]:focus-visible,path[id*=_Point_]:focus-visible, text[id*=_ChartTitle]:focus-visible {outline: 1.5px "+this.themeStyle.tabColor+" solid}",document.body.appendChild(e)},i.prototype.requiredModules=function(){var e,t,i=this,r=[],n=this.series,o=!1,s=!1,a=!1,l=this.zoomSettings;return this.chartAreaType=n.length>0&&("Polar"===n[0].type||"Radar"===n[0].type)?"PolarRadar":"Cartesian",this.tooltip.enable&&r.push({member:"Tooltip",args:[this]}),n.map((function(e){i.isLegend=i.legendSettings.visible&&(""!==e.name||!!i.isLegend),t=-1!==e.type.indexOf("100")?e.type.replace("100","")+"Series":e.type+"Series",o=e.errorBar.visible||o,a=e.marker.dataLabel.visible||a,s=e.dragSettings.enable||s,r.some((function(e){return e.member===t}))||r.push({member:t,args:[i,n]}),"PolarRadar"===i.chartAreaType&&r.push({member:e.drawType+"Series",args:[i,n]}),"Pareto"===e.type&&(r.push({member:"ColumnSeries",args:[i,n]}),r.push({member:"LineSeries",args:[i,n]}))})),this.findIndicatorModules(r),this.findTrendLineModules(r),r=this.findAxisModule(r),e=this.annotations.some((function(e){return null!==e.content})),o&&r.push({member:"ErrorBar",args:[this,n]}),this.isLegend&&r.push({member:"Legend",args:[this]}),(this.enableExport||this.allowExport)&&r.push({member:"Export",args:[this]}),"PolarRadar"!==this.chartAreaType&&!this.scrollSettingEnabled&&(l.enableSelectionZooming||l.enableMouseWheelZooming||l.enablePinchZooming||l.enablePan||l.enableScrollbar)&&(r.push({member:"Zoom",args:[this,this.zoomSettings]}),l.enableScrollbar&&r.push({member:"ScrollBar",args:[this]})),"None"===this.selectionMode||"PolarRadar"===this.chartAreaType&&this.selectionMode.indexOf("Drag")>-1||r.push({member:"Selection",args:[this]}),("None"!==this.highlightMode||this.legendSettings.enableHighlight)&&r.push({member:"Highlight",args:[this]}),a&&r.push({member:"DataLabel",args:[this,n]}),s&&r.push({member:"DataEditing",args:[this]}),e&&r.push({member:"Annotation",args:[this]}),"PolarRadar"!==this.chartAreaType&&this.crosshair.enable&&r.push({member:"Crosshair",args:[this]}),r},i.prototype.findAxisModule=function(e){var t=[];t.push(this.primaryXAxis),t.push(this.primaryYAxis);for(var i=!1,r=!1,n=!1,o=!1,s=!1,a=!1,l=0,h=t=t.concat(this.axes);l<h.length;l++){var d=h[l];i="DateTime"===d.valueType||i,r="Category"===d.valueType||r,n="Logarithmic"===d.valueType||n,s="DateTimeCategory"===d.valueType||s,o=this.findStriplineVisibility(d.stripLines)||o,a=d.multiLevelLabels.length>0||a,this.scrollSettingEnabled=!!d.scrollbarSettings.enable||this.scrollSettingEnabled}return i&&e.push({member:"DateTime",args:[this]}),r&&e.push({member:"Category",args:[this]}),n&&e.push({member:"Logarithmic",args:[this]}),o&&e.push({member:"StripLine",args:[this]}),a&&e.push({member:"MultiLevelLabel",args:[this]}),s&&e.push({member:"DateTimeCategory",args:[this]}),this.scrollSettingEnabled&&e.push({member:"ScrollBar",args:[this]}),e},i.prototype.findIndicatorModules=function(e){var t,i,r=this.indicators;if(this.indicators.length){e.push({member:"LineSeries",args:[this]}),r.map((function(e){t=t||"Macd"===e.type,i=i||"BollingerBands"===e.type})),t&&e.push({member:"ColumnSeries",args:[this]}),i&&e.push({member:"RangeAreaSeries",args:[this]}),i&&e.push({member:"SplineRangeAreaSeries",args:[this]});for(var n=0,o=this.indicators;n<o.length;n++){var s=o[n];e.push({member:s.type+"Indicator",args:[this]})}}},i.prototype.findTrendLineModules=function(e){for(var t,i,r=function(r){var o;r.trendlines.map((function(e){o=o||e.marker.visible,t=!(!t&&"Linear"!==e.type&&"MovingAverage"!==e.type),i=!(!i&&t)})),o&&e.push({member:"Marker",args:[n,r]})},n=this,o=0,s=this.series;o<s.length;o++){r(s[o])}(t||i)&&e.push({member:"TrendLine",args:[this]}),t&&e.push({member:"LineSeries",args:[this]}),i&&e.push({member:"SplineSeries",args:[this]})},i.prototype.findStriplineVisibility=function(e){for(var t=!1,i=0,r=e;i<r.length;i++){if(r[i].visible){t=!0;break}}return t},i.prototype.removeSvg=function(){if(this.redraw)return null;if(Ft(this),this.enableCanvas&&this.svgObject&&"CANVAS"===this.svgObject.tagName)return this.renderer.clearRect(new sf.svgbase.Rect(0,0,this.availableSize.width,this.availableSize.height)),this.svgObject.parentNode&&sf.base.remove(this.svgObject),null;ie(this.element.id+"_Secondary_Element"),this.isReact&&this.clearTemplate();var e=0;if(this.zoomModule&&this.zoomModule.pinchTarget&&(this.zoomModule.pinchTarget.id="",this.zoomModule.pinchTarget.setAttribute("opacity","0"),this.svgObject.appendChild(this.zoomModule.pinchTarget),e=1),!sf.base.isNullOrUndefined(this.resizeTo)){if(this.resizeTo!==this.checkResize&&this.isBlazor&&this.element.childElementCount)for(var t=document.querySelectorAll(".e-chart"),i=0;i<t.length;i++)for(var r=t[i];r.firstChild;)sf.base.remove(r.firstChild);this.checkResize=this.resizeTo}if(this.svgObject){for(;this.svgObject.childNodes.length>e;)this.svgObject.removeChild(this.svgObject.firstChild);this.svgObject.hasChildNodes()||!this.svgObject.parentNode||this.stockChart||sf.base.remove(this.svgObject)}},i.prototype.refreshDefinition=function(e){for(var t=0,i=e;t<i.length;t++){i[t].axes=[]}},i.prototype.refreshAxis=function(){var e=this.primaryXAxis;e.rect=new sf.svgbase.Rect(void 0,void 0,0,0),(e=this.primaryYAxis).isStack100=!1,e.rect=new sf.svgbase.Rect(void 0,void 0,0,0);for(var t=0,i=this.axes;t<i.length;t++){(e=i[t]).rect=new sf.svgbase.Rect(void 0,void 0,0,0),e.isStack100=!1}if(this.paretoSeriesModule&&"Pareto"===this.series[0].type)for(var r=0,n=this.paretoSeriesModule.paretoAxes;r<n.length;r++){(e=n[r]).rect=new sf.svgbase.Rect(void 0,void 0,0,0),e.isStack100=!1}},i.prototype.axisChange=function(e){return!(!e.name&&!e.valueType)&&(this.refreshDefinition(this.columns),this.refreshDefinition(this.rows),this.calculateVisibleAxis(),this.processData(),!0)},i.prototype.getVisibleSeries=function(e,t){for(var i=0,r=e;i<r.length;i++){var n=r[i];if(t===n.index)return n}return null},i.prototype.refreshLiveData=function(){this.calculateVisibleSeries(),this.initTechnicalIndicators(),this.initTrendLines(),this.refreshDefinition(this.columns),this.refreshDefinition(this.rows),this.calculateVisibleAxis(),this.processData(!1),this.isBlazor||(this.enableCanvas?this.createChartSvg():this.removeSvg(),this.refreshAxis(),this.refreshBound(),this.trigger("loaded",{chart:this.isBlazor?{}:this}))},i.prototype.removeStyles=function(){ie(this.element.id+"_ej2_chart_selection"),ie(this.element.id+"_ej2_chart_highlight")},i.prototype.onPropertyChanged=function(e,t){var i,r=!1,n=!1;if(this.animateSeries=!1,!this.delayRedraw){for(var o=0,s=Object.keys(e);o<s.length;o++){switch(s[o]){case"primaryXAxis":i=e.primaryXAxis,n=this.axisChange(i),e.primaryXAxis.edgeLabelPlacement&&(r=!0),e.primaryXAxis.crosshairTooltip||(n=!0),sf.base.isNullOrUndefined(i.isInversed)&&sf.base.isNullOrUndefined(i.opposedPosition)||this.primaryXAxis.setIsInversedAndOpposedPosition();break;case"primaryYAxis":i=e.primaryYAxis,n=this.axisChange(i),e.primaryYAxis.edgeLabelPlacement&&(r=!0),e.primaryYAxis.crosshairTooltip||(n=!0),sf.base.isNullOrUndefined(i.isInversed)&&sf.base.isNullOrUndefined(i.opposedPosition)||this.primaryYAxis.setIsInversedAndOpposedPosition();break;case"axes":for(var a=0,l=Object.keys(e.axes);a<l.length;a++){var h=l[a];i=e.axes[h],n=n||this.axisChange(i),i.crosshairTooltip||(n=!0),sf.base.isNullOrUndefined(i.isInversed)&&sf.base.isNullOrUndefined(i.opposedPosition)||this.axes[h].setIsInversedAndOpposedPosition()}break;case"height":case"width":this.createChartSvg(),n=!0;break;case"subTitle":case"title":n=!0;break;case"titleStyle":e.titleStyle&&(e.titleStyle.size||e.titleStyle.textOverflow)?n=!0:r=!0;break;case"subTitleStyle":e.subTitleStyle&&(e.subTitleStyle.size||e.subTitleStyle.textOverflow)?n=!0:r=!0;break;case"border":r=!0;break;case"dataSource":this.processData(!1),n=!0;break;case"enableCanvas":this.refresh();break;case"series":for(var d=this.series.length,c=!1,p=void 0,u=void 0,g=0;g<d;g++)p=e.series[g],this.isBlazor&&p&&(p.visible!==t.series[g].visible||p.isClosed||p.marker||p.emptyPointSettings||p.type||p.boxPlotMode||p.showMean)&&(u=!0),p&&(p.dataSource||p.query||p.errorBar||p.xName||p.yName||p.size||p.high||p.low||p.open||p.close||p.fill||p.name||p.marker||u)&&(sf.base.extend(this.getVisibleSeries(this.visibleSeries,g),p,null,!0),c=!0);c&&(this.calculateVisibleSeries(),this.initTechnicalIndicators(),this.initTrendLines(),this.refreshDefinition(this.columns),this.refreshDefinition(this.rows),this.calculateVisibleAxis(),this.processData(!1),n=!0);break;case"indicators":n=!0;break;case"zoomSettings":(e.zoomSettings.enableScrollbar||t.zoomSettings.enableScrollbar)&&(n=!0),r=!0;break;case"background":r=!0;break;case"chartArea":e.chartArea.border&&e.chartArea.border.width&&(n=!0),r=!0;break;case"legendSettings":e.legendSettings.background&&e.legendSettings.opacity||(n=!0),r=!0;break;case"palettes":this.calculateVisibleSeries(),r=!0;break;case"selectedDataIndexes":this.selectionModule&&(this.selectionModule.currentMode=this.selectionMode,this.selectionModule.selectedDataIndexes=this.selectedDataIndexes,this.selectionModule.styleId=this.element.id+"_ej2_chart_selection",this.selectionModule.redrawSelection(this,t.selectionMode,!0));break;case"selectionMode":this.selectionModule&&e.selectionMode&&-1===e.selectionMode.indexOf("Drag")&&(this.selectionModule.currentMode=this.selectionMode,this.selectionModule.styleId=this.element.id+"_ej2_chart_selection",this.selectionModule.redrawSelection(this,t.selectionMode,!0));break;case"isMultiSelect":this.selectionModule&&!e.isMultiSelect&&this.selectionModule.selectedDataIndexes.length>1&&(this.selectionModule.currentMode=this.selectionMode,this.selectionModule.styleId=this.element.id+"_ej2_chart_selection",this.selectionModule.redrawSelection(this,t.selectionMode));break;case"highlightMode":case"selectionPattern":case"highlightPattern":this.removeStyles(),r=!0;break;case"theme":this.animateSeries=!0;break;case"locale":case"currencyCode":this.isBlazor?(this.setCulture(),r=!0):this.refresh();break;case"tooltip":this.tooltipModule&&(this.tooltipModule.previousPoints=[],this.tooltip.template&&(this.tooltipModule.template=this.tooltip.template))}}!n&&r&&(this.rotatedDataLabelCollections=[],this.removeSvg(),this.renderElements(),this.trigger("loaded",{chart:this.isBlazor?{}:this})),n&&(this.enableCanvas?this.createChartSvg():this.removeSvg(),this.isReact&&this.clearTemplate(),this.dragY=null,this.refreshAxis(),this.refreshBound(),this.trigger("loaded",{chart:this.isBlazor?{}:this}),this.redraw=!1,this.animated=!1)}},Pr([sf.base.Property(null)],i.prototype,"width",void 0),Pr([sf.base.Property(null)],i.prototype,"height",void 0),Pr([sf.base.Property("")],i.prototype,"title",void 0),Pr([sf.base.Property("")],i.prototype,"dataSource",void 0),Pr([sf.base.Complex(t.chartTitleFont,d)],i.prototype,"titleStyle",void 0),Pr([sf.base.Property("")],i.prototype,"subTitle",void 0),Pr([sf.base.Complex(t.chartSubTitleFont,d)],i.prototype,"subTitleStyle",void 0),Pr([sf.base.Complex({},g)],i.prototype,"margin",void 0),Pr([sf.base.Complex({color:"#DDDDDD",width:0},c)],i.prototype,"border",void 0),Pr([sf.base.Property(null)],i.prototype,"background",void 0),Pr([sf.base.Complex({border:{color:null,width:.5},background:"transparent"},u)],i.prototype,"chartArea",void 0),Pr([sf.base.Complex({name:"primaryXAxis"},X)],i.prototype,"primaryXAxis",void 0),Pr([sf.base.Complex({name:"primaryYAxis"},X)],i.prototype,"primaryYAxis",void 0),Pr([sf.base.Collection([{}],H)],i.prototype,"rows",void 0),Pr([sf.base.Collection([{}],B)],i.prototype,"columns",void 0),Pr([sf.base.Collection([{}],X)],i.prototype,"axes",void 0),Pr([sf.base.Collection([{}],pr)],i.prototype,"series",void 0),Pr([sf.base.Collection([{}],F)],i.prototype,"annotations",void 0),Pr([sf.base.Property([])],i.prototype,"palettes",void 0),Pr([sf.base.Property("Material")],i.prototype,"theme",void 0),Pr([sf.base.Complex({},M)],i.prototype,"tooltip",void 0),Pr([sf.base.Complex({},Lr)],i.prototype,"crosshair",void 0),Pr([sf.base.Complex({},xr)],i.prototype,"legendSettings",void 0),Pr([sf.base.Collection([{}],Ar)],i.prototype,"rangeColorSettings",void 0),Pr([sf.base.Complex({},Fr)],i.prototype,"zoomSettings",void 0),Pr([sf.base.Property("")],i.prototype,"highlightColor",void 0),Pr([sf.base.Property("None")],i.prototype,"selectionMode",void 0),Pr([sf.base.Property("None")],i.prototype,"highlightMode",void 0),Pr([sf.base.Property("None")],i.prototype,"selectionPattern",void 0),Pr([sf.base.Property("None")],i.prototype,"highlightPattern",void 0),Pr([sf.base.Property(!1)],i.prototype,"isMultiSelect",void 0),Pr([sf.base.Property(!1)],i.prototype,"allowMultiSelection",void 0),Pr([sf.base.Property(!0)],i.prototype,"enableExport",void 0),Pr([sf.base.Property(!1)],i.prototype,"allowExport",void 0),Pr([sf.base.Collection([],y)],i.prototype,"selectedDataIndexes",void 0),Pr([sf.base.Property(!1)],i.prototype,"useGroupingSeparator",void 0),Pr([sf.base.Property(!1)],i.prototype,"enableAutoIntervalOnBothAxis",void 0),Pr([sf.base.Property(!1)],i.prototype,"isTransposed",void 0),Pr([sf.base.Property(!1)],i.prototype,"enableCanvas",void 0),Pr([sf.base.Property(null)],i.prototype,"backgroundImage",void 0),Pr([sf.base.Collection([],Cr)],i.prototype,"indicators",void 0),Pr([sf.base.Property(!0)],i.prototype,"enableAnimation",void 0),Pr([sf.base.Property(null)],i.prototype,"description",void 0),Pr([sf.base.Property(1)],i.prototype,"tabIndex",void 0),Pr([sf.base.Property(!0)],i.prototype,"enableSideBySidePlacement",void 0),Pr([sf.base.Event()],i.prototype,"resized",void 0),Pr([sf.base.Event()],i.prototype,"beforeResize",void 0),Pr([sf.base.Event()],i.prototype,"annotationRender",void 0),Pr([sf.base.Event()],i.prototype,"beforePrint",void 0),Pr([sf.base.Event()],i.prototype,"loaded",void 0),Pr([sf.base.Event()],i.prototype,"beforeExport",void 0),Pr([sf.base.Event()],i.prototype,"afterExport",void 0),Pr([sf.base.Event()],i.prototype,"load",void 0),Pr([sf.base.Event()],i.prototype,"animationComplete",void 0),Pr([sf.base.Event()],i.prototype,"legendRender",void 0),Pr([sf.base.Event()],i.prototype,"textRender",void 0),Pr([sf.base.Event()],i.prototype,"pointRender",void 0),Pr([sf.base.Event()],i.prototype,"seriesRender",void 0),Pr([sf.base.Event()],i.prototype,"axisLabelRender",void 0),Pr([sf.base.Event()],i.prototype,"axisLabelClick",void 0),Pr([sf.base.Event()],i.prototype,"axisRangeCalculated",void 0),Pr([sf.base.Event()],i.prototype,"axisMultiLabelRender",void 0),Pr([sf.base.Event()],i.prototype,"legendClick",void 0),Pr([sf.base.Event()],i.prototype,"multiLevelLabelClick",void 0),Pr([sf.base.Event()],i.prototype,"tooltipRender",void 0),Pr([sf.base.Event()],i.prototype,"sharedTooltipRender",void 0),Pr([sf.base.Event()],i.prototype,"chartMouseMove",void 0),Pr([sf.base.Event()],i.prototype,"chartMouseClick",void 0),Pr([sf.base.Event()],i.prototype,"chartDoubleClick",void 0),Pr([sf.base.Event()],i.prototype,"pointClick",void 0),Pr([sf.base.Event()],i.prototype,"pointDoubleClick",void 0),Pr([sf.base.Event()],i.prototype,"pointMove",void 0),Pr([sf.base.Event()],i.prototype,"chartMouseLeave",void 0),Pr([sf.base.Event()],i.prototype,"chartMouseDown",void 0),Pr([sf.base.Event()],i.prototype,"chartMouseUp",void 0),Pr([sf.base.Event()],i.prototype,"dragComplete",void 0),Pr([sf.base.Event()],i.prototype,"selectionComplete",void 0),Pr([sf.base.Event()],i.prototype,"zoomComplete",void 0),Pr([sf.base.Event()],i.prototype,"onZooming",void 0),Pr([sf.base.Event()],i.prototype,"scrollStart",void 0),Pr([sf.base.Event()],i.prototype,"scrollEnd",void 0),Pr([sf.base.Event()],i.prototype,"scrollChanged",void 0),Pr([sf.base.Event()],i.prototype,"dragStart",void 0),Pr([sf.base.Event()],i.prototype,"drag",void 0),Pr([sf.base.Event()],i.prototype,"dragEnd",void 0),Pr([sf.base.Property("USD")],i.prototype,"currencyCode",void 0),i=Pr([sf.base.NotifyPropertyChanges],i)}(sf.base.Component),Er=(ri=function(e,t){return(ri=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}ri(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),zr=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Er(t,e),t.prototype.calculateDateTimeNiceInterval=function(e,t,i,r,n){void 0===n&&(n=!0);var o,s=new Date(i),a=new Date(r),l=Math.abs((s.getTime()-a.getTime())/864e5);switch(e.actualIntervalType=e.intervalType,e.intervalType){case"Years":o=this.calculateNumericNiceInterval(e,l/365,t);break;case"Quarter":o=this.calculateNumericNiceInterval(e,l/365*4,t);break;case"Months":o=this.calculateNumericNiceInterval(e,l/30,t);break;case"Weeks":o=this.calculateNumericNiceInterval(e,l/7,t);break;case"Days":o=this.calculateNumericNiceInterval(e,l,t);break;case"Hours":o=this.calculateNumericNiceInterval(e,24*l,t);break;case"Minutes":o=this.calculateNumericNiceInterval(e,24*l*60,t);break;case"Seconds":o=this.calculateNumericNiceInterval(e,24*l*60*60,t);break;case"Auto":return(o=this.calculateNumericNiceInterval(e,l/365,t))>=1?(e.actualIntervalType="Years",o):(o=this.calculateNumericNiceInterval(e,l/365*4,t))>=1&&!n?(e.actualIntervalType="Quarter",o):(o=this.calculateNumericNiceInterval(e,l/30,t))>=1?(e.actualIntervalType="Months",o):(o=this.calculateNumericNiceInterval(e,l/7,t))>=1&&!n?(e.actualIntervalType="Weeks",o):(o=this.calculateNumericNiceInterval(e,l,t))>=1?(e.actualIntervalType="Days",o):(o=this.calculateNumericNiceInterval(e,24*l,t))>=1?(e.actualIntervalType="Hours",o):(o=this.calculateNumericNiceInterval(e,24*l*60,t))>=1?(e.actualIntervalType="Minutes",o):(o=this.calculateNumericNiceInterval(e,24*l*60*60,t),e.actualIntervalType="Seconds",o)}return o},t.prototype.getSkeleton=function(e,t,i,r){var n,o=e.actualIntervalType;return e.skeleton?e.skeleton:("Years"===o?n=r?e.isChart?(e.valueType,"y"):"y":e.isChart?"DateTime"===e.valueType&&e.isIntervalInDecimal?"y":"yMMM":"y":"Quarter"===o?n=r?"y":"yMMM":"Months"===o?r?(e.isChart,n="m"):n=e.isChart?"MMMd":"MMM":n="Weeks"===o?r?"m":"MEd":"Days"===o?r?"d":e.isChart?this.getDayFormat(e,t,i):"MMMd":"Hours"===o?r?"t":e.isChart?"DateTime"===e.valueType?"Hm":"EHm":"h":"Minutes"===o?r?"T":e.isChart?"Hms":"hm":r?"T":e.isChart?"Hms":"hms",n)},t.prototype.getMonthFormat=function(e,t,i){return new Date(t).getFullYear()===new Date(i).getFullYear()?e.isIntervalInDecimal?"MMM":"MMM d":"y MMM"},t.prototype.getDayFormat=function(e,t,i){return"DateTime"===e.valueType?new Date(t).getMonth()!==new Date(i).getMonth()?"MMMd":e.isIntervalInDecimal?"d":"Ehm":"yMd"},t.prototype.findCustomFormats=function(e,t,i){var r=e.labelFormat?e.labelFormat:"";return!e.isChart||e.skeleton||"Months"!==e.actualIntervalType||r||(r="DateTime"===e.valueType?this.getMonthFormat(e,t,i):"yMMM"),r},t}(C),kr=(ni=function(e,t){return(ni=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}ni(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),Wr=function(e){function t(t){return e.call(this,t)||this}return kr(t,e),t.prototype.calculateRangeAndInterval=function(e,t){this.calculateRange(t),this.getActualRange(t,e),this.applyRangePadding(t,e),this.calculateVisibleLabels(t,this.chart)},t.prototype.getActualRange=function(e,t){var i={skeleton:"full",type:"dateTime"},r=this.chart.intl.getDateParser(i),n=this.chart.intl.getDateFormat(i);null!==e.minimum?this.min=this.chart.isBlazor?Date.parse(e.minimum.toString()):Date.parse(r(n(new Date(sf.data.DataUtil.parse.parseJson({val:e.minimum}).val)))):null!==this.min&&this.min!==Number.POSITIVE_INFINITY||(this.min=Date.parse(r(n(new Date(1970,1,1))))),null!==e.maximum?this.max=this.chart.isBlazor?Date.parse(e.maximum.toString()):Date.parse(r(n(new Date(sf.data.DataUtil.parse.parseJson({val:e.maximum}).val)))):null!==this.max&&this.max!==Number.NEGATIVE_INFINITY||(this.max=Date.parse(r(n(new Date(1970,5,1))))),this.min===this.max&&(this.max=this.max+2592e6,this.min=this.min-2592e6),e.actualRange={},e.doubleRange=new S(this.min,this.max);var o=this.calculateDateTimeNiceInterval(e,t,e.doubleRange.start,e.doubleRange.end);e.interval?e.actualRange.interval=e.interval:e.actualRange.interval=o,e.actualRange.min=e.doubleRange.start,e.actualRange.max=e.doubleRange.end},t.prototype.applyRangePadding=function(e,t){var i,r;this.min=e.actualRange.min,this.max=e.actualRange.max;var n=e.actualRange.interval;if(!Ue(e)){var o=e.getRangePadding(this.chart);i=new Date(this.min),r=new Date(this.max);var s=e.actualIntervalType;if("None"===o)this.min=i.getTime(),this.max=r.getTime();else if("Additional"===o||"Round"===o)switch(s){case"Years":this.getYear(i,r,o,n);break;case"Months":this.getMonth(i,r,o,n);break;case"Days":this.getDay(i,r,o,n);break;case"Hours":this.getHour(i,r,o,n);break;case"Minutes":var a=i.getMinutes()/n*n,l=r.getMinutes()+(i.getMinutes()-a);"Round"===o?(this.min=new Date(i.getFullYear(),i.getMonth(),i.getDate(),i.getHours(),a,0).getTime(),this.max=new Date(r.getFullYear(),r.getMonth(),r.getDate(),r.getHours(),l,59).getTime()):(this.min=new Date(i.getFullYear(),i.getMonth(),i.getDate(),i.getHours(),a+-n,0).getTime(),this.max=new Date(r.getFullYear(),r.getMonth(),r.getDate(),r.getHours(),l+n,0).getTime());break;case"Seconds":var h=i.getSeconds()/n*n,d=r.getSeconds()+(i.getSeconds()-h);"Round"===o?(this.min=new Date(i.getFullYear(),i.getMonth(),i.getDate(),i.getHours(),i.getMinutes(),h,0).getTime(),this.max=new Date(r.getFullYear(),r.getMonth(),r.getDate(),r.getHours(),r.getMinutes(),d,0).getTime()):(this.min=new Date(i.getFullYear(),i.getMonth(),i.getDate(),i.getHours(),i.getMinutes(),h+-n,0).getTime(),this.max=new Date(r.getFullYear(),r.getMonth(),r.getDate(),r.getHours(),r.getMinutes(),d+n,0).getTime())}}e.actualRange.min=(e.minimum,this.min),e.actualRange.max=(e.maximum,this.max),e.actualRange.delta=e.actualRange.max-e.actualRange.min,e.doubleRange=new S(e.actualRange.min,e.actualRange.max),this.calculateVisibleRange(t,e)},t.prototype.getYear=function(e,t,i,r){var n=e.getFullYear(),o=t.getFullYear();"Additional"===i?(this.min=new Date(n-r,1,1,0,0,0).getTime(),this.max=new Date(o+r,1,1,0,0,0).getTime()):(this.min=new Date(n,0,0,0,0,0).getTime(),this.max=new Date(o,11,30,23,59,59).getTime())},t.prototype.getMonth=function(e,t,i,r){var n=e.getMonth(),o=t.getMonth();"Round"===i?(this.min=new Date(e.getFullYear(),n,0,0,0,0).getTime(),this.max=new Date(t.getFullYear(),o,new Date(t.getFullYear(),t.getMonth(),0).getDate(),23,59,59).getTime()):(this.min=new Date(e.getFullYear(),n+-r,1,0,0,0).getTime(),this.max=new Date(t.getFullYear(),o+r,2===o?28:30,0,0,0).getTime())},t.prototype.getDay=function(e,t,i,r){var n=e.getDate(),o=t.getDate();"Round"===i?(this.min=new Date(e.getFullYear(),e.getMonth(),n,0,0,0).getTime(),this.max=new Date(t.getFullYear(),t.getMonth(),o,23,59,59).getTime()):(this.min=new Date(e.getFullYear(),e.getMonth(),n+-r,0,0,0).getTime(),this.max=new Date(t.getFullYear(),t.getMonth(),o+r,0,0,0).getTime())},t.prototype.getHour=function(e,t,i,r){var n=e.getHours()/r*r,o=t.getHours()+(e.getHours()-n);"Round"===i?(this.min=new Date(e.getFullYear(),e.getMonth(),e.getDate(),n,0,0).getTime(),this.max=new Date(t.getFullYear(),t.getMonth(),t.getDate(),o,59,59).getTime()):(this.min=new Date(e.getFullYear(),e.getMonth(),e.getDate(),n+-r,0,0).getTime(),this.max=new Date(t.getFullYear(),t.getMonth(),t.getDate(),o+r,0,0).getTime())},t.prototype.calculateVisibleRange=function(e,t){t.visibleRange={min:t.actualRange.min,max:t.actualRange.max,interval:t.actualRange.interval,delta:t.actualRange.delta};var i=!sf.base.isNullOrUndefined(t.zoomingScrollBar)&&t.zoomingScrollBar.isLazyLoad;He(t)&&!i&&(t.calculateVisibleRangeOnZooming(e),t.visibleRange.interval=t.enableAutoIntervalOnZooming?this.calculateDateTimeNiceInterval(t,e,t.visibleRange.min,t.visibleRange.max):t.visibleRange.interval),t.dateTimeInterval=this.increaseDateTimeInterval(t,t.visibleRange.min,t.visibleRange.interval).getTime()-t.visibleRange.min,t.triggerRangeRender(this.chart,t.visibleRange.min,t.visibleRange.max,t.visibleRange.interval)},t.prototype.calculateVisibleLabels=function(e,t){e.visibleLabels=[];var i,r,n=e.visibleRange.min,o="chart"===t.getModuleName()&&t.isBlazor,s=e.visibleLabels;for(Ue(e)||(n=this.alignRangeStart(e,n,e.visibleRange.interval).getTime());n<=e.visibleRange.max;)i=sf.base.extend({},sf.base.getValue("properties",e.labelStyle),null,!0),r=s.length?e.visibleLabels[s.length-1].value:n,e.format=t.intl.getDateFormat({format:this.findCustomFormats(e,n,r)||this.blazorCustomFormat(e),type:Ae(e.skeletonType),skeleton:this.getSkeleton(e,n,r,o)}),e.startLabel=e.format(new Date(e.visibleRange.min)),e.endLabel=e.format(new Date(e.visibleRange.max)),se(n,e.visibleRange)&&je(t,n,e.format(new Date(n)),i,e),n=this.increaseDateTimeInterval(e,n,e.visibleRange.interval).getTime();"Months"!==e.actualIntervalType&&"Days"!==e.actualIntervalType||!e.isChart||(e.format=t.intl.getDateFormat({format:e.labelFormat||("Months"!==e.actualIntervalType||e.skeleton?"":"y MMM"),type:Ae(e.skeletonType),skeleton:e.skeleton||("Days"===e.actualIntervalType?"MMMd":"")})),e.getMaxLabelWidth&&e.getMaxLabelWidth(this.chart)},t.prototype.blazorCustomFormat=function(e){return this.chart.isBlazor?"Years"===e.actualIntervalType?e.isIntervalInDecimal?"yyyy":"MMM y":"Days"!==e.actualIntervalType||e.isIntervalInDecimal?"":"ddd HH tt":""},t.prototype.increaseDateTimeInterval=function(e,t,i){var r=new Date(t);e.interval?(e.isIntervalInDecimal=i%1==0,e.visibleRange.interval=i):(i=Math.ceil(i),e.visibleRange.interval=i);var n=e.actualIntervalType;if(e.isIntervalInDecimal)switch(n){case"Years":return r.setFullYear(r.getFullYear()+i),r;case"Quarter":return r.setMonth(r.getMonth()+3*i),r;case"Months":return r.setMonth(r.getMonth()+i),r;case"Weeks":return r.setDate(r.getDate()+7*i),r;case"Days":return r.setDate(r.getDate()+i),r;case"Hours":return r.setHours(r.getHours()+i),r;case"Minutes":return r.setMinutes(r.getMinutes()+i),r;case"Seconds":return r.setSeconds(r.getSeconds()+i),r}else r=this.getDecimalInterval(r,i,n);return r},t.prototype.alignRangeStart=function(e,t,i){var r=new Date(t);switch(e.actualIntervalType){case"Years":var n=Math.floor(Math.floor(r.getFullYear()/i)*i);return r=new Date(n,r.getMonth(),r.getDate(),0,0,0);case"Months":var o=Math.floor(Math.floor(r.getMonth()/i)*i);return r=new Date(r.getFullYear(),o,r.getDate(),0,0,0);case"Days":var s=Math.floor(Math.floor(r.getDate()/i)*i);return r=new Date(r.getFullYear(),r.getMonth(),s,0,0,0);case"Hours":var a=Math.floor(Math.floor(r.getHours()/i)*i);return r=new Date(r.getFullYear(),r.getMonth(),r.getDate(),a,0,0);case"Minutes":var l=Math.floor(Math.floor(r.getMinutes()/i)*i);return r=new Date(r.getFullYear(),r.getMonth(),r.getDate(),r.getHours(),l,0,0);case"Seconds":var h=Math.floor(Math.floor(r.getSeconds()/i)*i);return r=new Date(r.getFullYear(),r.getMonth(),r.getDate(),r.getHours(),r.getMinutes(),h,0)}return r},t.prototype.getDecimalInterval=function(e,t,i){var r=Math.floor(t),n=t-r;switch(i){case"Years":var o=Math.round(12*n);return e.setFullYear(e.getFullYear()+r),e.setMonth(e.getMonth()+o),e;case"Quarter":return e.setMonth(e.getMonth()+3*t),e;case"Months":var s=Math.round(30*n);return e.setMonth(e.getMonth()+r),e.setDate(e.getDate()+s),e;case"Weeks":return e.setDate(e.getDate()+7*t),e;case"Days":var a=Math.round(24*n);return e.setDate(e.getDate()+r),e.setHours(e.getHours()+a),e;case"Hours":var l=Math.round(60*n);return e.setHours(e.getHours()+r),e.setMinutes(e.getMinutes()+l),e;case"Minutes":var h=Math.round(60*n);return e.setMinutes(e.getMinutes()+r),e.setSeconds(e.getSeconds()+h),e;case"Seconds":var d=Math.round(1e3*n);return e.setSeconds(e.getSeconds()+r),e.setMilliseconds(e.getMilliseconds()+d),e}return e},t.prototype.getModuleName=function(){return"DateTime"},t.prototype.destroy=function(){},t}(zr),Rr=(oi=function(e,t){return(oi=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}oi(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),jr=function(e){function t(t){return e.call(this,t)||this}return Rr(t,e),t.prototype.calculateRangeAndInterval=function(e,t){this.calculateRange(t),this.getActualRange(t,e),this.applyRangePadding(t,e),this.calculateVisibleLabels(t)},t.prototype.getActualRange=function(e,t){this.initializeDoubleRange(e),e.actualRange={},e.interval?e.actualRange.interval=Math.ceil(e.interval):e.actualRange.interval=Math.max(1,Math.floor(e.doubleRange.delta/Be(t,e))),e.actualRange.min=e.doubleRange.start,e.actualRange.max=e.doubleRange.end,e.actualRange.delta=e.doubleRange.delta},t.prototype.applyRangePadding=function(e,t){var i="BetweenTicks"===e.labelPlacement&&"PolarRadar"!==this.chart.chartAreaType?.5:0;i>0?(e.actualRange.min-=i,e.actualRange.max+=i):e.actualRange.max+=e.actualRange.max?0:.5,e.doubleRange=new S(e.actualRange.min,e.actualRange.max),e.actualRange.delta=e.doubleRange.delta,this.calculateVisibleRange(t,e)},t.prototype.calculateVisibleLabels=function(e){/*! Generate axis labels */e.visibleLabels=[],e.visibleRange.interval=e.visibleRange.interval<1?1:e.visibleRange.interval;var t,i,r=Math.ceil(e.visibleRange.min);for((e.zoomFactor<1||e.zoomPosition>0)&&(r=e.visibleRange.min-e.visibleRange.min%e.visibleRange.interval),e.startLabel=e.labels[Math.round(e.visibleRange.min)],e.endLabel=e.labels[Math.floor(e.visibleRange.max)];r<=e.visibleRange.max;r+=e.visibleRange.interval)t=sf.base.extend({},sf.base.getValue("properties",e.labelStyle),null,!0),se(r,e.visibleRange)&&e.labels.length>0&&(i=Math.round(r),je(this.chart,i,e.labels[i]?e.labels[i].toString():i.toString(),t,e));e.getMaxLabelWidth&&e.getMaxLabelWidth(this.chart)},t.prototype.getModuleName=function(){return"Category"},t.prototype.destroy=function(){},t}(zr),Ur=(si=function(e,t){return(si=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}si(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),Hr=function(e){function t(t){return e.call(this,t)||this}return Ur(t,e),t.prototype.calculateRangeAndInterval=function(e,t){this.calculateRange(t),this.getActualRange(t,e),this.calculateVisibleRange(e,t),this.calculateVisibleLabels(t,this.chart)},t.prototype.getActualRange=function(e,t){this.initializeDoubleRange(e),this.min=this.min<0?0:this.min;var i=re(this.min,e.logBase);i=isFinite(i)?i:this.min;var r=1===this.max?1:re(this.max,e.logBase);r=isFinite(i)?r:this.max,this.min=Math.floor(i/1),e.series&&e.series.some((function(e){return(-1!==e.type.indexOf("Column")||-1!==e.type.indexOf("Bar"))&&-1===e.type.indexOf("Range")}))&&(this.min=this.min<=0?+this.min-1:this.min),this.max=Math.ceil(r/1),this.max=this.max===this.min?this.max+1:this.max,e.actualRange.interval=e.interval||this.calculateLogNiceInterval(this.max-this.min,t,e),e.actualRange.min=this.min,e.actualRange.max=this.max,e.actualRange.delta=this.max-this.min},t.prototype.calculateVisibleRange=function(e,t){t.visibleRange={interval:t.actualRange.interval,max:t.actualRange.max,min:t.actualRange.min,delta:t.actualRange.delta};var i=!sf.base.isNullOrUndefined(t.zoomingScrollBar)&&t.zoomingScrollBar.isLazyLoad;(t.zoomFactor<1||t.zoomPosition>0)&&!i&&(t.calculateVisibleRangeOnZooming(e),t.visibleRange.interval=t.enableAutoIntervalOnZooming?this.calculateLogNiceInterval(t.doubleRange.delta,e,t):t.visibleRange.interval,t.visibleRange.interval=0===Math.floor(t.visibleRange.interval)?1:Math.floor(t.visibleRange.interval),t.triggerRangeRender(this.chart,t.visibleRange.min,t.visibleRange.max,t.visibleRange.interval))},t.prototype.calculateLogNiceInterval=function(e,t,i){for(var r=Be(t,i),n=e,o=Math.pow(i.logBase,Math.floor(re(n,10))),s=0,a=i.intervalDivs.length;s<a;s++){var l=o*i.intervalDivs[s];if(r<e/l)break;n=l}return n},t.prototype.calculateVisibleLabels=function(e,t){/*! Generate axis labels */var i,r,n=e.visibleRange.min;e.visibleLabels=[],(e.zoomFactor<1||e.zoomPosition>0)&&(n=e.visibleRange.min-e.visibleRange.min%e.visibleRange.interval);var o=this.getFormat(e),s=null!==o.match("{value}"),a=Math.pow(e.logBase,e.visibleRange.min);for(e.format=t.intl.getNumberFormat({format:s?"":o,useGrouping:t.useGroupingSeparator,maximumFractionDigits:a<1?20:3}),e.startLabel=e.format(a<1?+a.toPrecision(1):a),e.endLabel=e.format(Math.pow(e.logBase,e.visibleRange.max));n<=e.visibleRange.max;n+=e.visibleRange.interval)i=sf.base.extend({},sf.base.getValue("properties",e.labelStyle),null,!0),se(n,e.visibleRange)&&(r=Math.pow(e.logBase,n),je(this.chart,n,this.formatValue(e,s,o,r<1?+r.toPrecision(1):r),i,e));e.getMaxLabelWidth&&e.getMaxLabelWidth(this.chart)},t.prototype.getModuleName=function(){return"Logarithmic"},t.prototype.destroy=function(){},t}(C),Br=(ai=function(e,t){return(ai=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}ai(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),_r=function(e){function t(t){return e.call(this,t)||this}return Br(t,e),t.prototype.calculateRangeAndInterval=function(e,t){this.axisSize=e,this.calculateRange(t),this.getActualRange(t,e),this.applyRangePadding(t,e),this.calculateVisibleLabels(t)},t.prototype.calculateVisibleLabels=function(e){var t;/*! Generate axis labels */e.visibleLabels=[];var i="BetweenTicks"===e.labelPlacement?.5:0;"Auto"===e.intervalType?this.calculateDateTimeNiceInterval(e,this.axisSize,parseInt(e.labels[0],10),parseInt(e.labels[e.labels.length-1],10)):e.actualIntervalType=e.intervalType,e.format=this.chart.intl.getDateFormat({format:e.labelFormat||this.blazorCustomFormat(e),type:Ae(e.skeletonType),skeleton:this.getSkeleton(e,null,null,this.chart.isBlazor)});for(var r=0;r<e.labels.length;r++)t=sf.base.extend({},sf.base.getValue("properties",e.labelStyle),null,!0),this.sameInterval(e.labels.map(Number)[r],e.labels.map(Number)[r-1],e.actualIntervalType,r)&&!e.isIndexed||se(r-i,e.visibleRange)&&je(this.chart,r,e.isIndexed?this.getIndexedAxisLabel(e.labels[r],e.format):e.format(new Date(e.labels.map(Number)[r])),t,e);e.getMaxLabelWidth&&e.getMaxLabelWidth(this.chart)},t.prototype.blazorCustomFormat=function(e){return this.chart.isBlazor&&"Years"===e.actualIntervalType?"yyyy":""},t.prototype.getIndexedAxisLabel=function(e,t){for(var i=e.split(","),r=0;r<i.length;r++)i[r]=t(new Date(parseInt(i[r],10)));return i.join(", ")},t.prototype.sameInterval=function(e,t,i,r){var n;if(0===r)n=!1;else switch(i){case"Years":n=new Date(e).getFullYear()===new Date(t).getFullYear();break;case"Months":n=new Date(e).getFullYear()===new Date(t).getFullYear()&&new Date(e).getMonth()===new Date(t).getMonth();break;case"Days":n=Math.abs(e-t)<864e5&&new Date(e).getDay()===new Date(t).getDay();break;case"Hours":n=Math.abs(e-t)<36e5&&new Date(e).getDay()===new Date(t).getDay();break;case"Minutes":n=Math.abs(e-t)<6e4&&new Date(e).getMinutes()===new Date(t).getMinutes();break;case"Seconds":n=Math.abs(e-t)<1e3&&new Date(e).getDay()===new Date(t).getDay()}return n},t.prototype.getModuleName=function(){return"DateTimeCategory"},t.prototype.destroy=function(){},t}(jr),Vr=function(){function e(){}return e.prototype.measureStripLine=function(e,t,i,r,n,o){var s,a,l=e.orientation,h="DateTime"===e.valueType;if(t.isRepeat&&null!==t.size)s=r,a=null;else if("DateTimeCategory"===e.valueType){var d=t.start,c=t.end;s=null!=d&&"number"!=typeof d?e.labels.indexOf(this.dateToMilliSeconds(d,o).toString()):d,a=null!=c&&"number"!=typeof c?e.labels.indexOf(this.dateToMilliSeconds(c,o).toString()):c}else s=null===t.start?null:h&&this.isCoreDate(t.start)?this.dateToMilliSeconds(t.start,o):+t.start,a=null===t.end?null:h&&this.isCoreDate(t.start)?this.dateToMilliSeconds(t.end,o):+t.end;var p=this.getFromTovalue(s,a,t.size,t.startFromAxis,e,t),u="Vertical"===l?(p.to-p.from)*e.rect.height:i.height,g="Horizontal"===l?(p.to-p.from)*e.rect.width:i.width,f="Vertical"===l?i.x:p.from*e.rect.width+e.rect.x,m="Horizontal"===l?i.y:e.rect.y+e.rect.height-("Pixel"===t.sizeType?p.from:p.to)*e.rect.height;if(t.isSegmented&&null!=t.segmentStart&&null!=t.segmentEnd&&"Pixel"!==t.sizeType){d=h&&this.isCoreDate(t.segmentStart)?this.dateToMilliSeconds(t.segmentStart,o):+t.segmentStart,c=h&&this.isCoreDate(t.segmentEnd)?this.dateToMilliSeconds(t.segmentEnd,o):+t.segmentEnd;var y=this.getFromTovalue(d,c,null,null,n,t);"Vertical"===n.orientation?(m=n.rect.y+n.rect.height-y.to*n.rect.height,u=(y.to-y.from)*n.rect.height):(f=y.from*n.rect.width+n.rect.x,g=(y.to-y.from)*n.rect.width)}return 0!==u&&0!==g||"Pixel"===t.sizeType&&(null!==t.start||t.startFromAxis)?new sf.svgbase.Rect(f,m,g,u):new sf.svgbase.Rect(0,0,0,0)},e.prototype.getFromTovalue=function(e,t,i,r,n,o){var s=!o.isRepeat&&r?n.visibleRange.min:e,a=this.getToValue(Math.max(e,sf.base.isNullOrUndefined(t)?e:t),s,i,n,t,o);return s=this.findValue(s,n),a=this.findValue(a,n),{from:ye(n.isAxisInverse?a:s,n),to:ye(n.isAxisInverse?s:a,n)}},e.prototype.getToValue=function(e,t,i,r,n,o){var s=o.sizeType,a=null===n;if("DateTime"!==r.valueType)return"Pixel"===o.sizeType?t:a?t+i:e;var l=new Date(t);switch("Auto"===s&&(s=r.actualIntervalType,i*=r.visibleRange.interval),s){case"Years":return a?new Date(l.setFullYear(l.getFullYear()+i)):e;case"Months":return a?new Date(l.setMonth(l.getMonth()+i)):e;case"Days":return a?new Date(l.setDate(l.getDate()+i)):e;case"Hours":return a?new Date(l.setHours(l.getHours()+i)):e;case"Minutes":return a?new Date(l.setMinutes(l.getMinutes()+i)):e;case"Seconds":return a?new Date(l.setSeconds(l.getSeconds()+i)):e;default:return t}},e.prototype.findValue=function(e,t){return e<t.visibleRange.min?e=t.visibleRange.min:e>t.visibleRange.max&&(e=t.visibleRange.max),e},e.prototype.dateParse=function(e,t){var i=t.intl.getDateParser({skeleton:"full",type:"dateTime"}),r=t.intl.getDateFormat({skeleton:"full",type:"dateTime"});return new Date(Date.parse(i(r(new Date(sf.data.DataUtil.parse.parseJson({val:e}).val)))))},e.prototype.renderStripLine=function(e,t,i){var r,n=e.element.id+"_stripline_"+t+"_",o=e.chartAxisLayoutPanel.seriesClipRect,s=0,a=0,l=null,h=new zt(n+"ClipRect","transparent",{width:1,color:"Gray"},1,{x:e.initialClipRect.x,y:e.initialClipRect.y,width:e.initialClipRect.width,height:e.initialClipRect.height}),d=e.renderer.createGroup({id:n+"collections","clip-path":"url(#"+n+"ClipRect)"});e.enableCanvas||d.appendChild(Re(e.redraw,h,e.renderer));for(var c=0,p=i;c<p.length;c++)for(var u=p[c],g=0,f=0,m=u.stripLines;f<m.length;f++){var y=m[f];if(y.visible&&y.zIndex===t)if(y.isSegmented&&null!=y.segmentStart&&null!=y.segmentEnd&&"Pixel"!==y.sizeType&&(l=this.getSegmentAxis(i,u,y)),y.isRepeat&&null!=y.repeatEvery&&null!==y.size&&"Pixel"!==y.sizeType)for(s=null!=y.repeatUntil?"DateTime"===u.valueType?this.dateToMilliSeconds(y.repeatUntil,e):+y.repeatUntil:u.actualRange.max,a="DateTime"===u.valueType&&this.isCoreDate(y.start)?this.dateToMilliSeconds(y.start,e):y.start,(y.startFromAxis&&"DateTime"===u.valueType&&"Auto"===y.sizeType||y.start<u.visibleRange.min)&&(a=u.visibleLabels[0].value===u.visibleRange.min?u.visibleRange.min:u.visibleLabels[0].value-("DateTime"===u.valueType?u.dateTimeInterval:u.visibleRange.interval)),a=y.startFromAxis&&"DateTime"!==u.valueType?u.visibleRange.min:a;a<s;)r=se(a+("DateTime"===u.valueType?u.dateTimeInterval*+y.size:y.size),u.visibleRange),(a>=u.visibleRange.min&&a<u.visibleRange.max||r)&&this.renderStripLineElement(u,y,o,n,d,e,a,l,g),g++,a=this.getStartValue(u,y,a,e);else this.renderStripLineElement(u,y,o,n,d,e,null,l,g),g++}nt(e.enableCanvas,e.svgObject,d,e.redraw)},e.prototype.isCoreDate=function(e){return"string"==typeof e},e.prototype.dateToMilliSeconds=function(e,t){return this.dateParse(e,t).getTime()},e.prototype.renderPath=function(e,t,i,r,n,o){var s=Ge(i),a=s?s.getAttribute("d"):"",l="Vertical"===o.orientation?"M "+t.x+" "+t.y+" L "+(t.x+t.width)+" "+t.y:"M "+t.x+" "+t.y+" L "+t.x+" "+(t.y+t.height);nt(n.enableCanvas,r,n.renderer.drawPath(new sf.svgbase.PathOption(i,"none",e.size,e.color,e.opacity,e.dashArray,l)),n.redraw,!0,"x","y",null,a,!0)},e.prototype.renderRectangle=function(e,t,i,r,n){var o=Ge(i),s=o?new sf.svgbase.Rect(+o.getAttribute("x"),+o.getAttribute("y"),+o.getAttribute("width"),+o.getAttribute("height")):null;nt(n.enableCanvas,r,n.renderer.drawRectangle(new zt(i,e.color,e.border,e.opacity,t,0,0,"",e.dashArray)),n.redraw,!0,"x","y",null,null,!0,!0,s)},e.prototype.renderText=function(e,t,i,r,n,o){var s,a=sf.svgbase.measureText(e.text,e.textStyle),l=null===e.rotation,h=l?a.height/8*3:0,d=t.y+t.height/2+h,c=l?"Vertical"===o.orientation?0:-90:e.rotation,p=t.x+t.width/2;"Horizontal"===o.orientation?(p=this.getTextStart(p+h*this.factor(e.horizontalAlignment),t.width,e.horizontalAlignment),d=this.getTextStart(d-h,t.height,e.verticalAlignment)+("Start"!==e.verticalAlignment||l?0:a.height/4),s=l?this.invertAlignment(e.verticalAlignment):e.horizontalAlignment):(p=this.getTextStart(p,t.width,e.horizontalAlignment),d=this.getTextStart(d+h*this.factor(e.verticalAlignment)-5,t.height,e.verticalAlignment),s=e.horizontalAlignment),It(n.renderer,new sf.svgbase.TextOption(i,p,d,s,e.text,"rotate("+c+" "+p+","+d+")","middle"),e.textStyle,e.textStyle.color,r,null,null,null,null,null,null,0,null,n.enableCanvas)},e.prototype.invertAlignment=function(e){switch(e){case"Start":e="End";break;case"End":e="Start"}return e},e.prototype.getStartValue=function(e,t,i,r){return"DateTime"===e.valueType?this.getToValue(null,i,+t.repeatEvery,e,null,t):i+ +t.repeatEvery},e.prototype.getSegmentAxis=function(e,t,i){var r;if(null==i.segmentAxisName)return"Horizontal"===t.orientation?e[1]:e[0];for(var n=0;n<e.length;n++)i.segmentAxisName===e[n].name&&(r=e[n]);return r},e.prototype.renderStripLineElement=function(e,t,i,r,n,o,s,a,l){var h=this.measureStripLine(e,t,i,s,a,o);"Pixel"===t.sizeType?this.renderPath(t,h,r+"path_"+e.name+"_"+l,n,o,e):0!==h.height&&0!==h.width&&this.renderRectangle(t,h,r+"rect_"+e.name+"_"+l,n,o),""!==t.text&&this.renderText(t,h,r+"text_"+e.name+"_"+l,n,o,e)},e.prototype.factor=function(e){var t=0;switch(e){case"Start":t=1;break;case"End":t=-1}return t},e.prototype.getTextStart=function(e,t,i){switch(i){case"Start":e=e-t/2+5;break;case"End":e=e+t/2-5}return e},e.prototype.getModuleName=function(){return"StripLine"},e.prototype.destroy=function(){},e}(),Yr=function(){function e(e){this.chart=e}return e.prototype.enableComplexProperty=function(e){for(var t,i=[],r=[],n=e.xAxis.visibleRange,o=e.yAxis.visibleRange,s=e.points,a=e.clipRect,l=Math.abs(n.delta/a.width),h=Math.abs(o.delta/a.height),d=s[0]&&s[0].x>l?0:l,c=s[0]&&s[0].y>h?0:h,p=0,u=0,g=0,f=s;g<f.length;g++){var m=f[g];m.symbolLocations=[],p=m.xValue?m.xValue:n.min,u=m.yValue?m.yValue:o.min,(Math.abs(d-p)>=l||Math.abs(c-u)>=h)&&(i.push(m),d=p,c=u)}for(var y=0;y<i.length;y++)t=i[y],sf.base.isNullOrUndefined(t.x)||""===t.x||"Indicator"===e.category&&(isNaN(t.xValue)||isNaN(t.yValue))||r.push(t);return r},e.prototype.getLineDirection=function(e,t,i,r,n,o){var s="";if(null!=e){var a=n(e.xValue,e.yValue,i.xAxis,i.yAxis,r,i),l=n(t.xValue,t.yValue,i.xAxis,i.yAxis,r,i);s=o+" "+a.x+" "+a.y+" L "+l.x+" "+l.y+" "}return s},e.prototype.appendLinePath=function(e,t,i){var r=Ge(e.id),n=t.chart,o=r?r.getAttribute("d"):null,s=t.chart.renderer.drawPath(e,new Int32Array([t.clipRect.x,t.clipRect.y]));s&&s.setAttribute("clip-path",i),t.pathElement=s,t.chart.enableCanvas||t.seriesElement.appendChild(s),t.isRectSeries=!1,We(r,e.d,t.chart.redraw,o,n.duration)},e.prototype.renderMarker=function(e){e.marker&&e.marker.visible&&e.chart.markerRender.render(e)},e.prototype.doProgressiveAnimation=function(e,t){var i,r=new sf.base.Animation({}),n=e.pathElement,o=n.getAttribute("stroke-dasharray"),s=e.pathElement.getTotalLength();n.style.visibility="hidden",r.animate(n,{duration:t.duration,delay:t.delay,progress:function(e){e.timeStamp>=e.delay&&(n.style.visibility="visible",i=Math.abs(Math.round((e.timeStamp-e.delay)*s/e.duration)),n.setAttribute("stroke-dasharray",i+","+s))},end:function(){n.setAttribute("stroke-dasharray",o),e.chart.trigger("animationComplete",{series:e.chart.isBlazor?{}:e})}})},e.prototype.storePointLocation=function(e,t,i,r){var n=t.marker&&t.marker.width?t.marker.width:0,o=t.marker&&t.marker.height?t.marker.height:0;e.symbolLocations.push(r(e.xValue,e.yValue,t.xAxis,t.yAxis,i,t)),e.regions.push(new sf.svgbase.Rect(e.symbolLocations[0].x-n,e.symbolLocations[0].y-o,2*n,2*o))},e.prototype.withinYRange=function(e,t){return e.yValue>=t.visibleRange.min&&e.yValue<=t.visibleRange.max},e.prototype.getFirstLastVisiblePoint=function(e){for(var t=null,i=null,r=0,n=e;r<n.length;r++){var o=n[r];null===t&&o.visible&&(t=i=o),i=o.visible?o:i}return{first:t||e[0],last:i||e[e.length-1]}},e.prototype.getBorderDirection=function(e){var t=e.split(" ");return t.length>3&&!this.chart.stackingAreaSeriesModule&&!this.chart.stackingStepAreaSeriesModule?t.splice(t.length-4,3):(this.chart.stackingAreaSeriesModule||this.chart.stackingStepAreaSeriesModule)&&(t.splice(t.length/2+1,t.length/2+1),"L"===t[t.length-1]&&t.splice(t.length-1,1)),t.join(" ")},e.prototype.removeEmptyPointsBorder=function(e){var t,i=0,r=e.split(" ");do{(t=r.indexOf("M",i))>-1&&(r.splice(t+1,3),i=t+1,t-6>0&&(r.splice(t-6,6),i-=6))}while(-1!==t);return r.join(" ")},e.prototype.doLinearAnimation=function(e,t){var i,r=e.clipRectElement.childNodes[0].childNodes[0],n=e.chart.animated?e.chart.duration:t.duration,o=De("Linear"),s=+r.getAttribute("height"),a=+r.getAttribute("width"),l=+r.getAttribute("x"),h=e.chart.requireInvertedAxis?+r.getAttribute("height")+ +r.getAttribute("y"):+r.getAttribute("y");r.style.visibility="hidden",new sf.base.Animation({}).animate(r,{duration:n,delay:t.delay,progress:function(t){t.timeStamp>=t.delay&&(r.style.visibility="visible",e.chart.requireInvertedAxis?(i=o(t.timeStamp-t.delay,0,s,t.duration),r.setAttribute("transform","translate("+l+" "+h+") scale(1,"+i/s+") translate("+-l+" "+-h+")")):(i=o(t.timeStamp-t.delay,0,a,t.duration),r.setAttribute("transform","translate("+l+" "+h+") scale("+i/a+", 1) translate("+-l+" "+-h+")")))},end:function(){r.setAttribute("transform","translate(0,0)"),e.chart.trigger("animationComplete",{series:e.chart.isBlazor?{}:e})}})},e}(),Qr=(li=function(e,t){return(li=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}li(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),qr=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Qr(t,e),t.prototype.render=function(e,t,i,r){for(var n,o,s="",a=null,l="M",h=e.chart&&"PolarRadar"===e.chart.chartAreaType,d=e.emptyPointSettings&&"Drop"===e.emptyPointSettings.mode,c=h?ve:it,p="TrendLine"===e.category?e.points:this.enableComplexProperty(e),u=0,g=p;u<g.length;u++){var f=g[u];f.regions=[],f.symbolLocations=[],f.visible&&le(p[f.index-1],f,p[f.index+1],e)?(s+=this.getLineDirection(a,f,e,r,c,l),l=a?"L":l,a=f,this.storePointLocation(f,e,r,c)):(a=d?a:null,l=d?l:"M")}if(h&&e.isClosed){var m=this.getFirstLastVisiblePoint(p);o=c(m.last.xValue,m.last.yValue,t,i,r,e),n=c(m.first.xValue,m.first.yValue,t,i,r,e),s=s.concat(l+" "+o.x+" "+o.y+" L "+n.x+" "+n.y)}var y="Indicator"===e.category?e.chart.element.id+"_Indicator_"+e.index+"_"+e.name:"TrendLine"===e.category?e.chart.element.id+"_Series_"+e.sourceIndex+"_TrendLine_"+e.index:e.chart.element.id+"_Series_"+(void 0===e.index?e.category:e.index),v=new sf.svgbase.PathOption(y,"none",e.width,e.interior,e.opacity,e.dashArray,s);this.appendLinePath(v,e,""),this.renderMarker(e)},t.prototype.doAnimation=function(e){var t=e.animation;this.doProgressiveAnimation(e,t)},t.prototype.getModuleName=function(){return"LineSeries"},t.prototype.destroy=function(){},t}(Yr),Gr=function(){function e(){}return e.prototype.getSideBySideInfo=function(e){if(e.chart.enableSideBySidePlacement&&!e.position&&this.getSideBySidePositions(e),e.columnWidthInPixel)return new S(0,0);var t="Histogram"!==e.type&&e.chart.enableSideBySidePlacement?e.position:0,i="Histogram"!==e.type&&e.chart.enableSideBySidePlacement?e.rectCount:1;e.isRectSeries=!0;var r,n=e.chart.visibleSeries,o=e.chart.enableSideBySidePlacement?e.columnSpacing:0,s=null===e.columnWidth||isNaN(+e.columnWidth)?"Histogram"===e.type?1:.7:e.columnWidth,a=Fe(e.xAxis,n),l=a*s,h=t/i-.5,d=new S(h,h+1/i);if(!isNaN(d.start)&&!isNaN(d.end)){if(e.groupName&&-1===e.type.indexOf("Stacking")){var c=.7;e.chart.series.filter((function(e){e.columnWidth>c&&(c=e.columnWidth)}));var p=a*c,u=new S(d.start*p,d.end*p),g=(u.delta-(d.end*l-d.start*l))/2;d=new S(u.start+g,u.end-g)}else d=new S(d.start*l,d.end*l);r=o*d.delta,d=new S(d.start+r/2,d.end-r/2)}return d},e.prototype.getRectangle=function(e,t,i,r,n){var o=it(e,t,n.xAxis,n.yAxis,n.chart.requireInvertedAxis),s=it(i,r,n.xAxis,n.yAxis,n.chart.requireInvertedAxis);return new sf.svgbase.Rect(Math.min(o.x,s.x),Math.min(o.y,s.y),Math.abs(s.x-o.x),Math.abs(s.y-o.y))},e.prototype.getSideBySidePositions=function(e){for(var t=e.chart,i=0,r=t.columns;i<r.length;i++)for(var n=r[i],o=0,s=t.rows;o<s.length;o++){var a=s[o];this.findRectPosition(e.findSeriesCollection(n,a,!1))}},e.prototype.findRectPosition=function(e){for(var t=[],i={rectCount:0,position:null},r=0;r<e.length;r++){if(-1!==(o=e[r]).type.indexOf("Stacking")||""!==o.groupName){var n=-1!==o.type.indexOf("Stacking")?o.stackingGroup:o.type+o.groupName;n?void 0===t[n]?(o.position=i.rectCount,t[n]=i.rectCount++):o.position=t[n]:null===i.position?(o.position=i.rectCount,i.position=i.rectCount++):o.position=i.position}else o.position=i.rectCount++}for(r=0;r<e.length;r++){var o;(o=e[r]).rectCount=i.rectCount}},e.prototype.updateSymbolLocation=function(e,t,i){i.chart.requireInvertedAxis?this.updateYRegion(e,t,i):this.updateXRegion(e,t,i),"Histogram"===i.type&&(e.minimum=+e.x-i.histogramValues.binWidth/2,e.maximum=+e.x+i.histogramValues.binWidth/2)},e.prototype.updateXRegion=function(e,t,i){e.symbolLocations.push({x:t.x+t.width/2,y:"BoxPlot"===i.seriesType||-1!==i.seriesType.indexOf("HighLow")||e.yValue>=0==!i.yAxis.isAxisInverse?t.y:t.y+t.height}),this.getRegion(e,t,i),"RangeColumn"===i.type&&e.symbolLocations.push({x:t.x+t.width/2,y:t.y+t.height})},e.prototype.updateYRegion=function(e,t,i){e.symbolLocations.push({x:"BoxPlot"===i.seriesType||-1!==i.seriesType.indexOf("HighLow")||e.yValue>=0==!i.yAxis.isAxisInverse?t.x+t.width:t.x,y:t.y+t.height/2}),this.getRegion(e,t,i),"RangeColumn"===i.type&&e.symbolLocations.push({x:t.x,y:t.y+t.height/2})},e.prototype.renderMarker=function(e){e.marker&&e.marker.visible&&e.chart.markerRender.render(e)},e.prototype.getRegion=function(e,t,i){if(0===e.y){var r=i.marker&&i.marker.width?i.marker.width:0,n=i.marker&&i.marker.height?i.marker.height:0;e.regions.push(new sf.svgbase.Rect(e.symbolLocations[0].x-r,e.symbolLocations[0].y-n,2*r,2*n))}else e.regions.push(t)},e.prototype.triggerEvent=function(e,t,i,r){var n={cancel:!1,name:"pointRender",series:e,point:t,fill:e.setPointColor(t,i),border:e.setBorderColor(t,r)};return e.chart.trigger("pointRender",n),t.color=n.fill,n},e.prototype.drawRectangle=function(e,t,i,r){var n,o=e.chart;if((o.requireInvertedAxis?i.height:i.width)<=0)return null;n=0===t.y?this.calculateRoundedRectPath(i,0,0,0,0):this.calculateRoundedRectPath(i,e.cornerRadius.topLeft,e.cornerRadius.topRight,e.cornerRadius.bottomLeft,e.cornerRadius.bottomRight);var s="Indicator"===e.category?o.element.id+"_Indicator_"+e.index+"_"+e.name+"_Point_"+t.index:o.element.id+"_Series_"+e.index+"_Point_"+t.index,a=Mt(o.redraw,s),l=a?a.getAttribute("d"):"",h=new sf.svgbase.PathOption(s,r.fill,r.border.width,r.border.color,e.opacity,e.dashArray,n),d=o.renderer.drawPath(h,new Int32Array([e.clipRect.x,e.clipRect.y]));switch(e.seriesType){case"XY":d.setAttribute("aria-label",t.x+":"+t.yValue+", "+e.name);break;case"HighLow":d.setAttribute("aria-label",t.x+":"+t.high+", "+t.low+", "+e.name)}nt(e.chart.enableCanvas,e.seriesElement,d,o.redraw),e.chart.enableCanvas||We(d,n,o.redraw,l,o.duration)},e.prototype.animate=function(e){for(var t=e.seriesElement.childNodes,i="Indicator"===e.category?0:1,r=0,n=ee(e);r<n.length;r++){var o=n[r];(o.symbolLocations.length||"BoxAndWhisker"===e.type&&o.regions.length)&&(this.animateRect(t[i],e,o),i++)}},e.prototype.animateRect=function(e,t,i){var r,n,o,s,a,l=t.animation,h=t.chart.animated?t.chart.duration:l.duration,d=De("Linear"),c=i.yValue<0,p=+i.regions[0].height,u=+i.regions[0].width;t.chart.requireInvertedAxis?(n=+i.regions[0].y,t.type.indexOf("Stacking")>-1?(r=ye(0,t.yAxis)*t.yAxis.rect.width,o=r,s=n):(r=+i.regions[0].x,s=c?n:n+p,o=-1!==t.seriesType.indexOf("HighLow")||-1!==t.type.indexOf("Waterfall")?r+u/2:c!==t.yAxis.isAxisInverse?r+u:r)):(r=+i.regions[0].x,t.type.indexOf("Stacking")>-1?(n=(1-ye(0,t.yAxis))*t.yAxis.rect.height,o=r,s=n):(n=+i.regions[0].y,s=-1!==t.seriesType.indexOf("HighLow")||-1!==t.type.indexOf("Waterfall")?n+p/2:c!==t.yAxis.isAxisInverse?n:n+p,o=c?r:r+u)),sf.base.isNullOrUndefined(e)||(e.style.visibility="hidden",new sf.base.Animation({}).animate(e,{duration:h,delay:l.delay,progress:function(i){i.timeStamp>=i.delay&&(e.style.visibility="visible",t.chart.requireInvertedAxis?(u=u||1,a=d(i.timeStamp-i.delay,0,u,i.duration),e.setAttribute("transform","translate("+o+" "+s+") scale("+a/u+", 1) translate("+-o+" "+-s+")")):(p=p||1,a=d(i.timeStamp-i.delay,0,p,i.duration),e.setAttribute("transform","translate("+o+" "+s+") scale(1,"+a/p+") translate("+-o+" "+-s+")")))},end:function(){e.setAttribute("transform","translate(0,0)");var r=t.seriesElement;if((e===r.lastElementChild||i.index===t.points.length-1||"Waterfall"===t.type&&e===r.children[r.childElementCount-2])&&(t.chart.trigger("animationComplete",{series:t.chart.isBlazor?{}:t}),"Waterfall"===t.type))for(var n=r.childNodes,o=0;o<n.length;o++)-1!==n[o].id.indexOf("Connector")&&(n[o].style.visibility="visible",n[o].setAttribute("transform","translate(0,0)"))}}))},e.prototype.calculateRoundedRectPath=function(e,t,i,r,n){return"M "+e.x+" "+(t+e.y)+" Q "+e.x+" "+e.y+" "+(e.x+t)+" "+e.y+" L "+(e.x+e.width-i)+" "+e.y+" Q "+(e.x+e.width)+" "+e.y+" "+(e.x+e.width)+" "+(e.y+i)+" L "+(e.x+e.width)+" "+(e.y+e.height-n)+" Q "+(e.x+e.width)+" "+(e.y+e.height)+" "+(e.x+e.width-n)+" "+(e.y+e.height)+" L "+(e.x+r)+" "+(e.y+e.height)+" Q "+e.x+" "+(e.y+e.height)+" "+e.x+" "+(e.y+e.height-r)+" L "+e.x+" "+(t+e.y)+" Z"},e}(),Xr=(hi=function(e,t){return(hi=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}hi(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),Zr=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Xr(t,e),t.prototype.render=function(e){for(var t,i,r=this.getSideBySideInfo(e),n=Math.max(e.yAxis.visibleRange.min,0),o=0,s=e.points;o<s.length;o++){var a=s[o];if(a.symbolLocations=[],a.regions=[],a.visible&&le(e.points[a.index-1],a,e.points[a.index+1],e)){(t=this.getRectangle(a.xValue+r.start,a.yValue,a.xValue+r.end,n,e)).width=e.columnWidthInPixel?e.columnWidthInPixel:t.width,t.x=e.columnWidthInPixel?t.x-(e.columnWidthInPixel/2*e.rectCount-e.columnWidthInPixel*e.index):t.x;var l="Indicator"===e.category?a.color:e.interior;(i=this.triggerEvent(e,a,l,{width:e.border.width,color:e.border.color})).cancel||(this.updateSymbolLocation(a,t,e),this.drawRectangle(e,a,t,i))}}this.renderMarker(e)},t.prototype.doAnimation=function(e){this.animate(e)},t.prototype.getModuleName=function(){return"ColumnSeries"},t.prototype.destroy=function(){},t}(Gr),Kr=(di=function(e,t){return(di=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}di(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),Jr=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Kr(t,e),t.prototype.getAreaPathDirection=function(e,t,i,r,n,o,s){var a,l="";return null===o&&(l+=s+" "+(a=n(e,t,i.xAxis,i.yAxis,r,i)).x+" "+a.y+" "),l},t.prototype.getAreaEmptyDirection=function(e,t,i,r,n){var o="";return o+=this.getAreaPathDirection(e.x,e.y,i,r,n,null,"L"),o+=this.getAreaPathDirection(t.x,t.y,i,r,n,null,"L")},t.prototype.setPointColor=function(e,t,i,r,n){if(""===i.pointColorMapping){for(var o=void 0,s=0;s<n.length;s++)if(o=n[s],(r?e.xValue:e.yValue)<=this.getAxisValue(o.value,r?i.xAxis:i.yAxis,i.chart)||!o.value&&0!==o.value){e.interior=o.color;break}return null==e.interior&&(e.interior=i.interior),!1}return!!t&&i.setPointColor(e,i.interior)!==i.setPointColor(t,i.interior)},t.prototype.sortSegments=function(e,t){var i=this,r="X"===e.segmentAxis?e.xAxis:e.yAxis;return[].concat(t).sort((function(t,n){return i.getAxisValue(t.value,r,e.chart)-i.getAxisValue(n.value,r,e.chart)}))},t.prototype.applySegmentAxis=function(e,t,i){var r=this;if(""!==e.pointColorMapping)return t.map((function(t){r.appendLinePath(t,e,"")})),null;var n,o="X"===e.segmentAxis,s=o?e.xAxis:e.yAxis,a=e.chart;this.includeSegment(i,s,e,i.length);for(var l,h,d,c=i.length,p=0,u=function(c){n=i[c],l=g.getAxisValue(n.value,s,e.chart),(h=g.createClipRect(c?g.getAxisValue(i[c-1].value,s,e.chart):s.visibleRange.min,l,e,c,o))&&t.map((function(t){p+=1,d={"clip-path":h,"stroke-dasharray":n.dashArray,opacity:t.opacity,stroke:e.type.indexOf("Line")>-1?n.color||e.interior:t.stroke,"stroke-width":t["stroke-width"],fill:e.type.indexOf("Line")>-1?"none":n.color||e.interior,id:t.id+"_Segment_"+c,d:t.d},p%2==0&&r.chart.multiColoredAreaSeriesModule&&"transparent"!==e.border.color&&0!==d["stroke-width"]&&(d.fill="transparent"),We(Ge(d.id),d.d,a.redraw),e.seriesElement.appendChild(a.renderer.drawPath(d))}))},g=this,f=0;f<c;f++)u(f)},t.prototype.includeSegment=function(e,t,i,r){if(r<=0)return e.push({value:t.visibleRange.max,color:i.interior}),null;this.getAxisValue(e[r-1].value,t,i.chart)<t.visibleRange.max&&e.push({value:t.visibleRange.max,color:i.interior})},t.prototype.createClipRect=function(e,t,i,r,n){var o,s=i.chart.requireInvertedAxis,a=it(n?e:i.xAxis.visibleRange.min,n?i.yAxis.visibleRange.max:t,i.xAxis,i.yAxis,s),l=it(n?t:i.xAxis.visibleRange.max,n?i.yAxis.visibleRange.min:e,i.xAxis,i.yAxis,s);return(l=s?[a,a=l][0]:l).x-a.x>0&&l.y-a.y>0?(o=new zt(i.chart.element.id+"_ChartSegment"+i.index+"ClipRect_"+r,"transparent",{width:1,color:"Gray"},1,{x:a.x,y:a.y,width:l.x-a.x,height:l.y-a.y}),i.seriesElement.appendChild(Re(i.chart.redraw,o,i.chart.renderer)),"url(#"+i.chart.element.id+"_ChartSegment"+i.index+"ClipRect_"+r+")"):null},t.prototype.getAxisValue=function(e,t,i){if(null===e&&(e=t.visibleRange.max),"DateTime"===t.valueType){var r={skeleton:"full",type:"dateTime"};return Date.parse(i.intl.getDateParser(r)(i.intl.getDateFormat(r)(new Date(sf.data.DataUtil.parse.parseJson({val:e}).val))))}if(t.valueType.indexOf("Category")>-1){var n="DateTimeCategory"===t.valueType?e.getTime().toString():e;return t.labels.indexOf(n)<0?+e:t.labels.indexOf(n)}return+e},t}(Yr),$r=(ci=function(e,t){return(ci=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}ci(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),en=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return $r(t,e),t.prototype.render=function(e,t,i,r){var n,o=null,s="",a=e.chart&&"PolarRadar"===e.chart.chartAreaType,l=Math.max(e.yAxis.visibleRange.min,0);a&&(l=this.getFirstLastVisiblePoint(e.points).first.yValue);for(var h,d=e.emptyPointSettings&&"Drop"===e.emptyPointSettings.mode,c=e.border.width?e.border.width:0,p=e.border.color?e.border.color:e.interior,u="PolarRadar"===e.chart.chartAreaType?ve:it,g=this.enableComplexProperty(e),f="",m=0;m<g.length;m++)n=(h=g[m]).xValue,h.symbolLocations=[],h.regions=[],h.visible&&le(g[m-1],h,g[m+1],e)&&(s+=this.getAreaPathDirection(n,l,e,r,u,o,"M"),o=o||new jt(n,l),s+=this.getAreaPathDirection(n,h.yValue,e,r,u,null,"L"),g[m+1]&&!g[m+1].visible&&(!a||a&&this.withinYRange(g[m+1],i))&&!d&&(s+=this.getAreaEmptyDirection({x:n,y:l},o,e,r,u),o=null),this.storePointLocation(h,e,r,u));if(a&&""!==s){var y="",v=this.chart;y+=this.getAreaPathDirection(0,l,e,r,u,null,"L"),(t.isAxisInverse||i.isAxisInverse)&&(s+="Polar"===e.type?v.polarSeriesModule.getPolarIsInversedPath(t,y):v.radarSeriesModule.getRadarIsInversedPath(t,y)),s=s.concat(s+" Z")}this.appendLinePath(new sf.svgbase.PathOption(e.chart.element.id+"_Series_"+e.index,e.interior,0,"transparent",e.opacity,e.dashArray,e.points.length>1&&""!==s?s+this.getAreaPathDirection(e.points[e.points.length-1].xValue,"PolarRadar"===e.chart.chartAreaType?e.points[e.points.length-1].yValue:l,e,r,u,null,"L"):""),e,""),0!==e.border.width&&(f=this.removeEmptyPointsBorder(s),this.appendLinePath(new sf.svgbase.PathOption(e.chart.element.id+"_Series_border_"+e.index,"transparent",c,p,1,e.dashArray,f),e,"")),this.renderMarker(e)},t.prototype.destroy=function(){},t.prototype.getModuleName=function(){return"AreaSeries"},t.prototype.doAnimation=function(e){var t=e.animation;this.doLinearAnimation(e,t)},t}(Jr),tn=(pi=function(e,t){return(pi=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}pi(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),rn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return tn(t,e),t.prototype.render=function(e){for(var t,i,r=Math.max(e.yAxis.visibleRange.min,0),n=this.getSideBySideInfo(e),o=0,s=e.points;o<s.length;o++){var a=s[o];a.symbolLocations=[],a.regions=[],a.visible&&le(e.points[a.index-1],a,e.points[a.index+1],e)&&((t=this.getRectangle(a.xValue+n.start,a.yValue,a.xValue+n.end,r,e)).height=e.columnWidthInPixel?e.columnWidthInPixel:t.height,t.y=e.columnWidthInPixel?t.y-(e.columnWidthInPixel/2*e.rectCount-e.columnWidthInPixel*e.index):t.y,(i=this.triggerEvent(e,a,e.interior,{width:e.border.width,color:e.border.color})).cancel||(this.updateSymbolLocation(a,t,e),this.drawRectangle(e,a,t,i)))}this.renderMarker(e)},t.prototype.doAnimation=function(e){this.animate(e)},t.prototype.destroy=function(){},t.prototype.getModuleName=function(){return"BarSeries"},t}(Gr),nn=(ui=function(e,t){return(ui=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}ui(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),on=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.visibleAxisLabelRect=[],t}return nn(t,e),t.prototype.measureAxis=function(e){var t=this.chart;this.initialClipRect=e,this.seriesClipRect=new sf.svgbase.Rect(e.x,e.y,e.width,e.height),this.measureRowAxis(t,this.initialClipRect),this.measureColumnAxis(t,this.initialClipRect),this.calculateAxisSize()},t.prototype.measureRowAxis=function(e,t){this.calculateRowSize(t);var i=e.rows[0];this.measureDefinition(i,e,new sf.svgbase.Size(e.availableSize.width,i.computedHeight))},t.prototype.measureColumnAxis=function(e,t){this.calculateColumnSize(t);var i=e.columns[0];this.measureDefinition(i,e,new sf.svgbase.Size(i.computedWidth,e.availableSize.height))},t.prototype.measureDefinition=function(e,t,i){for(var r=0,n=e.axes;r<n.length;r++){var o=n[r];o.getModule(t),o.baseModule.calculateRangeAndInterval(i,o)}},t.prototype.calculateAxisSize=function(){var e=this.chart;this.centerX=.5*this.initialClipRect.width+this.initialClipRect.x,this.centerY=.5*this.initialClipRect.height+this.initialClipRect.y,e.radius=Math.min(this.initialClipRect.width,this.initialClipRect.height)/2-5-e.primaryXAxis.majorTickLines.height-e.primaryXAxis.maxLabelSize.height,e.radius=e.primaryXAxis.coefficient*e.radius/100,this.seriesClipRect.y=this.centerY-e.radius,this.seriesClipRect.x=this.centerX-e.radius,this.seriesClipRect.height=2*e.radius,this.seriesClipRect.width=2*e.radius,this.calculateRowSize(this.seriesClipRect),e.primaryYAxis.rect=this.seriesClipRect,this.calculateColumnSize(this.seriesClipRect),e.primaryXAxis.rect=this.seriesClipRect},t.prototype.measure=function(){var e=this.chart,t=e.primaryYAxis;t.isRTLEnabled=e.enableRtl,t.setIsInversedAndOpposedPosition(!0),e.verticalAxes.push(t);var i=e.rows[0];i.axes[0]=t,e.rows[0]=i;var r=e.primaryXAxis;r.isRTLEnabled=e.enableRtl,r.setIsInversedAndOpposedPosition(!0),e.horizontalAxes.push(r);var n=e.columns[0];n.axes[0]=r,e.columns[0]=n},t.prototype.calculateRowSize=function(e){/*! Calculate row size */var t=this.chart,i=t.rows[0];i.computedHeight=e.height/2,i.computedTop=e.y,t.rows[0]=i},t.prototype.calculateColumnSize=function(e){/*! Calculate column size */var t=this.chart,i=t.columns[0];i.computedLeft=e.x,i.computedWidth=e.width,t.columns[0]=i},t.prototype.renderAxes=function(){var e,t=this.chart;this.startAngle=t.primaryXAxis.startAngle;for(var i=t.renderer.createGroup({id:t.element.id+"AxisCollection"}),r=t.renderer.createGroup({id:t.element.id+"AxisOutsideCollection"}),n=0,o=t.axisCollections.length;n<o;n++)this.element=t.renderer.createGroup({id:t.element.id+"AxisGroup"+n}),"Horizontal"===(e=t.axisCollections[n]).orientation?((e.majorGridLines.width>0||e.majorTickLines.width>0)&&this.drawXAxisGridLine(e,n),e.visible&&e.internalVisibility&&this.drawXAxisLabels(e,n)):(this.drawYAxisGridLine(e,n),e.lineStyle.width>0&&this.drawYAxisLine(e,n),e.visible&&e.internalVisibility&&this.drawYAxisLabels(e,n)),this.chart.enableCanvas||i.appendChild(this.element);return this.chart.enableCanvas||i.appendChild(this.element),nt(t.enableCanvas,t.svgObject,i,t.redraw),r},t.prototype.drawYAxisLine=function(e,t){var i,r=this.chart,n=be(we(e.visibleLabels[0].value,e),this.startAngle),o="M "+this.centerX+" "+this.centerY+"L "+(this.centerX+r.radius*n.x)+" "+(this.centerY+r.radius*n.y);i={id:r.element.id+"AxisLine_"+t,d:o,"stroke-dasharray":e.lineStyle.dashArray,"stroke-width":e.lineStyle.width,stroke:e.lineStyle.color||r.themeStyle.axisLine};var s=r.renderer.drawPath(i);this.setPointerEventNone(s),this.chart.enableCanvas||r.yAxisElements.appendChild(s)},t.prototype.drawYAxisLabels=function(e,t){var i,r,n,o,s=this.chart,a=0,l=0,h=this.startAngle<0?this.startAngle+360:this.startAngle,d=[],c=[];c[0]=!0;for(var p=e.labelIntersectAction,u=s.renderer.createGroup({id:s.element.id+"AxisLabels"+t}),g=be(we(e.visibleLabels[0].value,e),this.startAngle),f=0,m=e.visibleLabels.length;f<m;f++){if(o=!1,s.radius*ye(e.visibleLabels[f].value,e),i=e.visibleLabels[f].size,n=s.radius*ye(e.visibleLabels[f].value,e),a=this.centerX+n*g.x+(e.majorTickLines.height+i.width/2+2.5)*Math.cos(h*Math.PI/180)*("Inside"===e.labelPosition?1:-1),l=this.centerY+n*g.y+(e.majorTickLines.height+i.height/2)*Math.sin(h*Math.PI/180)*("Inside"===e.labelPosition?1:-1),l+=i.height/4,d[f]=this.getLabelRegion(a,l,e.visibleLabels[f],"middle"),0!==f&&"Hide"===p){for(var y=f;y>=0;y--){if(c[y=0===y?0:y===f?y-1:y]&&dt(d[f],d[y])){o=!0,c[f]=!1;break}c[f]=!0}if(o)continue;for(var v=0,b=this.visibleAxisLabelRect;v<b.length;v++){var w=b[v];if(dt(d[f],w)){o=!0;break}}}o||(this.visibleAxisLabelRect.push(d[f]),r=new sf.svgbase.TextOption(s.element.id+t+"_AxisLabel_"+f,a,l,"middle",e.visibleLabels[f].text),It(s.renderer,r,e.labelStyle,e.labelStyle.color||s.themeStyle.axisLabel,u,!1,s.redraw,!0,!0,null,null,0,null,s.enableCanvas))}this.chart.enableCanvas||s.yAxisElements.appendChild(u)},t.prototype.drawYAxisGridLine=function(e,t){var i,r,n,o,s,a,l,h=this.chart,d="",c="",p=this.startAngle<0?this.startAngle+360:this.startAngle,u={color:e.majorGridLines.color||h.themeStyle.majorGridLine,width:e.majorGridLines.width};if(e.majorGridLines.width>0)if("Polar"===h.visibleSeries[0].type){for(var g=0;g<e.visibleLabels.length;g++)a=(l=Ge(h.element.id+"_MajorGridLine_"+t+"_"+g))?l.getAttribute("r"):null,r=h.radius*ye(e.visibleLabels[g].value,e),i=new Wt(h.element.id+"_MajorGridLine_"+t+"_"+g,"transparent",u,e.majorGridLines.width,this.centerX,this.centerY,r),nt(h.enableCanvas,this.element,h.renderer.drawCircle(i),h.redraw,!0,"r","r",new jt(+a,+a),null,!0);r!==h.radius&&(i=new Wt(h.element.id+"_MajorGridLine_"+t+"_"+e.visibleLabels.length+1,"transparent",u,e.majorGridLines.width,this.centerX,this.centerY,h.radius),nt(h.enableCanvas,this.element,h.renderer.drawCircle(i),h.redraw,!0,"r","r",new jt(+a,+a),null,!0))}else{for(g=0;g<e.visibleLabels.length;g++)r=h.radius*ye(e.visibleLabels[g].value,e),c=this.renderRadarGrid(r,"",h),a=(l=Ge(h.element.id+"_MajorGridLine_"+t+"_"+g))?l.getAttribute("d"):null,i=new sf.svgbase.PathOption(h.element.id+"_MajorGridLine_"+t+"_"+g,"transparent",e.majorGridLines.width,e.majorGridLines.color||h.themeStyle.majorGridLine,null,null,c),nt(h.enableCanvas,this.element,h.renderer.drawPath(i),h.redraw,!0,"x","y",null,a,!0);r!==h.radius&&(c=this.renderRadarGrid(h.radius,"",h),a=(l=Ge(h.element.id+"_MajorGridLine_"+t+"_"+e.visibleLabels.length))?l.getAttribute("d"):null,i=new sf.svgbase.PathOption(h.element.id+"_MajorGridLine_"+t+"_"+e.visibleLabels.length,"transparent",e.majorGridLines.width,e.majorGridLines.color||h.themeStyle.majorGridLine,null,null,c),nt(h.enableCanvas,this.element,h.renderer.drawPath(i),h.redraw,!0,"x","y",null,a,!0))}if(e.majorTickLines.width>0){n=be(we(e.visibleLabels[0].value,e),this.startAngle);for(var f=0;f<e.visibleLabels.length;f++)r=h.radius*ye(e.visibleLabels[f].value,e),d="M "+(o=this.centerX+r*n.x)+" "+(s=this.centerY+r*n.y)+" L "+(o+e.majorTickLines.height*Math.cos(p*Math.PI/180)*("Inside"===e.tickPosition?1:-1))+" "+(s+e.majorTickLines.height*Math.sin(p*Math.PI/180)*("Inside"===e.tickPosition?1:-1)),this.renderTickLine(e,t,d,"",f)}},t.prototype.renderRadarGrid=function(e,t,i){for(var r,n,o,s,a,l,h=0,d=i.primaryXAxis.visibleLabels.length;h<d;h++)r=be(we(i.primaryXAxis.visibleLabels[h].value,i.primaryXAxis),this.startAngle),n=be(we(h+1<d?i.primaryXAxis.visibleLabels[h+1].value:i.primaryXAxis.visibleLabels[0].value,i.primaryXAxis),this.startAngle),o=this.centerX+e*r.x,s=this.centerY+e*r.y,a=this.centerX+e*n.x,l=this.centerY+e*n.y,t=t.concat((h?"L ":"M ")+o+" "+s+" L "+a+" "+l+" ");return t},t.prototype.drawXAxisGridLine=function(e,t){for(var i,r,n,o,s,a=this.chart,l="",h="",d="",c="",p=this.centerX,u=this.centerY,g=e.visibleLabels.length,f=0;f<g;f++){i=e.visibleLabels[f].value,r=be(we(e.visibleLabels[f].value,e),this.startAngle),l="M "+p+" "+u+" L "+(n=this.centerX+a.radius*r.x)+" "+(o=this.centerY+a.radius*r.y),h="M "+n+" "+o+" L "+(n+e.majorTickLines.height*r.x*("Inside"===e.tickPosition?-1:1))+" "+(o+e.majorTickLines.height*r.y*("Inside"===e.tickPosition?-1:1)),e.minorTicksPerInterval>0&&(e.minorGridLines.width>0||e.minorTickLines.width>0)&&"Category"!==e.valueType&&"Radar"!==a.visibleSeries[0].type&&(d=(s=this.drawAxisMinorLine(e,i,d,c))[0],c=s[1]),this.renderTickLine(e,t,h,c,f),this.renderGridLine(e,t,l,d,f)}},t.prototype.drawAxisMinorLine=function(e,t,i,r){for(var n,o,s,a=t,l=e.visibleRange,h=[],d=0;d<e.minorTicksPerInterval;d++)if(oe(a+=("DateTime"===e.valueType?e.dateTimeInterval:e.visibleRange.interval)/(e.minorTicksPerInterval+1),l)){s=be(we(a,e),this.startAngle),n=this.centerX+this.chart.radius*s.x,o=this.centerY+this.chart.radius*s.y;var c=n+e.minorTickLines.height*s.x*("Inside"===e.tickPosition?-1:1),p=o+e.minorTickLines.height*s.y*("Inside"===e.tickPosition?-1:1);i=i.concat("M "+this.centerX+" "+this.centerY+"L "+n+" "+o),r=r.concat("M "+n+" "+o+"L "+c+" "+p)}return h.push(i),h.push(r),h},t.prototype.drawXAxisLabels=function(e,t){var i;this.visibleAxisLabelRect=[],this.chart.legendModule&&(i=this.chart.legendModule.legendBounds);var r,n,o,s,a,l,h,d=this.chart,c=0,p=0,u=d.renderer.createGroup({id:d.element.id+"AxisLabels"+t}),g="Inside"===e.labelPosition,f="",m=[],y=[];y[0]=!0;var v=e.labelIntersectAction,b="Category"===e.valueType&&"BetweenTicks"===e.labelPlacement?.5:0,w=d.radius+e.majorTickLines.height;w=g?-w:w;for(var x=0,M=e.visibleLabels.length;x<M;x++){if(h=!1,n=be(we(e.visibleLabels[x].value+b,e),this.startAngle),isNaN(n.x)||isNaN(n.y)||(c=this.centerX+(w+e.majorTickLines.height+5)*n.x,p=this.centerY+(w+e.majorTickLines.height+5)*n.y,f=parseFloat(c.toFixed(1))===parseFloat(this.centerX.toFixed(1))?"middle":c<this.centerX&&!g||c>this.centerX&&g?"end":"start"),o=(l=e.visibleLabels[x]).text,e.enableTrim||"Trim"===v)for(var N=e.visibleLabels[x].originalText,I=void 0,S=void 0,C=e.labelPosition,O=d.availableSize.width,T=N.length,P=T-1;P>=0;--P)if(I=N.substring(0,P)+"...",S=sf.svgbase.measureText(I,e.labelStyle).width,c===O/2?c-S/2>=0&&c+S/2<=O:"Outside"===C&&(c>=O/2&&c+S<=O||c<=O/2&&c-S>=0)||"Inside"===C&&(c+S<=O/2||c-S>=O/2)){o=P===T-1?N:I,l.size.width=sf.svgbase.measureText(o,e.labelStyle).width,l.text=o;break}if(m[x]=this.getLabelRegion(c,p,l,f),0===x?s=c:x===e.visibleLabels.length-1&&"Category"!==e.valueType&&(a=sf.svgbase.measureText(o,e.labelStyle).height,o=(a+=c)>s?"":o),0!==x&&"Hide"===v)for(var A=x;A>=0;A--){if(y[A=0===A?0:A===x?A-1:A]&&dt(m[x],m[A])){h=!0,y[x]=!1;break}y[x]=!0}if(!h&&i&&(h=dt(m[x],i))){var L=this.getAvailableSpaceToTrim(i,m[x]);L>0&&(o=bt(L,e.visibleLabels[x].originalText,e.labelStyle),h=!1)}r=new sf.svgbase.TextOption(d.element.id+t+"_AxisLabel_"+x,c,p,d.enableRtl?"end"===f?"start":"start"===f?"end":f:f,o,"","central"),h||(this.visibleAxisLabelRect.push(m[x]),It(d.renderer,r,l.labelStyle,l.labelStyle.color||d.themeStyle.axisLabel,u,!1,d.redraw,!0,!0,null,null,0,null,d.enableCanvas))}this.chart.enableCanvas||this.element.appendChild(u)},t.prototype.getAvailableSpaceToTrim=function(e,t){var i=e.x,r=i+e.width,n=t.x,o=n+t.width,s=0;return n>i&&n<r&&o>r?s=o-r:n>i&&n<r&&o<r?s=0:(o>i&&o<r&&n<i||o>i&&o>r&&n<i)&&(s=i-n),s},t.prototype.getLabelRegion=function(e,t,i,r){return"middle"===r?e-=i.size.width/2:"end"===r?e-=i.size.width:e=e,t-=i.size.height/2,new sf.svgbase.Rect(e,t,i.size.width,i.size.height)},t.prototype.renderTickLine=function(e,t,i,r,n){var o,s,a,l=this.chart;e.majorTickLines.width>0&&(s=(a=Ge(l.element.id+"_MajorTickLine_"+t+"_"+n))?a.getAttribute("d"):null,o=new sf.svgbase.PathOption(l.element.id+"_MajorTickLine_"+t+"_"+n,"transparent",e.majorTickLines.width,e.majorTickLines.color||l.themeStyle.majorTickLine,null,null,i),a=l.renderer.drawPath(o),this.setPointerEventNone(a),nt(l.enableCanvas,l.yAxisElements,a,l.redraw,!0,"x","y",null,s)),e.minorTickLines.width>0&&(s=(a=Ge(l.element.id+"_MinorTickLine_"+t+"_"+n))?a.getAttribute("d"):null,o=new sf.svgbase.PathOption(l.element.id+"_MinorTickLine_"+t+"_"+n,"transparent",e.minorTickLines.width,e.minorTickLines.color||l.themeStyle.minorTickLine,null,null,r),a=l.renderer.drawPath(o),this.setPointerEventNone(a),nt(l.enableCanvas,l.yAxisElements,a,l.redraw,!0,"x","y",null,s))},t.prototype.renderGridLine=function(e,t,i,r,n){var o,s,a,l=this.chart;e.majorGridLines.width>0&&(s=(a=Ge(l.element.id+"_MajorGridLine_"+t+"_"+n))?a.getAttribute("d"):null,o=new sf.svgbase.PathOption(l.element.id+"_MajorGridLine_"+t+"_"+n,"transparent",e.majorGridLines.width,e.majorGridLines.color||l.themeStyle.majorGridLine,null,e.majorGridLines.dashArray,i),nt(l.enableCanvas,this.element,l.renderer.drawPath(o),l.redraw,!0,"x","y",null,s)),e.minorGridLines.width>0&&(s=(a=Ge(l.element.id+"_MinorGridLine_"+t+"_"+n))?a.getAttribute("d"):null,o=new sf.svgbase.PathOption(l.element.id+"_MinorGridLine_"+t+"_"+n,"transparent",e.minorGridLines.width,e.minorGridLines.color||l.themeStyle.minorGridLine,null,e.minorGridLines.dashArray,r),nt(l.enableCanvas,this.element,l.renderer.drawPath(o),l.redraw,!0,"x","y",null,s))},t.prototype.setPointerEventNone=function(e){e&&(e.style.pointerEvents="none")},t}(Yr),sn=(gi=function(e,t){return(gi=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}gi(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),an=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return sn(t,e),t.prototype.render=function(e,t,i,r){for(var n=Ae(e.drawType),o=i.minimum,s=i.maximum,a=0,l=e.points;a<l.length;a++){var h=l[a];h.visible=h.visible&&!(!sf.base.isNullOrUndefined(o)&&h.yValue<o||!sf.base.isNullOrUndefined(s)&&h.yValue>s)}e.points.length&&(e.drawType.indexOf("Column")>-1?this.columnDrawTypeRender(e,t,i):e.chart[n+"SeriesModule"].render(e,t,i,r))},t.prototype.columnDrawTypeRender=function(e,t,i){var r,n,o,s,a,l,h,d,c,p,u,g,f,m,y,v,b,w,x,M,N=t.actualRange.min,I=e.clipRect.width/2+e.clipRect.x,S=e.clipRect.height/2+e.clipRect.y,C="RangeColumn"===e.drawType,O="Polar"===e.type,T="Logarithmic"===i.valueType,P="StackingColumn"===e.drawType,A="",L=0,F=(e.points[1]?e.points[1].xValue:2*e.points[0].xValue)-e.points[0].xValue,D=t.isAxisInverse,E="Category"===t.valueType&&"BetweenTicks"===t.labelPlacement?0:D?-F/2:F/2,z="DateTime"===t.valueType?t.dateTimeInterval:1;this.getSeriesPosition(e);var k=D?e.rectCount-1-e.position:e.position;do{L+=z,N+=z}while(N<=t.actualRange.max-("Category"===t.valueType?0:1));for(var W=0,R=e.points;W<R.length;W++){var j=R[W];j.symbolLocations=[],j.regions=[],j.visible&&le(e.points[j.index-1],j,e.points[j.index+1],e)&&(a=(D?t.visibleRange.max-j.xValue:j.xValue-t.visibleRange.min)+(F/e.rectCount*k-E)+L/360*t.startAngle,a/=L,o=2*Math.PI*(a+t.startAngle),s=2*Math.PI*(a+t.startAngle+F/e.rectCount/L),0===o&&0===s?(s=2*Math.PI,M="1"):M="0",h=o,d=s,o=o-.5*Math.PI+e.columnSpacing/2,s=s-.5*Math.PI-1e-6-e.columnSpacing/2,P||C?(f=C?j.low:e.stackedValues.startValues[j.index],m=C?j.high:e.stackedValues.endValues[j.index],m=(m=T?re(0===m?1:m,i.logBase):m)>i.actualRange.max?i.actualRange.max:m):(f=i.visibleRange.min,m=j.yValue>i.actualRange.max?i.actualRange.max:j.yValue),c=I+(l=f===m?0:e.chart.radius*ye(m,i))*Math.cos(o),p=I+l*Math.cos(s),u=S+l*Math.sin(o),g=S+l*Math.sin(s),v=I+(y=e.chart.radius*ye(0===f&&0!==i.visibleRange.min?i.visibleRange.min:f,i))*Math.cos(o),b=S+y*Math.sin(o),w=I+y*Math.cos(s),x=S+y*Math.sin(s),A=O?"M "+c+" "+u+" A "+l+" "+l+" 0 "+M+" 1 "+p+" "+g+" L "+w+" "+x+" A "+y+" "+y+" 1 0 0 "+v+" "+b+" Z":"M "+c+" "+u+" L "+p+" "+g+" L "+w+" "+x+" L "+v+" "+b+" Z",j.regionData=new Me(h,d,y,l,a),n=this.triggerEvent(e.chart,e,j),r=new sf.svgbase.PathOption(e.chart.element.id+"_Series_"+e.index+"_Point_"+j.index,n.fill,n.border.width,n.border.color,e.opacity,e.dashArray,A),n.cancel||(this.appendLinePath(r,e,""),O?(j.symbolLocations.push({x:I+l*Math.cos(o+(s-o)/2),y:S+l*Math.sin(o+(s-o)/2)}),C&&j.symbolLocations.push({x:I+y*Math.cos(o+(s-o)/2),y:S+y*Math.sin(o+(s-o)/2)})):(j.symbolLocations.push({x:(c+p)/2,y:(u+g)/2}),C&&j.symbolLocations.push({x:(w+v)/2,y:(x+b)/2}))))}this.renderMarker(e),e.isRectSeries=!0},t.prototype.triggerEvent=function(e,t,i){var r={cancel:!1,name:"pointRender",series:t,point:i,fill:t.setPointColor(i,t.interior),border:t.setBorderColor(i,{width:t.border.width,color:t.border.color})};return e.trigger("pointRender",r),i.color=r.fill,r},t.prototype.getSeriesPosition=function(e){for(var t=[],i=[],r={rectCount:0,position:null},n=0,o=e.chart.visibleSeries;n<o.length;n++){var s=o[n];!s.visible||"Polar"!==s.type&&"Radar"!==s.type||-1===s.drawType.indexOf("Column")||t.push(s)}for(var a=0;a<t.length;a++){var l=t[a];-1!==l.drawType.indexOf("Stacking")?l.stackingGroup?void 0===i[l.stackingGroup]?(l.position=r.rectCount,i[l.stackingGroup]=r.rectCount++):l.position=i[l.stackingGroup]:null===r.position?(l.position=r.rectCount,r.position=r.rectCount++):l.position=r.position:l.position=r.rectCount++}for(a=0;a<t.length;a++){t[a].rectCount=r.rectCount}},t.prototype.doAnimation=function(e){var t=e.animation.duration,i=e.animation.delay,r=e.seriesElement.childNodes,n=1;if("Scatter"===e.drawType)for(var o=0,s=e.points;o<s.length;o++){var a=s[o];a.symbolLocations.length&&r[n]&&(ze(r[n],i,t,e,a.index,a.symbolLocations[0],!1),n++)}else for(n=1;n<r.length;n++)this.doPolarRadarAnimation(r[n],i,t,e)},t.prototype.doPolarRadarAnimation=function(e,t,i,r){var n=r.clipRect.width/2+r.clipRect.x,o=r.clipRect.height/2+r.clipRect.y,s=0;e.style.visibility="hidden",new sf.base.Animation({}).animate(e,{duration:i,delay:t,progress:function(t){t.timeStamp>t.delay&&(t.element.style.visibility="visible",s=(t.timeStamp-t.delay)/t.duration,e.setAttribute("transform","translate("+n+" "+o+") scale("+s+") translate("+-n+" "+-o+")"))},end:function(){e.style.visibility="visible",e.removeAttribute("transform"),r.chart.trigger("animationComplete",{series:r.chart.isBlazor?{}:r})}})},t.prototype.getPolarIsInversedPath=function(e,t){var i,r,n,o=this.chart.radius,s=t,a=e.isAxisInverse?"1 1 ":"1 0 ";return i=be(we(e.visibleLabels[0].value,e),this.startAngle),s+"L "+(r=this.centerX+o*i.x)+" "+(n=this.centerY+o*i.y)+" A "+o+" "+o+" 0 "+a+r+" "+(this.centerY+o)+" A "+o+" "+o+" 0 "+a+r+" "+n+" "},t.prototype.getModuleName=function(){return"PolarSeries"},t.prototype.destroy=function(){},t}(on),ln=(fi=function(e,t){return(fi=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}fi(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),hn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ln(t,e),t.prototype.render=function(e,t,i,r){for(var n=Ae(e.drawType),o=i.minimum,s=i.maximum,a=0,l=e.points;a<l.length;a++){var h=l[a];h.visible=h.visible&&!(!sf.base.isNullOrUndefined(o)&&h.yValue<o||!sf.base.isNullOrUndefined(s)&&h.yValue>s)}e.points.length&&(-1===e.drawType.indexOf("Column")?e.chart[n+"SeriesModule"].render(e,t,i,r):this.columnDrawTypeRender(e,t,i))},t.prototype.getRadarIsInversedPath=function(e,t){var i,r,n=this.chart.radius,o=e.visibleLabels.length,s=t;r=be(we(e.visibleLabels[0].value,e),this.startAngle),i=this.centerY+n*r.y,s+=" L "+(this.centerX+n*r.x)+" "+i+" ";for(var a=o-1;a>=0;a--)r=be(we(e.visibleLabels[a].value,e),this.startAngle),i=this.centerY+n*r.y,s+="L "+(this.centerX+n*r.x)+" "+i+" ";return s},t.prototype.getModuleName=function(){return"RadarSeries"},t.prototype.destroy=function(){},t}(an),dn=(mi=function(e,t){return(mi=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}mi(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),cn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return dn(t,e),t.prototype.render=function(e){for(var t,i,r=this.getSideBySideInfo(e),n=e.stackedValues,o=0,s=e.points;o<s.length;o++){var a=s[o];a.symbolLocations=[],a.regions=[],a.visible&&le(e.points[a.index-1],a,e.points[a.index+1],e)&&((t=this.getRectangle(a.xValue+r.start,n.endValues[a.index],a.xValue+r.end,n.startValues[a.index],e)).height=e.columnWidthInPixel?e.columnWidthInPixel:t.height,t.y=e.columnWidthInPixel?t.y-e.columnWidthInPixel/2:t.y,(i=this.triggerEvent(e,a,e.interior,{width:e.border.width,color:e.border.color})).cancel||(this.drawRectangle(e,a,t,i),this.updateSymbolLocation(a,t,e)))}this.renderMarker(e)},t.prototype.destroy=function(){},t.prototype.getModuleName=function(){return"StackingBarSeries"},t.prototype.doAnimation=function(e){this.animate(e)},t}(Gr),pn=(yi=function(e,t){return(yi=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}yi(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),un=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return pn(t,e),t.prototype.render=function(e){for(var t,i=this.getSideBySideInfo(e),r=Math.max(e.border.width,1),n=0,o=e.points;n<o.length;n++){var s=o[n],a="",l=void 0,h=void 0;s.regions=[],s.symbolLocations=[],s.visible&&le(e.points[s.index-1],s,e.points[s.index+1],e)&&(h=this.getRectangle(s.xValue+i.median,Math.max(s.high,s.low),s.xValue+i.median,Math.min(s.high,s.low),e),e.chart.requireInvertedAxis?(h.y-=r/2,h.height=r):(h.x-=r/2,h.width=r),l=this.getRectangle(s.xValue+i.start,Math.max(s.open,s.close),s.xValue+i.end,Math.min(s.open,s.close),e),a=this.getPathString(h,l,e),(t=this.triggerPointRenderEvent(e,s)).cancel||(this.drawCandle(e,s,l,t,a),this.updateSymbolLocation(s,h,e),this.updateSymbolLocation(s,l,e)))}},t.prototype.triggerPointRenderEvent=function(e,t){var i=this.getCandleColor(t,e),r={color:e.border.color,width:Math.max(e.border.width,1)};return this.triggerEvent(e,t,i,r)},t.prototype.getCandleColor=function(e,t){var i=t.points[e.index-1];return!1===t.enableSolidCandles?i&&i.close>e.close?t.bullFillColor:t.bearFillColor:e.open>e.close?t.bullFillColor:t.bearFillColor},t.prototype.getPathString=function(e,t,i){var r="",n=i.chart.requireInvertedAxis?e.y+e.height/2:e.x+e.width/2;return r=(r+=i.chart.requireInvertedAxis?"M "+e.x+" "+n+" L "+t.x+" "+n:"M "+n+" "+e.y+" L "+n+" "+t.y).concat(" M "+t.x+" "+t.y+" L "+(t.x+t.width)+" "+t.y+" L "+(t.x+t.width)+" "+(t.y+t.height)+" L "+t.x+" "+(t.y+t.height)+" Z"),r+=i.chart.requireInvertedAxis?" M "+(t.x+t.width)+" "+n+" L "+(e.x+e.width)+" "+n:" M "+n+" "+(t.y+t.height)+" L "+n+" "+(e.y+e.height)},t.prototype.drawCandle=function(e,t,i,r,n){if((e.chart.requireInvertedAxis?i.height:i.width)<=0)return null;var o=e.enableSolidCandles||t.open>t.close?r.fill:"transparent";r.border.color=r.fill;var s=new sf.svgbase.PathOption(e.chart.element.id+"_Series_"+e.index+"_Point_"+t.index,o,r.border.width,r.border.color,e.opacity,e.dashArray,n),a=Ge(s.id),l=a?a.getAttribute("d"):null,h=e.chart.renderer.drawPath(s,new Int32Array([e.clipRect.x,e.clipRect.y]));h.setAttribute("aria-label",t.x.toString()+":"+t.high.toString()+":"+t.low.toString()+":"+t.close.toString()+":"+t.open.toString()),e.chart.enableCanvas||e.seriesElement.appendChild(h),We(a,n,e.chart.redraw,l)},t.prototype.doAnimation=function(e){this.animate(e)},t.prototype.getModuleName=function(){return"CandleSeries"},t.prototype.destroy=function(){},t}(Gr),gn=(vi=function(e,t){return(vi=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}vi(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),fn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return gn(t,e),t.prototype.render=function(e){e.isRectSeries=!0;for(var t,i,r=this.getSideBySideInfo(e),n=e.stackedValues,o=ee(e),s=0,a=o;s<a.length;s++){var l=a[s];l.symbolLocations=[],l.regions=[],l.visible&&le(o[l.index-1],l,o[l.index+1],e)&&((t=this.getRectangle(l.xValue+r.start,n.endValues[l.index],l.xValue+r.end,n.startValues[l.index],e)).width=e.columnWidthInPixel?e.columnWidthInPixel:t.width,t.x=e.columnWidthInPixel?t.x-e.columnWidthInPixel/2:t.x,(i=this.triggerEvent(e,l,e.interior,{width:e.border.width,color:e.border.color})).cancel||(this.drawRectangle(e,l,t,i),this.updateSymbolLocation(l,t,e)))}this.renderMarker(e)},t.prototype.doAnimation=function(e){this.animate(e)},t.prototype.destroy=function(){},t.prototype.getModuleName=function(){return"StackingColumnSeries"},t}(Gr),mn=(bi=function(e,t){return(bi=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}bi(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),yn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return mn(t,e),t.prototype.render=function(e,t,i,r){var n,o,s,a="",l="M",h=null,d=this.enableComplexProperty(e);n="Category"===t.valueType&&"BetweenTicks"===t.labelPlacement?.5:0;for(var c=0,p=d;c<p.length;c++){var u=p[c];u.symbolLocations=[],u.regions=[],u.visible&&le(d[u.index-1],u,d[u.index+1],e)?(null!=h?(s=it(u.xValue,u.yValue,t,i,r),o=it(h.xValue,h.yValue,t,i,r),a=a.concat(l+" "+o.x+" "+o.y+" L "+s.x+" "+o.y+" L "+s.x+" "+s.y+" "),l="L"):(o=it(u.xValue-n,u.yValue,t,i,r),a=a.concat(l+" "+o.x+" "+o.y+" "),l="L"),this.storePointLocation(u,e,r,it),h=u):(h="Drop"===e.emptyPointSettings.mode?h:null,l="Drop"===e.emptyPointSettings.mode?l:"M")}d.length>0&&(o=it(d[d.length-1].xValue+n,d[d.length-1].yValue,t,i,r),a=a.concat(l+" "+o.x+" "+o.y+" "));var g=new sf.svgbase.PathOption(e.chart.element.id+"_Series_"+e.index,"transparent",e.width,e.interior,e.opacity,e.dashArray,a);this.appendLinePath(g,e,""),this.renderMarker(e)},t.prototype.doAnimation=function(e){var t=e.animation;this.doLinearAnimation(e,t)},t.prototype.destroy=function(){},t.prototype.getModuleName=function(){return"StepLineSeries"},t}(Yr),vn=(wi=function(e,t){return(wi=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}wi(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),bn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return vn(t,e),t.prototype.render=function(e,t,i,r){var n,o,s,a,l,h=null,d="",c=this.enableComplexProperty(e),p=c.length,u=Math.max(e.yAxis.visibleRange.min,0),g=null,f="";l="Category"===t.valueType&&"BetweenTicks"===t.labelPlacement?.5:0;for(var m=0;m<p;m++)a=(s=c[m]).xValue,s.symbolLocations=[],s.regions=[],s.visible&&le(c[m-1],s,c[m+1],e)&&(null===h&&(h=new jt(a,0),d+="M "+(n=it(a-l,u,t,i,r)).x+" "+n.y+" ",d+="L "+(n=it(a-l,s.yValue,t,i,r)).x+" "+n.y+" "),null!=g?(n=it(s.xValue,s.yValue,t,i,r),o=it(g.xValue,g.yValue,t,i,r),d+="L "+n.x+" "+o.y+" L "+n.x+" "+n.y+" "):"Gap"===e.emptyPointSettings.mode&&(d+="L "+(n=it(s.xValue,s.yValue,t,i,r)).x+" "+n.y+" "),this.storePointLocation(s,e,r,it),g=s),c[m+1]&&!c[m+1].visible&&"Drop"!==e.emptyPointSettings.mode&&(d+="L "+(n=it(a+l,u,t,i,r)).x+" "+n.y,h=null,g=null);p>1&&""!==d?(d+="L "+(o=it((h={x:c[p-1].xValue+l,y:c[p-1].yValue}).x,h.y,t,i,r)).x+" "+o.y+" ",d+="L "+(o=it((h={x:c[p-1].xValue+l,y:u}).x,h.y,t,i,r)).x+" "+o.y+" "):d="";var y=new sf.svgbase.PathOption(e.chart.element.id+"_Series_"+e.index,e.interior,0,"transparent",e.opacity,e.dashArray,d);if(this.appendLinePath(y,e,""),0!==e.border.width){f=this.removeEmptyPointsBorder(this.getBorderDirection(d));var v=new sf.svgbase.PathOption(e.chart.element.id+"_Series_border_"+e.index,"transparent",e.border.width,e.border.color?e.border.color:e.interior,1,e.dashArray,f);this.appendLinePath(v,e,"")}this.renderMarker(e)},t.prototype.doAnimation=function(e){var t=e.animation;this.doLinearAnimation(e,t)},t.prototype.destroy=function(){},t.prototype.getModuleName=function(){return"StepAreaSeries"},t}(Yr),wn=(xi=function(e,t){return(xi=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}xi(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),xn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return wn(t,e),t.prototype.render=function(e,t,i,r){var n,o,s,a,l="PolarRadar"===e.chart.chartAreaType,h=l?ve:it,d="",c=this.enableComplexProperty(e),p=c.length,u=e.stackedValues,g=l?Math.max(e.yAxis.visibleRange.min,u.endValues[0]):Math.max(e.yAxis.visibleRange.min,u.startValues[0]),f=0,m="";p>0&&(s=h(c[0].xValue,g,t,i,r,e),d=d.concat("M "+s.x+" "+s.y+" "));for(var y=e.chart&&"PolarRadar"===e.chart.chartAreaType,v=0;v<p;v++)if(n=c[v].index,c[v].symbolLocations=[],c[v].regions=[],c[v].visible&&le(c[v-1],c[v],c[v+1],e))s=h(c[v].xValue,u.endValues[n],t,i,r,e),d=d.concat("L "+s.x+" "+s.y+" "),c[v].symbolLocations.push(h(c[v].xValue,u.endValues[n],t,i,r,e)),c[v].regions.push(new sf.svgbase.Rect(c[v].symbolLocations[0].x-e.marker.width,c[v].symbolLocations[0].y-e.marker.height,2*e.marker.width,2*e.marker.height));else if(!y&&"Drop"!==e.emptyPointSettings.mode){for(var b=v-1;b>=f;b--)n=c[b].index,a=h(c[b].xValue,u.startValues[n],t,i,r,e),d=d.concat("L "+a.x+" "+a.y+" ");c[v+1]&&c[v+1].visible&&(!y||y&&this.withinYRange(c[v+1],i))&&(o=c[v+1].index,s=h(c[v+1].xValue,u.startValues[o],t,i,r,e),d=d.concat("M "+s.x+" "+s.y+" ")),f=v+1}if("PolarRadar"===e.chart.chartAreaType&&c.length>1){var w=this.getFirstLastVisiblePoint(e.points),x=this.chart;d+="L "+(a=h((s={x:w.first.xValue,y:u.endValues[w.first.index]}).x,s.y,t,i,r,e)).x+" "+a.y+" ",1===this.chart.visible&&(t.isAxisInverse||i.isAxisInverse)&&(this.chart.enableAnimation=!1,d="Polar"===e.type?x.polarSeriesModule.getPolarIsInversedPath(t,d):x.radarSeriesModule.getRadarIsInversedPath(t,d))}if(!y||y&&e.index!==this.getFirstSeriesIndex(e.chart.visibleSeries))for(b=p-1;b>=f;b--)if(n=c[b].index,!y||c[b].visible){var M=this.getPreviousSeries(e);"Drop"===M.emptyPointSettings.mode&&M.points[b].isEmpty||(a=h(c[b].xValue,u.startValues[n],t,i,r,e),u.startValues[n]===u.endValues[n]&&(a.y=Math.floor(a.y)),d=d.concat((b===p-1&&l?"M":"L")+" "+a.x+" "+a.y+" "))}var N=new sf.svgbase.PathOption(e.chart.element.id+"_Series_"+e.index,e.interior,0,"transparent",e.opacity,e.dashArray,d);if(this.appendLinePath(N,e,""),0!==e.border.width){m=this.removeEmptyPointsBorder(this.getBorderDirection(d));var I=new sf.svgbase.PathOption(e.chart.element.id+"_Series_border_"+e.index,"transparent",e.border.width,e.border.color?e.border.color:e.interior,1,e.dashArray,m);this.appendLinePath(I,e,"")}this.renderMarker(e)},t.prototype.doAnimation=function(e){var t=e.animation;this.doLinearAnimation(e,t)},t.prototype.destroy=function(){},t.prototype.getModuleName=function(){return"StackingAreaSeries"},t.prototype.getPreviousSeries=function(e){for(var t=e.chart.visibleSeries,i=0,r=t.length;i<r;i++)if(e.index===t[i].index&&0!==i)return t[i-1];return t[0]},t.prototype.getFirstSeriesIndex=function(e){for(var t=0,i=e;t<i.length;t++){var r=i[t];if(r.visible)return r.index}return 0},t}(Yr),Mn=(Mi=function(e,t){return(Mi=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}Mi(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),Nn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Mn(t,e),t.prototype.render=function(e,t,i,r){var n,o,s,a,l,h,d,c,p,u,g=null,f="",m=e.stackedValues,y=this.enableComplexProperty(e),v=Math.max(e.yAxis.visibleRange.min,m.startValues[0]),b=y.length,w=null,x=0,M="";c="Category"===t.valueType&&"BetweenTicks"===t.labelPlacement?.5:0;for(var N=0;N<b;N++)if(d=(a=y[N]).xValue,a.symbolLocations=[],a.regions=[],u=a.index,a.visible&&le(y[N-1],a,y[N+1],e)&&(null===g&&(g=new jt(d,0),f+="M "+(n=it(d-c,v,t,i,r)).x+" "+n.y+" ",f+="L "+(n=it(d-c,m.endValues[u],t,i,r)).x+" "+n.y+" "),null!=w?(n=it(a.xValue,m.endValues[u],t,i,r),o=it(w.xValue,m.endValues[w.index],t,i,r),f+="L "+n.x+" "+o.y+" L "+n.x+" "+n.y+" "):"Gap"===e.emptyPointSettings.mode&&(f+="L "+(n=it(a.xValue,m.endValues[u],t,i,r)).x+" "+n.y+" "),y[N].symbolLocations.push(it(y[N].xValue,m.endValues[u],t,i,r)),y[N].regions.push(new sf.svgbase.Rect(y[N].symbolLocations[0].x-e.marker.width,y[N].symbolLocations[0].y-e.marker.height,2*e.marker.width,2*e.marker.height)),w=a),y[N+1]&&!y[N+1].visible&&"Drop"!==e.emptyPointSettings.mode){for(var I=void 0,S=N;S>=x;S--)u=y[S].index,I=0===S?0:y[S-1].index,0!==S&&(m.startValues[u]<m.startValues[I]||m.startValues[u]>m.startValues[I])?(n=it(y[u].xValue,m.startValues[u],t,i,r),f=f.concat("L "+n.x+" "+n.y+" "),n=it(y[u].xValue,m.startValues[I],t,i,r)):n=it(y[u].xValue,m.startValues[u],t,i,r),f=f.concat("L "+n.x+" "+n.y+" ");x=N+1,g=null,w=null}if(""!==f){b>1&&(u=y[b-1].index,f+="L "+(o=it((g={x:y[b-1].xValue+c,y:m.endValues[u]}).x,g.y,t,i,r)).x+" "+o.y+" ",f+="L "+(o=it((g={x:y[b-1].xValue+c,y:m.startValues[u]}).x,g.y,t,i,r)).x+" "+o.y+" ");for(S=b-1;S>=x;S--){var C=void 0;y[S].visible&&(u=y[S].index,l=it(y[S].xValue,m.startValues[u],t,i,r),f=f.concat("L "+l.x+" "+l.y+" ")),0===S||y[S-1].visible||(C=this.getNextVisiblePointIndex(y,S)),0!==S&&(p=C||S-1,u=C?y[C].index:y[S-1].index,h=it(y[p].xValue,m.startValues[u],t,i,r),f=f.concat("L "+l.x+" "+h.y+" "))}s=new sf.svgbase.PathOption(e.chart.element.id+"_Series_"+e.index,e.interior,0,"transparent",e.opacity,e.dashArray,f),this.appendLinePath(s,e,""),0!==e.border.width&&(M=this.removeEmptyPointsBorder(this.getBorderDirection(f)),s=new sf.svgbase.PathOption(e.chart.element.id+"_Series_border_"+e.index,"transparent",e.border.width,e.border.color?e.border.color:e.interior,1,e.dashArray,M),this.appendLinePath(s,e,"")),this.renderMarker(e)}},t.prototype.doAnimation=function(e){var t=e.animation;this.doLinearAnimation(e,t)},t.prototype.destroy=function(){},t.prototype.getModuleName=function(){return"StackingStepAreaSeries"},t.prototype.getNextVisiblePointIndex=function(e,t){var i;for(i=t-1;i>=0;i--)if(e[i].visible)return i;return 0},t}(Yr),In=(Ni=function(e,t){return(Ni=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}Ni(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),Sn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return In(t,e),t.prototype.render=function(e,t,i,r){for(var n,o,s,a,l="PolarRadar"===e.chart.chartAreaType?ve:it,h="",d=this.enableComplexProperty(e),c=d.length,p=e.stackedValues,u=0;u<c;u++)d[u].regions=[],d[u].symbolLocations=[],n=d[u].index,d[u].visible&&le(d[u-1],d[u],d[u+1],e)?(s=l(d[u].xValue,p.endValues[n],t,i,r,e),h=h.concat((u?"L":"M")+" "+s.x+" "+s.y+" "),d[u].symbolLocations.push(l(d[u].xValue,p.endValues[n],t,i,r,e)),d[u].regions.push(new sf.svgbase.Rect(d[u].symbolLocations[0].x-e.marker.width,d[u].symbolLocations[0].y-e.marker.height,2*e.marker.width,2*e.marker.height))):"Drop"!==e.emptyPointSettings.mode&&d[u+1]&&d[u+1].visible&&(o=d[u+1].index,s=l(d[u+1].xValue,p.endValues[o],t,i,r,e),h=h.concat("M "+s.x+" "+s.y+" "));"PolarRadar"===e.chart.chartAreaType&&d.length>1&&(h+="L "+(a=l((s={y:p.endValues[0],x:e.points[0].xValue}).x,s.y,t,i,r,e)).x+" "+a.y+" ");var g=new sf.svgbase.PathOption(e.chart.element.id+"_Series_"+e.index,"none",e.width,e.interior,e.opacity,e.dashArray,h);this.appendLinePath(g,e,""),this.renderMarker(e)},t.prototype.doAnimation=function(e){var t=e.animation;this.doLinearAnimation(e,t)},t.prototype.destroy=function(){},t.prototype.getModuleName=function(){return"StackingLineSeries"},t}(Yr),Cn=function(){function e(){}return e.prototype.render=function(e,t,i,r){e.isRectSeries=!1;for(var n,o,s=e.marker,a=this.enableComplexProperty(e),l="PolarRadar"===e.chart.chartAreaType?ve:it,h=e.chart.redraw,d={width:this.isLineShapeMarker(s.shape)?e.width:e.border.width,color:this.isLineShapeMarker(s.shape)?e.interior:e.border.color},c=0,p=a;c<p.length;c++){var u=p[c];o=h&&u.symbolLocations?u.symbolLocations[0]:null,u.symbolLocations=[],u.regions=[],u.visible&&le(a[u.index-1],u,a[u.index+1],e)&&(n={cancel:!1,name:"pointRender",series:e,point:u,fill:e.setPointColor(u,e.interior),border:e.setBorderColor(u,d),height:s.height,width:s.width,shape:s.shape},e.chart.trigger("pointRender",n),n.cancel?u.marker={visible:!0}:(u.symbolLocations.push(l(u.xValue,u.yValue,t,i,r,e)),u.color=n.fill,this.refresh(e,u,n,o)))}},e.prototype.isLineShapeMarker=function(e){return"HorizontalLine"===e||"VerticalLine"===e},e.prototype.enableComplexProperty=function(e){for(var t,i=[],r=[],n=e.yAxis.visibleRange,o=e.xAxis.visibleRange,s=e.clipRect,a=e.points,l=Math.abs(n.delta/s.height),h=Math.abs(o.delta/s.width),d=a[0]&&a[0].y>l?0:l,c=a[0]&&a[0].x>h?0:h,p=0,u=0,g=0,f=a;g<f.length;g++){var m=f[g];m.symbolLocations=[],p=m.yValue?m.yValue:n.min,u=m.xValue?m.xValue:o.min,(Math.abs(d-p)>=l||Math.abs(c-u)>=h)&&(r.push(m),d=p,c=u)}for(var y=0;y<r.length;y++)t=r[y],sf.base.isNullOrUndefined(t.x)||""===t.x||i.push(t);return i},e.prototype.refresh=function(e,t,i,r){var n,o,s=e.chart,a=e.marker,l=i.point.marker.imageUrl||a.imageUrl,h=new sf.svgbase.PathOption(s.element.id+"_Series_"+e.index+"_Point_"+t.index,i.fill,i.border.width,i.border.color,e.opacity,null);s.redraw&&Ge(h.id)&&(n="Circle"===i.shape?"c":"",o=Ge(h.id).getAttribute("d")),nt(e.chart.enableCanvas,e.seriesElement,Ve(t.symbolLocations[0],i.shape,new sf.svgbase.Size(i.width,i.height),l,h,(t.x.toString(),t.yValue.toString()),e.chart.svgRenderer,e.clipRect),s.redraw,!0,n+"x",n+"y",r,o),t.regions.push(new sf.svgbase.Rect(t.symbolLocations[0].x-a.width,t.symbolLocations[0].y-a.height,2*a.width,2*a.height)),t.marker={border:i.border,fill:i.fill,height:i.height,visible:!0,width:i.width,shape:i.shape,imageUrl:l},e.chart.enableCanvas&&e.chart.markerRender.render(e)},e.prototype.doAnimation=function(e){for(var t=e.animation.duration,i=e.animation.delay,r=e.seriesElement.childNodes,n=1,o=0,s=e.points;o<s.length;o++){var a=s[o];a.symbolLocations.length&&r[n]&&(ze(r[n],i,t,e,a.index,a.symbolLocations[0],!1),n++)}},e.prototype.getModuleName=function(){return"ScatterSeries"},e.prototype.destroy=function(){},e}(),On=(Ii=function(e,t){return(Ii=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}Ii(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),Tn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return On(t,e),t.prototype.render=function(e){for(var t,i,r=this.getSideBySideInfo(e),n=0,o=e.points;n<o.length;n++){var s=o[n];s.symbolLocations=[],s.regions=[],s.visible&&le(e.points[s.index-1],s,e.points[s.index+1],e)&&((t=this.getRectangle(s.xValue+r.start,s.high,s.xValue+r.end,s.low,e)).width=e.columnWidthInPixel?e.columnWidthInPixel:t.width,t.x=e.columnWidthInPixel?t.x-(e.columnWidthInPixel/2*e.rectCount-e.columnWidthInPixel*e.index):t.x,(i=this.triggerEvent(e,s,e.interior,{width:e.border.width,color:e.border.color})).cancel||(this.updateSymbolLocation(s,t,e),this.drawRectangle(e,s,t,i)))}this.renderMarker(e)},t.prototype.getModuleName=function(){return"RangeColumnSeries"},t.prototype.doAnimation=function(e){this.animate(e)},t.prototype.destroy=function(){},t}(Gr),Pn=(Si=function(e,t){return(Si=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}Si(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),An=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Pn(t,e),t.prototype.render=function(e){for(var t,i,r,n,o=this.getSideBySideInfo(e),s=Math.max(e.yAxis.visibleRange.min,0),a=0,l="",h=0,d=null,c=e.chart.requireInvertedAxis,p=0,u=e.chart.redraw,g=0,f=e.points;g<f.length;g++){var m=f[g];if(m.symbolLocations=[],m.regions=[],m.visible&&le(e.points[m.index-1],m,e.points[m.index+1],e)){var y=this.isIntermediateSum(e,m.index),v=this.isSumIndex(e,m.index);h+=y||!0===v?0:m.yValue,r=!0===y?p:null===a||v?s:a,t=this.getRectangle(m.xValue+o.start,h,m.xValue+o.end,r,e),y&&(p=h),a=h,(i=this.triggerPointRenderEvent(e,m)).cancel||(this.updateSymbolLocation(m,t,e),this.drawRectangle(e,m,t,i));var b=m.regions[0];if(null!==d){var w=c?d.x:d.y,x=c?b.x:b.y,M=void 0,N=void 0,I=b.y,S=b.x,C=e.points[m.index-1];0===m.yValue?(M=c?d.x+d.width:d.y+d.height,N=c?m.symbolLocations[0].x:m.symbolLocations[0].y):(M=c?0===C.yValue?C.symbolLocations[0].x:d.x+d.width:0===C.yValue?C.symbolLocations[0].y:d.y+d.height,N=c?b.x+b.width:b.y+b.height),Math.round(w)===Math.round(x)||Math.round(M)===Math.round(x)?(n=c?0===b.x&&0===d.x?N:b.x:b.y,n=0===m.yValue?c?m.symbolLocations[0].x:m.symbolLocations[0].y:n):n=N,c?(0===C.yValue&&(d.y=d.y+d.height/2+t.height/2-d.height),0===m.yValue&&(I=b.y+b.height/2-t.height/2),l=l.concat("M "+n+" "+(d.y+d.height)+" L "+n+" "+I+" ")):(0===C.yValue&&(d.x=d.x+d.width/2-t.width/2,S=b.x+b.width/2+t.width/2-b.width),l=l.concat("M "+d.x+" "+n+" L "+(S+b.width)+" "+n+" "))}d=m.regions[0]}}var O=new sf.svgbase.PathOption(e.chart.element.id+"_Series_"+e.index+"_Connector_","none",e.connector.width,e.connector.color,e.opacity,e.connector.dashArray,l);u&&Ge(O.id)&&(l=Ge(O.id).getAttribute("d"));var T=Mt(u,O.id,O,e.chart.renderer)||e.chart.renderer.drawPath(O,new Int32Array([e.clipRect.x,e.clipRect.y]));T.style.visibility=e.chart.enableCanvas?null:e.animation.enable&&e.chart.animateSeries?"hidden":"visible",nt(e.chart.enableCanvas,e.seriesElement,T,u,!0,null,null,null,l),this.renderMarker(e)},t.prototype.isIntermediateSum=function(e,t){return void 0!==e.intermediateSumIndexes&&-1!==e.intermediateSumIndexes.indexOf(t)},t.prototype.isSumIndex=function(e,t){return void 0!==e.sumIndexes&&-1!==e.sumIndexes.indexOf(t)},t.prototype.triggerPointRenderEvent=function(e,t){var i,r=this.isIntermediateSum(e,t.index),n=this.isSumIndex(e,t.index);return i=r||n?e.summaryFillColor:t.y<0?e.negativeFillColor:e.interior,this.triggerEvent(e,t,i,{color:e.border.color,width:e.border.width})},t.prototype.processInternalData=function(e,t){var i,r=e,n=0,o=t.intermediateSumIndexes,s=t.sumIndexes;if(void 0!==o&&o.length>0)for(var a=0;a<o.length;a++)for(var l=0;l<r.length;l++)l===o[a]&&(i=de(r,0===a?-1:o[a-1],o[a],null,t),r[l][t.yName]=i);if(void 0!==s&&s.length>0)for(var h=0;h<s.length;h++)for(l=0;l<r.length;l++)l===s[h]&&(n+=i=void 0!==o?de(r,o[h]-1,s[h],s,t):de(r,0===h?-1:s[h-1],s[h],null,t),r[l][t.yName]=n);return r},t.prototype.doAnimation=function(e){this.animate(e)},t.prototype.getModuleName=function(){return"WaterfallSeries"},t.prototype.destroy=function(){},t}(Gr),Ln=(Ci=function(e,t){return(Ci=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}Ci(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),Fn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Ln(t,e),t.prototype.render=function(e){for(var t,i,r=this.getSideBySideInfo(e),n=0,o=e.points;n<o.length;n++){var s=o[n];s.symbolLocations=[],s.regions=[],s.visible&&le(e.points[s.index-1],s,e.points[s.index+1],e)&&(t=this.getRectangle(s.xValue+r.median,s.high,s.xValue+r.median,s.low,e),(i=this.triggerPointRenderEvent(e,s)).cancel||(e.chart.requireInvertedAxis?(t.height=i.border.width,t.y=t.y-t.height/2):(t.width=i.border.width,t.x=t.x-t.width/2),i.border.width=0,this.updateSymbolLocation(s,t,e),this.drawRectangle(e,s,t,i)))}},t.prototype.triggerPointRenderEvent=function(t,i){var r={color:t.fill,width:Math.max(t.border.width,2)};return e.prototype.triggerEvent.call(this,t,i,t.interior,r)},t.prototype.getModuleName=function(){return"HiloSeries"},t.prototype.doAnimation=function(e){this.animate(e)},t.prototype.destroy=function(){},t}(Gr),Dn=(Oi=function(e,t){return(Oi=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}Oi(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),En=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Dn(t,e),t.prototype.render=function(e){for(var t,i,r,n,o=this.getSideBySideInfo(e),s=Math.max(e.border.width,2),a=0,l=e.points;a<l.length;a++){var h=l[a];if(h.symbolLocations=[],h.regions=[],h.visible&&le(e.points[h.index-1],h,e.points[h.index+1],e)){if(t=this.getRectangle(h.xValue+o.start,Math.max(h.high,h.low),h.xValue+o.end,Math.min(h.high,h.low),e),h.regions.push(this.getRectangle(h.xValue+o.median,Math.max(h.high,h.low),h.xValue+o.median,Math.min(h.high,h.low),e)),this.updateTickRegion(!e.chart.requireInvertedAxis,h.regions[0],s),h.regions.push(this.getRectangle(h.xValue+o.start,Math.max(h.open,h.close),h.xValue+o.median,Math.max(h.open,h.close),e)),h.regions.push(this.getRectangle(h.xValue+o.median,Math.min(h.open,h.close),h.xValue+o.end,Math.min(h.open,h.close),e)),!(n=this.triggerPointRenderEvent(e,h)).cancel){this.updateSymbolLocation(h,h.regions[0],e),i=h.open>h.close?1:2,r=h.open>h.close?2:1;var d={x:h.regions[i].x,y:h.regions[i].y},c={x:h.regions[r].x,y:h.regions[r].y};this.drawHiloOpenClosePath(e,h,d,c,t,n)}this.updateTickRegion(e.chart.requireInvertedAxis,h.regions[1],s),this.updateTickRegion(e.chart.requireInvertedAxis,h.regions[2],s)}}},t.prototype.updateTickRegion=function(e,t,i){e?(t.x-=i/2,t.width=i):(t.y-=i/2,t.height=i)},t.prototype.triggerPointRenderEvent=function(e,t){var i=t.open<=t.close?e.bearFillColor:e.bullFillColor,r={color:e.border.color,width:Math.max(e.border.width,1)};return this.triggerEvent(e,t,i,r)},t.prototype.drawHiloOpenClosePath=function(e,t,i,r,n,o){var s;e.chart.requireInvertedAxis?(s="M "+n.x+" "+(n.y+n.height/2)+" L "+(n.x+n.width)+" "+(n.y+n.height/2)+" ",s+="M "+i.x+" "+(n.y+n.height/2)+" L "+i.x+" "+(n.y+n.height)+" ",s+="M "+r.x+" "+(n.y+n.height/2)+" L "+r.x+" "+n.y+" "):(s="M "+(n.x+n.width/2)+" "+(n.y+n.height)+" L "+(n.x+n.width/2)+" "+n.y+" ",s+="M "+n.x+" "+i.y+" L "+(n.x+n.width/2)+" "+i.y+" ",s+="M "+(n.x+n.width/2)+" "+r.y+" L "+(n.x+n.width)+" "+r.y+" ");var a=new sf.svgbase.PathOption(e.chart.element.id+"_Series_"+e.index+"_Point_"+t.index,o.fill,o.border.width,o.fill,e.opacity,e.dashArray,s);We(Ge(a.id),s,e.chart.redraw);var l=e.chart.renderer.drawPath(a,new Int32Array([e.clipRect.x,e.clipRect.y]));l.setAttribute("aria-label",t.x.toString()+":"+t.high.toString()+":"+t.low.toString()+":"+t.close.toString()+":"+t.open.toString()),e.chart.enableCanvas||e.seriesElement.appendChild(l)},t.prototype.getModuleName=function(){return"HiloOpenCloseSeries"},t.prototype.doAnimation=function(e){this.animate(e)},t.prototype.destroy=function(){},t}(Gr),zn=(Ti=function(e,t){return(Ti=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}Ti(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),kn=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.borderDirection="",t}return zn(t,e),t.prototype.render=function(e,t,i,r){for(var n,o="",s="M",a=void 0,l=e.border.width?e.border.width:0,h=e.border.color?e.border.color:e.interior,d=this.enableComplexProperty(e),c=0,p=d.length;c<p;c++){(n=d[c]).symbolLocations=[],n.regions=[];var u=Math.min(n.low,n.high),g=Math.max(n.low,n.high);if(i.isAxisInverse){var f=u;u=g,g=f}var m=it(n.xValue,u,t,i,r),y=it(n.xValue,g,t,i,r);n.symbolLocations.push(y),n.symbolLocations.push(m);var v=new sf.svgbase.Rect(Math.min(m.x,y.x),Math.min(m.y,y.y),Math.max(Math.abs(y.x-m.x),e.marker.width),Math.max(Math.abs(y.y-m.y),e.marker.width));r?v.y-=e.marker.width/2:v.x-=e.marker.width/2,n.regions.push(v),n.visible&&le(d[n.index-1],n,d[n.index+1],e)?(o=o.concat(s+" "+m.x+" "+m.y+" "),this.borderDirection+=s+" "+m.x+" "+m.y+" ",a=!1,(c+1<d.length&&!d[c+1].visible||c===d.length-1)&&(s="M",o=(o=this.closeRangeAreaPath(d,n,e,o,c)).concat(" Z"),a=!0),s="L"):(!1===a&&0!==c&&(o=this.closeRangeAreaPath(d,n,e,o,c),a=!0),s="M",n.symbolLocations=[])}var b="Indicator"===e.category?e.chart.element.id+"_Indicator_"+e.index+"_"+e.name:e.chart.element.id+"_Series_"+e.index,w=new sf.svgbase.PathOption(b,e.interior,0,"transparent",e.opacity,e.dashArray,o);this.appendLinePath(w,e,""),0!==e.border.width&&(this.appendLinePath(new sf.svgbase.PathOption(e.chart.element.id+"_Series_border_"+e.index,"transparent",l,h,1,e.dashArray,this.borderDirection),e,""),this.borderDirection=""),this.renderMarker(e)},t.prototype.closeRangeAreaPath=function(e,t,i,r,n){for(var o=n;o>=0&&(e[o].visible&&e[o].symbolLocations[0]);o--)r+="L "+(t=e[o]).symbolLocations[0].x+" "+t.symbolLocations[0].y+" ",this.borderDirection+=(o===n?"M":"L")+" "+t.symbolLocations[0].x+" "+t.symbolLocations[0].y+" ";return r},t.prototype.doAnimation=function(e){var t=e.animation;this.doLinearAnimation(e,t)},t.prototype.getModuleName=function(){return"RangeAreaSeries"},t.prototype.destroy=function(){},t}(Yr),Wn=(Pi=function(e,t){return(Pi=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}Pi(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),Rn=function(e){function t(t){var i=e.call(this,t)||this;return i.splinePoints=[],i.lowSplinePoints=[],i}return Wn(t,e),t.prototype.findSplinePoint=function(e){var t,i,r,n,o=[],s=0;r=this.filterEmptyPoints(e);for(var a=0;a<r.length;a++)null!==(n=r[a]).x&&""!==n.x&&(n.index=s,s++,o.push(n));var l=!1;if(this.splinePoints=this.findSplineCoefficients(o,e,l),"SplineRangeArea"===e.type&&(l=!l,this.lowSplinePoints=this.findSplineCoefficients(o,e,l)),o.length>1){e.drawPoints=[],e.lowDrawPoints=[];for(var h=0,d=o;h<d.length;h++){var c=d[h];if(0!==c.index){var p=this.getPreviousIndex(o,c.index-1,e);"SplineRangeArea"===e.type&&(o[p].yValue=o[p].high>o[p].low?o[p].high:o[p].low,c.yValue=c.high>c.low?c.high:c.low),t=this.getControlPoints(o[p],c,this.splinePoints[p],this.splinePoints[c.index],e),e.drawPoints.push(t),"SplineRangeArea"===e.type&&(o[p].yValue=o[p].low<o[p].high?o[p].low:o[p].high,c.yValue=c.low<c.high?c.low:c.high,i=this.getControlPoints(o[p],c,this.lowSplinePoints[p],this.lowSplinePoints[c.index],e),e.lowDrawPoints.push(i));var u=e.yMax-e.yMin;c.yValue&&t.controlPoint1.y&&t.controlPoint2.y&&u>1&&(e.yMin=Math.min(e.yMin,c.yValue,t.controlPoint1.y,t.controlPoint2.y),e.yMax=Math.ceil(Math.max(e.yMax,c.yValue,t.controlPoint1.y,t.controlPoint2.y)),e.yMin="Logarithmic"!==e.yAxis.valueType?Math.floor(e.yMin):e.yMin)}}"PolarRadar"===e.chart.chartAreaType&&e.isClosed&&(t=this.getControlPoints({xValue:o[o.length-1].xValue,yValue:o[o.length-1].yValue},{xValue:o[o.length-1].xValue+1,yValue:o[0].yValue},this.splinePoints[0],this.splinePoints[o[o.length-1].index],e),e.drawPoints.push(t))}},t.prototype.getPreviousIndex=function(e,t,i){if("Drop"!==i.emptyPointSettings.mode)return t;for(;sf.base.isNullOrUndefined(e[t])&&t>-1;)t-=1;return t},t.prototype.getNextIndex=function(e,t,i){if("Drop"!==i.emptyPointSettings.mode)return t;for(;sf.base.isNullOrUndefined(e[t])&&t<e.length;)t+=1;return t},t.prototype.filterEmptyPoints=function(e,t){if("Drop"!==e.emptyPointSettings.mode&&this.isPointInRange(e.points))return t||e.points;for(var i=t||sf.base.extend([],e.points,null,!0),r=0;r<i.length;r++)i[r].index=r,i[r].isEmpty&&(i[r].symbolLocations=[],i[r].regions=[],i.splice(r,1),r--);return i},t.prototype.isPointInRange=function(e){for(var t=0,i=e;t<i.length;t++){if(!i[t].isPointInRange)return!1}return!0},t.prototype.findSplineCoefficients=function(e,t,i){var r=[],n=t.cardinalSplineTension?t.cardinalSplineTension:.5;switch(n=n<0?0:n>1?1:n,t.splineType){case"Monotonic":r=this.monotonicSplineCoefficients(e,t,i);break;case"Cardinal":r=this.cardinalSplineCofficients(e,t,i);break;default:"Clamped"===t.splineType?r=this.clampedSplineCofficients(e,t,i):(r[0]=[][0]=0,r[e.length-1]=0),r=this.naturalSplineCoefficients(e,t,i)}return r},t.prototype.monotonicSplineCoefficients=function(e,t,i){for(var r,n=e.length,o=[],s=[],a=[],l=[],h=0;h<n-1;h++)"SplineRangeArea"===t.type&&(i||(e[h+1].yValue=e[h+1].high>e[h+1].low?e[h+1].high:e[h+1].low,e[h].yValue=e[h].high>e[h].low?e[h].high:e[h].low),i&&(e[h+1].yValue=e[h+1].low<e[h+1].high?e[h+1].low:e[h+1].high,e[h].yValue=e[h].low<e[h].high?e[h].low:e[h].high)),s[h]=e[h+1].xValue-e[h].xValue,a[h]=e[h+1].yValue-e[h].yValue,l[h]=a[h]/s[h];var d=l.length;o[0]=l[0],o[n-1]=l[d-1];for(var c=0;c<s.length;c++)d>c+1&&(l[c]*l[c+1]<=0?o[c+1]=0:(r=s[c]+s[c+1],o[c+1]=3*r/((r+s[c+1])/l[c]+(r+s[c])/l[c+1])));return o},t.prototype.cardinalSplineCofficients=function(e,t,i){var r=e.length,n=[],o=t.cardinalSplineTension?t.cardinalSplineTension:.5;o=o<0?0:o>1?1:o;for(var s=0;s<r;s++)n[s]=0===s?r>2?o*(e[s+2].xValue-e[s].xValue):0:s===r-1?r>2?o*(e[r-1].xValue-e[r-3].xValue):0:o*(e[s+1].xValue-e[s-1].xValue);return n},t.prototype.clampedSplineCofficients=function(e,t,i){for(var r=e.length,n=[],o=[],s=0;s<r-1;s++)"SplineRangeArea"===t.type&&(i||(e[1].yValue=e[1].high>e[1].low?e[1].high:e[1].low,e[0].yValue=e[0].high>e[0].low?e[0].high:e[0].low,e[e.length-1].yValue=e[e.length-1].high>e[e.length-1].low?e[e.length-1].high:e[e.length-1].low,e[e.length-2].yValue=e[e.length-2].high>e[e.length-2].low?e[e.length-2].high:e[e.length-2].low),i&&(e[1].yValue=e[1].low<e[1].high?e[1].low:e[1].high,e[0].yValue=e[0].low<e[0].high?e[0].low:e[0].high,e[e.length-1].yValue=e[e.length-1].low<e[e.length-1].high?e[e.length-1].low:e[e.length-1].high,e[e.length-2].yValue=e[e.length-2].low<e[e.length-2].high?e[e.length-2].low:e[e.length-2].high)),n[0]=3*(e[1].yValue-e[0].yValue)/(e[1].xValue-e[0].xValue)-3,o[0]=.5,n[e.length-1]=3*(e[e.length-1].yValue-e[e.length-2].yValue)/(e[e.length-1].xValue-e[e.length-2].xValue),n[0]=o[0]=Math.abs(n[0])===1/0?0:n[0],n[e.length-1]=o[e.length-1]=Math.abs(n[e.length-1])===1/0?0:n[e.length-1];return n},t.prototype.naturalSplineCoefficients=function(e,t,i){var r,n,o,s,a,l=e.length,h=[],d=[];h[0]=d[0]=0,h[e.length-1]=0;for(var c=1;c<l-1;c++)if("SplineRangeArea"===t.type&&(i||(e[c+1].yValue=e[c+1].low>e[c+1].high?e[c+1].low:e[c+1].high,e[c].yValue=e[c].low>e[c].high?e[c].low:e[c].high,e[c-1].yValue=e[c-1].low>e[c-1].high?e[c-1].low:e[c-1].high),i&&(e[c+1].yValue=e[c+1].high<e[c+1].low?e[c+1].high:e[c+1].low,e[c].yValue=e[c].high<e[c].low?e[c].high:e[c].low,e[c-1].yValue=e[c-1].high<e[c-1].low?e[c-1].high:e[c-1].low)),o=e[c].xValue-e[c-1].xValue,s=e[c+1].xValue-e[c-1].xValue,a=e[c+1].xValue-e[c].xValue,r=e[c+1].yValue-e[c].yValue||null,n=e[c].yValue-e[c-1].yValue||null,0===o||0===s||0===a)h[c]=0,d[c]=0;else{var p=1/(o*h[c-1]+2*s);h[c]=-p*a,d[c]=p*(6*(r/a-n/o)-o*d[c-1])}for(var u=l-2;u>=0;u--)h[u]=h[u]*h[u+1]+d[u];return h},t.prototype.getControlPoints=function(e,t,i,r,n){var o,s,a,l=i,h=r,d=e.xValue,c=e.yValue,p=t.xValue,u=t.yValue;switch(n.splineType){case"Cardinal":"DateTime"===n.xAxis.valueType&&(l=i/this.dateTimeInterval(n),h=r/this.dateTimeInterval(n)),o=new jt(d+i/3,c+l/3),s=new jt(p-r/3,u-h/3),a=new Yt(o,s);break;case"Monotonic":var g=(p-d)/3;o=new jt(d+g,c+i*g),s=new jt(p-g,u-r*g),a=new Yt(o,s);break;default:var f=p-d,m=1/3*(c+2*u-1/3*(f*=f)*(.5*i+r));o=new jt((2*d+p)*(1/3),1/3*(2*c+u-1/3*f*(i+.5*r))),s=new jt((d+2*p)*(1/3),m),a=new Yt(o,s)}return a},t.prototype.dateTimeInterval=function(e){var t=e.xAxis.actualIntervalType;return"Years"===t?31536e6:"Months"===t?2592e6:"Days"===t?864e5:"Hours"===t?36e5:"Minutes"===t?6e4:"Seconds"===t?1e3:2592e6},t.prototype.doAnimation=function(e){var t=e.animation;this.doLinearAnimation(e,t)},t}(Yr),jn=(Ai=function(e,t){return(Ai=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}Ai(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),Un=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.borderDirection="",t}return jn(t,e),t.prototype.render=function(e,t,i,r){var n,o,s,a,l,h,d,c,p,u="",g=void 0,f=null,m=[],y=0,v=e.border.width?e.border.width:0,b=e.border.color?e.border.color:e.interior,w="";d=this.filterEmptyPoints(e);for(var x=0;x<d.length;x++)null!==(n=d[x]).x&&""!==n.x&&(n.index=y,y++,m.push(n));var M=this.enableComplexProperty(e),N=M.length;for(x=0;x<N;x++){(n=M[x]).regions=[],n.symbolLocations=[],p=this.getNextIndex(m,n.index-1,e),c=this.getPreviousIndex(m,n.index-1,e);var I=Math.min(n.low,n.high),S=Math.max(n.low,n.high);if(i.isAxisInverse){var C=I;I=S,S=C}var O=it(n.xValue,I,t,i,r),T=it(n.xValue,S,t,i,r);n.symbolLocations.push(T),n.symbolLocations.push(O);var P=new sf.svgbase.Rect(Math.min(O.x,T.x),Math.min(O.y,T.y),Math.max(Math.abs(T.x-O.x),e.marker.width),Math.max(Math.abs(T.y-O.y),e.marker.width));r?P.y-=e.marker.width/2:P.x-=e.marker.width/2,n.regions.push(P),n.visible&&le(M[c],n,M[p],e)?(f?(l=e.drawPoints[c].controlPoint1,h=e.drawPoints[c].controlPoint2,o=it(n.xValue,n.high>n.low?n.high:n.low,t,i,r),s=it(l.x,l.y,t,i,r),a=it(h.x,h.y,t,i,r),u=u.concat("C "+s.x+" "+s.y+" "+a.x+" "+a.y+" "+o.x+" "+o.y+" "),this.borderDirection+="C "+s.x+" "+s.y+" "+a.x+" "+a.y+" "+o.x+" "+o.y+" "):(i.isAxisInverse?(u=u.concat("M "+T.x+" "+T.y+" L "+O.x+" "+O.y+" "),this.borderDirection+="M "+T.x+" "+T.y+" ",w="L "+O.x+" "+O.y):(u=u.concat("M "+O.x+" "+O.y+" L "+T.x+" "+T.y+" "),this.borderDirection+="M "+T.x+" "+T.y+" ",w="L "+O.x+" "+O.y),g=!1),(x+1<M.length&&!M[x+1].visible||x===M.length-1)&&(u=this.closeSplineRangeAreaPath(M,n,e,u,x,t,i,r),this.borderDirection+=w,w="",u=u.concat(" Z"),g=!0),f=n):(!1===g&&0!==x&&(u=this.closeSplineRangeAreaPath(M,n,e,u,x,t,i,r),g=!0),f=null,n.symbolLocations=[])}var A="Indicator"===e.category?e.chart.element.id+"_Indicator_"+e.index+"_"+e.name:e.chart.element.id+"_Series_"+e.index,L=new sf.svgbase.PathOption(A,e.interior,0,"transparent",e.opacity,e.dashArray,u);this.appendLinePath(L,e,""),0!==e.border.width&&(this.appendLinePath(new sf.svgbase.PathOption(e.chart.element.id+"_Series_border_"+e.index,"transparent",v,b,1,e.dashArray,this.borderDirection),e,""),this.borderDirection=""),this.renderMarker(e)},t.prototype.closeSplineRangeAreaPath=function(e,t,i,r,n,o,s,a){for(var l,h,d,c,p,u=null,g=n;g>0&&e[g].visible;g--){t=e[g];var f=Math.min(t.low,t.high),m=Math.max(t.low,t.high);if(s.isAxisInverse){var y=f;f=m,m=y}var v=it(t.xValue,f,o,s,a),b=it(t.xValue,m,o,s,a);u?(c=i.lowDrawPoints[g].controlPoint1,p=i.lowDrawPoints[g].controlPoint2,l=it(t.xValue,t.low<t.high?t.low:t.high,o,s,a),h=it(c.x,c.y,o,s,a),d=it(p.x,p.y,o,s,a),r=r.concat("C "+d.x+" "+d.y+" "+h.x+" "+h.y+" "+l.x+" "+l.y+" "),this.borderDirection+="C "+d.x+" "+d.y+" "+h.x+" "+h.y+" "+l.x+" "+l.y+" "):s.isAxisInverse?(r=r.concat("L "+b.x+" "+b.y+" "),this.borderDirection+="M "+b.x+" "+b.y+" "):(r=r.concat("L "+v.x+" "+v.y+" "),this.borderDirection+="M "+v.x+" "+v.y+" "),u=t}return r},t.prototype.doAnimation=function(e){var t=e.animation;this.doLinearAnimation(e,t)},t.prototype.getModuleName=function(){return"SplineRangeAreaSeries"},t.prototype.destroy=function(){},t}(Rn),Hn=function(){function e(){}return e.prototype.render=function(e,t,i,r){var n,o,s,a,l,h,d=e.marker,c=e.points,p=Math.max(e.chart.initialClipRect.height,e.chart.initialClipRect.width),u=p/100,g=e.maxRadius*u,f=e.minRadius*u,m=null,y=e.chart.redraw;if(null===e.maxRadius||null===e.minRadius){for(var v=0,b=e.chart.visibleSeries;v<b.length;v++){var w=b[v];"Bubble"!==w.type||!0!==w.visible||null!==w.maxRadius&&null!==w.minRadius||(m=w.sizeMax>m?w.sizeMax:m)}f=g=1,a=p/5/2*g}else m=e.sizeMax,a=g-f;for(var x=0,M=c;x<M.length;x++){var N=M[x];N.symbolLocations=[],N.regions=[],N.visible&&le(c[N.index-1],N,c[N.index+1],e)&&(s=(s=null===e.maxRadius||null===e.minRadius?a*Math.abs(+N.size/m):f+a*Math.abs(+N.size/m))||f,o={cancel:!1,name:"pointRender",series:e,point:N,fill:e.setPointColor(N,e.interior),border:e.setBorderColor(N,{width:e.border.width,color:e.border.color}),height:2*s,width:2*s},e.chart.trigger("pointRender",o),o.cancel?N.marker={visible:!1}:(N.symbolLocations.push(it(N.xValue,N.yValue,t,i,r)),N.color=o.fill,n=new sf.svgbase.PathOption(e.chart.element.id+"_Series_"+e.index+"_Point_"+N.index,o.fill,o.border.width,o.border.color,e.opacity,null),l=Ve(N.symbolLocations[0],"Circle",new sf.svgbase.Size(o.width,o.height),d.imageUrl,n,(N.x.toString(),N.yValue.toString()),e.chart.svgRenderer,e.clipRect),nt(e.chart.enableCanvas,e.seriesElement,l,y),N.regions.push(new sf.svgbase.Rect(N.symbolLocations[0].x-s,N.symbolLocations[0].y-s,2*s,2*s)),N.marker={border:o.border,fill:o.fill,height:o.height,visible:!0,shape:"Circle",width:o.width},e.chart.enableCanvas&&e.chart.markerRender.render(e),h=y?N.symbolLocations[0]:null,y&&Nt(l,300,h,N.symbolLocations[0],"cx","cy")))}},e.prototype.destroy=function(){},e.prototype.getModuleName=function(){return"BubbleSeries"},e.prototype.doAnimation=function(e){for(var t=e.animation.duration,i=e.animation.delay,r=e.seriesElement.childNodes,n=1,o=0,s=e.points;o<s.length;o++){var a=s[o];a.symbolLocations.length&&(ze(r[n],i,t,e,a.index,a.symbolLocations[0],!1),n++)}},e}(),Bn=(Li=function(e,t){return(Li=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}Li(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),_n=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Bn(t,e),t.prototype.render=function(e,t,i,r){var n,o,s=null,a="",l="M",h="TrendLine"===e.category?e.points:this.enableComplexProperty(e);n=this.filterEmptyPoints(e,h);for(var d="PolarRadar"===e.chart.chartAreaType?ve:it,c=0,p=n;c<p.length;c++){var u=p[c];o=this.getPreviousIndex(n,u.index-1,e),u.symbolLocations=[],u.regions=[],u.visible?(le(n[o],u,n[this.getNextIndex(n,u.index-1,e)],e)&&(null!==s&&(a=this.getSplineDirection(e.drawPoints[o],s,u,t,i,r,e,l,d,a),l="L"),this.storePointLocation(u,e,r,d)),s=u):(l="M",s=null,u.symbolLocations=[])}if(n.length>0&&e.drawPoints.length>0&&"PolarRadar"===e.chart.chartAreaType&&e.isClosed){var g=this.getFirstLastVisiblePoint(n);a=this.getSplineDirection(e.drawPoints[e.drawPoints.length-1],g.last,{xValue:g.first.xValue,yValue:g.first.yValue},t,i,r,e,l,d,a),l="L"}var f="TrendLine"===e.category?e.chart.element.id+"_Series_"+e.sourceIndex+"_TrendLine_"+e.index:e.chart.element.id+"_Series_"+e.index,m=new sf.svgbase.PathOption(f,"transparent",e.width,e.interior,e.opacity,e.dashArray,a);this.appendLinePath(m,e,""),this.renderMarker(e)},t.prototype.getSplineDirection=function(e,t,i,r,n,o,s,a,l,h){var d=e.controlPoint1,c=e.controlPoint2,p=l(t.xValue,t.yValue,r,n,o,s),u=l(i.xValue,i.yValue,r,n,o,s),g=l(d.x,d.y,r,n,o,s),f=l(c.x,c.y,r,n,o,s);return h.concat(a+" "+p.x+" "+p.y+" C "+g.x+" "+g.y+" "+f.x+" "+f.y+" "+u.x+" "+u.y+" ")},t.prototype.getModuleName=function(){return"SplineSeries"},t.prototype.destroy=function(){},t}(Rn),Vn=(Fi=function(e,t){return(Fi=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}Fi(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),Yn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Vn(t,e),t.prototype.render=function(t){e.prototype.render.call(this,t),t.showNormalDistribution&&this.renderNormalDistribution(t)},t.prototype.calculateBinInterval=function(e,t){for(var i=he(e)/e.length,r=0,n=0,o=e;n<o.length;n++){var s=o[n];r+=(s-i)*(s-i)}t.histogramValues.mean=i,t.histogramValues.sDValue=Math.round(Math.sqrt(Math.abs(r/e.length-1))),t.histogramValues.binWidth=t.binInterval||Math.round(3.5*t.histogramValues.sDValue/Math.pow(e.length,1/3))||1},t.prototype.processInternalData=function(e,t){for(var i,r=[],n=[],o=Object.keys(e),s=0;s<o.length;s++){var a=o[s];n.push(e[a][t.yName])}t.histogramValues={yValues:n};var l=Math.min.apply(Math,t.histogramValues.yValues),h=Math.max.apply(Math,t.histogramValues.yValues);this.calculateBinInterval(t.histogramValues.yValues,t);for(var d,c=t.histogramValues.binWidth,p=0;p<e.length;)d=n.filter((function(e){return e>=l&&e<l+c})).length,l+c===h&&(d+=n.filter((function(e){return e>=h})).length),r.push(((i={x:l+c/2})[t.yName]=d,i)),l+=c,p+=d;return r},t.prototype.calculateBinValues=function(e){var t,i,r=e.histogramValues.yValues.length,n=e.histogramValues.binWidth,o=e.histogramValues.mean,s=e.histogramValues.sDValue,a=e.xAxis.minimum?parseInt(e.xAxis.minimum.toString()):e.xMin,l=((e.xAxis.maximum?parseInt(e.xAxis.maximum.toString()):e.xMax)-a)/499;if(e.points.length)for(var h=0;h<500;h++)t=a+h*l,i=Math.exp(-(t-o)*(t-o)/(2*s*s))/(s*Math.sqrt(2*Math.PI))*n*r,e.yMin=e.yMin>i?i:e.yMin,e.yMax=e.yMax<i?i:e.yMax},t.prototype.renderNormalDistribution=function(e){var t,i,r=e.xAxis.actualRange.min,n=e.xAxis.actualRange.max,o="",s="M",a=e.histogramValues.yValues.length,l=e.histogramValues.binWidth,h=e.histogramValues.mean,d=e.histogramValues.sDValue,c=(n-r)/499;if(e.points.length)for(var p=0;p<500;p++)o+=s+" "+(i=it(t=r+p*c,Math.exp(-(t-h)*(t-h)/(2*d*d))/(d*Math.sqrt(2*Math.PI))*l*a,e.xAxis,e.yAxis,e.chart.requireInvertedAxis)).x+" "+i.y+" ",s="L";var u=e.chart.renderer.drawPath(new sf.svgbase.PathOption(e.chart.element.id+"_Series_"+e.index+"_NDLine","transparent",2,e.chart.themeStyle.errorBar,e.opacity,e.dashArray,o),new Int32Array([e.clipRect.x,e.clipRect.y]));u.style.visibility=e.chart.enableCanvas?null:e.animation.enable&&e.chart.animateSeries?"hidden":"visible",e.chart.enableCanvas||e.seriesElement.appendChild(u)},t.prototype.doAnimation=function(t){e.prototype.doAnimation.call(this,t),t.showNormalDistribution&&_e(t.seriesElement.lastElementChild,t.animation.duration,500,"FadeIn")},t.prototype.getModuleName=function(){return"HistogramSeries"},t.prototype.destroy=function(){},t}(Zr),Qn=(Di=function(e,t){return(Di=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}Di(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),qn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Qn(t,e),t.prototype.render=function(e,t,i,r){var n,o,s,a,l,h,d,c=null,p="",u=null,g=null,f=[],m=0;h=this.filterEmptyPoints(e);for(var y="",v=0;v<h.length;v++)null!==(d=h[v]).x&&""!==d.x&&(d.index=m,m++,f.push(d));var b,w=f.length,x="PolarRadar"===e.chart.chartAreaType?ve:it,M="PolarRadar"===e.chart.chartAreaType?e.points[0].yValue:Math.max(e.yAxis.visibleRange.min,0);for(v=0;v<w;v++)(d=f[v]).symbolLocations=[],d.regions=[],b=this.getPreviousIndex(f,d.index-1,e),d.visible&&le(f[b],d,f[this.getNextIndex(f,d.index-1,e)],e)?(c?(a=e.drawPoints[b].controlPoint1,l=e.drawPoints[b].controlPoint2,n=x(d.xValue,d.yValue,t,i,r,e),o=x(a.x,a.y,t,i,r,e),s=x(l.x,l.y,t,i,r,e),p=p.concat("C "+o.x+" "+o.y+" "+s.x+" "+s.y+" "+n.x+" "+n.y+" ")):(p+="M "+(u=x(d.xValue,M,t,i,r,e)).x+" "+u.y+" ",p+="L "+(g=x(d.xValue,d.yValue,t,i,r,e)).x+" "+g.y+" "),this.storePointLocation(d,e,r,x),c=d):(c=null,d.symbolLocations=[]),(v+1<w&&!f[v+1].visible||v===w-1)&&n&&u&&(u=x(d.xValue,M,t,i,r,e),p=p.concat("L "+u.x+" "+u.y+" "));this.appendLinePath(new sf.svgbase.PathOption(e.chart.element.id+"_Series_"+e.index,e.interior,0,"transparent",e.opacity,e.dashArray,p),e,""),0!==e.border.width&&(y=this.removeEmptyPointsBorder(this.getBorderDirection(p)),this.appendLinePath(new sf.svgbase.PathOption(e.chart.element.id+"_Series_border_"+e.index,"transparent",e.border.width,e.border.color?e.border.color:e.interior,1,e.dashArray,y),e,"")),this.renderMarker(e)},t.prototype.getModuleName=function(){return"SplineAreaSeries"},t.prototype.destroy=function(){},t}(Rn),Gn=(Ei=function(e,t){return(Ei=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}Ei(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),Xn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Gn(t,e),t.prototype.initSeriesCollection=function(e,t){e.targetSeries=[];var i=new pr(e,"targetSeries",{},!0);this.setSeriesProperties(i,e,e.type,e.fill,e.width,t)},t.prototype.setSeriesProperties=function(e,t,i,r,n,o){e.name=i.length<=4?i.toLocaleUpperCase():i,e.xName="x",e.yName="y",e.fill=r||"#606eff",e.dashArray=t.dashArray,e.width=n,e.xAxisName=t.xAxisName,e.animation=t.animation,e.yAxisName=t.yAxisName,e.clipRectElement=t.clipRectElement,e.points=[],e.enableTooltip=!0,e.interior=e.fill,e.category="Indicator",e.index=t.index,e.chart=o,e.xMin=1/0,e.xMax=-1/0,e.yMin=1/0,e.yMax=-1/0,e.xData=[],e.yData=[],e.marker.visible=!1,t.targetSeries.push(e)},t.prototype.createIndicatorElements=function(e,t,i){(t.seriesName||t.dataSource)&&Pe(t.targetSeries[0]);var r=new sf.svgbase.Rect(0,0,0,0);(t.seriesName||t.dataSource)&&(r=t.targetSeries[0].clipRect);var n=new zt(e.element.id+"_ChartIndicatorClipRect_"+i,"transparent",{width:1,color:"Gray"},1,{x:0,y:0,width:r.width,height:r.height}),o=Re(e.redraw,n,e.renderer);t.indicatorElement=e.renderer.createGroup({id:e.element.id+"IndicatorGroup"+i,transform:"translate("+r.x+","+r.y+")","clip-path":"url(#"+e.element.id+"_ChartIndicatorClipRect_"+i+")"}),t.indicatorElement.appendChild(o);for(var s=0,a=t.targetSeries;s<a.length;s++){var l=a[s];l.clipRectElement=o;var h=l.chart.renderer.createGroup({id:l.chart.element.id+"_Indicator_"+t.index+"_"+l.name+"_Group"});t.indicatorElement.appendChild(h),l.seriesElement=h}e.indicatorElements.appendChild(t.indicatorElement)},t.prototype.getDataPoint=function(e,t,i,r,n,o){void 0===o&&(o=null);var s=new sr;return s.x=e,s.y=t,s.xValue=i.xValue,s.color=r.fill,s.index=n,s.yValue=t,s.visible=!0,r.xMin=Math.min(r.xMin,s.xValue),r.yMin=Math.min(r.yMin,s.yValue),r.xMax=Math.max(r.xMax,s.xValue),r.yMax=Math.max(r.yMax,s.yValue),r.xData.push(s.xValue),o&&"Macd"===o.type&&"Column"===r.type&&(s.y>=0?s.color=o.macdPositiveColor:s.color=o.macdNegativeColor),s},t.prototype.getRangePoint=function(e,t,i,r,n,o){var s=new sr;return s.x=e,s.high=t,s.low=i,s.xValue=r.xValue,s.color=n.fill,s.index=o,s.visible=!0,n.xData.push(s.xValue),s},t.prototype.setSeriesRange=function(e,t,i){void 0===i&&(i=null),i?i.points=e:t.targetSeries[0].points=e},t}(Yr),Zn=(zi=function(e,t){return(zi=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}zi(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),Kn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Zn(t,e),t.prototype.initDataSource=function(e,t){var i=[],r=e.points;if(r&&r.length){var n=r,o=Ae(e.field),s=e.targetSeries[0];if(n&&n.length&&n.length>=e.period){for(var a=0,l=0,h=0;h<e.period;h++)l+=n[h][o];a=l/e.period,i.push(this.getDataPoint(n[e.period-1].x,a,n[e.period-1],s,i.length));for(var d=e.period;d<n.length;)l-=n[d-e.period][o],a=(l+=n[d][o])/e.period,i.push(this.getDataPoint(n[d].x,a,n[d],s,i.length)),d++}this.setSeriesRange(i,e)}},t.prototype.destroy=function(){},t.prototype.getModuleName=function(){return"SmaIndicator"},t}(Xn),Jn=(ki=function(e,t){return(ki=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}ki(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),$n=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Jn(t,e),t.prototype.initDataSource=function(e,t){var i=Ae(e.field),r=[],n=e.targetSeries[0],o=e.points;if(o&&o.length&&o.length>=e.period){for(var s,a=0,l=2/(e.period+1),h=0;h<e.period;h++)a+=o[h][i];s=a/e.period,r.push(this.getDataPoint(o[e.period-1].x,s,o[e.period-1],n,r.length));for(var d=e.period;d<o.length;){var c=r[d-e.period][n.yName],p=(o[d][i]-c)*l+c;r.push(this.getDataPoint(o[d].x,p,o[d],n,r.length)),d++}}this.setSeriesRange(r,e)},t.prototype.destroy=function(){},t.prototype.getModuleName=function(){return"EmaIndicator"},t}(Xn),eo=(Wi=function(e,t){return(Wi=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}Wi(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),to=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return eo(t,e),t.prototype.initDataSource=function(e,t){var i=[],r=Ae(e.field),n=e.points;if(n&&n.length&&n.length>=e.period){var o=e.targetSeries[0],s=e.points;if(s.length&&s.length>=e.period){for(var a=0,l=[],h=0,d=s.length,c=e.period;d>=c;){a=0;for(var p=h=s.length-d;p<h+c;p++)a+=s[p][r];a/=c,l.push(a),d--}for(var u=0;u<c-1;u++){a=0;for(p=0;p<u+1;p++)a+=s[p][r];a/=u+1,l.splice(u,0,a)}for(h=e.period;h<=l.length;){a=0;for(p=h-e.period;p<h;p++)a+=l[p];a/=e.period,i.push(this.getDataPoint(s[h-1].x,a,s[h-1],o,i.length)),h++}}}this.setSeriesRange(i,e)},t.prototype.destroy=function(){},t.prototype.getModuleName=function(){return"TmaIndicator"},t}(Xn),io=(Ri=function(e,t){return(Ri=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}Ri(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),ro=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return io(t,e),t.prototype.initDataSource=function(e){var t=[],i=e.points;i.length>0&&i.length>e.period&&(t=this.calculateADPoints(e,i)),this.setSeriesRange(t,e)},t.prototype.calculateADPoints=function(e,t){var i=[],r=0,n=0,o=0,s=0,a=0,l=e.targetSeries[0];for(n=0;n<t.length;n++)o=Number(t[n].high),s=Number(t[n].low),r+=((a=Number(t[n].close))-s-(o-a))/(o-s)*Number(t[n].volume),i[n]=this.getDataPoint(t[n].x,r,t[n],l,i.length);return i},t.prototype.destroy=function(){},t.prototype.getModuleName=function(){return"AccumulationDistributionIndicator"},t}(Xn),no=(ji=function(e,t){return(ji=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}ji(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),oo=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return no(t,e),t.prototype.initDataSource=function(e,t){var i=e.points;i.length>0&&i.length>e.period&&this.calculateATRPoints(e,i)},t.prototype.calculateATRPoints=function(e,t){for(var i=0,r=0,n=0,o=0,s=0,a=[],l=[],h=e.period,d=0,c=e.targetSeries[0],p=0;p<t.length;p++)r=Number(t[p].high)-Number(t[p].low),p>0&&(n=Math.abs(Number(t[p].high)-Number(t[p-1].close)),o=Math.abs(Number(t[p].low)-Number(t[p-1].close))),d+=s=Math.max(r,n,o),p>=h?(i=(Number(l[p-1].y)*(h-1)+s)/h,a.push(this.getDataPoint(t[p].x,i,t[p],c,a.length))):(i=d/h,p===h-1&&a.push(this.getDataPoint(t[p].x,i,t[p],c,a.length))),l[p]={x:t[p].x,y:i};this.setSeriesRange(a,e)},t.prototype.destroy=function(){},t.prototype.getModuleName=function(){return"AtrIndicator"},t}(Xn),so=(Ui=function(e,t){return(Ui=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}Ui(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),ao=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return so(t,e),t.prototype.initSeriesCollection=function(t,i){e.prototype.initSeriesCollection.call(this,t,i);var r=new pr(t,"targetSeries",{},!0);e.prototype.setSeriesProperties.call(this,r,t,"UpperLine",t.upperLine.color,t.upperLine.width,i)},t.prototype.initDataSource=function(e,t){var i=[],r=[],n=e.points;if(n&&n.length){var o=e.targetSeries[1],s=e.targetSeries[0],a=e.period;if(n.length>=e.period)for(var l=0;l<n.length;l++)i.push(this.getDataPoint(n[l].x,100,n[l],o,i.length)),l<a||r.push(this.getDataPoint(n[l].x,Number(n[l].close)/Number(n[l-a].close)*100,n[l],s,r.length));this.setSeriesRange(r,e,e.targetSeries[0]),this.setSeriesRange(i,e,e.targetSeries[1])}},t.prototype.destroy=function(){},t.prototype.getModuleName=function(){return"MomentumIndicator"},t}(Xn),lo=(Hi=function(e,t){return(Hi=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}Hi(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),ho=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return lo(t,e),t.prototype.initSeriesCollection=function(t,i){if(e.prototype.initSeriesCollection.call(this,t,i),t.showZones){var r=new pr(t,"targetSeries",{},!0);e.prototype.setSeriesProperties.call(this,r,t,"LowerLine",t.lowerLine.color,t.lowerLine.width,i);var n=new pr(t,"targetSeries",{},!0);e.prototype.setSeriesProperties.call(this,n,t,"UpperLine",t.upperLine.color,t.upperLine.width,i)}},t.prototype.initDataSource=function(e,t){var i=[],r=[],n=[],o=e.targetSeries[0],s=e.points;if(s.length&&s.length>=e.period){if(e.showZones)for(var a=0;a<s.length;a++)n.push(this.getDataPoint(s[a].x,e.overBought,s[a],e.targetSeries[1],n.length)),r.push(this.getDataPoint(s[a].x,e.overSold,s[a],e.targetSeries[2],r.length));var l=Number(s[0].close),h=0,d=0;for(a=1;a<=e.period;a++){var c=Number(s[a].close);c>l?h+=c-l:d+=l-c,l=c}h/=e.period,d/=e.period,i.push(this.getDataPoint(s[e.period].x,100-100/(1+h/d),s[e.period],o,i.length));for(var p=e.period+1;p<s.length;p++){var u=Number(s[p].close);u>l?(h=(h*(e.period-1)+(u-l))/e.period,d=d*(e.period-1)/e.period):u<l&&(d=(d*(e.period-1)+(l-u))/e.period,h=h*(e.period-1)/e.period),l=u,i.push(this.getDataPoint(s[p].x,100-100/(1+h/d),s[p],o,i.length))}}this.setSeriesRange(i,e,e.targetSeries[0]),e.showZones&&(this.setSeriesRange(n,e,e.targetSeries[1]),this.setSeriesRange(r,e,e.targetSeries[2]))},t.prototype.destroy=function(){},t.prototype.getModuleName=function(){return"RsiIndicator"},t}(Xn),co=(Bi=function(e,t){return(Bi=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}Bi(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),po=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return co(t,e),t.prototype.initSeriesCollection=function(t,i){e.prototype.initSeriesCollection.call(this,t,i);var r=new pr(t,"targetSeries",{},!0);if(this.setSeriesProperties(r,t,"PeriodLine",t.periodLine.color,t.periodLine.width,i),t.showZones){var n=new pr(t,"targetSeries",{},!0);this.setSeriesProperties(n,t,"UpperLine",t.upperLine.color,t.upperLine.width,i);var o=new pr(t,"targetSeries",{},!0);this.setSeriesProperties(o,t,"LowerLine",t.lowerLine.color,t.lowerLine.width,i)}},t.prototype.initDataSource=function(e,t){var i=[],r=[],n=[],o=[],s=[],a=e.points;if(a.length&&a.length>=e.period){if(e.showZones)for(var l=0;l<a.length;l++)r.push(this.getDataPoint(a[l].x,e.overBought,a[l],e.targetSeries[2],r.length)),n.push(this.getDataPoint(a[l].x,e.overSold,a[l],e.targetSeries[3],n.length));s=this.calculatePeriod(e.period,e.kPeriod,a,e.targetSeries[1]),o=this.smaCalculation(e.period,e.kPeriod,s,e.targetSeries[1]),i=this.smaCalculation(e.period+e.kPeriod-1,e.dPeriod,s,e.targetSeries[0])}this.setSeriesRange(i,e,e.targetSeries[0]),this.setSeriesRange(o,e,e.targetSeries[1]),e.showZones&&(this.setSeriesRange(r,e,e.targetSeries[2]),this.setSeriesRange(n,e,e.targetSeries[3]))},t.prototype.smaCalculation=function(e,t,i,r){var n=[];if(i.length>=e+t){for(var o=e+(t-1),s=[],a=[],l=0;l<i.length;l++){var h=Number(i[l].y);s.push(h)}for(var d=s.length;d>=o;){var c=0;for(l=e-1;l<e+t-1;l++)c+=s[l];c/=t,a.push(c.toFixed(2)),s.splice(0,1),d=s.length}var p=o-1;for(l=0;l<i.length;l++)l<p||(n.push(this.getDataPoint(i[l].x,Number(a[l-p]),i[l],r,n.length)),i[l].y=Number(a[l-p]))}return n},t.prototype.calculatePeriod=function(e,t,i,r){for(var n=[],o=[],s=[],a=[],l=0;l<i.length;l++)n[l]=i[l].low,o[l]=i[l].high,s[l]=i[l].close;if(i.length>e){for(var h=[],d=[],c=0;c<e-1;++c)d.push(0),h.push(0),a.push(this.getDataPoint(i[c].x,i[c].close,i[c],r,a.length));for(c=e-1;c<i.length;++c){var p=Number.MAX_VALUE,u=Number.MIN_VALUE;for(l=0;l<e;++l)p=Math.min(p,n[c-l]),u=Math.max(u,o[c-l]);d.push(u),h.push(p)}for(c=e-1;c<i.length;++c){var g=0,f=0;g+=s[c]-h[c],f+=d[c]-h[c],a.push(this.getDataPoint(i[c].x,g/f*100,i[c],r,a.length))}}return a},t.prototype.destroy=function(){},t.prototype.getModuleName=function(){return"StochasticIndicator"},t}(Xn),uo=(_i=function(e,t){return(_i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}_i(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),go=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return uo(t,e),t.prototype.initSeriesCollection=function(e,t){e.targetSeries=[];var i=new pr(e,"targetSeries",{},!0);i.type="RangeArea","transparent"!==e.bandColor&&"none"!==e.bandColor&&this.setSeriesProperties(i,e,"BollingerBand",e.bandColor,0,t);var r=new pr(e,"targetSeries",{},!0);this.setSeriesProperties(r,e,"BollingerBand",e.fill,e.width,t);var n=new pr(e,"targetSeries",{},!0);this.setSeriesProperties(n,e,"UpperLine",e.upperLine.color,e.upperLine.width,t);var o=new pr(e,"targetSeries",{},!0);this.setSeriesProperties(o,e,"LowerLine",e.lowerLine.color,e.lowerLine.width,t)},t.prototype.initDataSource=function(e,t){var i="transparent"!==e.bandColor&&"none"!==e.bandColor,r=i?1:0,n=[],o=[],s=[],a=[],l=e.targetSeries[r+1],h=e.targetSeries[r+2],d=e.targetSeries[r],c=i?e.targetSeries[0]:null,p=e.points;if(p.length&&p.length>=e.period){for(var u=0,g=0,f=e.standardDeviation,m=p.length,y=Math.round(e.period),v=[],b=[],w=[],x=0;x<y;x++)u+=Number(p[x].close);for(var M=u/e.period,N=0;N<m;N++){var I=Number(p[N].close);if(N>=y-1&&N<m){if(N-e.period>=0)M=(u+=I-Number(p[N-y].close))/e.period,v[N]=M,b[N]=Math.pow(I-M,2),g+=b[N]-b[N-y];else v[N]=M,b[N]=Math.pow(I-M,2),g+=b[N];var S=Math.sqrt(g/e.period),C=v[N]-f*S,O=v[N]+f*S;if(N+1===y)for(var T=0;T<y-1;T++)w[T]={X:p[T].x,mb:v[N],lb:C,ub:O,visible:!0};w[N]={X:p[N].x,mb:v[N],lb:C,ub:O,visible:!0}}else N<e.period-1&&(v[N]=M,b[N]=Math.pow(I-M,2),g+=b[N])}for(var P=-1,A=-1,L=0;L<m;L++)if(L>=y-1){o.push(this.getDataPoint(p[L].x,w[L].ub,p[L],l,o.length)),s.push(this.getDataPoint(p[L].x,w[L].lb,p[L],h,s.length)),n.push(this.getDataPoint(p[L].x,w[L].mb,p[L],d,n.length)),i&&a.push(this.getRangePoint(p[L].x,o[++P].y,s[++A].y,p[L],c,a.length))}}i&&this.setSeriesRange(a,e,e.targetSeries[0]),this.setSeriesRange(n,e,e.targetSeries[r]),this.setSeriesRange(o,e,e.targetSeries[r+1]),this.setSeriesRange(s,e,e.targetSeries[r+2])},t.prototype.destroy=function(){},t.prototype.getModuleName=function(){return"BollingerBandsIndicator"},t}(Xn),fo=(Vi=function(e,t){return(Vi=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}Vi(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),mo=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return fo(t,e),t.prototype.initSeriesCollection=function(t,i){if(e.prototype.initSeriesCollection.call(this,t,i),"Line"===t.macdType||"Both"===t.macdType){var r=new pr(t,"targetSeries",{},!0);this.setSeriesProperties(r,t,"MacdLine",t.macdLine.color,t.macdLine.width,i)}if("Histogram"===t.macdType||"Both"===t.macdType){var n=new pr(t,"targetSeries",{},!0);n.type="Column",this.setSeriesProperties(n,t,"Histogram",t.macdPositiveColor,t.width,i)}},t.prototype.initDataSource=function(e,t){var i,r,n=[],o=e.fastPeriod,s=e.slowPeriod,a=e.period,l=o+a,h=[],d=[],c=e.points,p=e.targetSeries[0];if("Histogram"===e.macdType?i=e.targetSeries[1]:(r=e.targetSeries[1],"Both"===e.macdType&&(i=e.targetSeries[2])),c&&l<c.length&&s<=o&&s>0&&l-2>=0){var u=this.calculateEMAValues(s,c,"close"),g=this.calculateEMAValues(o,c,"close"),f=this.getMACDVales(e,u,g);h=this.getMACDPoints(e,f,c,r||p);var m=this.calculateEMAValues(a,h,"y");n=this.getSignalPoints(e,m,c,p),i&&(d=this.getHistogramPoints(e,f,m,c,i))}this.setSeriesRange(n,e,e.targetSeries[0]),i&&this.setSeriesRange(d,e,i),r&&this.setSeriesRange(h,e,r)},t.prototype.calculateEMAValues=function(e,t,i){for(var r,n=0,o=[],s=2/(e+1),a=0;a<e;a++)n+=Number(t[a][i]);r=n/e,o.push(r);for(var l=r,h=e;h<t.length;h++)l=(Number(t[h][i])-l)*s+l,o.push(l);return o},t.prototype.getMACDPoints=function(e,t,i,r){for(var n=[],o=e.fastPeriod-1,s=0;o<i.length;)n.push(this.getDataPoint(i[o].x,t[s],i[o],r,n.length)),o++,s++;return n},t.prototype.getSignalPoints=function(e,t,i,r){for(var n=e.fastPeriod+e.period-2,o=0,s=[];n<i.length;)s.push(this.getDataPoint(i[n].x,t[o],i[n],r,s.length)),n++,o++;return s},t.prototype.getMACDVales=function(e,t,i){for(var r=[],n=e.fastPeriod-e.slowPeriod,o=0;o<i.length;o++)r.push(t[o+n]-i[o]);return r},t.prototype.getHistogramPoints=function(e,t,i,r,n){for(var o=e.fastPeriod+e.period-2,s=0,a=[];o<r.length;)a.push(this.getDataPoint(r[o].x,t[s+(e.period-1)]-i[s],r[o],n,a.length,e)),o++,s++;return a},t.prototype.destroy=function(){},t.prototype.getModuleName=function(){return"MacdIndicator"},t}(Xn),yo=function(){function e(){}return e.prototype.initSeriesCollection=function(e,t){var i=new pr(e,"targetSeries",{},!0);"Linear"===e.type||"MovingAverage"===e.type?i.type="Line":i.type="Spline",this.setSeriesProperties(i,e,e.type,e.fill,e.width,t)},e.prototype.setSeriesProperties=function(e,t,i,r,n,o){e.name=t.name,e.xName="x",e.yName="y",e.fill=r||"blue",e.width=n,e.dashArray=t.dashArray,e.clipRectElement=t.clipRectElement,e.points=[],e.enableTooltip=t.enableTooltip,e.index=t.index,e.sourceIndex=t.sourceIndex,e.interior=e.fill,e.animation=t.animation,e.legendShape="HorizontalLine",e.marker=t.marker,e.category="TrendLine",e.chart=o,e.xMin=1/0,e.xMax=-1/0,e.yMin=1/0,e.yMax=-1/0,e.xData=[],e.yData=[],t.targetSeries=e,o.isBlazor&&(t.targetSeries.border={},t.targetSeries.connector={})},e.prototype.createTrendLineElements=function(e,t,i,r,n){t.trendLineElement=r,t.targetSeries.clipRectElement=n,t.targetSeries.seriesElement=r,e.trendLineElements&&e.trendLineElements.appendChild(t.trendLineElement)},e.prototype.getDataPoint=function(e,t,i,r){var n=new sr;return n.x="DateTime"===i.xAxis.valueType?new Date(Number(e)):e,n.y=t,n.xValue=Number(e),n.color=i.fill,n.index=r,n.yValue=Number(t),n.visible=!0,i.xMin=Math.min(i.xMin,n.xValue),i.yMin=Math.min(i.yMin,n.yValue),i.xMax=Math.max(i.xMax,n.xValue),i.yMax=Math.max(i.yMax,n.yValue),i.xData.push(n.xValue),n},e.prototype.findSlopeIntercept=function(e,t,i,r){for(var n=0,o=0,s=0,a=0,l=0,h=0,d=0;l<r.length;)isNaN(t[l])&&(t[l]=(t[l-1]+t[l+1])/2),n+=e[l],o+=t[l],s+=e[l]*t[l],a+=e[l]*e[l],l++;var c=i.type;if(!i.intercept||"Linear"!==c&&"Exponential"!==c)h=(r.length*s-n*o)/(r.length*a-n*n),h="Linear"===c?h:Math.abs(h),d="Exponential"===c||"Power"===c?Math.exp((o-h*n)/r.length):(o-h*n)/r.length;else switch(d=i.intercept,c){case"Linear":h=(s-i.intercept*n)/a;break;case"Exponential":h=(s-Math.log(Math.abs(i.intercept))*n)/a}return{slope:h,intercept:d}},e.prototype.initDataSource=function(e){var t=e.points;if(t&&t.length){var i=e.targetSeries;switch(e.type){case"Linear":this.setLinearRange(t,e,i);break;case"Exponential":this.setExponentialRange(t,e,i);break;case"MovingAverage":this.setMovingAverageRange(t,e,i);break;case"Polynomial":this.setPolynomialRange(t,e,i);break;case"Power":this.setPowerRange(t,e,i);break;case"Logarithmic":this.setLogarithmicRange(t,e,i)}"Linear"!==e.type&&"MovingAverage"!==e.type&&i.chart.splineSeriesModule.findSplinePoint(i)}},e.prototype.setExponentialRange=function(e,t,i){for(var r=[],n=[],o=0;o<e.length;){var s=e[o],a=s.yValue?Math.log(s.yValue):0;r.push(s.xValue),n.push(a),o++}var l=this.findSlopeIntercept(r,n,t,e);i.points=this.getExponentialPoints(t,e,r,n,i,l)},e.prototype.setLogarithmicRange=function(e,t,i){for(var r=[],n=[],o=[],s=0;s<e.length;){var a=e[s],l=a.xValue?Math.log(a.xValue):0;o.push(a.xValue),r.push(l),n.push(a.yValue),s++}var h=this.findSlopeIntercept(r,n,t,e);i.points=this.getLogarithmicPoints(t,e,o,n,i,h)},e.prototype.setPolynomialRange=function(e,t,i){for(var r=[],n=[],o=0;o<e.length;){var s=e[o];r.push(s.xValue),n.push(s.yValue),o++}i.points=this.getPolynomialPoints(t,e,r,n,i)},e.prototype.setPowerRange=function(e,t,i){for(var r=[],n=[],o=[],s=0;s<e.length;){var a=e[s],l=a.xValue?Math.log(a.xValue):0,h=a.yValue?Math.log(a.yValue):0;o.push(a.xValue),r.push(l),n.push(h),s++}var d=this.findSlopeIntercept(r,n,t,e);i.points=this.getPowerPoints(t,e,o,n,i,d)},e.prototype.setLinearRange=function(e,t,i){for(var r=[],n=[],o=0;o<e.length;){var s=e[o];r.push(s.xValue),n.push(s.yValue),o++}var a=this.findSlopeIntercept(r,n,t,e);i.points=this.getLinearPoints(t,e,r,n,i,a)},e.prototype.setMovingAverageRange=function(e,t,i){for(var r=[],n=[],o=[],s=0;s<e.length;){var a=e[s];o.push(a.xValue),r.push(s+1),n.push(a.yValue),s++}i.points=this.getMovingAveragePoints(t,e,o,n,i)},e.prototype.getLogarithmicPoints=function(e,t,i,r,n,o){var s=Math.round(t.length/2),a=[],l=i[0]-e.backwardForecast,h=l?Math.log(l):0,d=o.intercept+o.slope*h,c=i[s-1],p=c?Math.log(c):0,u=o.intercept+o.slope*p,g=i[i.length-1]+e.forwardForecast,f=g?Math.log(g):0,m=o.intercept+o.slope*f;return a.push(this.getDataPoint(l,d,n,a.length)),a.push(this.getDataPoint(c,u,n,a.length)),a.push(this.getDataPoint(g,m,n,a.length)),a},e.prototype.getPowerPoints=function(e,t,i,r,n,o){var s=Math.round(t.length/2),a=[],l=i[0]-e.backwardForecast;l=l>-1?l:0;var h=o.intercept*Math.pow(l,o.slope),d=i[s-1],c=o.intercept*Math.pow(d,o.slope),p=i[i.length-1]+e.forwardForecast,u=o.intercept*Math.pow(p,o.slope);return a.push(this.getDataPoint(l,h,n,a.length)),a.push(this.getDataPoint(d,c,n,a.length)),a.push(this.getDataPoint(p,u,n,a.length)),a},e.prototype.getPolynomialPoints=function(e,t,i,r,n){var o=t.length<=e.polynomialOrder?t.length:e.polynomialOrder;o=Math.max(2,o),o=Math.min(6,o),e.polynomialOrder=o,e.polynomialSlopes=[],e.polynomialSlopes.length=e.polynomialOrder+1;for(var s=0;s<i.length;){for(var a=i[s],l=r[s],h=0;h<=e.polynomialOrder;)e.polynomialSlopes[h]||(e.polynomialSlopes[h]=0),e.polynomialSlopes[h]+=Math.pow(a,h)*l,++h;s++}var d=[];d.length=1+2*e.polynomialOrder;var c=[];c.length=e.polynomialOrder+1;for(var p=0;p<e.polynomialOrder+1;)c[p]=[],c[p].length=3,p++;for(var u=0;u<i.length;){for(var g=i[u],f=1,m=0;m<d.length;)d[m]||(d[m]=0),d[m]+=f,f*=g,++m;++u}for(var y=0;y<=e.polynomialOrder;){for(var v=0;v<=e.polynomialOrder;)c[y][v]=d[y+v],++v;++y}return this.gaussJordanElimination(c,e.polynomialSlopes)||(e.polynomialSlopes=null),this.getPoints(e,t,i,n)},e.prototype.getMovingAveragePoints=function(e,t,i,r,n){var o=[],s=e.period>=t.length?t.length-1:e.period;s=Math.max(2,s);for(var a,l,h,d=0;d<t.length-1;){a=h=0;for(var c=d;h<s;c++)h++,a+=r[c];a=s-0<0?null:a?a/(s-0):a,sf.base.isNullOrUndefined(a)||isNaN(a)||(l=i[s-1+d],o.push(this.getDataPoint(l,a,n,o.length))),d++}return o},e.prototype.getLinearPoints=function(e,t,i,r,n,o){var s=[],a=i.indexOf(Math.max.apply(null,i)),l=i.indexOf(Math.min.apply(null,i)),h=i[l]-e.backwardForecast,d=o.slope*h+o.intercept,c=i[a]+e.forwardForecast,p=o.slope*c+o.intercept;return s.push(this.getDataPoint(h,d,n,s.length)),s.push(this.getDataPoint(c,p,n,s.length)),s},e.prototype.getExponentialPoints=function(e,t,i,r,n,o){var s=Math.round(t.length/2),a=[],l=i[0]-e.backwardForecast,h=o.intercept*Math.exp(o.slope*l),d=i[s-1],c=o.intercept*Math.exp(o.slope*d),p=i[i.length-1]+e.forwardForecast,u=o.intercept*Math.exp(o.slope*p);return a.push(this.getDataPoint(l,h,n,a.length)),a.push(this.getDataPoint(d,c,n,a.length)),a.push(this.getDataPoint(p,u,n,a.length)),a},e.prototype.getPoints=function(e,t,i,r){var n,o,s=e.polynomialSlopes,a=[],l=1,h=1;for(t.sort((function(e,t){return e.xValue-t.xValue})),i.sort((function(e,t){return e-t}));h<=s.length;)1===h?(n=i[0]-e.backwardForecast,o=this.getPolynomialYValue(s,n),a.push(this.getDataPoint(n,o,r,a.length))):h===s.length?(n=i[t.length-1]+e.forwardForecast,o=this.getPolynomialYValue(s,n),a.push(this.getDataPoint(n,o,r,a.length))):(l+=(t.length+e.forwardForecast)/s.length,n=i[parseInt(l.toString(),10)-1],o=this.getPolynomialYValue(s,n),a.push(this.getDataPoint(n,o,r,a.length))),h++;return a},e.prototype.getPolynomialYValue=function(e,t){for(var i=0,r=0;r<e.length;)i+=e[r]*Math.pow(t,r),r++;return i},e.prototype.gaussJordanElimination=function(e,t){var i=e.length,r=[],n=[],o=[];r.length=i,n.length=i,o.length=i;for(var s=0;s<i;)o[s]=0,++s;for(var a=0;a<i;){for(var l=0,h=0,d=0,c=0;c<i;){if(1!==o[c])for(var p=0;p<i;)0===o[p]&&Math.abs(e[c][p])>=l&&(l=Math.abs(e[c][p]),h=c,d=p),++p;++c}if(++o[d],h!==d){for(var u=0;u<i;){var g=e[h][u];e[h][u]=e[d][u],e[d][u]=g,++u}var f=t[h];t[h]=t[d],t[d]=f}if(n[a]=h,r[a]=d,0===e[d][d])return!1;var m=1/e[d][d];e[d][d]=1;for(var y=0;y<i;)e[d][y]*=m,++y;t[d]*=m;for(var v=0;v<i;){if(v!==d){g=e[v][d];e[v][d]=0;for(p=0;p<i;)e[v][p]-=e[d][p]*g,++p;t[v]-=t[d]*g}++v}++a}for(var b=i-1;b>=0;){if(n[b]!==r[b])for(var w=0;w<i;){var x=e[w][n[b]];e[w][n[b]]=e[w][r[b]],e[w][r[b]]=x,++w}--b}return!0},e.prototype.getTrendLineElements=function(e,t){Pe(e);var i=e.clipRect,r=t.renderer.drawClipPath(new zt(t.element.id+"_ChartTrendlineClipRect_"+e.index,"transparent",{width:1,color:"Gray"},1,{x:0,y:0,width:i.width,height:i.height})),n=t.renderer.createGroup({id:t.element.id+"TrendlineSeriesGroup"+e.index,transform:"translate("+i.x+","+i.y+")","clip-path":"url(#"+t.element.id+"_ChartTrendlineClipRect_"+e.index+")"});n&&n.appendChild(r);for(var o=0,s=e.trendlines;o<s.length;o++){var a=s[o];this.createTrendLineElements(t,a,a.index,n,r)}},e.prototype.destroy=function(){},e.prototype.getModuleName=function(){return"TrendLine"},e}(),vo=function(){function e(e){this.arrowLocation=new jt(0,0),this.rx=2,this.ry=2,this.chart=e,this.elementID=this.chart.element.id,this.svgRenderer=new sf.svgbase.SvgRenderer(this.chart.element.id),this.addEventListener()}return e.prototype.addEventListener=function(){if(!this.chart.isDestroyed){var e=sf.base.Browser.isPointer?"pointerleave":"mouseleave";this.chart.on(sf.base.Browser.touchMoveEvent,this.mouseMoveHandler,this),this.chart.on(sf.base.Browser.touchEndEvent,this.mouseUpHandler,this),this.chart.on(e,this.mouseLeaveHandler,this),this.chart.on("tapHold",this.longPress,this)}},e.prototype.mouseUpHandler=function(){this.chart.startMove&&this.removeCrosshair(2e3)},e.prototype.mouseLeaveHandler=function(){this.removeCrosshair(1e3)},e.prototype.mouseMoveHandler=function(e){var t=this.chart;t.mouseX=t.mouseX/t.scaleX,t.mouseY=t.mouseY/t.scaleY,"touchmove"===e.type&&(sf.base.Browser.isIos||sf.base.Browser.isIos7)&&t.startMove&&e.preventDefault&&e.preventDefault(),t.disableTrackTooltip||(Ce(t.mouseX,t.mouseY,t.chartAxisLayoutPanel.seriesClipRect)?!t.startMove&&t.isTouch||this.crosshair():this.removeCrosshair(1e3))},e.prototype.longPress=function(){var e=this.chart;return Ce(e.mouseX,e.mouseY,e.chartAxisLayoutPanel.seriesClipRect)&&this.crosshair(),!1},e.prototype.crosshair=function(){var e,t,i=this.chart,r="",n="",o=document.getElementById(this.elementID+"_crosshair_axis"),s=i.crosshair,a=document.getElementById(this.elementID+"_tooltip"),l=i.chartAxisLayoutPanel.seriesClipRect,h=i.enableCanvas?document.getElementById(this.elementID+"_Secondary_Element"):document.getElementById(this.elementID+"_UserInteraction"),d=document.getElementById(this.elementID+"_Crosshair");if(i.enableCanvas&&(d||(d=sf.base.createElement("div",{id:this.elementID+"_Crosshair",styles:"position: absolute; pointer-events: none"}),h.appendChild(d))),this.stopAnimation(),i.tooltip.enable&&!Ce(i.tooltipModule.valueX,i.tooltipModule.valueY,l))return null;if(i.stockChart&&i.stockChart.onPanning)return this.removeCrosshair(1e3),null;if(this.valueX=i.tooltip.enable?i.tooltipModule.valueX:i.mouseX,this.valueY=i.tooltip.enable?i.tooltipModule.valueY:i.mouseY,i.enableCanvas||h.setAttribute("opacity","1"),"Both"!==s.lineType&&"Horizontal"!==s.lineType||(r+="M "+l.x+" "+this.valueY+" L "+(l.x+l.width)+" "+this.valueY),"Both"!==s.lineType&&"Vertical"!==s.lineType||(n+="M "+this.valueX+" "+l.y+" L "+this.valueX+" "+(l.y+l.height)),i.enableCanvas){o||(o=this.svgRenderer.createGroup({id:this.elementID+"_crosshair_axis"}));var c=i.tooltip.enable?i.element.id+"_tooltip_svg":i.element.id+"_svg";t=this.svgRenderer.createSvg({id:c,width:i.availableSize.width,height:i.availableSize.height}),i.tooltip.enable&&((a=a||i.tooltipModule.createElement()).appendChild(t),h.appendChild(a)),e=new sf.svgbase.PathOption(this.elementID+"_HorizontalLine","none",s.line.width,s.horizontalLineColor||s.line.color||i.themeStyle.crosshairLine,s.opacity,s.dashArray,r),this.drawCrosshairLine(e,d,l.x,this.valueY,l.width,0,r),e=new sf.svgbase.PathOption(this.elementID+"_VerticalLine","none",s.line.width,s.verticalLineColor||s.line.color||i.themeStyle.crosshairLine,s.opacity,s.dashArray,n),this.drawCrosshairLine(e,d,this.valueX,l.y,0,l.height,n),this.renderAxisTooltip(i,l,o),t.appendChild(o),i.tooltip.enable||d.appendChild(t)}else 0===h.childNodes.length?(o=i.renderer.createGroup({id:this.elementID+"_crosshair_axis"}),e=new sf.svgbase.PathOption(this.elementID+"_HorizontalLine","none",s.line.width,s.horizontalLineColor||s.line.color||i.themeStyle.crosshairLine,s.opacity,s.dashArray,r),this.renderCrosshairLine(e,h),e=new sf.svgbase.PathOption(this.elementID+"_VerticalLine","none",s.line.width,s.verticalLineColor||s.line.color||i.themeStyle.crosshairLine,s.opacity,s.dashArray,n),this.renderCrosshairLine(e,h),h.appendChild(o),this.renderAxisTooltip(i,l,h.lastChild)):(document.getElementById(this.elementID+"_HorizontalLine").setAttribute("d",r),document.getElementById(this.elementID+"_VerticalLine").setAttribute("d",n),this.renderAxisTooltip(i,l,h.lastChild))},e.prototype.renderCrosshairLine=function(e,t){var i=this.chart.renderer.drawPath(e);t.appendChild(i)},e.prototype.drawCrosshairLine=function(e,t,i,r,n,o,s){if(!document.getElementById(e.id)&&s){var a=sf.base.createElement("div",{id:e.id});t.appendChild(a)}if(document.getElementById(e.id)){var l="top:"+r.toString()+"px;left:"+i.toString()+"px;width:"+n+"px;height:"+o+"px;fill:"+e.stroke+";border: 0.5px solid "+e.stroke+";opacity: "+e.opacity+" ; position: absolute",h=document.getElementById(e.id),d=document.getElementById(this.elementID+"_crosshair_axis");h.style.cssText=l,t.style.opacity="1",d&&(d.style.opacity="1")}},e.prototype.renderAxisTooltip=function(e,t,i){for(var r,n,o,s,a,l,h,d,c=0,p=e.axisCollections.length;c<p;c++)if(d=(r=e.axisCollections[c]).placeNextToAxisLine?r.updatedRect:r.rect,r.crosshairTooltip.enable)if(this.valueX<=d.x+d.width&&d.x<=this.valueX||this.valueY<=d.y+d.height&&d.y<=this.valueY){if(s=document.getElementById(this.elementID+"_axis_tooltip_"+c),a=document.getElementById(this.elementID+"_axis_tooltip_text_"+c),(n=this.getAxisText(r))&&n.indexOf("<br")>-1&&(n=this.getAxisText(r).split(/<br.*?>/g)),!n)continue;if(o=this.tooltipLocation(n,r,t,d),null===s)s=e.enableCanvas?this.svgRenderer.drawPath({id:this.elementID+"_axis_tooltip_"+c,fill:r.crosshairTooltip.fill||e.themeStyle.crosshairFill}):e.renderer.drawPath({id:this.elementID+"_axis_tooltip_"+c,fill:r.crosshairTooltip.fill||e.themeStyle.crosshairFill},null),i.appendChild(s),l=new sf.svgbase.TextOption(this.elementID+"_axis_tooltip_text_"+c,0,0,"start",n),a=It(e.enableCanvas?this.svgRenderer:e.renderer,l,r.crosshairTooltip.textStyle,r.crosshairTooltip.textStyle.color||e.themeStyle.crosshairLabel,i,null,null,null,null,null,null,0,null,e.enableCanvas);if(h=Se(this.rx,this.ry,o,this.arrowLocation,9,this.isTop,this.isBottom,this.isLeft,this.valueX,this.valueY),s.setAttribute("d",h),"string"!=typeof n&&n.length>1)for(var u=0;u<n.length;u++)a.childNodes[u].textContent=n[u];else a.textContent=n;if(a.setAttribute("x",(o.x+5+(e.enableRtl?this.elementSize.width:0)).toString()),a.setAttribute("y",(o.y+5+3*this.elementSize.height/4).toString()),"string"!=typeof n&&n.length>1){var g=0;a.setAttribute("y",(o.y+5+3*this.elementSize.height/(4*n.length)).toString());for(u=0;u<a.children.length;u++)g+=this.elementSize.height/n.length,a.children[u].setAttribute("x",(o.x+5+(e.enableRtl?this.elementSize.width:0)+this.elementSize.width/2).toString()),a.children[u].setAttribute("y",(parseInt(a.getAttribute("y"))+g).toString()),a.children[u].setAttribute("style","text-anchor: middle")}if("Fluent"===this.chart.theme||"FluentDark"===this.chart.theme){var f=this.chart.element.id+"_shadow";s.setAttribute("filter",sf.base.Browser.isIE?"":"url(#"+f+")");var m='<filter id="'+f+'" height="130%"><feGaussianBlur in="SourceAlpha" stdDeviation="3"/>';m+='<feOffset dx="3" dy="3" result="offsetblur"/><feComponentTransfer><feFuncA type="linear" slope="0.5"/>',m+='</feComponentTransfer><feMerge><feMergeNode/><feMergeNode in="SourceGraphic"/></feMerge></filter>';var y=this.chart.renderer.createDefs();y.setAttribute("id",this.chart.element.id+"SVG_tooltip_definition"),i.appendChild(y),y.innerHTML=m,s.setAttribute("stroke","#cccccc"),s.setAttribute("stroke-width","0.5")}}else ie(this.elementID+"_axis_tooltip_"+c),ie(this.elementID+"_axis_tooltip_text_"+c)},e.prototype.getAxisText=function(e){var t;this.isBottom=!1,this.isTop=!1,this.isLeft=!1,this.isRight=!1;var i="Category"===e.valueType&&"BetweenTicks"===e.labelPlacement?.5:0,r=e.isAxisOpposedPosition;return"Horizontal"===e.orientation?(t=Oe(Math.abs(this.valueX-e.rect.x),e.rect.width,e)+i,this.isBottom=!r,this.isTop=r):(t=Te(Math.abs(this.valueY-e.rect.y),e.rect.height,e)+i,this.isRight=r,this.isLeft=!r),"DateTime"===e.valueType?e.format(new Date(t)):"Category"===e.valueType?e.labels[Math.floor(t)]:"DateTimeCategory"===e.valueType?this.chart.dateTimeCategoryModule.getIndexedAxisLabel(e.labels[Math.floor(t)],e.format):"Logarithmic"===e.valueType?e.format(Math.pow(e.logBase,t)):e.labelFormat&&null!==e.labelFormat.match("{value}")?e.labelFormat.replace("{value}",e.format(t)):e.format(t)},e.prototype.tooltipLocation=function(e,t,i,r){var n,o=i.x,s=i.y,a="Inside"===t.labelPosition,l=t.scrollbarSettings.enable||t.zoomingScrollBar&&t.zoomingScrollBar.svgObject?t.scrollBarHeight:0;if(this.elementSize=sf.svgbase.measureText(e,t.crosshairTooltip.textStyle),"string"!=typeof e&&e.length>1){this.elementSize.width=0,this.elementSize.height=0;for(var h=0;h<e.length;h++){var d=sf.svgbase.measureText(e[h],t.crosshairTooltip.textStyle);this.elementSize.height+=d.height,this.elementSize.width<d.width&&(this.elementSize.width=d.width)}}var c=t.isAxisOpposedPosition;if("Horizontal"===t.orientation){var p=a?r.y-this.elementSize.height-19:r.y+l,u=a?r.y-this.elementSize.height-9:r.y+9;this.arrowLocation=new jt(this.valueX,p),n=new sf.svgbase.Rect(this.valueX-this.elementSize.width/2-5,u+(a?0:l),this.elementSize.width+10,this.elementSize.height+10),c&&(n.y=a?r.y:r.y-(this.elementSize.height+10+9)-l),n.x<o&&(n.x=o),n.x+n.width>o+i.width&&(n.x-=n.x+n.width-(o+i.width)),this.arrowLocation.x+4.5>n.x+n.width-this.rx&&(this.arrowLocation.x=n.x+n.width-this.rx-9),this.arrowLocation.x-9<n.x+this.rx&&(this.arrowLocation.x=n.x+this.rx+9)}else{l*=c?1:-1,this.arrowLocation=new jt(r.x,this.valueY);var g=a?r.x-l:r.x-this.elementSize.width-19;n=new sf.svgbase.Rect(g+l,this.valueY-this.elementSize.height/2-5,this.elementSize.width+10,this.elementSize.height+10),c?(n.x=a?r.x-this.elementSize.width-9:r.x+9+l,n.x+n.width>this.chart.availableSize.width&&(this.arrowLocation.x-=n.x+n.width-this.chart.availableSize.width,n.x-=n.x+n.width-this.chart.availableSize.width)):n.x<0&&(this.arrowLocation.x-=n.x,n.x=0),n.y<s&&(n.y=s),n.y+n.height>=s+i.height&&(n.y-=n.y+n.height-(s+i.height)),this.arrowLocation.y+4.5>n.y+n.height-this.ry&&(this.arrowLocation.y=n.y+n.height-this.ry-4.5),this.arrowLocation.y-4.5<n.y+this.ry&&(this.arrowLocation.y=n.y+this.ry+4.5)}return n},e.prototype.stopAnimation=function(){lt(this.crosshairInterval)},e.prototype.progressAnimation=function(){lt(this.crosshairInterval)},e.prototype.removeCrosshair=function(e){var t=this.chart,i=t.enableCanvas?document.getElementById(this.elementID+"_Crosshair"):document.getElementById(this.elementID+"_UserInteraction"),r=t.enableCanvas?document.getElementById(this.elementID+"_crosshair_axis"):null;this.stopAnimation(),i&&"0"!==i.getAttribute("opacity")&&(this.crosshairInterval=+setTimeout((function(){new sf.base.Animation({}).animate(i,{duration:200,progress:function(e){i.style.animation="",t.enableCanvas?(i.style.opacity=(1-e.timeStamp/e.duration).toString(),r.style.opacity=(1-e.timeStamp/e.duration).toString()):i.setAttribute("opacity",(1-e.timeStamp/e.duration).toString())},end:function(){t.enableCanvas?(i.style.opacity="0",r.style.opacity="0"):i.setAttribute("opacity","0"),t.startMove=!1,t.tooltipModule&&(t.tooltipModule.valueX=null,t.tooltipModule.valueY=null)}})}),e))},e.prototype.getModuleName=function(){return"Crosshair"},e.prototype.destroy=function(){},e}(),bo=(Yi=function(e,t){return(Yi=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}Yi(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),wo=function(e){function t(t){var i=e.call(this,t)||this;return i.element=i.chart.element,i.textStyle=t.tooltip.textStyle,i.control=t,i.template=t.tooltip.template,i}return bo(t,e),t.prototype.getElement=function(e){return document.getElementById(e)},t.prototype.getTooltipElement=function(e){this.inverted=this.chart.requireInvertedAxis,this.header=null===this.control.tooltip.header?this.control.tooltip.shared?"<b>${point.x}</b>":"<b>${series.name}</b>":this.control.tooltip.header,this.formattedText=[];var t=document.getElementById(this.chart.element.id+"_tooltip"),i=this.chart.element.id.indexOf("stockChart")>-1;return!e&&!t||i?this.createElement():null},t.prototype.createElement=function(){var e=document.createElement("div");return e.id=this.element.id+"_tooltip",e.className="ejSVGTooltip",e.style.pointerEvents="none",e.style.position="absolute",e.style.zIndex="1",e},t.prototype.pushData=function(e,t,i,r){return!!e.series.enableTooltip&&(this.currentPoints.push(e),this.stopAnimation(),i&&!document.getElementById(i.id)&&(this.chart.stockChart?document.getElementById(this.chart.stockChart.element.id+"_Secondary_Element").appendChild(i):document.getElementById(this.element.id+"_Secondary_Element").appendChild(i)),!0)},t.prototype.removeHighlight=function(){for(var e,t=0,i=this.previousPoints.length;t<i;t++)(e=this.previousPoints[t]).series.isRectSeries?e.series.visible&&this.highlightPoint(e.series,e.point.index,!1):e.series},t.prototype.highlightPoint=function(e,t,i){var r=this.getElement(this.element.id+"_Series_"+e.index+"_Point_"+t),n=this.control.accumulationSelectionModule,o=!!(n&&n.selectedDataIndexes.length>0);r&&(!o||o&&r.getAttribute("class")&&-1===r.getAttribute("class").indexOf("_ej2_chart_selection_series_")?""===this.chart.highlightColor||sf.base.isNullOrUndefined(this.chart.highlightColor)?r.setAttribute("opacity",(i&&"transparent"!==this.chart.highlightColor?e.opacity/2:e.opacity).toString()):r.setAttribute("fill",i&&"transparent"!==this.chart.highlightColor?this.chart.highlightColor:""!==e.pointColorMapping?e.points[0].color:e.points[t].color||e.interior):r.setAttribute("opacity",e.opacity.toString()))},t.prototype.highlightPoints=function(){for(var e=0,t=this.currentPoints;e<t.length;e++){var i=t[e];i.series.isRectSeries&&"Series"===i.series.category&&this.highlightPoint(i.series,i.point.index,!0)}},t.prototype.createTooltip=function(e,t,i,r,n,o,s,a,l,h,d,c){void 0===l&&(l=!1),void 0===h&&(h=null),void 0===d&&(d=null);var p=this.currentPoints[0].series,u=e.tooltipModule||e.accumulationTooltipModule;u&&null!==i&&(t?this.svgTooltip=new sf.svgbase.Tooltip({opacity:e.tooltip.opacity,header:this.headerText,content:this.text,fill:e.tooltip.fill,border:e.tooltip.border,enableAnimation:e.tooltip.enableAnimation,location:i,shared:e.tooltip.shared,crosshair:l,shapes:o,clipBounds:"PolarRadar"===this.chart.chartAreaType?new jt(0,0):r,areaBounds:a,palette:this.findPalette(),template:c||this.template,data:d,theme:e.theme,offset:s,textStyle:e.tooltip.textStyle,isNegative:p.isRectSeries&&"Waterfall"!==p.type&&n&&n.y<0,inverted:this.chart.requireInvertedAxis&&p.isRectSeries,arrowPadding:this.text.length>1||this.chart.stockChart?0:7,availableSize:e.availableSize,duration:this.chart.tooltip.duration,isCanvas:this.chart.enableCanvas,isTextWrap:e.tooltip.enableTextWrap&&"chart"===e.getModuleName(),blazorTemplate:{name:"Template",parent:this.chart.tooltip},controlInstance:this.chart,enableRTL:e.enableRtl,controlName:"Chart",tooltipRender:function(){u.removeHighlight(),u.highlightPoints(),u.updatePreviousPoint(h)},animationComplete:function(e){e.tooltip.fadeOuted&&u.fadeOut(u.previousPoints)}},"#"+this.element.id+"_tooltip"):this.svgTooltip&&(this.svgTooltip.location=i,this.svgTooltip.content=this.text,this.svgTooltip.header=this.headerText,this.svgTooltip.offset=s,this.svgTooltip.palette=this.findPalette(),this.svgTooltip.shapes=o,this.svgTooltip.data=d,this.svgTooltip.template=this.template,this.svgTooltip.controlName="Chart",this.svgTooltip.crosshair=l,this.svgTooltip.textStyle=e.tooltip.textStyle,this.svgTooltip.isNegative=p.isRectSeries&&"Waterfall"!==p.type&&n&&n.y<0,this.svgTooltip.clipBounds="PolarRadar"===this.chart.chartAreaType?new jt(0,0):r,this.svgTooltip.arrowPadding=this.text.length>1||this.chart.stockChart?0:7,this.svgTooltip.dataBind()),this.chart.isReact&&this.chart.renderReactTemplates())},t.prototype.findPalette=function(){for(var e=[],t=0,i=this.currentPoints;t<i.length;t++){var r=i[t];e.push(this.findColor(r,r.series))}return e},t.prototype.findColor=function(e,t){return!t.isRectSeries||"Candle"!==t.type&&"Hilo"!==t.type&&"HiloOpenClose"!==t.type?(e.point.color&&"#ffffff"!==e.point.color?e.point.color:e.point.interior)||t.marker.fill||t.interior:e.point.color},t.prototype.updatePreviousPoint=function(e){e&&(this.currentPoints=this.currentPoints.concat(e)),this.previousPoints=sf.base.extend([],this.currentPoints,null,!0)},t.prototype.fadeOut=function(e){var t=this.chart.enableCanvas?this.getElement(this.element.id+"_tooltip_group"):this.getElement(this.element.id+"_tooltip_svg");t&&parseInt(t.getAttribute("opacity"),10)>0||(this.valueX=null,this.valueY=null,this.currentPoints=[],this.removeHighlight(),this.removeHighlightedMarker(e,!0),this.svgTooltip=null,this.control.trigger("animationComplete",{}))},t.prototype.removeHighlightedMarker=function(e,t){if(this.chart.markerRender)for(var i=0,r=e;i<r.length;i++){var n=r[i];ie(this.element.id+"_Series_"+n.series.index+"_Point_"+n.point.index+"_Trackball"),this.chart.markerRender.removeHighlightedMarker(n.series,n.point,t)}this.previousPoints=[]},t.prototype.removeText=function(){this.textElements=[];var e=this.getElement(this.element.id+"_tooltip_group");if(e&&e.childNodes.length>0)for(;e.lastChild&&1!==e.childNodes.length;)e.removeChild(e.lastChild)},t.prototype.stopAnimation=function(){lt(this.toolTipInterval)},t.prototype.removeTooltip=function(e){var t=this,i=this.getElement(this.element.id+"_tooltip"),r=i?this.getElement(i.id+"parent_template"):null;r&&r.innerHTML;this.stopAnimation(),i&&this.previousPoints.length>0&&(this.toolTipInterval=+setTimeout((function(){t.svgTooltip&&t.svgTooltip.fadeOut()}),e))},t}(tr),xo=(Qi=function(e,t){return(Qi=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}Qi(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),Mo=function(e){function t(t){var i=e.call(this,t)||this;return i.commonXvalues=[],i.addEventListener(),i}return xo(t,e),t.prototype.addEventListener=function(){if(!this.chart.isDestroyed){var e=sf.base.Browser.isPointer?"pointerleave":"mouseleave";this.chart.on(e,this.mouseLeaveHandler,this),this.chart.on("tapHold",this.longPress,this),this.chart.on(sf.base.Browser.touchMoveEvent,this.mouseMoveHandler,this),this.chart.on(sf.base.Browser.touchEndEvent,this.mouseUpHandler,this)}},t.prototype.mouseUpHandler=function(){var e=this.control,t=this.getData();t.lierIndex=this.lierIndex,e.isTouch&&!this.isSelected(e)&&(Ce(e.mouseX,e.mouseY,e.chartAxisLayoutPanel.seriesClipRect)&&e.tooltip.shared||!e.tooltip.shared)?e.crosshair.enable?e.startMove&&"Move"===e.tooltip.fadeOutMode&&this.removeTooltip(2e3):(this.tooltip(),"Move"===e.tooltip.fadeOutMode&&this.removeTooltip(e.tooltip.fadeOutDuration)):this.findData(t,this.previousPoints[0])||"Click"!==e.tooltip.fadeOutMode||this.removeTooltip(0)},t.prototype.mouseLeaveHandler=function(){this.removeTooltip(this.chart.tooltip.fadeOutDuration)},t.prototype.mouseMoveHandler=function(){var e=this.chart;e.mouseX=e.mouseX/e.scaleX,e.mouseY=e.mouseY/e.scaleY,e.disableTrackTooltip||this.isSelected(e)||(e.tooltip.shared||e.isTouch&&!e.startMove||this.tooltip(),Ce(e.mouseX,e.mouseY,e.chartAxisLayoutPanel.seriesClipRect)?!e.tooltip.shared||e.isTouch&&!e.startMove||this.tooltip():e.tooltip.shared&&"Move"===e.tooltip.fadeOutMode&&this.removeTooltip(this.chart.tooltip.fadeOutDuration))},t.prototype.longPress=function(){var e=this.chart;return e.crosshair.enable&&Ce(e.mouseX,e.mouseY,e.chartAxisLayoutPanel.seriesClipRect)&&this.tooltip(),!1},t.prototype.tooltip=function(){if(this.chart.stockChart&&this.chart.stockChart.onPanning)return this.removeTooltip(1e3),null;var e=this.chart.enableCanvas?this.element.id+"_tooltip_group":this.element.id+"_tooltip_svg",t=this.getElement(e),i=this.chart.stockChart&&t&&t.firstChild.childNodes.length>1,r=t&&parseInt(t.getAttribute("opacity"),10)>0&&!i,n=this.getTooltipElement(r);this.chart.enableCanvas&&n&&(document.getElementById(this.chart.element.id+"_Secondary_Element").appendChild(n),n.appendChild(document.getElementById(this.chart.element.id+"_tooltip_svg"))),this.chart.tooltip.shared?this.renderGroupedTooltip(this.chart,!r,n):this.renderSeriesTooltip(this.chart,!r,n)},t.prototype.findHeader=function(e){return""===this.header?"":(this.header=this.parseTemplate(e.point,e.series,this.header,e.series.xAxis,e.series.yAxis),""!==this.header.replace(/<b>/g,"").replace(/<\/b>/g,"").trim()?this.header:"")},t.prototype.findShapes=function(){if(!this.chart.tooltip.enableMarker)return[];for(var e=[],t=0,i=this.currentPoints;t<i.length;t++){var r=i[t];e.push(r.point.marker.shape||r.series.marker.shape)}return e},t.prototype.renderSeriesTooltip=function(e,t,i){var r=this.getData();if(r.lierIndex=this.lierIndex,this.currentPoints=[],this.findData(r,this.previousPoints[0])){if((!e.dataEditingModule||!e.dataEditingModule.isPointDragging)&&this.previousPoints[0]&&r.point.index===this.previousPoints[0].point.index&&r.series.index===this.previousPoints[0].series.index)return null;this.pushData(r,t,i,!0)&&this.triggerTooltipRender(r,t,this.getTooltipText(r),this.findHeader(r))}else if(!r.point&&this.isRemove&&"Move"===e.tooltip.fadeOutMode)this.removeTooltip(this.chart.tooltip.fadeOutDuration),this.isRemove=!1;else for(var n=this.mergeXvalues(this.chart.visibleSeries),o=0,s=e.visibleSeries;o<s.length;o++){var a=s[o];a.visible&&"TrendLine"!==a.category&&(r=this.getClosestX(e,a,n)||r)}r&&r.point&&this.findMouseValue(r,e)},t.prototype.triggerTooltipRender=function(e,t,i,r){var n=this,o={cancel:!1,name:"tooltipRender",text:i,headerText:r,template:void 0,series:this.chart.isBlazor?{}:e.series,textStyle:this.textStyle,point:e.point,data:{pointX:e.point.x,pointY:e.point.y,seriesIndex:e.series.index,seriesName:e.series.name,pointIndex:e.point.index,pointText:e.point.text}},s=this.chart.border.width,a=function(i){i.cancel?(n.removeHighlight(),sf.base.remove(n.getElement(n.element.id+"_tooltip"))):("BoxAndWhisker"===e.series.type&&(n.removeText(),t=!0),n.headerText=i.headerText,n.formattedText=n.formattedText.concat(i.text),n.text=n.formattedText,n.createTooltip(n.chart,t,n.getSymbolLocation(e),e.series.clipRect,e.point,n.findShapes(),n.findMarkerHeight(n.currentPoints[0]),new sf.svgbase.Rect(s,s,n.chart.availableSize.width-3-2*s,n.chart.availableSize.height-3-2*s),n.chart.crosshair.enable,null,n.getTemplateText(e),n.template?i.template:"")),n.isRemove=!0};a.bind(this,e),this.chart.trigger("tooltipRender",o,a)},t.prototype.findMarkerHeight=function(e){if(!this.chart.tooltip.enableMarker)return 0;var t=e.series;return(t.marker.visible||this.chart.tooltip.shared&&(!t.isRectSeries||t.marker.visible)||"Scatter"===t.type||"Scatter"===t.drawType)&&"Candle"!==t.type&&"Hilo"!==t.type&&"HiloOpenClose"!==t.type?(t.marker.height+2)/2+2*t.marker.border.width:0},t.prototype.findData=function(e,t){return e.point&&(!t||t.point!==e.point||t&&t.lierIndex>3&&t.lierIndex!==this.lierIndex||t.point===e.point)},t.prototype.getSymbolLocation=function(e){var t;if("BoxAndWhisker"!==e.series.type){if(!e.point.symbolLocations[0])return null;t=new jt(e.point.symbolLocations[0].x,e.point.symbolLocations[0].y)}switch(e.series.type){case"BoxAndWhisker":return this.getBoxLocation(e);case"Waterfall":return this.getWaterfallRegion(e,t);case"RangeArea":case"SplineRangeArea":case"RangeColumn":return this.getRangeArea(e,t);default:return t}},t.prototype.getRangeArea=function(e,t){return e.point.regions[0]&&(this.inverted?t.x=e.point.regions[0].x+e.point.regions[0].width/2:t.y=e.point.regions[0].y+e.point.regions[0].height/2),t},t.prototype.getWaterfallRegion=function(e,t){return this.inverted?t.x=e.point.y<0?t.x+e.point.regions[0].width:t.x:t.y=e.point.y<0?t.y-e.point.regions[0].height:t.y,t},t.prototype.getTooltipText=function(e){var t=e.series;return this.parseTemplate(e.point,t,this.getFormat(this.chart,t),t.xAxis,t.yAxis)},t.prototype.getTemplateText=function(e){if(this.template&&this.chart.tooltip.shared){(i=sf.base.extend({},e[0].point)).x=this.formatPointValue(e[0].point,e[0].series.xAxis,"x",!0,!1);for(var t=0;t<e.length;t++)"XY"===e[t].series.seriesType?i.y=this.formatPointValue(e[t].point,e[t].series.yAxis,"y",!1,!0):(i.low=this.formatPointValue(e[t].point,e[t].series.yAxis,"low",!1,!0),i.high=this.formatPointValue(e[t].point,e[t].series.yAxis,"high",!1,!0));return i}var i;return this.template?((i=sf.base.extend({},e.point)).x=this.formatPointValue(e.point,e.series.xAxis,"x",!0,!1),"XY"===e.series.seriesType?i.y=this.formatPointValue(e.point,e.series.yAxis,"y",!1,!0):(i.low=this.formatPointValue(e.point,e.series.yAxis,"low",!1,!0),i.high=this.formatPointValue(e.point,e.series.yAxis,"high",!1,!0)),i):e.point},t.prototype.findMouseValue=function(e,t){t.requireInvertedAxis?(this.valueY=(1-ye(e.point.xValue,e.series.xAxis))*e.series.xAxis.rect.height+e.series.xAxis.rect.y,this.valueX=t.mouseX):("PolarRadar"===t.chartAreaType?this.valueX=we(e.point.xValue,e.series.xAxis)*e.series.xAxis.rect.width+e.series.xAxis.rect.x:this.valueX="TrendLine"===e.series.category&&t.tooltip.shared?this.valueX:ye(e.point.xValue,e.series.xAxis)*e.series.xAxis.rect.width+e.series.xAxis.rect.x,this.valueY=t.mouseY)},t.prototype.renderGroupedTooltip=function(e,t,i){var r,n,o=[],s="PolarRadar"===e.chartAreaType?this.getData():null;this.stopAnimation(),this.removeHighlight(),this.currentPoints=[];t&&(e.stockChart?i&&!sf.svgbase.getElement(i.id)&&document.getElementById(e.stockChart.element.id+"_Secondary_Element").appendChild(i):i&&document.getElementById(this.element.id+"_Secondary_Element").appendChild(i)),this.removeText();for(var a={text:[],cancel:!1,name:"sharedTooltipRender",data:[],point:[],series:[],headerText:"",textStyle:this.textStyle,template:""},l=0,h=0,d=e.visibleSeries;h<d.length;h++){var c=d[h];if(c.enableTooltip&&c.visible){"Cartesian"===e.chartAreaType&&c.visible?r=this.getClosestX(e,c,this.commonXValue(this.chart.visibleSeries)):"PolarRadar"===e.chartAreaType&&c.visible&&null!==s.point&&(r=new _t(c.points[s.point.index],c));var p=!0;e.tooltip.showNearestPoint&&!r&&(r=this.getClosestX(e,c,this.commonXValue([c])),p=!1),r&&(a.data.push({pointX:r.point.x,pointY:r.point.y,seriesIndex:r.series.index,seriesName:r.series.name,pointIndex:r.point.index,pointText:r.point.text}),a.series[l]=r.series,a.point[l]=r.point,a.headerText=this.findHeader(r),this.currentPoints.push(r),a.text.push(this.getTooltipText(r)),p&&(n="TrendLine"===r.series.category&&e.tooltip.shared?n:r),o.push(r)),l++}}o.length>0&&this.currentPoints.length>0?this.triggerSharedTooltip(a,n,[],e,t,o):this.getElement(this.element.id+"_tooltip_path")&&this.getElement(this.element.id+"_tooltip_path").setAttribute("d","")},t.prototype.triggerSharedTooltip=function(e,t,i,r,n,o){var s=this,a={cancel:!1,name:"sharedTooltipRender",text:e.text,headerText:e.headerText,textStyle:e.textStyle,template:void 0,point:e.point,series:e.series,data:e.data},l=this.chart.border.width,h=function(e){e.cancel?i.push(t):("BoxAndWhisker"===t.series.type&&(s.removeText(),n=!0),s.formattedText=s.formattedText.concat(e.text),s.text=e.text,s.headerText=e.headerText,s.findMouseValue(t,s.chart),s.createTooltip(r,n,s.findSharedLocation(),1===s.currentPoints.length?s.currentPoints[0].series.clipRect:null,1===o.length?o[0].point:null,s.findShapes(),s.findMarkerHeight(s.currentPoints[0]),new sf.svgbase.Rect(l,l,s.chart.availableSize.width-3-2*l,s.chart.availableSize.height-3-2*l),s.chart.crosshair.enable,i,s.template?s.getTemplateText(o):null,s.template?e.template:""),t=null)};h.bind(this,t,i),this.chart.trigger("sharedTooltipRender",a,h)},t.prototype.findSharedLocation=function(){var e=this.chart.stockChart;if(e){1===this.text.length&&this.text.push("");var t=e.enablePeriodSelector?e.toolbarHeight:0,i=document.getElementById(e.element.id+"_ChartTitle"),r=""!==e.title?i.getBoundingClientRect().height+10:0;return new jt(this.chart.chartAxisLayoutPanel.seriesClipRect.x+5,this.chart.chartAxisLayoutPanel.seriesClipRect.y+t+5+r)}return this.currentPoints.length>1?new jt(this.valueX,this.valueY):this.getSymbolLocation(this.currentPoints[0])},t.prototype.getBoxLocation=function(e){return this.lierIndex>3?e.point.symbolLocations[this.lierIndex-4]:{x:e.point.regions[0].x+e.point.regions[0].width/2,y:e.point.regions[0].y+e.point.regions[0].height/2}},t.prototype.parseTemplate=function(e,t,i,r,n){for(var o,s,a=0,l=Object.keys(e);a<l.length;a++){var h=l[a];o=new RegExp("${point."+h+"}","gm"),i=i.replace(o.source,this.formatPointValue(e,"${point.x}"===o.source?r:n,h,"${point.x}"===o.source,"${point.high}"===o.source||"${point.open}"===o.source||"${point.close}"===o.source||"${point.low}"===o.source||"${point.y}"===o.source||"${point.minimum}"===o.source||"${point.maximum}"===o.source||"${point.outliers}"===o.source||"${point.upperQuartile}"===o.source||"${point.lowerQuartile}"===o.source||"${point.median}"===o.source))}for(var d=0,c=Object.keys(Object.getPrototypeOf(t));d<c.length;d++){h=c[d];o=new RegExp("${series."+h+"}","gm"),s=t[h],i=i.replace(o.source,s)}return i},t.prototype.formatPointValue=function(e,t,i,r,n){var o,s,a;return"Category"!==t.valueType&&r?o=(s=t.labelFormat&&null!==t.labelFormat.match("{value}"))?t.labelFormat.replace("{value}",t.format(e[i])):t.format(e[i]):n&&!sf.base.isNullOrUndefined(e[i])?(s=t.labelFormat&&null!==t.labelFormat.match("{value}"),a="outliers"===i?t.format(e[i][this.lierIndex-4]):t.format(e[i]),o=s?t.labelFormat.replace("{value}",a):a):o=e[i],o},t.prototype.getFormat=function(e,t){if(t.tooltipFormat)return"XY"===t.seriesType&&"Indicator"===t.category?this.getIndicatorTooltipFormat(t,e,e.tooltip.format):t.tooltipFormat;if(!t.tooltipFormat&&e.tooltip.format)return"XY"===t.seriesType&&"Indicator"===t.category?this.getIndicatorTooltipFormat(t,e,e.tooltip.format):e.tooltip.format;var i="Histogram"===t.type?"${point.minimum}-${point.maximum}":"${point.x}",r=e.tooltip.shared?"${series.name}":i;switch(t.seriesType){case"XY":return"Indicator"===t.category&&this.getIndicatorTooltipFormat(t,e,e.tooltip.format),r+" : "+("Bubble"===t.type?"<b>${point.y}</b>  Size : <b>${point.size}</b>":"<b>${point.y}</b>");case"HighLow":return r+"<br/>High : <b>${point.high}</b><br/>Low : <b>${point.low}</b>";case"HighLowOpenClose":return r+"<br/>High : <b>${point.high}</b><br/>Low : <b>${point.low}</b><br/>Open : <b>${point.open}</b><br/>Close : <b>${point.close}</b>";case"BoxPlot":return r+"<br/>"+(this.lierIndex>3?"Outliers : <b>${point.outliers}</b>":"Maximum : <b>${point.maximum}</b><br/>Q3 : <b>${point.upperQuartile}</b><br/>Median : <b>${point.median}</b><br/>Q1 : <b>${point.lowerQuartile}</b><br/>Minimum : <b>${point.minimum}</b>");default:return""}},t.prototype.getIndicatorTooltipFormat=function(e,t,i){return"XY"===e.seriesType?e.name+" : <b>${point.y}</b>":i},t.prototype.removeHighlightedMarker=function(e,t){for(var i=0,r=e;i<r.length;i++){var n=r[i];ie(this.element.id+"_Series_"+n.series.index+"_Point_"+n.point.index+"_Trackball"),this.chart.markerRender&&this.chart.markerRender.removeHighlightedMarker(n.series,n.point,t)}this.previousPoints=[]},t.prototype.getModuleName=function(){return"Tooltip"},t.prototype.destroy=function(){},t}(wo),No=function(){function e(e){this.iconRectOverFill="transparent",this.iconRectSelectionFill="transparent",this.zoomCompleteEvtCollection=[],this.chart=e,this.elementId=e.element.id,this.chart.svgRenderer=new sf.svgbase.SvgRenderer(this.elementId),this.selectionColor="Bootstrap4"===e.theme?"#FFFFFF":"Tailwind"===e.theme||"Bootstrap5"===e.theme||"Bootstrap5Dark"===e.theme||"TailwindDark"===e.theme?"#374151":"Fluent"===e.theme?"#201F1E":"FluentDark"===e.theme?"#A19F9D":"#ff4081",this.fillColor="Bootstrap4"===e.theme?"#495057":"Tailwind"===e.theme?"#6B7280":"TailwindDark"===e.theme?"#D1D5DB":"Fluent"===e.theme?"#A19F9D":"FluentDark"===e.theme?"#484644":"#737373",this.iconRectOverFill="Bootstrap4"===e.theme?"#5A6268":this.iconRectOverFill,this.iconRectSelectionFill="Bootstrap4"===e.theme?"#5B6269":this.iconRectSelectionFill,this.iconRect="Bootstrap4"===e.theme?new sf.svgbase.Rect(-5,-5,26,26):new sf.svgbase.Rect(0,0,16,16)}return e.prototype.createPanButton=function(e,t){var i=this.chart.svgRenderer,r=this.chart.zoomModule.isPanning?this.selectionColor:this.fillColor;this.elementOpacity=!this.chart.zoomModule.isZoomed&&this.chart.zoomSettings.showToolbar?"0.2":"1",e.setAttribute("opacity",this.elementOpacity),e.id=this.elementId+"_Zooming_Pan",e.setAttribute("aria-label",this.chart.getLocalizedLabel("Pan")),this.panElements=e,e.appendChild(i.drawRectangle(new zt(this.elementId+"_Zooming_Pan_1","transparent",{},1,this.iconRect))),e.appendChild(i.drawPath(new sf.svgbase.PathOption(this.elementId+"_Zooming_Pan_2",r,null,null,1,null,"M5,3h2.3L7.275,5.875h1.4L8.65,3H11L8,0L5,3z M3,11V8.7l2.875,0.025v-1.4L3,7.35V5L0,8L3,11z M11,13H8.7l0.025-2.875h-1.4L7.35,13H5l3,3L11,13z M13,5v2.3l-2.875-0.025v1.4L13,8.65V11l3-3L13,5z"))),t.appendChild(e),this.wireEvents(e,this.pan)},e.prototype.createZoomButton=function(e,t){var i=this.chart.svgRenderer,r=this.chart.zoomModule.isPanning||!this.chart.zoomModule.isZoomed&&this.chart.zoomSettings.showToolbar?this.fillColor:this.selectionColor,n=this.chart.zoomModule.isPanning?"transparent":this.iconRectSelectionFill,o="M0.001,14.629L1.372,16l4.571-4.571v-0.685l0.228-0.274c1.051,0.868,2.423,1.417,3.885,1.417c3.291,0,";o+="5.943-2.651,5.943-5.943S13.395,0,10.103,0S4.16,2.651,4.16,5.943c0,1.508,0.503,2.834,1.417,3.885l-0.274,0.228H4.571",o+="L0.001,14.629L0.001,14.629z M5.943,5.943c0-2.285,1.828-4.114,4.114-4.114s4.114,1.828,4.114,",e.id=this.elementId+"_Zooming_Zoom",e.setAttribute("aria-label",this.chart.getLocalizedLabel("Zoom")),this.zoomElements=e,this.selectedID=this.chart.zoomModule.isPanning?this.chart.element.id+"_Zooming_Pan_1":this.elementId+"_Zooming_Zoom_1",e.appendChild(i.drawRectangle(new zt(this.elementId+"_Zooming_Zoom_1",n,{},1,this.iconRect))),e.appendChild(i.drawPath(new sf.svgbase.PathOption(this.elementId+"_Zooming_Zoom_3",r,null,null,1,null,o+"4.114s-1.828,4.114-4.114,4.114S5.943,8.229,5.943,5.943z"))),t.appendChild(e),this.wireEvents(e,this.zoom)},e.prototype.createZoomInButton=function(e,t,i){var r=this.chart.svgRenderer,n=this.fillColor;e.id=this.elementId+"_Zooming_ZoomIn",e.setAttribute("aria-label",this.chart.getLocalizedLabel("ZoomIn"));e.appendChild(r.drawRectangle(new zt(this.elementId+"_Zooming_ZoomIn_1","transparent",{},1,this.iconRect))),e.appendChild(r.drawPath(new sf.svgbase.PathOption(this.elementId+"_Zooming_ZoomIn_2",n,null,null,1,null,"M10.103,0C6.812,0,4.16,2.651,4.16,5.943c0,1.509,0.503,2.834,1.417,3.885l-0.274,0.229H4.571L0,14.628l0,0L1.372,16l4.571-4.572v-0.685l0.228-0.275c1.052,0.868,2.423,1.417,3.885,1.417c3.291,0,5.943-2.651,5.943-5.943C16,2.651,13.395,0,10.103,0z M10.058,10.058c-2.286,0-4.114-1.828-4.114-4.114c0-2.286,1.828-4.114,4.114-4.114c2.286,0,4.114,1.828,4.114,4.114C14.172,8.229,12.344,10.058,10.058,10.058z"))),e.appendChild(r.drawPolygon(new Rt(this.elementId+"_Zooming_ZoomIn_3","12.749,5.466 10.749,5.466 10.749,3.466 9.749,3.466 9.749,5.466 7.749,5.466 7.749,6.466 9.749,6.466 9.749,8.466 10.749,8.466 10.749,6.466 12.749,6.466",n))),this.zoomInElements=e,this.elementOpacity=i.zoomModule.isPanning||!i.zoomModule.isZoomed&&i.zoomSettings.showToolbar&&!this.enableZoomButton?"0.2":"1",e.setAttribute("opacity",this.elementOpacity),t.appendChild(e),this.wireEvents(e,this.zoomIn)},e.prototype.createZoomOutButton=function(e,t,i){var r=this.chart.svgRenderer,n=this.fillColor;e.id=this.elementId+"_Zooming_ZoomOut",e.setAttribute("aria-label",this.chart.getLocalizedLabel("ZoomOut")),e.appendChild(r.drawRectangle(new zt(this.elementId+"_Zooming_ZoomOut_1","transparent",{},1,this.iconRect))),e.appendChild(r.drawPath(new sf.svgbase.PathOption(this.elementId+"_Zooming_ZoomOut_2",n,null,null,1,null,"M0,14.622L1.378,16l4.533-4.533v-0.711l0.266-0.266c1.022,0.889,2.4,1.422,3.866,1.422c3.289,0,5.955-2.666,5.955-5.955S13.333,0,10.044,0S4.089,2.667,4.134,5.911c0,1.466,0.533,2.844,1.422,3.866l-0.266,0.266H4.578L0,14.622L0,14.622z M5.911,5.911c0-2.311,1.822-4.133,4.133-4.133s4.133,1.822,4.133,4.133s-1.866,4.133-4.133,4.133S5.911,8.222,5.911,5.911z M12.567,6.466h-5v-1h5V6.466z"))),this.zoomOutElements=e,this.elementOpacity=i.zoomModule.isPanning||!i.zoomModule.isZoomed&&i.zoomSettings.showToolbar&&!this.enableZoomButton?"0.2":"1",e.setAttribute("opacity",this.elementOpacity),t.appendChild(e),this.wireEvents(e,this.zoomOut)},e.prototype.createResetButton=function(e,t,i,r){var n,o=this.chart.svgRenderer,s=this.fillColor;e.id=this.elementId+"_Zooming_Reset",e.setAttribute("aria-label",this.chart.getLocalizedLabel("Reset")),this.elementOpacity=!i.zoomModule.isZoomed&&i.zoomSettings.showToolbar?"0.2":"1",e.setAttribute("opacity",this.elementOpacity),r?(n=sf.svgbase.measureText(this.chart.getLocalizedLabel("ResetZoom"),{size:"12px"}),e.appendChild(o.drawRectangle(new zt(this.elementId+"_Zooming_Reset_1","transparent",{},1,new sf.svgbase.Rect(0,0,n.width,n.height)))),It(i.renderer,new sf.svgbase.TextOption(this.elementId+"_Zooming_Reset_2",0+n.width/2,0+3*n.height/4,"middle",this.chart.getLocalizedLabel("ResetZoom"),"rotate(0,0,0)","auto"),{size:"12px"},"black",e,null,null,null,null,null,null,0,null,i.enableCanvas)):(e.appendChild(o.drawRectangle(new zt(this.elementId+"_Zooming_Reset_1","transparent",{},1,this.iconRect))),e.appendChild(o.drawPath(new sf.svgbase.PathOption(this.elementId+"_Zooming_Reset_2",s,null,null,1,null,"M12.364,8h-2.182l2.909,3.25L16,8h-2.182c0-3.575-2.618-6.5-5.818-6.5c-1.128,0-2.218,0.366-3.091,1.016l1.055,1.178C6.581,3.328,7.272,3.125,8,3.125C10.4,3.125,12.363,5.319,12.364,8L12.364,8z M11.091,13.484l-1.055-1.178C9.419,12.672,8.728,12.875,8,12.875c-2.4,0-4.364-2.194-4.364-4.875h2.182L2.909,4.75L0,8h2.182c0,3.575,2.618,6.5,5.818,6.5C9.128,14.5,10.219,14.134,11.091,13.484L11.091,13.484z")))),t.appendChild(e),this.wireEvents(e,this.reset)},e.prototype.wireEvents=function(e,t){sf.base.EventHandler.add(e,"mousedown touchstart",t,this),sf.base.EventHandler.add(e,"mouseover",this.showTooltip,this),sf.base.EventHandler.add(e,"mouseout",this.removeTooltip,this)},e.prototype.showTooltip=function(e){var t=e.currentTarget.id.split("_Zooming_")[1],i=e.pageX-(sf.svgbase.measureText(t,{size:"10px"}).width+5),r=Ge(e.currentTarget.id+"_1"),n=Ge(e.currentTarget.id+"_2"),o=Ge(e.currentTarget.id+"_3");r&&(this.hoveredID=r.id,r.setAttribute("fill",this.iconRectOverFill)),n&&n.setAttribute("fill",this.selectionColor),o&&o.setAttribute("fill",this.selectionColor),this.chart.isTouch||Ne("EJ2_Chart_ZoomTip",this.chart.getLocalizedLabel(t),e.pageY+10,i,"10px")},e.prototype.removeTooltip=function(){if(Ge(this.hoveredID)){var e=this.chart.zoomModule.isPanning?this.hoveredID.indexOf("_Pan_")>-1?this.iconRectSelectionFill:"transparent":this.hoveredID.indexOf("_Zoom_")>-1?this.iconRectSelectionFill:"transparent";Ge(this.hoveredID).setAttribute("fill",e)}var t=this.hoveredID?Ge(this.hoveredID.replace("_1","_2")):null,i=this.hoveredID?Ge(this.hoveredID.replace("_1","_3")):null;if(t){var r=this.chart.zoomModule.isPanning?this.hoveredID.indexOf("_Pan_")>-1?this.selectionColor:this.fillColor:this.hoveredID.indexOf("_Zoom_")>-1?this.selectionColor:this.fillColor;t.setAttribute("fill",r)}if(i){r=this.chart.zoomModule.isPanning||!this.chart.isZoomed&&this.chart.zoomSettings.showToolbar?this.fillColor:this.hoveredID.indexOf("_Zoom_")>-1?this.selectionColor:this.fillColor;i.setAttribute("fill",r)}ie("EJ2_Chart_ZoomTip")},e.prototype.reset=function(e){var t=this;if(!this.chart.zoomModule.isZoomed)return!1;var i,r,n=this.chart;this.enableZoomButton=!1,n.zoomModule.isDevice?"touchstart"==e.type&&e.stopPropagation():sf.base.remove(n.zoomModule.toolkitElements),this.removeTooltip(),n.svgObject.setAttribute("cursor","auto");var o=[];this.zoomCompleteEvtCollection=[];for(var s=0,a=n.axisCollections;s<a.length;s++){var l=a[s];i={cancel:!1,name:"zoomComplete",axis:l,previousZoomFactor:l.zoomFactor,previousZoomPosition:l.zoomPosition,currentZoomFactor:1,currentZoomPosition:0,previousVisibleRange:l.visibleRange,currentVisibleRange:null},l.zoomFactor=1,l.zoomPosition=0,l.zoomingScrollBar&&(l.zoomingScrollBar.isScrollUI=!1),i.cancel||(l.zoomFactor=i.currentZoomFactor,l.zoomPosition=i.currentZoomPosition,this.zoomCompleteEvtCollection.push(i)),o.push({zoomFactor:l.zoomFactor,zoomPosition:l.zoomFactor,axisName:l.name,axisRange:l.visibleRange})}return!(r={cancel:!1,axisCollection:o,name:P}).cancel&&this.chart.isBlazor?(this.chart.trigger(P,r,(function(){t.setDefferedZoom(n)})),!1):this.setDefferedZoom(n)},e.prototype.setDefferedZoom=function(e){return e.disableTrackTooltip=!1,e.zoomModule.isZoomed=e.zoomModule.isPanning=e.isChartDrag=e.delayRedraw=!1,e.zoomModule.touchMoveList=e.zoomModule.touchStartList=[],e.zoomModule.pinchTarget=null,e.removeSvg(),e.refreshAxis(),e.refreshBound(),this.elementOpacity="1",!1},e.prototype.zoomIn=function(e){return this.zoomInOutCalculation(1,this.chart,this.chart.axisCollections,this.chart.zoomSettings.mode),!1},e.prototype.zoomOut=function(e){return this.enableZoomButton=!0,this.zoomInOutCalculation(-1,this.chart,this.chart.axisCollections,this.chart.zoomSettings.mode),!1},e.prototype.zoom=function(e){this.chart.zoomModule.isPanning=!1;this.chart.zoomModule;return this.elementOpacity="1",this.chart.svgObject.setAttribute("cursor","auto"),this.zoomInElements.setAttribute("opacity",this.elementOpacity),this.zoomOutElements.setAttribute("opacity",this.elementOpacity),this.applySelection(this.zoomElements.childNodes,this.selectionColor),this.applySelection(this.panElements.childNodes,"#737373"),Ge(this.selectedID)&&Ge(this.selectedID).setAttribute("fill","transparent"),this.selectedID=this.chart.element.id+"_Zooming_Zoom_1",Ge(this.selectedID).setAttribute("fill",this.iconRectSelectionFill),!1},e.prototype.pan=function(){return!!this.chart.zoomModule.isZoomed&&(this.chart.zoomModule.isPanning=!0,this.chart.svgObject.setAttribute("cursor","pointer"),this.elementOpacity="0.2",this.zoomInElements?this.zoomInElements.setAttribute("opacity",this.elementOpacity):null,this.zoomOutElements?this.zoomOutElements.setAttribute("opacity",this.elementOpacity):null,this.panElements?this.applySelection(this.panElements.childNodes,this.selectionColor):null,this.zoomElements?this.applySelection(this.zoomElements.childNodes,"#737373"):null,Ge(this.selectedID)&&Ge(this.selectedID).setAttribute("fill","transparent"),this.selectedID=this.chart.element.id+"_Zooming_Pan_1",Ge(this.selectedID).setAttribute("fill",this.iconRectSelectionFill),!1)},e.prototype.zoomInOutCalculation=function(e,t,i,r){if(t.zoomSettings.showToolbar&&(this.elementOpacity=this.zoomInElements.getAttribute("opacity")),!t.zoomModule.isPanning&&"0.2"!==this.elementOpacity){t.zoomSettings.showToolbar&&!t.isZoomed&&(t.zoomModule.isZoomed=!0);var n=void 0,o=void 0,s=void 0;t.disableTrackTooltip=!0,t.delayRedraw=!0;var a=void 0;this.zoomCompleteEvtCollection=[];for(var l=0,h=i;l<h.length;l++){var d=h[l];a={cancel:!1,name:"zoomComplete",axis:d,previousZoomFactor:d.zoomFactor,previousZoomPosition:d.zoomPosition,currentZoomFactor:d.zoomFactor,currentZoomPosition:d.zoomPosition,previousVisibleRange:d.visibleRange,currentVisibleRange:null},("Horizontal"===d.orientation&&"Y"!==r||"Vertical"===d.orientation&&"X"!==r)&&(n=1===(s=Math.max(Math.max(1/qe(d.zoomFactor,0,1),1)+.25*e,1))?1:qe(1/s,0,1),o=1===s?0:d.zoomPosition+.5*(d.zoomFactor-n),d.zoomPosition===o&&d.zoomFactor===n||(n=o+n>1?1-o:n),a.currentZoomFactor=n,a.currentZoomPosition=o,a.cancel||(d.zoomFactor=a.currentZoomFactor,d.zoomPosition=a.currentZoomPosition,this.zoomCompleteEvtCollection.push(a)))}}},e.prototype.applySelection=function(e,t){for(var i=1,r=e.length;i<r;i++)e[i].setAttribute("fill",t)},e}(),Io=function(){function e(e){this.zoomCompleteEvtCollection=[],this.chart=e,this.isPointer=sf.base.Browser.isPointer,this.browserName=sf.base.Browser.info.name,this.wheelEvent="mozilla"===this.browserName?this.isPointer?"mousewheel":"DOMMouseScroll":"mousewheel",this.cancelEvent=this.isPointer?"pointerleave":"mouseleave",this.addEventListener(),this.isDevice=sf.base.Browser.isDevice;var t=e.zoomSettings;this.toolkit=new No(e),this.zooming=t,this.elementId=e.element.id,this.zoomingRect=new sf.svgbase.Rect(0,0,0,0),this.zoomAxes=[],this.zoomkitOpacity=.3,this.isIOS=sf.base.Browser.isIos||sf.base.Browser.isIos7,this.isZoomed=this.performedUI=this.zooming.enablePan&&this.zooming.enableSelectionZooming,t.enableScrollbar&&(e.scrollElement=sf.base.createElement("div",{id:e.element.id+"_scrollElement"}))}return e.prototype.renderZooming=function(e,t,i){this.calculateZoomAxesRange(t),!this.zooming.enableSelectionZooming||i&&(!t.isDoubleTap||1!==this.touchStartList.length)||this.isPanning&&!t.isDoubleTap?this.isPanning&&t.isChartDrag&&(!i||i&&1===this.touchStartList.length)&&(this.pinchTarget=i?e.target:null,this.doPan(t,t.axisCollections)):(this.isPanning=!!this.isDevice||this.isPanning,this.performedUI=!0,this.drawZoomingRectangle(t))},e.prototype.drawZoomingRectangle=function(e){var t=e.chartAxisLayoutPanel.seriesClipRect,i=new jt(e.previousMouseMoveX,e.previousMouseMoveY),r=new jt(e.mouseX,e.mouseY),n=this.zoomingRect=Qe(i,r,t);n.width>0&&n.height>0&&(this.isZoomed=!0,e.disableTrackTooltip=!0,e.svgObject.setAttribute("cursor","crosshair"),"X"===this.zooming.mode?(n.height=t.height,n.y=t.y):"Y"===this.zooming.mode&&(n.width=t.width,n.x=t.x),(e.enableCanvas?document.getElementById(this.elementId+"_tooltip_svg"):e.svgObject).appendChild(e.svgRenderer.drawRectangle(new zt(this.elementId+"_ZoomArea",e.themeStyle.selectionRectFill,{color:e.themeStyle.selectionRectStroke,width:1},1,n,0,0,"","3"))))},e.prototype.doPan=function(e,t,i,r){var n,o,s,a=this;if(void 0===i&&(i=0),void 0===r&&(r=0),e.startMove&&e.crosshair.enable)return null;this.isZoomed=!0,this.offset=e.delayRedraw?this.offset:e.chartAxisLayoutPanel.seriesClipRect,e.delayRedraw=!0,this.zoomCompleteEvtCollection=[],e.disableTrackTooltip=!0;for(var l=[],h=0,d=t;h<d.length;h++){var c=d[h];s={cancel:!1,name:"zoomComplete",axis:c,previousZoomFactor:c.zoomFactor,previousZoomPosition:c.zoomPosition,currentZoomFactor:c.zoomFactor,currentZoomPosition:c.zoomPosition,previousVisibleRange:c.visibleRange,currentVisibleRange:null},n=Math.max(1/qe(c.zoomFactor,0,1),1),"Horizontal"===c.orientation?(o=(0!==i?i:e.previousMouseMoveX-e.mouseX)/c.rect.width/n,s.currentZoomPosition=qe(c.zoomPosition+o,0,1-c.zoomFactor)):(o=(0!==r?r:e.previousMouseMoveY-e.mouseY)/c.rect.height/n,s.currentZoomPosition=qe(c.zoomPosition-o,0,1-c.zoomFactor)),s.cancel||(c.zoomFactor=s.currentZoomFactor,c.zoomPosition=s.currentZoomPosition,this.zoomCompleteEvtCollection.push(s)),l.push({zoomFactor:c.zoomFactor,zoomPosition:c.zoomFactor,axisName:c.name,axisRange:c.visibleRange})}var p={cancel:!1,axisCollection:l,name:P};!p.cancel&&this.chart.isBlazor?this.chart.trigger(P,p,(function(){a.performDefferedZoom(e)})):this.chart.trigger(P,p,(function(){a.performDefferedZoom(e),a.redrawOnZooming(e,!1)}))},e.prototype.performDefferedZoom=function(e){var t,i;if(this.zooming.enableDeferredZooming){switch(t=e.mouseX-e.mouseDownX,i=e.mouseY-e.mouseDownY,this.zooming.mode){case"X":i=0;break;case"Y":t=0}this.setTransform(t,i,null,null,e,!1),this.refreshAxis(e.chartAxisLayoutPanel,e,e.axisCollections),e.enableCanvas&&this.performZoomRedraw(e)}else this.performZoomRedraw(e);e.previousMouseMoveX=e.mouseX,e.previousMouseMoveY=e.mouseY},e.prototype.performZoomRedraw=function(e){var t=this.zoomingRect;e.animateSeries=!1,this.isZoomed&&(t.width>0&&t.height>0?(this.performedUI=!0,e.svgObject.setAttribute("cursor","auto"),this.doZoom(e,e.axisCollections,e.chartAxisLayoutPanel.seriesClipRect),e.isDoubleTap=!1):e.disableTrackTooltip&&(e.disableTrackTooltip=!1,e.delayRedraw=!1,e.enableCanvas?e.createChartSvg():e.removeSvg(),e.refreshAxis(),e.refreshBound()))},e.prototype.refreshAxis=function(e,t,i){var r=t.zoomSettings.mode;e.measureAxis(new sf.svgbase.Rect(t.initialClipRect.x,t.initialClipRect.y,t.initialClipRect.width,t.initialClipRect.height)),i.map((function(t,i){"Horizontal"===t.orientation&&"Y"!==r&&e.drawXAxisLabels(t,i,null,t.placeNextToAxisLine?t.updatedRect:t.rect),"Vertical"===t.orientation&&"X"!==r&&e.drawYAxisLabels(t,i,null,t.placeNextToAxisLine?t.updatedRect:t.rect)}))},e.prototype.doZoom=function(e,t,i){var r,n=this,o=this.zoomingRect,s=this.zooming.mode;this.isPanning=e.zoomSettings.enablePan||this.isPanning;var a=[];this.zoomCompleteEvtCollection=[];for(var l=0,h=t;l<h.length;l++){var d=h[l];r={cancel:!1,name:"zoomComplete",axis:d,previousZoomFactor:d.zoomFactor,previousZoomPosition:d.zoomPosition,currentZoomFactor:d.zoomFactor,currentZoomPosition:d.zoomPosition,previousVisibleRange:d.visibleRange,currentVisibleRange:null},"Horizontal"===d.orientation?"Y"!==s&&(r.currentZoomPosition+=Math.abs((o.x-i.x)/i.width)*d.zoomFactor,r.currentZoomFactor*=o.width/i.width):"X"!==s&&(r.currentZoomPosition+=(1-Math.abs((o.height+(o.y-i.y))/i.height))*d.zoomFactor,r.currentZoomFactor*=o.height/i.height),parseFloat(r.currentZoomFactor.toFixed(3))<=.001&&(r.currentZoomFactor=r.previousZoomFactor,r.currentZoomPosition=r.previousZoomPosition),r.cancel||(d.zoomFactor=r.currentZoomFactor,d.zoomPosition=r.currentZoomPosition,this.zoomCompleteEvtCollection.push(r)),a.push({zoomFactor:d.zoomFactor,zoomPosition:d.zoomFactor,axisName:d.name,axisRange:d.visibleRange})}var c={cancel:!1,axisCollection:a,name:P};!c.cancel&&this.chart.isBlazor?this.chart.trigger(P,c,(function(){n.zoomingRect=new sf.svgbase.Rect(0,0,0,0),n.performZoomRedraw(e)})):this.chart.trigger(P,c,(function(){n.zoomingRect=new sf.svgbase.Rect(0,0,0,0),n.redrawOnZooming(e)}))},e.prototype.redrawOnZooming=function(e,t,i){void 0===t&&(t=!0),void 0===i&&(i=!1);var r,n=i?this.toolkit.zoomCompleteEvtCollection:this.zoomCompleteEvtCollection;t&&this.performZoomRedraw(e);for(var o=0;o<n.length;o++)n[o].cancel||(r={cancel:!1,name:"zoomComplete",axis:e.axisCollections[o],previousZoomFactor:n[o].previousZoomFactor,previousZoomPosition:n[o].previousZoomPosition,currentZoomFactor:e.axisCollections[o].zoomFactor,currentZoomPosition:e.axisCollections[o].zoomPosition,currentVisibleRange:e.axisCollections[o].visibleRange,previousVisibleRange:n[o].previousVisibleRange},e.trigger("zoomComplete",r))},e.prototype.performMouseWheelZooming=function(e,t,i,r,n){var o,s,a,l,h=this,d="mozilla"!==this.browserName||this.isPointer?e.wheelDelta>0?1:-1:-e.detail/3>0?1:-1,c=this.zooming.mode,p=.5;this.isZoomed=!0,this.calculateZoomAxesRange(r),r.disableTrackTooltip=!0,this.performedUI=!0,this.isPanning=r.zoomSettings.enablePan||this.isPanning,this.zoomCompleteEvtCollection=[];for(var u=[],g=0,f=n;g<f.length;g++){var m=f[g];l={cancel:!1,name:"zoomComplete",axis:m,previousZoomFactor:m.zoomFactor,previousZoomPosition:m.zoomPosition,currentZoomFactor:m.zoomFactor,currentZoomPosition:m.zoomPosition,currentVisibleRange:null,previousVisibleRange:m.visibleRange},("Vertical"===m.orientation&&"X"!==c||"Horizontal"===m.orientation&&"Y"!==c)&&((o=(o=Math.max(Math.max(1/qe(m.zoomFactor,0,1),1)+.25*d,1))>5e10?5e10:o)>=1&&(p=(p="Horizontal"===m.orientation?t/m.rect.width:1-i/m.rect.height)>1?1:p<0?0:p,s=1===o?1:qe((d>0?.9:1.1)/o,0,1),a=1===o?0:m.zoomPosition+(m.zoomFactor-s)*p,m.zoomPosition===a&&m.zoomFactor===s||(s=a+s>1?1-a:s),l.currentZoomFactor=s,l.currentZoomPosition=a),l.cancel||(m.zoomFactor=l.currentZoomFactor,m.zoomPosition=l.currentZoomPosition,this.zoomCompleteEvtCollection.push(l))),u.push({zoomFactor:m.zoomFactor,zoomPosition:m.zoomFactor,axisName:m.name,axisRange:m.visibleRange})}var y={cancel:!1,axisCollection:u,name:P};!y.cancel&&this.chart.isBlazor?this.chart.trigger(P,y,(function(){h.performZoomRedraw(r)})):this.chart.trigger(P,y,(function(){h.redrawOnZooming(r)}))},e.prototype.performPinchZooming=function(e,t){if(this.zoomingRect.width>0&&this.zoomingRect.height>0||t.startMove&&t.crosshair.enable)return!1;this.calculateZoomAxesRange(t),this.isZoomed=!0,this.isPanning=!0,this.performedUI=!0,this.offset=t.delayRedraw?this.offset:t.chartAxisLayoutPanel.seriesClipRect,t.delayRedraw=!0,t.disableTrackTooltip=!0;var i=t.element.getBoundingClientRect(),r=this.touchStartList,n=this.touchMoveList,o=r[0].pageX-i.left,s=r[0].pageY-i.top,a=n[0].pageX-i.left,l=n[0].pageY-i.top,h=r[1].pageX-i.left,d=r[1].pageY-i.top,c=n[1].pageX-i.left,p=n[1].pageY-i.top,u=Math.abs(a-c)/Math.abs(o-h),g=Math.abs(l-p)/Math.abs(s-d),f=(this.offset.x-a)/u+o,m=(this.offset.y-l)/g+s,y=new sf.svgbase.Rect(f,m,this.offset.width/u,this.offset.height/g),v=a-u*o,b=l-g*s;if(!isNaN(u-u)&&!isNaN(g-g))switch(this.zooming.mode){case"XY":this.setTransform(v,b,u,g,t,!0);break;case"X":this.setTransform(v,0,u,1,t,!0);break;case"Y":this.setTransform(0,b,1,g,t,!0)}return this.calculatePinchZoomFactor(t,y),this.refreshAxis(t.chartAxisLayoutPanel,t,t.axisCollections),this.redrawOnZooming(t,!1),!0},e.prototype.calculatePinchZoomFactor=function(e,t){var i,r,n,o,s,a,l,h,d,c=this.zooming.mode,p=[];this.zoomCompleteEvtCollection=[];for(var u=0;u<e.axisCollections.length;u++){var g=e.axisCollections[u];("Horizontal"===g.orientation&&"Y"!==c||"Vertical"===g.orientation&&"X"!==c)&&(h=g.zoomFactor,d=g.zoomPosition,l={cancel:!1,name:"zoomComplete",axis:g,previousZoomFactor:g.zoomFactor,previousZoomPosition:g.zoomPosition,currentZoomFactor:h,currentZoomPosition:d,previousVisibleRange:g.visibleRange,currentVisibleRange:null},"Horizontal"===g.orientation?(n=(s=t.x-this.offset.x)/(a=g.rect.width/this.zoomAxes[u].delta)+this.zoomAxes[u].min,o=(s=t.x+t.width-this.offset.x)/a+this.zoomAxes[u].min):(s=t.y-this.offset.y,a=g.rect.height/this.zoomAxes[u].delta,n=(-1*s+g.rect.height)/a+this.zoomAxes[u].min,o=(-1*(s=t.y+t.height-this.offset.y)+g.rect.height)/a+this.zoomAxes[u].min),i=Math.min(n,o),r=Math.max(n,o),d=(i-this.zoomAxes[u].actualMin)/this.zoomAxes[u].actualDelta,h=(r-i)/this.zoomAxes[u].actualDelta,l.currentZoomPosition=d<0?0:d,l.currentZoomFactor=h>1?1:h<.03?.03:h,l.cancel||(g.zoomFactor=l.currentZoomFactor,g.zoomPosition=l.currentZoomPosition,this.zoomCompleteEvtCollection.push(l)),p.push({zoomFactor:g.zoomFactor,zoomPosition:g.zoomFactor,axisName:g.name,axisRange:g.visibleRange}))}var f={cancel:!1,axisCollection:p,name:P};f.cancel||this.chart.trigger(P,f)},e.prototype.setTransform=function(e,t,i,r,n,o){var s,a,l,h;if(n.enableCanvas||n.seriesElements.setAttribute("clip-path","url(#"+this.elementId+"_ChartAreaClipRect_)"),n.indicatorElements&&n.indicatorElements.setAttribute("clip-path","url(#"+this.elementId+"_ChartAreaClipRect_)"),null!==e&&null!==t)for(var d=0,c=n.visibleSeries;d<c.length;d++){var p=c[d];a=n.requireInvertedAxis?p.yAxis.rect.x:p.xAxis.rect.x,l=n.requireInvertedAxis?p.xAxis.rect.y:p.yAxis.rect.y,s="translate("+(e+(o?i*a:a))+","+(t+(o?r*l:l))+")",s=i||r?s+" scale("+i+" "+r+")":s,p.visible&&("Indicator"===p.category?p.seriesElement.parentNode.setAttribute("transform",s):n.enableCanvas||p.seriesElement.setAttribute("transform",s),h=Ge(n.element.id+"_Series_"+p.index+"_DataLabelCollections"),p.errorBarElement&&p.errorBarElement.setAttribute("transform",s),p.symbolElement&&p.symbolElement.setAttribute("transform",s),p.textElement&&(p.textElement.setAttribute("visibility","hidden"),p.shapeElement.setAttribute("visibility","hidden")),h&&(h.style.visibility="hidden"))}},e.prototype.calculateZoomAxesRange=function(e){for(var t,i,r=0;r<e.axisCollections.length;r++){var n=e.axisCollections[r];i=n.visibleRange,this.zoomAxes[r]?e.delayRedraw||(this.zoomAxes[r].min=i.min,this.zoomAxes[r].delta=i.delta):(t={actualMin:n.actualRange.min,actualDelta:n.actualRange.delta,min:i.min,delta:i.delta},this.zoomAxes[r]=t)}},e.prototype.showZoomingToolkit=function(e){var t,i=this.zooming.toolbarItems,r=e.chartAxisLayoutPanel.seriesClipRect,n=e.svgRenderer,o=this.isDevice?1:i.length,s=this.isDevice?sf.svgbase.measureText("Reset Zoom",{size:"12px"}).width:16,a=this.isDevice?sf.svgbase.measureText("Reset Zoom",{size:"12px"}).height:22,l=o*s+5*(o+1)+5*(o-1),h=r.x+r.width-l-5,d=r.y+5,c=5,p=this.toolkit;if('<feOffset dx="-3" dy="4" result="offsetblur"/><feComponentTransfer><feFuncA type="linear" slope="1"/>','</feComponentTransfer><feMerge><feMergeNode/><feMergeNode in="SourceGraphic"/></feMerge></filter>',0===o||Ge(this.elementId+"_Zooming_KitCollection"))return!1;var u=n.createDefs();i=this.isDevice?["Reset"]:i,u.innerHTML='<filter id="chart_shadow" height="130%"><feGaussianBlur in="SourceAlpha" stdDeviation="5"/><feOffset dx="-3" dy="4" result="offsetblur"/><feComponentTransfer><feFuncA type="linear" slope="1"/></feComponentTransfer><feMerge><feMergeNode/><feMergeNode in="SourceGraphic"/></feMerge></filter>',this.toolkitElements=n.createGroup({id:this.elementId+"_Zooming_KitCollection",transform:"translate("+h+","+d+")"}),this.toolkitElements.appendChild(u);var g="Tailwind"===this.chart.theme?"#F3F4F6":"Fluent"===this.chart.theme?"#F3F2F1":"FluentDark"===this.chart.theme?"#252423":"#fafafa";this.toolkitElements.appendChild(n.drawRectangle(new zt(this.elementId+"_Zooming_Rect",g,{color:"transparent",width:1},1,new sf.svgbase.Rect(0,0,l,a+10),0,0)));var f,m=n.drawRectangle(new zt(this.elementId+"_Zooming_Rect",g,{color:"transparent",width:1},.1,new sf.svgbase.Rect(0,0,l,a+10),0,0));"Tailwind"===this.chart.theme||"TailwindDark"===this.chart.theme?m.setAttribute("box-shadow","0px 1px 2px rgba(0, 0, 0, 0.06), 0px 1px 3px rgba(0, 0, 0, 0.1)"):m.setAttribute("filter","url(#chart_shadow)"),this.toolkitElements.appendChild(m);for(var y=!1,v=1;v<=o;v++){switch(f=i[v-1],t=n.createGroup({transform:"translate("+c+","+(this.isDevice?5:8)+")"}),f){case"Pan":p.createPanButton(t,this.toolkitElements),y=!0;break;case"Zoom":p.createZoomButton(t,this.toolkitElements);break;case"ZoomIn":p.createZoomInButton(t,this.toolkitElements,e);break;case"ZoomOut":p.createZoomOutButton(t,this.toolkitElements,e);break;case"Reset":p.createResetButton(t,this.toolkitElements,e,this.isDevice)}c+=s+10}if(this.toolkitElements.setAttribute("opacity",this.isDevice?"1":""+this.zoomkitOpacity),this.toolkitElements.setAttribute("cursor","auto"),e.enableCanvas){var b=document.createElement("div");b.id=e.element.id+"_zoom",b.style.cssText="position:absolute; z-index:1";var w=e.availableSize.height/2,x=e.svgRenderer.createSvg({id:e.element.id+"_zoomkit_svg",width:e.availableSize.width,height:w});x.style.position="absolute",x.appendChild(this.toolkitElements),b.appendChild(x),document.getElementById(this.elementId+"_Secondary_Element").appendChild(b)}else e.svgObject.appendChild(this.toolkitElements);return this.isDevice||(sf.base.EventHandler.add(this.toolkitElements,"mousemove touchstart",this.zoomToolkitMove,this),sf.base.EventHandler.add(this.toolkitElements,"mouseleave touchend",this.zoomToolkitLeave,this),this.isPanning&&y&&p.pan()),!0},e.prototype.applyZoomToolkit=function(e,t){var i=this.isAxisZoomed(t);i?(this.showZoomingToolkit(e),this.isZoomed=!0):e.zoomSettings.showToolbar?(this.isZoomed=i,this.showZoomingToolkit(e)):(this.toolkit.removeTooltip(),this.isPanning=!1,this.isZoomed=!1,e.isZoomed=!1,e.svgObject.setAttribute("cursor","auto"))},e.prototype.isAxisZoomed=function(e){for(var t=!1,i=0,r=e;i<r.length;i++){var n=r[i];t=t||1!==n.zoomFactor||0!==n.zoomPosition}return t},e.prototype.zoomToolkitMove=function(){var e=this.toolkitElements;return this.zoomkitOpacity=1,e.setAttribute("opacity",""+this.zoomkitOpacity),!1},e.prototype.zoomToolkitLeave=function(){var e=this.toolkitElements;return this.zoomkitOpacity=.3,e.setAttribute("opacity",""+this.zoomkitOpacity),!1},e.prototype.addEventListener=function(){this.chart.isDestroyed||(sf.base.EventHandler.add(this.chart.element,this.wheelEvent,this.chartMouseWheel,this),this.chart.on(sf.base.Browser.touchMoveEvent,this.mouseMoveHandler,this),this.chart.on(sf.base.Browser.touchStartEvent,this.mouseDownHandler,this),this.chart.on(sf.base.Browser.touchEndEvent,this.mouseUpHandler,this),this.chart.on(this.cancelEvent,this.mouseCancelHandler,this))},e.prototype.removeEventListener=function(){this.chart.isDestroyed||(sf.base.EventHandler.remove(this.chart.element,this.wheelEvent,this.chartMouseWheel),this.chart.off(sf.base.Browser.touchMoveEvent,this.mouseMoveHandler),this.chart.off(sf.base.Browser.touchStartEvent,this.mouseDownHandler),this.chart.off(sf.base.Browser.touchEndEvent,this.mouseUpHandler),this.chart.off(this.cancelEvent,this.mouseCancelHandler))},e.prototype.chartMouseWheel=function(e){var t=this.chart,i=t.element.getBoundingClientRect(),r=Ge(t.svgId).getBoundingClientRect(),n=e.clientX-i.left-Math.max(r.left-i.left,0),o=e.clientY-i.top-Math.max(r.top-i.top,0);return this.zooming.enableMouseWheelZooming&&Ce(n,o,t.chartAxisLayoutPanel.seriesClipRect)&&(e.preventDefault(),this.performMouseWheelZooming(e,n,o,t,t.axisCollections)),!1},e.prototype.mouseMoveHandler=function(e){var t=this.chart,i=null;"touchmove"===e.type&&(e.preventDefault&&this.isIOS&&(this.isPanning||t.isDoubleTap||this.zooming.enablePinchZooming&&this.touchStartList.length>1)&&e.preventDefault(),i=e.touches),t.isChartDrag&&(t.isTouch&&(this.touchMoveList=this.addTouchPointer(this.touchMoveList,e,i),this.zooming.enablePinchZooming&&this.touchMoveList.length>1&&this.touchStartList.length>1&&this.performPinchZooming(e,t)),this.renderZooming(e,t,t.isTouch))},e.prototype.mouseDownHandler=function(e){var t,i=this.chart,r=null;"touchstart"===e.type?(r=e.touches,t=e.target):t=e.target,-1===t.id.indexOf(i.element.id+"_Zooming_")&&Ce(i.previousMouseMoveX,i.previousMouseMoveY,i.chartAxisLayoutPanel.seriesClipRect)&&(i.isChartDrag=!0),i.isTouch&&(this.touchStartList=this.addTouchPointer(this.touchStartList,e,r))},e.prototype.mouseUpHandler=function(e){var t=this.chart,i=-1===e.target.id.indexOf(t.element.id+"_ZoomOut_")||-1===e.target.id.indexOf(t.element.id+"_ZoomIn_");(t.isChartDrag||i)&&this.redrawOnZooming(t,!0,!0),t.isTouch&&(t.isDoubleTap&&Ce(t.mouseX,t.mouseY,t.chartAxisLayoutPanel.seriesClipRect)&&1===this.touchStartList.length&&this.isZoomed&&this.toolkit.reset(e),this.touchStartList=[],t.isDoubleTap=!1)},e.prototype.mouseCancelHandler=function(){this.isZoomed&&this.performZoomRedraw(this.chart),this.pinchTarget=null,this.touchStartList=[],this.touchMoveList=[]},e.prototype.addTouchPointer=function(e,t,i){if(i){e=[];for(var r=0,n=i.length;r<n;r++)e.push({pageX:i[r].clientX,pageY:i[r].clientY,pointerId:null})}else if(0===(e=e||[]).length)e.push({pageX:t.clientX,pageY:t.clientY,pointerId:t.pointerId});else{r=0;for(var o=e.length;r<o;r++)e[r].pointerId===t.pointerId?e[r]={pageX:t.clientX,pageY:t.clientY,pointerId:t.pointerId}:e.push({pageX:t.clientX,pageY:t.clientY,pointerId:t.pointerId})}return e},e.prototype.getModuleName=function(){return"Zoom"},e.prototype.destroy=function(){this.removeEventListener()},e}(),So=function(){function e(e){this.control=e}return e.prototype.seriesStyles=function(){var e,t,i=document.getElementById(this.styleId),r="{}",n=this.control.selectionPattern,o=this.control.highlightPattern;if(this.styleId.indexOf("highlight")>0&&""!==this.control.highlightColor||sf.base.isNullOrUndefined(i)||"None"!==n||"None"!==o){(i=document.createElement("style")).setAttribute("id",this.styleId);for(var s=0,a=this.control.visibleSeries;s<a.length;s++){var l=a[s],h=this.control.visibleSeries[l.index]||this.control.visibleSeries[l.index];if(this.styleId.indexOf("highlight")>0&&""!==this.control.highlightColor||(!sf.base.isNullOrUndefined(n)||!sf.base.isNullOrUndefined(o))&&("None"!==n||"None"!==o)){var d=this.styleId.indexOf("highlight")>0?o:n;if("Pie"===h.type||"Funnel"===h.type||"Pyramid"===h.type&&"transparent"!==this.control.highlightColor)for(var c=0;c<h.points.length;c++)t=h.opacity,r="{ fill:"+this.pattern(this.control,this.styleId.indexOf("highlight")>0&&""!==this.control.highlightColor?this.control.highlightColor:h.points[c].color,l.points[c].index,d,t)+"}",e=l.selectionStyle||this.styleId+"_series_"+l.index+"_point_"+l.points[c].index+",."+this.styleId+"_series_"+l.index+"_point_"+l.points[c].index+"> *","None"===this.control.highlightMode&&this.control.legendSettings.enableHighlight&&(i.innerHTML+="."+this.styleId+"_series_"+l.index+"> * { stroke-width:3;} "),r=r.indexOf("None")>-1?"{fill:"+this.control.highlightColor+"!important}":r,i.innerHTML+=l.selectionStyle?"":"."+e+r;else h.type&&"transparent"!==this.control.highlightColor&&(t=h.opacity,r="{ fill:"+this.pattern(this.control,this.styleId.indexOf("highlight")>0&&""!==this.control.highlightColor?this.control.highlightColor:""!==h.pointColorMapping||this.control.rangeColorSettings&&this.control.rangeColorSettings.length>1?h.points[0].color:h.interior,l.index,d,t)+"}")}e=l.selectionStyle||this.styleId+"_series_"+l.index+",."+this.styleId+"_series_"+l.index+"> *","None"===this.control.highlightMode&&this.control.legendSettings.enableHighlight&&(i.innerHTML+="."+this.styleId+"_series_"+l.index+"> * { stroke-width:3;} "),r=r.indexOf("None")>-1?"{}":r,i.innerHTML+=l.selectionStyle?"":"."+e+r}var p="transparent"!==this.control.highlightColor?.3:t;sf.base.isNullOrUndefined(this.control.selectionModule)&&"None"===this.control.selectionMode&&""!==this.control.highlightColor&&(p=1),i.innerHTML+="."+this.unselected+" { opacity:"+p+";} ",document.body.appendChild(i)}},e.prototype.pattern=function(e,t,i,r,n){var o=e.svgObject,s=[],a={id:e.element.id+"_"+r+"_Selection_"+i,patternUnits:"userSpaceOnUse"};switch(r){case"Dots":a.height=a.width=6,a.width=6,s[0]={x:0,y:0,width:7,height:7,transform:"translate(0,0)",fill:"#ffffff",opacity:n,name:"rect"},s[1]={cx:3,cy:3,r:2,"stroke-width":1,fill:t,name:"circle"};break;case"Pacman":a.height="18.384",a.width="17.917",s[0]={name:"rect",x:0,y:0,width:17.917,height:18.384,transform:"translate(0,0)",fill:"#ffffff",opacity:n},s[1]={name:"path",d:"M9.081,9.194l5.806-3.08c-0.812-1.496-2.403-3.052-4.291-3.052H8.835C6.138,3.063,3,6.151,3,8.723v1.679   c0,2.572,3.138,5.661,5.835,5.661h1.761c2.085,0,3.835-1.76,4.535-3.514L9.081,9.194z","stroke-width":1,stroke:t,fill:t};break;case"Chessboard":a.height=a.width=10,s[0]={x:0,y:0,width:10,height:10,fill:"#ffffff",opacity:n,name:"rect"},s[1]={x:0,y:0,width:5,height:5,fill:t,opacity:n,name:"rect"},s[2]={x:5,y:5,width:5,height:5,fill:t,opacity:n,name:"rect"};break;case"Crosshatch":a.height=a.width="8",s[0]={x:0,y:0,width:8,height:8,transform:"translate(0,0)",fill:"#ffffff",opacity:n,name:"rect"},s[1]={d:"M0 0L8 8ZM8 0L0 8Z","stroke-width":1,stroke:t,name:"path"};break;case"DiagonalForward":a.height=a.width=6,s[0]={x:0,y:0,width:6,height:6,transform:"translate(0,0)",fill:"#ffffff",opacity:n,name:"rect"},s[1]={d:"M 3 -3 L 9 3 M 6 6 L 0 0 M 3 9 L -3 3","stroke-width":2,stroke:t,name:"path"};break;case"DiagonalBackward":a.height=a.width=6,s[0]={x:0,y:0,width:6,height:6,transform:"translate(0,0)",fill:"#ffffff",opacity:n,name:"rect"},s[1]={d:"M 3 -3 L -3 3 M 0 6 L 6 0 M 9 3 L 3 9","stroke-width":2,stroke:t,name:"path"};break;case"Grid":a.height=a.width=6,s[0]={name:"rect",x:0,y:0,width:6,height:6,transform:"translate(0,0)",fill:"#ffffff",opacity:n},s[1]={name:"path",d:"M1 3.5L11 3.5 M0 3.5L11 3.5 M0 7.5L11 7.5 M0 11.5L11 11.5 M5.5 0L5.5 12 M11.5 0L11.5 12Z","stroke-width":1,stroke:t};break;case"Turquoise":a.height=a.width=17,s[0]={name:"rect",x:0,y:0,width:17,height:17,transform:"translate(0,0)",fill:"#ffffff",opacity:n},s[1]={name:"path",d:"M0.5739999999999998,2.643a2.123,2.111 0 1,0 4.246,0a2.123,2.111 0 1,0 -4.246,0","stroke-width":1,"stroke-miterlimit":10,stroke:t,fill:t},s[2]={name:"path",d:"M11.805,2.643a2.123,2.111 0 1,0 4.246,0a2.123,2.111 0 1,0 -4.246,0","stroke-width":1,"stroke-miterlimit":10,stroke:t,fill:t},s[3]={name:"path",d:"M6.19,2.643a2.123,2.111 0 1,0 4.246,0a2.123,2.111 0 1,0 -4.246,0","stroke-width":1,"stroke-miterlimit":10,stroke:t,fill:t},s[4]={name:"path",d:"M11.805,8.217a2.123,2.111 0 1,0 4.246,0a2.123,2.111 0 1,0 -4.246,0","stroke-width":1,"stroke-miterlimit":10,stroke:t,fill:t},s[5]={name:"path",d:"M6.19,8.217a2.123,2.111 0 1,0 4.246,0a2.123,2.111 0 1,0 -4.246,0","stroke-width":1,"stroke-miterlimit":10,stroke:t,fill:t},s[6]={name:"path",d:"M11.805,13.899a2.123,2.111 0 1,0 4.246,0a2.123,2.111 0 1,0 -4.246,0","stroke-width":1,"stroke-miterlimit":10,stroke:t,fill:t},s[7]={name:"path",d:"M6.19,13.899a2.123,2.111 0 1,0 4.246,0a2.123,2.111 0 1,0 -4.246,0","stroke-width":1,"stroke-miterlimit":10,stroke:t,fill:t};break;case"Star":a.height=a.width=21,s[0]={name:"rect",x:0,y:0,width:21,height:21,transform:"translate(0,0)",fill:"#ffffff",opacity:n},s[1]={name:"path",d:"M15.913,18.59L10.762 12.842 5.613 18.75 8.291 11.422 0.325 9.91 8.154 8.33 5.337 0.91 10.488 6.658 15.637 0.75 12.959 8.078 20.925 9.59 13.096 11.17 z","stroke-width":1,stroke:t,fill:t};break;case"Triangle":a.height=a.width=10,s[0]={name:"rect",x:0,y:0,width:10,height:10,transform:"translate(0,0)",fill:"#ffffff",opacity:n},s[1]={name:"path",d:"M4.987,0L7.48 4.847 9.974 9.694 4.987 9.694 0 9.694 2.493 4.847 z","stroke-width":1,stroke:t,fill:t};break;case"Circle":a.height=a.width=9,s[0]={name:"rect",x:0,y:0,width:9,height:9,transform:"translate(0,0)",fill:"#ffffff",opacity:n},s[1]={name:"circle",cx:5.125,cy:3.875,r:3.625,"stroke-width":1,fill:t};break;case"Tile":a.height=a.width=18,s[0]={name:"rect",x:0,y:0,width:18,height:18,transform:"translate(0,0)",fill:"#ffffff",opacity:n},s[1]={name:"path",d:"M0,9L0 0 9 0 z","stroke-width":1,stroke:t,fill:t},s[2]={name:"path",d:"M9,9L9 0 18 0 z","stroke-width":1,stroke:t,fill:t},s[3]={name:"path",d:"M0,18L0 9 9 9 z","stroke-width":1,stroke:t,fill:t},s[4]={name:"path",d:"M9,18L9 9 18 9 z","stroke-width":1,stroke:t,fill:t};break;case"HorizontalDash":a.height=a.width=12,s[0]={name:"rect",x:0,y:0,width:12,height:12,transform:"translate(0,0)",fill:"#ffffff",opacity:n},s[1]={name:"path",d:"M0,1.5 L10 1.5 M0,5.5 L10 5.5 M0,9.5 L10 9.5 z","stroke-width":1,stroke:t,fill:t};break;case"VerticalDash":a.height=a.width=12,s[0]={name:"rect",x:0,y:0,width:12,height:12,transform:"translate(0,0)",fill:"#ffffff",opacity:n},s[1]={name:"path",d:"M1.5,0 L1.5 10 M5.5,0 L5.5 10 M9.5,0 L9.5 10 z","stroke-width":1,stroke:t,fill:t};break;case"Rectangle":a.height=a.width=12,s[0]={name:"rect",width:12,height:12,fill:"#ffffff",opacity:n},s[1]={name:"rect",x:1,y:2,width:4,height:9,fill:t,opacity:n},s[2]={name:"rect",x:7,y:2,width:4,height:9,fill:t,opacity:n};break;case"Box":a.height=a.width=10,s[0]={name:"rect",width:13,height:13,fill:"#ffffff",opacity:n},s[1]={name:"rect",x:1.5,y:1.5,width:10,height:9,fill:t,opacity:n};break;case"HorizontalStripe":a.height=12,a.width=10,s[0]={name:"rect",x:0,y:0,width:10,height:12,transform:"translate(0,0)",fill:"#ffffff",opacity:n},s[1]={name:"path",d:"M0,0.5 L10 0.5 M0,4.5 L10 4.5 M0,8.5 L10 8.5 z","stroke-width":1,stroke:t,fill:t};break;case"VerticalStripe":a.height=10,a.width=12,s[0]={name:"rect",x:0,y:0,width:12,height:10,transform:"translate(0,0)",fill:"#ffffff",opacity:n},s[1]={name:"path",d:"M0.5,0 L0.5 10 M4.5,0 L4.5 10 M8.5,0 L8.5 10 z","stroke-width":1,stroke:t,fill:t};break;case"Bubble":a.height=a.width=20,s[0]={name:"rect",x:0,y:0,width:20,height:20,transform:"translate(0,0)",fill:"#ffffff",opacity:n},s[1]={name:"circle",cx:5.217,cy:11.325,r:3.429,"stroke-width":1,fill:"#D0A6D1"},s[2]={name:"circle",cx:13.328,cy:6.24,r:4.884,"stroke-width":1,fill:t},s[3]={name:"circle",cx:13.277,cy:14.66,r:3.018,"stroke-width":1,fill:"#D0A6D1"}}var l=e.svgRenderer||e.renderer,h=l.createPattern(a,"pattern");return this.loadPattern(e,s,h,l),o.appendChild(h),"url(#"+e.element.id+"_"+r+"_Selection_"+i+")"},e.prototype.loadPattern=function(e,t,i,r){var n;for(n=0;n<t.length;n++){var o=r.createPattern(t[n],t[n].name);i.appendChild(o)}},e.prototype.concatIndexes=function(e,t){return e.concat(t)},e.prototype.checkVisibility=function(e,t){if(void 0===t&&(t=null),!e)return!1;for(var i=!1,r=[],n=0,o=e;n<o.length;n++){var s=o[n];-1===r.indexOf(s.series)&&r.push(s.series)}for(var a=0,l=r;a<l.length;a++){s=l[a];if(null!=t&&t.rangeColorSettings&&t.rangeColorSettings.length>0&&t.rangeColorSettings[0].colors.length>0){if(this.control.series[0].visible){i=!0;break}}else if(this.control.series[s].visible){i=!0;break}}return i},e.prototype.addSvgClass=function(e,t){var i=e.getAttribute("class")||"";-1===(i+=""!==i?" ":"").indexOf(t)&&e.setAttribute("class",i+t)},e.prototype.removeSvgClass=function(e,t){var i=e.getAttribute("class")||"";i.indexOf(t)>-1&&e.setAttribute("class",i.replace(t,""))},e.prototype.getChildren=function(e){for(var t=[],i=0;i<e.childNodes.length;i++)"defs"!==e.childNodes[i].tagName&&t.push(e.childNodes[i]);return t},e}(),Co=(qi=function(e,t){return(qi=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}qi(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),Oo=function(e){function t(t){var i=e.call(this,t)||this;i.isdrawRect=!0,i.multiDataIndexes=[],i.pathIndex=0,i.seriesIndex=0,i.count=-1,i.dragRectArray=[],i.filterArray=[],i.totalSelectedPoints=[],i.chart=t,i.renderer=t.renderer;var r=t.selectionMode;return i.isMultiDrag=t.isMultiSelect&&r.indexOf("Drag")>-1,i.addEventListener(),i}return Co(t,e),t.prototype.addEventListener=function(){if(!(this.chart.isDestroyed||this.chart.stockChart&&this.chart.stockChart.onPanning)){var e=sf.base.Browser.isPointer?"pointerleave":"mouseleave";this.chart.on(sf.base.Browser.touchMoveEvent,this.mouseMove,this),this.chart.on(e,this.mouseLeave,this),this.chart.on("click",this.mouseClick,this),this.chart.on(sf.base.Browser.touchStartEvent,this.mousedown,this),this.chart.on(sf.base.Browser.touchEndEvent,this.mouseLeave,this)}},t.prototype.mousedown=function(e){var t=this.chart;t.isPointMouseDown||"None"===t.selectionMode||t.isChartDrag||(t.isDoubleTap||!t.isTouch||this.rectPoints)&&this.dragStart(t,t.chartAxisLayoutPanel.seriesClipRect,t.mouseDownX,t.mouseDownY,e)},t.prototype.removeEventListener=function(){this.chart.isDestroyed||(this.chart.off(sf.base.Browser.touchMoveEvent,this.mouseMove),this.chart.off("pointerleave",this.mouseLeave),this.chart.off("click",this.mouseClick),this.chart.off(sf.base.Browser.touchStartEvent,this.mousedown),this.chart.off(sf.base.Browser.touchEndEvent,this.mouseLeave))},t.prototype.initPrivateVariables=function(e){this.styleId=e.element.id+"_ej2_chart_selection",this.unselected=e.element.id+"_ej2_deselected",this.closeIconId=e.element.id+"_ej2_drag_close",this.draggedRectGroup=e.element.id+"_ej2_drag_group",this.multiRectGroup=e.element.id+"_ej2_drag_multi_group",this.draggedRect=e.element.id+"_ej2_drag_rect",this.lassoPath=e.element.id+"_ej2_drag_path",this.selectedDataIndexes=[],this.rectPoints=null,this.isSeriesMode="Series"===e.selectionMode},t.prototype.invokeSelection=function(e){this.initPrivateVariables(e),this.series=sf.base.extend({},e.visibleSeries,null,!0),this.seriesStyles(),this.currentMode=e.selectionMode,e.selectionMode.indexOf("Drag")>-1||this.selectDataIndex(e,this.concatIndexes(e.selectedDataIndexes,this.selectedDataIndexes))},t.prototype.generateStyle=function(e){return e?(this.styleId.indexOf("selection")>1&&"None"!==this.chart.selectionMode&&(this.unselected=e.unSelectedStyle||this.unselected),this.styleId.indexOf("highlight")>0&&("None"!==this.chart.highlightMode||this.chart.legendSettings.enableHighlight)&&(this.unselected=e.nonHighlightStyle||this.unselected),e.selectionStyle||this.styleId+"_series_"+e.index):"undefined"},t.prototype.selectDataIndex=function(e,t){for(var i=0,r=t;i<r.length;i++){var n=r[i];this.performSelection(n,e,this.getElementByIndex(e,n)[0])}},t.prototype.getElementByIndex=function(e,t,i,r){void 0===i&&(i="");var n=e.element.id+"_Series_"+t.series+"_Point_"+t.point,o=e.series[t.series];return[Ge(n="Scatter"!==o.type&&"Bubble"!==o.type&&r?n+"_Symbol"+i:n),"RangeArea"!==o.type&&"SplineRangeArea"!==o.type||!o.marker.visible?null:Ge(n+"1")]},t.prototype.getClusterElements=function(e,t){for(var i,r,n=[],o=0,s=e.visibleSeries;o<s.length;o++){var a=s[o];if(a.visible){t=new b(a.index,t.point),a.isRectSeries&&n.push(this.getElementByIndex(e,t)[0]),n.push(this.getElementByIndex(e,t,"",a.marker.visible)[0]),i=this.generateStyle(e.visibleSeries[t.series]),r=document.querySelectorAll("."+i),this.findTrackballElements(r,i);var l=a.marker.visible&&a.isRectSeries?2:1;!e.isMultiSelect&&r.length>0&&r[0].id!==n[n.length-l].id&&this.removeSelection(e,t.series,r,i,!0)}}return n},t.prototype.findTrackballElements=function(e,t){for(var i,r,n=0;n<e.length;n++)if(!sf.base.isNullOrUndefined(e[n])&&(i=sf.base.isNullOrUndefined(e[n].parentNode)?[]:[].slice.call(e[0].parentNode.querySelectorAll("."+t))).length>0){r=[];for(var o=0;o<i.length;o++)i[o].id.indexOf("Trackball")>-1&&r.push(i[o]);this.removeStyles(r)}},t.prototype.findElements=function(e,t,i,r,n){return void 0===r&&(r=""),this.isSeriesMode?this.getSeriesElements(t):"Cluster"===this.currentMode?this.getClusterElements(e,i):this.getElementByIndex(e,i,r,n)},t.prototype.isAlreadySelected=function(e,t){if("click"===t?(this.currentMode=this.chart.selectionMode,this.styleId=this.chart.element.id+"_ej2_chart_selection"):"mousemove"!==t&&"pointermove"!==t||(this.currentMode=this.chart.highlightMode,this.highlightDataIndexes=[],this.styleId=this.chart.element.id+"_ej2_chart_highlight"),"None"!==this.chart.highlightMode&&"None"===this.chart.selectionMode&&"click"===t)return!1;if(("None"!==this.chart.highlightMode||this.chart.legendSettings.enableHighlight)&&this.previousSelectedEle&&this.previousSelectedEle[0]){var i=e.parentNode.id,r=void 0;e.parentNode&&(r=i.indexOf("SeriesGroup")>0||i.indexOf("SymbolGroup")>0);for(var n=0;n<this.previousSelectedEle.length;n++)if(this.previousSelectedEle[n].hasAttribute("class"))if(this.previousSelectedEle[n].getAttribute("class").indexOf("highlight")>-1&&(r||"click"===t)){if(this.previousSelectedEle[n].removeAttribute("class"),""!==this.chart.highlightColor&&!sf.base.isNullOrUndefined(this.chart.highlightColor)&&"None"===this.chart.highlightPattern)if(this.previousSelectedEle[n].id.indexOf("Group")>0)for(var o=0;o<this.previousSelectedEle[n].children.length;o++)this.previousSelectedEle[n].children[o].setAttribute("fill",this.control.visibleSeries[this.indexFinder(this.previousSelectedEle[n].id).series].interior);else this.previousSelectedEle[n].setAttribute("fill",this.control.visibleSeries[this.indexFinder(this.previousSelectedEle[n].id).series].interior);this.addOrRemoveIndex(this.highlightDataIndexes,this.indexFinder(this.previousSelectedEle[n].id))}else!r&&this.previousSelectedEle[n].getAttribute("class").indexOf("highlight")>-1&&this.performSelection(this.indexFinder(this.previousSelectedEle[n].id),this.chart,this.previousSelectedEle[n])}return!0},t.prototype.mouseClick=function(e){this.calculateSelectedElements(e.target,e.type)},t.prototype.calculateSelectedElements=function(e,t){if(!sf.base.isNullOrUndefined(e)&&!("None"===this.chart.selectionMode&&"None"===this.chart.highlightMode||e.id&&-1===e.id.indexOf(this.chart.element.id+"_"))){if("mousemove"===t||"pointermove"===t){if(e.hasAttribute("class")&&(e.getAttribute("class").indexOf("highlight")>-1||e.getAttribute("class").indexOf("selection")>-1))return;if(!sf.base.isNullOrUndefined(e.parentNode)&&e.parentNode.hasAttribute("class")&&(e.parentNode.getAttribute("class").indexOf("highlight")>0||e.parentNode.getAttribute("class").indexOf("selection")>0))return}if(this.isAlreadySelected(e,t),e.id&&e.id.indexOf("_Series_")>-1&&-1===e.id.indexOf("_Text_")){var i=void 0;if(e.id.indexOf("_Trackball_1")>-1)i=Ge(e.id.split("_Trackball_")[0]+"_Symbol"),i=sf.base.isNullOrUndefined(i)?Ge(e.id.split("_Trackball_")[0]):i;else if(e.id.indexOf("_Trackball_0")>-1)return null;this.performSelection(this.indexFinder(e.id),this.chart,i||e)}}},t.prototype.performSelection=function(e,t,i){if(this.isSeriesMode="Series"===this.currentMode,"BoxAndWhisker"===t.series[e.series].type&&i&&i.id===t.element.id+"_Series_"+e.series+"_Point_"+e.point+"_BoxPath"&&(i=i.parentNode),"Area"===t.series[e.series].type&&("Point"===this.currentMode||"Cluster"===this.currentMode)&&i&&i.id===this.chart.element.id+"_Series_"+e.series){var r=this.generateStyle(t.series[e.series]),n=document.querySelectorAll("."+r);this.findTrackballElements(n,r),this.blurEffect(t.element.id,t.visibleSeries,!1,e.point)}switch(this.currentMode){case"Series":this.selection(t,e,this.getSeriesElements(t.series[e.series])),this.selectionComplete(t,e,this.currentMode),this.blurEffect(t.element.id,t.visibleSeries,!1,e.point);break;case"Point":if(!isNaN(e.point)&&i){var o=[];o.push(i),null===o[0]||!t.series[e.series].marker.visible||-1===t.series[e.series].type.indexOf("Column")&&-1===t.series[e.series].type.indexOf("Bar")||(-1===i.id.indexOf("_Symbol")&&Ge(i.id+"_Symbol")?o.push(Ge(i.id+"_Symbol")):-1!==i.id.indexOf("_Symbol")&&Ge(i.id.replace("_Symbol",""))&&o.push(Ge(i.id.replace("_Symbol","")))),this.selection(t,e,o),this.selectionComplete(t,e,this.currentMode),this.blurEffect(t.element.id,t.visibleSeries,!1,e.point)}break;case"Cluster":isNaN(e.point)||(this.clusterSelection(t,e),this.selectionComplete(t,e,this.currentMode),this.blurEffect(t.element.id,t.visibleSeries,!1,e.point))}},t.prototype.selectionComplete=function(e,t,i){var r,n,o,s,a,l=[];if("Cluster"===i)for(var h=0,d=e.visibleSeries;h<d.length;h++){if((p=d[h]).visible)for(var c=0;c<this.selectedDataIndexes.length;c++)n=e.isMultiSelect?this.selectedDataIndexes[c].point:t.point,o=p.index,r=p.points,isNaN(n)||(p.type,s=r[n].yValue,a=r[n].xValue,"Category"===e.primaryXAxis.valueType?a=r[n].x.toLocaleString():"DateTime"===e.primaryXAxis.valueType&&(a=new Date(r[n].xValue)),"Indicator"!==p.category&&l.push({x:a,y:s,seriesIndex:o,pointIndex:n}),"RangeArea"!==p.type&&"SplineRangeArea"!==p.type||l.push({x:a,y:r[n].regions[0].y,seriesIndex:o,pointIndex:n}))}else if("Series"===i)if(e.isMultiSelect)for(c=0;c<this.selectedDataIndexes.length;c++)o=this.selectedDataIndexes[c].series,l.push({seriesIndex:o});else o=this.selectedDataIndexes.length>0?this.selectedDataIndexes[0].series:0,l.push({seriesIndex:o});else if("Point"===i)for(c=0;c<this.selectedDataIndexes.length;c++){var p;n=this.selectedDataIndexes[c].point,o=this.selectedDataIndexes[c].series,r=(p=e.series[o]).points,isNaN(n)||(a=r[n].xValue,p.type,s=r[n].yValue,"Category"===e.primaryXAxis.valueType?a=r[n].x.toLocaleString():"DateTime"===e.primaryXAxis.valueType&&(a=new Date(r[n].xValue)),l.push({x:a,y:s,seriesIndex:o,pointIndex:n}))}var u={name:"selectionComplete",selectedDataValues:l,cancel:!1};e.trigger("selectionComplete",u)},t.prototype.selection=function(e,t,i){"Lasso"!==this.currentMode&&(e.isMultiSelect||-1!==this.currentMode.indexOf("Drag")||-1!==this.styleId.indexOf("highlight")||"None"===e.selectionMode||this.removeMultiSelectElements(e,this.selectedDataIndexes,t,e.series));var r=this.rangeColorMappingEnabled()?0:t.series;if(!sf.base.isNullOrUndefined(i[0])){e.series[r].isRectSeries&&i[0].id&&(document.getElementById(i[0].id+"_Symbol")?i.push(Ge(i[0].id+"_Symbol")):-1!==i[0].id.indexOf("SeriesGroup")&&document.getElementById(i[0].id.replace("SeriesGroup","SymbolGroup"))&&i.push(Ge(i[0].id.replace("SeriesGroup","SymbolGroup"))));var n=void 0,o=i[0]&&(i[0].getAttribute("class")||""),s=i[0].parentNode&&(i[0].parentNode.getAttribute("class")||"");""!==o&&"Cluster"!==this.currentMode&&this.findTrackballElements(i,o),i[0]&&o.indexOf(this.getSelectionClass(i[0].id))>-1?this.removeStyles(i):i[0].parentNode&&s.indexOf(this.getSelectionClass(i[0].id))>-1?this.removeStyles([i[0].parentNode]):(this.previousSelectedEle="None"!==e.highlightMode||e.legendSettings.enableHighlight?i:[],this.applyStyles(i),n=!0),this.styleId.indexOf("highlight")>0&&("None"!==e.highlightMode||e.legendSettings.enableHighlight)?this.addOrRemoveIndex(this.highlightDataIndexes,t,n):this.addOrRemoveIndex(this.selectedDataIndexes,t,n)}},t.prototype.clusterSelection=function(e,t){this.selection(e,t,this.getClusterElements(e,new b(t.series,t.point)))},t.prototype.removeMultiSelectElements=function(e,t,i,r){for(var n,o=0;o<t.length;o++)n=r[t[o].series],(this.isSeriesMode&&!this.toEquals(t[o],i,this.isSeriesMode)||"Cluster"===this.currentMode&&!this.toEquals(t[o],i,!1)||!this.isSeriesMode&&this.toEquals(t[o],i,!0)&&!this.toEquals(t[o],i,!1))&&(this.removeStyles(this.findElements(e,n,t[o],"",!1)),n.marker.visible&&this.removeStyles(this.findElements(e,n,t[o],"",!0)),t.splice(o,1),o--)},t.prototype.blurEffect=function(e,t,i,r){void 0===i&&(i=!1),void 0===r&&(r=0);for(var n=this.checkVisibility(this.highlightDataIndexes,this.chart)||this.checkVisibility(this.selectedDataIndexes,this.chart),o=0,s=t;o<s.length;o++){var a=s[o],l=void 0,h=void 0;this.rangeColorMappingEnabled()?!1===i?(l=Object.keys(a.rangeColorPoints).indexOf(a.points[r].interior),h=a.points[r].interior):(l=r,h=document.getElementById(e+"_chart_legend_shape_"+r).getAttribute("fill")):(l=a.index,h=this.chart.visibleSeries[a.index].interior),a.visible&&(this.checkSelectionElements(Ge(e+"SeriesGroup"+a.index),this.generateStyle(a),n,i,l,h),sf.base.isNullOrUndefined(Ge(e+"SymbolGroup"+a.index))||this.checkSelectionElements(Ge(e+"SymbolGroup"+a.index),this.generateStyle(a),n,i,l,h))}},t.prototype.checkSelectionElements=function(e,t,i,r,n,o){void 0===r&&(r=!0),void 0===n&&(n=0),void 0===o&&(o="#D3D3D3");var s,a,l,h=this.isSeriesMode?[e]:e.childNodes||e;"None"===this.chart.selectionMode||"None"===this.chart.highlightMode&&!this.chart.legendSettings.enableHighlight||(h=e.childNodes||e);for(var d=e,c=0;c<h.length;c++)s=h[c].getAttribute("class")||"",a=h[c].parentNode.getAttribute("class")||"","None"===this.chart.selectionMode||"None"===this.chart.highlightMode&&!this.chart.legendSettings.enableHighlight||(t=s.indexOf("selection")>0||s.indexOf("highlight")>0?s:t,t=a.indexOf("selection")>0||a.indexOf("highlight")>0?a:t),-1===s.indexOf(t)&&-1===a.indexOf(t)&&i?this.addSvgClass(h[c],this.unselected):(d=h[c],this.removeSvgClass(h[c],this.unselected),this.removeSvgClass(h[c].parentNode,this.unselected)),h[c].id.indexOf("Trackball")>0&&d.classList[0]===t&&(this.removeSvgClass(h[c],this.unselected),this.removeSvgClass(h[c].parentNode,this.unselected),this.addSvgClass(h[c],t));if(e.id.indexOf("Symbol")>-1&&e.querySelectorAll("."+t)[0]&&e.querySelectorAll("."+t)[0].getAttribute("class")===t){var p=Ge(this.control.element.id+"_Series_"+e.id[e.id.length-1]);(p&&p.hasAttribute("class")?p.getAttribute("class"):"").indexOf(this.unselected)>-1&&this.removeSvgClass(p,this.unselected)}if(this.control.legendModule&&this.control.legendSettings.visible&&(l=Ge(this.control.element.id+"_chart_legend_shape_"+n))){l.hasAttribute("class")&&(this.removeSvgClass(l,l.getAttribute("class")),sf.base.isNullOrUndefined(this.chart.highlightColor&&""!==this.chart.highlightColor)||this.chart.legendSettings.enableHighlight||(l.setAttribute("stroke",o),"None"===this.chart.highlightPattern&&l.setAttribute("fill",o))),s=d.getAttribute("class")||"",a=d.parentNode.getAttribute("class")||"",-1===s.indexOf(t)&&-1===a.indexOf(t)&&i?(this.addSvgClass(l,"None"===this.chart.highlightMode&&this.chart.legendSettings.enableHighlight?t:this.unselected),this.removeSvgClass(l,t),""===this.chart.highlightColor||sf.base.isNullOrUndefined(this.chart.highlightColor)||(l.setAttribute("stroke",this.control.visibleSeries[n].interior),"None"===this.chart.highlightPattern&&l.setAttribute("fill",this.control.visibleSeries[n].interior))):(this.removeSvgClass(l,this.unselected),sf.base.isNullOrUndefined(this.chart.highlightColor)||""===this.chart.highlightColor||(l.setAttribute("stroke",this.control.visibleSeries[n].interior),"None"===this.chart.highlightPattern&&l.setAttribute("fill",this.control.visibleSeries[n].interior)),""===s&&""===a||"EJ2-Trackball"===s.trim()?this.removeSvgClass(l,t):(this.addSvgClass(l,t),t.indexOf("highlight")>0&&""!==this.chart.highlightColor&&!sf.base.isNullOrUndefined(this.chart.highlightColor)&&(l.setAttribute("stroke",this.chart.highlightColor),this.styleId.indexOf("highlight")>0&&"None"===this.chart.highlightPattern&&l.setAttribute("fill",this.chart.highlightColor))));var u=void 0;if(this.rangeColorMappingEnabled())for(c=0;c<this.chart.rangeColorSettings.length;c++)l!==(u=document.getElementById(this.chart.element.id+"_chart_legend_shape_"+c))?this.addSvgClass(u,this.unselected):!0===r&&this.addSvgClass(u,t),-1===s.indexOf(t)&&!1===r&&this.removeSvgClass(u,this.unselected);r&&a.indexOf(t)>-1&&this.addSvgClass(l,t)}},t.prototype.applyStyles=function(e){for(var t=0,i=e;t<i.length;t++){var r=i[t];if(r){if(this.removeSvgClass(r.parentNode,this.unselected),this.removeSvgClass(r,this.unselected),"fill"===this.chart.series[0].pointColorMapping||this.rangeColorMappingEnabled()){var n=this.getSelectionClass(r.id),o=this.styleId.indexOf("highlight")>0?this.chart.highlightPattern:this.chart.selectionPattern,s=void 0,a=n.indexOf("highlight")>-1?parseInt(n.split(this.chart.element.id+"_ej2_chart_highlight_series_")[1],10):parseInt(n.split(this.chart.element.id+"_ej2_chart_selection_series_")[1],10);if((n.indexOf("highlight")>-1||n.indexOf("selection")>-1)&&(s=document.getElementById(this.chart.element.id+"_"+o+"_Selection_"+a)),-1===r.id.indexOf("legend")&&-1===r.id.indexOf("Group")&&null!=s)for(var l=1;l<s.children.length;l++)s.children[l].setAttribute("fill",r.getAttribute("fill")),s.children[l].setAttribute("stroke",r.getAttribute("fill"))}if(this.addSvgClass(r,this.getSelectionClass(r.id)),this.styleId.indexOf("highlight")>0&&""!==this.chart.highlightColor&&!sf.base.isNullOrUndefined(this.chart.highlightColor)&&"None"===this.chart.highlightPattern&&"transparent"!==this.chart.highlightColor)if(r.id.indexOf("Group")>0)for(l=0;l<r.children.length;l++)r.children[l].setAttribute("fill",this.chart.highlightColor);else r.setAttribute("fill",this.chart.highlightColor)}}},t.prototype.getSelectionClass=function(e){return this.generateStyle(this.control.series[this.indexFinder(e).series])},t.prototype.removeStyles=function(e){for(var t=0,i=e;t<i.length;t++){var r=i[t];if(r&&(this.removeSvgClass(r,this.getSelectionClass(r.id)),"None"===this.chart.highlightPattern&&""!==this.chart.highlightColor&&!sf.base.isNullOrUndefined(this.chart.highlightColor)&&"transparent"!==this.chart.highlightColor))if(r.id.indexOf("Group")>0)for(var n=0;n<r.children.length;n++)r.children[n].setAttribute("fill",this.control.visibleSeries[this.indexFinder(r.id).series].interior);else r.setAttribute("fill",this.control.visibleSeries[this.indexFinder(r.id).series].interior)}},t.prototype.addOrRemoveIndex=function(e,t,i){for(var r=0;r<e.length;r++)this.toEquals(e[r],t,this.isSeriesMode)&&(e.splice(r,1),r--);i&&e.push(t)},t.prototype.toEquals=function(e,t,i){return(e.series===t.series||"Cluster"===this.currentMode&&!i)&&(i||e.point===t.point)},t.prototype.redrawSelection=function(e,t,i){this.isSeriesMode="Series"===t,sf.base.isNullOrUndefined(t)||(-1!==t.indexOf("Drag")||"Lasso"===t||i?e.isRedrawSelection=!1:e.isRedrawSelection=!0);var r=sf.base.extend([],this.selectedDataIndexes,null,!0),n=sf.base.extend([],this.highlightDataIndexes,null,!0);this.styleId.indexOf("highlight")>0&&n.length>0?(this.removeSelectedElements(e,this.highlightDataIndexes,e.series),r=n):this.removeSelectedElements(e,this.selectedDataIndexes,e.series),this.blurEffect(e.element.id,e.visibleSeries,!1),this.selectDataIndex(e,r)},t.prototype.legendSelection=function(e,t,i,r){if("mousemove"===r){if(i.id.indexOf("text")>1&&(i=Ge(i.id.replace("text","shape"))),i.id.indexOf("marker")>1&&(i=Ge(i.id.replace("_marker",""))),i.id.indexOf("g")>1&&(i=Ge(i.id.replace("_g_","_shape_"))),i.hasAttribute("class")&&(i.getAttribute("class").indexOf("highlight")>-1||i.getAttribute("class").indexOf("selection")>-1))return;this.currentMode=this.chart.highlightMode}if(this.isAlreadySelected(i,r)){var n=this.generateStyle(e.visibleSeries[t]),o=document.querySelectorAll("."+n);this.isSeriesMode="Series"===this.currentMode;if(o.length>0)this.removeSelection(e,t,o,n,!0);else{for(var s=0,a=e.visibleSeries;s<a.length;s++){(g=a[s]).index===t||e.isMultiSelect||(n=this.generateStyle(e.visibleSeries[g.index]),o=document.querySelectorAll("."+n),this.removeSelection(e,t,o,n,!0))}var l=[];if(this.rangeColorMappingEnabled()){for(var h=0,d=e.visibleSeries[0].seriesElement.children;h<d.length;h++){var c=d[h];i.getAttribute("fill")===c.getAttribute("fill")&&l.push(c)}for(var p=0,u=l;p<u.length;p++){var g=u[p];if(sf.base.isNullOrUndefined(g))return;this.checkSelectionElements(g,n,!1,!0,t)}}else for(var f=0,m=l=this.getSeriesElements(e.visibleSeries[t]);f<m.length;f++){var y=m[f];if(sf.base.isNullOrUndefined(y))return;this.checkSelectionElements(y,n,!1,!0,t)}this.isSeriesMode=!0,this.selection(e,new b(t,NaN),l),this.isSeriesMode="Series"===e.selectionMode,this.blurEffect(e.element.id,e.visibleSeries,!0,t)}}},t.prototype.rangeColorMappingEnabled=function(){return!(!(this.chart.rangeColorSettings&&this.chart.rangeColorSettings.length>0&&1===this.chart.visibleSeries.length&&this.chart.rangeColorSettings[0].colors.length>0)||"Column"!==this.chart.series[0].type&&"Bar"!==this.chart.series[0].type&&"Scatter"!==this.chart.series[0].type&&"Bubble"!==this.chart.series[0].type)},t.prototype.removeSelection=function(e,t,i,r,n){if(i.length>0){for(var o=[],s=0;s<i.length;s++)o.push(i[s]);this.removeStyles(o),this.isSeriesMode=!0,this.addOrRemoveIndex(this.selectedDataIndexes,new b(t,NaN));for(var a=0,l=e.visibleSeries;a<l.length;a++){var h=l[a];if(r=this.generateStyle(h),document.querySelectorAll("."+r).length>0){for(var d=0,c=o;d<c.length;d++){var p=c[d];this.checkSelectionElements(p,r,!0,!0,t)}n=!1;break}}n&&(this.isSeriesMode="Series"===e.selectionMode,this.blurEffect(e.element.id,e.visibleSeries))}},t.prototype.getSeriesElements=function(e){var t=[e.seriesElement];return(e.marker.visible&&"Scatter"!==e.type&&"Bubble"!==e.type&&!e.isRectSeries||e.marker.visible&&e.isRectSeries)&&t.push(e.symbolElement),t},t.prototype.indexFinder=function(e){var t=["NaN","NaN"];return e.indexOf("SeriesGroup")>-1?(t=e.split("SeriesGroup"))[0]=t[1]:e.indexOf("SymbolGroup")>-1?(t=e.split("SymbolGroup"))[0]=t[1]:e.indexOf("_Point_")>-1?t=e.split("_Series_")[1].split("_Point_"):e.indexOf("_Series_")>-1?t[0]=e.split("_Series_")[1]:e.indexOf("_chart_legend_shape_")>-1&&((t=e.split("_chart_legend_shape_"))[0]=t[1]),new b(parseInt(t[0],10),parseInt(t[1],10))},t.prototype.calculateDragSelectedElements=function(e,t,i){this.removeSelectedElements(e,this.selectedDataIndexes,e.series);var r,n,o="Lasso"===e.selectionMode,s=new sf.svgbase.Rect(t.x,t.y,t.width,t.height),a=new jt(e.chartAxisLayoutPanel.seriesClipRect.x,e.chartAxisLayoutPanel.seriesClipRect.y);this.removeOffset(s,a);var l=[],h=[];this.isSeriesMode=!1;var d=e.allowMultiSelection&&(this.rectGrabbing||this.resizing);if(this.rectPoints=this.dragRectArray[d?this.targetIndex:this.count]=new sf.svgbase.Rect(t.x,t.y,t.width,t.height),t.width&&t.height&&!i){var c=new sf.svgbase.Rect(t.x,t.y,t.width,t.height);this.removeOffset(c,a),this.filterArray[d?this.targetIndex:this.count]=c}for(var p=function(t){if(t.visible){var i,o;r=t.points,l=[],!e.isTransposed&&-1===t.type.indexOf("Bar")||e.isTransposed&&-1!==t.type.indexOf("Bar")?(i=t.xAxis.rect.x-a.x,o=t.yAxis.rect.y-a.y):(i=t.xAxis.rect.y-a.y,o=t.yAxis.rect.x-a.x);for(var d=0;d<r.length;d++){var c=(t.type,r[d].yValue),p=void 0,g=r[d].xValue;"Category"===e.primaryXAxis.valueType?g=r[d].x.toLocaleString():"DateTime"===e.primaryXAxis.valueType&&(g=new Date(r[d].xValue)),(p="BoxAndWhisker"===t.type?r[d].regions.some((function(e){return Ce(e.x+i,e.y+o,s)})):"Lasso"===e.selectionMode?r[d].isSelect:e.allowMultiSelection?u.isPointSelect(r[d],i,o,u.filterArray):r[d].symbolLocations.some((function(e){return e&&Ce(e.x+i,e.y+o,s)})))&&"Indicator"!==t.category&&(n=new b(t.index,r[d].index),u.selection(e,n,u.findElements(e,t,n,"",!t.isRectSeries&&t.marker.visible)),l.push({x:g,y:c})),!p||"RangeArea"!==t.type&&"SplineRangeArea"!==t.type||l.push({x:g,y:r[d].regions[0].y})}h.push(l)}},u=this,g=0,f=e.visibleSeries;g<f.length;g++){p(f[g])}this.blurEffect(e.element.id,e.visibleSeries);var m=o?e.mouseDownX:t.x+t.width,y=o?e.mouseDownY:t.y;i||this.createCloseButton(m,y);var v={name:"dragComplete",selectedDataValues:h,cancel:!1};e.trigger("dragComplete",v)},t.prototype.removeOffset=function(e,t){e.x-=t.x,e.y-=t.y},t.prototype.isPointSelect=function(e,t,i,r){for(var n=e.symbolLocations[0],o=0,s=r;o<s.length;o++){var a=s[o];if(a&&n&&Ce(n.x+t,n.y+i,a))return!0}return!1},t.prototype.drawDraggingRect=function(e,t){var i=e.chartAxisLayoutPanel.seriesClipRect,r=e.chartArea.border.width,n=e.themeStyle.selectionRectFill,o=e.themeStyle.selectionRectStroke,s="Lasso"===e.selectionMode;switch(this.isdrawRect&&(i.x=i.x-r/2,i.y=i.y-r/2,i.width=i.width+r,i.height=i.height+r,this.isdrawRect=!1),e.selectionMode){case"DragX":t.y=i.y,t.height=i.height;break;case"DragY":t.x=i.x,t.width=i.width}if((t.width<5||t.height<5)&&!s)return null;var a=e.selectionMode.indexOf("Drag")>-1||"Lasso"===e.selectionMode;if(e.allowMultiSelection&&a){var l=void 0,h=void 0,d=Ge(this.multiRectGroup);if(d||(d=e.svgRenderer.createGroup({id:this.multiRectGroup}),e.svgObject.appendChild(d)),this.rectGrabbing||this.resizing){var c=Ge(this.draggedRect+this.targetIndex);c.nextSibling&&sf.base.remove(c.nextSibling),this.setAttributes(c,t)}else if(!Ge(this.draggedRectGroup+this.count)){h=e.svgRenderer.createGroup({id:this.draggedRectGroup+this.count});var p=document.getElementById(e.element.id+"_series_svg");e.enableCanvas?p.appendChild(h):d.appendChild(h)}"Lasso"!==e.selectionMode?(l=e.svgRenderer.drawRectangle(new zt(this.draggedRect+this.count,n,{color:o,width:1},1,t))).style.cursor="move":l=e.svgRenderer.drawPath(new sf.svgbase.PathOption(this.lassoPath+this.count,n,3,o,1,"",this.path)),h||this.rectGrabbing||this.resizing?this.rectGrabbing||this.resizing||h.appendChild(l):Ge(this.draggedRectGroup+this.count).appendChild(l)}else{l=Ge(s?this.lassoPath:this.draggedRect);if(this.closeIcon&&ie(this.closeIconId),l)s?l.setAttribute("d",this.path):this.setAttributes(l,t);else{h=e.svgRenderer.createGroup({id:this.draggedRectGroup}),p=document.getElementById(e.element.id+"_series_svg");e.enableCanvas?p.appendChild(h):e.svgObject.appendChild(h),l="Lasso"!==e.selectionMode?e.svgRenderer.drawRectangle(new zt(this.draggedRect,n,{color:o,width:1},1,t)):e.svgRenderer.drawPath(new sf.svgbase.PathOption(this.lassoPath,n,3,o,1,"",this.path)),h.appendChild(l)}}},t.prototype.getIndex=function(e){var t;for(t=e.length-1;t>0;t--){var i=Number(e[t]);if(isNaN(i))break}return+e.substr(t+1,e.length-1)},t.prototype.createCloseButton=function(e,t){var i=this.chart.allowMultiSelection,r=this.chart.themeStyle.selectionCircleStroke,n=this.rectGrabbing||this.resizing,o=this.chart.svgRenderer.createGroup({id:this.closeIconId+(i?n?this.targetIndex:this.count:""),style:"cursor:pointer; visibility: visible;"});o.appendChild(this.chart.svgRenderer.drawCircle(new Wt(this.closeIconId+"_circle"+(i?n?this.targetIndex:this.count:""),"#FFFFFF",{color:r,width:1},1,e,t,10)));var s="M "+(e-4)+" "+(t-4)+" L "+(e+4)+" "+(t+4)+" M "+(e-4)+" "+(t+4)+" L "+(e+4)+" "+(t-4);o.appendChild(this.chart.svgRenderer.drawPath({id:this.closeIconId+"_cross"+(i?n?this.targetIndex:this.count:""),d:s,stroke:r,"stroke-width":2,fill:r})),this.closeIcon=o;var a=Ge(this.draggedRectGroup+(i?n?this.targetIndex:this.count:""));a&&a.appendChild(o)},t.prototype.removeDraggedElements=function(e,t,i){if(t.id&&t.id.indexOf(this.closeIconId)>-1&&-1===i.indexOf("move")){var r=!0;if(e.allowMultiSelection){var n=this.getIndex(t.id),o=Ge(this.multiRectGroup);if(sf.base.remove(Ge(this.draggedRectGroup+n)),this.dragRectArray[n]=null,this.filterArray[n]=null,this.totalSelectedPoints[n]=null,o&&0===o.childElementCount&&(ie(o),this.dragRectArray=[],this.filterArray=[],this.totalSelectedPoints=[]),"Lasso"===this.currentMode){if(null!=this.multiDataIndexes[n])for(var s=0;s<this.multiDataIndexes[n].length;s++)this.multiDataIndexes[n][s].isSelect=!1;this.multiDataIndexes[n]=null;for(var a=0;a<this.multiDataIndexes.length;a++)if(null!=this.multiDataIndexes[a]){r=!1;for(var l=0;l<this.multiDataIndexes[a].length;l++)this.multiDataIndexes[a][l].isSelect=!0}this.calculateDragSelectedElements(e,this.dragRect,!0)}else if(this.filterArray.length)for(s=0;s<this.filterArray.length;s++)this.filterArray[s]&&(r=!1,this.calculateDragSelectedElements(e,this.filterArray[s],!0));else this.calculateDragSelectedElements(e,new sf.svgbase.Rect(0,0,0,0),!0)}else sf.base.remove(Ge(this.draggedRectGroup)),this.removeSelectedElements(e,this.selectedDataIndexes,e.series);this.blurEffect(e.element.id,e.visibleSeries),this.changeCursorStyle(!1,e.svgObject,"auto"),e.allowMultiSelection&&!r||(this.rectPoints=null)}},t.prototype.resizingSelectionRect=function(e,t,i,r){var n;if(e.allowMultiSelection&&r.id.indexOf("_ej2_drag_rect")>-1||this.dragRectArray[this.targetIndex]){r.id.indexOf("_ej2_drag_rect")>-1&&(this.targetIndex=this.getIndex(r.id));var o=this.dragRectArray[this.targetIndex];n=new sf.svgbase.Rect(o.x,o.y,o.width,o.height)}if(e.allowMultiSelection||(n=new sf.svgbase.Rect(this.rectPoints.x,this.rectPoints.y,this.rectPoints.width,this.rectPoints.height)),n){var s=this.findResizeMode(e.svgObject,n,t);this.resizing&&(n=ot(n.x,n.y,n.x+n.width,n.y+n.height,e.chartAxisLayoutPanel.seriesClipRect),this.drawDraggingRect(e,n),this.dragRect=n),i&&(this.resizing=s)}},t.prototype.findResizeMode=function(e,t,i){var r="se-resize",n=!1;if(this.resizing){var o=t.x,s=t.y,a=i.x-o,l=i.y-s;switch(this.resizeMode){case 0:l=Math.abs(t.height+t.y-i.y),t.y=Math.min(t.height+t.y,i.y),t.height=l;break;case 1:a=Math.abs(t.width+t.x-i.x),t.x=Math.min(t.width+t.x,i.x),t.width=a;break;case 2:t.height=Math.abs(l),t.y=Math.min(i.y,s);break;case 3:t.width=Math.abs(a),t.x=Math.min(i.x,o);break;case 4:t.width=Math.abs(a),t.height=Math.abs(l),t.x=Math.min(i.x,o),t.y=Math.min(i.y,s)}}else for(var h=[new sf.svgbase.Rect(t.x,t.y,t.width-5,5),new sf.svgbase.Rect(t.x,t.y,5,t.height),new sf.svgbase.Rect(t.x,t.y+t.height-5,t.width-5,5),new sf.svgbase.Rect(t.x+t.width-5,t.y+5,5,t.height-15),new sf.svgbase.Rect(t.x+t.width-10,t.y+t.height-10,10,10)],d=0;d<h.length;d++)if(Ce(i.x,i.y,h[d])){r=4===d?r:d%2==0?"ns-resize":"ew-resize",n=!0,this.resizeMode=d;break}return"Lasso"!==this.currentMode&&this.changeCursorStyle(n,Ge(this.chart.allowMultiSelection?this.draggedRect+this.targetIndex:this.draggedRect),r),this.changeCursorStyle(n,e,r),n},t.prototype.changeCursorStyle=function(e,t,i){i=e?i:this.control.svgObject===t?"auto":"move",t&&(t.style.cursor=i)},t.prototype.removeSelectedElements=function(e,t,i){var r;t=e.isRedrawSelection?t:t.splice(0,t.length);for(var n=0,o=i;n<o.length;n++){var s=o[n];if(s.visible){r=this.getSeriesElements(s),this.removeStyles(r);for(var a=0,l=r;a<l.length;a++){var h=l[a];this.removeStyles(this.getChildren(h))}}}},t.prototype.setAttributes=function(e,t){for(var i=0,r=Object.keys(t);i<r.length;i++){var n=r[i];e.setAttribute(n,t[n])}},t.prototype.draggedRectMoved=function(e,t,i,r){var n;if((this.resizing||this.rectGrabbing)&&e.allowMultiSelection){var o=this.dragRectArray[this.targetIndex];n=new sf.svgbase.Rect(o.x,o.y,o.width,o.height)}else n=new sf.svgbase.Rect(this.rectPoints.x,this.rectPoints.y,this.rectPoints.width,this.rectPoints.height);n.x-=t.x-e.mouseX,n.y-=t.y-e.mouseY,n=ot(n.x,n.y,n.x+n.width,n.height+n.y,e.chartAxisLayoutPanel.seriesClipRect),i?this.drawDraggingRect(e,n):this.calculateDragSelectedElements(e,n)},t.prototype.mouseLeave=function(e){this.completeSelection(e.target,e.type)},t.prototype.completeSelection=function(e,t){var i=this.chart;"None"!==i.selectionMode&&(this.currentMode=i.selectionMode,(this.dragging||this.resizing)&&this.dragRect.width>5&&this.dragRect.height>5?this.calculateDragSelectedElements(i,this.dragRect):(!i.allowMultiSelection&&this.rectGrabbing&&this.rectPoints.width&&this.rectPoints.height||this.rectGrabbing&&this.dragRectArray[this.targetIndex].width&&this.dragRectArray[this.targetIndex].height)&&this.draggedRectMoved(i,this.dragRect),"Lasso"===i.selectionMode&&this.dragging&&this.path&&-1!==this.path.indexOf("L")&&(i.allowMultiSelection?Ge(this.lassoPath+this.count)&&(Ge(this.lassoPath+this.count).setAttribute("d",this.path+"Z"),this.pointChecking(Ge(this.lassoPath+this.count))):(Ge(this.lassoPath).setAttribute("d",this.path+"Z"),this.pointChecking(Ge(this.lassoPath))),(this.dragging||this.resizing)&&this.calculateDragSelectedElements(i,this.dragRect)),this.dragging=!1,this.rectGrabbing=!1,this.resizing=!1,this.removeDraggedElements(i,e,t))},t.prototype.getDragRect=function(e,t){return ot(e.mouseDownX,e.mouseDownY,e.mouseX,e.mouseY,t)},t.prototype.dragStart=function(e,t,i,r,n){var o=e.selectionMode;this.currentMode=e.selectionMode,this.dragging=(o.indexOf("Drag")>-1||"Lasso"===o)&&(e.isDoubleTap||!e.isTouch)&&"PolarRadar"!==e.chartAreaType;var s=n.target;if(this.path=void 0,this.dragging&&(this.count=Ge(this.multiRectGroup)?this.count+1:0,this.dragRect=new sf.svgbase.Rect(e.mouseDownX,e.mouseDownY,0,0),(e.mouseDownX<t.x||e.mouseDownX>t.x+t.width||e.mouseDownY<t.y||e.mouseDownY>t.y+t.height)&&(this.dragging=!1)),"Lasso"===o)for(var a=0,l=e.visibleSeries;a<l.length;a++){var h=l[a];if(h.visible)for(var d=0,c=h.points;d<c.length;d++){var p=c[d];e.allowMultiSelection||(p.isSelect=!1)}}if("Lasso"!==o&&(this.rectPoints&&!e.allowMultiSelection&&(this.dragRect=new sf.svgbase.Rect(e.mouseDownX,e.mouseDownY,0,0),this.resizingSelectionRect(e,new jt(i,r),!0),this.rectGrabbing=Ce(i,r,this.rectPoints)),e.allowMultiSelection)){var u=this.getIndex(s.id);this.targetIndex=this.isDragRect(s.id)?u:void 0,this.dragRectArray.length&&this.isDragRect(s.id)&&(this.resizingSelectionRect(e,new jt(i,r),!0,s),this.rectGrabbing=Ce(i,r,this.dragRectArray[u]))}},t.prototype.isDragRect=function(e){return e.indexOf("_ej2_drag_rect")>-1},t.prototype.mouseMove=function(e){var t=this.chart,i=e.target,r=e.type;this.highlightChart(i,r),"None"!==t.selectionMode&&("touchmove"===r&&(sf.base.Browser.isIos||sf.base.Browser.isIos7)&&this.dragging&&e.preventDefault&&e.preventDefault(),this.selectionAndDrag(t,i,r))},t.prototype.highlightChart=function(e,t){if("None"!==this.chart.highlightMode||this.chart.legendSettings.enableHighlight){if(!sf.base.isNullOrUndefined(e)){if(e.id.indexOf("text")>1&&(e=Ge(e.id.replace("text","shape"))),e.hasAttribute("class")&&(e.getAttribute("class").indexOf("highlight")>-1||e.getAttribute("class").indexOf("selection")>-1))return;this.calculateSelectedElements(e,t),this.chart.highlightModule.highlightDataIndexes&&this.chart.highlightModule.highlightDataIndexes.length>0&&-1===e.id.indexOf("_chart_legend_")&&-1===e.id.indexOf("_Series_")&&this.removeLegendHighlightStyles()}}else;},t.prototype.selectionAndDrag=function(e,t,i){Ce(e.mouseX,e.mouseY,e.chartAxisLayoutPanel.seriesClipRect)?(this.rectGrabbing&&!this.resizing?this.draggedRectMoved(e,this.dragRect,!0,t):this.dragging&&!this.resizing&&("Lasso"===e.selectionMode?(this.getPath(e.mouseDownX,e.mouseDownY,e.mouseX,e.mouseY),this.drawDraggingRect(e,this.dragRect)):(this.dragRect=this.getDragRect(e,e.chartAxisLayoutPanel.seriesClipRect),this.drawDraggingRect(e,this.dragRect))),(this.rectPoints&&!e.allowMultiSelection||e.allowMultiSelection&&!this.dragging||this.resizing)&&this.resizingSelectionRect(e,new jt(e.mouseX,e.mouseY),null,t)):this.completeSelection(t,i)},t.prototype.removeLegendHighlightStyles=function(){var e;this.chart.highlightModule.highlightDataIndexes=[];for(var t=0;t<this.chart.series.length;t++)if(e=document.getElementsByClassName(this.generateStyle(this.chart.series[t])),0===this.selectedDataIndexes.length){for(e=document.getElementsByClassName(this.generateStyle(this.chart.series[t]));e.length>0;){(i=e[0])&&this.removeSvgClass(i,i.getAttribute("class"))}for(e=document.getElementsByClassName(this.unselected);e.length>0;){(i=e[0])&&this.removeSvgClass(i,i.getAttribute("class"))}}else for(e=document.getElementsByClassName(this.generateStyle(this.chart.series[t]));e.length>0;){var i;(i=e[0])&&(this.removeSvgClass(i,i.getAttribute("class")),this.addSvgClass(i,this.unselected))}},t.prototype.getPath=function(e,t,i,r){this.dragging&&(this.path?this.path=this.path+" L"+i+" "+r:this.path="M "+e+" "+t)},t.prototype.pointChecking=function(e){var t,i=this,r=this.chart,n=Ge(r.svgId).getBoundingClientRect(),o=r.chartAxisLayoutPanel.seriesClipRect.x+Math.max(n.left,0),s=r.chartAxisLayoutPanel.seriesClipRect.y+Math.max(n.top,0);this.multiDataIndexes[this.count]=[];for(var a=0,l=r.visibleSeries;a<l.length;a++){l[a].points.filter((function(n){n.symbolLocations&&n.symbolLocations.length&&(t=document.elementFromPoint(n.symbolLocations[0].x+o,n.symbolLocations[0].y+s)),t===e?(n.isSelect=!0,i.chart.allowMultiSelection&&"Lasso"===i.currentMode&&(i.multiDataIndexes[i.count][i.seriesIndex]=n,i.seriesIndex++)):r.allowMultiSelection||(n.isSelect=!1)}))}this.seriesIndex=0},t.prototype.getModuleName=function(){return"Selection"},t.prototype.destroy=function(){this.removeEventListener()},t}(So),To=function(){function e(e){this.isPointDragging=!1,this.chart=e}return e.prototype.pointMouseDown=function(){var e=this.chart,t=new tr(e),i=t.getData();!i.point||!t.insideRegion&&i.series.isRectSeries||(this.seriesIndex=i.series.index,this.pointIndex=i.point.index,e.series[this.seriesIndex].dragSettings.enable&&!e.zoomModule&&(e.trigger("dragStart",{series:i.series,seriesIndex:this.seriesIndex,pointIndex:this.pointIndex,point:i.point,oldValue:e.visibleSeries[this.seriesIndex].yData[this.pointIndex],newValue:e.visibleSeries[this.seriesIndex].points[this.pointIndex].yValue}),e.isPointMouseDown=!0,e.zoomSettings.enableDeferredZooming=!1))},e.prototype.pointMouseMove=function(e){var t,i=this.chart;"touchmove"===e.type&&e.preventDefault&&e.preventDefault();var r=new tr(i),n=r.getData();n.series.dragSettings.enable&&n.point&&(r.insideRegion||!n.series.isRectSeries)?this.getCursorStyle(n):i.svgObject.style.cursor="null",i.isPointMouseDown&&((t=i.series[this.seriesIndex]).type.indexOf("Spline")>-1&&i[Ae(t.type)+"SeriesModule"].findSplinePoint(t),this.pointDragging(this.seriesIndex,this.pointIndex))},e.prototype.getCursorStyle=function(e){var t=this.chart;e.series.type.indexOf("Stacking")>-1?t.svgObject.style.cursor="":"Bar"===e.series.type&&t.isTransposed?t.svgObject.style.cursor="ns-resize":t.isTransposed||"Bar"===e.series.type?t.svgObject.style.cursor="ew-resize":t.svgObject.style.cursor="ns-resize"},e.prototype.pointDragging=function(e,t){var i,r,n,o=this.chart,s=[],a=o.visibleSeries[e],l=a.dragSettings,h=a.xAxis,d=a.yAxis,c=a.isRectSeries?1:0,p=Le(h,d,o.requireInvertedAxis);"Bar"===a.type?(i=o.isTransposed?p.y+p.height-o.mouseY:o.mouseX-p.x,r=o.isTransposed?p.height:p.width):(i=o.isTransposed?o.mouseX-p.x:p.y+p.height-o.mouseY,r=o.isTransposed?p.width:p.height),n=(n=d.isAxisInverse?1-i/r:i/r)*d.visibleRange.delta+d.visibleRange.min;var u=null!==d.minimum?d.visibleRange.min+c:sf.base.isNullOrUndefined(l.minY)?n:l.minY;if((null!==d.maximum?d.visibleRange.max+c:sf.base.isNullOrUndefined(l.maxY)?n:l.maxY)>=n&&u<=n){a.points[t].yValue=a.points[t].y=o.dragY="Logarithmic"===d.valueType?Math.pow(d.logBase,n):parseFloat(n.toFixed(2)),a.points[t].interior=l.fill;for(var g=0;g<a.points.length;g++)s[g]=a.points[g].yValue;a.yMin=Math.min.apply(null,s),a.yMax=Math.max.apply(null,s),this.isPointDragging=!0,o.refreshBound(),o.trigger("drag",{seriesIndex:e,pointIndex:t,series:a,point:a.points[t],oldValue:o.visibleSeries[this.seriesIndex].yData[this.pointIndex],newValue:a.points[t].yValue})}},e.prototype.pointMouseUp=function(){var e=this.chart;e.isPointMouseDown&&e.series[this.seriesIndex].dragSettings.enable&&(e.trigger("dragEnd",{series:e.series[this.seriesIndex],point:e.visibleSeries[this.seriesIndex].points[this.pointIndex],seriesIndex:this.seriesIndex,pointIndex:this.pointIndex,oldValue:e.visibleSeries[this.seriesIndex].yData[this.pointIndex],newValue:e.visibleSeries[this.seriesIndex].points[this.pointIndex].yValue}),e.visibleSeries[this.seriesIndex].points[this.pointIndex].y=e.visibleSeries[this.seriesIndex].points[this.pointIndex].yValue,e.isPointMouseDown=!1,this.isPointDragging=!1,this.seriesIndex=this.pointIndex=void 0)},e.prototype.getModuleName=function(){return"DataEditing"},e.prototype.destroy=function(){},e}(),Po=(Gi=function(e,t){return(Gi=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}Gi(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),Ao=function(e){function t(t){var i=e.call(this,t)||this;return i.chart=t,i.renderer=t.renderer,i.wireEvents(),i}return Po(t,e),t.prototype.wireEvents=function(){this.chart.isDestroyed||this.chart.stockChart&&this.chart.stockChart.onPanning||this.chart.on(sf.base.Browser.touchMoveEvent,this.mouseMove,this)},t.prototype.unWireEvents=function(){this.chart.isDestroyed||this.chart.off(sf.base.Browser.touchMoveEvent,this.mouseMove)},t.prototype.declarePrivateVariables=function(e){this.styleId=e.element.id+"_ej2_chart_highlight",this.unselected=e.element.id+"_ej2_deselected",this.selectedDataIndexes=[],this.highlightDataIndexes=[],this.isSeriesMode="Series"===e.highlightMode},t.prototype.invokeHighlight=function(e){this.declarePrivateVariables(e),this.series=sf.base.extend({},e.visibleSeries,null,!0),this.seriesStyles(),this.currentMode=e.highlightMode},t.prototype.getModuleName=function(){return"Highlight"},t.prototype.destroy=function(){this.unWireEvents()},t}(Oo),Lo=function(){function e(e){this.errorHeight=0,this.chart=e}return e.prototype.initPrivateVariables=function(e,t){var i="",r="",n=e.chart.renderer,o=void 0===e.index?e.category:e.index;"Cartesian"===e.chart.chartAreaType&&(i="translate("+e.clipRect.x+","+e.clipRect.y+")",r="url(#"+this.chart.element.id+"_ChartSeriesClipRect_"+o+")"),t.dataLabel.visible&&(e.shapeElement=n.createGroup({id:this.chart.element.id+"ShapeGroup"+o,transform:i,"clip-path":"url(#"+this.chart.element.id+"_ChartSeriesClipRect_"+o+")"}),e.textElement=n.createGroup({id:this.chart.element.id+"TextGroup"+o,transform:i,"clip-path":r}),e.textElement.setAttribute("aria-hidden","true")),this.markerHeight="Scatter"===e.type||t.visible?t.height/2:0,this.commonId=this.chart.element.id+"_Series_"+o+"_Point_",this.calculateErrorHeight(e,e.marker.dataLabel.position),this.chartBackground="transparent"===this.chart.chartArea.background?this.chart.background||this.chart.themeStyle.background:this.chart.chartArea.background},e.prototype.calculateErrorHeight=function(e,t){if(!e.errorBar.visible)return null;if(e.errorBar.visible&&"PolarRadar"!==this.chart.chartAreaType){var i=e.errorBar.direction,r=this.chart.errorBarModule.positiveHeight,n=this.chart.errorBarModule.negativeHeight;this.isRectSeries(e)?("Top"!==t&&"Auto"!==t||(this.errorHeight="Both"===i||"Minus"===i?n:0),"Outer"!==t&&"Auto"!==t||(this.errorHeight="Both"===i||"Plus"===i?r:0)):("Top"!==t&&"Outer"!==t&&"Auto"!==t||("Both"!==i&&"Plus"!==i||e.chart.isTransposed?this.errorHeight=0:this.errorHeight=r),"Bottom"!==t&&"Auto"!==t||(this.errorHeight="Both"===i||"Minus"===i?n:0))}else this.errorHeight=0},e.prototype.isRectSeries=function(e){return e.isRectSeries||"RangeArea"===e.type||"SplineRangeArea"===e.type},e.prototype.render=function(e,t,i){var r;this.initPrivateVariables(e,e.marker);var n,o,s,a,l,h,d,c={x:0,y:0};this.inverted=t.requireInvertedAxis,this.yAxisInversed=e.yAxis.isAxisInverse;for(var p,u,g,f=t.redraw,m=!1,y=[],v=t.element.id+"_Series_"+(void 0===e.index?e.category:e.index)+"_DataLabelCollections",b=sf.base.createElement("div",{id:v}),w=ee(e),x=0;x<w.length;x++){if(p=w[x],!i.showZero&&(0!==p.y||0===p.y&&"Zero"===e.emptyPointSettings.mode))return null;this.margin=i.margin;var M=[],N=void 0,I=void 0,S=void 0,C=void 0,O=void 0,T=!0,P=e.clipRect,A=void 0;m=!1,h=d=i.angle,a={width:i.border.width,color:i.border.color};var L=sf.base.extend({},sf.base.getValue("properties",i.font),null,!0);if(p.symbolLocations.length&&p.symbolLocations[0]||"BoxAndWhisker"===e.type&&p.regions.length){N=(M=at(p,e,t)).length;for(var F=0;F<N;F++)if(s={cancel:!1,name:"textRender",series:e,point:p,text:M[F],border:a,color:i.fill,template:i.template,font:L,location:c,textSize:sf.svgbase.measureText(M[F],i.font)},t.trigger("textRender",s),!s.cancel)if(this.fontBackground=s.color,this.isDataLabelShape(s),this.markerHeight="Bubble"===e.type?p.regions[0].height/2:this.markerHeight,null!==s.template)this.createDataLabelTemplate(b,e,i,p,s,F,f);else{if(l=sf.svgbase.measureText(s.text,i.font),r=this.calculateTextPosition(p,e,l,i,F),"PolarRadar"===t.chartAreaType)for(var D=0,E=t.chartAxisLayoutPanel.visibleAxisLabelRect;D<E.length;D++){var z=E[D];if(dt(new sf.svgbase.Rect(r.x,r.y,r.width,r.height),z)){T=!1;break}}var k=new sf.svgbase.Rect(r.x+P.x,r.y+P.y,r.width,r.height);if(i.enableRotation){if(y=ge(this.getRectanglePoints(r),u=r.x+r.width/2,g=r.y+r.height/2,h),!(m=this.isDataLabelOverlapWithChartBound(y,t,P))){this.chart.rotatedDataLabelCollections.push(y);for(var W=this.chart.rotatedDataLabelCollections.length-1,R=W;R>=0;R--)if(this.chart.rotatedDataLabelCollections[W]&&this.chart.rotatedDataLabelCollections[R-1]&&fe(this.chart.rotatedDataLabelCollections[W],this.chart.rotatedDataLabelCollections[R-1])){m=!0,this.chart.rotatedDataLabelCollections[W]=null;break}}}else m=ht(r,t.dataLabelCollections,P);if((!m||"None"===i.labelIntersectAction)&&T)t.dataLabelCollections.push(k),this.isShape&&(A=t.renderer.drawRectangle(new zt(this.commonId+p.index+"_TextShape_"+F,s.color,s.border,i.opacity,r,i.rx,i.ry),new Int32Array([P.x,P.y])),e.shapeElement&&e.shapeElement.appendChild(A)),n=gt(ft("transparent"===this.fontBackground?this.chart.theme.indexOf("Dark")>-1||"HighContrast"===this.chart.theme?"black":"white":this.fontBackground)),o=Math.round((299*n.r+587*n.g+114*n.b)/1e3),I=r.x+this.margin.left+l.width/2+c.x,S=r.y+this.margin.top+3*l.height/4+c.y,c={x:0,y:0},0!==h&&i.enableRotation?(C=u,O=g,d=h>360?h-360:h<-360?h+360:h):(d=0,C=r.x,O=r.y),It(t.renderer,new sf.svgbase.TextOption(this.commonId+p.index+"_Text_"+F,I,S,"middle",s.text,"rotate("+d+","+C+","+O+")","auto",d),s.font,s.font.color||(o>=128||"Hilo"===e.type?"black":"white"),e.textElement,!1,f,!0,!1,e.chart.duration,e.clipRect,0,null,t.enableCanvas)}}}b.childElementCount&&(t.enableCanvas?Ge(t.element.id+"_Secondary_Element").appendChild(b):nt(t.enableCanvas,Ge(t.element.id+"_Secondary_Element"),b,t.redraw,!1,"x","y",null,"",!1,!1,null,t.duration))},e.prototype.getRectanglePoints=function(e){return[new jt(e.x,e.y),new jt(e.x+e.width,e.y),new jt(e.x+e.width,e.y+e.height),new jt(e.x,e.y+e.height)]},e.prototype.isDataLabelOverlapWithChartBound=function(e,t,i){for(var r=0;r<e.length;r++)if(!Ce(e[r].x+i.x,e[r].y+i.y,t.initialClipRect))return!0;return!1},e.prototype.createDataLabelTemplate=function(e,t,i,r,n,o,s){this.margin={left:0,right:0,bottom:0,top:0};var a=t.clipRect,l=Je(sf.base.createElement("div",{id:this.chart.element.id+"_Series_"+(void 0===t.index?t.category:t.index)+"_DataLabel_"+r.index+(o?"_"+o:""),styles:"position: absolute;background-color:"+n.color+";"+$e(i.font)+";border:"+n.border.width+"px solid "+n.border.color+";"}),r.index,n.template,this.chart,r,t,this.chart.element.id+"_DataLabel",o);this.calculateTemplateLabelSize(e,l,r,t,i,o,a,s)},e.prototype.calculateTemplateLabelSize=function(e,t,i,r,n,o,s,a,l){var h=et(t,a,l),d=this.calculateTextPosition(i,r,{width:h.width,height:h.height},n,o),c=!1;l&&(c=0===h.width||0===h.height),t.style.left=("PolarRadar"===this.chart.chartAreaType?0:r.clipRect.x)+d.x-0+"px",t.style.top=("PolarRadar"===this.chart.chartAreaType?0:r.clipRect.y)+d.y+0+"px";var p=gt(ft("transparent"===this.fontBackground?this.chart.theme.indexOf("Dark")>-1?"black":"white":this.fontBackground)),u=r.chart.requireInvertedAxis?r.xAxis:r.yAxis,g=r.chart.requireInvertedAxis?r.yAxis:r.xAxis;t.style.color=n.font.color||(Math.round((299*p.r+587*p.g+114*p.b)/1e3)>=128?"black":"white"),t.childElementCount&&!c&&(!ht(d,this.chart.dataLabelCollections,s)||"None"===n.labelIntersectAction)&&("XY"!==r.seriesType||void 0===i.yValue||se(i.yValue,r.yAxis.visibleRange)||r.type.indexOf("Stacking")>-1||r.type.indexOf("100")>-1&&se(r.stackedValues.endValues[i.index],r.yAxis.visibleRange))&&se(i.xValue,r.xAxis.visibleRange)&&parseFloat(t.style.top)>=u.rect.y&&parseFloat(t.style.left)>=g.rect.x&&parseFloat(t.style.top)<=u.rect.y+u.rect.height&&parseFloat(t.style.left)<=g.rect.x+g.rect.width&&(this.chart.dataLabelCollections.push(new sf.svgbase.Rect(d.x+s.x,d.y+s.y,d.width,d.height)),nt(this.chart.enableCanvas,e,t,a,!0,"left","top"),r.animation.enable&&this.chart.animateSeries&&!this.chart.enableCanvas?this.doDataLabelAnimation(r,t):this.chart.enableCanvas&&e.appendChild(t))},e.prototype.calculateTextPosition=function(e,t,i,r,n){var o,s=n>1&&"Candle"===t.type?e.regions[1]:e.regions[0];n>1&&"HiloOpenClose"===t.type&&(s=2===n?e.regions[1]:e.regions[2]),o=this.getLabelLocation(e,t,i,n);var a=t.clipRect;if(this.chart.requireInvertedAxis&&this.isRectSeries(t)&&"BoxAndWhisker"!==t.type){this.locationY=o.y;l=i.width+this.borderWidth+this.margin.left+this.margin.right-5;o.x="Auto"===r.position?o.x:this.calculateAlignment(l,o.x,r.alignment,e.yValue<0),o.x=this.calculateRectPosition(o.x,s,e.yValue<0!==this.yAxisInversed,r.position,t,i,n,e)}else{this.locationX=o.x;var l=i.height+2*this.borderWidth+this.markerHeight+this.margin.bottom+this.margin.top+5;o.x="Auto"===r.position?o.x:this.calculateAlignment(l,o.x,r.alignment,!!this.isRectSeries(t)&&e.yValue<0),o.y=this.isRectSeries(t)&&"BoxAndWhisker"!==t.type?this.calculateRectPosition(o.y,s,e.yValue<0!==this.yAxisInversed,r.position,t,i,n,e):this.calculatePathPosition(o.y,r.position,t,e,i,n),this.isRectSeries(t)&&"PolarRadar"===this.chart.chartAreaType&&(o=this.calculatePolarRectPosition(o,r.position,t,e,i,n,r.alignment,l))}var h,d=ct(o,i,this.margin);return!0===r.enableRotation&&0!==r.angle||d.y>a.y+a.height||d.x>a.x+a.width||d.x+d.width<0||d.y+d.height<0||(d.x=d.x<0?5:d.x,d.y=d.y<0&&"None"!==r.labelIntersectAction?5:d.y,d.x-=d.x+d.width>a.x+a.width?d.x+d.width-(a.x+a.width)+5:0,d.y-=d.y+d.height>a.y+a.height?d.y+d.height-(a.y+a.height)+5:0,this.fontBackground="transparent"===this.fontBackground?this.chartBackground:this.fontBackground),this.inverted&&t.isRectSeries&&d.x+d.width>s.x+s.width&&(h=!0),this.fontBackground=h?this.chartBackground:this.fontBackground,d},e.prototype.calculatePolarRectPosition=function(e,t,i,r,n,o,s,a){var l,h=this.chart.availableSize.width,d="Center"===s?0:"Far"===s?1:-1,c=r.regionData.startAngle-.5*Math.PI+(r.regionData.endAngle-r.regionData.startAngle)/2;return l=0===o?r.regionData.radius<r.regionData.innerRadius?r.regionData.innerRadius:r.regionData.radius:r.regionData.radius>r.regionData.innerRadius?r.regionData.innerRadius:r.regionData.radius,this.fontBackground="transparent"===this.fontBackground?this.chartBackground:this.fontBackground,i.drawType.indexOf("Stacking")>-1?t="Outer"===t?"Top":t:i.drawType.indexOf("Range")>-1&&(t="Outer"===t||"Top"===t?t:"Auto"),"Outer"===t?l=0===o?l+10+this.markerHeight:l-10-this.markerHeight:"Middle"===t?(l=l/2+5,"StackingColumn"===i.drawType&&(l=r.regionData.innerRadius+(r.regionData.radius-r.regionData.innerRadius)/2+5-n.height/2)):"Top"===t?l=0===o?l-10-this.markerHeight:l+10+this.markerHeight:"Bottom"===t?(l=10,l+="StackingColumn"===i.drawType?r.regionData.innerRadius+this.markerHeight:0):l=0===o?l>=i.chart.radius?l-5:"StackingColumn"===i.drawType?l-10:l+10:l>=i.chart.radius?l+5:l-10,l+=a*d,e.x=i.clipRect.width/2+i.clipRect.x+l*Math.cos(c),"StackingColumn"===i.drawType?e.x=e.x<h/2?e.x+n.width/2:e.x>h/2?e.x-n.width/2:e.x:"Column"===i.drawType&&(e.x=e.x<h/2?e.x-n.width/2:e.x>h/2?e.x+n.width/2:e.x),e.y=i.clipRect.height/2+i.clipRect.y+l*Math.sin(c),e},e.prototype.getLabelLocation=function(e,t,i,r){var n=new jt(0,0),o="Candle"===t.type&&r>1?e.regions[1]:e.regions[0];"HiloOpenClose"===t.type&&(o=2===r?e.regions[1]:e.regions[2]);var s=t.xAxis,a=t.yAxis,l=t.chart.requireInvertedAxis;if("BoxAndWhisker"===t.type){switch(this.markerHeight=0,r){case 0:n=it(e.xValue,e.median,s,a,l);break;case 1:n=it(e.xValue,e.maximum,s,a,l);break;case 2:n=it(e.xValue,e.minimum,s,a,l);break;case 3:n=it(e.xValue,e.upperQuartile,s,a,l);break;case 4:n=it(e.xValue,e.lowerQuartile,s,a,l);break;default:n=it(e.xValue,e.outliers[r-5],s,a,l),this.markerHeight=t.marker.height/2}l?n.y=e.regions[0].y+e.regions[0].height/2:n.x=e.regions[0].x+e.regions[0].width/2}else n=0===r||1===r?new jt(e.symbolLocations[0].x,e.symbolLocations[0].y):2!==r&&3!==r||"Candle"!==t.type?l?{x:o.x+o.width/2,y:o.y}:{x:o.x+o.width,y:o.y+o.height/2}:new jt(e.symbolLocations[1].x,e.symbolLocations[1].y);if(r>1&&"HiloOpenClose"===t.type)if(t.chart.requireInvertedAxis){var h=o.height;n.y=o.y+h/2+2*(2===r?1:-1)}else{var d=o.width;n.x=o.x+d/2+2*(2===r?1:-1)}return n},e.prototype.calculateRectPosition=function(e,t,i,r,n,o,s,a){if("PolarRadar"===n.chart.chartAreaType)return null;var l=this.margin,h=this.inverted?o.width:o.height,d=this.borderWidth+h/2+("Outer"!==r&&n.type.indexOf("Column")>-1&&Math.abs(t.height-o.height)<5?0:5);switch("StackingColumn100"===n.type||"StackingBar100"===n.type?r="Outer"===r?"Top":r:n.type.indexOf("Range")>-1?r="Outer"===r||"Top"===r?r:"Auto":"Waterfall"===n.type&&(r="Auto"===r?"Middle":r),r){case"Bottom":e=this.inverted?i?e+t.width-d-l.left:e-t.width+d+l.right:i?e-t.height+d+l.top:e+t.height-d-l.bottom;break;case"Middle":e=e=this.inverted?i?e+t.width/2:e-t.width/2:i?e-t.height/2:e+t.height/2;break;case"Auto":e=this.calculateRectActualPosition(e,t,i,n,o,s,a);break;default:d+=this.errorHeight,e=this.calculateTopAndOuterPosition(e,t,r,n,s,d,i)}var c=this.inverted?e<t.x||e>t.x+t.width:e<t.y||e>t.y+t.height;this.fontBackground=c?"transparent"===this.fontBackground?this.chartBackground:this.fontBackground:"transparent"===this.fontBackground?a.color||n.interior:this.fontBackground;var p=n.chart.series.length;if("Outer"===r&&n.type.indexOf("Stacking")>-1&&p-1>n.index)for(var u=void 0,g=void 0,f=n.index+1;f<p;f++)if(g=(u=n.chart.series[f]).points[a.index],u.type.indexOf("Stacking")>-1&&-1===u.type.indexOf("100")){this.fontBackground=g&&(g.yValue<0&&a.yValue<0||g.yValue>0&&a.yValue>0)?g?g.color:u.interior:this.fontBackground;break}return e},e.prototype.calculatePathPosition=function(e,t,i,r,n,o){switch(i.type.indexOf("Area")>-1&&"RangeArea"!==i.type&&"SplineRangeArea"!==i.type&&this.yAxisInversed&&"Auto"!==i.marker.dataLabel.position&&(t="Top"===t?"Bottom":"Bottom"===t?"Top":t),this.fontBackground="transparent"===this.fontBackground?this.chartBackground:this.fontBackground,t){case"Top":case"Outer":e=e-this.markerHeight-this.borderWidth-n.height/2-this.margin.bottom-5-this.errorHeight;break;case"Bottom":e=e+this.markerHeight+this.borderWidth+n.height/2+this.margin.top+5+this.errorHeight;break;case"Auto":e=this.calculatePathActualPosition(e,this.markerHeight,i,r,n,o)}return e},e.prototype.isDataLabelShape=function(e){this.isShape="transparent"!==e.color||e.border.width>0,this.borderWidth=e.border.width,this.isShape||(this.margin={left:0,right:0,bottom:0,top:0})},e.prototype.calculateRectActualPosition=function(e,t,i,r,n,o,s){for(var a,l,h=!0,d=0,c=this.chart.dataLabelCollections,p=-1!==r.type.indexOf("Range")||"Hilo"===r.type?2:4;h&&d<p;){var u=this.getPosition(d);r.type.indexOf("Stacking")>-1&&"Outer"===u&&(u="Top",d++),a=this.calculateRectPosition(e,t,i,u,r,n,o,s),h=this.inverted?(l=ct(new jt(a,this.locationY),n,this.margin)).x<0||ht(l,c,r.clipRect)||l.x+l.width>r.clipRect.width:(l=ct(new jt(this.locationX,a),n,this.margin)).y<0||ht(l,c,r.clipRect)||l.y>r.clipRect.height,d++}return a},e.prototype.calculateAlignment=function(e,t,i,r){switch(i){case"Far":t=this.inverted?r?t-e:t+e:r?t+e:t-e;break;case"Near":t=this.inverted?r?t+e:t-e:r?t-e:t+e;break;case"Center":t=t}return t},e.prototype.calculateTopAndOuterPosition=function(e,t,i,r,n,o,s){var a,l=this.margin;switch(r.type){case"RangeColumn":case"RangeArea":case"SplineRangeArea":case"Hilo":a=0===n&&!this.yAxisInversed||1===n&&this.yAxisInversed,e=this.updateLabelLocation(i,e,o,l,t,a);break;case"Candle":a=(0===n||2===n)&&!this.yAxisInversed||(1===n||3===n)&&this.yAxisInversed,e=this.updateLabelLocation(i,e,o,l,t,a,n>1);break;case"HiloOpenClose":n<=1?(a=0===n&&!this.yAxisInversed||1===n&&this.yAxisInversed,e=this.updateLabelLocation(i,e,o,l,t,a)):e=this.yAxisInversed?this.inverted?e-o-l.right:e+o+l.top:this.inverted?e+o+l.left:e-o-l.bottom;break;default:e=s&&"Top"===i||!s&&"Outer"===i?this.inverted?e+o+l.left+this.markerHeight:e-o-l.bottom-this.markerHeight:this.inverted?e-o-l.right-this.markerHeight:e+o+l.top+this.markerHeight}return e},e.prototype.updateLabelLocation=function(e,t,i,r,n,o,s){return void 0===s&&(s=!1),t=this.inverted?o?"Outer"!==e||s?t-i-r.right-this.markerHeight:t+i+r.left+this.markerHeight:"Outer"!==e||s?t-n.width+i+r.left+this.markerHeight:t-n.width-i-r.right-this.markerHeight:o?"Outer"!==e||s?t+i+r.top+this.markerHeight:t-i-r.bottom-this.markerHeight:"Outer"!==e||s?t+n.height-i-r.bottom-this.markerHeight:t+n.height+i+r.top+this.markerHeight},e.prototype.calculatePathActualPosition=function(e,t,i,r,n,o){var s,a,l,h,d,c=i.points,p=r.index,u=c[p].yValue,g=c.length-1>p?c[p+1]:null,f=p>0?c[p-1]:null,m=!0,y=this.chart.dataLabelCollections;if("Bubble"===i.type)s="Top";else if(i.type.indexOf("Step")>-1)s="Top",p&&(s=f&&f.visible&&u>f.yValue===this.yAxisInversed&&u!==f.yValue?"Bottom":"Top");else if("BoxAndWhisker"===i.type)1===o||3===o||o>4?s=i.yAxis.isAxisInverse?"Bottom":"Top":2===o||4===o?s=i.yAxis.isAxisInverse?"Top":"Bottom":(m=!1,s="Middle",a=this.calculatePathPosition(e,s,i,r,n,o));else if(0===p)s=!g||!g.visible||u>g.yValue||u<g.yValue&&this.yAxisInversed?"Top":"Bottom";else if(p===c.length-1)s=!f||!f.visible||u>f.yValue||u<f.yValue&&this.yAxisInversed?"Top":"Bottom";else if(g.visible||f&&f.visible)if(g.visible&&f){var v=(g.yValue-f.yValue)/2,b=v*p+(g.yValue-v*(p+1));s=this.yAxisInversed?b<u?"Bottom":"Top":b<u?"Top":"Bottom"}else s=g.yValue>u||f&&f.yValue>u?"Bottom":"Top";else s="Top";for(h="Bottom"===s,d=["Outer","Top","Bottom","Middle","Auto"].indexOf(s);m&&d<4;)a=this.calculatePathPosition(e,this.getPosition(d),i,r,n,o),m=(l=ct(new jt(this.locationX,a),n,this.margin)).y<0||ht(l,y,i.clipRect)||l.y+l.height>i.clipRect.height,d=h?d-1:d+1,h=!1;return a},e.prototype.doDataLabelAnimation=function(e,t){for(var i,r,n=e.shapeElement.childNodes,o=e.textElement.childNodes,s=e.animation.delay+e.animation.duration,a=e.chart.animated?e.chart.duration:200,l=t?1:o.length,h=0;h<l;h++)r=o[h],t?(t.style.visibility="hidden",_e(t,s,a,"ZoomIn")):(i=new jt(+r.getAttribute("x")+ +r.getAttribute("width")/2,+r.getAttribute("y")+ +r.getAttribute("height")/2),ze(r,s,a,e,null,i,!0),n[h]&&(r=n[h],i=new jt(+r.getAttribute("x")+ +r.getAttribute("width")/2,+r.getAttribute("y")+ +r.getAttribute("height")/2),ze(r,s,a,e,null,i,!0)))},e.prototype.getPosition=function(e){return["Outer","Top","Bottom","Middle","Auto"][e]},e.prototype.getModuleName=function(){return"DataLabel"},e.prototype.destroy=function(){},e}(),Fo=function(){function e(e){this.chart=e}return e.prototype.render=function(e){if("PolarRadar"===this.chart.chartAreaType)return null;this.createElement(e,this.chart),this.renderErrorBar(e)},e.prototype.renderErrorBar=function(e){for(var t,i,r=e.index,n=e.errorBar,o=e.errorBar.errorBarCap,s=["",""],a=e.chart.redraw,l=0,h=e.points;l<h.length;l++){var d=h[l];if(d.visible&&d.symbolLocations[0]){var c=0,p=0;switch(n.mode){case"Vertical":p=n.verticalError;break;case"Horizontal":c=n.horizontalError;break;case"Both":c=n.horizontalError,p=n.verticalError}s=this["calculate"+n.type+"Value"](d,e,this.chart.requireInvertedAxis,c,p),t=this.chart.element.id+"_Series__ErrorBarGroup_"+r+"_Point_"+d.index,i=this.chart.element.id+"_Series__ErrorBarCap_"+r+"_Point_"+d.index;var u=new sf.svgbase.PathOption(t,"",n.width,n.color||this.chart.themeStyle.errorBar,null,"",s[0]),g=Ge(u.id),f=g?g.getAttribute("d"):null;e.errorBarElement.appendChild(this.chart.renderer.drawPath(u)),We(g,s[0],a,f);var m=new sf.svgbase.PathOption(i,"",o.width,o.color||this.chart.themeStyle.errorBar,null,"",s[1]);f=(g=Ge(m.id))?g.getAttribute("d"):null,nt(this.chart.enableCanvas,e.errorBarElement,this.chart.renderer.drawPath(m),a),We(g,s[1],a,f)}}},e.prototype.findLocation=function(e,t,i,r,n){var o=t.errorBar,s=o.direction,a=[],l=t.type.indexOf("Stacking")>-1?t.stackedValues.endValues[e.index]:"HighLow"===t.seriesType||"HighLowOpenClose"===t.seriesType?t.points[e.index].high:e.yValue,h=it(e.xValue+("Plus"===s||"Both"===s?"Custom"!==o.type||"Horizontal"!==o.mode&&"Both"!==o.mode?r:r=o.horizontalPositiveError:0),l+("Plus"===s||"Both"===s?"Custom"!==o.type||"Vertical"!==o.mode&&"Both"!==o.mode?n:n=o.verticalPositiveError:0),t.xAxis,t.yAxis,i);if(a.push(h),t.isRectSeries){var d=e.symbolLocations[0];a.push(d)}else{d=it(e.xValue,e.yValue,t.xAxis,t.yAxis,i);a.push(d)}var c=it(e.xValue-("Minus"===s||"Both"===s?"Custom"!==o.type||"Horizontal"!==o.mode&&"Both"!==o.mode?r:r=o.horizontalNegativeError:0),l-("Minus"===s||"Both"===s?"Custom"!==o.type||"Vertical"!==o.mode&&"Both"!==o.mode?n:n=o.verticalNegativeError:0),t.xAxis,t.yAxis,i);return a.push(c),e.error="Vertical"===o.mode?o.verticalError:o.horizontalError,this.negativeHeight="Vertical"===o.mode||"Both"===o.mode?i?a[1].x-a[2].x:a[2].y-a[1].y:0,this.positiveHeight="Vertical"===o.mode||"Both"===o.mode?i?a[0].x-a[1].x:a[1].y-a[0].y:0,this.getErrorDirection(a[0],a[1],a[2],t,i)},e.prototype.calculateFixedValue=function(e,t,i,r,n,o,s){t.errorBar;return this.findLocation(e,t,i,r,n)},e.prototype.calculatePercentageValue=function(e,t,i,r,n,o,s){return r=r/100*e.xValue,n=n/100*e.yValue,this.findLocation(e,t,i,r,n)},e.prototype.calculateStandardDeviationValue=function(e,t,i,r,n,o,s){var a=this.meanCalculation(t,t.errorBar.mode);return r*=a.horizontalSquareRoot+a.horizontalMean,n*=a.verticalSquareRoot+a.verticalMean,this.findLocation(e,t,i,r,n)},e.prototype.calculateStandardErrorValue=function(e,t,i,r,n,o,s){var a=t.points.length,l=this.meanCalculation(t,t.errorBar.mode);return r=r*l.horizontalSquareRoot/Math.sqrt(a),n=n*l.verticalSquareRoot/Math.sqrt(a),this.findLocation(e,t,i,r,n)},e.prototype.calculateCustomValue=function(e,t,i,r,n,o,s){t.errorBar;return this.findLocation(e,t,i,r,n)},e.prototype.getHorizontalDirection=function(e,t,i,r,n,o){var s="",a="";return s+="M "+e.x+" "+t.y+" L "+i.x+" "+t.y,a+="Plus"===r||"Both"===r?"M "+e.x+" "+(t.y-o)+" L "+e.x+" "+(t.y+o):"",[s,a+="Minus"===r||"Both"===r?"M "+i.x+" "+(t.y-o)+" L "+i.x+" "+(t.y+o):" "]},e.prototype.getVerticalDirection=function(e,t,i,r,n,o){var s="",a="";return s+="M "+t.x+" "+e.y+" L "+t.x+" "+i.y,a+="Plus"===r||"Both"===r?"M "+(t.x-o)+" "+e.y+" L "+(t.x+o)+" "+e.y:"",[s,a+="Minus"===r||"Both"===r?"M "+(t.x-o)+" "+i.y+" L "+(t.x+o)+" "+i.y:""]},e.prototype.getBothDirection=function(e,t,i,r,n,o){var s=this.getHorizontalDirection(e,t,i,r,n,o),a=this.getVerticalDirection(e,t,i,r,n,o);return[s[0].concat(a[0]),s[1].concat(a[1])]},e.prototype.getErrorDirection=function(e,t,i,r,n){var o,s=r.errorBar.direction,a=r.errorBar.mode,l=r.errorBar.errorBarCap.length,h=a;switch(a){case"Both":h=a;break;case"Horizontal":h=n?"Vertical":a;break;case"Vertical":h=n?"Horizontal":a}switch(h){case"Horizontal":o=this.getHorizontalDirection(e,t,i,s,h,l);break;case"Vertical":o=this.getVerticalDirection(e,t,i,s,h,l);break;case"Both":o=this.getBothDirection(e,t,i,s,h,l)}return[o[0],o[1]]},e.prototype.meanCalculation=function(e,t){var i=0,r=0,n=0,o=0,s=e.points.length;switch(t){case"Vertical":n=(r=he(e.yData))/s;break;case"Horizontal":o=(i=he(e.xData))/s;break;case"Both":n=(r=he(e.yData))/s,o=(i=he(e.xData))/s}for(var a=0,l=e.points;a<l.length;a++){var h=l[a];"Vertical"===t?r+=Math.pow(h.yValue-n,2):("Horizontal"===t||(r+=Math.pow(h.yValue-n,2)),i+=Math.pow(h.xValue-o,2))}var d=r/(s-1),c=Math.sqrt(r/(s-1)),p=i/(s-1),u=Math.sqrt(i/(s-1));return new xe(d,c,p,u,n,o)},e.prototype.createElement=function(e,t){var i="Cartesian"===t.chartAreaType?"translate("+e.clipRect.x+","+e.clipRect.y+")":"",r=e.marker.height/2,n=e.marker.width/2;if("Cartesian"===t.chartAreaType){var o=new zt(t.element.id+"_ChartErrorBarClipRect_"+e.index,"transparent",{width:1,color:"Gray"},1,{x:-n,y:-r,width:e.clipRect.width+2*n,height:e.clipRect.height+2*r});e.errorBarElement=t.renderer.createGroup({id:t.element.id+"ErrorBarGroup"+e.index,transform:i,"clip-path":"url(#"+t.element.id+"_ChartErrorBarClipRect_"+e.index+")"}),e.errorBarElement.appendChild(Re(t.redraw,o,t.renderer))}},e.prototype.doErrorBarAnimation=function(e){var t=e.errorBarElement.childNodes;if(!t)return null;for(var i=e.animation.delay+e.animation.duration,r=1;r<t.length;){for(var n=0;n<e.points.length;n++)e.points[n].symbolLocations[0]&&(t[r].style.visibility="hidden",_e(t[r],i,350,e.chart.requireInvertedAxis?"SlideLeftIn":"SlideBottomIn",!1));r++}},e.prototype.getModuleName=function(){return"ErrorBar"},e.prototype.destroy=function(){},e}(),Do=(Xi=function(e,t){return(Xi=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}Xi(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),Eo=function(e){function t(t){var i=e.call(this,t)||this;return i.library=i,i.addEventListener(),i}return Do(t,e),t.prototype.addEventListener=function(){this.chart.isDestroyed||(this.chart.on(sf.base.Browser.touchMoveEvent,this.mouseMove,this),this.chart.on("click",this.click,this),this.chart.on(sf.base.Browser.touchEndEvent,this.mouseEnd,this))},t.prototype.removeEventListener=function(){this.chart.isDestroyed||(this.chart.off(sf.base.Browser.touchMoveEvent,this.mouseMove),this.chart.off("click",this.click),this.chart.off(sf.base.Browser.touchEndEvent,this.mouseEnd))},t.prototype.mouseMove=function(e){if(this.chart.legendSettings.visible&&!this.chart.isTouch&&(this.move(e),this.chart.highlightModule&&("None"!==this.chart.highlightMode||this.chart.legendSettings.enableHighlight)))for(var t=[this.legendID+"_text_",this.legendID+"_shape_marker_",this.legendID+"_shape_",this.legendID+"_g_"],i=e.target.id,r=void 0,n=0,o=t;n<o.length;n++){var s=o[n];if(i.indexOf(s)>-1){r=parseInt(i.split(s)[1],10),this.chart.highlightModule.legendSelection(this.chart,r,e.target,e.type);break}}},t.prototype.mouseEnd=function(e){this.chart.legendSettings.visible&&this.chart.isTouch&&this.move(e)},t.prototype.getLegendOptions=function(e,t){var i,r,n;this.legendCollections=[];var o=[];this.isRtlEnable=t.enableRtl,this.isReverse=!this.isRtlEnable&&t.legendSettings.reverse,e.length>1&&(this.legend.mode="Series");for(var s=0,a=e;s<a.length;s++){var l=a[s];if("Series"===this.legend.mode)"Indicator"!==l.category&&(i="PolarRadar"===t.chartAreaType?l.drawType:l.type,n=!l.marker.visible&&i.indexOf("Line")>-1&&-1===i.indexOf("Area")?l.dashArray:"",r=l.pointColorMapping&&l.points.length>0&&l.points[0].interior?l.points[0].interior:l.interior,this.legendCollections.push(new Nr(l.name,r,l.legendShape,"TrendLine"===l.category?this.chart.series[l.sourceIndex].trendlines[l.index].visible:l.visible,i,l.legendImageUrl,l.marker.shape,l.marker.visible,null,null,n)));else if("Point"===this.legend.mode)for(var h=function(e){i="PolarRadar"===t.chartAreaType?l.drawType:l.type,r=e.interior?e.interior:l.interior,0===d.legendCollections.filter((function(t){return t.text===e.x.toString()})).length&&d.legendCollections.push(new Nr(e.x.toString(),r,l.legendShape,"TrendLine"===l.category?d.chart.series[l.sourceIndex].trendlines[l.index].visible:e.visible,i,"",l.marker.shape,l.marker.visible))},d=this,c=0,p=l.points;c<p.length;c++){h(f=p[c])}else if("Range"===this.legend.mode)for(var u=0,g=l.points;u<g.length;u++){var f=g[u];i="PolarRadar"===t.chartAreaType?l.drawType:l.type,r=f.interior?f.interior:l.interior;var m="Others";if(o.indexOf(r)<0&&(o.push(r),t.rangeColorSettings.length>=1&&1===t.rangeColorSettings[0].colors.length)){for(var y=0,v=t.rangeColorSettings;y<v.length;y++){var b=v[y];b.colors[0]===r&&(m=b.label)}this.legendCollections.push(new Nr(m,r,l.legendShape,"TrendLine"===l.category?this.chart.series[l.sourceIndex].trendlines[l.index].visible:f.visible,i,"",l.marker.shape,l.marker.visible))}}else if(0===this.legendCollections.length&&t.rangeColorSettings.length>0){var w=t.rangeColorSettings[0].start.toString(),x=t.rangeColorSettings[t.rangeColorSettings.length-1].end.toString();this.legendCollections.push(new Nr(w,l.interior,"Rectangle",!0,i,"",l.marker.shape,l.marker.visible)),this.legendCollections.push(new Nr(x,l.interior,"Rectangle",!0,i,"",l.marker.shape,l.marker.visible))}}this.isReverse&&"Gradient"!==t.legendSettings.mode&&this.legendCollections.reverse()},t.prototype.getLegendBounds=function(e,t,i){this.calculateLegendTitle(i,t),this.isTitle=!!i.title,this.chartRowCount=1,this.rowHeights=[],this.columnHeights=[],this.pageHeights=[];var r,n=i.padding,o=i.titlePosition,s=0,a=0,l=this.arrowWidth,h=this.arrowHeight,d=this.isVertical&&!i.enablePages?h:0,c=this.isTitle&&"Top"===o?this.legendTitleSize.height+this.fivePixel:0;c=this.isTitle&&this.isVertical&&"Top"!==o?this.legendTitleSize.height+this.fivePixel:c,this.isVertical?a=i.width?0:e.width/100*5:s=i.height?0:e.height/100*5,t.height+=s,t.width+=a;var p,u=i.shapeWidth,g=i.shapePadding,f=0,m=0,y=0,v=0,b=0,w=0,x=0,M=!1;this.maxItemHeight=Math.max(sf.svgbase.measureText("MeasureText",i.textStyle).height,i.shapeHeight);for(var N=0;N<this.legendCollections.length;N++)if(r=this.legendCollections[N],O.test(r.text)&&(r.text=Lt(r.text,O)),T.test(r.text)&&(r.text=Lt(r.text,T)),p={fill:r.fill,text:r.text,shape:r.shape,markerShape:r.markerShape,name:"legendRender",cancel:!1},this.chart.trigger("legendRender",p),r.render=!p.cancel,r.text=p.text,r.fill=p.fill,r.shape=p.shape,r.markerShape=p.markerShape,r.textSize=sf.svgbase.measureText(r.text,i.textStyle),u=r.text?i.shapeWidth:0,g=r.text?i.shapePadding:0,r.render&&r.text){M=!0,m+=y=u+g+(i.maximumLabelWidth?i.maximumLabelWidth:r.textSize.width)+(this.isVertical||0===N?n:this.itemPadding),i.enablePages||this.isVertical||(x=this.isTitle&&"Top"!==o?this.legendTitleSize.width+this.fivePixel:0,x+=l),this.getLegendHeight(r,i,t,m,this.maxItemHeight,n),(t.width<n+m+x||this.isVertical)&&(f=Math.max(f,m+n+x-(this.isVertical?0:y)),0===w&&y!==m&&(w=1),m=this.isVertical?0:y,w++,b=0,v=d);var I=w>0?w-1:0;this.rowHeights[I]=Math.max(this.rowHeights[I]?this.rowHeights[I]:0,r.textSize.height),this.columnHeights[b]=(this.columnHeights[b]?this.columnHeights[b]:0)+r.textSize.height+(this.isVertical?0===N?n:this.itemPadding:n),b++}v=Math.max.apply(null,this.columnHeights)+n+c,v=Math.max(v,this.maxItemHeight+n+n+c),this.isPaging=t.height<v,this.isPaging&&!i.enablePages&&(v=this.isVertical?v:this.maxItemHeight+n+n+("Top"===o?c:0)),this.totalPages=w,this.isPaging||this.isVertical||(m+=this.isTitle&&"Top"!==o?this.fivePixel+this.legendTitleSize.width+this.fivePixel:0),M?this.setBounds(Math.max(m+n,f),v,i,t):this.setBounds(0,0,i,t)},t.prototype.getLegendHeight=function(e,t,i,r,n,o){var s=e.textSize.width,a=t.shapePadding+2*o+t.shapeWidth;switch(t.textWrap){case"Wrap":case"AnyWhere":s>t.maximumLabelWidth||s+r>i.width?e.textCollection=Pt(e.text,t.maximumLabelWidth?Math.min(t.maximumLabelWidth,i.width-a):i.width-a,t.textStyle):e.textCollection.push(e.text),e.textSize.height=n*e.textCollection.length}},t.prototype.getRenderPoint=function(e,t,i,r,n,o,s,a){var l=this.legend.padding,h=i+(this.legend.maximumLabelWidth?this.legend.maximumLabelWidth:r.textSize.width),d=r.location.x+(this.isRtlEnable?-h:h);this.isWithinBounds(d,(this.legend.maximumLabelWidth?this.legend.maximumLabelWidth:e.textSize.width)+i-this.itemPadding,n)||this.isVertical?(e.location.x=t.x,o!==s&&this.chartRowCount++,e.location.y=o===s?r.location.y:r.location.y+(this.isVertical?r.textSize.height:this.rowHeights[this.chartRowCount-2])+(this.isVertical?this.itemPadding:l)):(e.location.x=o===s?r.location.x:d,e.location.y=r.location.y);var c=this.isRtlEnable?e.location.x-i+this.itemPadding+this.legend.shapeWidth/2-this.legendBounds.x:this.legendBounds.x+this.legendBounds.width-(e.location.x+i-this.itemPadding-this.legend.shapeWidth/2);c=this.legend.maximumLabelWidth?Math.min(this.legend.maximumLabelWidth,c):c,"Ellipsis"===this.legend.textOverflow&&"Normal"===this.legend.textWrap&&(e.text=bt(+c.toFixed(4),e.text,this.legend.textStyle))},t.prototype.isWithinBounds=function(e,t,i){return this.isRtlEnable?e-t<i.x-this.legend.shapeWidth/2:e+t>i.x+i.width+this.legend.shapeWidth/2},t.prototype.LegendClick=function(e,t){var i=this.chart,r="Series"===i.legendSettings.mode?e:0,n=this.isReverse?this.legendCollections.length-1-e:e,o=i.visibleSeries[r],s=this.legendCollections[n];if("Series"===i.legendSettings.mode){var a={legendText:s.text,legendShape:s.shape,chart:i.isBlazor?{}:i,series:o,points:o.points,name:"legendClick",cancel:!1};this.chart.trigger("legendClick",a),o.legendShape=a.legendShape,a.cancel||(null!==o.fill&&(i.visibleSeries[e].interior=o.fill),i.legendSettings.toggleVisibility?("TrendLine"===o.category?i.series[o.sourceIndex].trendlines[o.index].visible?i.series[o.sourceIndex].trendlines[o.index].visible=!1:i.series[o.sourceIndex].trendlines[o.index].visible=!0:(o.chart.isProtectedOnChange=!0,this.changeSeriesVisiblity(o,o.visible)),s.visible="TrendLine"===o.category?i.series[o.sourceIndex].trendlines[o.index].visible:o.visible,this.refreshLegendToggle(i,o)):i.highlightModule?i.highlightModule.legendSelection(i,e,t.target,t.type):i.selectionModule&&i.selectionModule.legendSelection(i,e,t.target,t.type),o.chart.isProtectedOnChange=!1)}else if("Point"===i.legendSettings.mode){var l=o.points[e];a={legendText:s.text,legendShape:s.shape,chart:i.isBlazor?{}:i,series:o,points:[l],name:"legendClick",cancel:!1};if(this.chart.trigger("legendClick",a),i.legendSettings.toggleVisibility&&!a.cancel)l.visible=!l.visible,(d=this.legendCollections[e]).visible=l.visible,this.refreshLegendToggle(i,o)}else if("Range"===i.legendSettings.mode){for(var h=[],d=this.legendCollections[e],c=0,p=o.points;c<p.length;c++){l=p[c];d.fill===(l.interior||o.interior)&&h.push(l)}a={legendText:s.text,legendShape:s.shape,chart:i.isBlazor?{}:i,series:o,points:h,name:"legendClick",cancel:!1};if(this.chart.trigger("legendClick",a),i.legendSettings.toggleVisibility&&!a.cancel){d.visible=!d.visible;for(var u=0,g=h;u<g.length;u++){(l=g[u]).visible=!l.visible}this.refreshLegendToggle(i,o)}}},t.prototype.refreshLegendToggle=function(e,t){var i=[];if(e.selectionModule&&(i=sf.base.extend([],e.selectionModule.selectedDataIndexes,null,!0)),e.svgObject.childNodes.length>0&&!e.enableAnimation&&!e.enableCanvas){for(;e.svgObject.lastChild;)e.svgObject.removeChild(e.svgObject.lastChild);sf.base.remove(e.svgObject)}e.animateSeries=!1,e.redraw=e.enableAnimation,e.rotatedDataLabelCollections=[],ie(sf.svgbase.getElement(e.element.id+"_Secondary_Element").querySelectorAll(".ejSVGTooltip")[0]),Ft(e),this.redrawSeriesElements(t,e),e.removeSvg(),e.refreshAxis(),t.refreshAxisLabel(),this.refreshSeries(e.visibleSeries);for(var r=0,n=e.visibleSeries;r<n.length;r++){var o=n[r];sf.base.isNullOrUndefined(o)||e.markerRender.removeHighlightedMarker(o,null,!0)}e.refreshBound(),e.trigger("loaded",{chart:e}),i.length>0&&(e.selectionModule.selectedDataIndexes=i,e.selectionModule.redrawSelection(e,e.selectionMode)),(e.highlightModule&&"None"!==e.highlightMode||e.legendSettings.enableHighlight)&&e.highlightModule.redrawSelection(e,e.highlightMode),e.redraw=!1},t.prototype.changeSeriesVisiblity=function(e,t){e.visible=!t,this.isSecondaryAxis(e.xAxis)&&(e.xAxis.internalVisibility=e.xAxis.series.some((function(e){return e.visible}))),this.isSecondaryAxis(e.yAxis)&&(e.yAxis.internalVisibility=e.yAxis.series.some((function(e){return e.visible})))},t.prototype.isSecondaryAxis=function(e){return this.chart.axes.indexOf(e)>-1},t.prototype.redrawSeriesElements=function(e,t){if(!t.redraw)return null;ie(t.element.id+"_Series_"+(void 0===e.index?e.category:e.index)+"_DataLabelCollections")},t.prototype.refreshSeries=function(e){for(var t=0,i=e;t<i.length;t++){var r=i[t];if(r.type.indexOf("Spline")>-1){var n=r.type.indexOf("Area")>-1||r.drawType.indexOf("Area")>-1,o=r.type.indexOf("Range")>-1;this.chart["spline"+(n?o?"RangeArea":"Area":"")+"SeriesModule"].findSplinePoint(r)}r.position=void 0}},t.prototype.click=function(e){var t=this;if(this.chart.legendSettings.visible){for(var i,r,n=this.chart.mouseX,o=this.chart.mouseY,s=e.target.id.indexOf("_chart_legend_g_")>-1?e.target.firstChild.id:e.target.id,a=0,l=[this.legendID+"_text_",this.legendID+"_shape_marker_",this.legendID+"_shape_"];a<l.length;a++){var h=l[a];if(s.indexOf(h)>-1){r=parseInt(s.split(h)[1],10),this.LegendClick(r,e);break}}s.indexOf(this.legendID+"_pageup")>-1?this.changePage(e,!0):s.indexOf(this.legendID+"_pagedown")>-1&&this.changePage(e,!1),this.chart.enableCanvas&&this.pagingRegions.length&&this.checkWithinBounds(n,o),(i=this.legendRegions.filter((function(e){return Ce(n,o+(t.isPaging?(t.currentPageNumber-1)*t.translatePage(t.chart.enableCanvas,null,1,2):0),e.rect)}))).length&&this.chart.enableCanvas&&this.LegendClick(i[0].index,e)}},t.prototype.checkWithinBounds=function(e,t){var i=this.chart.renderer,r=this.legendBounds,n=this.chart.legendSettings.border.width,o=new sf.svgbase.Rect(r.x,r.y,r.width,r.height);return o.x=o.x-n/2,o.y=o.y-n/2,o.width=o.width+n,o.height=o.height+n,Ce(e,t,this.pagingRegions[0])?(this.isRtlEnable?this.canvasPageUp(i,o,r):this.canvasPageDown(i,o,r),null):Ce(e,t,this.pagingRegions[1])?(this.isRtlEnable?this.canvasPageDown(i,o,r):this.canvasPageUp(i,o,r),null):void 0},t.prototype.canvasPageDown=function(e,t,i){--this.currentPageNumber>0?(this.legendRegions=[],e.clearRect(t),e.canvasClip(new zt("legendClipPath","transparent",{width:0,color:""},null,t)),this.renderLegend(this.chart,this.legend,i),e.canvasRestore()):++this.currentPageNumber},t.prototype.canvasPageUp=function(e,t,i){++this.currentPageNumber>0&&this.currentPageNumber<=this.totalNoOfPages?(this.legendRegions=[],e.clearRect(t),e.canvasClip(new zt("legendClipPath","transpaent",{width:0,color:""},null,t)),this.renderLegend(this.chart,this.legend,i),e.canvasRestore()):--this.currentPageNumber},t.prototype.getModuleName=function(){return"Legend"},t.prototype.destroy=function(){this.removeEventListener()},t}(Mr),zo=function(){function e(e){this.control=e}return e.prototype.render=function(e,t){return this.isChart="chart"===this.control.getModuleName(),this.annotation=e,Je(sf.base.createElement("div",{id:this.control.element.id+"_Annotation_"+t,styles:"position: absolute; z-index: 1"}),t,e.content,this.control)},e.prototype.setAnnotationPixelValue=function(e){var t="Chart"===this.annotation.region?new sf.svgbase.Rect(0,0,this.control.availableSize.width,this.control.availableSize.height):this.isChart?this.control.chartAxisLayoutPanel.seriesClipRect:this.control.series[0].accumulationBound;return e.x=("string"!=typeof this.annotation.x?"number"==typeof this.annotation.x?this.annotation.x:0:xt(this.annotation.x,t.width))+t.x,e.y=("number"==typeof this.annotation.y?this.annotation.y:xt(this.annotation.y,t.height))+t.y,!0},e.prototype.setAnnotationPointValue=function(e){var t=new jt(0,0);if(this.isChart){for(var i=this.control,n=this.annotation,o=n.xAxisName,s=n.yAxisName,a=i.requireInvertedAxis,l=this.control.stockChart,h=void 0,d=void 0,c=void 0,p=0,u=i.axisCollections;p<u.length;p++){var g=u[p];if(o===g.name||null==o&&"primaryXAxis"===g.name)if((h=g).valueType.indexOf("Category")>-1){var f="DateTimeCategory"===h.valueType?n.x.getTime().toString():n.x;if(h.labels.indexOf(f)<0)return!1;c=h.labels.indexOf(f)}else if("DateTime"===h.valueType){var m={skeleton:"full",type:"dateTime"};c="object"===r(this.annotation.x)||"object"===r(new Date(this.annotation.x))?Date.parse(i.intl.getDateParser(m)(i.intl.getDateFormat(m)(new Date(sf.data.DataUtil.parse.parseJson({val:n.x}).val)))):0}else c=+n.x;else(s===g.name||null==s&&"primaryYAxis"===g.name)&&(d=g)}return!!(h&&d&&se("Logarithmic"===h.valueType?re(c,h.logBase):c,h.visibleRange)&&se("Logarithmic"===d.valueType?re(+n.y,d.logBase):+n.y,d.visibleRange))&&(t=it(c,+n.y,h,d,a),e.x=t.x+(a?d.rect.x:h.rect.x),e.y=t.y+(a?h.rect.y:d.rect.y)+(l&&l.enablePeriodSelector?l.toolbarHeight+l.titleSize.height:0),!0)}return this.setAccumulationPointValue(e)},e.prototype.processAnnotation=function(e,t,i){var r=this.control,n=new jt(0,0),o=this.render(e,t),s=function(){o.style.transform="translate(-50%, -50%)"};s.bind(n,this),this["setAnnotation"+e.coordinateUnits+"Value"](n)?this.setElementStyle(n,o,i):this.control.redraw&&ie(o.id),sf.base.updateBlazorTemplate((this.control.element.id+"Annotation"+t).replace(/[^a-zA-Z0-9]/g,""),"ContentTemplate",r.stockChart?r.stockChart.annotations[t]:this.control.annotations[t],void 0,s)},e.prototype.setAccumulationPointValue=function(e){for(var t,i=0,n=this.control.visibleSeries[0].points;i<n.length;i++){var o=n[i];if("object"===r(o.x)){if(Date.parse(o.x)===Date.parse(this.annotation.x)&&o.y===this.annotation.y){t=o;break}}else if(o.x===this.annotation.x&&o.y===this.annotation.y){t=o;break}}return!(!t||!t.visible)&&(e.x=t.symbolLocation.x,e.y=t.symbolLocation.y,!0)},e.prototype.setElementStyle=function(e,t,i){var r=et(t,this.control.redraw),n={cancel:!1,name:"annotationRender",content:t,location:e};this.control.trigger("annotationRender",n),n.cancel||(n.content.style.left=this.setAlignmentValue(this.annotation.horizontalAlignment,r.width,n.location.x)+"px",n.content.style.top=this.setAlignmentValue(this.annotation.verticalAlignment,r.height,n.location.y)+"px",n.content.setAttribute("aria-label",this.annotation.description||"Annotation"),rt(n.content,i,this.control.redraw,!0,"left","top"))},e.prototype.setAlignmentValue=function(e,t,i){switch(e){case"Top":case"Near":i-=t;break;case"Bottom":case"Far":i+=0;break;case"Middle":case"Center":i-=t/2}return i},e}(),ko=(Zi=function(e,t){return(Zi=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}Zi(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),Wo=function(e){function t(t,i){var r=e.call(this,t)||this;return r.chart=t,r.annotations=i,r}return ko(t,e),t.prototype.renderAnnotations=function(e){var t=this;this.annotations=this.chart.annotations,this.parentElement=Mt(this.chart.redraw,this.chart.element.id+"_Annotation_Collections")||sf.base.createElement("div",{id:this.chart.element.id+"_Annotation_Collections"}),this.annotations.map((function(e,i){t.processAnnotation(e,i,t.parentElement)})),rt(this.parentElement,e,this.chart.redraw)},t.prototype.destroy=function(){},t.prototype.getModuleName=function(){return"Annotation"},t}(zo),Ro=(Ki=function(e,t){return(Ki=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}Ki(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),jo=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Ro(t,e),t.prototype.render=function(e,t,i,r){for(var n,o=this.getSideBySideInfo(e),s=0,a=e.points;s<a.length;s++){var l=a[s];l.symbolLocations=[],l.regions=[];var h=void 0;l.visible&&le(e.points[l.index-1],l,e.points[l.index+1],e)&&(this.findBoxPlotValues(l.y,l,e.boxPlotMode),this.updateTipRegion(e,l,o),h=this.getRectangle(l.xValue+o.start,l.upperQuartile,l.xValue+o.end,l.lowerQuartile,e),l.regions.push(h),(n=this.triggerEvent(e,l,e.interior,{color:sf.base.isNullOrUndefined(e.border.color)||"transparent"===e.border.color?mt(e.interior,-.6):e.border.color,width:e.border.width?e.border.width:1})).cancel||this.renderBoxAndWhisker(e,l,n,this.getPathString(l,e,it(l.xValue,l.median,t,i,r),it(l.xValue+o.median,l.average,t,i,r)),o.median))}e.marker.visible&&e.chart.markerRender.render(e)},t.prototype.updateTipRegion=function(e,t,i){var r=this.getRectangle(t.xValue+i.median,t.maximum,t.xValue+i.median,t.minimum,e);this.updateTipSize(e,t,r,e.chart.requireInvertedAxis)},t.prototype.updateTipSize=function(e,t,i,r){var n=e.border.width||1;r?(i.y-=n/2,i.height=i.height||n):(i.x-=n/2,i.width=i.width||n),t.regions.push(i)},t.prototype.getPathString=function(e,t,i,r){var n=e.regions[0],o=e.regions[1],s="",a=t.chart.requireInvertedAxis?n.y+n.height/2:n.x+n.width/2,l=o.x+o.width,h=o.y+o.height,d=n.x+n.width,c=n.y+n.height;return t.chart.requireInvertedAxis?(this.updateTipSize(t,e,{x:n.x,y:o.y,width:0,height:h-o.y},!1),this.updateTipSize(t,e,{x:d,y:o.y,width:0,height:h-o.y},!0),s+="M "+n.x+" "+o.y+" L "+n.x+" "+h,s+="M "+n.x+" "+a+"  L "+o.x+" "+a,s+=" M "+o.x+" "+o.y+"  L "+l+" "+o.y+" L "+l+" "+h+" L "+o.x+" "+h+" Z",s+=" M "+l+" "+a+" L "+d+" "+a,s+=" M "+d+" "+o.y+" L "+d+" "+h,s+=" M "+i.x+" "+o.y+"  L "+i.x+" "+h,s+=t.showMean?"M "+(r.x+5)+" "+(r.y-5)+" L "+(r.x-5)+" "+(r.y+5)+"M "+(r.x-5)+" "+(r.y-5)+" L "+(r.x+5)+" "+(r.y+5):""):(this.updateTipSize(t,e,{x:o.x,y:n.y,width:l-o.x,height:0},!0),this.updateTipSize(t,e,{x:o.x,y:c,width:l-o.x,height:0},!0),s+="M "+o.x+" "+n.y+"  L "+l+" "+n.y,s+=" M "+a+" "+n.y+"  L "+a+" "+o.y,s+=" M "+o.x+" "+o.y+"  L "+l+" "+o.y+" L "+l+" "+h+" L "+o.x+" "+h+" Z",s+=" M "+a+" "+h+" L "+a+" "+c,s+=" M "+o.x+" "+c+" L "+l+" "+c,s+=" M "+o.x+" "+i.y+" L "+l+" "+i.y,s+=t.showMean?" M "+(r.x-5)+" "+(r.y-5)+" L "+(r.x+5)+" "+(r.y+5)+" M "+(r.x+5)+" "+(r.y-5)+" L "+(r.x-5)+" "+(r.y+5):""),s},t.prototype.renderBoxAndWhisker=function(e,t,i,r,n){var o,s,a=e.chart.element.id+"_Series_"+e.index+"_Point_"+t.index,l=e.chart.renderer.drawPath(new sf.svgbase.PathOption(a+"_BoxPath",i.fill,i.border.width,i.border.color,e.opacity,e.dashArray,r));l.setAttribute("aria-label",t.x.toString()+":"+t.maximum.toString()+":"+t.minimum.toString()+":"+t.lowerQuartile.toString()+":"+t.upperQuartile.toString());var h=e.chart.renderer.createGroup({id:a});h.appendChild(l);for(var d=0;d<t.outliers.length;d++)o=it(t.xValue+n,t.outliers[d],e.xAxis,e.yAxis,e.chart.requireInvertedAxis),s=new sf.svgbase.Size(e.marker.width,e.marker.height),t.symbolLocations.push(o),this.updateTipSize(e,t,{x:o.x-s.width/2,y:o.y-s.height/2,width:s.width,height:s.height},!0);e.seriesElement.appendChild(h)},t.prototype.findBoxPlotValues=function(e,t,i){var r=e.length,n={average:he(e)/r,lowerQuartile:0,upperQuartile:0,maximum:0,minimum:0,median:0,outliers:[]};"Exclusive"===i?(n.lowerQuartile=this.getExclusiveQuartileValue(e,r,.25),n.upperQuartile=this.getExclusiveQuartileValue(e,r,.75),n.median=this.getExclusiveQuartileValue(e,r,.5)):"Inclusive"===i?(n.lowerQuartile=this.getInclusiveQuartileValue(e,r,.25),n.upperQuartile=this.getInclusiveQuartileValue(e,r,.75),n.median=this.getInclusiveQuartileValue(e,r,.5)):(n.median=yt(e),this.getQuartileValues(e,r,n)),this.getMinMaxOutlier(e,r,n),t.minimum=n.minimum,t.maximum=n.maximum,t.lowerQuartile=n.lowerQuartile,t.upperQuartile=n.upperQuartile,t.median=n.median,t.outliers=n.outliers,t.average=n.average},t.prototype.getExclusiveQuartileValue=function(e,t,i){if(0===t)return 0;if(1===t)return e[0];var r=i*(t+1),n=Math.floor(Math.abs(r)),o=r-n;return 0===n?e[0]:n>t-1?e[t-1]:o*(e[n]-e[n-1])+e[n-1]},t.prototype.getInclusiveQuartileValue=function(e,t,i){if(0===t)return 0;if(1===t)return e[0];var r=i*(t-1),n=Math.floor(Math.abs(r));return(r-n)*(e[n+1]-e[n])+e[n]},t.prototype.getQuartileValues=function(e,t,i){if(1===t)return i.lowerQuartile=e[0],i.upperQuartile=e[0],null;var r=t%2==0,n=t/2,o=e.slice(0,n),s=e.slice(r?n:n+1,t);i.lowerQuartile=yt(o),i.upperQuartile=yt(s)},t.prototype.getMinMaxOutlier=function(e,t,i){for(var r=1.5*(i.upperQuartile-i.lowerQuartile),n=0;n<t;n++){if(!(e[n]<i.lowerQuartile-r)){i.minimum=e[n];break}i.outliers.push(e[n])}for(n=t-1;n>=0;n--){if(!(e[n]>i.upperQuartile+r)){i.maximum=e[n];break}i.outliers.push(e[n])}},t.prototype.doAnimation=function(e){this.animate(e)},t.prototype.getModuleName=function(){return"BoxAndWhiskerSeries"},t.prototype.destroy=function(){},t}(Gr),Uo=(Ji=function(e,t){return(Ji=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}Ji(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),Ho=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Uo(t,e),t.prototype.render=function(e,t,i,r){var n,o,s,a,l=this,h=null,d="",c=Math.max(e.yAxis.visibleRange.min,0),p=[],u=this.sortSegments(e,e.segments),g="";e.visiblePoints.map((function(g,f,m){g.symbolLocations=[],g.regions=[],a=!1,g.visible&&le(m[f-1],g,m[f+1],e)&&(d+=l.getAreaPathDirection(g.xValue,c,e,r,it,h,"M"),h=h||new jt(g.xValue,c),n=it(g.xValue,g.yValue,t,i,r),s&&l.setPointColor(g,s,e,"X"===e.segmentAxis,u)?(a=!0,o=it(h.x,c,t,i,r),d+="L "+n.x+" "+n.y+" ",d+="L "+n.x+" "+o.y+" ",l.generatePathOption(p,e,s,d,"_Point_"+s.index),d="M "+n.x+" "+o.y+" L "+n.x+" "+n.y+" "):(d+="L "+n.x+" "+n.y+" ",l.setPointColor(g,null,e,"X"===e.segmentAxis,u)),m[f+1]&&!m[f+1].visible&&"Drop"!==e.emptyPointSettings.mode&&(d+=l.getAreaEmptyDirection({x:g.xValue,y:c},h,e,r,it),h=null),s=g,l.storePointLocation(g,e,r,it))})),sf.base.isNullOrUndefined(a)||a||(d=e.points.length>1?d+this.getAreaPathDirection(s.xValue,c,e,r,it,null,"L"):"",this.generatePathOption(p,e,s,d,"")),0!==e.border.width&&(g=this.removeEmptyPointsBorder(this.getBorderDirection(d)),this.generateBorderPathOption(p,e,s,g,"")),this.applySegmentAxis(e,p,u),this.renderMarker(e)},t.prototype.generatePathOption=function(e,t,i,r,n){e.push(new sf.svgbase.PathOption(t.chart.element.id+"_Series_"+t.index+n,t.setPointColor(i,t.interior),0,"transparent",t.opacity,t.dashArray,r))},t.prototype.generateBorderPathOption=function(e,t,i,r,n){e.push(new sf.svgbase.PathOption(t.chart.element.id+"_Series_border_"+t.index+n,"transparent",t.border.width,t.border.color?t.border.color:t.interior,1,t.dashArray,r))},t.prototype.destroy=function(){},t.prototype.getModuleName=function(){return"MultiColoredAreaSeries"},t.prototype.doAnimation=function(e){this.doLinearAnimation(e,e.animation)},t}(Jr),Bo=($i=function(e,t){return($i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}$i(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),_o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Bo(t,e),t.prototype.render=function(e,t,i,r){for(var n,o=null,s="M",a=this.enableComplexProperty(e),l=[],h="",d=this.sortSegments(e,e.segments),c=0,p=a;c<p.length;c++){var u=p[c];u.regions=[],u.visible&&le(a[u.index-1],u,a[u.index+1],e)?(n=u,h+=this.getLineDirection(o,u,e,r,it,s),null!=o?this.setPointColor(u,o,e,"X"===e.segmentAxis,d)?(l.push(new sf.svgbase.PathOption(e.chart.element.id+"_Series_"+e.index+"_Point_"+o.index,"none",e.width,e.setPointColor(o,e.interior),e.opacity,e.dashArray,h)),s="M",h=""):s="L":this.setPointColor(u,null,e,"X"===e.segmentAxis,d),o=u,this.storePointLocation(u,e,r,it)):(o="Drop"===e.emptyPointSettings.mode?o:null,s="Drop"===e.emptyPointSettings.mode?s:"M",u.symbolLocations=[])}""!==h&&l.push(new sf.svgbase.PathOption(e.chart.element.id+"_Series_"+e.index,"none",e.width,e.setPointColor(n,e.interior),e.opacity,e.dashArray,h)),this.applySegmentAxis(e,l,d),this.renderMarker(e)},t.prototype.doAnimation=function(e){this.doLinearAnimation(e,e.animation)},t.prototype.getModuleName=function(){return"MultiColoredLineSeries"},t.prototype.destroy=function(){},t}(Jr),Vo=function(){function e(e){this.xAxisPrevHeight=[],this.xAxisMultiLabelHeight=[],this.yAxisPrevHeight=[],this.yAxisMultiLabelHeight=[],this.multiLevelLabelRectXRegion=[],this.xLabelCollection=[],this.chart=e,this.addEventListener()}return e.prototype.addEventListener=function(){this.chart.isDestroyed||this.chart.on("click",this.click,this)},e.prototype.getMultilevelLabelsHeight=function(e){var t,i,r,n=0,o=[],s=[],a="Vertical"===e.orientation,l=a?e.rect.height:e.rect.width;e.multiLevelLabels.map((function(h,d){h.categories.map((function(n,s){if(""!==n.text&&null!==n.start&&null!==n.end){t=sf.svgbase.measureText(n.text,h.textStyle),i=a?t.width:t.height,i+=2*h.border.width+("CurlyBrace"===h.border.type?10:0),r=null!==n.maximumTextWidth?n.maximumTextWidth:ye("string"==typeof n.end?Number(new Date(n.end)):n.end,e)*l-ye("string"==typeof n.start?Number(new Date(n.start)):n.start,e)*l;var c=e.multiLevelLabels[d].categories.length;r=0!==s&&s!==c-1||"OnTicks"!==e.labelPlacement||"Shift"!==e.edgeLabelPlacement?r:r/2,t.width>r-10&&r>0&&"Wrap"===h.overflow&&!a&&(i*=Pt(n.text,r-10,h.textStyle).length),o[d]=o[d]?o[d]<i?i:o[d]:i}})),s[d]=n,n+=o[d]?o[d]+10:0})),e.multiLevelLabelHeight=n+(""!==e.title||this.chart.legendModule&&this.chart.legendSettings.visible?5:0),a?(this.yAxisMultiLabelHeight=o,this.yAxisPrevHeight=s):(this.xAxisMultiLabelHeight=o,this.xAxisPrevHeight=s)},e.prototype.renderXAxisMultiLevelLabels=function(e,t,i,r){var n,o,s,a,l,h,d,c,p,u,g,f,m=this,y=(e.labelPosition===e.tickPosition?e.majorTickLines.height:0)+e.maxLabelSize.height+10,v="",b="Outside"===e.labelPosition,w=e.isAxisInverse,x=e.isAxisOpposedPosition,M=(e.angle,e.scrollbarSettings.enable||b&&sf.base.isNullOrUndefined(e.crossesAt)?e.scrollBarHeight:0),N=x&&!b||!x&&b?r.y+y-e.majorTickLines.width:r.y-y-e.multiLevelLabelHeight;this.createClipRect(r.x-e.majorTickLines.width,N+M,e.multiLevelLabelHeight+10,r.width+2*e.majorTickLines.width,this.chart.element.id+"_XAxis_Clippath_"+t,this.chart.element.id+"XAxisMultiLevelLabel"+t),e.multiLevelLabels.map((function(i,N){a=0,m.labelElement=m.chart.renderer.createGroup({id:m.chart.element.id+t+"_MultiLevelLabel"+N}),i.categories.map((function(I,S){if(f=i.categories.length,v="",h="string"==typeof I.start?Number(new Date(I.start)):I.start,d="string"==typeof I.end?Number(new Date(I.end)):I.end,!(g=m.triggerMultiLabelRender(e,I.text,e.multiLevelLabels[N].textStyle,e.multiLevelLabels[N].alignment,I.customAttributes)).cancel){s=ye(h,e)*r.width,l=ye(d,e)*r.width,l=w?[s,s=l][0]:l,c=sf.svgbase.measureText(g.text,g.textStyle),p=(null===I.maximumTextWidth?l-s:I.maximumTextWidth)-10,n=s+r.x+10,o=(x&&!b||!x&&b?y+r.y+c.height/2+10+m.xAxisPrevHeight[N]:r.y-y+c.height/2-m.xAxisMultiLabelHeight[N]-m.xAxisPrevHeight[N])+M,"Center"===g.alignment?(n+=(l-s-10)/2,u="middle"):"Far"===g.alignment?(n=n+(l-s-10)-i.border.width/2,"OnTicks"!==e.labelPlacement||0!==S&&S!==f-1||(n+=(l-s-10)/2,n-=c.width/2),u="end"):(u="start",n+=i.border.width/2),o="CurlyBrace"===i.border.type?!x&&b||x&&!b?o+10:o-5:o;var C=new sf.svgbase.TextOption(m.chart.element.id+t+"_Axis_MultiLevelLabel_Level_"+N+"_Text_"+S,n,o,u,g.text);if("None"!==i.overflow){if(e.edgeLabelPlacement&&"OnTicks"===e.labelPlacement)switch(e.edgeLabelPlacement){case"None":break;case"Shift":0===S||w&&S===f-1?("Center"===g.alignment&&(C.x<r.x+10||C.x-c.width/2)<e.rect.x?(C.x+=r.x/2,C.x/2<r.x&&(C.x=r.x+5,C.anchor="start")):"Far"===g.alignment&&(C.x<r.x+10||C.x>r.x+10)?C.x+=c.width/2-p/2:"Near"===g.alignment&&(C.x<r.x+10||C.x>r.x+10)&&(C.x=r.x+10),p/=2):(S===f-1||w&&0===S)&&("Center"===g.alignment&&C.x>r.x+r.width?(C.x-=10,C.x>r.width&&(C.x=r.width+r.x,C.anchor="end")):"Far"===g.alignment?C.x=r.width+r.x:C.x=C.x,p/=2)}C.text="Wrap"===i.overflow?Pt(g.text,p,g.textStyle):bt(p,g.text,g.textStyle),C.x=C.x-5}if(It(m.chart.renderer,C,g.textStyle,g.textStyle.color||m.chart.themeStyle.axisLabel,m.labelElement,!1,m.chart.redraw,!0,null,null,null,0,null,m.chart.enableCanvas),m.chart.enableCanvas){var O=sf.svgbase.measureText(g.text,g.textStyle);m.multiLevelLabelRectXRegion.push(new sf.svgbase.Rect(C.x,C.y,O.width,O.height)),m.xLabelCollection.push(C)}i.border.width>0&&"WithoutBorder"!==i.border.type&&""!==(v=m.renderXAxisLabelBorder(N,l-s-10,e,s,y,c,C,r,g.alignment,v,b,x,a))&&(m.createBorderElement(N,t,e,v,a),a++),m.chart.enableCanvas||m.multiElements.appendChild(m.labelElement)}}))})),this.chart.enableCanvas||i.appendChild(this.multiElements)},e.prototype.renderXAxisLabelBorder=function(e,t,i,r,n,o,s,a,l,h,d,c,p){var u,g,f,m,y=10,v=i.multiLevelLabels[e],b=v.categories[p].type,w=t+y,x=this.xAxisMultiLabelHeight[e]+y,M="Outside"===i.labelPosition?i.scrollBarHeight:0,N=r+a.x,I=!c&&d||c&&!d?n+a.y+this.xAxisPrevHeight[e]+M:a.y-n-this.xAxisPrevHeight[e]-M,S=b||v.border.type;switch(S){case"WithoutTopandBottomBorder":case"Rectangle":case"WithoutTopBorder":var C=p===i.multiLevelLabels[e].categories.length-1&&N+w>a.width?a.width+a.x:N+w,O=0===p&&i.multiLevelLabels[e].categories[0].start<=0?a.x:N;h+="M "+O+" "+I+" L "+O+" "+(I+(x=!c&&d||c&&!d?x:-x))+" M "+C+" "+I+" L "+C+" "+(I+x),h+="WithoutTopandBottomBorder"!==S?" L "+O+" "+(I+x)+" ":" ",h+="Rectangle"===S?"M "+O+" "+I+" L "+C+" "+I:" ";break;case"Brace":"Near"===l?(f=s.x,m=s.x+o.width+2):"Center"===l?(f=s.x-o.width/2-2,m=s.x+o.width/2+2):(f=s.x-o.width-2,m=s.x),h+="M "+N+" "+I+" L "+N+" "+(I+(x=!c&&d||c&&!d?x:-x)/2)+" M "+N+" "+(I+x/2)+" L "+(f-2)+" "+(I+x/2)+" M "+m+" "+(I+x/2)+" L "+(N+w)+" "+(I+x/2)+" M "+(N+w)+" "+(I+x/2)+" L "+(N+w)+" "+I;break;case"CurlyBrace":!c&&d||c&&!d?(y=10,u=15,g=5):(y=-10,u=-15,g=-5),h+="Center"===l?"M "+N+" "+I+" C "+N+" "+I+" "+(N+5)+" "+(I+y)+" "+(N+10)+" "+(I+y)+" L "+(N+w/2-5)+" "+(I+y)+" L "+(N+w/2)+" "+(I+u)+" L "+(N+w/2+5)+" "+(I+y)+" L "+(N+w-10)+" "+(I+y)+" C "+(N+w-10)+" "+(I+y)+" "+(N+w)+" "+(I+g)+" "+(N+w)+" "+I:"Near"===l?"M "+N+" "+I+" C "+N+" "+I+" "+(N+5)+" "+(I+y)+" "+(N+10)+" "+(I+y)+" L "+(N+15)+" "+(I+u)+" L "+(N+20)+" "+(I+y)+" L "+(N+w-10)+" "+(I+y)+" C "+(N+w-10)+" "+(I+y)+" "+(N+w)+" "+(I+g)+" "+(N+w)+" "+I:"M "+N+" "+I+" C "+N+" "+I+" "+(N+5)+" "+(I+y)+" "+(N+10)+" "+(I+y)+" L "+(N+w-20)+" "+(I+y)+" L "+(N+w-15)+" "+(I+u)+" L "+(N+w-10)+" "+(I+y)+" L "+(N+w-10)+" "+(I+y)+" C "+(N+w-10)+" "+(I+y)+" "+(N+w)+" "+(I+g)+" "+(N+w)+" "+I}return h},e.prototype.renderYAxisMultiLevelLabels=function(e,t,i,r){var n,o,s,a,l,h,d,c,p,u,g=this,f="Outside"===e.labelPosition,m=(e.tickPosition===e.labelPosition?e.majorTickLines.height:0)+e.maxLabelSize.width+10,y="",v=e.isAxisInverse,b=e.isAxisOpposedPosition,w=f&&sf.base.isNullOrUndefined(e.crossesAt)?e.scrollBarHeight:0;w*=b?1:-1;var x=b&&!f||!b&&f?r.x-e.multiLevelLabelHeight-m-10:r.x+m;this.createClipRect(x+w,r.y-e.majorTickLines.width,r.height+2*e.majorTickLines.width,e.multiLevelLabelHeight+10,this.chart.element.id+"_YAxis_Clippath_"+t,this.chart.element.id+"YAxisMultiLevelLabel"+t),e.multiLevelLabels.map((function(i,x){g.labelElement=g.chart.renderer.createGroup({id:g.chart.element.id+t+"_MultiLevelLabel"+x}),d=0,i.categories.map((function(M,N){if(y="",p="string"==typeof M.end?Number(new Date(M.end)):M.end,c="string"==typeof M.start?Number(new Date(M.start)):M.start,a=ye(c,e)*r.height,l=ye(p,e)*r.height,l=v?[a,a=l][0]:l,!(h=g.triggerMultiLabelRender(e,M.text,i.textStyle,i.alignment,M.customAttributes)).cancel){var I=null===M.maximumTextWidth?g.yAxisMultiLabelHeight[x]/2:M.maximumTextWidth/2;n=sf.svgbase.measureText(h.text,h.textStyle),u=l-a,o=r.x-m-g.yAxisPrevHeight[x]-I-5,s=r.height+r.y-a-u/2,o=b?f?r.x+m+5+I+g.yAxisPrevHeight[x]+w:r.x-m-I-g.yAxisPrevHeight[x]-5:f?o+w:r.x+m+5+I+g.yAxisPrevHeight[x],"Center"===h.alignment?s+=n.height/4:"Far"===h.alignment?s+=u/2-n.height/2:s=s-u/2+n.height,o="CurlyBrace"===i.border.type?!b&&f||b&&!f?o-10:o+10:o;var S=new sf.svgbase.TextOption(g.chart.element.id+t+"_Axis_MultiLevelLabel_Level_"+x+"_Text_"+N,o,s,"middle",h.text);S.text="Trim"===i.overflow?bt(null===M.maximumTextWidth?g.yAxisMultiLabelHeight[x]:M.maximumTextWidth,h.text,h.textStyle):S.text,S.text="Wrap"===i.overflow?Pt(h.text,null===M.maximumTextWidth?g.yAxisMultiLabelHeight[x]:M.maximumTextWidth,h.textStyle):S.text,"string"!=typeof S.text&&S.text.length>1&&(S.y-=10*S.text.length/2),It(g.chart.renderer,S,h.textStyle,h.textStyle.color||g.chart.themeStyle.axisLabel,g.labelElement,g.chart.redraw,!0,null,null,null,null,0,null,g.chart.enableCanvas),i.border.width>0&&"WithoutBorder"!==i.border.type&&""!==(y=g.renderYAxisLabelBorder(x,u,e,l,m,a,n,S,r,h.alignment,y,f,b,d))&&(g.createBorderElement(x,t,e,y,d),d++),g.chart.enableCanvas||g.multiElements.appendChild(g.labelElement)}}))})),this.chart.enableCanvas||i.appendChild(this.multiElements)},e.prototype.renderYAxisLabelBorder=function(e,t,i,r,n,o,s,a,l,h,d,c,p,u){var g,f,m=r-o,y=10,v=i.multiLevelLabels[e],b=v.categories[u].type,w=l.y+l.height-r,x=c&&sf.base.isNullOrUndefined(i.crossesAt)?i.scrollBarHeight:0;x*=p?1:-1;var M=(null===v.categories[u].maximumTextWidth?this.yAxisMultiLabelHeight[e]:v.categories[u].maximumTextWidth)+y,N=(!p&&c||p&&!c?l.x-n-this.yAxisPrevHeight[e]:l.x+n+this.yAxisPrevHeight[e])+x,I=b||v.border.type;switch(I){case"WithoutTopandBottomBorder":case"Rectangle":case"WithoutTopBorder":d+="M "+N+" "+w+" L "+(N+(M=!p&&c||p&&!c?-M:M))+" "+w+" M "+N+" "+(w+m)+" L "+(N+M)+" "+(w+m),d+="WithoutTopandBottomBorder"!==I?" L "+(N+M)+" "+w+" ":" ",d+="Rectangle"===I?"M "+N+" "+(w+m)+"L "+N+" "+w+" ":" ";break;case"Brace":d+="M "+N+" "+w+" L "+(N-(M=!p&&c||p&&!c?M:-M)/2)+" "+w+" L "+(N-M/2)+" "+(a.y-s.height/2-4)+" M "+(N-M/2)+" "+(a.y+s.height/4+2)+" L "+(N-M/2)+" "+(w+m)+" L "+N+" "+(w+m);break;case"CurlyBrace":!p&&c||p&&!c?(y=-10,g=-15,f=-5):(y=10,g=15,f=5),d+="Center"===h?"M "+N+" "+w+" C "+N+" "+w+" "+(N+y)+" "+w+" "+(N+y)+" "+(w+10)+" L "+(N+y)+" "+(w+(m-10)/2)+" L "+(N+g)+" "+(w+(m-10)/2+5)+" L "+(N+y)+" "+(w+(m-10)/2+10)+" L "+(N+y)+" "+(w+(m-10))+" C "+(N+y)+" "+(w+(m-10))+" "+(N+f)+" "+(w+m)+" "+N+" "+(w+m):"Far"===h?"M "+N+" "+w+" C "+N+" "+w+" "+(N+y)+" "+w+" "+(N+y)+" "+(w+10)+" L "+(N+y)+" "+(w+m-20)+"  L "+(N+g)+" "+(w+(m-15))+" L "+(N+y)+" "+(w+(m-10))+" L "+(N+y)+" "+(w+(m-10))+" C "+(N+y)+" "+(w+(m-10))+" "+(N+y)+" "+(w+m)+" "+N+" "+(w+m):"M "+N+" "+w+" C "+N+" "+w+" "+(N+y)+" "+w+" "+(N+y)+" "+(w+10)+" L "+(N+g)+" "+(w+15)+" L "+(N+y)+" "+(w+20)+" L "+(N+y)+" "+(w+(m-10))+" C "+(N+y)+" "+(w+(m-10))+" "+(N+f)+" "+(w+m)+" "+N+" "+(w+m)}return d},e.prototype.createClipRect=function(e,t,i,r,n,o){this.multiElements=this.chart.renderer.createGroup({id:o,"clip-path":"url(#"+n+")"}),this.chart.enableCanvas||this.multiElements.appendChild(Re(this.chart.redraw,{id:n,x:e,y:t,width:r,height:i,fill:"white","stroke-width":1,stroke:"Gray"},this.chart.renderer))},e.prototype.createBorderElement=function(e,t,i,r,n){var o=r,s=this.chart.renderer.drawPath(new sf.svgbase.PathOption(this.chart.element.id+t+"_Axis_MultiLevelLabel_Rect_"+e+"_"+n,"Transparent",i.multiLevelLabels[e].border.width,i.multiLevelLabels[e].border.color||this.chart.themeStyle.axisLine,1,"",r));s.style.pointerEvents="none",nt(this.chart.enableCanvas,this.labelElement,s,this.chart.redraw,!0,"x","y",null,o)},e.prototype.triggerMultiLabelRender=function(e,t,i,r,n){var o={cancel:!1,name:"axisMultiLabelRender",axis:e,text:t,textStyle:i,alignment:r,customAttributes:n};return this.chart.trigger("axisMultiLabelRender",o),o},e.prototype.MultiLevelLabelClick=function(e,t){var i=parseInt(e.substr(0,1),10),r=parseInt(e.substr(7),10),n=this.chart.axisCollections[t],o=n.multiLevelLabels[i].categories,s=o[r].text,a=o[r].start,l=o[r].end,h={axis:n,level:i,text:s,customAttributes:o[r].customAttributes,start:a,end:l,name:"multiLevelLabelClick",cancel:!1};return this.chart.trigger("multiLevelLabelClick",h),h},e.prototype.click=function(e){var t,i,r,n=e.target.id,o="_Axis_MultiLevelLabel_Level_";if(this.chart.enableCanvas)for(var s=0;s<this.multiLevelLabelRectXRegion.length;s++)Ce(e.x,e.y,this.multiLevelLabelRectXRegion[s],this.multiLevelLabelRectXRegion[s].width,this.multiLevelLabelRectXRegion[s].height)&&(n=this.xLabelCollection[s].id);n.indexOf(o)>-1&&(t=n.split(o)[1],i=n.split(o)[0],r=parseInt(i.charAt(i.length-1),10),this.MultiLevelLabelClick(t,r))},e.prototype.getModuleName=function(){return"MultiLevelLabel"},e.prototype.destroy=function(){},e}();var Yo,Qo=function(){function e(e){this.chartId=e.element.id+"_"}return e.prototype.renderElements=function(e,t){var i=e.axis.isAxisInverse,r=t.createGroup({id:this.chartId+"scrollBar_"+e.axis.name,transform:"translate("+(e.isVertical&&i?e.height:i?e.width:"0")+","+(e.isVertical&&i?"0":i?e.height:e.isVertical?e.width:"0")+") rotate("+(e.isVertical&&i?"90":e.isVertical?"270":i?"180":"0")+")"}),n=t.createGroup({id:this.chartId+"scrollBar_backRect_"+e.axis.name}),o=t.createGroup({id:this.chartId+"scrollBar_thumb_"+e.axis.name,transform:"translate(0,0)"});return this.backRect(e,t,n),this.thumb(e,t,o),this.renderCircle(e,t,o),this.arrows(e,t,o),this.thumbGrip(e,t,o),r.appendChild(n),r.appendChild(o),r},e.prototype.backRect=function(e,t,i){var r=e.scrollbarThemeStyle,n=t.drawRectangle(new zt(this.chartId+"scrollBarBackRect_"+e.axis.name,r.backRect,{width:1,color:r.backRect},1,new sf.svgbase.Rect(0,0,e.width,e.height),0,0));i.appendChild(n)},e.prototype.arrows=function(e,t,i){var r=e.scrollbarThemeStyle,n=new sf.svgbase.PathOption(this.chartId+"scrollBar_leftArrow_"+e.axis.name,r.arrow,1,r.arrow,1,"","");this.leftArrowEle=t.drawPath(n),n.id=this.chartId+"scrollBar_rightArrow_"+e.axis.name,this.rightArrowEle=t.drawPath(n),this.setArrowDirection(this.thumbRectX,this.thumbRectWidth,e.height),i.appendChild(this.leftArrowEle),i.appendChild(this.rightArrowEle)},e.prototype.setArrowDirection=function(e,t,i){var r="M "+(e-4+1)+" "+i/2+" L "+(e-4+6)+" 11 L "+(e-4+6)+" 5 Z",n="M "+(e+t+4-.5)+" "+i/2+" L "+(e+t+4-6)+" 11.5 L "+(e+t+4-6)+" 4.5 Z";this.leftArrowEle.setAttribute("d",r),this.rightArrowEle.setAttribute("d",n)},e.prototype.thumb=function(e,t,i){e.startX=this.thumbRectX;var r=e.scrollbarThemeStyle;this.slider=t.drawRectangle(new zt(this.chartId+"scrollBarThumb_"+e.axis.name,r.thumb,{width:1,color:""},1,new sf.svgbase.Rect(this.thumbRectX,0,this.thumbRectWidth,e.height))),i.appendChild(this.slider)},e.prototype.renderCircle=function(e,t,i){var r=e.scrollbarThemeStyle,n=new Wt(this.chartId+"scrollBar_leftCircle_"+e.axis.name,r.circle,{width:1,color:r.circle},1,this.thumbRectX,e.height/2,8),o=t.createDefs(),s=t.createGroup({id:this.chartId+e.axis.name+"_thumb_shadow"});o.innerHTML='<filter x="-25.0%" y="-20.0%" width="150.0%" height="150.0%" filterUnits="objectBoundingBox"id="scrollbar_shadow"><feOffset dx="0" dy="1" in="SourceAlpha" result="shadowOffsetOuter1"></feOffset><feGaussianBlur stdDeviation="1.5" in="shadowOffsetOuter1" result="shadowBlurOuter1"></feGaussianBlur><feComposite in="shadowBlurOuter1" in2="SourceAlpha" operator="out" result="shadowBlurOuter1"></feComposite><feColorMatrix values="0 0 0 0 0   0 0 0 0 0   0 0 0 0 0  0 0 0 0.16 0" type="matrix" in="shadowBlurOuter1"></feColorMatrix></filter>',s.innerHTML='<use fill="black" fill-opacity="1" filter="url(#scrollbar_shadow)" xlink:href="#'+this.chartId+"scrollBar_leftCircle_"+e.axis.name+'"></use><use fill="black" fill-opacity="1" filter="url(#scrollbar_shadow)" xlink:href="#'+this.chartId+"scrollBar_rightCircle_"+e.axis.name+'"></use>',this.leftCircleEle=t.drawCircle(n),n.id=this.chartId+"scrollBar_rightCircle_"+e.axis.name,n.cx=this.thumbRectX+this.thumbRectWidth,this.rightCircleEle=t.drawCircle(n),i.appendChild(o),i.appendChild(this.leftCircleEle),i.appendChild(this.rightCircleEle),i.appendChild(s)},e.prototype.thumbGrip=function(e,t,i){var r=0,n=0,o=e.scrollbarThemeStyle,s=new Wt(this.chartId+"scrollBar_gripCircle0_"+e.axis.name,o.grip,{width:1,color:o.grip},1,0,0,1);this.gripCircle=t.createGroup({id:this.chartId+"scrollBar_gripCircle_"+e.axis.name,transform:"translate("+(this.thumbRectX+this.thumbRectWidth/2+5*(e.isVertical?1:-1))+","+(e.isVertical?"10":"5")+") rotate("+(e.isVertical?"180":"0")+")"});for(var a=1;a<=6;a++)s.id=this.chartId+"scrollBar_gripCircle"+a+"_"+e.axis.name,s.cx=r,s.cy=n,this.gripCircle.appendChild(t.drawCircle(s)),r=3===a?0:r+5,n=a>=3?5:0;i.appendChild(this.gripCircle)},e}(),qo=function(){function e(e,t){this.scrollRange={max:null,min:null,interval:null,delta:null},this.component=e,this.elements=[],this.scrollElements=new Qo(e),this.axis=t,this.mouseMoveListener=this.scrollMouseMove.bind(this),this.mouseUpListener=this.scrollMouseUp.bind(this),this.animateDuration=500,this.isPointer=sf.base.Browser.isPointer,this.browserName=sf.base.Browser.info.name}return e.prototype.getMouseXY=function(e){var t,i,r;e.type.indexOf("touch")>-1?(t=(r=e).changedTouches[0].clientX,i=r.changedTouches[0].clientY):(t=e.clientX,i=e.clientY);var n=Ge(this.component.element.id+"_scrollBar_svg"+this.axis.name).getBoundingClientRect();this.mouseX=t-Math.max(n.left,0),this.mouseY=i-Math.max(n.top,0)},e.prototype.wireEvents=function(e){sf.base.EventHandler.add(e,sf.base.Browser.touchStartEvent,this.scrollMouseDown,this),sf.base.EventHandler.add(e,sf.base.Browser.touchMoveEvent,this.scrollMouseMove,this),sf.base.EventHandler.add(e,sf.base.Browser.touchEndEvent,this.scrollMouseUp,this),sf.base.EventHandler.add(e,"mousewheel",this.scrollMouseWheel,this),window.addEventListener("mousemove",this.mouseMoveListener,!1),window.addEventListener("mouseup",this.mouseUpListener,!1)},e.prototype.unWireEvents=function(e){sf.base.EventHandler.remove(e,sf.base.Browser.touchStartEvent,this.scrollMouseDown),sf.base.EventHandler.remove(e,sf.base.Browser.touchMoveEvent,this.scrollMouseMove),sf.base.EventHandler.remove(e,sf.base.Browser.touchEndEvent,this.scrollMouseUp),sf.base.EventHandler.remove(e,"mousewheel",this.scrollMouseWheel),window.removeEventListener("mousemove",this.mouseMoveListener,!1),window.removeEventListener("mouseup",this.mouseUpListener,!1)},e.prototype.scrollMouseDown=function(e){var t=e.target.id,i=this.scrollElements,r=this.axis.isAxisInverse;if(this.getMouseXY(e),this.isResizeLeft=this.isExist(t,"_leftCircle_")||this.isExist(t,"_leftArrow_"),this.isResizeRight=this.isExist(t,"_rightCircle_")||this.isExist(t,"_rightArrow_"),this.previousXY=this.isVertical&&r?this.mouseY:this.isVertical?this.width-this.mouseY:r?this.width-this.mouseX:this.mouseX,this.previousWidth=i.thumbRectWidth,this.previousRectX=i.thumbRectX,this.startZoomPosition=this.axis.zoomPosition,this.startZoomFactor=this.axis.zoomFactor,this.startRange=this.axis.visibleRange,this.scrollStarted=!0,this.component.trigger("scrollStart",this.getArgs("scrollStart")),this.isExist(t,"scrollBarThumb_")||this.isExist(t,"gripCircle"))this.isThumbDrag=!0,this.svgObject.style.cursor="-webkit-grabbing";else if(this.isExist(t,"scrollBarBackRect_")){var n=this.moveLength(this.previousXY,this.previousRectX);if(i.thumbRectX=this.isWithIn(n)?n:i.thumbRectX,this.positionThumb(i.thumbRectX,i.thumbRectWidth),this.setZoomFactorPosition(i.thumbRectX,i.thumbRectWidth,!1),this.isLazyLoad){var o=i.thumbRectX>this.previousRectX?"RightMove":"LeftMove",s=this.calculateLazyRange(i.thumbRectX,i.thumbRectWidth,o);s&&this.component.trigger("scrollEnd",s)}}""===this.component.element.style.height&&(this.isCustomHeight=!0,this.component.element.style.height=this.component.availableSize.height+"px")},e.prototype.isExist=function(e,t){return e.indexOf(t)>-1},e.prototype.isWithIn=function(e){return e-8>=0&&e+this.scrollElements.thumbRectWidth+8<=this.width},e.prototype.moveLength=function(e,t,i){void 0===i&&(i=8);var r=.1*(this.width-2*i);return r=e<t?t-(t-r>i?r:i):t+(t+this.scrollElements.thumbRectWidth+r<this.width-i?r:i)},e.prototype.setZoomFactorPosition=function(e,t,i){void 0===i&&(i=!0),this.isScrollUI=!0;var r=this.axis,n=e+t+8+1,o=this.isVertical?r.rect.height:this.width;this.zoomFactor=(t+(n>=this.width?9:0))/o,r.zoomFactor=i?this.zoomFactor:r.zoomFactor,this.zoomPosition=n>o?1-r.zoomFactor:e<9?0:(e-(e-8.5<=0?8.5:0))/o,r.zoomPosition=this.zoomPosition<0?0:this.zoomPosition>.9?1:this.zoomPosition},e.prototype.scrollMouseMove=function(e){var t=e.target,i=this.scrollElements,r=this.axis.isAxisInverse;if(!Ge(this.svgObject.id))return null;this.getMouseXY(e),this.setCursor(t),this.setTheme(t);var n,o=this.isVertical&&r?this.width-this.mouseY:this.isVertical?this.mouseY:this.mouseX,s=this.axis.visibleRange,a=this.zoomPosition,l=this.zoomFactor,h=this.previousRectX-i.thumbRectX<0?"RightMove":"LeftMove";this.isLazyLoad&&(this.isThumbDrag||this.isResizeLeft||this.isResizeRight)&&(n=this.calculateLazyRange(i.thumbRectX,i.thumbRectWidth,h));var d=n?n.currentRange:null;if(this.isThumbDrag){this.component.isScrolling=this.isThumbDrag,o=this.isVertical||r?this.width-o:o;var c=i.thumbRectX+(o-this.previousXY);o>=c+i.thumbRectWidth?this.setCursor(t):this.svgObject.style.cursor="-webkit-grabbing",o>=0&&o<=c+i.thumbRectWidth&&(i.thumbRectX=this.isWithIn(c)?c:i.thumbRectX,this.positionThumb(i.thumbRectX,i.thumbRectWidth),this.previousXY=o,this.setZoomFactorPosition(c,i.thumbRectWidth,!1)),this.component.trigger("scrollChanged",this.getArgs("scrollChanged",s,a,l,d))}else(this.isResizeLeft||this.isResizeRight)&&(this.resizeThumb(),this.component.trigger("scrollChanged",this.getArgs("scrollChanged",s,a,l,d)))},e.prototype.scrollMouseWheel=function(e){var t=Ge(this.component.element.id+"_scrollBar_svg"+this.axis.name).getBoundingClientRect();this.mouseX=e.clientX-Math.max(t.left,0),this.mouseY=e.clientY-Math.max(t.top,0);var i,r=.5,n=this.scrollElements,o=this.axis,s="mozilla"!==this.browserName||this.isPointer?e.wheelDelta/120>0?1:-1:-e.detail/3>0?1:-1,a=Math.max(Math.max(1/qe(o.zoomFactor,0,1),1)+.25*s,1),l=this.axis.visibleRange,h=this.zoomPosition,d=this.zoomFactor;a>=1&&(r=(r="Horizontal"===o.orientation?this.mouseX/o.rect.width:1-this.mouseY/o.rect.height)>1?1:r<0?0:r,this.zoomFactor=1===a?1:qe(1/a,0,1),this.zoomPosition=1===a?0:o.zoomPosition+(o.zoomFactor-this.zoomFactor)*r),n.thumbRectX=this.isWithIn(this.zoomPosition*this.width)?this.zoomPosition*this.width:n.thumbRectX,this.isScrollUI=!0,this.positionThumb(n.thumbRectX,n.thumbRectWidth),this.isLazyLoad&&this.setZoomFactorPosition(n.thumbRectX,n.thumbRectWidth),o.zoomFactor=this.zoomFactor,o.zoomPosition=this.zoomPosition,this.isLazyLoad&&(i=this.calculateMouseWheelRange(n.thumbRectX,n.thumbRectWidth))&&i.currentRange.minimum!==i.previousAxisRange.minimum&&i.currentRange.maximum!==i.previousAxisRange.maximum&&(this.component.trigger("scrollEnd",i),this.isScrollEnd=!1),this.isLazyLoad||this.component.trigger("scrollChanged",this.getArgs("scrollChanged",l,h,d))},e.prototype.scrollMouseUp=function(){var e;this.startX=this.scrollElements.thumbRectX;var t=this.startX+this.scrollElements.thumbRectWidth+8+1;if(!this.isResizeLeft&&!this.isResizeRight||this.isLazyLoad||(this.axis.zoomFactor=t>=this.width-1&&this.startX-8.5<=0?1:this.zoomFactor),this.isLazyLoad){var i=this.previousRectX-this.startX;if((i>0||i<0)&&this.isThumbDrag){var r=i<0?"RightMove":"LeftMove";this.startX="RightMove"===r?this.startX+Math.abs(i)<this.width-8?this.startX:this.width-8-this.scrollElements.thumbRectWidth:this.startX+this.scrollElements.thumbRectWidth-Math.abs(i)>8?this.startX:8,(e=this.calculateLazyRange(this.startX,this.scrollElements.thumbRectWidth,r))&&(this.component.trigger("scrollEnd",e),this.scrollStarted=!1)}(this.isResizeLeft||this.isResizeRight)&&(e=this.calculateLazyRange(this.startX,this.scrollElements.thumbRectWidth))&&(this.component.trigger("scrollEnd",e),this.scrollStarted=!1)}this.isThumbDrag=!1,this.isResizeLeft=!1,this.isResizeRight=!1,this.isScrollEnd=!1,this.component.isScrolling=!1,this.scrollStarted&&!this.isLazyLoad&&(this.component.trigger("scrollEnd",this.getArgs("scrollChanged",this.startRange,this.startZoomPosition,this.startZoomFactor)),this.scrollStarted=!1),this.isCustomHeight&&(this.component.element.style.height=null)},e.prototype.calculateMouseWheelRange=function(e,t){var i,r,n,o=this.scrollRange,s=this.getStartEnd(this.previousStart,this.previousEnd,!1);e+t+8<=this.width&&(r=(e-8)/this.width,i=t/this.width);var a=o.min+r*o.delta,l=a+i*o.delta;return l&&(n={axis:this.axis,currentRange:this.getStartEnd(a,l,!0),previousAxisRange:s}),n},e.prototype.calculateLazyRange=function(e,t,i){var r,n,o,s,a,l=t,h=this.scrollRange,d=this.getStartEnd(this.previousStart,this.previousEnd,!1);return this.isResizeRight||"RightMove"===i?(r=((l=this.isResizeRight?l+16:l)+8)/this.width,n="RightMove"===i?(e+8)/this.width:this.axis.zoomPosition,s=(o="RightMove"===i?h.min+n*h.delta:this.previousStart)+r*h.delta):this.isResizeLeft||"LeftMove"===i?(n=(e-8)/this.width,r=l/this.width,o=(o=h.min+n*h.delta)>=h.min?o:h.min,s="LeftMove"===i?o+r*h.delta:this.previousEnd):this.isThumbDrag&&(n="RightMove"===i?(e+8)/this.width:(e-8)/this.width,r=this.scrollElements.thumbRectWidth/this.width,s=(o=(o=h.min+n*h.delta)>=h.min?o:h.min)+r*h.delta),s&&(a={axis:this.component.isBlazor?{}:this.axis,currentRange:this.getStartEnd(o,s,!0),previousAxisRange:d}),a},e.prototype.getStartEnd=function(e,t,i){var r=this.valueType;switch("DateTime"!==r&&"DateTimeCategory"!==r||!i?i&&(this.previousStart=Math.round(e),this.previousEnd=Math.ceil(t)):(this.previousStart=e,this.previousEnd=t),r){case"Double":case"Category":case"Logarithmic":e=Math.round(e),t=Math.ceil(t);break;case"DateTime":case"DateTimeCategory":e=new Date(e),t=new Date(t)}return{minimum:e,maximum:t}},e.prototype.render=function(e){return(this.component.zoomModule||e&&this.axis.scrollbarSettings.enable)&&this.getDefaults(),this.getTheme(),this.removeScrollSvg(),function(e,t){for(var i,r=e.axis.rect,n="Horizontal"===e.axis.orientation,o=!1,s=0,a=0,l=e.axis.series;a<l.length;a++){(c=l[a]).marker.visible&&c.marker.height>s&&(s=c.marker.height)}for(var h=0,d=e.axis.series;h<d.length;h++){var c;if((c=d[h]).visible&&(i=c.yMin.toString(),o=c.yData.some((function(e){return e===i}))),o)break}e.svgObject=t.createSvg({id:e.component.element.id+"_scrollBar_svg"+e.axis.name,width:e.isVertical?e.height:e.width,height:e.isVertical?e.width:e.height,style:"position: absolute;top: "+((e.axis.isAxisOpposedPosition&&n?-16:o?s:0)+r.y+Math.max(1,e.axis.lineStyle.width/2))+"px;left: "+((e.axis.isAxisOpposedPosition&&!n?16:0)+r.x-(e.isVertical?e.height:0))+"px;cursor:auto;"}),e.elements.push(e.svgObject)}(this,this.component.svgRenderer),this.wireEvents(this.svgObject),this.svgObject.appendChild(this.scrollElements.renderElements(this,this.component.svgRenderer)),this.svgObject},e.prototype.getTheme=function(){this.scrollbarThemeStyle=function(e){var t;switch(e){case"HighContrastLight":t={backRect:"#333",thumb:"#bfbfbf",circle:"#fff",circleHover:"#685708",arrow:"#333",grip:"#333",arrowHover:"#fff",backRectBorder:"#969696"};break;case"Bootstrap":t={backRect:"#f5f5f5",thumb:"#e6e6e6",circle:"#fff",circleHover:"#eee",arrow:"#8c8c8c",grip:"#8c8c8c"};break;case"Fabric":t={backRect:"#f8f8f8",thumb:"#eaeaea",circle:"#fff",circleHover:"#eaeaea",arrow:"#a6a6a6",grip:"#a6a6a6"};break;case"MaterialDark":t={backRect:"#424242",thumb:"#616161",circle:"#757575",circleHover:"#616161",arrow:"#BDBDBD",grip:"#BDBDBD"};break;case"FabricDark":t={backRect:"#282727",thumb:"#333232",circle:"#4A4848",circleHover:"#514F4F",arrow:"#ADB5BD",grip:"#DADADA"};break;case"BootstrapDark":t={backRect:"#2A2A2A",thumb:"#313131",circle:"#414141",circleHover:"#484848",arrow:"#DADADA",grip:"#FFFFFF"};break;case"Bootstrap5Dark":t={backRect:"#282D31",thumb:"#3B4248",circle:"#495057",circleHover:"#6C757D",arrow:"#A19F9D",grip:"#ADB5BD"};break;case"HighContrast":t={backRect:"#757575",thumb:"#BFBFBF",circle:"#FFFFFF",circleHover:"#FFFFFF",arrow:"#ADB5BD",grip:"#969696"};break;case"TailwindDark":t={backRect:"#6B7280",thumb:"#374151",circle:"#4B5563",circleHover:"#4B5563",arrow:"#ADB5BD",grip:"#D1D5DB"};break;case"Fluent":t={backRect:"#F3F2F1",thumb:"#E1DFDD",circle:"#FFFFFF",circleHover:"#E1DFDD",arrow:"#605E5C",grip:"#605E5C"};break;case"FluentDark":t={backRect:"#252423",thumb:"#323130",circle:"#3B3A39",circleHover:"#3B3A39",arrow:"#ADB5BD",grip:"#A19F9D"};break;default:t={backRect:"#f5f5f5",thumb:"#e0e0e0",circle:"#fff",circleHover:"#eee",arrow:"#9e9e9e",grip:"#9e9e9e"}}return t}(this.component.theme)},e.prototype.removeScrollSvg=function(){document.getElementById(this.component.element.id+"_scrollBar_svg"+this.axis.name)&&sf.base.remove(document.getElementById(this.component.element.id+"_scrollBar_svg"+this.axis.name))},e.prototype.setCursor=function(e){var t=e.id;this.svgObject.style.cursor=t.indexOf("scrollBarThumb_")>-1||t.indexOf("_gripCircle")>-1?"-webkit-grab":t.indexOf("Circle_")>-1||t.indexOf("Arrow_")>-1?this.isVertical?"ns-resize":"ew-resize":"auto"},e.prototype.setTheme=function(e){var t=e.id,i=t.indexOf("_leftCircle_")>-1||t.indexOf("_leftArrow_")>-1,r=t.indexOf("_rightCircle_")>-1||t.indexOf("_rightArrow_")>-1,n=this.scrollbarThemeStyle,o=this.scrollElements.leftArrowEle,s=this.scrollElements.rightArrowEle,a=this.scrollElements.leftCircleEle,l=this.scrollElements.rightCircleEle,h=this.isCurrentAxis(e,o);a.style.fill=i&&h?n.circleHover:n.circle,l.style.fill=r&&h?n.circleHover:n.circle,a.style.stroke=i&&h?n.circleHover:n.circle,l.style.stroke=r&&h?n.circleHover:n.circle,"HighContrastLight"===this.component.theme&&(o.style.fill=i&&h?n.arrowHover:n.arrow,o.style.stroke=i&&h?n.arrowHover:n.arrow,s.style.fill=r&&h?n.arrowHover:n.arrow,s.style.stroke=r&&h?n.arrowHover:n.arrow,a.style.stroke=i&&h?n.circleHover:n.circle,l.style.stroke=r&&h?n.circleHover:n.circle)},e.prototype.isCurrentAxis=function(e,t){return e.id.split("_")[2]===t.id.split("_")[2]},e.prototype.resizeThumb=function(){var e,t=this.previousRectX,i=this.axis.isAxisInverse,r=this.isVertical&&i?this.mouseY:this.isVertical?this.width-this.mouseY:i?this.width-this.mouseX:this.mouseX,n=Math.abs(this.previousXY-r);if(this.isResizeLeft&&r>=0){var o=t+(r>this.previousXY?n:-n);e=o-8>=0?this.previousWidth+(r>this.previousXY?-n:n):this.previousWidth,o=o-8>=0?o:t,e>=40&&r<o+e&&(this.scrollElements.thumbRectX=this.previousRectX=o,this.scrollElements.thumbRectWidth=this.previousWidth=e,this.previousXY=r,this.positionThumb(o,e),this.setZoomFactorPosition(o,e))}else this.isResizeRight&&(e=r>=40+this.scrollElements.thumbRectX&&r<=this.width-8?r-this.scrollElements.thumbRectX:this.previousWidth,this.scrollElements.thumbRectWidth=this.previousWidth=e,this.previousXY=r,this.positionThumb(this.startX,e),this.setZoomFactorPosition(this.startX,e),this.isLazyLoad||this.setZoomFactorPosition(this.startX,e))},e.prototype.positionThumb=function(e,t){var i=this.scrollElements;i.slider.setAttribute("x",e.toString()),i.slider.setAttribute("width",t.toString()),i.leftCircleEle.setAttribute("cx",e.toString()),i.rightCircleEle.setAttribute("cx",(e+t).toString()),i.setArrowDirection(e,t,this.height),i.gripCircle.setAttribute("transform","translate("+(e+t/2+5*(this.isVertical?1:-1))+","+(this.isVertical?"10":"5")+") rotate("+(this.isVertical?"180":"0")+")")},e.prototype.getDefaults=function(){var e=this.axis;this.axis.scrollbarSettings.enable&&(this.isLazyLoad=!0,this.getLazyDefaults(e)),this.isVertical="Vertical"===e.orientation,this.zoomFactor=this.isLazyLoad?this.zoomFactor:e.zoomFactor,this.zoomPosition=this.isLazyLoad?this.zoomPosition:e.zoomPosition;var t=this.zoomFactor*(this.isVertical?e.rect.height:e.rect.width);t=t>40?t:40,this.scrollX=e.rect.x,this.scrollY=e.rect.y,this.width=this.isVertical?e.rect.height:e.rect.width,this.height=16;var i=this.zoomPosition*(this.isVertical?e.rect.height:this.width),r=this.width-40-8;this.scrollElements.thumbRectX=i>r?r:i<8?8:i,this.scrollElements.thumbRectWidth=t+this.scrollElements.thumbRectX<this.width-16?t:this.width-this.scrollElements.thumbRectX-8},e.prototype.getLazyDefaults=function(e){var t,i,r=e.valueType,n=e.scrollbarSettings,o=e.scrollbarSettings.range,s=e.visibleRange,a=e.scrollbarSettings.pointsLength;this.valueType=r=n.range.minimum&&n.range.maximum||!n.pointsLength?r:"Double";var l={skeleton:"full",type:"dateTime"},h=this.component.intl.getDateParser(l),d=this.component.intl.getDateFormat(l);switch(r){case"Double":case"Category":case"Logarithmic":t=o.minimum?o.minimum:a?0:s.min,i=o.maximum?o.maximum:a?a-1:s.max;break;case"DateTime":case"DateTimeCategory":t=o.minimum?Date.parse(h(d(o.minimum))):s.min,i=o.maximum?Date.parse(h(d(o.maximum))):s.max}t=Math.min(t,s.min),i=Math.max(i,s.max);var c=(s.max-s.min)/(i-t),p=(s.min-t)/(i-t);this.zoomFactor=o.minimum||o.maximum?c:this.axis.maxPointLength/e.scrollbarSettings.pointsLength,this.zoomPosition=o.minimum||o.maximum?p:e.zoomPosition,this.scrollRange.min=t,this.scrollRange.max=i,this.scrollRange.delta=i-t,this.previousStart=s.min,this.previousEnd=s.max},e.prototype.getLogRange=function(e){var t=e.scrollbarSettings.range,i=re(t.minimum,e.logBase),r=re(t.maximum,e.logBase);return i=isFinite(i)?i:t.minimum,r=isFinite(i)?r:t.maximum,{minimum:Math.floor(i/1),maximum:Math.ceil(r/1)}},e.prototype.injectTo=function(t,i){t.zoomingScrollBar=new e(i,t)},e.prototype.destroy=function(){var e=this;this.axes?this.axes.map((function(e){e.zoomingScrollBar.destroy()})):(this.elements.map((function(t){e.unWireEvents(t),sf.base.remove(t.firstChild)})),this.elements=[])},e.prototype.getModuleName=function(){return"ScrollBar"},e.prototype.getArgs=function(e,t,i,r,n){return{axis:this.component.isBlazor?{}:this.axis,name:e,range:this.axis.visibleRange,zoomFactor:this.axis.zoomFactor,zoomPosition:this.axis.zoomPosition,previousRange:t,previousZoomFactor:r,previousZoomPosition:i,currentRange:n}},e}(),Go=(Yo=function(e,t){return(Yo=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}Yo(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),Xo=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.paretoAxes=[],t}return Go(t,e),t.prototype.initSeries=function(e,t){var i=new pr(t,"series",e.properties,!0);i.name="Pareto",i.yAxisName=e.yAxisName+"_CumulativeAxis",i.category="Pareto",e.category="Pareto",i.type="Line",i.interior=t.themeStyle.errorBar,t.visibleSeries.push(i),this.initAxis(e,i,t)},t.prototype.initAxis=function(e,t,i){if(!this.paretoAxes.some((function(e){return e.name===t.yAxisName}))){var r=e.yAxisName?i.axes.filter((function(t){return t.name===e.yAxisName}))[0]:i.primaryYAxis,n=new X(i,"axis",{name:t.yAxisName,majorGridLines:{width:0},majorTickLines:r.majorTickLines,lineStyle:r.lineStyle,minimum:0,maximum:100,rowIndex:r.rowIndex,opposedPosition:!0,labelFormat:"{value}%"});this.paretoAxes.push(n)}},t.prototype.render=function(e){e.chart.columnSeriesModule.render(e)},t.prototype.performCumulativeCalculation=function(e,t){for(var i=e,r=0,n=0,o=i.length,s=0;s<o;s++)r+=i[s][t.yName];for(s=0;s<o;s++)n+=i[s][t.yName],i[s][t.yName]=Math.round(n/r*100);return i},t.prototype.doAnimation=function(e){this.animate(e)},t.prototype.getModuleName=function(){return"ParetoSeries"},t.prototype.destroy=function(){},t}(Gr),Zo=function(){function e(e){this.chart=e}return e.prototype.export=function(e,t,i,r,n,o,s,a,l){var h=new Or(this.chart);r=r||[this.chart];var d={cancel:!1,name:"beforeExport",width:n,height:o};this.chart.trigger("beforeExport",d),d.cancel||h.export(e,t,i,r,n=d.width,o=d.height,s,a,l)},e.prototype.getDataUrl=function(e){return new Or(e).getDataUrl(e)},e.prototype.getModuleName=function(){return"Export"},e.prototype.destroy=function(){},e}();return Dr.Inject(qr,Cn,Zr,_n,qn,Vr,en,qo,yn,bn,fn,Sn,xn,Nn,rn,cn,Tn,Hn,Mo,vo,jr,Wr,Hr,Eo,Io,Lo,Oo,Wo,Fn,En,An,kn,Un,un,an,hn,Kn,to,$n,ro,mo,oo,ho,ao,po,go,jo,Yn,Fo,yo,_r,_o,Ho,Vo,Xo,Zo,To,Ao),e.RangeColorSetting=Ar,e.CrosshairSettings=Lr,e.ZoomSettings=Fr,e.Chart=Dr,e.Row=H,e.Column=B,e.MajorGridLines=_,e.MinorGridLines=V,e.AxisLine=Y,e.MajorTickLines=Q,e.MinorTickLines=q,e.CrosshairTooltip=G,e.Axis=X,e.VisibleLabels=Z,e.Double=C,e.DateTime=Wr,e.Category=jr,e.Logarithmic=Hr,e.DateTimeCategory=_r,e.NiceInterval=zr,e.StripLine=Vr,e.Connector=h,e.Font=d,e.Border=c,e.Offset=p,e.ChartArea=u,e.Margin=g,e.ContainerPadding=f,e.Animation=m,e.Indexes=y,e.CornerRadius=v,e.Index=b,e.EmptyPointSettings=w,e.DragSettings=x,e.TooltipSettings=M,e.Periods=N,e.PeriodSelectorSettings=I,e.LineSeries=qr,e.ColumnSeries=Zr,e.AreaSeries=en,e.BarSeries=rn,e.PolarSeries=an,e.RadarSeries=hn,e.StackingBarSeries=cn,e.CandleSeries=un,e.StackingColumnSeries=fn,e.StepLineSeries=yn,e.StepAreaSeries=bn,e.StackingAreaSeries=xn,e.StackingStepAreaSeries=Nn,e.StackingLineSeries=Sn,e.ScatterSeries=Cn,e.RangeColumnSeries=Tn,e.WaterfallSeries=An,e.HiloSeries=Fn,e.HiloOpenCloseSeries=En,e.RangeAreaSeries=kn,e.SplineRangeAreaSeries=Un,e.BubbleSeries=Hn,e.SplineSeries=_n,e.HistogramSeries=Yn,e.SplineAreaSeries=qn,e.TechnicalIndicator=Cr,e.SmaIndicator=Kn,e.EmaIndicator=$n,e.TmaIndicator=to,e.AccumulationDistributionIndicator=ro,e.AtrIndicator=oo,e.MomentumIndicator=ao,e.RsiIndicator=ho,e.StochasticIndicator=po,e.BollingerBands=go,e.MacdIndicator=mo,e.Trendlines=yo,e.sort=J,e.isBreakLabel=$,e.getVisiblePoints=ee,e.rotateTextSize=te,e.removeElement=ie,e.logBase=re,e.showTooltip=ne,e.inside=oe,e.withIn=se,e.logWithIn=ae,e.withInRange=le,e.sum=he,e.subArraySum=de,e.subtractThickness=ce,e.subtractRect=function(e,t){return e.x+=t.x,e.y+=t.y,e.width-=t.x+t.width,e.height-=t.y+t.height,e},e.degreeToLocation=pe,e.degreeToRadian=ue,e.getRotatedRectangleCoordinates=ge,e.isRotatedRectIntersect=fe,e.getAngle=function(e,t){var i=Math.atan2(t.y-e.y,t.x-e.x);return(i=i<0?6.283+i:i)*(180/Math.PI)},e.subArray=me,e.valueToCoefficient=ye,e.TransformToVisible=ve,e.indexFinder=function(e,t){void 0===t&&(t=!1);var i=["NaN","NaN"];return e.indexOf("_Point_")>-1?i=e.split("_Series_")[1].split("_Point_"):e.indexOf("_shape_")>-1&&(!t||t&&-1===e.indexOf("_legend_"))?(i=e.split("_shape_"))[0]="0":e.indexOf("_text_")>-1&&(!t||t&&-1===e.indexOf("_legend_"))&&((i=e.split("_text_"))[0]="0"),new b(parseInt(i[0],10),parseInt(i[1],10))},e.CoefficientToVector=be,e.valueToPolarCoefficient=we,e.Mean=xe,e.PolarArc=Me,e.createTooltip=Ne,e.createZoomingLabels=Ie,e.findCrosshairDirection=Se,e.withInBounds=Ce,e.getValueXByPoint=Oe,e.getValueYByPoint=Te,e.findClipRect=Pe,e.firstToLowerCase=Ae,e.getTransform=Le,e.getMinPointsDelta=Fe,e.getAnimationFunction=De,e.linear=Ee,e.markerAnimate=ze,e.animateRectElement=ke,e.pathAnimation=We,e.appendClipElement=Re,e.triggerLabelRender=je,e.setRange=Ue,e.isZoomSet=He,e.getActualDesiredIntervalsCount=Be,e.templateAnimate=_e,e.drawSymbol=Ve,e.calculateShapes=Ye,e.getRectLocation=Qe,e.minMax=qe,e.getElement=Ge,e.getTemplateFunction=Xe,e.accReactTemplate=Ze,e.chartReactTemplate=Ke,e.createTemplate=Je,e.getFontStyle=$e,e.measureElementRect=et,e.findlElement=tt,e.getPoint=it,e.appendElement=rt,e.appendChildElement=nt,e.getDraggedRectLocation=ot,e.checkBounds=st,e.getLabelText=at,e.stopTimer=lt,e.isCollide=ht,e.isOverlap=dt,e.containsRect=function(e,t){return e.x<=t.x&&e.x+e.width>=t.x+t.width&&e.y<=t.y&&e.height+e.y>=t.y+t.height},e.calculateRect=ct,e.convertToHexCode=pt,e.componentToHex=ut,e.convertHexToColor=gt,e.colorNameToHex=ft,e.getSaturationColor=mt,e.getMedian=yt,e.calculateLegendShapes=vt,e.textTrim=bt,e.lineBreakLabelTrim=wt,e.stringToNumber=xt,e.redrawElement=Mt,e.animateRedrawElement=Nt,e.textElement=It,e.calculateSize=St,e.createSvg=Ct,e.getTitle=Ot,e.titlePositionX=Tt,e.textWrap=Pt,e.textWrapAnyWhere=At,e.getUnicodeText=Lt,e.blazorTemplatesReset=Ft,e.CustomizeOption=Dt,e.StackValues=Et,e.RectOption=zt,e.ImageOption=kt,e.CircleOption=Wt,e.PolygonOption=Rt,e.ChartLocation=jt,e.LabelLocation=Ut,e.Thickness=Ht,e.ColorValue=Bt,e.PointData=_t,e.AccPointData=Vt,e.ControlPoints=Yt,e.getColorByValue=Qt,e.getGradientColor=qt,e.getPercentageColor=Gt,e.getPercentage=Xt,e.getTextAnchor=Zt,e.Crosshair=vo,e.Tooltip=Mo,e.Zoom=Io,e.Selection=Oo,e.DataEditing=To,e.Highlight=Ao,e.DataLabel=Lo,e.ErrorBar=Fo,e.DataLabelSettings=nr,e.MarkerSettings=or,e.Points=sr,e.Trendline=ar,e.ErrorBarCapSettings=lr,e.ChartSegment=hr,e.ErrorBarSettings=dr,e.SeriesBase=cr,e.Series=pr,e.Legend=Eo,e.ChartAnnotation=Wo,e.ChartAnnotationSettings=F,e.LabelBorder=D,e.MultiLevelCategories=E,e.StripLineSettings=z,e.MultiLevelLabels=k,e.ScrollbarSettingsRange=W,e.ScrollbarSettings=R,e.BoxAndWhiskerSeries=jo,e.MultiColoredAreaSeries=Ho,e.MultiColoredLineSeries=_o,e.MultiColoredSeries=Jr,e.MultiLevelLabel=Vo,e.ScrollBar=qo,e.ParetoSeries=Xo,e.Export=Zo,e}({}))},"./modules/compression.js":function(e,t){window.sf=window.sf||{},window.sf.compression=function(e){"use strict";var t=new Int16Array(286),i=new Uint8Array(286),r=new Int16Array(30),n=new Uint8Array(30),o=function(){function e(t){this.pendingBuffer=new Uint8Array(65536),this.pendingBufLength=0,this.pendingBufCache=0,this.pendingBufBitsInCache=0,this.bufferPosition=0,this.extraBits=0,this.currentHash=0,this.matchStart=0,this.matchLength=0,this.matchPrevAvail=!1,this.blockStart=0,this.stringStart=0,this.lookAhead=0,this.totalBytesIn=0,this.inputOffset=0,this.inputEnd=0,this.windowSize=32768,this.windowMask=this.windowSize-1,this.hashSize=32768,this.hashMask=this.hashSize-1,this.hashShift=Math.floor(17/3),this.maxDist=this.windowSize-262,this.checkSum=1,this.noWrap=!1,e.isHuffmanTreeInitiated||(e.initHuffmanTree(),e.isHuffmanTreeInitiated=!0),this.treeLiteral=new s(this,286,257,15),this.treeDistances=new s(this,30,1,15),this.treeCodeLengths=new s(this,19,4,7),this.arrDistances=new Uint16Array(16384),this.arrLiterals=new Uint8Array(16384),this.stream=[],this.dataWindow=new Uint8Array(2*this.windowSize),this.hashHead=new Int16Array(this.hashSize),this.hashPrevious=new Int16Array(this.windowSize),this.blockStart=this.stringStart=1,this.noWrap=t,t||this.writeZLibHeader()}return Object.defineProperty(e.prototype,"compressedData",{get:function(){return this.stream},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"getCompressedString",{get:function(){var e="";if(void 0!==this.stream)for(var t=0;t<this.stream.length;t++)e+=String.fromCharCode.apply(null,this.stream[t]);return e},enumerable:!0,configurable:!0}),e.prototype.write=function(e,t,i){if(null==e)throw new Error("ArgumentException: data cannot null or undefined");var r=t+i;if(0>t||t>r||r>e.length)throw new Error("ArgumentOutOfRangeException: Offset or length is incorrect");if("string"==typeof e){var n=new sf.fileutils.Encoding(!1);n.type="Utf8",r=t+(e=new Uint8Array(n.getBytes(e,0,e.length))).length}for(this.inputBuffer=e,this.inputOffset=t,this.inputEnd=r,this.noWrap||(this.checkSum=a.checksumUpdate(this.checkSum,this.inputBuffer,this.inputOffset,r));this.inputEnd!==this.inputOffset||0!==this.pendingBufLength;)this.pendingBufferFlush(),this.compressData(!1)},e.prototype.writeZLibHeader=function(){var e=30720;e|=64,e+=31-e%31,this.pendingBufferWriteShortBytes(e)},e.prototype.pendingBufferWriteShortBytes=function(e){this.pendingBuffer[this.pendingBufLength++]=e>>8,this.pendingBuffer[this.pendingBufLength++]=e},e.prototype.compressData=function(e){var t;do{this.fillWindow();var i=e&&this.inputEnd===this.inputOffset;t=this.compressSlow(i,e)}while(0===this.pendingBufLength&&t);return t},e.prototype.compressSlow=function(e,t){if(this.lookAhead<262&&!e)return!1;for(;this.lookAhead>=262||e;){if(0===this.lookAhead)return this.lookAheadCompleted(t);this.stringStart>=2*this.windowSize-262&&this.slideWindow();var i=this.matchStart,r=this.matchLength;if(this.lookAhead>=3&&this.discardMatch(),r>=3&&this.matchLength<=r?r=this.matchPreviousBest(i,r):this.matchPreviousAvailable(),this.bufferPosition>=16384)return this.huffmanIsFull(t)}return!0},e.prototype.discardMatch=function(){var e=this.insertString();0!==e&&this.stringStart-e<=this.maxDist&&this.findLongestMatch(e)&&this.matchLength<=5&&3===this.matchLength&&this.stringStart-this.matchStart>4096&&(this.matchLength=2)},e.prototype.matchPreviousAvailable=function(){this.matchPrevAvail&&this.huffmanTallyLit(255&this.dataWindow[this.stringStart-1]),this.matchPrevAvail=!0,this.stringStart++,this.lookAhead--},e.prototype.matchPreviousBest=function(e,t){this.huffmanTallyDist(this.stringStart-1-e,t),t-=2;do{this.stringStart++,this.lookAhead--,this.lookAhead>=3&&this.insertString()}while(--t>0);return this.stringStart++,this.lookAhead--,this.matchPrevAvail=!1,this.matchLength=2,t},e.prototype.lookAheadCompleted=function(e){return this.matchPrevAvail&&this.huffmanTallyLit(255&this.dataWindow[this.stringStart-1]),this.matchPrevAvail=!1,this.huffmanFlushBlock(this.dataWindow,this.blockStart,this.stringStart-this.blockStart,e),this.blockStart=this.stringStart,!1},e.prototype.huffmanIsFull=function(e){var t=this.stringStart-this.blockStart;this.matchPrevAvail&&t--;var i=e&&0===this.lookAhead&&!this.matchPrevAvail;return this.huffmanFlushBlock(this.dataWindow,this.blockStart,t,i),this.blockStart+=t,!i},e.prototype.fillWindow=function(){for(this.stringStart>=this.windowSize+this.maxDist&&this.slideWindow();this.lookAhead<262&&this.inputOffset<this.inputEnd;){var e=2*this.windowSize-this.lookAhead-this.stringStart;e>this.inputEnd-this.inputOffset&&(e=this.inputEnd-this.inputOffset),this.dataWindow.set(this.inputBuffer.subarray(this.inputOffset,this.inputOffset+e),this.stringStart+this.lookAhead),this.inputOffset+=e,this.totalBytesIn+=e,this.lookAhead+=e}this.lookAhead>=3&&this.updateHash()},e.prototype.slideWindow=function(){this.dataWindow.set(this.dataWindow.subarray(this.windowSize,this.windowSize+this.windowSize),0),this.matchStart-=this.windowSize,this.stringStart-=this.windowSize,this.blockStart-=this.windowSize;for(var e=0;e<this.hashSize;++e){var t=65535&this.hashHead[e];this.hashHead[e]=t>=this.windowSize?t-this.windowSize:0}for(e=0;e<this.windowSize;e++){t=65535&this.hashPrevious[e];this.hashPrevious[e]=t>=this.windowSize?t-this.windowSize:0}},e.prototype.insertString=function(){var e,t=(this.currentHash<<this.hashShift^this.dataWindow[this.stringStart+2])&this.hashMask;return this.hashPrevious[this.stringStart&this.windowMask]=e=this.hashHead[t],this.hashHead[t]=this.stringStart,this.currentHash=t,65535&e},e.prototype.findLongestMatch=function(e){var t,i=4096,r=258,n=this.stringStart,o=this.stringStart+this.matchLength,s=Math.max(this.matchLength,2),a=Math.max(this.stringStart-this.maxDist,0),l=this.stringStart+258-1,h=this.dataWindow[o-1],d=this.dataWindow[o],c=this.dataWindow;s>=32&&(i>>=2),r>this.lookAhead&&(r=this.lookAhead);do{if(c[e+s]===d&&c[e+s-1]===h&&c[e]===c[n]&&c[e+1]===c[n+1]){for(t=e+2,n+=2;c[++n]===c[++t]&&c[++n]===c[++t]&&c[++n]===c[++t]&&c[++n]===c[++t]&&c[++n]===c[++t]&&c[++n]===c[++t]&&c[++n]===c[++t]&&c[++n]===c[++t]&&n<l;);if(n>o){if(this.matchStart=e,o=n,(s=n-this.stringStart)>=r)break;h=c[o-1],d=c[o]}n=this.stringStart}}while((e=65535&this.hashPrevious[e&this.windowMask])>a&&0!=--i);return this.matchLength=Math.min(s,this.lookAhead),this.matchLength>=3},e.prototype.updateHash=function(){this.currentHash=this.dataWindow[this.stringStart]<<this.hashShift^this.dataWindow[this.stringStart+1]},e.prototype.huffmanTallyLit=function(e){return this.arrDistances[this.bufferPosition]=0,this.arrLiterals[this.bufferPosition++]=e,this.treeLiteral.codeFrequencies[e]++,this.bufferPosition>=16384},e.prototype.huffmanTallyDist=function(e,t){this.arrDistances[this.bufferPosition]=e,this.arrLiterals[this.bufferPosition++]=t-3;var i=this.huffmanLengthCode(t-3);this.treeLiteral.codeFrequencies[i]++,i>=265&&i<285&&(this.extraBits+=Math.floor((i-261)/4));var r=this.huffmanDistanceCode(e-1);return this.treeDistances.codeFrequencies[r]++,r>=4&&(this.extraBits+=Math.floor(r/2-1)),this.bufferPosition>=16384},e.prototype.huffmanFlushBlock=function(e,o,a,l){this.treeLiteral.codeFrequencies[256]++,this.treeLiteral.buildTree(),this.treeDistances.buildTree(),this.treeLiteral.calculateBLFreq(this.treeCodeLengths),this.treeDistances.calculateBLFreq(this.treeCodeLengths),this.treeCodeLengths.buildTree();for(var h=4,d=18;d>h;d--)this.treeCodeLengths.codeLengths[s.huffCodeLengthOrders[d]]>0&&(h=d+1);var c=14+3*h+this.treeCodeLengths.getEncodedLength()+this.treeLiteral.getEncodedLength()+this.treeDistances.getEncodedLength()+this.extraBits,p=this.extraBits;for(d=0;d<286;d++)p+=this.treeLiteral.codeFrequencies[d]*i[d];for(d=0;d<30;d++)p+=this.treeDistances.codeFrequencies[d]*n[d];c>=p&&(c=p),o>=0&&a+4<c>>3?this.huffmanFlushStoredBlock(e,o,a,l):c==p?(this.pendingBufferWriteBits(2+(l?1:0),3),this.treeLiteral.setStaticCodes(t,i),this.treeDistances.setStaticCodes(r,n),this.huffmanCompressBlock(),this.huffmanReset()):(this.pendingBufferWriteBits(4+(l?1:0),3),this.huffmanSendAllTrees(h),this.huffmanCompressBlock(),this.huffmanReset())},e.prototype.huffmanFlushStoredBlock=function(e,t,i,r){this.pendingBufferWriteBits(0+(r?1:0),3),this.pendingBufferAlignToByte(),this.pendingBufferWriteShort(i),this.pendingBufferWriteShort(~i),this.pendingBufferWriteByteBlock(e,t,i),this.huffmanReset()},e.prototype.huffmanLengthCode=function(e){if(255===e)return 285;for(var t=257;e>=8;)t+=4,e>>=1;return t+e},e.prototype.huffmanDistanceCode=function(e){for(var t=0;e>=4;)t+=2,e>>=1;return t+e},e.prototype.huffmanSendAllTrees=function(e){this.treeCodeLengths.buildCodes(),this.treeLiteral.buildCodes(),this.treeDistances.buildCodes(),this.pendingBufferWriteBits(this.treeLiteral.treeLength-257,5),this.pendingBufferWriteBits(this.treeDistances.treeLength-1,5),this.pendingBufferWriteBits(e-4,4);for(var t=0;t<e;t++)this.pendingBufferWriteBits(this.treeCodeLengths.codeLengths[s.huffCodeLengthOrders[t]],3);this.treeLiteral.writeTree(this.treeCodeLengths),this.treeDistances.writeTree(this.treeCodeLengths)},e.prototype.huffmanReset=function(){this.bufferPosition=0,this.extraBits=0,this.treeLiteral.reset(),this.treeDistances.reset(),this.treeCodeLengths.reset()},e.prototype.huffmanCompressBlock=function(){for(var e=0;e<this.bufferPosition;e++){var t=255&this.arrLiterals[e],i=this.arrDistances[e];if(0!=i--){var r=this.huffmanLengthCode(t);this.treeLiteral.writeCodeToStream(r);var n=Math.floor((r-261)/4);n>0&&n<=5&&this.pendingBufferWriteBits(t&(1<<n)-1,n);var o=this.huffmanDistanceCode(i);this.treeDistances.writeCodeToStream(o),(n=Math.floor(o/2-1))>0&&this.pendingBufferWriteBits(i&(1<<n)-1,n)}else this.treeLiteral.writeCodeToStream(t)}this.treeLiteral.writeCodeToStream(256)},e.prototype.pendingBufferWriteBits=function(e,t){var i=new Uint32Array(1);i[0]=this.pendingBufCache|e<<this.pendingBufBitsInCache,this.pendingBufCache=i[0],this.pendingBufBitsInCache+=t,this.pendingBufferFlushBits()},e.prototype.pendingBufferFlush=function(e){if(this.pendingBufferFlushBits(),this.pendingBufLength>0){var t=new Uint8Array(this.pendingBufLength);t.set(this.pendingBuffer.subarray(0,this.pendingBufLength),0),this.stream.push(t)}this.pendingBufLength=0},e.prototype.pendingBufferFlushBits=function(){for(var e=0;this.pendingBufBitsInCache>=8&&this.pendingBufLength<65536;)this.pendingBuffer[this.pendingBufLength++]=this.pendingBufCache,this.pendingBufCache>>=8,this.pendingBufBitsInCache-=8,e++;return e},e.prototype.pendingBufferWriteByteBlock=function(e,t,i){var r=e.subarray(t,t+i);this.pendingBuffer.set(r,this.pendingBufLength),this.pendingBufLength+=i},e.prototype.pendingBufferWriteShort=function(e){this.pendingBuffer[this.pendingBufLength++]=e,this.pendingBuffer[this.pendingBufLength++]=e>>8},e.prototype.pendingBufferAlignToByte=function(){this.pendingBufBitsInCache>0&&(this.pendingBuffer[this.pendingBufLength++]=this.pendingBufCache),this.pendingBufCache=0,this.pendingBufBitsInCache=0},e.initHuffmanTree=function(){for(var e=0;e<144;)t[e]=s.bitReverse(48+e<<8),i[e++]=8;for(;e<256;)t[e]=s.bitReverse(256+e<<7),i[e++]=9;for(;e<280;)t[e]=s.bitReverse(-256+e<<9),i[e++]=7;for(;e<286;)t[e]=s.bitReverse(-88+e<<8),i[e++]=8;for(e=0;e<30;e++)r[e]=s.bitReverse(e<<11),n[e]=5},e.prototype.close=function(){do{this.pendingBufferFlush(!0),this.compressData(!0)||(this.pendingBufferFlush(!0),this.pendingBufferAlignToByte(),this.noWrap||(this.pendingBufferWriteShortBytes(this.checkSum>>16),this.pendingBufferWriteShortBytes(65535&this.checkSum)),this.pendingBufferFlush(!0))}while(this.inputEnd!==this.inputOffset||0!==this.pendingBufLength)},e.prototype.destroy=function(){this.stream=[],this.stream=void 0,this.pendingBuffer=void 0,this.treeLiteral=void 0,this.treeDistances=void 0,this.treeCodeLengths=void 0,this.arrLiterals=void 0,this.arrDistances=void 0,this.hashHead=void 0,this.hashPrevious=void 0,this.dataWindow=void 0,this.inputBuffer=void 0,this.pendingBufLength=void 0,this.pendingBufCache=void 0,this.pendingBufBitsInCache=void 0,this.bufferPosition=void 0,this.extraBits=void 0,this.currentHash=void 0,this.matchStart=void 0,this.matchLength=void 0,this.matchPrevAvail=void 0,this.blockStart=void 0,this.stringStart=void 0,this.lookAhead=void 0,this.totalBytesIn=void 0,this.inputOffset=void 0,this.inputEnd=void 0,this.windowSize=void 0,this.windowMask=void 0,this.hashSize=void 0,this.hashMask=void 0,this.hashShift=void 0,this.maxDist=void 0,this.checkSum=void 0,this.noWrap=void 0},e.isHuffmanTreeInitiated=!1,e}(),s=function(){function e(e,t,i,r){this.writer=e,this.codeMinCount=i,this.maxLength=r,this.codeFrequency=new Uint16Array(t),this.lengthCount=new Int32Array(r)}return Object.defineProperty(e.prototype,"treeLength",{get:function(){return this.codeCount},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"codeLengths",{get:function(){return this.codeLength},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"codeFrequencies",{get:function(){return this.codeFrequency},enumerable:!0,configurable:!0}),e.prototype.setStaticCodes=function(e,t){var i=new Int16Array(e.length);i.set(e,0),this.codes=i;var r=new Uint8Array(t.length);r.set(t,0),this.codeLength=r},e.prototype.reset=function(){for(var e=0;e<this.codeFrequency.length;e++)this.codeFrequency[e]=0;this.codes=void 0,this.codeLength=void 0},e.prototype.writeCodeToStream=function(e){this.writer.pendingBufferWriteBits(65535&this.codes[e],this.codeLength[e])},e.prototype.buildCodes=function(){var t=new Int32Array(this.maxLength);this.codes=new Int16Array(this.codeCount);for(var i=0,r=0;r<this.maxLength;r++)t[r]=i,i+=this.lengthCount[r]<<15-r;for(var n=0;n<this.codeCount;n++){var o=this.codeLength[n];o>0&&(this.codes[n]=e.bitReverse(t[o-1]),t[o-1]+=1<<16-o)}},e.bitReverse=function(t){return e.reverseBits[15&t]<<12|e.reverseBits[t>>4&15]<<8|e.reverseBits[t>>8&15]<<4|e.reverseBits[t>>12]},e.prototype.getEncodedLength=function(){for(var e=0,t=0;t<this.codeFrequency.length;t++)e+=this.codeFrequency[t]*this.codeLength[t];return e},e.prototype.calculateBLFreq=function(e){for(var t,i,r,n=-1,o=0;o<this.codeCount;){r=1;var s=this.codeLength[o];for(0===s?(t=138,i=3):(t=6,i=3,n!==s&&(e.codeFrequency[s]++,r=0)),n=s,o++;o<this.codeCount&&n===this.codeLength[o]&&(o++,!(++r>=t)););r<i?e.codeFrequency[n]+=r:0!==n?e.codeFrequency[16]++:r<=10?e.codeFrequency[17]++:e.codeFrequency[18]++}},e.prototype.writeTree=function(e){for(var t,i,r,n=-1,o=0;o<this.codeCount;){r=1;var s=this.codeLength[o];for(0===s?(t=138,i=3):(t=6,i=3,n!==s&&(e.writeCodeToStream(s),r=0)),n=s,o++;o<this.codeCount&&n===this.codeLength[o]&&(o++,!(++r>=t)););if(r<i)for(;r-- >0;)e.writeCodeToStream(n);else 0!==n?(e.writeCodeToStream(16),this.writer.pendingBufferWriteBits(r-3,2)):r<=10?(e.writeCodeToStream(17),this.writer.pendingBufferWriteBits(r-3,3)):(e.writeCodeToStream(18),this.writer.pendingBufferWriteBits(r-11,7))}},e.prototype.buildTree=function(){for(var e=this.codeFrequency.length,t=new Int32Array(e),i=0,r=0,n=0;n<e;n++){var o=this.codeFrequency[n];if(0!==o){for(var s=i++,a=0;s>0&&this.codeFrequency[t[a=Math.floor((s-1)/2)]]>o;)t[s]=t[a],s=a;t[s]=n,r=n}}for(;i<2;)t[i++]=r<2?++r:0;this.codeCount=Math.max(r+1,this.codeMinCount);for(var l=i,h=new Int32Array(4*i-2),d=new Int32Array(2*i-1),c=0;c<i;c++){var p=t[c],u=2*c;h[u]=p,h[u+1]=-1,d[c]=this.codeFrequency[p]<<8,t[c]=c}this.constructHuffmanTree(t,i,d,l,h),this.buildLength(h)},e.prototype.constructHuffmanTree=function(e,t,i,r,n){do{for(var o=e[0],s=e[--t],a=i[s],l=0,h=1;h<t;)h+1<t&&i[e[h]]>i[e[h+1]]&&h++,e[l]=e[h],h=2*(l=h)+1;for(;(h=l)>0&&i[e[l=Math.floor((h-1)/2)]]>a;)e[h]=e[l];e[h]=s;var d=e[0];n[2*(s=r++)]=o,n[2*s+1]=d;var c=Math.min(255&i[o],255&i[d]);for(i[s]=a=i[o]+i[d]-c+1,l=0,h=1;h<t;)h+1<t&&i[e[h]]>i[e[h+1]]&&h++,e[l]=e[h],h=2*(l=h)+1;for(;(h=l)>0&&i[e[l=Math.floor((h-1)/2)]]>a;)e[h]=e[l];e[h]=s}while(t>1)},e.prototype.buildLength=function(e){this.codeLength=new Uint8Array(this.codeFrequency.length);for(var t=Math.floor(e.length/2),i=Math.floor((t+1)/2),r=0,n=0;n<this.maxLength;n++)this.lengthCount[n]=0;if(0!==(r=this.calculateOptimalCodeLength(e,r,t))){var o=this.maxLength-1;do{for(;0===this.lengthCount[--o];);do{this.lengthCount[o]--,this.lengthCount[++o]++,r-=1<<this.maxLength-1-o}while(r>0&&o<this.maxLength-1)}while(r>0);this.recreateTree(e,r,i)}},e.prototype.recreateTree=function(e,t,i){this.lengthCount[this.maxLength-1]+=t,this.lengthCount[this.maxLength-2]-=t;for(var r=2*i,n=this.maxLength;0!==n;n--)for(var o=this.lengthCount[n-1];o>0;){var s=2*e[r++];-1===e[s+1]&&(this.codeLength[e[s]]=n,o--)}},e.prototype.calculateOptimalCodeLength=function(e,t,i){var r=new Int32Array(i);r[i-1]=0;for(var n=i-1;n>=0;n--){var o=2*n+1;if(-1!==e[o]){(s=r[n]+1)>this.maxLength&&(s=this.maxLength,t++),r[e[o-1]]=r[e[o]]=s}else{var s=r[n];this.lengthCount[s-1]++,this.codeLength[e[o-1]]=r[n]}}return t},e.reverseBits=[0,8,4,12,2,10,6,14,1,9,5,13,3,11,7,15],e.huffCodeLengthOrders=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],e}(),a=function(){function e(){}return e.checksumUpdate=function(t,i,r,n){var o=new Uint32Array(1);o[0]=t;for(var s=o[0],a=o[0]=65535&s,l=o[0]=s>>e.checkSumBitOffset;n>0;){var h=Math.min(n,e.checksumIterationCount);for(n-=h;--h>=0;)l+=a+=o[0]=255&i[r++];a%=e.checksumBase,l%=e.checksumBase}return s=l<<e.checkSumBitOffset|a},e.checkSumBitOffset=16,e.checksumBase=65521,e.checksumIterationCount=3800,e}(),l=[],h=function(){function e(){0===l.length&&e.initCrc32Table(),this.files=[],this.level="Normal",sf.fileutils.Save.isMicrosoftBrowser=!!navigator.msSaveBlob}return Object.defineProperty(e.prototype,"compressionLevel",{get:function(){return this.level},set:function(e){this.level=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"length",{get:function(){return void 0===this.files?0:this.files.length},enumerable:!0,configurable:!0}),e.prototype.addItem=function(e){if(null==e)throw new Error("ArgumentException: item cannot be null or undefined");for(var t=0;t<this.files.length;t++){var i=this.files[t];if(i instanceof d&&i.name===e.name)throw new Error("item with same name already exist")}this.files.push(e)},e.prototype.addDirectory=function(e){if(null==e)throw new Error("ArgumentException: string cannot be null or undefined");if(0===e.length)throw new Error("ArgumentException: string cannot be empty");if("/"!==e.slice(-1)&&(e+="/"),-1!==this.files.indexOf(e))throw new Error("item with same name already exist");this.files.push(e)},e.prototype.getItem=function(e){if(e>=0&&e<this.files.length)return this.files[e]},e.prototype.contains=function(e){return-1!==this.files.indexOf(e)},e.prototype.save=function(e){if(null==e||0===e.length)throw new Error("ArgumentException: fileName cannot be null or undefined");if(0===this.files.length)throw new Error("InvalidOperation");var t=this;return new Promise((function(i,r){t.saveInternal(e,!1).then((function(){i(t)}))}))},e.prototype.saveAsBlob=function(){var e=this;return new Promise((function(t,i){e.saveInternal("",!0).then((function(e){t(e)}))}))},e.prototype.saveInternal=function(e,t){var i=this,r=this;return new Promise((function(n,o){for(var s=[],a=0,l=0;l<r.files.length;l++){i.getCompressedData(i.files[l]).then((function(i){if(a=r.constructZippedObject(s,i,a,i.isDirectory),s.length===r.files.length){var o=r.writeZippedContent(e,s,a,t);n(o)}}))}}))},e.prototype.destroy=function(){if(void 0!==this.files&&this.files.length>0){for(var e=0;e<this.files.length;e++){var t=this.files[e];t instanceof d&&t.destroy(),t=void 0}this.files=[]}this.files=void 0,this.level=void 0},e.prototype.getCompressedData=function(e){var t=this;return new Promise((function(i,r){if(e instanceof d){var n=new FileReader;n.onload=function(){var r=new Uint8Array(n.result),o={fileName:e.name,crc32Value:0,compressedData:[],compressedSize:void 0,uncompressedDataSize:r.length,compressionType:void 0,isDirectory:!1};if("Normal"===t.level){t.compressData(r,o,l);for(var s=0,a=0;a<o.compressedData.length;a++)s+=o.compressedData[a].length;o.compressedSize=s,o.compressionType="\b\0"}else o.compressedSize=r.length,o.crc32Value=t.calculateCrc32Value(0,r,l),o.compressionType="\0\0",o.compressedData.push(r);i(o)},n.readAsArrayBuffer(e.data)}else{i({fileName:e,crc32Value:0,compressedData:"",compressedSize:0,uncompressedDataSize:0,compressionType:"\0\0",isDirectory:!0})}}))},e.prototype.compressData=function(e,t,i){var r=new o(!0),n=0,s=0;do{if(n>=e.length){r.close();break}s=Math.min(e.length,n+16384);var a=e.subarray(n,s);t.crc32Value=this.calculateCrc32Value(t.crc32Value,a,i),r.write(a,0,s-n),n=s}while(n<=e.length);t.compressedData=r.compressedData,r.destroy()},e.prototype.constructZippedObject=function(e,t,i,r){var n=0,o=new Date;r&&(n|=16),n|=0;var s=this.writeHeader(t,o),a="PK"+s+t.fileName,l=this.writeCentralDirectory(t,s,i,n);return e.push({localHeader:a,centralDir:l,compressedData:t}),i+a.length+t.compressedSize},e.prototype.writeHeader=function(e,t){var i="";return i+="\n\0\0\0",i+=e.compressionType,i+=this.getBytes(this.getModifiedTime(t),2),i+=this.getBytes(this.getModifiedDate(t),2),i+=this.getBytes(e.crc32Value,4),i+=this.getBytes(e.compressedSize,4),i+=this.getBytes(e.uncompressedDataSize,4),i+=this.getBytes(e.fileName.length,2),i+=this.getBytes(0,2)},e.prototype.writeZippedContent=function(e,t,i,r){for(var n=0,o=[],s=0;s<t.length;s++){var a=t[s];for(n+=a.centralDir.length,o.push(this.getArrayBuffer(a.localHeader));a.compressedData.compressedData.length;)o.push(a.compressedData.compressedData.shift().buffer)}for(s=0;s<t.length;s++)o.push(this.getArrayBuffer(t[s].centralDir));o.push(this.getArrayBuffer(this.writeFooter(t,n,i)));var l=new Blob(o,{type:"application/zip"});return r||sf.fileutils.Save.save(e,l),l},e.prototype.writeCentralDirectory=function(e,t,i,r){return"PK"+this.getBytes(20,2)+t+this.getBytes(0,2)+"\0\0\0\0"+this.getBytes(r,4)+this.getBytes(i,4)+e.fileName},e.prototype.writeFooter=function(e,t,i){return"PK\0\0\0\0"+this.getBytes(e.length,2)+this.getBytes(e.length,2)+this.getBytes(t,4)+this.getBytes(i,4)+this.getBytes(0,2)},e.prototype.getArrayBuffer=function(e){for(var t=new Uint8Array(e.length),i=0;i<e.length;++i)t[i]=255&e.charCodeAt(i);return t.buffer},e.prototype.getBytes=function(e,t){for(var i="",r=0;r<t;r++)i+=String.fromCharCode(255&e),e>>>=8;return i},e.prototype.getModifiedTime=function(e){var t=e.getHours();return t<<=6,t|=e.getMinutes(),(t<<=5)|e.getSeconds()/2},e.prototype.getModifiedDate=function(e){var t=e.getFullYear()-1980;return t<<=4,t|=e.getMonth()+1,(t<<=5)|e.getDate()},e.prototype.calculateCrc32Value=function(e,t,i){e^=-1;for(var r=0;r<t.length;r++)e=e>>>8^i[255&(e^t[r])];return-1^e},e.initCrc32Table=function(){for(var e,t=0;t<256;t++){e=t;for(var i=0;i<8;i++)e=1&e?3988292384^e>>>1:e>>>1;l[t]=e}},e}(),d=function(){function e(e,t){if(null==e)throw new Error("ArgumentException: data cannot be null or undefined");if(null==t)throw new Error("ArgumentException: string cannot be null or undefined");if(0===t.length)throw new Error("string cannot be empty");this.data=e,this.name=t}return Object.defineProperty(e.prototype,"name",{get:function(){return this.fileName},set:function(e){this.fileName=e},enumerable:!0,configurable:!0}),e.prototype.destroy=function(){this.fileName=void 0,this.data=void 0},e}();return e.ZipArchive=h,e.ZipArchiveItem=d,e.CompressedStreamWriter=o,e.CompressorHuffmanTree=s,e.ChecksumCalculator=a,e},sf.compression=sf.compression({})},"./modules/data.js":function(e,t){function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}window.sf=window.sf||{},window.sf.data=function(e){"use strict";var t,r=function(){function e(e){return this.subQuery=null,this.isChild=!1,this.distincts=[],this.queries=[],this.key="",this.fKey="","string"==typeof e?this.fromTable=e:e&&e instanceof Array&&(this.lookups=e),this.expands=[],this.sortedColumns=[],this.groupedColumns=[],this.subQuery=null,this.isChild=!1,this.params=[],this.lazyLoad=[],this}return e.prototype.setKey=function(e){return this.key=e,this},e.prototype.using=function(e){return this.dataManager=e,this},e.prototype.execute=function(e,t,i,r){return(e=e||this.dataManager)?e.executeQuery(this,t,i,r):s.throwError('Query - execute() : dataManager needs to be is set using "using" function or should be passed as argument')},e.prototype.executeLocal=function(e){return(e=e||this.dataManager)?e.executeLocal(this):s.throwError('Query - executeLocal() : dataManager needs to be is set using "using" function or should be passed as argument')},e.prototype.clone=function(){var t=new e;return t.queries=this.queries.slice(0),t.key=this.key,t.isChild=this.isChild,t.dataManager=this.dataManager,t.fromTable=this.fromTable,t.params=this.params.slice(0),t.expands=this.expands.slice(0),t.sortedColumns=this.sortedColumns.slice(0),t.groupedColumns=this.groupedColumns.slice(0),t.subQuerySelector=this.subQuerySelector,t.subQuery=this.subQuery,t.fKey=this.fKey,t.isCountRequired=this.isCountRequired,t.distincts=this.distincts.slice(0),t.lazyLoad=this.lazyLoad.slice(0),t},e.prototype.from=function(e){return this.fromTable=e,this},e.prototype.addParams=function(e,t){return"function"==typeof t?this.params.push({key:e,fn:t}):this.params.push({key:e,value:t}),this},e.prototype.distinct=function(e){return this.distincts="string"==typeof e?[].slice.call([e],0):e.slice(0),this},e.prototype.expand=function(e){return this.expands="string"==typeof e?[].slice.call([e],0):e.slice(0),this},e.prototype.where=function(e,t,i,r,o,s){t=t?t.toLowerCase():null;var a=null;return"string"==typeof e?a=new n(e,t,i,r,o,s):e instanceof n&&(a=e),this.queries.push({fn:"onWhere",e:a}),this},e.prototype.search=function(e,t,i,r,n){"string"==typeof t&&(t=[t]),i&&"none"!==i||(i="contains");var o=s.fnOperators[i];return this.queries.push({fn:"onSearch",e:{fieldNames:t,operator:i,searchKey:e,ignoreCase:r,ignoreAccent:n,comparer:o}}),this},e.prototype.sortBy=function(e,t,i){return this.sortByForeignKey(e,t,i)},e.prototype.sortByForeignKey=function(t,i,r,n){var o,a,l=sf.base.isNullOrUndefined(n)?"ascending":n;if("string"==typeof t&&s.endsWith(t.toLowerCase()," desc")&&(t=t.replace(/ desc$/i,""),i="descending"),i&&"string"!=typeof i||(l=i?i.toLowerCase():"ascending",i=s.fnSort(i)),r){o=e.filterQueries(this.queries,"onSortBy");for(var h=0;h<o.length;h++)if("string"==typeof(a=o[h].e.fieldName)){if(a===t)return this}else if(a instanceof Array)for(var d=0;d<a.length;d++)if(a[d]===t||t.toLowerCase()===a[d]+" desc")return this}return this.queries.push({fn:"onSortBy",e:{fieldName:t,comparer:i,direction:l}}),this},e.prototype.sortByDesc=function(e){return this.sortBy(e,"descending")},e.prototype.group=function(e,t,i){return this.sortBy(e,null,!0),this.queries.push({fn:"onGroup",e:{fieldName:e,comparer:t||null,format:i||null}}),this},e.prototype.page=function(e,t){return this.queries.push({fn:"onPage",e:{pageIndex:e,pageSize:t}}),this},e.prototype.range=function(e,t){return this.queries.push({fn:"onRange",e:{start:e,end:t}}),this},e.prototype.take=function(e){return this.queries.push({fn:"onTake",e:{nos:e}}),this},e.prototype.skip=function(e){return this.queries.push({fn:"onSkip",e:{nos:e}}),this},e.prototype.select=function(e){return"string"==typeof e&&(e=[].slice.call([e],0)),this.queries.push({fn:"onSelect",e:{fieldNames:e}}),this},e.prototype.hierarchy=function(e,t){return this.subQuerySelector=t,this.subQuery=e,this},e.prototype.foreignKey=function(e){return this.fKey=e,this},e.prototype.requiresCount=function(){return this.isCountRequired=!0,this},e.prototype.aggregate=function(e,t){return this.queries.push({fn:"onAggregates",e:{field:t,type:e}}),this},e.filterQueries=function(e,t){return e.filter((function(e){return e.fn===t}))},e.filterQueryLists=function(e,t){for(var i=e.filter((function(e){return-1!==t.indexOf(e.fn)})),r={},n=0;n<i.length;n++)r[i[n].fn]||(r[i[n].fn]=i[n].e);return r},e}(),n=function(){function e(t,i,r,n,o,a){return void 0===n&&(n=!1),this.ignoreAccent=!1,this.isComplex=!1,"string"==typeof t?(this.field=t,this.operator=i.toLowerCase(),this.value=r,this.matchCase=a,this.ignoreCase=n,this.ignoreAccent=o,this.isComplex=!1,this.comparer=s.fnOperators.processOperator(this.operator)):(t instanceof e&&r instanceof e||r instanceof Array)&&(this.isComplex=!0,this.condition=i.toLowerCase(),this.predicates=[t],this.matchCase=t.matchCase,this.ignoreCase=t.ignoreCase,this.ignoreAccent=t.ignoreAccent,r instanceof Array?[].push.apply(this.predicates,r):this.predicates.push(r)),this}return e.and=function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];return e.combinePredicates([].slice.call(t,0),"and")},e.prototype.and=function(t,i,r,n,o){return e.combine(this,t,i,r,"and",n,o)},e.or=function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];return e.combinePredicates([].slice.call(t,0),"or")},e.prototype.or=function(t,i,r,n,o){return e.combine(this,t,i,r,"or",n,o)},e.fromJson=function(e){if(e instanceof Array){for(var t=[],i=0,r=e.length;i<r;i++)t.push(this.fromJSONData(e[i]));return t}var n=e;return this.fromJSONData(n)},e.prototype.validate=function(e){var t,i,r=this.predicates?this.predicates:[];if(!this.isComplex&&this.comparer)return this.comparer.call(this,s.getObject(this.field,e),this.value,this.ignoreCase,this.ignoreAccent);t="and"===this.condition;for(var n=0;n<r.length;n++)if(i=r[n].validate(e),t){if(!i)return!1}else if(i)return!0;return t},e.prototype.toJson=function(){var e,t;if(this.isComplex){e=[],t=this.predicates;for(var i=0;i<t.length;i++)e.push(t[i].toJson())}return{isComplex:this.isComplex,field:this.field,operator:this.operator,value:this.value,ignoreCase:this.ignoreCase,ignoreAccent:this.ignoreAccent,condition:this.condition,predicates:e,matchCase:this.matchCase}},e.combinePredicates=function(t,i){if(1===t.length){if(!(t[0]instanceof Array))return t[0];t=t[0]}return new e(t[0],i,t.slice(1))},e.combine=function(t,i,r,n,o,a,l){return i instanceof e?e[o](t,i):"string"==typeof i?e[o](t,new e(i,r,n,a,l)):s.throwError("Predicate - "+o+" : invalid arguments")},e.fromJSONData=function(t){for(var i=t.predicates||[],r=i.length,n=[],o=0;o<r;o++)n.push(this.fromJSONData(i[o]));return t.isComplex?new e(n[0],t.condition,n.slice(1)):new e(t.field,t.operator,t.value,t.ignoreCase,t.ignoreAccent)},e}(),o={GroupGuid:"{271bbba0-1ee7}"},s=function(){function e(){}return e.getValue=function(e,t){return"function"==typeof e?e.call(t||{}):e},e.endsWith=function(e,t){return e.slice&&e.slice(-t.length)===t},e.startsWith=function(e,t){return e.slice(0,t.length)===t},e.fnSort=function(t){return"ascending"===(t=t?e.toLowerCase(t):"ascending")?this.fnAscending:this.fnDescending},e.fnAscending=function(e,t){return sf.base.isNullOrUndefined(e)&&sf.base.isNullOrUndefined(t)||null==t?-1:"string"==typeof e?e.localeCompare(t):null==e?1:e-t},e.fnDescending=function(e,t){return sf.base.isNullOrUndefined(e)&&sf.base.isNullOrUndefined(t)?-1:null==t?1:"string"==typeof e?-1*e.localeCompare(t):null==e?-1:t-e},e.extractFields=function(e,t){for(var i={},r=0;r<t.length;r++)i=this.setValue(t[r],this.getObject(t[r],e),i);return i},e.select=function(e,t){for(var i=[],r=0;r<e.length;r++)i.push(this.extractFields(e[r],t));return i},e.group=function(t,i,r,n,s,a,l){n=n||1;var h=t;if(h.GroupGuid===o.GroupGuid){for(var d=function(e){if(sf.base.isNullOrUndefined(s))h[e].items=c.group(h[e].items,i,r,h.level+1,null,a,l),h[e].count=h[e].items.length;else{var t,n=s.filter((function(t){return t.key===h[e].key}));t=s.indexOf(n[0]),h[e].items=c.group(h[e].items,i,r,h.level+1,s[t].items,a,l),h[e].count=s[t].count}},c=this,p=0;p<h.length;p++)d(p);return h.childLevels+=1,h}var u={},g=[];g.GroupGuid=o.GroupGuid,g.level=n,g.childLevels=0,g.records=h;for(var f=function(e){var t=m.getVal(h,e,i);if(sf.base.isNullOrUndefined(a)||(t=a(t,i)),!u[t]&&(u[t]={key:t,count:0,items:[],aggregates:{},field:i},g.push(u[t]),!sf.base.isNullOrUndefined(s))){var n=s.filter((function(e){return e.key===u[t].key}));u[t].count=n[0].count}u[t].count=sf.base.isNullOrUndefined(s)?u[t].count+=1:u[t].count,(!l||l&&r.length)&&u[t].items.push(h[e])},m=this,y=0;y<h.length;y++)f(y);if(r&&r.length){var v=function(t){for(var i={},n=void 0,o=r,a=0;a<r.length;a++)if(n=e.aggregates[r[a].type],sf.base.isNullOrUndefined(s))n&&(i[o[a].field+" - "+o[a].type]=n(g[t].items,o[a].field));else{var l=s.filter((function(e){return e.key===g[t].key}));n&&(i[o[a].field+" - "+o[a].type]=n(l[0].items,o[a].field))}g[t].aggregates=i};for(y=0;y<g.length;y++)v(y)}if(l&&g.length&&r.length)for(y=0;y<g.length;y++)g[y].items=[];return h.length&&g||h},e.buildHierarchy=function(e,t,i,r,n){var o,s={};for(r.result&&(r=r.result),r.GroupGuid&&this.throwError("DataManager: Do not have support Grouping in hierarchy"),o=0;o<r.length;o++){(s[a=this.getObject(e,r[o])]||(s[a]=[])).push(r[o])}for(o=0;o<i.length;o++){var a=this.getObject(n||e,i[o]);i[o][t]=s[a]}},e.getFieldList=function(e,t,r){if(void 0===r&&(r=""),null==t)return this.getFieldList(e,[],r);for(var n=e,o=0,s=Object.keys(e);o<s.length;o++){var a=s[o];"object"!==i(n[a])||n[a]instanceof Array?t.push(r+a):this.getFieldList(n[a],t,r+a+".")}return t},e.getObject=function(e,t){if(!e)return t;if(t){if(-1===e.indexOf("."))return t[e];for(var i=t,r=e.split("."),n=0;n<r.length&&null!=i;n++)i=i[r[n]];return i}},e.setValue=function(e,t,i){var r,n,o=e.toString().split("."),s=i||{},a=s,l=o.length;for(r=0;r<l;r++)n=o[r],r+1===l?a[n]=void 0===t?void 0:t:sf.base.isNullOrUndefined(a[n])&&(a[n]={}),a=a[n];return s},e.sort=function(e,t,i){if(e.length<=1)return e;var r=parseInt((e.length/2).toString(),10),n=e.slice(0,r),o=e.slice(r);return n=this.sort(n,t,i),o=this.sort(o,t,i),this.merge(n,o,t,i)},e.ignoreDiacritics=function(t){return"string"!=typeof t?t:t.split("").map((function(t){return t in e.diacritics?e.diacritics[t]:t})).join("")},e.merge=function(e,t,i,r){for(var n,o=[];e.length>0||t.length>0;)n=e.length>0&&t.length>0?r?r(this.getVal(e,0,i),this.getVal(t,0,i),e[0],t[0])<=0?e:t:e[0][i]<e[0][i]?e:t:e.length>0?e:t,o.push(n.shift());return o},e.getVal=function(e,t,i){return i?this.getObject(i,e[t]):e[t]},e.toLowerCase=function(e){return e?"string"==typeof e?e.toLowerCase():e.toString():0===e||!1===e?e.toString():""},e.callAdaptorFunction=function(e,t,i,r){if(t in e){var n=e[t](i,r);sf.base.isNullOrUndefined(n)||(i=n)}return i},e.getAddParams=function(t,i,r){var n={};return e.callAdaptorFunction(t,"addParams",{dm:i,query:r,params:r.params,reqParams:n}),n},e.isPlainObject=function(e){return!!e&&e.constructor===Object},e.isCors=function(){var e=null;try{e=new window.XMLHttpRequest}catch(e){}return!!e&&"withCredentials"in e},e.getGuid=function(e){var t;return(e||"")+"00000000-0000-4000-0000-000000000000".replace(/0/g,(function(e,i){if("crypto"in window&&"getRandomValues"in crypto){var r=new Uint8Array(1);window.crypto.getRandomValues(r),t=r[0]%16|0}else t=16*Math.random()|0;return"0123456789abcdef"[19===i?3&t|8:t]}))},e.isNull=function(e){return null==e},e.getItemFromComparer=function(t,i,r){var n,o,s,a=0,l="string"==typeof e.getVal(t,0,i);if(t.length)for(;sf.base.isNullOrUndefined(n)&&a<t.length;)n=e.getVal(t,a,i),s=t[a++];for(;a<t.length;a++)o=e.getVal(t,a,i),sf.base.isNullOrUndefined(o)||(l&&(n=+n,o=+o),r(n,o)>0&&(n=o,s=t[a]));return s},e.distinct=function(t,r,n){n=!sf.base.isNullOrUndefined(n)&&n;var o,s=[],a={};return t.forEach((function(l,h){(o="object"===i(t[h])?e.getVal(t,h,r):t[h])in a||(s.push(n?t[h]:o),a[o]=1)})),s},e.processData=function(e,t){var i=this.prepareQuery(e),r=new w(t);e.requiresCounts&&i.requiresCount();var n=r.executeLocal(i),o={result:e.requiresCounts?n.result:n,count:n.count,aggregates:JSON.stringify(n.aggregates)};return e.requiresCounts?o:n},e.prepareQuery=function(t){var i=this,o=new r;(t.select&&o.select(t.select),t.where)&&e.parse.parseJson(t.where).filter((function(e){if(sf.base.isNullOrUndefined(e.condition))o.where(e.field,e.operator,e.value,e.ignoreCase,e.ignoreAccent);else{var t=[];e.field?t.push(new n(e.field,e.operator,e.value,e.ignoreCase,e.ignoreAccent)):t=t.concat(i.getPredicate(e.predicates)),"or"==e.condition?o.where(n.or(t)):"and"==e.condition&&o.where(n.and(t))}}));t.search&&e.parse.parseJson(t.search).filter((function(e){return o.search(e.key,e.fields,e.operator,e.ignoreCase,e.ignoreAccent)}));return t.aggregates&&t.aggregates.filter((function(e){return o.aggregate(e.type,e.field)})),t.sorted&&t.sorted.filter((function(e){return o.sortBy(e.name,e.direction)})),t.skip&&o.skip(t.skip),t.take&&o.take(t.take),t.group&&t.group.filter((function(e){return o.group(e)})),o},e.getPredicate=function(e){for(var t=[],i=0;i<e.length;i++){var r=e[i];if(r.field)t.push(new n(r.field,r.operator,r.value,r.ignoreCase,r.ignoreAccent));else{for(var o=[],s=this.getPredicate(r.predicates),a=0,l=Object.keys(s);a<l.length;a++){var h=l[a];o.push(s[h])}t.push("or"==r.condition?n.or(o):n.and(o))}}return t},e.serverTimezoneOffset=null,e.timeZoneHandling=!0,e.throwError=function(e){try{throw new Error(e)}catch(e){throw e.message+"\n"+e.stack}},e.aggregates={sum:function(t,i){for(var r,n=0,o="number"!=typeof e.getVal(t,0,i),s=0;s<t.length;s++)r=e.getVal(t,s,i),isNaN(r)||null===r||(o&&(r=+r),n+=r);return n},average:function(t,i){return e.aggregates.sum(t,i)/t.length},min:function(t,i){var r;return"function"==typeof i&&(r=i,i=null),e.getObject(i,e.getItemFromComparer(t,i,r||e.fnAscending))},max:function(t,i){var r;return"function"==typeof i&&(r=i,i=null),e.getObject(i,e.getItemFromComparer(t,i,r||e.fnDescending))},truecount:function(e,t){return new w(e).executeLocal((new r).where(t,"equal",!0,!0)).length},falsecount:function(e,t){return new w(e).executeLocal((new r).where(t,"equal",!1,!0)).length},count:function(e,t){return e.length}},e.operatorSymbols={"<":"lessthan",">":"greaterthan","<=":"lessthanorequal",">=":"greaterthanorequal","==":"equal","!=":"notequal","*=":"contains","$=":"endswith","^=":"startswith"},e.odBiOperator={"<":" lt ",">":" gt ","<=":" le ",">=":" ge ","==":" eq ","!=":" ne ",lessthan:" lt ",lessthanorequal:" le ",greaterthan:" gt ",greaterthanorequal:" ge ",equal:" eq ",notequal:" ne "},e.odUniOperator={"$=":"endswith","^=":"startswith","*=":"substringof",endswith:"endswith",startswith:"startswith",contains:"substringof"},e.odv4UniOperator={"$=":"endswith","^=":"startswith","*=":"contains",endswith:"endswith",startswith:"startswith",contains:"contains"},e.diacritics={"Ⓐ":"A","Ａ":"A","À":"A","Á":"A","Â":"A","Ầ":"A","Ấ":"A","Ẫ":"A","Ẩ":"A","Ã":"A","Ā":"A","Ă":"A","Ằ":"A","Ắ":"A","Ẵ":"A","Ẳ":"A","Ȧ":"A","Ǡ":"A","Ä":"A","Ǟ":"A","Ả":"A","Å":"A","Ǻ":"A","Ǎ":"A","Ȁ":"A","Ȃ":"A","Ạ":"A","Ậ":"A","Ặ":"A","Ḁ":"A","Ą":"A","Ⱥ":"A","Ɐ":"A","Ꜳ":"AA","Æ":"AE","Ǽ":"AE","Ǣ":"AE","Ꜵ":"AO","Ꜷ":"AU","Ꜹ":"AV","Ꜻ":"AV","Ꜽ":"AY","Ⓑ":"B","Ｂ":"B","Ḃ":"B","Ḅ":"B","Ḇ":"B","Ƀ":"B","Ƃ":"B","Ɓ":"B","Ⓒ":"C","Ｃ":"C","Ć":"C","Ĉ":"C","Ċ":"C","Č":"C","Ç":"C","Ḉ":"C","Ƈ":"C","Ȼ":"C","Ꜿ":"C","Ⓓ":"D","Ｄ":"D","Ḋ":"D","Ď":"D","Ḍ":"D","Ḑ":"D","Ḓ":"D","Ḏ":"D","Đ":"D","Ƌ":"D","Ɗ":"D","Ɖ":"D","Ꝺ":"D","Ǳ":"DZ","Ǆ":"DZ","ǲ":"Dz","ǅ":"Dz","Ⓔ":"E","Ｅ":"E","È":"E","É":"E","Ê":"E","Ề":"E","Ế":"E","Ễ":"E","Ể":"E","Ẽ":"E","Ē":"E","Ḕ":"E","Ḗ":"E","Ĕ":"E","Ė":"E","Ë":"E","Ẻ":"E","Ě":"E","Ȅ":"E","Ȇ":"E","Ẹ":"E","Ệ":"E","Ȩ":"E","Ḝ":"E","Ę":"E","Ḙ":"E","Ḛ":"E","Ɛ":"E","Ǝ":"E","Ⓕ":"F","Ｆ":"F","Ḟ":"F","Ƒ":"F","Ꝼ":"F","Ⓖ":"G","Ｇ":"G","Ǵ":"G","Ĝ":"G","Ḡ":"G","Ğ":"G","Ġ":"G","Ǧ":"G","Ģ":"G","Ǥ":"G","Ɠ":"G","Ꞡ":"G","Ᵹ":"G","Ꝿ":"G","Ⓗ":"H","Ｈ":"H","Ĥ":"H","Ḣ":"H","Ḧ":"H","Ȟ":"H","Ḥ":"H","Ḩ":"H","Ḫ":"H","Ħ":"H","Ⱨ":"H","Ⱶ":"H","Ɥ":"H","Ⓘ":"I","Ｉ":"I","Ì":"I","Í":"I","Î":"I","Ĩ":"I","Ī":"I","Ĭ":"I","İ":"I","Ï":"I","Ḯ":"I","Ỉ":"I","Ǐ":"I","Ȉ":"I","Ȋ":"I","Ị":"I","Į":"I","Ḭ":"I","Ɨ":"I","Ⓙ":"J","Ｊ":"J","Ĵ":"J","Ɉ":"J","Ⓚ":"K","Ｋ":"K","Ḱ":"K","Ǩ":"K","Ḳ":"K","Ķ":"K","Ḵ":"K","Ƙ":"K","Ⱪ":"K","Ꝁ":"K","Ꝃ":"K","Ꝅ":"K","Ꞣ":"K","Ⓛ":"L","Ｌ":"L","Ŀ":"L","Ĺ":"L","Ľ":"L","Ḷ":"L","Ḹ":"L","Ļ":"L","Ḽ":"L","Ḻ":"L","Ł":"L","Ƚ":"L","Ɫ":"L","Ⱡ":"L","Ꝉ":"L","Ꝇ":"L","Ꞁ":"L","Ǉ":"LJ","ǈ":"Lj","Ⓜ":"M","Ｍ":"M","Ḿ":"M","Ṁ":"M","Ṃ":"M","Ɱ":"M","Ɯ":"M","Ⓝ":"N","Ｎ":"N","Ǹ":"N","Ń":"N","Ñ":"N","Ṅ":"N","Ň":"N","Ṇ":"N","Ņ":"N","Ṋ":"N","Ṉ":"N","Ƞ":"N","Ɲ":"N","Ꞑ":"N","Ꞥ":"N","Ǌ":"NJ","ǋ":"Nj","Ⓞ":"O","Ｏ":"O","Ò":"O","Ó":"O","Ô":"O","Ồ":"O","Ố":"O","Ỗ":"O","Ổ":"O","Õ":"O","Ṍ":"O","Ȭ":"O","Ṏ":"O","Ō":"O","Ṑ":"O","Ṓ":"O","Ŏ":"O","Ȯ":"O","Ȱ":"O","Ö":"O","Ȫ":"O","Ỏ":"O","Ő":"O","Ǒ":"O","Ȍ":"O","Ȏ":"O","Ơ":"O","Ờ":"O","Ớ":"O","Ỡ":"O","Ở":"O","Ợ":"O","Ọ":"O","Ộ":"O","Ǫ":"O","Ǭ":"O","Ø":"O","Ǿ":"O","Ɔ":"O","Ɵ":"O","Ꝋ":"O","Ꝍ":"O","Ƣ":"OI","Ꝏ":"OO","Ȣ":"OU","Ⓟ":"P","Ｐ":"P","Ṕ":"P","Ṗ":"P","Ƥ":"P","Ᵽ":"P","Ꝑ":"P","Ꝓ":"P","Ꝕ":"P","Ⓠ":"Q","Ｑ":"Q","Ꝗ":"Q","Ꝙ":"Q","Ɋ":"Q","Ⓡ":"R","Ｒ":"R","Ŕ":"R","Ṙ":"R","Ř":"R","Ȑ":"R","Ȓ":"R","Ṛ":"R","Ṝ":"R","Ŗ":"R","Ṟ":"R","Ɍ":"R","Ɽ":"R","Ꝛ":"R","Ꞧ":"R","Ꞃ":"R","Ⓢ":"S","Ｓ":"S","ẞ":"S","Ś":"S","Ṥ":"S","Ŝ":"S","Ṡ":"S","Š":"S","Ṧ":"S","Ṣ":"S","Ṩ":"S","Ș":"S","Ş":"S","Ȿ":"S","Ꞩ":"S","Ꞅ":"S","Ⓣ":"T","Ｔ":"T","Ṫ":"T","Ť":"T","Ṭ":"T","Ț":"T","Ţ":"T","Ṱ":"T","Ṯ":"T","Ŧ":"T","Ƭ":"T","Ʈ":"T","Ⱦ":"T","Ꞇ":"T","Ꜩ":"TZ","Ⓤ":"U","Ｕ":"U","Ù":"U","Ú":"U","Û":"U","Ũ":"U","Ṹ":"U","Ū":"U","Ṻ":"U","Ŭ":"U","Ü":"U","Ǜ":"U","Ǘ":"U","Ǖ":"U","Ǚ":"U","Ủ":"U","Ů":"U","Ű":"U","Ǔ":"U","Ȕ":"U","Ȗ":"U","Ư":"U","Ừ":"U","Ứ":"U","Ữ":"U","Ử":"U","Ự":"U","Ụ":"U","Ṳ":"U","Ų":"U","Ṷ":"U","Ṵ":"U","Ʉ":"U","Ⓥ":"V","Ｖ":"V","Ṽ":"V","Ṿ":"V","Ʋ":"V","Ꝟ":"V","Ʌ":"V","Ꝡ":"VY","Ⓦ":"W","Ｗ":"W","Ẁ":"W","Ẃ":"W","Ŵ":"W","Ẇ":"W","Ẅ":"W","Ẉ":"W","Ⱳ":"W","Ⓧ":"X","Ｘ":"X","Ẋ":"X","Ẍ":"X","Ⓨ":"Y","Ｙ":"Y","Ỳ":"Y","Ý":"Y","Ŷ":"Y","Ỹ":"Y","Ȳ":"Y","Ẏ":"Y","Ÿ":"Y","Ỷ":"Y","Ỵ":"Y","Ƴ":"Y","Ɏ":"Y","Ỿ":"Y","Ⓩ":"Z","Ｚ":"Z","Ź":"Z","Ẑ":"Z","Ż":"Z","Ž":"Z","Ẓ":"Z","Ẕ":"Z","Ƶ":"Z","Ȥ":"Z","Ɀ":"Z","Ⱬ":"Z","Ꝣ":"Z","ⓐ":"a","ａ":"a","ẚ":"a","à":"a","á":"a","â":"a","ầ":"a","ấ":"a","ẫ":"a","ẩ":"a","ã":"a","ā":"a","ă":"a","ằ":"a","ắ":"a","ẵ":"a","ẳ":"a","ȧ":"a","ǡ":"a","ä":"a","ǟ":"a","ả":"a","å":"a","ǻ":"a","ǎ":"a","ȁ":"a","ȃ":"a","ạ":"a","ậ":"a","ặ":"a","ḁ":"a","ą":"a","ⱥ":"a","ɐ":"a","ꜳ":"aa","æ":"ae","ǽ":"ae","ǣ":"ae","ꜵ":"ao","ꜷ":"au","ꜹ":"av","ꜻ":"av","ꜽ":"ay","ⓑ":"b","ｂ":"b","ḃ":"b","ḅ":"b","ḇ":"b","ƀ":"b","ƃ":"b","ɓ":"b","ⓒ":"c","ｃ":"c","ć":"c","ĉ":"c","ċ":"c","č":"c","ç":"c","ḉ":"c","ƈ":"c","ȼ":"c","ꜿ":"c","ↄ":"c","ⓓ":"d","ｄ":"d","ḋ":"d","ď":"d","ḍ":"d","ḑ":"d","ḓ":"d","ḏ":"d","đ":"d","ƌ":"d","ɖ":"d","ɗ":"d","ꝺ":"d","ǳ":"dz","ǆ":"dz","ⓔ":"e","ｅ":"e","è":"e","é":"e","ê":"e","ề":"e","ế":"e","ễ":"e","ể":"e","ẽ":"e","ē":"e","ḕ":"e","ḗ":"e","ĕ":"e","ė":"e","ë":"e","ẻ":"e","ě":"e","ȅ":"e","ȇ":"e","ẹ":"e","ệ":"e","ȩ":"e","ḝ":"e","ę":"e","ḙ":"e","ḛ":"e","ɇ":"e","ɛ":"e","ǝ":"e","ⓕ":"f","ｆ":"f","ḟ":"f","ƒ":"f","ꝼ":"f","ⓖ":"g","ｇ":"g","ǵ":"g","ĝ":"g","ḡ":"g","ğ":"g","ġ":"g","ǧ":"g","ģ":"g","ǥ":"g","ɠ":"g","ꞡ":"g","ᵹ":"g","ꝿ":"g","ⓗ":"h","ｈ":"h","ĥ":"h","ḣ":"h","ḧ":"h","ȟ":"h","ḥ":"h","ḩ":"h","ḫ":"h","ẖ":"h","ħ":"h","ⱨ":"h","ⱶ":"h","ɥ":"h","ƕ":"hv","ⓘ":"i","ｉ":"i","ì":"i","í":"i","î":"i","ĩ":"i","ī":"i","ĭ":"i","ï":"i","ḯ":"i","ỉ":"i","ǐ":"i","ȉ":"i","ȋ":"i","ị":"i","į":"i","ḭ":"i","ɨ":"i","ı":"i","ⓙ":"j","ｊ":"j","ĵ":"j","ǰ":"j","ɉ":"j","ⓚ":"k","ｋ":"k","ḱ":"k","ǩ":"k","ḳ":"k","ķ":"k","ḵ":"k","ƙ":"k","ⱪ":"k","ꝁ":"k","ꝃ":"k","ꝅ":"k","ꞣ":"k","ⓛ":"l","ｌ":"l","ŀ":"l","ĺ":"l","ľ":"l","ḷ":"l","ḹ":"l","ļ":"l","ḽ":"l","ḻ":"l","ſ":"l","ł":"l","ƚ":"l","ɫ":"l","ⱡ":"l","ꝉ":"l","ꞁ":"l","ꝇ":"l","ǉ":"lj","ⓜ":"m","ｍ":"m","ḿ":"m","ṁ":"m","ṃ":"m","ɱ":"m","ɯ":"m","ⓝ":"n","ｎ":"n","ǹ":"n","ń":"n","ñ":"n","ṅ":"n","ň":"n","ṇ":"n","ņ":"n","ṋ":"n","ṉ":"n","ƞ":"n","ɲ":"n","ŉ":"n","ꞑ":"n","ꞥ":"n","ǌ":"nj","ⓞ":"o","ｏ":"o","ò":"o","ó":"o","ô":"o","ồ":"o","ố":"o","ỗ":"o","ổ":"o","õ":"o","ṍ":"o","ȭ":"o","ṏ":"o","ō":"o","ṑ":"o","ṓ":"o","ŏ":"o","ȯ":"o","ȱ":"o","ö":"o","ȫ":"o","ỏ":"o","ő":"o","ǒ":"o","ȍ":"o","ȏ":"o","ơ":"o","ờ":"o","ớ":"o","ỡ":"o","ở":"o","ợ":"o","ọ":"o","ộ":"o","ǫ":"o","ǭ":"o","ø":"o","ǿ":"o","ɔ":"o","ꝋ":"o","ꝍ":"o","ɵ":"o","ƣ":"oi","ȣ":"ou","ꝏ":"oo","ⓟ":"p","ｐ":"p","ṕ":"p","ṗ":"p","ƥ":"p","ᵽ":"p","ꝑ":"p","ꝓ":"p","ꝕ":"p","ⓠ":"q","ｑ":"q","ɋ":"q","ꝗ":"q","ꝙ":"q","ⓡ":"r","ｒ":"r","ŕ":"r","ṙ":"r","ř":"r","ȑ":"r","ȓ":"r","ṛ":"r","ṝ":"r","ŗ":"r","ṟ":"r","ɍ":"r","ɽ":"r","ꝛ":"r","ꞧ":"r","ꞃ":"r","ⓢ":"s","ｓ":"s","ß":"s","ś":"s","ṥ":"s","ŝ":"s","ṡ":"s","š":"s","ṧ":"s","ṣ":"s","ṩ":"s","ș":"s","ş":"s","ȿ":"s","ꞩ":"s","ꞅ":"s","ẛ":"s","ⓣ":"t","ｔ":"t","ṫ":"t","ẗ":"t","ť":"t","ṭ":"t","ț":"t","ţ":"t","ṱ":"t","ṯ":"t","ŧ":"t","ƭ":"t","ʈ":"t","ⱦ":"t","ꞇ":"t","ꜩ":"tz","ⓤ":"u","ｕ":"u","ù":"u","ú":"u","û":"u","ũ":"u","ṹ":"u","ū":"u","ṻ":"u","ŭ":"u","ü":"u","ǜ":"u","ǘ":"u","ǖ":"u","ǚ":"u","ủ":"u","ů":"u","ű":"u","ǔ":"u","ȕ":"u","ȗ":"u","ư":"u","ừ":"u","ứ":"u","ữ":"u","ử":"u","ự":"u","ụ":"u","ṳ":"u","ų":"u","ṷ":"u","ṵ":"u","ʉ":"u","ⓥ":"v","ｖ":"v","ṽ":"v","ṿ":"v","ʋ":"v","ꝟ":"v","ʌ":"v","ꝡ":"vy","ⓦ":"w","ｗ":"w","ẁ":"w","ẃ":"w","ŵ":"w","ẇ":"w","ẅ":"w","ẘ":"w","ẉ":"w","ⱳ":"w","ⓧ":"x","ｘ":"x","ẋ":"x","ẍ":"x","ⓨ":"y","ｙ":"y","ỳ":"y","ý":"y","ŷ":"y","ỹ":"y","ȳ":"y","ẏ":"y","ÿ":"y","ỷ":"y","ẙ":"y","ỵ":"y","ƴ":"y","ɏ":"y","ỿ":"y","ⓩ":"z","ｚ":"z","ź":"z","ẑ":"z","ż":"z","ž":"z","ẓ":"z","ẕ":"z","ƶ":"z","ȥ":"z","ɀ":"z","ⱬ":"z","ꝣ":"z","Ά":"Α","Έ":"Ε","Ή":"Η","Ί":"Ι","Ϊ":"Ι","Ό":"Ο","Ύ":"Υ","Ϋ":"Υ","Ώ":"Ω","ά":"α","έ":"ε","ή":"η","ί":"ι","ϊ":"ι","ΐ":"ι","ό":"ο","ύ":"υ","ϋ":"υ","ΰ":"υ","ω":"ω","ς":"σ"},e.fnOperators={equal:function(t,i,r,n){return n&&(t=e.ignoreDiacritics(t),i=e.ignoreDiacritics(i)),r?e.toLowerCase(t)===e.toLowerCase(i):t===i},notequal:function(t,i,r,n){return n&&(t=e.ignoreDiacritics(t),i=e.ignoreDiacritics(i)),!e.fnOperators.equal(t,i,r)},lessthan:function(t,i,r){return r?e.toLowerCase(t)<e.toLowerCase(i):(sf.base.isNullOrUndefined(t)&&(t=void 0),t<i)},greaterthan:function(t,i,r){return r?e.toLowerCase(t)>e.toLowerCase(i):t>i},lessthanorequal:function(t,i,r){return r?e.toLowerCase(t)<=e.toLowerCase(i):(sf.base.isNullOrUndefined(t)&&(t=void 0),t<=i)},greaterthanorequal:function(t,i,r){return r?e.toLowerCase(t)>=e.toLowerCase(i):t>=i},contains:function(t,i,r,n){return n&&(t=e.ignoreDiacritics(t),i=e.ignoreDiacritics(i)),r?!sf.base.isNullOrUndefined(t)&&!sf.base.isNullOrUndefined(i)&&-1!==e.toLowerCase(t).indexOf(e.toLowerCase(i)):!sf.base.isNullOrUndefined(t)&&!sf.base.isNullOrUndefined(i)&&-1!==t.toString().indexOf(i)},notnull:function(e){return null!==e},isnull:function(e){return null===e},startswith:function(t,i,r,n){return n&&(t=e.ignoreDiacritics(t),i=e.ignoreDiacritics(i)),r?t&&i&&e.startsWith(e.toLowerCase(t),e.toLowerCase(i)):t&&i&&e.startsWith(t,i)},endswith:function(t,i,r,n){return n&&(t=e.ignoreDiacritics(t),i=e.ignoreDiacritics(i)),r?t&&i&&e.endsWith(e.toLowerCase(t),e.toLowerCase(i)):t&&i&&e.endsWith(t,i)},processSymbols:function(t){var i=e.operatorSymbols[t];return i?e.fnOperators[i]:e.throwError("Query - Process Operator : Invalid operator")},processOperator:function(t){var i=e.fnOperators[t];return i||e.fnOperators.processSymbols(t)}},e.parse={parseJson:function(t){return"string"==typeof t?t=JSON.parse(t,e.parse.jsonReviver):t instanceof Array?e.parse.iterateAndReviveArray(t):"object"===i(t)&&null!==t&&e.parse.iterateAndReviveJson(t),t},iterateAndReviveArray:function(t){for(var r=0;r<t.length;r++)"object"===i(t[r])&&null!==t[r]?e.parse.iterateAndReviveJson(t[r]):"string"!=typeof t[r]||/^[\s]*\[|^[\s]*\{(.)+:|\"/g.test(t[r])?t[r]=e.parse.parseJson(t[r]):t[r]=e.parse.jsonReviver("",t[r])},iterateAndReviveJson:function(t){for(var r,n=0,o=Object.keys(t);n<o.length;n++){var s=o[n];e.startsWith(s,"__")||("object"===i(r=t[s])?r instanceof Array?e.parse.iterateAndReviveArray(r):r&&e.parse.iterateAndReviveJson(r):t[s]=e.parse.jsonReviver(t[s],r))}},jsonReviver:function(t,i){if("string"==typeof i){var r=/^\/Date\(([+-]?[0-9]+)([+-][0-9]{4})?\)\/$/.exec(i),n=e.timeZoneHandling?e.serverTimezoneOffset:null;if(r)return e.dateParse.toTimeZone(new Date(parseInt(r[1],10)),n,!0);if(/^(\d{4}\-\d\d\-\d\d([tT][\d:\.]*){1})([zZ]|([+\-])(\d\d):?(\d\d))?$/.test(i)){var o=i.indexOf("Z")>-1||i.indexOf("z")>-1,s=i.split(/[^0-9.]/);if(o){if(s[5].indexOf(".")>-1){var a=s[5].split(".");s[5]=a[0],s[6]=new Date(i).getUTCMilliseconds().toString()}else s[6]="00";i=e.dateParse.toTimeZone(new Date(parseInt(s[0],10),parseInt(s[1],10)-1,parseInt(s[2],10),parseInt(s[3],10),parseInt(s[4],10),parseInt(s[5],10),parseInt(s[6],10)),e.serverTimezoneOffset,!1)}else{var l=new Date(parseInt(s[0],10),parseInt(s[1],10)-1,parseInt(s[2],10),parseInt(s[3],10),parseInt(s[4],10),parseInt(s[5],10)),h=parseInt(s[6],10),d=parseInt(s[7],10);if(isNaN(h)&&isNaN(d))return l;i.indexOf("+")>-1?l.setHours(l.getHours()-h,l.getMinutes()-d):l.setHours(l.getHours()+h,l.getMinutes()+d),i=e.dateParse.toTimeZone(l,e.serverTimezoneOffset,!1)}null==e.serverTimezoneOffset&&(i=e.dateParse.addSelfOffset(i))}}return i},isJson:function(t){return"string"==typeof t[0]?t:e.parse.parseJson(t)},isGuid:function(e){return null!=/[A-Fa-f0-9]{8}(?:-[A-Fa-f0-9]{4}){3}-[A-Fa-f0-9]{12}/i.exec(e)},replacer:function(t,i){return e.isPlainObject(t)?e.parse.jsonReplacer(t,i):t instanceof Array?e.parse.arrayReplacer(t):t instanceof Date?e.parse.jsonReplacer({val:t},i).val:t},jsonReplacer:function(t,i){for(var r,n=0,o=Object.keys(t);n<o.length;n++){var s=o[n];if((r=t[s])instanceof Date){var a=r;null==e.serverTimezoneOffset?t[s]=e.dateParse.toTimeZone(a,null).toJSON():(a=new Date(+a+36e5*e.serverTimezoneOffset),t[s]=e.dateParse.toTimeZone(e.dateParse.addSelfOffset(a),null).toJSON())}}return t},arrayReplacer:function(t){for(var i=0;i<t.length;i++)e.isPlainObject(t[i])?t[i]=e.parse.jsonReplacer(t[i]):t[i]instanceof Date&&(t[i]=e.parse.jsonReplacer({date:t[i]}).date);return t},jsonDateReplacer:function(t,i){if("value"===t&&i){if("string"==typeof i){var r=/^\/Date\(([+-]?[0-9]+)([+-][0-9]{4})?\)\/$/.exec(i);if(r)i=e.dateParse.toTimeZone(new Date(parseInt(r[1],10)),null,!0);else if(/^(\d{4}\-\d\d\-\d\d([tT][\d:\.]*){1})([zZ]|([+\-])(\d\d):?(\d\d))?$/.test(i)){var n=i.split(/[^0-9]/);i=e.dateParse.toTimeZone(new Date(parseInt(n[0],10),parseInt(n[1],10)-1,parseInt(n[2],10),parseInt(n[3],10),parseInt(n[4],10),parseInt(n[5],10)),null,!0)}}if(i instanceof Date)return i=e.dateParse.addSelfOffset(i),null===e.serverTimezoneOffset?e.dateParse.toTimeZone(e.dateParse.addSelfOffset(i),null).toJSON():(i=e.dateParse.toTimeZone(i,i.getTimezoneOffset()/60*2-e.serverTimezoneOffset,!1)).toJSON()}return i}},e.dateParse={addSelfOffset:function(e){return new Date(+e-6e4*e.getTimezoneOffset())},toUTC:function(e){return new Date(+e+6e4*e.getTimezoneOffset())},toTimeZone:function(t,i,r){if(null===i)return t;var n=r?e.dateParse.toUTC(t):t;return new Date(+n-36e5*i)},toLocalTime:function(e){var t=e,i=-t.getTimezoneOffset(),r=i>=0?"+":"-",n=function(e){var t=Math.floor(Math.abs(e));return(t<10?"0":"")+t};return t.getFullYear()+"-"+n(t.getMonth()+1)+"-"+n(t.getDate())+"T"+n(t.getHours())+":"+n(t.getMinutes())+":"+n(t.getSeconds())+r+n(i/60)+":"+n(i%60)}},e}(),a=(t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,i)},function(e,i){function r(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}),l={GroupGuid:"{271bbba0-1ee7}"},h=function(){function e(t){this.options={from:"table",requestType:"json",sortBy:"sorted",select:"select",skip:"skip",group:"group",take:"take",search:"search",count:"requiresCounts",where:"where",aggregates:"aggregates",expand:"expand"},this.type=e,this.dataSource=t,this.pvt={}}return e.prototype.processResponse=function(e,t,i,r){return e},e}(),d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.prototype.processQuery=function(e,t){for(var i,r,n,o=e.dataSource.json.slice(0),s=o.length,a=!0,l={},h=0,d=[],c=0;c<t.lazyLoad.length;c++)h++,l[t.lazyLoad[c].key]=t.lazyLoad[c].value;var p={};for(c=0;c<t.queries.length;c++)"onPage"!==(r=t.queries[c]).fn&&"onGroup"!==r.fn||!t.lazyLoad.length?(i=this[r.fn].call(this,o,r.e,t),"onAggregates"===r.fn?p[r.e.field+" - "+r.e.type]=i:o=void 0!==i?i:o,"onPage"!==r.fn&&"onSkip"!==r.fn&&"onTake"!==r.fn&&"onRange"!==r.fn||(a=!1),a&&(s=o.length)):("onGroup"===r.fn&&d.push(r.e),"onPage"===r.fn&&(n=r.e));if(h){var u={query:t,lazyLoad:l,result:o,group:d,page:n},g=this.lazyLoadGroup(u);o=g.result,s=g.count}return t.isCountRequired&&(o={result:o,count:s,aggregates:p}),o},t.prototype.lazyLoadGroup=function(e){var t=0,i=this.getAggregate(e.query),r=e.result;if(sf.base.isNullOrUndefined(e.lazyLoad.onDemandGroupInfo)){a=e.group[0].fieldName;t=(r=s.group(r,a,i,null,null,e.group[0].comparer,!0)).length;l=r;e.page&&(r=this.onPage(r,e.page,e.query)),this.formGroupResult(r,l)}else{for(var n=e.lazyLoad.onDemandGroupInfo,o=n.where.length-1;o>=0;o--)r=this.onWhere(r,n.where[o]);if(e.group.length!==n.level){var a=e.group[n.level].fieldName;r=s.group(r,a,i,null,null,e.group[0].comparer,!0)}t=r.length;var l=r;r=(r=r.slice(n.skip)).slice(0,n.take),e.group.length!==n.level&&this.formGroupResult(r,l)}return{result:r,count:t}},t.prototype.formGroupResult=function(e,t){if(e.length&&t.length){e.GroupGuid=t.GroupGuid,e.childLevels=t.childLevels,e.level=t.level,e.records=t.records}return e},t.prototype.getAggregate=function(e){var t=r.filterQueries(e.queries,"onAggregates"),i=[];if(t.length)for(var n=void 0,o=0;o<t.length;o++)n=t[o].e,i.push({type:n.type,field:s.getValue(n.field,e)});return i},t.prototype.batchRequest=function(e,t,i){var r,n=t.deletedRecords.length;for(r=0;r<t.addedRecords.length;r++)this.insert(e,t.addedRecords[r]);for(r=0;r<t.changedRecords.length;r++)this.update(e,i.key,t.changedRecords[r]);for(r=0;r<n;r++)this.remove(e,i.key,t.deletedRecords[r]);return t},t.prototype.onWhere=function(e,t){return e&&e.length?e.filter((function(e){if(t)return t.validate(e)})):e},t.prototype.onAggregates=function(e,t){var i=s.aggregates[t.type];return e&&i&&0!==e.length?i(e,t.field):null},t.prototype.onSearch=function(e,t){return e&&e.length?(0===t.fieldNames.length&&s.getFieldList(e[0],t.fieldNames),e.filter((function(e){for(var i=0;i<t.fieldNames.length;i++)if(t.comparer.call(e,s.getObject(t.fieldNames[i],e),t.searchKey,t.ignoreCase,t.ignoreAccent))return!0;return!1}))):e},t.prototype.onSortBy=function(e,t,i){if(!e||!e.length)return e;var r,n=s.getValue(t.fieldName,i);if(!n)return e.sort(t.comparer);if(n instanceof Array){for(var o=(n=n.slice(0)).length-1;o>=0;o--)n[o]&&(r=t.comparer,s.endsWith(n[o]," desc")&&(r=s.fnSort("descending"),n[o]=n[o].replace(" desc","")),e=s.sort(e,n[o],r));return e}return s.sort(e,n,t.comparer)},t.prototype.onGroup=function(e,t,i){if(!e||!e.length)return e;var r=this.getAggregate(i);return s.group(e,s.getValue(t.fieldName,i),r,null,null,t.comparer)},t.prototype.onPage=function(e,t,i){var r=s.getValue(t.pageSize,i),n=(s.getValue(t.pageIndex,i)-1)*r,o=n+r;return e&&e.length?e.slice(n,o):e},t.prototype.onRange=function(e,t){return e&&e.length?e.slice(s.getValue(t.start),s.getValue(t.end)):e},t.prototype.onTake=function(e,t){return e&&e.length?e.slice(0,s.getValue(t.nos)):e},t.prototype.onSkip=function(e,t){return e&&e.length?e.slice(s.getValue(t.nos)):e},t.prototype.onSelect=function(e,t){return e&&e.length?s.select(e,s.getValue(t.fieldNames)):e},t.prototype.insert=function(e,t,i,r,n){return sf.base.isNullOrUndefined(n)?e.dataSource.json.push(t):e.dataSource.json.splice(n,0,t)},t.prototype.remove=function(e,t,r,n){var o,a=e.dataSource.json;for("object"!==i(r)||r instanceof Date||(r=s.getObject(t,r)),o=0;o<a.length&&s.getObject(t,a[o])!==r;o++);return o!==a.length?a.splice(o,1):null},t.prototype.update=function(e,t,i,r){var n,o,s=e.dataSource.json;for(sf.base.isNullOrUndefined(t)||(o=sf.base.getValue(t,i)),n=0;n<s.length&&(sf.base.isNullOrUndefined(t)||sf.base.getValue(t,s[n])!==o);n++);return n<s.length?sf.base.merge(s[n],i):null},t}(h),c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.prototype.processQuery=function(e,t,n){var o,a,l=this.getQueryRequest(t),h=r.filterQueryLists(t.queries,["onSelect","onPage","onSkip","onTake","onRange"]),d=t.params,c=e.dataSource.url,p=null,u=this.options,g={sorts:[],groups:[],filters:[],searches:[],aggregates:[]};"onPage"in h?(o=h.onPage,a=((a=s.getValue(o.pageIndex,t))-1)*(p=s.getValue(o.pageSize,t))):"onRange"in h&&(a=(o=h.onRange).start,p=o.end-o.start);for(var f=0;f<l.sorts.length;f++)o=s.getValue(l.sorts[f].e.fieldName,t),g.sorts.push(s.callAdaptorFunction(this,"onEachSort",{name:o,direction:l.sorts[f].e.direction},t));n&&(o=this.getFiltersFrom(n,t))&&g.filters.push(s.callAdaptorFunction(this,"onEachWhere",o.toJson(),t));for(f=0;f<l.filters.length;f++){var m=s.callAdaptorFunction(this,"onEachWhere",l.filters[f].e.toJson(),t);this.getModuleName&&"ODataV4Adaptor"===this.getModuleName()&&!sf.base.isNullOrUndefined(l.filters[f].e.key)&&l.filters.length>1&&(m="("+m+")"),g.filters.push(m);for(var y=0,v="object"===i(g.filters[f])?Object.keys(g.filters[f]):[];y<v.length;y++){var b=v[y];s.isNull(g[b])&&delete g[b]}}for(f=0;f<l.searches.length;f++)o=l.searches[f].e,g.searches.push(s.callAdaptorFunction(this,"onEachSearch",{fields:o.fieldNames,operator:o.operator,key:o.searchKey,ignoreCase:o.ignoreCase},t));for(f=0;f<l.groups.length;f++)g.groups.push(s.getValue(l.groups[f].e.fieldName,t));for(f=0;f<l.aggregates.length;f++)o=l.aggregates[f].e,g.aggregates.push({type:o.type,field:s.getValue(o.field,t)});var w={};if(this.getRequestQuery(u,t,h,g,w),s.callAdaptorFunction(this,"addParams",{dm:e,query:t,params:d,reqParams:w}),t.lazyLoad.length)for(f=0;f<t.lazyLoad.length;f++)w[t.lazyLoad[f].key]=t.lazyLoad[f].value;for(var x=0,M=Object.keys(w);x<M.length;x++){b=M[x];(s.isNull(w[b])||""===w[b]||0===w[b].length)&&delete w[b]}u.skip in w&&u.take in w||null===p||(w[u.skip]=s.callAdaptorFunction(this,"onSkip",a,t),w[u.take]=s.callAdaptorFunction(this,"onTake",p,t));var N=this.pvt;return this.pvt={},"json"===this.options.requestType?{data:JSON.stringify(w,s.parse.jsonDateReplacer),url:c,pvtData:N,type:"POST",contentType:"application/json; charset=utf-8"}:(o=this.convertToQueryString(w,t,e),{type:"GET",url:(o=(-1!==e.dataSource.url.indexOf("?")?"&":"/")+o).length?c.replace(/\/*$/,o):c,pvtData:N})},t.prototype.getRequestQuery=function(e,t,i,r,n){var o=n;o[e.from]=t.fromTable,e.apply&&t.distincts.length&&(o[e.apply]="onDistinct"in this?s.callAdaptorFunction(this,"onDistinct",t.distincts):""),!t.distincts.length&&e.expand&&(o[e.expand]="onExpand"in this&&"onSelect"in i?s.callAdaptorFunction(this,"onExpand",{selects:s.getValue(i.onSelect.fieldNames,t),expands:t.expands},t):t.expands),o[e.select]="onSelect"in i&&!t.distincts.length?s.callAdaptorFunction(this,"onSelect",s.getValue(i.onSelect.fieldNames,t),t):"",o[e.count]=t.isCountRequired?s.callAdaptorFunction(this,"onCount",t.isCountRequired,t):"",o[e.search]=r.searches.length?s.callAdaptorFunction(this,"onSearch",r.searches,t):"",o[e.skip]="onSkip"in i?s.callAdaptorFunction(this,"onSkip",s.getValue(i.onSkip.nos,t),t):"",o[e.take]="onTake"in i?s.callAdaptorFunction(this,"onTake",s.getValue(i.onTake.nos,t),t):"",o[e.where]=r.filters.length||r.searches.length?s.callAdaptorFunction(this,"onWhere",r.filters,t):"",o[e.sortBy]=r.sorts.length?s.callAdaptorFunction(this,"onSortBy",r.sorts,t):"",o[e.group]=r.groups.length?s.callAdaptorFunction(this,"onGroup",r.groups,t):"",o[e.aggregates]=r.aggregates.length?s.callAdaptorFunction(this,"onAggregates",r.aggregates,t):"",o.param=[]},t.prototype.convertToQueryString=function(e,t,i){return""},t.prototype.processResponse=function(e,t,i,r,n,o){if(r&&r.getResponseHeader("Content-Type")&&-1!==r.getResponseHeader("Content-Type").indexOf("application/json")){var a=s.timeZoneHandling;t&&!t.timeZoneHandling&&(s.timeZoneHandling=!1),e=s.parse.parseJson(e),s.timeZoneHandling=a}var l=n,h=l.pvtData||{},d=e?e.groupDs:[];if(r&&r.getResponseHeader("Content-Type")&&-1!==r.getResponseHeader("Content-Type").indexOf("xml"))return i.isCountRequired?{result:[],count:0}:[];var c=JSON.parse(l.data);if(c&&"batch"===c.action&&e&&e.addedRecords)return o.addedRecords=e.addedRecords,o;e&&e.d&&(e=e.d);var p={};e&&"count"in e&&(p.count=e.count),p.result=e&&e.result?e.result:e;var u=!1;if(Array.isArray(e.result)&&e.result.length){if(sf.base.isNullOrUndefined(e.result[0].key)||(p.result=this.formRemoteGroupedData(p.result,1,h.groups.length-1)),i&&i.lazyLoad.length&&h.groups.length)for(var g=0;g<i.lazyLoad.length;g++)if("onDemandGroupInfo"===i.lazyLoad[g].key){var f=i.lazyLoad[g].value.level;h.groups.length===f&&(u=!0)}}return u||this.getAggregateResult(h,e,p,d,i),s.isNull(p.count)?p.result:{result:p.result,count:p.count,aggregates:p.aggregates}},t.prototype.formRemoteGroupedData=function(e,t,i){for(var r=0;r<e.length;r++)e[r].items.length&&Object.keys(e[r].items[0]).indexOf("key")>-1&&this.formRemoteGroupedData(e[r].items,t+1,i-1);return e.GroupGuid=l.GroupGuid,e.level=t,e.childLevels=i,e.records=e[0].items.length?this.getGroupedRecords(e,!sf.base.isNullOrUndefined(e[0].items.records)):[],e},t.prototype.getGroupedRecords=function(e,t){for(var i=[],r=0;r<e.length;r++)if(t)i=i.concat(e[r].items.records);else for(var n=0;n<e[r].items.length;n++)i.push(e[r].items[n]);return i},t.prototype.onGroup=function(e){return this.pvt.groups=e,e},t.prototype.onAggregates=function(e){this.pvt.aggregates=e},t.prototype.batchRequest=function(e,t,i,r,n){return{type:"POST",url:e.dataSource.batchUrl||e.dataSource.crudUrl||e.dataSource.removeUrl||e.dataSource.url,contentType:"application/json; charset=utf-8",dataType:"json",data:JSON.stringify(sf.base.extend({},{changed:t.changedRecords,added:t.addedRecords,deleted:t.deletedRecords,action:"batch",table:i[void 0],key:i[void 0]},s.getAddParams(this,e,r)))}},t.prototype.beforeSend=function(e,t){},t.prototype.insert=function(e,t,i,r){return{url:e.dataSource.insertUrl||e.dataSource.crudUrl||e.dataSource.url,data:JSON.stringify(sf.base.extend({},{value:t,table:i,action:"insert"},s.getAddParams(this,e,r)))}},t.prototype.remove=function(e,t,i,r,n){return{type:"POST",url:e.dataSource.removeUrl||e.dataSource.crudUrl||e.dataSource.url,data:JSON.stringify(sf.base.extend({},{key:i,keyColumn:t,table:r,action:"remove"},s.getAddParams(this,e,n)))}},t.prototype.update=function(e,t,i,r,n){return{type:"POST",url:e.dataSource.updateUrl||e.dataSource.crudUrl||e.dataSource.url,data:JSON.stringify(sf.base.extend({},{value:i,action:"update",keyColumn:t,key:s.getObject(t,i),table:r},s.getAddParams(this,e,n)))}},t.prototype.getFiltersFrom=function(e,t){var r,o=t.fKey,a=o,l=t.key,h=[];"object"!==i(e[0])&&(a=null);for(var d=0;d<e.length;d++)r="object"===i(e[0])?s.getObject(l||a,e[d]):e[d],h.push(new n(o,"equal",r));return n.or(h)},t.prototype.getAggregateResult=function(e,t,i,n,o){var a=t;if(t&&t.result&&(a=t.result),e&&e.aggregates&&e.aggregates.length){var l=e.aggregates,h=void 0,d=a,c={};t.aggregate&&(d=t.aggregate);for(var p=0;p<l.length;p++)(h=s.aggregates[l[p].type])&&(c[l[p].field+" - "+l[p].type]=h(d,l[p].field));i.aggregates=c}var u=Array.isArray(t.result)&&t.result.length&&!sf.base.isNullOrUndefined(t.result[0].key);if(e&&e.groups&&e.groups.length&&!u){var g=e.groups;for(p=0;p<g.length;p++){sf.base.isNullOrUndefined(n)||(n=s.group(n,g[p]));var f=r.filterQueries(o.queries,"onGroup")[p].e;a=s.group(a,g[p],e.aggregates,null,n,f.comparer)}i.result=a}return i},t.prototype.getQueryRequest=function(e){var t={sorts:[],groups:[],filters:[],searches:[],aggregates:[]};return t.sorts=r.filterQueries(e.queries,"onSortBy"),t.groups=r.filterQueries(e.queries,"onGroup"),t.filters=r.filterQueries(e.queries,"onWhere"),t.searches=r.filterQueries(e.queries,"onSearch"),t.aggregates=r.filterQueries(e.queries,"onAggregates"),t},t.prototype.addParams=function(e){var t=e.reqParams;e.params.length&&(t.params={});for(var i=0,r=e.params;i<r.length;i++){var n=r[i];if(t[n.key])throw new Error("Query() - addParams: Custom Param is conflicting other request arguments");t[n.key]=n.value,n.fn&&(t[n.key]=n.fn.call(e.query,n.key,e.query,e.dm)),t.params[n.key]=t[n.key]}},t}(h),p=function(e){function t(t){var i=e.call(this)||this;return i.options=sf.base.extend({},i.options,{requestType:"get",accept:"application/json;odata=light;q=1,application/json;odata=verbose;q=0.5",multipartAccept:"multipart/mixed",sortBy:"$orderby",select:"$select",skip:"$skip",take:"$top",count:"$inlinecount",where:"$filter",expand:"$expand",batch:"$batch",changeSet:"--changeset_",batchPre:"batch_",contentId:"Content-Id: ",batchContent:"Content-Type: multipart/mixed; boundary=",changeSetContent:"Content-Type: application/http\nContent-Transfer-Encoding: binary ",batchChangeSetContentType:"Content-Type: application/json; charset=utf-8 ",updateType:"PUT"}),sf.base.extend(i.options,t||{}),i}return a(t,e),t.prototype.getModuleName=function(){return"ODataAdaptor"},t.prototype.onPredicate=function(e,r,n){var o,a,l="",h=e.value,d=i(h),c=e.field?t.getField(e.field):null;if(h instanceof Date&&(h="datetime'"+s.parse.replacer(h)+"'"),"string"===d&&(h=h.replace(/'/g,"''"),e.ignoreCase&&(h=h.toLowerCase()),h="'"+(h=encodeURIComponent(h))+"'",n&&(c="cast("+c+", 'Edm.String')"),s.parse.isGuid(h)&&(a="guid"),e.ignoreCase&&(a||(c="tolower("+c+")"),h=h.toLowerCase())),o=s.odBiOperator[e.operator])return l+=c,l+=o,a&&(l+=a),l+h;if("substringof"===(o=sf.base.isNullOrUndefined(this.getModuleName)||"ODataV4Adaptor"!==this.getModuleName()?s.odUniOperator[e.operator]:s.odv4UniOperator[e.operator])){var p=h;h=c,c=p}return l+=o+"(",l+=c+",",a&&(l+=a),l+=h+")"},t.prototype.addParams=function(t){e.prototype.addParams.call(this,t),delete t.reqParams.params},t.prototype.onComplexPredicate=function(e,t,i){for(var r=[],n=0;n<e.predicates.length;n++)r.push("("+this.onEachWhere(e.predicates[n],t,i)+")");return r.join(" "+e.condition+" ")},t.prototype.onEachWhere=function(e,t,i){return e.isComplex?this.onComplexPredicate(e,t,i):this.onPredicate(e,t,i)},t.prototype.onWhere=function(e){return this.pvt.search&&e.push(this.onEachWhere(this.pvt.search,null,!0)),e.join(" and ")},t.prototype.onEachSearch=function(e){e.fields&&0===e.fields.length&&s.throwError("Query() - Search : oData search requires list of field names to search");for(var t=this.pvt.search||[],i=0;i<e.fields.length;i++)t.push(new n(e.fields[i],e.operator,e.key,e.ignoreCase));this.pvt.search=t},t.prototype.onSearch=function(e){return this.pvt.search=n.or(this.pvt.search),""},t.prototype.onEachSort=function(e){var i=[];if(e.name instanceof Array)for(var r=0;r<e.name.length;r++)i.push(t.getField(e.name[r])+("descending"===e.direction?" desc":""));else i.push(t.getField(e.name)+("descending"===e.direction?" desc":""));return i.join(",")},t.prototype.onSortBy=function(e){return e.reverse().join(",")},t.prototype.onGroup=function(e){return this.pvt.groups=e,[]},t.prototype.onSelect=function(e){for(var i=0;i<e.length;i++)e[i]=t.getField(e[i]);return e.join(",")},t.prototype.onAggregates=function(e){return this.pvt.aggregates=e,""},t.prototype.onCount=function(e){return!0===e?"allpages":""},t.prototype.beforeSend=function(e,t,i){s.endsWith(i.url,this.options.batch)&&"post"===i.type.toLowerCase()?(t.setRequestHeader("Accept",this.options.multipartAccept),t.setRequestHeader("DataServiceVersion","2.0"),t.overrideMimeType("text/plain; charset=x-user-defined")):t.setRequestHeader("Accept",this.options.accept),t.setRequestHeader("DataServiceVersion","2.0"),t.setRequestHeader("MaxDataServiceVersion","2.0")},t.prototype.processResponse=function(e,t,i,r,n,o){if(n&&"GET"===n.type&&!this.rootUrl&&e["odata.metadata"]){var a=e["odata.metadata"].split("/$metadata#");this.rootUrl=a[0],this.resourceTableName=a[1]}if(!sf.base.isNullOrUndefined(e.d)){var l=i&&i.isCountRequired?e.d.results:e.d;if(!sf.base.isNullOrUndefined(l))for(var h=0;h<l.length;h++)sf.base.isNullOrUndefined(l[h].__metadata)||delete l[h].__metadata}var d=n&&n.pvtData,c=this.processBatchResponse(e,i,r,n,o);if(c)return c;var p=r&&n.getResponseHeader("DataServiceVersion"),u=null,g=p&&parseInt(p,10)||2;if(i&&i.isCountRequired){(e.__count||e["odata.count"])&&(u=e.__count||e["odata.count"]),e.d&&(e=e.d),(e.__count||e["odata.count"])&&(u=e.__count||e["odata.count"])}3===g&&e.value&&(e=e.value),e.d&&(e=e.d),g<3&&e.results&&(e=e.results);var f={};return f.count=u,f.result=e,this.getAggregateResult(d,e,f,null,i),s.isNull(u)?f.result:{result:f.result,count:f.count,aggregates:f.aggregates}},t.prototype.convertToQueryString=function(e,t,i){var r=[],n=e.table||"";delete e.table,i.dataSource.requiresFormat&&(e.$format="json");for(var o=0,s=Object.keys(e);o<s.length;o++){var a=s[o];r.push(a+"="+e[a])}return r=r.join("&"),i.dataSource.url&&-1!==i.dataSource.url.indexOf("?")&&!n?r:r.length?n+"?"+r:n||""},t.prototype.localTimeReplacer=function(e,t){for(var i=0,r=sf.base.isNullOrUndefined(t)?[]:Object.keys(t);i<r.length;i++){var n=r[i];t[n]instanceof Date&&(t[n]=s.dateParse.toLocalTime(t[n]))}return t},t.prototype.insert=function(e,t,i){return{url:(e.dataSource.insertUrl||e.dataSource.url).replace(/\/*$/,i?"/"+i:""),data:JSON.stringify(t,this.options.localTime?this.localTimeReplacer:null)}},t.prototype.remove=function(e,t,i,r){var n;return n="string"!=typeof i||s.parse.isGuid(i)?"("+i+")":"('"+i+"')",{type:"DELETE",url:(e.dataSource.removeUrl||e.dataSource.url).replace(/\/*$/,r?"/"+r:"")+n}},t.prototype.update=function(e,t,i,r,n,o){var a;return"PATCH"!==this.options.updateType||sf.base.isNullOrUndefined(o)||(i=this.compareAndRemove(i,o,t)),a="string"!=typeof i[t]||s.parse.isGuid(i[t])?"("+i[t]+")":"('"+i[t]+"')",{type:this.options.updateType,url:(e.dataSource.updateUrl||e.dataSource.url).replace(/\/*$/,r?"/"+r:"")+a,data:JSON.stringify(i,this.options.localTime?this.localTimeReplacer:null),accept:this.options.accept}},t.prototype.batchRequest=function(e,t,i,r,n){var o=i.guid=s.getGuid(this.options.batchPre),a=this.rootUrl?this.rootUrl+"/"+this.options.batch:e.dataSource.url.replace(/\/*$/,"/"+this.options.batch);i.url=this.resourceTableName?this.resourceTableName:i.url;var l={url:i.url,key:i.key,cid:1,cSet:s.getGuid(this.options.changeSet)},h="--"+o+"\n";return h+="Content-Type: multipart/mixed; boundary="+l.cSet.replace("--","")+"\n",this.pvt.changeSet=0,h+=this.generateInsertRequest(t.addedRecords,l,e),h+=this.generateUpdateRequest(t.changedRecords,l,e,n?n.changedRecords:[]),h+=this.generateDeleteRequest(t.deletedRecords,l,e),h+=l.cSet+"--\n",{type:"POST",url:a,dataType:"json",contentType:"multipart/mixed; charset=UTF-8;boundary="+o,data:h+="--"+o+"--"}},t.prototype.generateDeleteRequest=function(e,t,i){if(!e)return"";var r={method:"DELETE ",url:function(e,t,i){var r=s.getObject(i,e[t]);return"number"==typeof r||s.parse.isGuid(r)?"("+r+")":r instanceof Date?"("+e[t][i].toJSON()+")":"('"+r+"')"},data:function(e,t){return""}};return this.generateBodyContent(e,t,r,i)+"\n"},t.prototype.generateInsertRequest=function(e,t,i){if(!e)return"";var r={method:"POST ",url:function(e,t,i){return""},data:function(e,t){return JSON.stringify(e[t])+"\n\n"}};return this.generateBodyContent(e,t,r,i)},t.prototype.generateUpdateRequest=function(e,t,i,r){var n=this;if(!e)return"";e.forEach((function(e){return e=n.compareAndRemove(e,r.filter((function(i){return s.getObject(t.key,i)===s.getObject(t.key,e)}))[0],t.key)}));var o={method:this.options.updateType+" ",url:function(e,t,i){return"number"==typeof e[t][i]||s.parse.isGuid(e[t][i])?"("+e[t][i]+")":e[t][i]instanceof Date?"("+e[t][i].toJSON()+")":"('"+e[t][i]+"')"},data:function(e,t){return JSON.stringify(e[t])+"\n\n"}};return this.generateBodyContent(e,t,o,i)},t.getField=function(e){return e.replace(/\./g,"/")},t.prototype.generateBodyContent=function(e,t,i,r){for(var n="",o=0;o<e.length;o++)n+="\n"+t.cSet+"\n",n+=this.options.changeSetContent+"\n\n",n+=i.method,"POST "===i.method?n+=(r.dataSource.insertUrl||r.dataSource.crudUrl||t.url)+i.url(e,o,t.key)+" HTTP/1.1\n":"PUT "===i.method||"PATCH "===i.method?n+=(r.dataSource.updateUrl||r.dataSource.crudUrl||t.url)+i.url(e,o,t.key)+" HTTP/1.1\n":"DELETE "===i.method&&(n+=(r.dataSource.removeUrl||r.dataSource.crudUrl||t.url)+i.url(e,o,t.key)+" HTTP/1.1\n"),n+="Accept: "+this.options.accept+"\n",n+="Content-Id: "+this.pvt.changeSet+++"\n",n+=this.options.batchChangeSetContentType+"\n",sf.base.isNullOrUndefined(e[o]["@odata.etag"])?n+="\n":(n+="If-Match: "+e[o]["@odata.etag"]+"\n\n",delete e[o]["@odata.etag"]),n+=i.data(e,o);return n},t.prototype.processBatchResponse=function(e,t,i,r,n){if(i&&i.getResponseHeader("Content-Type")&&-1!==i.getResponseHeader("Content-Type").indexOf("xml"))return t.isCountRequired?{result:[],count:0}:[];if(r&&this.options.batch&&s.endsWith(r.url,this.options.batch)&&"post"===r.type.toLowerCase()){var o=i.getResponseHeader("Content-Type"),a=void 0,l=void 0,h=e+"";if(o=o.substring(o.indexOf("=batchresponse")+1),(h=h.split(o)).length<2)return{};h=h[1];var d=/(?:\bContent-Type.+boundary=)(changesetresponse.+)/i.exec(h);d&&h.replace(d[0],"");for(var c=d?d[1]:"",p=(h=h.split(c)).length;p>-1;p--)/\bContent-ID:/i.test(h[p])&&/\bHTTP.+201/.test(h[p])&&(a=parseInt(/\bContent-ID: (\d+)/i.exec(h[p])[1],10),n.addedRecords[a]&&(l=s.parse.parseJson(/^\{.+\}/m.exec(h[p])[0]),sf.base.extend({},n.addedRecords[a],this.processResponse(l))));return n}return null},t.prototype.compareAndRemove=function(e,t,i){var r=this;return sf.base.isNullOrUndefined(t)||Object.keys(e).forEach((function(n){n!==i&&"@odata.etag"!==n&&(s.isPlainObject(e[n])?(r.compareAndRemove(e[n],t[n]),0===Object.keys(e[n]).filter((function(e){return"@odata.etag"!==e})).length&&delete e[n]):(e[n]===t[n]||e[n]&&t[n]&&e[n].valueOf()===t[n].valueOf())&&delete e[n])})),e},t}(c),u=function(e){function t(t){var i=e.call(this,t)||this;return i.options=sf.base.extend({},i.options,{requestType:"get",accept:"application/json, text/javascript, */*; q=0.01",multipartAccept:"multipart/mixed",sortBy:"$orderby",select:"$select",skip:"$skip",take:"$top",count:"$count",search:"$search",where:"$filter",expand:"$expand",batch:"$batch",changeSet:"--changeset_",batchPre:"batch_",contentId:"Content-Id: ",batchContent:"Content-Type: multipart/mixed; boundary=",changeSetContent:"Content-Type: application/http\nContent-Transfer-Encoding: binary ",batchChangeSetContentType:"Content-Type: application/json; charset=utf-8 ",updateType:"PATCH",localTime:!1,apply:"$apply"}),sf.base.extend(i.options,t||{}),i}return a(t,e),t.prototype.getModuleName=function(){return"ODataV4Adaptor"},t.prototype.onCount=function(e){return!0===e?"true":""},t.prototype.onPredicate=function(t,i,n){var o="",a=t.value,l=a instanceof Date;if(i instanceof r)for(var h=this.getQueryRequest(i),d=0;d<h.filters.length;d++)h.filters[d].e.key===t.value&&(n=!0);return o=e.prototype.onPredicate.call(this,t,i,n),l&&(o=o.replace(/datetime'(.*)'$/,"$1")),s.parse.isGuid(a)&&(o=o.replace("guid","").replace(/'/g,"")),o},t.prototype.onEachSearch=function(e){var t=this.pvt.searches||[];t.push(e.key),this.pvt.searches=t},t.prototype.onSearch=function(e){return this.pvt.searches.join(" OR ")},t.prototype.onExpand=function(e){var t=this,i={},r={},n=e.expands.slice(),o=[];return e.selects.filter((function(e){return e.indexOf(".")>-1})).forEach((function(e){var r=e.split(".");if(r[0]in i||(i[r[0]]=[]),2==r.length)i[r[0]].length&&-1!==Object.keys(i).indexOf(r[0])?-1!==i[r[0]][0].indexOf("$expand")&&-1===i[r[0]][0].indexOf(";$select=")?i[r[0]][0]=i[r[0]][0]+";$select="+r[1]:i[r[0]][0]=i[r[0]][0]+","+r[1]:i[r[0]].push("$select="+r[1]);else{for(var n="$select="+r[r.length-1],o="",s="",a=1;a<r.length-1;a++)o=o+"$expand="+r[a]+"(",s+=")";var l=o+n+s;if(i[r[0]].length&&-1!==Object.keys(i).indexOf(r[0])&&t.expandQueryIndex(i[r[0]],!0)){var h=t.expandQueryIndex(i[r[0]]);i[r[0]][h]=i[r[0]][h]+l.replace("$expand=",",")}else i[r[0]].push(l)}})),Object.keys(i).forEach((function(e){-1===n.indexOf(e)&&n.push(e)})),n.forEach((function(e){r[e]=e in i?e+"("+i[e].join(";")+")":e})),Object.keys(r).forEach((function(e){return o.push(r[e])})),o.join(",")},t.prototype.expandQueryIndex=function(e,t){for(var i=0;i<e.length;i++)if(-1!==e[i].indexOf("$expand"))return!!t||i;return!t&&0},t.prototype.onDistinct=function(e){return"groupby(("+e.map((function(e){return p.getField(e)})).join(",")+"))"},t.prototype.onSelect=function(t){return e.prototype.onSelect.call(this,t.filter((function(e){return-1===e.indexOf(".")})))},t.prototype.beforeSend=function(e,t,i){"POST"!==i.type&&"PUT"!==i.type&&"PATCH"!==i.type||t.setRequestHeader("Prefer","return=representation"),t.setRequestHeader("Accept",this.options.accept)},t.prototype.processResponse=function(t,i,r,n,o,a){if(o&&"GET"===o.type&&!this.rootUrl&&t["@odata.context"]){var l=t["@odata.context"].split("/$metadata#");this.rootUrl=l[0],this.resourceTableName=l[1]}var h=o&&o.pvtData,d=e.prototype.processBatchResponse.call(this,t,r,n,o,a);if(d)return d;var c=null;r&&r.isCountRequired&&"@odata.count"in t&&(c=t["@odata.count"]),t=sf.base.isNullOrUndefined(t.value)?t:t.value;var p={};return p.count=c,p.result=t,this.getAggregateResult(h,t,p,null,r),s.isNull(c)?p.result:{result:p.result,count:c,aggregates:p.aggregates}},t}(p),g=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.prototype.getModuleName=function(){return"WebApiAdaptor"},t.prototype.insert=function(e,t,i){return{type:"POST",url:e.dataSource.url,data:JSON.stringify(t)}},t.prototype.remove=function(e,t,i,r){return{type:"DELETE",url:e.dataSource.url+"/"+i,data:JSON.stringify(i)}},t.prototype.update=function(e,t,i,r){return{type:"PUT",url:e.dataSource.url,data:JSON.stringify(i)}},t.prototype.batchRequest=function(e,t,i){var r=this,n=i.guid=s.getGuid(this.options.batchPre),o=e.dataSource.url.replace(/\/*$/,"/"+this.options.batch);i.url=this.resourceTableName?this.resourceTableName:i.url;for(var a=[],l=function(r,o){t.addedRecords.forEach((function(o,s){var l=function(e,t,i){return""};a.push("--"+n),a.push("Content-Type: application/http; msgtype=request",""),a.push("POST /api/"+(e.dataSource.insertUrl||e.dataSource.crudUrl||i.url)+l(t.addedRecords,r,i.key)+" HTTP/1.1"),a.push("Content-Type: application/json; charset=utf-8"),a.push("Host: "+location.host),a.push("",o?JSON.stringify(o):"")}))},h=0,d=t.addedRecords.length;h<d;h++)l(h);var c=function(o,s){t.changedRecords.forEach((function(s,l){r.options.updateType;var h=function(e,t,i){return""};a.push("--"+n),a.push("Content-Type: application/http; msgtype=request",""),a.push("PUT /api/"+(e.dataSource.updateUrl||e.dataSource.crudUrl||i.url)+h(t.changedRecords,o,i.key)+" HTTP/1.1"),a.push("Content-Type: application/json; charset=utf-8"),a.push("Host: "+location.host),a.push("",s?JSON.stringify(s):"")}))};for(h=0,d=t.changedRecords.length;h<d;h++)c(h);var p=function(r,o){t.deletedRecords.forEach((function(o,l){var h=function(e,t,i){var r=s.getObject(i,e[t]);return"number"==typeof r||s.parse.isGuid(r)?"/"+r:r instanceof Date?"/"+e[t][i].toJSON():"/'"+r+"'"};a.push("--"+n),a.push("Content-Type: application/http; msgtype=request",""),a.push("DELETE /api/"+(e.dataSource.removeUrl||e.dataSource.crudUrl||i.url)+h(t.deletedRecords,r,i.key)+" HTTP/1.1"),a.push("Content-Type: application/json; charset=utf-8"),a.push("Host: "+location.host),a.push("",o?JSON.stringify(o):"")}))};for(h=0,d=t.deletedRecords.length;h<d;h++)p(h);return a.push("--"+n+"--",""),{type:"POST",url:o,contentType:"multipart/mixed; boundary="+n,data:a.join("\r\n")}},t.prototype.beforeSend=function(e,t,i){t.setRequestHeader("Accept","application/json, text/javascript, */*; q=0.01")},t.prototype.processResponse=function(e,t,i,r,n,o){var a=n&&n.pvtData,l=null,h={};if(n&&"post"!==n.type.toLowerCase()){var d=r&&n.getResponseHeader("DataServiceVersion"),c=d&&parseInt(d,10)||2;i&&i.isCountRequired&&(s.isNull(e.Count)||(l=e.Count)),c<3&&e.Items&&(e=e.Items),h.count=l,h.result=e,this.getAggregateResult(a,e,h,null,i)}return h.result=h.result||e,s.isNull(l)?h.result:{result:h.result,count:h.count,aggregates:h.aggregates}},t}(p),f=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.prototype.processQuery=function(e,t,i){var r=(new c).processQuery(e,t,i),n=s.parse.parseJson(r.data),o={};if(n.param)for(var a=0;a<n.param.length;a++){var l=n.param[a],h=Object.keys(l)[0];o[h]=l[h]}o.value=n;return{data:JSON.stringify(o),url:r.url,pvtData:r.pvtData,type:"POST",contentType:"application/json; charset=utf-8"}},t}(c),m=function(e){function t(){var t=e.call(this)||this;return sf.base.setValue("beforeSend",c.prototype.beforeSend,t),t}return a(t,e),t.prototype.insert=function(e,t,i,r,n){return this.pvt.position=n,this.updateType="add",{url:e.dataSource.insertUrl||e.dataSource.crudUrl||e.dataSource.url,data:JSON.stringify(sf.base.extend({},{value:t,table:i,action:"insert"},s.getAddParams(this,e,r)))}},t.prototype.remove=function(t,i,r,n,o){return e.prototype.remove.call(this,t,i,r),{type:"POST",url:t.dataSource.removeUrl||t.dataSource.crudUrl||t.dataSource.url,data:JSON.stringify(sf.base.extend({},{key:r,keyColumn:i,table:n,action:"remove"},s.getAddParams(this,t,o)))}},t.prototype.update=function(e,t,i,r,n){return this.updateType="update",this.updateKey=t,{type:"POST",url:e.dataSource.updateUrl||e.dataSource.crudUrl||e.dataSource.url,data:JSON.stringify(sf.base.extend({},{value:i,action:"update",keyColumn:t,key:i[t],table:r},s.getAddParams(this,e,n)))}},t.prototype.processResponse=function(t,i,r,n,o,a,l){var h;if(t="batch"===(o?JSON.parse(o.data):t).action?s.parse.parseJson(t):t,"add"===this.updateType&&e.prototype.insert.call(this,i,t,null,null,this.pvt.position),"update"===this.updateType&&e.prototype.update.call(this,i,this.updateKey,t),this.updateType=void 0,t.added)for(h=0;h<t.added.length;h++)e.prototype.insert.call(this,i,t.added[h]);if(t.changed)for(h=0;h<t.changed.length;h++)e.prototype.update.call(this,i,l.key,t.changed[h]);if(t.deleted)for(h=0;h<t.deleted.length;h++)e.prototype.remove.call(this,i,l.key,t.deleted[h]);return t},t.prototype.batchRequest=function(e,t,i,r,n){return{type:"POST",url:e.dataSource.batchUrl||e.dataSource.crudUrl||e.dataSource.url,contentType:"application/json; charset=utf-8",dataType:"json",data:JSON.stringify(sf.base.extend({},{changed:t.changedRecords,added:t.addedRecords,deleted:t.deletedRecords,action:"batch",table:i.url,key:i.key},s.getAddParams(this,e,r)))}},t.prototype.addParams=function(e){(new c).addParams(e)},t}(d),y=function(e){function t(t){var i=e.call(this)||this;return i.options=sf.base.extend({},i.options,{getData:new Function,addRecord:new Function,updateRecord:new Function,deleteRecord:new Function,batchUpdate:new Function}),sf.base.extend(i.options,t||{}),i}return a(t,e),t.prototype.getModuleName=function(){return"CustomDataAdaptor"},t}(c),v=function(e){function t(t){var i=e.call(this)||this;return i.opt=t,i.schema=i.opt.response,i.query=i.opt.query,i.getVariables=i.opt.getVariables?i.opt.getVariables:function(){},i.getQuery=function(){return i.query},i}return a(t,e),t.prototype.getModuleName=function(){return"GraphQLAdaptor"},t.prototype.processQuery=function(t,i){var r=e.prototype.processQuery.apply(this,arguments),n=JSON.parse(r.data),o=["skip","take","sorted","table","select","where","search","requiresCounts","aggregates","params"],s={},a="searchwhereparams";o.filter((function(e){s[e]=a.indexOf(e)>-1?JSON.stringify(n[e]):n[e]}));var l=this.getVariables()||{};l.datamanager=s;var h=JSON.stringify({query:this.getQuery(),variables:l});return r.data=h,r},t.prototype.processResponse=function(e,t,i,r,n){var o,a,l=e,h=sf.base.getValue(this.schema.result,l.data);this.schema.count&&(o=sf.base.getValue(this.schema.count,l.data)),this.schema.aggregates&&(a=sf.base.getValue(this.schema.aggregates,l.data),a=sf.base.isNullOrUndefined(a)?a:s.parse.parseJson(a));var d=n.pvtData||{},c={result:h,aggregates:a},p=c;return d&&d.groups&&d.groups.length&&this.getAggregateResult(d,p,c,null,i),sf.base.isNullOrUndefined(o)?c.result:{result:c.result,count:o,aggregates:a}},t.prototype.insert=function(){var t=e.prototype.insert.apply(this,arguments);return this.generateCrudData(t,"insert")},t.prototype.update=function(){var t=e.prototype.update.apply(this,arguments);return this.generateCrudData(t,"update")},t.prototype.remove=function(){var t=e.prototype.remove.apply(this,arguments);return this.generateCrudData(t,"remove")},t.prototype.batchRequest=function(t,i,r,n,o){var s=e.prototype.batchRequest.apply(this,arguments),a=JSON.parse(s.data);return a.key=r.key,s.data=JSON.stringify(a),this.generateCrudData(s,"batch")},t.prototype.generateCrudData=function(e,t){var i=JSON.parse(e.data);return e.data=JSON.stringify({query:this.opt.getMutation(t),variables:i}),e},t}(c),b=function(e){function t(t,i,r){var n=e.call(this)||this;n.isCrudAction=!1,n.isInsertAction=!1,sf.base.isNullOrUndefined(t)||(n.cacheAdaptor=t),n.pageSize=r,n.guidId=s.getGuid("cacheAdaptor");window.localStorage.setItem(n.guidId,JSON.stringify({keys:[],results:[]}));var o=n.guidId;return sf.base.isNullOrUndefined(i)||setInterval((function(){var e;e=s.parse.parseJson(window.localStorage.getItem(o));for(var t=[],r=0;r<e.results.length;r++){var n=+new Date,a=+new Date(e.results[r].timeStamp);e.results[r].timeStamp=n-a,n-a>i&&t.push(r)}for(r=0;r<t.length;r++)e.results.splice(t[r],1),e.keys.splice(t[r],1);window.localStorage.removeItem(o),window.localStorage.setItem(o,JSON.stringify(e))}),i),n}return a(t,e),t.prototype.generateKey=function(e,t){var i=this.getQueryRequest(t),n=r.filterQueryLists(t.queries,["onSelect","onPage","onSkip","onTake","onRange"]),o=e;"onPage"in n&&(o+=n.onPage.pageIndex),i.sorts.forEach((function(e){o+=e.e.direction+e.e.fieldName})),i.groups.forEach((function(e){o+=e.e.fieldName})),i.searches.forEach((function(e){o+=e.e.searchKey}));for(var s=0;s<i.filters.length;s++){var a=i.filters[s];if(a.e.isComplex){var l=t.clone();l.queries=[];for(var h=0;h<a.e.predicates.length;h++)l.queries.push({fn:"onWhere",e:a.e.predicates[h],filter:t.queries.filter});o+=a.e.condition+this.generateKey(e,l)}else o+=a.e.field+a.e.operator+a.e.value}return o},t.prototype.processQuery=function(e,t,i){var r,n=this.generateKey(e.dataSource.url,t),o=(r=s.parse.parseJson(window.localStorage.getItem(this.guidId)))?r.results[r.keys.indexOf(n)]:null;return null==o||this.isCrudAction||this.isInsertAction?(this.isCrudAction=null,this.isInsertAction=null,this.cacheAdaptor.processQuery.apply(this.cacheAdaptor,[].slice.call(arguments,0))):o},t.prototype.processResponse=function(e,t,i,r,n,o){if(this.isInsertAction||n&&this.cacheAdaptor.options.batch&&s.endsWith(n.url,this.cacheAdaptor.options.batch)&&"post"===n.type.toLowerCase())return this.cacheAdaptor.processResponse(e,t,i,r,n,o);e=this.cacheAdaptor.processResponse.apply(this.cacheAdaptor,[].slice.call(arguments,0));var a=i?this.generateKey(t.dataSource.url,i):t.dataSource.url,l={},h=(l=s.parse.parseJson(window.localStorage.getItem(this.guidId))).keys.indexOf(a);for(-1!==h&&(l.results.splice(h,1),l.keys.splice(h,1)),l.results[l.keys.push(a)-1]={keys:a,result:e.result,timeStamp:new Date,count:e.count};l.results.length>this.pageSize;)l.results.splice(0,1),l.keys.splice(0,1);return window.localStorage.setItem(this.guidId,JSON.stringify(l)),e},t.prototype.beforeSend=function(e,t,i){!sf.base.isNullOrUndefined(this.cacheAdaptor.options.batch)&&s.endsWith(i.url,this.cacheAdaptor.options.batch)&&"post"===i.type.toLowerCase()&&t.setRequestHeader("Accept",this.cacheAdaptor.options.multipartAccept),e.dataSource.crossDomain||t.setRequestHeader("Accept",this.cacheAdaptor.options.accept)},t.prototype.update=function(e,t,i,r){return this.isCrudAction=!0,this.cacheAdaptor.update(e,t,i,r)},t.prototype.insert=function(e,t,i){return this.isInsertAction=!0,this.cacheAdaptor.insert(e,t,i)},t.prototype.remove=function(e,t,i,r){return this.isCrudAction=!0,this.cacheAdaptor.remove(e,t,i,r)},t.prototype.batchRequest=function(e,t,i){return this.cacheAdaptor.batchRequest(e,t,i)},t}(c),w=function(){function e(e,t,n){var o,a=this;return this.dateParse=!0,this.timeZoneHandling=!0,this.requests=[],e||this.dataSource||(e=[]),n=n||e.adaptor,e&&!1===e.timeZoneHandling&&(this.timeZoneHandling=e.timeZoneHandling),e instanceof Array?o={json:e,offline:!0}:"object"===i(e)?(e.json||(e.json=[]),o={url:e.url,insertUrl:e.insertUrl,removeUrl:e.removeUrl,updateUrl:e.updateUrl,crudUrl:e.crudUrl,batchUrl:e.batchUrl,json:e.json,headers:e.headers,accept:e.accept,data:e.data,timeTillExpiration:e.timeTillExpiration,cachingPageSize:e.cachingPageSize,enableCaching:e.enableCaching,requestType:e.requestType,key:e.key,crossDomain:e.crossDomain,jsonp:e.jsonp,dataType:e.dataType,offline:void 0!==e.offline?e.offline:!(e.adaptor instanceof m||e.adaptor instanceof y)&&!e.url,requiresFormat:e.requiresFormat}):s.throwError("DataManager: Invalid arguments"),void 0!==o.requiresFormat||s.isCors()||(o.requiresFormat=!!sf.base.isNullOrUndefined(o.crossDomain)||o.crossDomain),void 0===o.dataType&&(o.dataType="json"),this.dataSource=o,this.defaultQuery=t,o.url&&o.offline&&!o.json.length?(this.isDataAvailable=!1,this.adaptor=n||new p,this.dataSource.offline=!1,this.ready=this.executeQuery(t||new r),this.ready.then((function(e){a.dataSource.offline=!0,a.isDataAvailable=!0,o.json=e.result,a.adaptor=new d}))):this.adaptor=o.offline?new d:new p,!o.jsonp&&this.adaptor instanceof p&&(o.jsonp="callback"),this.adaptor=n||this.adaptor,o.enableCaching&&(this.adaptor=new b(this.adaptor,o.timeTillExpiration,o.cachingPageSize)),this}return e.prototype.setDefaultQuery=function(e){return this.defaultQuery=e,this},e.prototype.executeLocal=function(t){this.defaultQuery||t instanceof r||s.throwError("DataManager - executeLocal() : A query is required to execute"),this.dataSource.json||s.throwError("DataManager - executeLocal() : Json data is required to execute"),t=t||this.defaultQuery;var i=this.adaptor.processQuery(this,t);if(t.subQuery){var n=t.subQuery.fromTable,o=t.subQuery.lookups,a=t.isCountRequired?i.result:i;o&&o instanceof Array&&s.buildHierarchy(t.subQuery.fKey,n,a,o,t.subQuery.key);for(var l=0;l<a.length;l++)a[l][n]instanceof Array&&(a[l]=sf.base.extend({},{},a[l]),a[l][n]=this.adaptor.processResponse(t.subQuery.using(new e(a[l][n].slice(0))).executeLocal(),this,t))}return this.adaptor.processResponse(i,this,t)},e.prototype.executeQuery=function(t,i,n,o){var a=this;"function"==typeof t&&(o=n,n=i,i=t,t=null),t||(t=this.defaultQuery),t instanceof r||s.throwError("DataManager - executeQuery() : A query is required to execute");var l=new x,h={query:t};if(!this.dataSource.offline&&void 0!==this.dataSource.url&&""!==this.dataSource.url||!sf.base.isNullOrUndefined(this.adaptor.makeRequest)||this.isCustomDataAdaptor(this.adaptor)){var d=this.adaptor.processQuery(this,t);sf.base.isNullOrUndefined(this.adaptor.makeRequest)?!sf.base.isNullOrUndefined(d.url)||this.isCustomDataAdaptor(this.adaptor)?(this.requests=[],this.makeRequest(d,l,h,t)):(h=e.getDeferedArgs(t,d,h),l.resolve(h)):this.adaptor.makeRequest(d,l,h,t)}else e.nextTick((function(){var i=a.executeLocal(t);h=e.getDeferedArgs(t,i,h),l.resolve(h)}));return(i||n)&&l.promise.then(i,n),o&&l.promise.then(o,o),l.promise},e.getDeferedArgs=function(e,t,i){return e.isCountRequired?(i.result=t.result,i.count=t.count,i.aggregates=t.aggregates):i.result=t,i},e.nextTick=function(e){(window.setImmediate||window.setTimeout)(e,0)},e.prototype.extendRequest=function(e,t,i){return sf.base.extend({},{type:"GET",dataType:this.dataSource.dataType,crossDomain:this.dataSource.crossDomain,jsonp:this.dataSource.jsonp,cache:!0,processData:!1,onSuccess:t,onFailure:i},e)},e.prototype.makeRequest=function(e,t,i,r){var n=this,o=!!r.subQuerySelector,a=function(e){i.error=e,t.reject(i)},l=function(e,r,n,o,s,a,l){i.xhr=n,i.count=r?parseInt(r.toString(),10):0,i.result=e,i.request=o,i.aggregates=a,i.actual=s,i.virtualSelectRecords=l,t.resolve(i)},h=function(e,t){var h=new x,d={parent:i};r.subQuery.isChild=!0;var c=n.adaptor.processQuery(n,r.subQuery,e?n.adaptor.processResponse(e):t),p=n.makeRequest(c,h,d,r.subQuery);return o||h.then((function(t){e&&(s.buildHierarchy(r.subQuery.fKey,r.subQuery.fromTable,e,t,r.subQuery.key),l(e,t.count,t.xhr))}),a),p},d=this.extendRequest(e,(function(e,t){if(n.isGraphQLAdaptor(n.adaptor)&&!sf.base.isNullOrUndefined(e.errors))return a(e.errors);n.isCustomDataAdaptor(n.adaptor)&&(t=sf.base.extend({},n.ajaxReqOption,t)),-1===t.httpRequest.getResponseHeader("Content-Type").indexOf("xml")&&n.dateParse&&(e=s.parse.parseJson(e));var i=n.adaptor.processResponse(e,n,r,t.httpRequest,t),d=0,c=null,p=e.virtualSelectRecords;r.isCountRequired&&(d=i.count,c=i.aggregates,i=i.result),r.subQuery?o||h(i,t):l(i,d,t.httpRequest,t.type,e,c,p)}),a);if(this.isCustomDataAdaptor(this.adaptor)){this.ajaxReqOption=d;var c=d;this.adaptor.options.getData({data:c.data,onSuccess:c.onSuccess,onFailure:c.onFailure})}else{var p=new sf.base.Ajax(d);p.beforeSend=function(){n.beforeSend(p.httpRequest,p)},(d=p.send()).catch((function(e){return!0})),this.requests.push(p)}if(o){var u=r.subQuerySelector.call(this,{query:r.subQuery,parent:r});u&&u.length?Promise.all([d,h(null,u)]).then((function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i=e[0],a=n.adaptor.processResponse(i[0],n,r,n.requests[0].httpRequest,n.requests[0]),h=0;r.isCountRequired&&(h=a.count,a=a.result);var d=n.adaptor.processResponse(i[1],n,r.subQuery,n.requests[1].httpRequest,n.requests[1]);h=0,r.subQuery.isCountRequired&&(h=d.count,d=d.result),s.buildHierarchy(r.subQuery.fKey,r.subQuery.fromTable,a,d,r.subQuery.key),o=!1,l(a,h,n.requests[0].httpRequest)})):o=!1}return d},e.prototype.beforeSend=function(e,t){this.adaptor.beforeSend(this,e,t);for(var i,r=this.dataSource.headers,n=0;r&&n<r.length;n++){i=[];for(var o=0,s=Object.keys(r[n]);o<s.length;o++){var a=s[o];i.push(a),e.setRequestHeader(a,r[n][a])}}},e.prototype.saveChanges=function(e,t,i,n,o){var s=this;i instanceof r&&(n=i,i=null);var a={url:i,key:t||this.dataSource.key},l=this.adaptor.batchRequest(this,e,a,n||new r,o);if(this.dataSource.offline)return l;if(sf.base.isNullOrUndefined(this.adaptor.doAjaxRequest)){if(this.isCustomDataAdaptor(this.adaptor))return this.doAjaxRequest(l,this.adaptor.options.batchUpdate);var h=new x,d=new sf.base.Ajax(l);return d.beforeSend=function(){s.beforeSend(d.httpRequest,d)},d.onSuccess=function(t,i){s.isGraphQLAdaptor(s.adaptor)&&(sf.base.isNullOrUndefined(t.errors)||d.onFailure(JSON.stringify(t.errors))),h.resolve(s.adaptor.processResponse(t,s,null,i.httpRequest,i,e,a))},d.onFailure=function(e){h.reject([{error:e}])},d.send().catch((function(e){return!0})),h.promise}return this.adaptor.doAjaxRequest(l)},e.prototype.insert=function(e,t,i,n){t instanceof r&&(i=t,t=null);var o=this.adaptor.insert(this,e,t,i,n);return this.dataSource.offline?o:sf.base.isNullOrUndefined(this.adaptor.doAjaxRequest)?this.doAjaxRequest(o,this.adaptor.options.addRecord):this.adaptor.doAjaxRequest(o)},e.prototype.remove=function(e,t,n,o){"object"===i(t)&&(t=s.getObject(e,t)),n instanceof r&&(o=n,n=null);var a=this.adaptor.remove(this,e,t,n,o);if(this.dataSource.offline)return a;if(sf.base.isNullOrUndefined(this.adaptor.doAjaxRequest)){var l=this.adaptor.options.deleteRecord;return this.doAjaxRequest(a,l)}return this.adaptor.doAjaxRequest(a)},e.prototype.update=function(e,t,i,n,o){i instanceof r&&(n=i,i=null);var s=this.adaptor.update(this,e,t,i,n,o);if(this.dataSource.offline)return s;if(sf.base.isNullOrUndefined(this.adaptor.doAjaxRequest)){var a=this.adaptor.options.updateRecord;return this.doAjaxRequest(s,a)}return this.adaptor.doAjaxRequest(s)},e.prototype.isCustomDataAdaptor=function(e){return this.adaptor.getModuleName&&"CustomDataAdaptor"===this.adaptor.getModuleName()},e.prototype.isGraphQLAdaptor=function(e){return this.adaptor.getModuleName&&"GraphQLAdaptor"===this.adaptor.getModuleName()},e.prototype.successFunc=function(e,t){if(this.isGraphQLAdaptor(this.adaptor)){var i=JSON.parse(e);sf.base.isNullOrUndefined(i.errors)||this.failureFunc(JSON.stringify(i.errors))}this.isCustomDataAdaptor(this.adaptor)&&(t=sf.base.extend({},this.ajaxReqOption,t));try{s.parse.parseJson(e)}catch(t){e=[]}e=this.adaptor.processResponse(s.parse.parseJson(e),this,null,t.httpRequest,t),this.ajaxDeffered.resolve(e)},e.prototype.failureFunc=function(e){this.ajaxDeffered.reject([{error:e}])},e.prototype.doAjaxRequest=function(e,t){var i=this;if(e=sf.base.extend({},{type:"POST",contentType:"application/json; charset=utf-8",processData:!1},e),this.ajaxDeffered=new x,this.isCustomDataAdaptor(this.adaptor))this.ajaxReqOption=e,t.call(this,{data:e.data,onSuccess:this.successFunc.bind(this),onFailure:this.failureFunc.bind(this)});else{var r=new sf.base.Ajax(e);r.beforeSend=function(){i.beforeSend(r.httpRequest,r)},r.onSuccess=this.successFunc.bind(this),r.onFailure=this.failureFunc.bind(this),r.send().catch((function(e){return!0}))}return this.ajaxDeffered.promise},e}(),x=function(){var e=this;this.promise=new Promise((function(t,i){e.resolve=t,e.reject=i})),this.then=this.promise.then.bind(this.promise),this.catch=this.promise.catch.bind(this.promise)};return e.DataManager=w,e.Deferred=x,e.Query=r,e.Predicate=n,e.Adaptor=h,e.JsonAdaptor=d,e.UrlAdaptor=c,e.ODataAdaptor=p,e.ODataV4Adaptor=u,e.WebApiAdaptor=g,e.WebMethodAdaptor=f,e.RemoteSaveAdaptor=m,e.CustomDataAdaptor=y,e.GraphQLAdaptor=v,e.CacheAdaptor=b,e.DataUtil=s,e},sf.data=sf.data({}),sfBlazor.initBlazorAdaptor()},"./modules/fileutils.js":function(e,t){window.sf=window.sf||{},window.sf.fileutils=function(e){"use strict";var t=function(){function e(){}return e.save=function(e,t){if(null==e||""===e)throw new Error("ArgumentException: fileName cannot be undefined, null or empty");var i=e.substring(e.lastIndexOf(".")+1,e.length),r=this.getMimeType(i);if(""!==r&&(t=new Blob([t],{type:r})),this.isMicrosoftBrowser)navigator.msSaveBlob(t,e);else{var n=document.createElementNS("http://www.w3.org/1999/xhtml","a");this.saveInternal(e,i,t,n,"download"in n)}},e.saveInternal=function(e,t,i,r,n){if(n){r.download=e;var o=window.URL.createObjectURL(i);r.href=o;var s=document.createEvent("MouseEvent");s.initEvent("click",!0,!0),r.dispatchEvent(s),setTimeout((function(){window.URL.revokeObjectURL(o),o=void 0}))}else if("docx"!==t&&"xlsx"!==t){var a=window.URL.createObjectURL(i);window.open(a,"_blank")||(window.location.href=a)}else{var l=new FileReader;l.onloadend=function(){window.open(l.result,"_blank")||(window.location.href=l.result)},l.readAsDataURL(i)}},e.getMimeType=function(e){var t="";switch(e){case"html":t="text/html";break;case"pdf":t="application/pdf";break;case"docx":t="application/vnd.openxmlformats-officedocument.wordprocessingml.document";break;case"xlsx":t="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet";break;case"txt":t="text/plain"}return t},e}(),i=function(){function e(){this.contentPos=0,this.bufferText="",this.bufferBlob=new Blob([""],{type:"text/plain"}),this.currentState="Initial",this.namespaceStack=[],this.namespaceStack.push(new r),this.namespaceStack[0].set("xmlns","http://www.w3.org/2000/xmlns/","Special"),this.namespaceStack.push(new r),this.namespaceStack[1].set("xml","http://www.w3.org/XML/1998/namespace","Special"),this.namespaceStack.push(new r),this.namespaceStack[2].set("","","Implied"),this.elementStack=[],this.elementStack.push(new n),this.elementStack[0].set("","","",this.namespaceStack.length-1),this.attributeStack=[],t.isMicrosoftBrowser=!!navigator.msSaveBlob}return Object.defineProperty(e.prototype,"buffer",{get:function(){return this.flush(),this.bufferBlob},enumerable:!0,configurable:!0}),e.prototype.writeProcessingInstruction=function(e,t){if(null==e||0===e.length)throw new Error("ArgumentException: name should not be undefined, null or empty");if(this.checkName(e),null==t&&(t=""),3===e.length&&"xml"===e&&"Initial"!==this.currentState)throw new Error("InvalidArgumentException: Cannot write XML declaration.WriteStartDocument method has already written it");if("Initial"!==this.currentState||void 0===this.bufferBlob)throw new Error("InvalidOperationException: Wrong Token");this.writeStartDocument(),this.writeProcessingInstructionInternal(e,t)},e.prototype.writeStartDocument=function(e){if("Initial"!==this.currentState||void 0===this.bufferBlob)throw new Error("InvalidOperationException: Wrong Token");this.currentState="StartDocument",this.rawText('<?xml version="1.0" encoding="utf-8'),null!=e&&(this.rawText('" standalone="'),this.rawText(e?"yes":"no")),this.rawText('"?>')},e.prototype.writeEndDocument=function(){for(;this.elementStack.length-1>0;)this.writeEndElement();this.currentState="EndDocument",this.flush()},e.prototype.writeStartElement=function(e,t,i){if(void 0===this.bufferBlob)throw new Error("InvalidOperationException: Wrong Token");if(null==t||0===t.length)throw new Error("ArgumentException: localName cannot be undefined, null or empty");if(this.checkName(t),"Initial"===this.currentState&&this.writeStartDocument(),"StartElement"===this.currentState&&this.startElementContent(),this.currentState="StartElement",null==e)null!=i&&(e=this.lookupPrefix(i)),null==e&&(e="");else if(e.length>0&&(null==i&&(i=this.lookupNamespace(e)),null==i||void 0!==i&&0===i.length))throw new Error("ArgumentException: Cannot use a prefix with an empty namespace");null==i&&(i=this.lookupNamespace(e)),this.writeStartElementInternal(e,t,i)},e.prototype.writeEndElement=function(){"StartElement"===this.currentState?(this.startElementContent(),this.currentState="ElementContent"):"ElementContent"===this.currentState&&(this.currentState="ElementContent"),this.currentState="EndElement";var e=this.elementStack.length-1;this.writeEndElementInternal(this.elementStack[e].prefix,this.elementStack[e].localName),this.namespaceStack.splice(this.elementStack[e].previousTop+1),this.elementStack.splice(e),this.bufferText.length>10240&&this.flush()},e.prototype.writeElementString=function(e,t,i,r){this.writeStartElement(e,t,i),null!=r&&0!==r.length&&this.writeString(r),this.writeEndElement()},e.prototype.writeAttributeString=function(e,t,i,r){this.writeStartAttribute(e,t,i,r),this.writeStringInternal(r,!0),this.writeEndAttribute()},e.prototype.writeString=function(e){this.writeInternal(e,!1)},e.prototype.writeRaw=function(e){this.writeInternal(e,!0)},e.prototype.writeInternal=function(e,t){if(null!=e){if("StartElement"!==this.currentState&&"ElementContent"!==this.currentState)throw new Error("InvalidOperationException: Wrong Token");"StartElement"===this.currentState&&this.startElementContent(),this.currentState="ElementContent",t?this.rawText(e):this.writeStringInternal(e,!1)}},e.prototype.save=function(e){for(;this.elementStack.length-1>0;)this.writeEndElement();""!==this.bufferText&&this.flush(),t.save(e,this.buffer)},e.prototype.destroy=function(){this.bufferBlob=void 0;for(var e=0;e<this.namespaceStack.length;e++)this.namespaceStack[e].destroy();this.namespaceStack=[];for(e=0;e<this.elementStack.length;e++)this.elementStack[e].destroy();this.elementStack=[],this.bufferText="",this.contentPos=0},e.prototype.flush=function(){void 0!==this.bufferBlob&&(this.bufferBlob=new Blob([this.bufferBlob,this.bufferText],{type:"text/plain"}),this.bufferText="")},e.prototype.writeProcessingInstructionInternal=function(e,t){this.bufferText+="<?",this.rawText(e),t.length>0&&(this.bufferText+=" ",t=t.replace(/\?\>/g,"? >"),this.bufferText+=t),this.bufferText+="?",this.bufferText+=">"},e.prototype.writeStartAttribute=function(e,t,i,r){if(null==t||0===t.length){if("xmlns"!==e)throw new Error("ArgumentException: localName cannot be undefined, null or empty");t="xmlns",e=""}if("StartElement"!==this.currentState)throw new Error("InvalidOperationException: Wrong Token");this.checkName(t),this.writeStartAttributePrefixAndNameSpace(e,t,i,r)},e.prototype.writeStartAttributePrefixAndNameSpace=function(e,t,i,r){null==e&&(null!=i&&("xmlns"===t&&"http://www.w3.org/2000/xmlns/"===i||(e=this.lookupPrefix(i))),null==e&&(e="")),null==i&&(null!=e&&e.length>0&&(i=this.lookupNamespace(e)),null==i&&(i="")),this.writeStartAttributeSpecialAttribute(e,t,i,r)},e.prototype.writeStartAttributeSpecialAttribute=function(e,t,i,r){if(0===e.length){if("x"===t[0]&&"xmlns"===t)return this.skipPushAndWrite(e,t,i),void this.pushNamespaceExplicit("",r);i.length>0&&(e=this.lookupPrefix(i))}else{if("x"===e[0]){if("xmlns"===e)return this.skipPushAndWrite(e,t,i),void this.pushNamespaceExplicit(t,r);if("xml"===e&&("space"===t||"lang"===t))return void this.skipPushAndWrite(e,t,i)}0===i.length&&(e="")}null!=e&&0!==e.length&&this.pushNamespaceImplicit(e,i),this.skipPushAndWrite(e,t,i)},e.prototype.writeEndAttribute=function(){this.currentState="StartElement",this.bufferText+='"'},e.prototype.writeStartElementInternal=function(e,t,i){this.bufferText+="<",e.length>0&&(this.rawText(e),this.bufferText+=":"),this.rawText(t);var r=this.elementStack.length;this.elementStack.push(new n),this.elementStack[r].set(e,t,i,this.namespaceStack.length-1),this.pushNamespaceImplicit(e,i);for(var o=0;o<this.attributeStack.length;o++)this.attributeStack[o].destroy();this.attributeStack=[]},e.prototype.writeEndElementInternal=function(e,t){this.contentPos!==this.bufferText.length+1?(this.bufferText+="</",null!=e&&0!==e.length&&(this.rawText(e),this.bufferText+=":"),this.rawText(t),this.bufferText+=">"):(this.bufferText=this.bufferText.substring(0,this.bufferText.length-1),this.bufferText+=" />")},e.prototype.writeStartAttributeInternal=function(e,t,i){this.bufferText+=" ",null!=e&&e.length>0&&(this.rawText(e),this.bufferText+=":"),this.rawText(t),this.bufferText+="=",this.bufferText+='"'},e.prototype.writeNamespaceDeclaration=function(e,t){this.writeStartNamespaceDeclaration(e),this.writeStringInternal(t,!0),this.bufferText+='"'},e.prototype.writeStartNamespaceDeclaration=function(e){null==e||0===e.length?this.rawText(' xmlns="'):(this.rawText(" xmlns:"),this.rawText(e),this.bufferText+="=",this.bufferText+='"')},e.prototype.writeStringInternal=function(e,t){null==e&&(e=""),e=(e=(e=e.replace(/\&/g,"&amp;")).replace(/\</g,"&lt;")).replace(/\>/g,"&gt;"),t&&(e=e.replace(/\"/g,"&quot;")),this.bufferText+=e,t||(this.contentPos=0)},e.prototype.startElementContent=function(){for(var e=this.elementStack[this.elementStack.length-1].previousTop,t=this.namespaceStack.length-1;t>e;t--)"NeedToWrite"===this.namespaceStack[t].kind&&this.writeNamespaceDeclaration(this.namespaceStack[t].prefix,this.namespaceStack[t].namespaceUri);this.bufferText+=">",this.contentPos=this.bufferText.length+1},e.prototype.rawText=function(e){this.bufferText+=e},e.prototype.addNamespace=function(e,t,i){var n=this.namespaceStack.length;this.namespaceStack.push(new r),this.namespaceStack[n].set(e,t,i)},e.prototype.lookupPrefix=function(e){for(var t=this.namespaceStack.length-1;t>=0;t--)if(this.namespaceStack[t].namespaceUri===e)return this.namespaceStack[t].prefix},e.prototype.lookupNamespace=function(e){for(var t=this.namespaceStack.length-1;t>=0;t--)if(this.namespaceStack[t].prefix===e)return this.namespaceStack[t].namespaceUri},e.prototype.lookupNamespaceIndex=function(e){for(var t=this.namespaceStack.length-1;t>=0;t--)if(this.namespaceStack[t].prefix===e)return t;return-1},e.prototype.pushNamespaceImplicit=function(e,t){var i,r=this.lookupNamespaceIndex(e);if(-1!==r){if(r>this.elementStack[this.elementStack.length-1].previousTop){if(this.namespaceStack[r].namespaceUri!==t)throw new Error("XmlException namespace Uri needs to be the same as the one that is already declared");return}if("Special"===this.namespaceStack[r].kind){if("xml"!==e)throw new Error('InvalidArgumentException: Prefix "xmlns" is reserved for use by XML.');if(t!==this.namespaceStack[r].namespaceUri)throw new Error("InvalidArgumentException: Xml String");i="Implied"}else i=this.namespaceStack[r].namespaceUri===t?"Implied":"NeedToWrite"}else{if("http://www.w3.org/XML/1998/namespace"===t&&"xml"!==e||"http://www.w3.org/2000/xmlns/"===t&&"xmlns"!==e)throw new Error("InvalidArgumentException");i="NeedToWrite"}this.addNamespace(e,t,i)},e.prototype.pushNamespaceExplicit=function(e,t){var i=this.lookupNamespaceIndex(e);-1!==i&&i>this.elementStack[this.elementStack.length-1].previousTop?this.namespaceStack[i].kind="Written":this.addNamespace(e,t,"Written")},e.prototype.addAttribute=function(e,t,i){var r=this.attributeStack.length;this.attributeStack.push(new o),this.attributeStack[r].set(e,t,i);for(var n=0;n<r;n++)if(this.attributeStack[n].isDuplicate(e,t,i))throw new Error("XmlException: duplicate attribute name")},e.prototype.skipPushAndWrite=function(e,t,i){this.addAttribute(e,t,i),this.writeStartAttributeInternal(e,t,i)},e.prototype.checkName=function(e){if(/[ !@#$%^&*()+\=\[\]{};':"\\|,<>\/?]/.test(e))throw new Error("InvalidArgumentException: invalid name character")},e}(),r=function(){function e(){}return e.prototype.set=function(e,t,i){this.prefix=e,this.namespaceUri=t,this.kind=i},e.prototype.destroy=function(){this.prefix=void 0,this.namespaceUri=void 0,this.kind=void 0},e}(),n=function(){function e(){}return e.prototype.set=function(e,t,i,r){this.previousTop=r,this.prefix=e,this.namespaceUri=i,this.localName=t},e.prototype.destroy=function(){this.previousTop=void 0,this.prefix=void 0,this.localName=void 0,this.namespaceUri=void 0},e}(),o=function(){function e(){}return e.prototype.set=function(e,t,i){this.prefix=e,this.namespaceUri=i,this.localName=t},e.prototype.isDuplicate=function(e,t,i){return this.localName===t&&(this.prefix===e||this.namespaceUri===i)},e.prototype.destroy=function(){this.prefix=void 0,this.namespaceUri=void 0,this.localName=void 0},e}(),s=function(){function e(e){this.emitBOM=!0,this.encodingType="Ansi",this.initBOM(e)}return Object.defineProperty(e.prototype,"includeBom",{get:function(){return this.emitBOM},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"type",{get:function(){return this.encodingType},set:function(e){this.encodingType=e},enumerable:!0,configurable:!0}),e.prototype.initBOM=function(e){this.emitBOM=null==e||e},e.prototype.getByteCount=function(e){return a(e,"string"),""===e?this.utf8Len(e.charCodeAt(0)):(null!==this.type&&void 0!==this.type||(this.type="Ansi"),this.getByteCountInternal(e,0,e.length))},e.prototype.utf8Len=function(e){return e<=127?1:e<=2047?2:e<=65535?3:e<=2097151?4:0},e.prototype.isHighSurrogate=function(e){return e>=55296&&e<=56319},e.prototype.toCodepoint=function(e,t){return((e=(1023&e)<<10)|1023&t)+65536},e.prototype.getByteCountInternal=function(e,t,i){var r=0;if("Utf8"===this.encodingType||"Unicode"===this.encodingType){for(var n="Utf8"===this.encodingType,o=0;o<i;o++){var s=e.charCodeAt(n?t:t++);if(this.isHighSurrogate(s))if(n){var a=s,l=e.charCodeAt(++t);r+=this.utf8Len(this.toCodepoint(a,l))}else r+=4,++o;else r+=n?this.utf8Len(s):2;n&&t++}return r}return r=i},e.prototype.getBytes=function(e,t,i){if(a(e,"string"),a(t,"charIndex"),a(i,"charCount"),t<0||i<0)throw new RangeError("Argument Out Of Range Exception: charIndex or charCount is less than zero");if(e.length-t<i)throw new RangeError("Argument Out Of Range Exception: charIndex and charCount do not denote a valid range in string");if(""===e)return new ArrayBuffer(0);null!==this.type&&void 0!==this.type||(this.type="Ansi");var r=this.getByteCountInternal(e,t,i);switch(this.type){case"Utf8":return this.getBytesOfUtf8Encoding(r,e,t,i);case"Unicode":return this.getBytesOfUnicodeEncoding(r,e,t,i);default:return this.getBytesOfAnsiEncoding(r,e,t,i)}},e.prototype.getString=function(e,t,i){if(a(e,"bytes"),a(t,"index"),a(i,"count"),t<0||i<0)throw new RangeError("Argument Out Of Range Exception: index or count is less than zero");if(e.byteLength-t<i)throw new RangeError("Argument Out Of Range Exception: index and count do not denote a valid range in bytes");if(0===e.byteLength||0===i)return"";null!==this.type&&void 0!==this.type||(this.type="Ansi");var r="",n=new Uint8Array(e);switch(this.type){case"Utf8":return this.getStringOfUtf8Encoding(n,t,i);case"Unicode":var o=new Uint16Array(e);return r=this.getStringofUnicodeEncoding(o,t,i);default:for(var s=t,l=0;l<i;l++){var h=n[s];r+=String.fromCharCode(h),s++}return r}},e.prototype.getBytesOfAnsiEncoding=function(e,t,i,r){for(var n=new ArrayBuffer(e),o=new Uint8Array(n),s=0,a=0;a<r;a++){var l=t.charCodeAt(i++);o[s]=l<2048?l:63,s++}return n},e.prototype.getBytesOfUtf8Encoding=function(e,t,i,r){for(var n=new ArrayBuffer(e),o=new Uint8Array(n),s=i,a=0,l=0;l<r;l++){var h=t.charCodeAt(s);h<=127?o[a]=h:h<2048?(o[a]=192|h>>6,o[++a]=128|63&h):h<55296||h>=57344?(o[a]=224|h>>12,o[++a]=128|h>>6&63,o[++a]=128|63&h):(o[a]=239,o[++a]=191,o[++a]=189),++a,++s}return n},e.prototype.getBytesOfUnicodeEncoding=function(e,t,i,r){for(var n=new ArrayBuffer(e),o=new Uint16Array(n),s=0;s<r;s++){var a=t.charCodeAt(s);o[s]=a}return n},e.prototype.getStringOfUtf8Encoding=function(e,t,i){for(var r=0,n=t,o="";r<i;r++){for(var s=e[n++];n>e.length;)return o;s>127&&(s>191&&s<224&&n<i?s=(31&s)<<6|63&e[n]:s>223&&s<240&&n<e.byteLength?s=(15&s)<<12|(63&e[n])<<6|63&e[++n]:s>239&&s<248&&n<e.byteLength&&(s=(7&s)<<18|(63&e[n])<<12|(63&e[++n])<<6|63&e[++n]),++n),o+=String.fromCharCode(s)}return o},e.prototype.getStringofUnicodeEncoding=function(e,t,i){if(i>e.length)throw new RangeError("ArgumentOutOfRange_Count");for(var r=new Uint16Array(i),n=0;n<i&&n<e.length;n++)r[n]=e[t++];return String.fromCharCode.apply(null,r)},e.prototype.destroy=function(){this.emitBOM=void 0,this.encodingType=void 0},e}();function a(e,t){if(null==e)throw new Error("ArgumentException: "+t+" cannot be null or undefined")}var l=function(){function e(e){this.bufferBlob=new Blob([""]),this.bufferText="",this.init(e),t.isMicrosoftBrowser=!!navigator.msSaveBlob}return Object.defineProperty(e.prototype,"buffer",{get:function(){return this.flush(),this.bufferBlob},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"encoding",{get:function(){return this.enc},enumerable:!0,configurable:!0}),e.prototype.init=function(e){null==e?(this.enc=new s(!1),this.enc.type="Utf8"):(this.enc=e,this.setBomByte())},e.prototype.setBomByte=function(){if(this.encoding.includeBom)switch(this.encoding.type){case"Unicode":var e=new ArrayBuffer(2),t=new Uint8Array(e);t[0]=255,t[1]=254,this.bufferBlob=new Blob([e]);break;case"Utf8":var i=new ArrayBuffer(3),r=new Uint8Array(i);r[0]=239,r[1]=187,r[2]=191,this.bufferBlob=new Blob([i]);break;default:this.bufferBlob=new Blob([""])}},e.prototype.save=function(e){""!==this.bufferText&&this.flush(),t.save(e,this.buffer)},e.prototype.write=function(e){if(void 0===this.encoding)throw new Error("Object Disposed Exception: current writer is disposed");a(e,"string"),this.bufferText+=e,this.bufferText.length>=10240&&this.flush()},e.prototype.flush=function(){if(void 0!==this.bufferText&&null!==this.bufferText&&0!==this.bufferText.length){var e=this.encoding.getBytes(this.bufferText,0,this.bufferText.length);this.bufferText="",this.bufferBlob=new Blob([this.bufferBlob,e])}},e.prototype.writeLine=function(e){if(void 0===this.encoding)throw new Error("Object Disposed Exception: current writer is disposed");a(e,"string"),this.bufferText=this.bufferText+e+"\r\n",this.bufferText.length>=10240&&this.flush()},e.prototype.destroy=function(){this.bufferBlob=void 0,this.bufferText=void 0,this.enc instanceof s&&this.enc.destroy(),this.enc=void 0},e}();return e.XmlWriter=i,e.Namespace=r,e.XmlElement=n,e.XmlAttribute=o,e.StreamWriter=l,e.Encoding=s,e.validateNullOrUndefined=a,e.Save=t,e}({})},"./modules/navigationsbase.js":function(e,t){function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}window.sf=window.sf||{};window.sf.navigations=window.sf.base.extend({},window.sf.navigations,function(e){"use strict";var t,r,n=(t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,i)},function(e,i){function r(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}),o=function(e,t,r,n){var o,s=arguments.length,a=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(s<3?o(a):s>3?o(t,r,a):o(t,r))||a);return s>3&&a&&Object.defineProperty(t,r,a),a},s=function(e){function t(t,i){return e.call(this,t,i)||this}return n(t,e),t.prototype.preRender=function(){this.browser=sf.base.Browser.info.name,this.browserCheck="mozilla"===this.browser,this.isDevice=sf.base.Browser.isDevice,this.customStep=!0;var e=this.element;this.ieCheck="edge"===this.browser||"msie"===this.browser,this.initialize(),""===e.id&&(e.id=sf.base.getUniqueID("hscroll"),this.uniqueId=!0),e.style.display="block",this.enableRtl&&e.classList.add("e-rtl")},t.prototype.render=function(){this.touchModule=new sf.base.Touch(this.element,{scroll:this.touchHandler.bind(this),swipe:this.swipeHandler.bind(this)}),sf.base.EventHandler.add(this.scrollEle,"scroll",this.scrollHandler,this),this.isDevice?(this.element.classList.add("e-scroll-device"),this.createOverlay(this.element)):this.createNavIcon(this.element),this.setScrollState()},t.prototype.setScrollState=function(){sf.base.isNullOrUndefined(this.scrollStep)||this.scrollStep<0?(this.scrollStep=this.scrollEle.offsetWidth,this.customStep=!1):this.customStep=!0},t.prototype.initialize=function(){var e=this.createElement("div",{className:"e-hscroll-content"}),t=this.createElement("div",{className:"e-hscroll-bar"});t.setAttribute("tabindex","-1");for(var i=this.element,r=0,n=[].slice.call(i.children);r<n.length;r++){var o=n[r];e.appendChild(o)}t.appendChild(e),i.appendChild(t),t.style.overflowX="hidden",this.scrollEle=t,this.scrollItems=e},t.prototype.getPersistData=function(){return this.addOnPersist(["scrollStep"])},t.prototype.getModuleName=function(){return"hScroll"},t.prototype.destroy=function(){var t=this.element;t.style.display="",t.classList.remove("e-hscroll"),t.classList.remove("e-scroll-device");var i=sf.base.selectAll(".e-"+t.id+"_nav.e-scroll-nav",t),r=sf.base.selectAll(".e-scroll-overlay",t);[].slice.call(r).forEach((function(e){sf.base.detach(e)}));for(var n=0,o=[].slice.call(this.scrollItems.children);n<o.length;n++){var s=o[n];t.appendChild(s)}this.uniqueId&&this.element.removeAttribute("id"),sf.base.detach(this.scrollEle),i.length>0&&(sf.base.detach(i[0]),sf.base.isNullOrUndefined(i[1])||sf.base.detach(i[1])),sf.base.EventHandler.remove(this.scrollEle,"scroll",this.scrollHandler),this.touchModule.destroy(),this.touchModule=null,e.prototype.destroy.call(this)},t.prototype.disable=function(e){var t=sf.base.selectAll(".e-scroll-nav:not(.e-overlay)",this.element);e?this.element.classList.add("e-overlay"):this.element.classList.remove("e-overlay"),[].slice.call(t).forEach((function(t){t.setAttribute("tabindex",e?"-1":"0")}))},t.prototype.createOverlay=function(e){var t=e.id.concat("_nav"),i=this.createElement("div",{className:"e-scroll-overlay e-scroll-right-overlay"}),r="e-"+e.id.concat("_nav e-scroll-nav e-scroll-right-nav"),n=this.createElement("div",{id:t.concat("_right"),className:r}),o=this.createElement("div",{className:"e-nav-right-arrow e-nav-arrow e-icons"});n.appendChild(o);var s=this.createElement("div",{className:"e-scroll-overlay e-scroll-left-overlay"});this.ieCheck&&n.classList.add("e-ie-align"),e.appendChild(i),e.appendChild(n),e.insertBefore(s,e.firstChild),this.eventBinding([n])},t.prototype.createNavIcon=function(e){var t=e.id.concat("_nav"),i="e-"+e.id.concat("_nav e-scroll-nav e-scroll-right-nav"),r={role:"button",id:t.concat("_right"),"aria-label":"Scroll right"},n=this.createElement("div",{className:i,attrs:r});n.setAttribute("aria-disabled","false");var o=this.createElement("div",{className:"e-nav-right-arrow e-nav-arrow e-icons"}),s="e-"+e.id.concat("_nav e-scroll-nav e-scroll-left-nav"),a={role:"button",id:t.concat("_left"),"aria-label":"Scroll left"},l=this.createElement("div",{className:s+" e-overlay",attrs:a});l.setAttribute("aria-disabled","true");var h=this.createElement("div",{className:"e-nav-left-arrow e-nav-arrow e-icons"});l.appendChild(h),n.appendChild(o),e.appendChild(n),e.insertBefore(l,e.firstChild),this.ieCheck&&(n.classList.add("e-ie-align"),l.classList.add("e-ie-align")),this.eventBinding([n,l])},t.prototype.onKeyPress=function(e){var t=this;if("Enter"===e.key){this.keyTimer=window.setTimeout((function(){t.keyTimeout=!0,t.eleScrolling(10,e.target,!0)}),100)}},t.prototype.onKeyUp=function(e){"Enter"===e.key&&(this.keyTimeout?this.keyTimeout=!1:e.target.click(),clearTimeout(this.keyTimer))},t.prototype.eventBinding=function(e){var t=this;[].slice.call(e).forEach((function(e){new sf.base.Touch(e,{tapHold:t.tabHoldHandler.bind(t),tapHoldThreshold:500}),e.addEventListener("keydown",t.onKeyPress.bind(t)),e.addEventListener("keyup",t.onKeyUp.bind(t)),e.addEventListener("mouseup",t.repeatScroll.bind(t)),e.addEventListener("touchend",t.repeatScroll.bind(t)),e.addEventListener("contextmenu",(function(e){e.preventDefault()})),sf.base.EventHandler.add(e,"click",t.clickEventHandler,t)}))},t.prototype.repeatScroll=function(){clearInterval(this.timeout)},t.prototype.tabHoldHandler=function(e){var t=this,i=e.originalEvent.target;i=this.contains(i,"e-scroll-nav")?i.firstElementChild:i;this.timeout=window.setInterval((function(){t.eleScrolling(10,i,!0)}),50)},t.prototype.contains=function(e,t){return e.classList.contains(t)},t.prototype.eleScrolling=function(e,t,i){var r=this.element,n=t.classList;n.contains("e-scroll-nav")&&(n=t.querySelector(".e-nav-arrow").classList),this.contains(r,"e-rtl")&&this.browserCheck&&(e=-e),!this.contains(r,"e-rtl")||this.browserCheck||this.ieCheck?n.contains("e-nav-right-arrow")?this.frameScrollRequest(e,"add",i):this.frameScrollRequest(e,"",i):n.contains("e-nav-left-arrow")?this.frameScrollRequest(e,"add",i):this.frameScrollRequest(e,"",i)},t.prototype.clickEventHandler=function(e){this.eleScrolling(this.scrollStep,e.target,!1)},t.prototype.swipeHandler=function(e){var t,i=this.scrollEle;t=e.velocity<=1?e.distanceX/(10*e.velocity):e.distanceX/e.velocity;var r=.5;!function n(){var o=Math.sin(r);o<=0?window.cancelAnimationFrame(o):("Left"===e.swipeDirection?i.scrollLeft+=t*o:"Right"===e.swipeDirection&&(i.scrollLeft-=t*o),r-=.5,window.requestAnimationFrame(n))}()},t.prototype.scrollUpdating=function(e,t){"add"===t?this.scrollEle.scrollLeft+=e:this.scrollEle.scrollLeft-=e},t.prototype.frameScrollRequest=function(e,t,i){var r=this;if(i)this.scrollUpdating(e,t);else{this.customStep||[].slice.call(sf.base.selectAll(".e-scroll-overlay",this.element)).forEach((function(t){e-=t.offsetWidth}));!function i(){var n,o;r.contains(r.element,"e-rtl")&&r.browserCheck?(n=-e,o=-10):(n=e,o=10),n<10?window.cancelAnimationFrame(o):(r.scrollUpdating(o,t),e-=o,window.requestAnimationFrame(i))}()}},t.prototype.touchHandler=function(e){var t=this.scrollEle,i=e.distanceX;this.ieCheck&&this.contains(this.element,"e-rtl")&&(i=-i),"Left"===e.scrollDirection?t.scrollLeft=t.scrollLeft+i:"Right"===e.scrollDirection&&(t.scrollLeft=t.scrollLeft-i)},t.prototype.arrowDisabling=function(e,t){if(this.isDevice){var i=(sf.base.isNullOrUndefined(e)?t:e).querySelector(".e-nav-arrow");sf.base.isNullOrUndefined(e)?sf.base.classList(i,["e-nav-right-arrow"],["e-nav-left-arrow"]):sf.base.classList(i,["e-nav-left-arrow"],["e-nav-right-arrow"])}else e&&t&&(e.classList.add("e-overlay"),e.setAttribute("aria-disabled","true"),e.removeAttribute("tabindex"),t.classList.remove("e-overlay"),t.setAttribute("aria-disabled","false"),t.setAttribute("tabindex","0"));this.repeatScroll()},t.prototype.scrollHandler=function(e){var t=e.target,i=t.offsetWidth,r=(this.element,this.element.querySelector(".e-scroll-left-nav")),n=this.element.querySelector(".e-scroll-right-nav"),o=this.element.querySelector(".e-scroll-left-overlay"),s=this.element.querySelector(".e-scroll-right-overlay"),a=t.scrollLeft;if(a<=0&&(a=-a),this.isDevice&&(!this.enableRtl||this.browserCheck||this.ieCheck||(o=this.element.querySelector(".e-scroll-right-overlay"),s=this.element.querySelector(".e-scroll-left-overlay")),o.style.width=a<40?a+"px":"40px",t.scrollWidth-Math.ceil(i+a)<40?s.style.width=t.scrollWidth-Math.ceil(i+a)+"px":s.style.width="40px"),0===a)this.arrowDisabling(r,n);else if(Math.ceil(i+a+.1)>=t.scrollWidth)this.arrowDisabling(n,r);else{var l=this.element.querySelector(".e-scroll-nav.e-overlay");l&&(l.classList.remove("e-overlay"),l.setAttribute("aria-disabled","false"),l.setAttribute("tabindex","0"))}},t.prototype.onPropertyChanged=function(e,t){for(var i=0,r=Object.keys(e);i<r.length;i++){switch(r[i]){case"scrollStep":this.setScrollState();break;case"enableRtl":e.enableRtl?this.element.classList.add("e-rtl"):this.element.classList.remove("e-rtl")}}},o([sf.base.Property(null)],t.prototype,"scrollStep",void 0),t=o([sf.base.NotifyPropertyChanges],t)}(sf.base.Component),a=(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),l=function(e,t,r,n){var o,s=arguments.length,a=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(s<3?o(a):s>3?o(t,r,a):o(t,r))||a);return s>3&&a&&Object.defineProperty(t,r,a),a},h=function(e){function t(t,i){return e.call(this,t,i)||this}return a(t,e),t.prototype.preRender=function(){this.browser=sf.base.Browser.info.name,this.browserCheck="mozilla"===this.browser,this.isDevice=sf.base.Browser.isDevice,this.customStep=!0;var e=this.element;this.ieCheck="edge"===this.browser||"msie"===this.browser,this.initialize(),""===e.id&&(e.id=sf.base.getUniqueID("vscroll"),this.uniqueId=!0),e.style.display="block",this.enableRtl&&e.classList.add("e-rtl")},t.prototype.render=function(){this.touchModule=new sf.base.Touch(this.element,{scroll:this.touchHandler.bind(this),swipe:this.swipeHandler.bind(this)}),sf.base.EventHandler.add(this.scrollEle,"scroll",this.scrollEventHandler,this),this.isDevice?(this.element.classList.add("e-scroll-device"),this.createOverlayElement(this.element)):this.createNavIcon(this.element),this.setScrollState(),sf.base.EventHandler.add(this.element,"wheel",this.wheelEventHandler,this)},t.prototype.setScrollState=function(){sf.base.isNullOrUndefined(this.scrollStep)||this.scrollStep<0?(this.scrollStep=this.scrollEle.offsetHeight,this.customStep=!1):this.customStep=!0},t.prototype.initialize=function(){var e=sf.base.createElement("div",{className:"e-vscroll-content"}),t=sf.base.createElement("div",{className:"e-vscroll-bar"});t.setAttribute("tabindex","-1");for(var i=this.element,r=0,n=[].slice.call(i.children);r<n.length;r++){var o=n[r];e.appendChild(o)}t.appendChild(e),i.appendChild(t),t.style.overflow="hidden",this.scrollEle=t,this.scrollItems=e},t.prototype.getPersistData=function(){return this.addOnPersist(["scrollStep"])},t.prototype.getModuleName=function(){return"vScroll"},t.prototype.destroy=function(){var t=this.element;t.style.display="",sf.base.removeClass([this.element],["e-vscroll","e-scroll-device"]);var i=sf.base.selectAll(".e-"+t.id+"_nav.e-scroll-nav",t),r=sf.base.selectAll(".e-scroll-overlay",t);[].slice.call(r).forEach((function(e){sf.base.detach(e)}));for(var n=0,o=[].slice.call(this.scrollItems.children);n<o.length;n++){var s=o[n];t.appendChild(s)}this.uniqueId&&this.element.removeAttribute("id"),sf.base.detach(this.scrollEle),i.length>0&&(sf.base.detach(i[0]),sf.base.isNullOrUndefined(i[1])||sf.base.detach(i[1])),sf.base.EventHandler.remove(this.scrollEle,"scroll",this.scrollEventHandler),this.touchModule.destroy(),this.touchModule=null,e.prototype.destroy.call(this)},t.prototype.disable=function(e){var t=sf.base.selectAll(".e-scroll-nav:not(.e-overlay)",this.element);e?this.element.classList.add("e-overlay"):this.element.classList.remove("e-overlay"),[].slice.call(t).forEach((function(t){t.setAttribute("tabindex",e?"-1":"0")}))},t.prototype.createOverlayElement=function(e){var t=e.id.concat("_nav"),i=sf.base.createElement("div",{className:"e-scroll-overlay e-scroll-down-overlay"}),r="e-"+e.id.concat("_nav e-scroll-nav e-scroll-down-nav"),n=sf.base.createElement("div",{id:t.concat("down"),className:r}),o=sf.base.createElement("div",{className:"e-nav-down-arrow e-nav-arrow e-icons"});n.appendChild(o);var s=sf.base.createElement("div",{className:"e-scroll-overlay e-scroll-up-overlay"});this.ieCheck&&n.classList.add("e-ie-align"),e.appendChild(i),e.appendChild(n),e.insertBefore(s,e.firstChild),this.eventBinding([n])},t.prototype.createNavIcon=function(e){var t=e.id.concat("_nav"),i="e-"+e.id.concat("_nav e-scroll-nav e-scroll-down-nav"),r=sf.base.createElement("div",{id:t.concat("_down"),className:i});r.setAttribute("aria-disabled","false");var n=sf.base.createElement("div",{className:"e-nav-down-arrow e-nav-arrow e-icons"}),o="e-"+e.id.concat("_nav e-scroll-nav e-scroll-up-nav"),s=sf.base.createElement("div",{id:t.concat("_up"),className:o+" e-overlay"});s.setAttribute("aria-disabled","true");var a=sf.base.createElement("div",{className:"e-nav-up-arrow e-nav-arrow e-icons"});s.appendChild(a),r.appendChild(n),r.setAttribute("tabindex","0"),e.appendChild(r),e.insertBefore(s,e.firstChild),this.ieCheck&&(r.classList.add("e-ie-align"),s.classList.add("e-ie-align")),this.eventBinding([r,s])},t.prototype.onKeyPress=function(e){var t=this;if("Enter"===e.key){this.keyTimer=window.setTimeout((function(){t.keyTimeout=!0,t.eleScrolling(10,e.target,!0)}),100)}},t.prototype.onKeyUp=function(e){"Enter"===e.key&&(this.keyTimeout?this.keyTimeout=!1:e.target.click(),clearTimeout(this.keyTimer))},t.prototype.eventBinding=function(e){var t=this;[].slice.call(e).forEach((function(e){new sf.base.Touch(e,{tapHold:t.tabHoldHandler.bind(t),tapHoldThreshold:500}),e.addEventListener("keydown",t.onKeyPress.bind(t)),e.addEventListener("keyup",t.onKeyUp.bind(t)),e.addEventListener("mouseup",t.repeatScroll.bind(t)),e.addEventListener("touchend",t.repeatScroll.bind(t)),e.addEventListener("contextmenu",(function(e){e.preventDefault()})),sf.base.EventHandler.add(e,"click",t.clickEventHandler,t)}))},t.prototype.repeatScroll=function(){clearInterval(this.timeout)},t.prototype.tabHoldHandler=function(e){var t=this,i=e.originalEvent.target;i=this.contains(i,"e-scroll-nav")?i.firstElementChild:i;this.timeout=window.setInterval((function(){t.eleScrolling(10,i,!0)}),50)},t.prototype.contains=function(e,t){return e.classList.contains(t)},t.prototype.eleScrolling=function(e,t,i){var r=t.classList;r.contains("e-scroll-nav")&&(r=t.querySelector(".e-nav-arrow").classList),r.contains("e-nav-down-arrow")?this.frameScrollRequest(e,"add",i):r.contains("e-nav-up-arrow")&&this.frameScrollRequest(e,"",i)},t.prototype.clickEventHandler=function(e){this.eleScrolling(this.scrollStep,e.target,!1)},t.prototype.wheelEventHandler=function(e){e.preventDefault(),this.frameScrollRequest(this.scrollStep,e.deltaY>0?"add":"",!1)},t.prototype.swipeHandler=function(e){var t,i=this.scrollEle;t=e.velocity<=1?e.distanceY/(10*e.velocity):e.distanceY/e.velocity;var r=.5;!function n(){var o=Math.sin(r);o<=0?window.cancelAnimationFrame(o):("Up"===e.swipeDirection?i.scrollTop+=t*o:"Down"===e.swipeDirection&&(i.scrollTop-=t*o),r-=.02,window.requestAnimationFrame(n))}()},t.prototype.scrollUpdating=function(e,t){"add"===t?this.scrollEle.scrollTop+=e:this.scrollEle.scrollTop-=e},t.prototype.frameScrollRequest=function(e,t,i){var r=this;if(i)this.scrollUpdating(e,t);else{this.customStep||[].slice.call(sf.base.selectAll(".e-scroll-overlay",this.element)).forEach((function(t){e-=t.offsetHeight}));!function i(){e<10?window.cancelAnimationFrame(10):(r.scrollUpdating(10,t),e-=10,window.requestAnimationFrame(i))}()}},t.prototype.touchHandler=function(e){var t=this.scrollEle,i=e.distanceY;"Up"===e.scrollDirection?t.scrollTop=t.scrollTop+i:"Down"===e.scrollDirection&&(t.scrollTop=t.scrollTop-i)},t.prototype.arrowDisabling=function(e,t){if(this.isDevice){var i=(sf.base.isNullOrUndefined(e)?t:e).querySelector(".e-nav-arrow");sf.base.isNullOrUndefined(e)?sf.base.classList(i,["e-nav-down-arrow"],["e-nav-up-arrow"]):sf.base.classList(i,["e-nav-up-arrow"],["e-nav-down-arrow"])}else e.classList.add("e-overlay"),e.setAttribute("aria-disabled","true"),e.removeAttribute("tabindex"),t.classList.remove("e-overlay"),t.setAttribute("aria-disabled","false"),t.setAttribute("tabindex","0");this.repeatScroll()},t.prototype.scrollEventHandler=function(e){var t=e.target,i=t.offsetHeight,r=this.element.querySelector(".e-scroll-up-nav"),n=this.element.querySelector(".e-scroll-down-nav"),o=this.element.querySelector(".e-scroll-up-overlay"),s=this.element.querySelector(".e-scroll-down-overlay"),a=t.scrollTop;if(a<=0&&(a=-a),this.isDevice&&(o.style.height=a<40?a+"px":"40px",t.scrollHeight-Math.ceil(i+a)<40?s.style.height=t.scrollHeight-Math.ceil(i+a)+"px":s.style.height="40px"),0===a)this.arrowDisabling(r,n);else if(Math.ceil(i+a+.1)>=t.scrollHeight)this.arrowDisabling(n,r);else{var l=this.element.querySelector(".e-scroll-nav.e-overlay");l&&(l.classList.remove("e-overlay"),l.setAttribute("aria-disabled","false"),l.setAttribute("tabindex","0"))}},t.prototype.onPropertyChanged=function(e,t){for(var i=0,r=Object.keys(e);i<r.length;i++){switch(r[i]){case"scrollStep":this.setScrollState();break;case"enableRtl":e.enableRtl?this.element.classList.add("e-rtl"):this.element.classList.remove("e-rtl")}}},l([sf.base.Property(null)],t.prototype,"scrollStep",void 0),t=l([sf.base.NotifyPropertyChanges],t)}(sf.base.Component);function d(e,t,i,r,n,o){var a=e("div",{className:"e-menu-"+r});return t.appendChild(a),a.appendChild(i),o?(a.style.overflow="hidden",a.style.height=o+"px"):(a.style.maxHeight=t.style.maxHeight,t.style.overflow="hidden"),"vscroll"===r?new h({enableRtl:n},a).scrollStep=sf.base.select(".e-"+r+"-bar",t).offsetHeight/2:new s({enableRtl:n},a).scrollStep=sf.base.select(".e-"+r+"-bar",t).offsetWidth,a}return e.HScroll=s,e.VScroll=h,e.addScrolling=function(e,t,i,r,n,o){var s,a,l=t.parentElement;if("vscroll"===r?(s=o||t.getBoundingClientRect().height,a=i.getBoundingClientRect().height):(s=t.getBoundingClientRect().width,a=i.getBoundingClientRect().width),s<a)return d(e,t,i,r,n,o);if(l){var h=l.getBoundingClientRect().width;return h<s&&"hscroll"===r?(a=h,t.style.maxWidth=h+"px",d(e,t,i,r,n,o)):i}return i},e.destroyScroll=function(e,t,i){if(e){var r=sf.base.select(".e-menu-parent",t);r?i&&i!==r||(e.destroy(),t.parentElement.appendChild(r),sf.base.detach(t)):(e.destroy(),sf.base.detach(t))}},e}({}))},"./modules/officechart.js":function(e,t){window.sf=window.sf||{},window.sf.officechart=function(e){"use strict";sf.charts.Chart.Inject(sf.charts.AreaSeries,sf.charts.StackingAreaSeries,sf.charts.BarSeries,sf.charts.PieSeries,sf.charts.StackingBarSeries,sf.charts.PolarSeries,sf.charts.ScatterSeries,sf.charts.BubbleSeries,sf.charts.RadarSeries,sf.charts.DateTime,sf.charts.ColumnSeries,sf.charts.StackingColumnSeries,sf.charts.LineSeries,sf.charts.StackingLineSeries,sf.charts.ErrorBar,sf.charts.Trendlines,sf.charts.SplineSeries,sf.charts.DataLabel,sf.charts.Category,sf.charts.Legend,sf.charts.Tooltip,sf.charts.Export),sf.charts.AccumulationChart.Inject(sf.charts.AccumulationLegend,sf.charts.PieSeries,sf.charts.AccumulationTooltip,sf.charts.AccumulationDataLabel);var t=function(){function e(){}return e.prototype.chartRender=function(e){this.chartType=e.chartType,this.isPieType="Pie"===this.chartType||"Doughnut"===this.chartType;var t=this.chartData(e,this.chartType),i={enableAnimation:!1,width:e.width*(96/72)+"px",height:e.height*(96/72)+"px"};this.isPieType?this.chart=new sf.charts.AccumulationChart(i):(this.chart=new sf.charts.Chart(i),this.chart.primaryXAxis=this.chartPrimaryXAxis(e.chartPrimaryCategoryAxis,this.chartType),this.chart.primaryYAxis=this.chartPrimaryYAxis(e.chartPrimaryValueAxis)),this.chart.series=this.chartSeries(e.chartSeries,t,this.chartType);for(var r=0;r<this.chart.series.length;r++)this.chart.series[r].animation.enable=!1;this.chart.title=e.chartTitle,this.chart.legendSettings=this.parseChartLegend(e.chartLegend)},e.prototype.convertChartToImage=function(e,t,i){var r=this;return new Promise((function(n,o){var s=0,a=0,l=r.getControlsValue([e],t,i);s=s||l.width,a=a||l.height;var h=sf.base.createElement("canvas"),d=Math.max(1,window.devicePixelRatio||1);h.width=s*d,h.height=a*d,h.style.width=s+"px",h.style.height=a+"px";var c=window.URL.createObjectURL(new Blob([(new XMLSerializer).serializeToString(l.svg)],{type:"image/svg+xml"})),p=new Image,u=h.getContext("2d");u.scale(d,d),p.onload=function(){u.drawImage(p,0,0),window.URL.revokeObjectURL(c);var e=h.toDataURL("image/png");n(e)},p.onerror=function(){o("Invalid data")},p.src=c}))},e.prototype.getControlsValue=function(e,t,i){var r=0,n=0,o=new sf.svgbase.SvgRenderer("").createSvg({id:"Image_Export",width:200,height:200});return e.map((function(e){if(e){var i=e.svgObject.cloneNode(!0),s=e.renderer.createGroup({style:"transform: translateY("+n+"px)"});s.appendChild(i),r=Math.max(e.availableSize.width,t),n+=e.availableSize.height,e.svgObject.outerHTML,o.appendChild(s)}})),o.setAttribute("width",r+""),o.setAttribute("height",n+""),{width:r,height:n,svg:o}},e.prototype.officeChartType=function(e){var t="";switch(e){case"Area_Stacked":t="StackingArea";break;case"Area":t="Area";break;case"Area_Stacked_100":t="StackingArea100";break;case"Bar_Clustered":t="Bar";break;case"Bar_Stacked":t="StackingBar";break;case"Bar_Stacked_100":t="StackingBar100";break;case"Column_Clustered":t="Column";break;case"Column_Stacked":t="StackingColumn";break;case"Column_Stacked_100":t="StackingColumn100";break;case"Scatter_Markers":t="Scatter";break;case"Bubble":t="Bubble";break;case"Doughnut":case"Pie":t="Pie";break;case"Line_Stacked_100":case"Line_Markers_Stacked_100":t="StackingLine100";break;case"Line":case"Line_Markers":t="Line";break;case"Line_Stacked":case"Line_Markers_Stacked":t="StackingLine"}return t},e.prototype.chartSeries=function(e,t,i){for(var r=[],n=0;n<e.length;n++){var o=e[n],s=this.writeChartSeries(o,t,i,n);r.push(s)}return r},e.prototype.writeChartSeries=function(e,t,i,r){var n,o=this.officeChartType(i),s=e.dataPoints[r],a={};if(a.type=o,a.dataSource=t,a.name=e.seriesName,a.xName="x",a.yName="y"+r,"Bubble"===i&&(a.size="size"+r),this.isPieType?(a.pointColorMapping="color","Doughnut"===i&&(a.innerRadius="75%",a.radius="70%")):(sf.base.isNullOrUndefined(s)&&(s=e.dataPoints[0]),n=this.chartFormat(s,o),a.fill=n,sf.base.isNullOrUndefined(s.fill.foreColor)||(a.pointColorMapping="color")),"Line_Markers"!==i&&"Line_Markers_Stacked"!==i&&"Line_Markers_Stacked_100"!==i||(a.marker={visible:!0}),e.hasOwnProperty("dataLabel"))if(this.isPieType)a.dataLabel=this.parseDataLabels(e.dataLabel);else{var l={};l.dataLabel=this.parseDataLabels(e.dataLabel),a.marker=l}if(e.hasOwnProperty("errorBar")){var h=e.errorBar;a.errorBar=this.parseErrorBars(h)}if(e.hasOwnProperty("trendLines"))for(var d=e.trendLines,c=[],p=0;p<d.length;p++){var u,g=d[p];u=this.parseTrendLines(g,n),c.push(u),a.trendlines=c}return a},e.prototype.parseDataLabels=function(e){var t={visible:!0};return this.isPieType?"BestFit"===e.position||"Inside"===e.position?t.position="Inside":t.position="Outside":t.position=this.dataLabelPosition(e.position),t},e.prototype.parseErrorBars=function(e){var t={visible:!0};return t.type=e.type,t.direction=e.direction,"Cap"===e.endStyle?t.errorBarCap={width:1}:t.errorBarCap={width:0},t},e.prototype.parseTrendLines=function(e,t){var i={};return i.type=e.type,i.name=e.name,i.forwardForecast=e.forward,i.backwardForecast=e.backward,"NaN"===e.intercept?i.intercept=0:i.intercept=e.intercept,i.fill=t,i},e.prototype.dataLabelPosition=function(e){var t="Auto";switch(e){case"Outside":t="Outer";break;case"Center":t="Middle";break;case"Inside":t="Top";break;case"OutsideBase":t="Bottom"}return t},e.prototype.chartFormat=function(e,t){var i=e;return"Line"===t||"StackingLine"===t||"StackingLine100"===t?i.line.rgb:i.fill.rgb},e.prototype.chartPrimaryXAxis=function(e,t){var i={};e.chartTitle&&(i.title=e.chartTitle);var r=this.chartCategoryType(e.categoryType);return i.valueType=r,"DateTime"===r&&(i.intervalType="Days",i.labelFormat="M/d/yyyy",i.edgeLabelPlacement="Shift"),"Scatter_Markers"!==t&&"Bubble"!==t||this.checkAndSetAxisValue(i,e),e.hasMajorGridLines&&(i.majorGridLines={width:1}),e.hasMinorGridLines&&(i.minorTicksPerInterval=4),i},e.prototype.chartCategoryType=function(e){var t="";switch(e){case"Time":t="DateTime";break;case"Automatic":t="Category"}return t},e.prototype.chartPrimaryYAxis=function(e){var t={};return e.chartTitle&&(t.title=e.chartTitle),this.checkAndSetAxisValue(t,e),e.hasMajorGridLines&&(t.majorGridLines={width:1}),e.hasMinorGridLines&&(t.minorTicksPerInterval=4),t},e.prototype.checkAndSetAxisValue=function(e,t){0!==t.minimumValue&&(e.minimum=t.minimumValue),0!==t.maximumValue&&(e.maximum=t.maximumValue),0!==t.majorUnit&&(e.interval=t.majorUnit)},e.prototype.chartData=function(e,t){for(var i=e.chartCategory,r=[],n=0;n<i.length;n++){var o=i[n],s=this.chartPlotData(o,e,t,n);r.push(s)}return r},e.prototype.chartPlotData=function(e,t,i,r){var n={},o=t.chartSeries;if("m/d/yyyy"===t.chartPrimaryCategoryAxis.numberFormat){var s=e.categoryXName.split("/"),a=Number(s[0]),l=Number(s[1]),h=Number(s[2]);n.x=new Date(h,a-1,l)}else n.x=e.categoryXName;for(var d=0;d<o.length;d++){var c=e.chartData[d];if(n["y"+d]=c.yValue,"Bubble"===i&&(n["size"+d]=c.size),"Pie"===t.chartType||"Doughnut"===t.chartType||"Column_Stacked"===t.chartType){var p=o[d],u=p.dataPoints.find((function(e){return e.id===r}));sf.base.isNullOrUndefined(u)?p.dataPoints.length>1&&0===p.dataPoints[r].id?(u=p.dataPoints[r],n.color=this.chartFormat(u,i)):sf.base.isNullOrUndefined(p.seriesFormat)||sf.base.isNullOrUndefined(p.seriesFormat.fill)||p.seriesFormat.fill.rgb.length>7&&(n.color=this.getColor(p.seriesFormat.fill.rgb)):n.color=this.chartFormat(u,i)}}return n},e.prototype.getColor=function(e){return e.length>0&&"#"===e[0]&&e.length>7?e.substr(0,7):e},e.prototype.parseChartLegend=function(e){var t={},i=e.position;return"Corner"===i&&(i="right"),i?(t.visible=!0,t.position=i.charAt(0).toUpperCase()+i.slice(1)):t.visible=!1,t},e.prototype.destroy=function(){this.chart&&this.chart.destroy(),this.chart=void 0},e}();return e.ChartComponent=t,e},sf.officechart=sf.officechart({})},"./modules/popup.js":function(e,t){function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}window.sf=window.sf||{};sf.popups=sf.base.extend({},sf.popups,function(e){"use strict";var t,r=(t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,i)},function(e,i){function r(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}),n=function(e,t,r,n){var o,s=arguments.length,a=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(s<3?o(a):s>3?o(t,r,a):o(t,r))||a);return s>3&&a&&Object.defineProperty(t,r,a),a},o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),n([sf.base.Property("left")],t.prototype,"X",void 0),n([sf.base.Property("top")],t.prototype,"Y",void 0),t}(sf.base.ChildProperty),s="e-popup",a="e-rtl",l="e-popup-open",h="e-popup-close",d=function(e){function t(t,i){return e.call(this,i,t)||this}return r(t,e),t.prototype.onPropertyChanged=function(e,t){for(var i=0,r=Object.keys(e);i<r.length;i++){switch(r[i]){case"width":sf.base.setStyleAttribute(this.element,{width:sf.base.formatUnit(e.width)});break;case"height":sf.base.setStyleAttribute(this.element,{height:sf.base.formatUnit(e.height)});break;case"zIndex":sf.base.setStyleAttribute(this.element,{zIndex:e.zIndex});break;case"enableRtl":this.setEnableRtl();break;case"position":case"relateTo":this.refreshPosition();break;case"offsetX":var n=e.offsetX-t.offsetX;this.element.style.left=(parseInt(this.element.style.left,10)+n).toString()+"px";break;case"offsetY":var o=e.offsetY-t.offsetY;this.element.style.top=(parseInt(this.element.style.top,10)+o).toString()+"px";break;case"content":this.setContent();break;case"actionOnScroll":"none"!==e.actionOnScroll?this.wireScrollEvents():this.unwireScrollEvents()}}},t.prototype.getModuleName=function(){return"popup"},t.prototype.resolveCollision=function(){this.checkCollision()},t.prototype.getPersistData=function(){return this.addOnPersist([])},t.prototype.destroy=function(){this.element.classList.contains("e-popup-open")&&this.unwireEvents(),this.element.classList.remove(s,a,l,h),e.prototype.destroy.call(this)},t.prototype.render=function(){this.element.classList.add(s);var e={};1e3!==this.zIndex&&(e.zIndex=this.zIndex),"auto"!==this.width&&(e.width=sf.base.formatUnit(this.width)),"auto"!==this.height&&(e.height=sf.base.formatUnit(this.height)),sf.base.setStyleAttribute(this.element,e),this.fixedParent=!1,this.setEnableRtl(),this.setContent()},t.prototype.wireEvents=function(){sf.base.Browser.isDevice&&sf.base.EventHandler.add(window,"orientationchange",this.orientationOnChange,this),"none"!==this.actionOnScroll&&this.wireScrollEvents()},t.prototype.wireScrollEvents=function(){if(this.getRelateToElement())for(var e=0,t=this.getScrollableParent(this.getRelateToElement());e<t.length;e++){var i=t[e];sf.base.EventHandler.add(i,"scroll",this.scrollRefresh,this)}},t.prototype.unwireEvents=function(){sf.base.Browser.isDevice&&sf.base.EventHandler.remove(window,"orientationchange",this.orientationOnChange),"none"!==this.actionOnScroll&&this.unwireScrollEvents()},t.prototype.unwireScrollEvents=function(){if(this.getRelateToElement())for(var e=0,t=this.getScrollableParent(this.getRelateToElement());e<t.length;e++){var i=t[e];sf.base.EventHandler.remove(i,"scroll",this.scrollRefresh)}},t.prototype.getRelateToElement=function(){var e=""===this.relateTo||sf.base.isNullOrUndefined(this.relateTo)?document.body:this.relateTo;return this.setProperties({relateTo:e},!0),"string"==typeof this.relateTo?document.querySelector(this.relateTo):this.relateTo},t.prototype.scrollRefresh=function(e){if("reposition"===this.actionOnScroll?sf.base.isNullOrUndefined(this.element)||this.element.offsetParent===e.target||this.element.offsetParent&&"BODY"===this.element.offsetParent.tagName&&null==e.target.parentElement||this.refreshPosition():"hide"===this.actionOnScroll&&this.hide(),"none"!==this.actionOnScroll&&this.getRelateToElement()){var t=this.isElementOnViewport(this.getRelateToElement(),e.target);t||this.targetInvisibleStatus?t&&(this.targetInvisibleStatus=!1):(this.trigger("targetExitViewport"),this.targetInvisibleStatus=!0)}},t.prototype.isElementOnViewport=function(e,t){for(var i=this.getScrollableParent(e),r=0;r<i.length;r++)if(!this.isElementVisible(e,i[r]))return!1;return!0},t.prototype.isElementVisible=function(e,t){var i=this.checkGetBoundingClientRect(e);if(!i.height||!i.width)return!1;if(sf.base.isNullOrUndefined(this.checkGetBoundingClientRect(t))){var r=window,n={top:r.scrollY,left:r.scrollX,right:r.scrollX+r.outerWidth,bottom:r.scrollY+r.outerHeight},o=sf.popups.calculatePosition(e),s={top:o.top,left:o.left,right:o.left+i.width,bottom:o.top+i.height},a={top:n.bottom-s.top,left:n.right-s.left,bottom:s.bottom-n.top,right:s.right-n.left};return a.top>0&&a.left>0&&a.right>0&&a.bottom>0}var l=t.getBoundingClientRect();return!(i.bottom<l.top||i.bottom>l.bottom||i.right>l.right||i.left<l.left)},t.prototype.preRender=function(){},t.prototype.setEnableRtl=function(){this.reposition(),this.enableRtl?this.element.classList.add(a):this.element.classList.remove(a)},t.prototype.setContent=function(){if(!sf.base.isNullOrUndefined(this.content))if(this.element.innerHTML="","string"==typeof this.content)this.element.textContent=this.content;else{var e=this.getRelateToElement(),t=this.content.props;e.classList.contains("e-dropdown-btn")&&!sf.base.isNullOrUndefined(t)||this.element.appendChild(this.content)}},t.prototype.orientationOnChange=function(){var e=this;setTimeout((function(){e.refreshPosition()}),200)},t.prototype.refreshPosition=function(e,t){sf.base.isNullOrUndefined(e)||this.checkFixedParent(e),this.reposition(),t||this.checkCollision()},t.prototype.reposition=function(){var e,t,i=this.getRelateToElement();if("number"==typeof this.position.X&&"number"==typeof this.position.Y)e={left:this.position.X,top:this.position.Y};else if("string"==typeof this.position.X&&"number"==typeof this.position.Y||"number"==typeof this.position.X&&"string"==typeof this.position.Y){var r=void 0,n=this.element.style.display;this.element.style.display="block",this.element.classList.contains("e-dlg-modal")&&(r=this.element.parentElement.style.display,this.element.parentElement.style.display="block"),t=this.getAnchorPosition(i,this.element,this.position,this.offsetX,this.offsetY),e="string"==typeof this.position.X?{left:t.left,top:this.position.Y}:{left:this.position.X,top:t.top},this.element.style.display=n,this.element.classList.contains("e-dlg-modal")&&(this.element.parentElement.style.display=r)}else if(i){n=this.element.style.display;this.element.style.display="block",e=this.getAnchorPosition(i,this.element,this.position,this.offsetX,this.offsetY),this.element.style.display=n}else e={left:0,top:0};sf.base.isNullOrUndefined(e)||(this.element.style.left=e.left+"px",this.element.style.top=e.top+"px")},t.prototype.checkGetBoundingClientRect=function(e){try{return e.getBoundingClientRect()}catch(e){return null}},t.prototype.getAnchorPosition=function(e,t,i,r,n){var o=this.checkGetBoundingClientRect(t),s=this.checkGetBoundingClientRect(e);if(sf.base.isNullOrUndefined(o)||sf.base.isNullOrUndefined(s))return null;var a=e,l={left:0,top:0};switch(t.offsetParent&&"BODY"===t.offsetParent.tagName&&"BODY"===e.tagName?l=sf.popups.calculatePosition(e):(t.classList.contains("e-dlg-modal")&&"BODY"!==a.tagName&&(t=t.parentElement),l=sf.popups.calculateRelativeBasedPosition(a,t)),i.X){default:case"left":break;case"center":t.classList.contains("e-dlg-modal")&&"BODY"===a.tagName&&"container"===this.targetType?l.left+=window.innerWidth/2-o.width/2:"container"===this.targetType?l.left+=s.width/2-o.width/2:l.left+=s.width/2;break;case"right":t.classList.contains("e-dlg-modal")&&"BODY"===a.tagName&&"container"===this.targetType?l.left+=window.innerWidth-o.width:"container"===this.targetType?l.left+=s.width-o.width:l.left+=s.width}switch(i.Y){default:case"top":break;case"center":t.classList.contains("e-dlg-modal")&&"BODY"===a.tagName&&"container"===this.targetType?l.top+=window.innerHeight/2-o.height/2:"container"===this.targetType?l.top+=s.height/2-o.height/2:l.top+=s.height/2;break;case"bottom":t.classList.contains("e-dlg-modal")&&"BODY"===a.tagName&&"container"===this.targetType?l.top+=window.innerHeight-o.height:"container"===this.targetType?l.top+=s.height-o.height:l.top+=s.height}return l.left+=r,l.top+=n,l},t.prototype.callFlip=function(e){var t=this.getRelateToElement();sf.popups.flip(this.element,t,this.offsetX,this.offsetY,this.position.X,this.position.Y,this.viewPortElement,e,this.fixedParent)},t.prototype.callFit=function(e){if(0!==sf.popups.isCollide(this.element,this.viewPortElement).length)if(sf.base.isNullOrUndefined(this.viewPortElement)){var t=sf.popups.fit(this.element,this.viewPortElement,e);e.X&&(this.element.style.left=t.left+"px"),e.Y&&(this.element.style.top=t.top+"px")}else{var i=this.checkGetBoundingClientRect(this.element),r=this.checkGetBoundingClientRect(this.viewPortElement);if(sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(r))return null;e&&!0===e.Y&&(r.top>i.top?this.element.style.top="0px":r.bottom<i.bottom&&(this.element.style.top=parseInt(this.element.style.top,10)-(i.bottom-r.bottom)+"px")),e&&!0===e.X&&(r.right<i.right?this.element.style.left=parseInt(this.element.style.left,10)-(i.right-r.right)+"px":r.left>i.left&&(this.element.style.left=parseInt(this.element.style.left,10)+(r.left-i.left)+"px"))}},t.prototype.checkCollision=function(){var e=this.collision.X,t=this.collision.Y;"none"===e&&"none"===t||("flip"===e&&"flip"===t?this.callFlip({X:!0,Y:!0}):"fit"===e&&"fit"===t?this.callFit({X:!0,Y:!0}):("flip"===e?this.callFlip({X:!0,Y:!1}):"flip"===t&&this.callFlip({Y:!0,X:!1}),"fit"===e?this.callFit({X:!0,Y:!1}):"fit"===t&&this.callFit({X:!1,Y:!0})))},t.prototype.show=function(e,t){var r=this;if(this.getRelateToElement().classList.contains("e-filemanager")&&(this.fmDialogContainer=this.element.getElementsByClassName("e-file-select-wrap")[0]),this.wireEvents(),!sf.base.isNullOrUndefined(this.fmDialogContainer)&&sf.base.Browser.isIos&&(this.fmDialogContainer.style.display="block"),1e3===this.zIndex||!sf.base.isNullOrUndefined(t)){var n=sf.base.isNullOrUndefined(t)?this.element:t;this.zIndex=p(n),sf.base.setStyleAttribute(this.element,{zIndex:this.zIndex})}e=sf.base.isNullOrUndefined(e)||"object"!==i(e)?this.showAnimation:e,"none"===this.collision.X&&"none"===this.collision.Y||(sf.base.removeClass([this.element],h),sf.base.addClass([this.element],l),this.checkCollision(),sf.base.removeClass([this.element],l),sf.base.addClass([this.element],h)),sf.base.isNullOrUndefined(e)?(sf.base.removeClass([this.element],h),sf.base.addClass([this.element],l),this.trigger("open")):(e.begin=function(){r.isDestroyed||(sf.base.removeClass([r.element],h),sf.base.addClass([r.element],l))},e.end=function(){r.isDestroyed||r.trigger("open")},new sf.base.Animation(e).animate(this.element))},t.prototype.hide=function(e){var t=this;e=sf.base.isNullOrUndefined(e)||"object"!==i(e)?this.hideAnimation:e,sf.base.isNullOrUndefined(e)?(sf.base.removeClass([this.element],l),sf.base.addClass([this.element],h),this.trigger("close")):(e.end=function(){t.isDestroyed||(sf.base.removeClass([t.element],l),sf.base.addClass([t.element],h),t.trigger("close"))},new sf.base.Animation(e).animate(this.element)),this.unwireEvents()},t.prototype.getScrollableParent=function(e){return this.checkFixedParent(e),c(e,this.fixedParent)},t.prototype.checkFixedParent=function(e){for(var t=e.parentElement;t&&"HTML"!==t.tagName;){var i=getComputedStyle(t);"fixed"===i.position&&!sf.base.isNullOrUndefined(this.element)&&this.element.offsetParent&&"BODY"===this.element.offsetParent.tagName&&"hidden"!==getComputedStyle(this.element.offsetParent).overflow&&(this.element.style.top=window.scrollY>parseInt(this.element.style.top,10)?sf.base.formatUnit(window.scrollY-parseInt(this.element.style.top,10)):sf.base.formatUnit(parseInt(this.element.style.top,10)-window.scrollY),this.element.style.position="fixed",this.fixedParent=!0),t=t.parentElement,!sf.base.isNullOrUndefined(this.element)&&sf.base.isNullOrUndefined(this.element.offsetParent)&&"fixed"===i.position&&"fixed"===this.element.style.position&&(this.fixedParent=!0)}},n([sf.base.Property("auto")],t.prototype,"height",void 0),n([sf.base.Property("auto")],t.prototype,"width",void 0),n([sf.base.Property(null)],t.prototype,"content",void 0),n([sf.base.Property("container")],t.prototype,"targetType",void 0),n([sf.base.Property(null)],t.prototype,"viewPortElement",void 0),n([sf.base.Property({X:"none",Y:"none"})],t.prototype,"collision",void 0),n([sf.base.Property("")],t.prototype,"relateTo",void 0),n([sf.base.Complex({},o)],t.prototype,"position",void 0),n([sf.base.Property(0)],t.prototype,"offsetX",void 0),n([sf.base.Property(0)],t.prototype,"offsetY",void 0),n([sf.base.Property(1e3)],t.prototype,"zIndex",void 0),n([sf.base.Property(!1)],t.prototype,"enableRtl",void 0),n([sf.base.Property("reposition")],t.prototype,"actionOnScroll",void 0),n([sf.base.Property(null)],t.prototype,"showAnimation",void 0),n([sf.base.Property(null)],t.prototype,"hideAnimation",void 0),n([sf.base.Event()],t.prototype,"open",void 0),n([sf.base.Event()],t.prototype,"close",void 0),n([sf.base.Event()],t.prototype,"targetExitViewport",void 0),t=n([sf.base.NotifyPropertyChanges],t)}(sf.base.Component);function c(e,t){for(var i=getComputedStyle(e),r=[],n=/(auto|scroll)/,o=e.parentElement;o&&"HTML"!==o.tagName;){var s=getComputedStyle(o);"absolute"===i.position&&"static"===s.position||!n.test(s.overflow+s.overflowY+s.overflowX)||r.push(o),o=o.parentElement}return t||r.push(document),r}function p(e){for(var t=e.parentElement,i=[];t&&"BODY"!==t.tagName;){var r=document.defaultView.getComputedStyle(t,null).getPropertyValue("z-index"),n=document.defaultView.getComputedStyle(t,null).getPropertyValue("position");"auto"!==r&&"static"!==n&&i.push(r),t=t.parentElement}for(var o=[],s=0;s<document.body.children.length;s++)if(!e.isEqualNode(document.body.children[s])){r=document.defaultView.getComputedStyle(document.body.children[s],null).getPropertyValue("z-index"),n=document.defaultView.getComputedStyle(document.body.children[s],null).getPropertyValue("position");"auto"!==r&&"static"!==n&&o.push(r)}o.push("999");var a=[];if(!sf.base.isNullOrUndefined(e.parentElement)&&"BODY"!==e.parentElement.tagName){var l=[].slice.call(e.parentElement.children);for(s=0;s<l.length;s++)if(!e.isEqualNode(l[s])){r=document.defaultView.getComputedStyle(l[s],null).getPropertyValue("z-index"),n=document.defaultView.getComputedStyle(l[s],null).getPropertyValue("position");"auto"!==r&&"static"!==n&&a.push(r)}}var h=i.concat(o,a),d=Math.max.apply(Math,h)+1;return d>2147483647?2147483647:d}return e.PositionData=o,e.Popup=d,e.getScrollableParent=c,e.getZindexPartial=p,e.getMaxZindex=function(e){void 0===e&&(e=["*"]);for(var t=[],i=0;i<e.length;i++)for(var r=document.getElementsByTagName(e[i]),n=0;n<r.length;n++){var o=document.defaultView.getComputedStyle(r[n],null).getPropertyValue("z-index"),s=document.defaultView.getComputedStyle(r[n],null).getPropertyValue("position");"auto"!==o&&"static"!==s&&t.push(o)}var a=Math.max.apply(Math,t)+1;return a>2147483647?2147483647:a},e}({}))},"./modules/popupsbase.js":function(e,t,i){window.sf=window.sf||{};window.sf.popups=window.sf.base.extend({},window.sf.popups,function(e){"use strict";var t,i,r,n,o,s,a=!1;function l(e,o,s,l,c){if(i=void 0,i=c,a=!!l,!e)return{left:0,top:0};o||(o="left"),s||(s="top"),n=e.ownerDocument,r=e;return function(e,i,n){switch(t=r.getBoundingClientRect(),i+e){case"topcenter":h(v(),n),d(f(),n);break;case"topright":h(y(),n),d(f(),n);break;case"centercenter":h(v(),n),d(g(),n);break;case"centerright":h(y(),n),d(g(),n);break;case"centerleft":h(m(),n),d(g(),n);break;case"bottomcenter":h(v(),n),d(u(),n);break;case"bottomright":h(y(),n),d(u(),n);break;case"bottomleft":h(m(),n),d(u(),n);break;default:case"topleft":h(m(),n),d(f(),n)}return r=null,n}(o.toLowerCase(),s.toLowerCase(),{left:0,top:0})}function h(e,t){t.left=e}function d(e,t){t.top=e}function c(){return n.documentElement.scrollTop||n.body.scrollTop}function p(){return n.documentElement.scrollLeft||n.body.scrollLeft}function u(){return a?t.bottom:t.bottom+c()}function g(){return f()+t.height/2}function f(){return a?t.top:t.top+c()}function m(){return t.left+p()}function y(){var e=r&&r.classList.contains("e-date-range-wrapper")?i?i.width:0:i&&t.width>=i.width?i.width:0;return t.right+p()-e}function v(){return m()+t.width/2}function b(e,t,i){e.TL={top:t.position.top+t.offsetY,left:t.position.left+t.offsetX},e.TR={top:e.TL.top,left:e.TL.left+i.width},e.BL={top:e.TL.top+i.height,left:e.TL.left},e.BR={top:e.TL.top+i.height,left:e.TL.left+i.width}}function w(e,t){var i=!1,r=!1;return e-L()<O()&&(i=!0),t>T()&&(r=!0),{leftSide:i,rightSide:r}}function x(e,t){var i=!1,r=!1;return e-A()<C()&&(i=!0),t>P()&&(r=!0),{topSide:i,bottomSide:r}}function M(){return s.getBoundingClientRect().width}function N(){return s.getBoundingClientRect().height}function I(){return s.getBoundingClientRect().left}function S(){return s.getBoundingClientRect().top}function C(){return s?S():0}function O(){return s?I():0}function T(){return s?L()+I()+M():L()+D()}function P(){return s?A()+S()+N():A()+F()}function A(){return o.documentElement.scrollTop||o.body.scrollTop}function L(){return o.documentElement.scrollLeft||o.body.scrollLeft}function F(){return window.innerHeight}function D(){var e=window.innerWidth,t=document.documentElement.getBoundingClientRect();return e-(e-(sf.base.isNullOrUndefined(document.documentElement)?0:t.width))}var E,z,k,W,R,j,U,H,B=["north-west","north","north-east","west","east","south-west","south","south-east"],_=["e-restrict-left"],V=["north","west","east","south"],Y=0,Q=0,q=0,G=0,X=0,Z=0,K=null,J=null,$=null,ee=!0,te=0,ie=!0;function re(e){he();var t=sf.base.createElement("span",{attrs:{unselectable:"on",contenteditable:"false"}});t.setAttribute("class","e-dialog-border-resize e-"+e),"south"===e&&(t.style.height="2px",t.style.width="100%",t.style.bottom="0px",t.style.left="0px"),"north"===e&&(t.style.height="2px",t.style.width="100%",t.style.top="0px",t.style.left="0px"),"east"===e&&(t.style.height="100%",t.style.width="2px",t.style.right="0px",t.style.top="0px"),"west"===e&&(t.style.height="100%",t.style.width="2px",t.style.left="0px",t.style.top="0px"),E.appendChild(t)}function ne(e){var t;return sf.base.isNullOrUndefined(e)||(t="string"==typeof e?document.querySelector(e):e),t}function oe(e){sf.base.isNullOrUndefined(e)&&(e=this);for(var t=E.querySelectorAll(".e-resize-handle"),i=0;i<t.length;i++){z=t[i],sf.base.EventHandler.add(z,"mousedown",ae,e);var r="msie"===sf.base.Browser.info.name?"pointerdown":"touchstart";sf.base.EventHandler.add(z,r,de,e)}var n=E.querySelectorAll(".e-dialog-border-resize");if(!sf.base.isNullOrUndefined(n))for(i=0;i<n.length;i++){z=n[i],sf.base.EventHandler.add(z,"mousedown",ae,e);r="msie"===sf.base.Browser.info.name?"pointerdown":"touchstart";sf.base.EventHandler.add(z,r,de,e)}}function se(e){return e.indexOf("mouse")>-1?"mouse":"touch"}function ae(e){if(e.preventDefault(),E=e.target.parentElement,he(),X=e.pageX,Z=e.pageY,e.target.classList.add("e-focused-handle"),sf.base.isNullOrUndefined(K)||!0!==K(e,this)){this.targetEle&&E&&E.querySelector(".e-dlg-resizable")&&(U="body"===this.target?null:this.targetEle,j=this.targetEle.clientWidth,W=this.targetEle.clientHeight);var t=sf.base.isNullOrUndefined(U)?document:U;sf.base.EventHandler.add(t,"mousemove",ce,this),sf.base.EventHandler.add(document,"mouseup",le,this);for(var i=0;i<_.length;i++)ee=!E.classList.contains(_[i])}}function le(e){var t="msie"===sf.base.Browser.info.name?"pointermove":"touchmove",i="msie"===sf.base.Browser.info.name?"pointerup":"touchend",r=sf.base.isNullOrUndefined(U)?document:U,n="msie"===sf.base.Browser.info.name?"pointerdown":"touchstart";sf.base.EventHandler.remove(r,"mousemove",ce),sf.base.EventHandler.remove(r,t,ce),sf.base.EventHandler.remove(r,n,ce),sf.base.isNullOrUndefined(document.body.querySelector(".e-focused-handle"))||document.body.querySelector(".e-focused-handle").classList.remove("e-focused-handle"),sf.base.isNullOrUndefined($)||$(e,this),sf.base.EventHandler.remove(document,"mouseup",le),sf.base.EventHandler.remove(document,i,le)}function he(){Y=parseFloat(getComputedStyle(E,null).getPropertyValue("width").replace("px","")),Q=parseFloat(getComputedStyle(E,null).getPropertyValue("height").replace("px","")),q=E.getBoundingClientRect().left,G=E.getBoundingClientRect().top}function de(e){E=e.target.parentElement,he();var t=E.classList.contains("e-dialog");(e.target.classList.contains("e-resize-handle")||e.target.classList.contains("e-dialog-border-resize"))&&t&&e.target.classList.add("e-focused-handle");var i=e.touches?e.changedTouches[0]:e;if(X=i.pageX,Z=i.pageY,sf.base.isNullOrUndefined(K)||!0!==K(e,this)){var r="msie"===sf.base.Browser.info.name?"pointermove":"touchmove",n="msie"===sf.base.Browser.info.name?"pointerup":"touchend",o=sf.base.isNullOrUndefined(U)?document:U;sf.base.EventHandler.add(o,r,ce,this),sf.base.EventHandler.add(document,n,le,this)}}function ce(e){if(e.target.classList.contains("e-resize-handle")&&e.target.classList.contains("e-focused-handle")?z=e.target:sf.base.isNullOrUndefined(document.body.querySelector(".e-focused-handle"))||(z=document.body.querySelector(".e-focused-handle")),!sf.base.isNullOrUndefined(z)){for(var t="",i=0;i<B.length;i++)z.classList.contains("e-"+B[i])&&(t=B[i]);switch(sf.base.isNullOrUndefined(J)||J(e,this),t){case"south":ue(e);break;case"north":ge(e);break;case"west":fe(e);break;case"east":me(e);break;case"south-east":ue(e),me(e);break;case"south-west":ue(e),fe(e);break;case"north-east":ge(e),me(e);break;case"north-west":ge(e),fe(e)}}}function pe(e){return e.getBoundingClientRect()}function ue(e){var t,i=document.documentElement.clientHeight,r=!1,n=(e.touches?e.changedTouches[0]:e).pageY,o=pe(E);sf.base.isNullOrUndefined(U)||(t=pe(U)),sf.base.isNullOrUndefined(U)?sf.base.isNullOrUndefined(U)&&(i-n>=0||o.top<0)&&(r=!0):r=!0;var s=Q+(n-Z);s=s>k?s:k;var a=0;sf.base.isNullOrUndefined(U)||(a=t.top);var l=sf.base.isNullOrUndefined(U)?0:U.offsetHeight-U.clientHeight,h=o.top-a-l/2;if(h=h<0?0:h,o.top>0&&h+s>W){if(r=!1,E.classList.contains("e-resize-viewport"))return;E.style.height=W-parseInt(h.toString(),10)+"px"}else{var d=0;if(r){o.top<0&&i+(o.height+o.top)>0&&s+(d=o.top)<=30&&(s=o.height-(o.height+o.top)+30),s+o.top>=W&&(E.style.height=o.height+(i-(o.height+o.top))+"px");var c=sf.base.isNullOrUndefined(U)?d:h;s>=k&&s+c<=W&&(E.style.height=s+"px")}}}function ge(e){var t,i=!1,r="mouse"===se(e.type)?e.pageY:e.touches[0].pageY,n=pe(E);sf.base.isNullOrUndefined(U)||(t=pe(U)),(!sf.base.isNullOrUndefined(U)&&n.top-t.top>0||sf.base.isNullOrUndefined(U)&&r>0)&&(i=!0);var o=Q-(r-Z);if(i&&o>=k&&o<=W){var s=0;sf.base.isNullOrUndefined(U)||(s=t.top);var a=G-s+(r-Z);a=a>0?a:1,E.style.height=o+"px",E.style.top=a+"px"}}function fe(e){var t,i=document.documentElement.clientWidth,r=!1;sf.base.isNullOrUndefined(U)||(t=pe(U));var n="mouse"===se(e.type)?e.pageX:e.touches[0].pageX,o=pe(E),s=sf.base.isNullOrUndefined(U)?0:U.offsetWidth-U.clientWidth,a=sf.base.isNullOrUndefined(U)?0:t.left,l=sf.base.isNullOrUndefined(U)?0:t.width;sf.base.isNullOrUndefined(H)&&(sf.base.isNullOrUndefined(U)?H=i:(H=o.left-a-s/2+o.width,H+=l-s-H)),(!sf.base.isNullOrUndefined(U)&&Math.floor(o.left-t.left+o.width+(t.right-o.right))-s<=j||sf.base.isNullOrUndefined(U)&&n>=0)&&(r=!0);var h=Y-(n-X);if(ee&&(h=h>H?H:h),r&&h>=R&&h<=j){var d=0;sf.base.isNullOrUndefined(U)||(d=t.left);var c=q-d+(n-X);c=c>0?c:1,h!==te&&ie&&(E.style.width=h+"px"),ee&&(E.style.left=c+"px",ie=1!==c)}te=h}function me(e){var t,i=document.documentElement.clientWidth,r=!1;sf.base.isNullOrUndefined(U)||(t=pe(U));var n=(e.touches?e.changedTouches[0]:e).pageX,o=pe(E);(!sf.base.isNullOrUndefined(U)&&(o.left-t.left+o.width<=j||o.right-t.left>=o.width)||sf.base.isNullOrUndefined(U)&&i-n>0)&&(r=!0);var s=Y+(n-X),a=0;if(sf.base.isNullOrUndefined(U)||(a=t.left),o.left-a+s>j){if(r=!1,E.classList.contains("e-resize-viewport"))return;E.style.width=j-(o.left-a)+"px"}r&&s>=R&&s<=j&&(E.style.width=s+"px")}return e.fit=function(e,t,i,r){if(void 0===t&&(t=null),void 0===i&&(i={X:!1,Y:!1}),!i.Y&&!i.X)return{left:0,top:0};var n=e.getBoundingClientRect();if(s=t,o=e.ownerDocument,r||(r=l(e,"left","top")),i.X){var a=s?M():D(),h=O(),d=T(),c=h-r.left,p=r.left+n.width-d;n.width>a?r.left=c>0&&p<=0?d-n.width:p>0&&c<=0?h:c>p?d-n.width:h:c>0?r.left+=c:p>0&&(r.left-=p)}if(i.Y){var u=s?N():F(),g=C(),f=P(),m=g-r.top,y=r.top+n.height-f;n.height>u?r.top=m>0&&y<=0?f-n.height:y>0&&m<=0?g:m>y?f-n.height:g:m>0?r.top+=m:y>0&&(r.top-=y)}return r},e.isCollide=function(e,t,i,r){void 0===t&&(t=null);var n=l(e,"left","top");i&&(n.left=i),r&&(n.top=r);var a=[];s=t,o=e.ownerDocument;var h=e.getBoundingClientRect(),d=n.top,c=n.left,p=n.left+h.width,u=x(d,n.top+h.height),g=w(c,p);return u.topSide&&a.push("top"),g.rightSide&&a.push("right"),g.leftSide&&a.push("left"),u.bottomSide&&a.push("bottom"),a},e.flip=function(e,t,i,r,n,a,h,d,c){if(void 0===h&&(h=null),void 0===d&&(d={X:!0,Y:!0}),t&&e&&n&&a&&(d.X||d.Y)){var p,u={TL:null,TR:null,BL:null,BR:null},g={TL:null,TR:null,BL:null,BR:null};if("none"===window.getComputedStyle(e).display){var f=e.style.visibility;e.style.visibility="hidden",e.style.display="block",p=e.getBoundingClientRect(),e.style.removeProperty("display"),e.style.visibility=f}else p=e.getBoundingClientRect();var m={posX:n,posY:a,offsetX:i,offsetY:r,position:{left:0,top:0}};s=h,o=t.ownerDocument,function(e,t,i,r,n){i.position=l(e,i.posX,i.posY,r,n),t.TL=l(e,"left","top",r,n),t.TR=l(e,"right","top",r,n),t.BR=l(e,"left","bottom",r,n),t.BL=l(e,"right","bottom",r,n)}(t,u,m,c,p),b(g,m,p),d.X&&function e(t,i,r,n,o,s){var a=w(i.TL.left,i.TR.left);r.TL.left-L()<=O()&&(a.leftSide=!1);r.TR.left>T()&&(a.rightSide=!1);(a.leftSide&&!a.rightSide||!a.leftSide&&a.rightSide)&&("right"===n.posX?n.posX="left":n.posX="right",n.offsetX=n.offsetX+o.width,n.offsetX=-1*n.offsetX,n.position=l(t,n.posX,n.posY,!1),b(i,n,o),s&&e(t,i,r,n,o,!1))}(t,g,u,m,p,!0),d.Y&&u.TL.top>-1&&function e(t,i,r,n,o,s){var a=x(i.TL.top,i.BL.top);r.TL.top-A()<=C()&&(a.topSide=!1);r.BL.top>=P()&&t.getBoundingClientRect().bottom<window.innerHeight&&(a.bottomSide=!1);(a.topSide&&!a.bottomSide||!a.topSide&&a.bottomSide)&&("top"===n.posY?n.posY="bottom":n.posY="top",n.offsetY=n.offsetY+o.height,n.offsetY=-1*n.offsetY,n.position=l(t,n.posX,n.posY,!1,o),b(i,n,o),s&&e(t,i,r,n,o,!1))}(t,g,u,m,p,!0),function(e,t,i){var r=0,n=0;if(null!=e.offsetParent&&("absolute"===getComputedStyle(e.offsetParent).position||"relative"===getComputedStyle(e.offsetParent).position)){var o=l(e.offsetParent,"left","top",!1,i);r=o.left,n=o.top}e.style.top=t.position.top+t.offsetY-n+"px",e.style.left=t.position.left+t.offsetX-r+"px"}(e,m,p)}},e.calculateRelativeBasedPosition=function(e,t){var i=!1,r={left:0,top:0},n=e;if(!e||!t)return r;for(sf.base.isNullOrUndefined(t.offsetParent)&&"fixed"===t.style.position&&(i=!0);(t.offsetParent||i)&&e&&t.offsetParent!==e;)r.left+=e.offsetLeft,r.top+=e.offsetTop,e=e.offsetParent;for(e=n;(t.offsetParent||i)&&e&&t.offsetParent!==e;)r.left-=e.scrollLeft,r.top-=e.scrollTop,e=e.parentElement;return r},e.calculatePosition=l,e.createResize=function(e){K=e.resizeBegin,J=e.resizing,$=e.resizeComplete,E=ne(e.element),U=ne(e.boundary);for(var t=e.direction.split(" "),i=0;i<t.length;i++)if(V.indexOf(t[i])>=0&&t[i])re(t[i]);else if(""!==t[i].trim()){var r=sf.base.createElement("div",{className:"e-icons e-resize-handle e-"+t[i]});E.appendChild(r)}k=e.minHeight,R=e.minWidth,j=e.maxWidth,W=e.maxHeight,e.proxy&&e.proxy.element&&e.proxy.element.classList.contains("e-dialog")?oe(e.proxy):oe()},e.setMinHeight=function(e){k=e},e.setMaxWidth=function(e){j=e},e.setMaxHeight=function(e){W=e},e.removeResize=function(){for(var e=E.querySelectorAll(".e-resize-handle"),t=0;t<e.length;t++)sf.base.detach(e[t]);var i=E.querySelectorAll(".e-dialog-border-resize");if(!sf.base.isNullOrUndefined(i))for(t=0;t<i.length;t++)sf.base.detach(i[t])},e}({}))},"./modules/sf-colorpicker.js":function(e,t){window.sfBlazor=window.sfBlazor||{},window.sfBlazor.ColorPicker=function(){"use strict";var e=function(){function e(e,t,i,r){this.dataId=e,this.element=t,this.dotnetRef=i,window.sfBlazor.setCompInstance(this),r&&(this.addScrollEvents(!0),this.setPaletteWidth(this.element.querySelector(".e-container"),!1))}return e.prototype.getOffset=function(e){var t=e.querySelector(".e-hsv-container");if(!t)return{IsDevice:sf.base.Browser.isDevice};var i=t.getBoundingClientRect(),r=t.querySelector(".e-hsv-color"),n=t.querySelector(".e-handler");return n&&n.focus(),{Left:i.left,Top:i.top,Width:i.width,Height:i.height,Right:i.right,ClientLeft:r.offsetLeft,ClientTop:r.offsetTop,ClientWidth:r.offsetWidth,ClientHeight:r.offsetHeight,IsDevice:sf.base.Browser.isDevice}},e.prototype.setOffset=function(e,t){var i=this.getOffset(e);t&&!sf.base.Browser.isDevice&&(this.setZIndex(this.element,t,".e-split-colorpicker"),this.setZIndex(this.element,t,".e-dropdown-btn")),i&&this.dotnetRef.invokeMethodAsync("SetOffset",i)},e.prototype.setZIndex=function(e,t,i){var r=e.querySelector(i);r&&(r.style.zIndex=t+1+"")},e.prototype.removeZIndex=function(){var e=this.element.querySelector(".e-split-colorpicker"),t=this.element.querySelector(".e-dropdown-btn");e&&(e.style.zIndex=""),t&&(t.style.zIndex="")},e.prototype.setPaletteWidth=function(e,t,i){if(sf.base.Browser.isDevice&&!sf.base.isNullOrUndefined(i)){var r=e.querySelector(".e-colorpicker.e-modal");r&&(r.style.zIndex=i-1+"",document.body.insertBefore(r,e.parentElement),r.style.display="")}if(e.querySelector(".e-hsv-container"))e.style.width="";else{var n=parseInt(getComputedStyle(e).borderBottomWidth,10);e.style.width=e.children[0].offsetWidth+n+n+"px";var o=e.querySelector(".e-selected-value");o&&(o.style.width="100%",(o=e.querySelector(".e-switch-ctrl-btn"))&&(o.style.width="100%"))}if(t){var s=window.sfBlazor.getCompInstance(this.dataId);sf.base.isNullOrUndefined(s)||s.setPosition(!0)}},e.prototype.scrollHandler=function(e){this.element.parentElement?this.setOffset(this.element):sf.base.EventHandler.remove(e.target,"scroll",this.scrollHandler)},e.prototype.addScrollEvents=function(e){for(var t=0,i=sf.popups.getScrollableParent(this.element);t<i.length;t++){var r=i[t];e?sf.base.EventHandler.add(r,"scroll",this.scrollHandler,this):sf.base.EventHandler.remove(r,"scroll",this.scrollHandler)}},e.prototype.focusIn=function(e,t){if(t){var i=e.querySelector(".e-container");i&&(i.classList.contains("e-color-palette")?this.setFocus(".e-palette"):this.setFocus(".e-handler"))}else this.setFocus(".e-split-colorpicker")},e.prototype.setFocus=function(e){var t=this.element.querySelector(e);t&&t.focus()},e.prototype.paletteKeyDown=function(e,t){var i=e.target;if(i.classList.contains("e-palette")){var r,n,o,s=[].slice.call(sf.base.selectAll(".e-tile",i)),a=s.filter((function(e){return e.classList.contains("e-selected")})).pop(),l=i.parentElement;switch(!e.altKey&&e.keyCode){case 39:e.preventDefault(),o=(r=a?s[this.tilePosition(s,a,t?-1:1)]:s[t?s.length-1:0]).getAttribute("aria-label"),this.keySelectionChanges(r,l,o);break;case 37:e.preventDefault(),o=(r=a?s[this.tilePosition(s,a,t?1:-1)]:s[t?0:s.length-1]).getAttribute("aria-label"),this.keySelectionChanges(r,l,o);break;case 38:e.preventDefault(),o=(r=s[n=a?this.tilePosition(s,a,-10):0]?s[n]:s[n-10]).getAttribute("aria-label"),this.keySelectionChanges(r,l,o);break;case 40:e.preventDefault(),s[n=a?this.tilePosition(s,a,10):s.length-1]?r=s[n]:(n%=s.length,r=s[n+=s[s.length-1].parentElement.childElementCount]),o=r.getAttribute("aria-label"),this.keySelectionChanges(r,l,o);break;case 13:if(e.preventDefault(),a){a.getAttribute("aria-label");this.dotnetRef.invokeMethodAsync("Close")}}}},e.prototype.tilePosition=function(e,t,i){var r=(e=Array.prototype.slice.call(e)).length,n=10-e[r-1].parentElement.childElementCount,o=e.indexOf(t);return(o+=i)<0?o+=r+n:o%=r+n,o},e.prototype.keySelectionChanges=function(e,t,i){this.removeTileSelection(t),this.addTileSelection(e),this.dotnetRef.invokeMethodAsync("Click",i)},e.prototype.removeTileSelection=function(e){[].slice.call(sf.base.selectAll(".e-selected",e.children[0])).forEach((function(e){e.classList.remove("e-selected"),e.setAttribute("aria-selected","false")}))},e.prototype.addTileSelection=function(e){e.classList.add("e-selected"),e.setAttribute("aria-selected","true")},e}();return{initialize:function(t,i,r,n){return sf.base.isNullOrUndefined(i)?null:(new e(t,i,r,n),window.sfBlazor.getCompInstance(t).getOffset(i))},getOffset:function(e,t){var i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)?null:(i.setPaletteWidth(t,!0),i.getOffset(t))},focusIn:function(e,t,i){var r=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(r)||r.focusIn(t,i)},destroy:function(e){var t=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(t)||t.addScrollEvents(!1)}}}()},"./modules/sf-contextmenu.js":function(e,t){window.sfBlazor=window.sfBlazor||{},window.sfBlazor.ContextMenu=function(){"use strict";function e(t,i,r,n){void 0===n&&(n=0);var o=t.children[i];return n===t.childElementCount?-1:((o.classList.contains("e-separator")||o.classList.contains("e-disabled")||o.classList.contains("e-menu-hide"))&&(i=r?i===t.childElementCount-1?0:i+1:0===i?t.childElementCount-1:i-1,n++),((o=t.children[i]).classList.contains("e-separator")||o.classList.contains("e-disabled")||o.classList.contains("e-menu-hide"))&&(i=e(t,i,r)),i)}var t="e-menu-parent",i="CloseMenuAsync",r="mousedown touchstart",n=function(){function n(e,t,i,r,n,o,s,a){this.dataId=e,this.element=t,this.target=i,this.filter=r,this.showOn=n,this.closeOn=o,this.dotnetRef=a,this.enableScrolling=s,window.sfBlazor.setCompInstance(this),this.addContextMenuEvent(),this.addEventListener()}return n.prototype.addContextMenuEvent=function(e){var t;if(void 0===e&&(e=!0),this.target){var i=sf.base.selectAll(this.target);if(i.length){for(var r=0,n=i.length;r<n;r++)if(t=i[r],e)sf.base.Browser.isIos?new sf.base.Touch(t,{tapHold:this.touchHandler.bind(this)}):sf.base.EventHandler.add(t,this.showOn,this.cmenuHandler,this);else if(sf.base.Browser.isIos){var o=sf.base.getInstance(t,sf.base.Touch);o&&o.destroy()}else sf.base.EventHandler.remove(t,this.showOn,this.cmenuHandler);if(sf.base.isNullOrUndefined(this.targetElement)&&(this.targetElement=t),e){sf.base.EventHandler.add(this.targetElement,"scroll",this.scrollHandler,this);for(var s=0,a=sf.popups.getScrollableParent(this.targetElement);s<a.length;s++){var l=a[s];sf.base.EventHandler.add(l,"scroll",this.scrollHandler,this)}}else{var h=void 0;this.targetElement.parentElement?(sf.base.EventHandler.remove(this.targetElement,"scroll",this.scrollHandler),h=sf.popups.getScrollableParent(this.targetElement)):h=sf.popups.getScrollableParent(t);for(var d=0,c=h;d<c.length;d++){var p=c[d];sf.base.EventHandler.remove(p,"scroll",this.scrollHandler)}this.targetElement=null}}}},n.prototype.scrollHandler=function(){if(sf.base.select("."+t,this.element)&&(this.dotnetRef.invokeMethodAsync(i,0,!1,!0,!1),this.enableScrolling)){var e=this;setTimeout((function(){e.destroyScroll()}),100)}},n.prototype.vscrollHandler=function(){var e=this.element.querySelector(".e-menu-parent");null!=e&&e.classList.contains("e-transparent")&&e.classList.remove("e-transparent")},n.prototype.touchHandler=function(e){this.cmenuHandler(e.originalEvent)},n.prototype.keyDownHandler=function(i){var r=i.target.classList;(r.contains("e-menu-item")||r.contains(t))&&i.preventDefault(),function(t,i,r,n){if(40===r||38===r){var o=void 0,s=void 0,a=void 0;i.classList.contains("e-menu-parent")?((a=(s=i).querySelector(".e-menu-item.e-focused"))?(o=Array.prototype.indexOf.call(s.children,a),o=40===r?o===s.childElementCount-1?0:o+1:0===o?s.childElementCount-1:o-1):o=0,o=e(s,o,40===r)):i.classList.contains("e-menu-item")&&(a=(s=i.parentElement).querySelector(".e-menu-item.e-focused"),o=Array.prototype.indexOf.call(s.children,a||i),o=e(s,o=40===r?o===s.childElementCount-1?0:o+1:0===o?s.childElementCount-1:o-1,40===r)),s&&-1!==o&&s.children[o].focus()}else if(((t.classList.contains("e-rtl")?39===r:37===r)||27===r||13===r&&sf.base.closest(i,".e-menu-container"))&&(i.classList.contains("e-ul")||i.classList.contains("e-menu-item")&&!i.parentElement.classList.contains("e-contextmenu"))){var l=void 0;n&&(l=sf.base.select(n));s=i.classList.contains("e-ul")?i:i.parentElement;var h=sf.base.closest(s,".e-menu-vscroll"),d=void 0,c=h?h.previousElementSibling:s.previousElementSibling;if(!l||c&&13!==r){var p=sf.base.closest(s,".e-hamburger");d=p?sf.base.select(".e-menu-item.e-selected",p):sf.base.select(".e-menu-item.e-selected",c)}else d=sf.base.select(".e-menu-item.e-selected",l),(h=sf.base.select(".e-menu-vscroll",t))&&l.blazor__instance.destroyScroll("none");d&&d.focus()}}(this.element,i.target,i.keyCode,this.menuId)},n.prototype.cmenuHandler=function(e){if(this.cmTarget=e.target,this.filter){for(var t=!1,i=this.filter.split(" "),n=0,o=i.length;n<o;n++)if(sf.base.closest(e.target,i[n])){t=!0;break}if(!t)return}e.preventDefault(),e.stopPropagation();var s=e.changedTouches?e.changedTouches[0].clientX:e.clientX,a=e.changedTouches?e.changedTouches[0].clientY:e.clientY;if("mouseover"===this.showOn){var l=this.cmTarget.getBoundingClientRect();l.right>s&&s>l.right-5&&(s-=10),l.bottom>a&&a>l.bottom-5&&(a-=10)}this.closeOn!==r&&(sf.base.EventHandler.remove(e.target,this.showOn,this.cmenuHandler),"mouseleave"===this.closeOn?sf.base.EventHandler.add(e.target,this.closeOn,this.mouseLeaveHandler,this):sf.base.EventHandler.add(document,this.closeOn,this.delegateMouseDownHandler,this)),this.dotnetRef.invokeMethodAsync("OpenContextMenuAsync",Math.ceil(s),Math.ceil(a))},n.prototype.mouseLeaveHandler=function(e,t){var r=this.cmTarget.getBoundingClientRect(),n=r.top<e.clientY&&r.bottom-3>e.clientY;if(!(r.left<e.clientX&&r.right>e.clientX)||!n||t){if(this.dotnetRef.invokeMethodAsync(i,0,!1,!0,!1),this.enableScrolling){var o=this;setTimeout((function(){o.destroyScroll()}),100)}sf.base.EventHandler.remove(this.cmTarget,this.closeOn,this.mouseLeaveHandler),sf.base.EventHandler.add(this.cmTarget,this.showOn,this.cmenuHandler,this)}},n.prototype.clickHandler=function(e){if(e&&(sf.base.EventHandler.add(this.cmTarget,this.showOn,this.cmenuHandler,this),"mouseleave"===this.closeOn?sf.base.EventHandler.remove(this.cmTarget,this.closeOn,this.mouseLeaveHandler):sf.base.EventHandler.remove(document,this.closeOn,this.delegateMouseDownHandler)),this.enableScrolling){var t=this;setTimeout((function(){t.destroyScroll(null,!0)}),100)}},n.prototype.contextMenuPosition=function(e,t,i,r,n,o){var s=this.hideMenu(!0);if(s){this.subMenuOpen=!1,this.setBlankIconStyle(s,i);var a=s.getBoundingClientRect(),l=this.getMenuWidth(s,a.width,i);if(r&&sf.base.Browser.isDevice)return s.style.width=Math.ceil(l)+"px",void(s.style.visibility="");if(n){if(t+a.height>document.documentElement.clientHeight){var h=document.documentElement.clientHeight-a.height-20;h>document.documentElement.clientTop&&(t=h)}if(e+l>document.documentElement.clientWidth){var d=document.documentElement.clientWidth-l-20;d>document.documentElement.clientLeft&&(e=d)}}var c=(s=this.updateScroll(o,s)).classList.contains("e-menu-parent")?s:sf.base.select(".e-menu-parent",s);this.element.style.top=Math.ceil(t+1)+pageYOffset+"px",this.element.style.left=Math.ceil(e+1)+pageXOffset+"px",s.style.width=Math.ceil(l)+"px",this.element.style.zIndex=sf.popups.getZindexPartial(this.element).toString(),s.style.visibility="",c.style.visibility="",s.focus()}},n.prototype.setBlankIconStyle=function(e,t){var i=[].slice.call(e.getElementsByClassName("e-blankicon")),r=t?{padding:"paddingRight",cssSelector:"padding-right",margin:"marginLeft"}:{padding:"paddingLeft",cssSelector:"padding-left",margin:"marginRight"};if([].slice.call(e.querySelectorAll('.e-menu-item[style*="'+r.cssSelector+'"]:not(.e-blankicon)')).forEach((function(e){e.style[r.padding]=""})),i.length){var n=e.querySelector(".e-menu-item:not(.e-blankicon):not(.e-separator)"),o=n.querySelector(".e-menu-icon");if(o){var s=getComputedStyle(o),a=parseInt(s.fontSize,10);parseInt(s.width,10)&&parseInt(s.width,10)>a&&(a=parseInt(s.width,10));var l=a+parseInt(s[r.margin],10)+parseInt(getComputedStyle(n)[r.padding],10)+"px";i.forEach((function(e){e.style[r.padding]=l}))}}},n.prototype.getMenuWidth=function(e,t,i){var r=e.getElementsByClassName("e-caret")[0];return r&&(t+=parseInt(getComputedStyle(r)[i?"marginRight":"marginLeft"],10)),t<120?120:t},n.prototype.addEventListener=function(){this.delegateMouseDownHandler=this.mouseDownHandler.bind(this),this.delegateMouseOverHandler=this.mouseOverHandler.bind(this),this.closeOn===r&&sf.base.EventHandler.add(document,r,this.delegateMouseDownHandler,this),sf.base.EventHandler.add(document,"mouseover",this.delegateMouseOverHandler,this),sf.base.EventHandler.add(this.element,"keydown",this.keyDownHandler,this)},n.prototype.removeEventListener=function(){sf.base.EventHandler.remove(document,r,this.delegateMouseDownHandler),sf.base.EventHandler.remove(document,"mouseover",this.delegateMouseOverHandler),sf.base.EventHandler.remove(this.element,"keydown",this.keyDownHandler)},n.prototype.mouseDownHandler=function(e){var n=e.target;if("DIV"!==n.tagName&&"SPAN"!==n.tagName||!(n.className.indexOf("scroll")>-1||n.className.indexOf("arrow")>-1))if(document.getElementById(this.element.id)){if(!sf.base.closest(e.target,"#"+this.element.id)&&(sf.base.isNullOrUndefined(this.menuId)||!sf.base.closest(e.target,this.menuId))&&sf.base.select("."+t,this.element)){if(sf.base.closest(sf.base.select("."+t,this.element),".e-dropdown-popup")||this.dotnetRef.invokeMethodAsync(i,0,!1,!0,!1),this.enableScrolling){var o=this;setTimeout((function(){o.destroyScroll()}),100)}this.closeOn!==r&&(sf.base.EventHandler.remove(document,this.closeOn,this.delegateMouseDownHandler),sf.base.EventHandler.add(this.cmTarget,this.showOn,this.cmenuHandler,this))}}else this.removeEventListener()},n.prototype.isHavingChild=function(e){return e&&"LI"===e.tagName&&e.className.indexOf("e-menu-item")<0&&(e=e.closest(".e-menu-item")),!!(e&&"LI"===e.tagName&&e.className.indexOf("e-menu-item")>-1&&e.className.indexOf("e-menu-caret-icon")>-1)},n.prototype.mouseOverHandler=function(e){var r=e.target;if("DIV"!==r.tagName&&"SPAN"!==r.tagName||!(r.className.indexOf("scroll")>-1||r.className.indexOf("arrow")>-1))if(document.getElementById(this.element.id)){var n=[].slice.call(sf.base.selectAll("."+t,this.element));if(n.length){var o=sf.base.closest(r,".e-scroll-nav");if(this.enableScrolling&&!this.isHavingChild(r)){var s=this;setTimeout((function(){for(var e=[].slice.call(sf.base.selectAll(".e-menu-vscroll",this.element)),t=0;t<e.length;t++)r&&"LI"===r.tagName&&r.className.indexOf("e-menu-item")<0&&(r=r.closest(".e-menu-item")),r&&r.parentElement!=e[t].querySelectorAll(".e-menu-parent")[0]&&t==e.length-1&&s.destroyScroll(e[t])}),100)}if(this.subMenuOpen&&(n.length>1||!sf.base.isNullOrUndefined(this.menuId)&&!o)){if(!sf.base.closest(r,"#"+this.element.id)&&(sf.base.isNullOrUndefined(this.menuId)||!sf.base.closest(r,this.menuId))||o){var a=1;if(!sf.base.isNullOrUndefined(this.menuId)&&(a=0,o&&(a=n.indexOf(sf.base.select("."+t,o.parentElement))+1)===n.length))return;if(this.dotnetRef.invokeMethodAsync(i,a,!1,!0,!1),this.enableScrolling){var l=this;setTimeout((function(){for(var e=a;e<n.length;e++)l.destroyScroll(n[e])}),100)}"mouseleave"===this.closeOn&&(this.mouseLeaveHandler(e),sf.base.EventHandler.remove(this.menuTarget,this.closeOn,this.menuMouseLeave)),sf.base.isNullOrUndefined(this.menuId)||sf.base.closest(r,".e-scroll-nav")||this.destroyMenuScroll(null)}sf.base.isNullOrUndefined(this.menuId)||!sf.base.closest(r,"#"+this.element.id)&&!sf.base.closest(r,this.menuId)||!sf.base.closest(r,".e-menu-item")||sf.base.closest(r,".e-selected")||this.destroyMenuScroll(sf.base.closest(r,"."+t))}else"mouseleave"===this.closeOn&&r.classList.contains("e-menu-item")&&(this.menuTarget=r.parentElement,sf.base.EventHandler.add(this.menuTarget,this.closeOn,this.menuMouseLeave,this));if(!this.openAsMenu){var h=document.activeElement;if(!sf.base.closest(h,"#"+this.element.id)&&n.length&&"BODY"==h.tagName){var d=this.getLastMenu();d&&d.focus()}}}}else this.removeEventListener()},n.prototype.menuMouseLeave=function(e){var t=this.menuTarget.getBoundingClientRect(),i=t.top<e.clientY&&t.bottom>e.clientY;t.left<e.clientX&&t.right>e.clientX&&i||(this.mouseLeaveHandler(e,!0),sf.base.EventHandler.remove(this.menuTarget,this.closeOn,this.menuMouseLeave))},n.prototype.destroyMenuScroll=function(e){if(sf.base.select(".e-menu-vscroll",this.element)){var t=window.sfBlazor.getCompInstance(this.dataId);sf.base.isNullOrUndefined(t)||t.destroyScroll("none",e)}},n.prototype.hideMenu=function(e){var i;if(e){if(!(i=sf.base.select("."+t,this.element))||sf.base.isNullOrUndefined(this.element.parentElement))return null;this.element.parentElement!==document.body&&document.body.appendChild(this.element)}else{var r=sf.base.selectAll("."+t,this.element);if(r.length<2)return null;i=r[r.length-1]}return i.style.width="",i.style.visibility="hidden",i.classList.remove("e-transparent"),i},n.prototype.subMenuPosition=function(e,i,r,n,o,s,a){if(e){var l=sf.base.selectAll("."+t,this.element),h=l[l.length-2].querySelector(".e-menu-item.e-selected").getBoundingClientRect(),d=this.element.getBoundingClientRect(),c=e.classList.contains(t)?e:sf.base.select("."+t,e);this.setBlankIconStyle(c,i);var p,u,g=c.getBoundingClientRect(),f=this.getMenuWidth(c,g.width,i);i?(u=parseInt(getComputedStyle(c).borderWidth,10),p=h.left-f-d.left):p="mouseleave"==this.closeOn?h.right-d.left-10:h.right-d.left;var m=h.top-d.top;if(i)h.left-u-f<document.documentElement.clientLeft&&h.right+f<document.documentElement.clientWidth&&(p=h.right-d.left);else if(h.right+f>document.documentElement.clientWidth){var y=h.left-f;y>document.documentElement.clientLeft&&(p=y-d.left,"mouseleave"==this.closeOn&&(p=y-d.left+10))}var v=o||g.height;if(h.top+v>document.documentElement.clientHeight){var b=document.documentElement.clientHeight-v-20;b>document.documentElement.clientTop&&(m=b-d.top)}s&&(e=this.updateScroll(o,e)).className.indexOf("scroll")>-1&&(c.style.left="0px",c.style.top="0px"),this.subMenuOpen=!r,e.style.left=Math.ceil(p)+"px",e.style.top=Math.ceil(m)+"px",e.style.width=Math.ceil(f)+"px",c.style.visibility="";var w=c.querySelector(".e-menu-item.e-focused");w?w.focus():a&&c.focus(),n&&(this.openAsMenu=!0)}},n.prototype.updateScroll=function(e,t){if(this.enableScrolling){this.destroyScroll(t),e>0&&t&&(t=sf.navigations.addScrolling(sf.base.createElement,this.element,t,"vscroll",!1,e));var i=this.element.querySelector(".e-vscroll-bar");i&&sf.base.EventHandler.add(i,"scroll",this.vscrollHandler,this)}return t},n.prototype.destroyScroll=function(e,t){sf.base.selectAll(".e-menu-vscroll",this.element).forEach((function(i){(t&&!i.querySelector("ul")||!t)&&sf.navigations.destroyScroll(sf.base.getInstance(i,sf.navigations.VScroll),i,e)}))},n.prototype.getLastMenu=function(){var e=sf.base.selectAll("."+t,this.element);return e.length?e[e.length-1]:null},n.prototype.onPropertyChanged=function(e,t){switch(e){case"Target":this.addContextMenuEvent(!1),this.target=t,this.addContextMenuEvent();break;case"Filter":this.filter=t;break;case"ShowOn":this.addContextMenuEvent(!1),this.showOn=t,this.addContextMenuEvent()}},n.prototype.destroy=function(e){this.removeEventListener(),this.addContextMenuEvent(!1),e&&e.parentElement&&e.previousElementSibling!==this.element&&e.parentElement.insertBefore(this.element,e),e&&e.parentElement||!this.element.parentElement||this.element.parentElement!==document.body||document.body.removeChild(this.element)},n.prototype.updateProperty=function(e,t){t&&(this.menuId="#"+t.id),this.subMenuOpen=!e},n}();return{initialize:function(e,t,i,r,o,s,a,l){sf.base.isNullOrUndefined(t)||new n(e,t,i,r,o,s,a,l)},contextMenuPosition:function(e,t,i,r,n,o,s){var a=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(a)||a.contextMenuPosition(t,i,r,n,o,s)},subMenuPosition:function(e,t,i,r,n){var o=window.sfBlazor.getCompInstance(e);if(!sf.base.isNullOrUndefined(o)){var s=o.hideMenu();o.subMenuPosition(s,t,i,r,n,!0)}},onPropertyChanged:function(e,t,i){var r=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(r)||r.onPropertyChanged(t,i)},click:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||i.clickHandler(t)},destroy:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||i.destroy(t)}}}()},"./modules/sf-datepicker.js":function(e,t){window.sfBlazor=window.sfBlazor||{},window.sfBlazor.DatePicker=function(){"use strict";var e="Tab",t=function(){function t(){this.mask="",this.hiddenMask="",this.validCharacters="dMyhmHts",this.isDayPart=!1,this.isMonthPart=!1,this.isYearPart=!1,this.isHourPart=!1,this.isMinutePart=!1,this.isSecondsPart=!1,this.isMilliSecondsPart=!1,this.monthCharacter="",this.periodCharacter="",this.isHiddenMask=!1,this.isComplete=!1,this.isNavigate=!1,this.navigated=!1,this.formatRegex=/E{3,4}|d{1,4}|M{1,4}|y{1,4}|H{1,2}|h{1,2}|m{1,2}|f{1,7}|FF|t{1,2}|s{1,2}|z{1,4}|'[^']*'|'[^']*'/g,this.isDeletion=!1,this.isShortYear=!1,this.isDeleteKey=!1,this.isDateZero=!1,this.isMonthZero=!1,this.isYearZero=!1,this.dayTypeCount=0,this.monthTypeCount=0,this.hourTypeCount=0,this.minuteTypeCount=0,this.secondTypeCount=0}return t.prototype.keydownHandler=function(t){switch(t.code){case"ArrowLeft":case"ArrowRight":case"ArrowUp":case"ArrowDown":case"Home":case"End":case"Delete":"Delete"!==t.code&&t.preventDefault(),this.isPopupOpen||this.maskKeydownHandler(t);break;case e:case"shiftTab":this.maskKeydownHandler(t)}},t.prototype.clearHandler=function(){this.isDayPart=this.isMonthPart=this.isYearPart=this.isHourPart=this.isMinutePart=this.isSecondsPart=!1,this.updateValue()},t.prototype.updateValue=function(){this.monthCharacter=this.periodCharacter="";var e=this.dateformat.replace(this.formatRegex,this.formatCheck());this.isHiddenMask=!0,this.hiddenMask=this.dateformat.replace(this.formatRegex,this.formatCheck()),this.isHiddenMask=!1,this.previousHiddenMask=this.hiddenMask,this.previousValue=e},t.prototype.zeroCheck=function(e,t,i){var r=i;return e&&!t&&(r="0"),r},t.prototype.roundOff=function(e,t){for(var i=e.toString(),r=t-i.length,n="",o=0;o<r;o++)n+="0";return n+i},t.prototype.formatCheck=function(){var e=this;return function(t){var i,r,n=e.dayAbbreviatedName,o=Object.keys(n),s=e.dayName,a=Object.keys(s),l=e.monthAbbreviatedName,h=e.monthName,d=e.dayPeriod,c=Object.keys(d);switch(t){case"d":i=e.isDayPart?e.maskDateValue.getDate().toString():e.maskPlaceholderDictionary.Day.toString(),i=e.zeroCheck(e.isDateZero,e.isDayPart,i),2==e.dayTypeCount&&(e.isNavigate=!0,e.dayTypeCount=0);break;case"dd":i=e.isDayPart?e.roundOff(e.maskDateValue.getDate(),2):e.maskPlaceholderDictionary.Day.toString(),i=e.zeroCheck(e.isDateZero,e.isDayPart,i),2==e.dayTypeCount&&(e.isNavigate=!0,e.dayTypeCount=0);break;case"ddd":i=e.isDayPart&&e.isMonthPart&&e.isYearPart?n[o[e.maskDateValue.getDay()]].toString():e.maskPlaceholderDictionary.DayOfWeek.toString();break;case"dddd":i=e.isDayPart&&e.isMonthPart&&e.isYearPart?s[a[e.maskDateValue.getDay()]].toString():e.maskPlaceholderDictionary.DayOfWeek.toString();break;case"M":i=e.isMonthPart?(e.maskDateValue.getMonth()+1).toString():e.maskPlaceholderDictionary.Month.toString(),i=e.zeroCheck(e.isMonthZero,e.isMonthPart,i),2==e.monthTypeCount&&(e.isNavigate=!0,e.monthTypeCount=0);break;case"MM":i=e.isMonthPart?e.roundOff(e.maskDateValue.getMonth()+1,2):e.maskPlaceholderDictionary.Month.toString(),i=e.zeroCheck(e.isMonthZero,e.isMonthPart,i),2==e.monthTypeCount&&(e.isNavigate=!0,e.monthTypeCount=0);break;case"MMM":i=e.isMonthPart?l[e.maskDateValue.getMonth()]:e.maskPlaceholderDictionary.Month.toString();break;case"MMMM":i=e.isMonthPart?h[e.maskDateValue.getMonth()]:e.maskPlaceholderDictionary.Month.toString();break;case"yy":i=e.isYearPart?e.roundOff(e.maskDateValue.getFullYear()%100,2):e.maskPlaceholderDictionary.Year.toString(),i=e.zeroCheck(e.isYearZero,e.isYearPart,i),e.isYearPart&&(e.isNavigate=e.isShortYear=2===(e.maskDateValue.getFullYear()%100).toString().length);break;case"y":case"yyyy":i=e.isYearPart?e.roundOff(e.maskDateValue.getFullYear(),4):e.maskPlaceholderDictionary.Year.toString(),i=e.zeroCheck(e.isYearZero,e.isYearPart,i);break;case"h":i=e.isHourPart?(e.maskDateValue.getHours()%12||12).toString():e.maskPlaceholderDictionary.Hour.toString(),2==e.hourTypeCount&&(e.isNavigate=!0,e.hourTypeCount=0);break;case"hh":i=e.isHourPart?e.roundOff(e.maskDateValue.getHours()%12||12,2):e.maskPlaceholderDictionary.Hour.toString(),2==e.hourTypeCount&&(e.isNavigate=!0,e.hourTypeCount=0);break;case"H":i=e.isHourPart?e.maskDateValue.getHours().toString():e.maskPlaceholderDictionary.Hour.toString(),2==e.hourTypeCount&&(e.isNavigate=!0,e.hourTypeCount=0);break;case"HH":i=e.isHourPart?e.roundOff(e.maskDateValue.getHours(),2):e.maskPlaceholderDictionary.Hour.toString(),2==e.hourTypeCount&&(e.isNavigate=!0,e.hourTypeCount=0);break;case"m":i=e.isMinutePart?e.maskDateValue.getMinutes().toString():e.maskPlaceholderDictionary.Minute.toString(),2==e.minuteTypeCount&&(e.isNavigate=!0,e.minuteTypeCount=0);break;case"mm":i=e.isMinutePart?e.roundOff(e.maskDateValue.getMinutes(),2):e.maskPlaceholderDictionary.Minute.toString(),2==e.minuteTypeCount&&(e.isNavigate=!0,e.minuteTypeCount=0);break;case"s":i=e.isSecondsPart?e.maskDateValue.getSeconds().toString():e.maskPlaceholderDictionary.Second.toString(),2==e.secondTypeCount&&(e.isNavigate=!0,e.secondTypeCount=0);break;case"ss":i=e.isSecondsPart?e.roundOff(e.maskDateValue.getSeconds(),2):e.maskPlaceholderDictionary.Second.toString(),2==e.secondTypeCount&&(e.isNavigate=!0,e.secondTypeCount=0);break;case"f":i=Math.floor(e.maskDateValue.getMilliseconds()/100).toString();break;case"FF":case"ff":r=e.maskDateValue.getMilliseconds(),e.maskDateValue.getMilliseconds()>99&&(r=Math.floor(e.maskDateValue.getMilliseconds()/10)),i=e.roundOff(r,2);break;case"fff":i=e.roundOff(e.maskDateValue.getMilliseconds(),3);break;case"ffff":i=e.roundOff(e.maskDateValue.getMilliseconds(),4);break;case"fffff":i=e.roundOff(e.maskDateValue.getMilliseconds(),5);break;case"ffffff":i=e.roundOff(e.maskDateValue.getMilliseconds(),6);break;case"t":case"tt":i=e.maskDateValue.getHours()<12?d[c[0]]:d[c[1]];break;case"z":case"zz":i=e.offset.substring(0,3);break;case"zzz":case"zzzz":i=e.offset}if("ddd"===t&&(t="EEE"),"dddd"===t&&(t="EEEE"),i=void 0!==i?i:t.slice(1,t.length-1),e.isHiddenMask){for(var p="",u=0;u<i.length;u++)p+=t[0];return p}return i}},t.prototype.differenceCheck=function(){var e=this.element,t=e.selectionStart,i=e.value,r=this.previousValue.substring(0,t+this.previousValue.length-i.length),n=i.substring(0,t),o=new Date(+this.maskDateValue),s=new Date(o.getFullYear(),o.getMonth()+1,0).getDate();if(0===r.indexOf(n)&&(0===n.length||this.previousHiddenMask[n.length-1]!==this.previousHiddenMask[n.length])){for(var a=n.length;a<r.length;a++)""!==this.previousHiddenMask[a]&&this.validCharacters.indexOf(this.previousHiddenMask[a])>=0&&(this.isDeletion=this.handleDeletion(this.previousHiddenMask[a],!1));if(this.isDeletion)return}switch(this.previousHiddenMask[t-1]){case"d":var l=(this.isDayPart&&o.getDate().toString().length<2&&!this.isPersist()?10*o.getDate():0)+parseInt(n[t-1],10);if(this.isDateZero="0"==n[t-1],this.isFocused=!this.isFocused&&this.isFocused,this.navigated=!this.navigated&&this.navigated,isNaN(l))return;for(a=0;l>s;a++)l=parseInt(l.toString().slice(1),10);if(l>=1){if(o.setDate(l),this.isNavigate=2===l.toString().length,this.previousDate=new Date(o.getFullYear(),o.getMonth(),o.getDate()),o.getMonth()!==this.maskDateValue.getMonth())return;this.isDayPart=!0,this.dayTypeCount=this.dayTypeCount+1}else this.isDayPart=!1,this.dayTypeCount=this.isDateZero?this.dayTypeCount+1:this.dayTypeCount;break;case"M":var h=void 0;if(h=o.getMonth().toString().length<2&&!this.isPersist()?(this.isMonthPart?10*(o.getMonth()+1):0)+parseInt(n[t-1],10):parseInt(n[t-1],10),this.isFocused=!this.isFocused&&this.isFocused,this.navigated=!this.navigated&&this.navigated,this.isMonthZero="0"==n[t-1],isNaN(h)){var d=this.monthName,c=Object.keys(d);for(this.monthCharacter+=n[t-1].toLowerCase();this.monthCharacter.length>0;){a=0;for(var p=0,u=c;p<u.length;p++){u[p];if(0===d[a].toLowerCase().indexOf(this.monthCharacter))return o.setMonth(a),this.isMonthPart=!0,void(this.maskDateValue=o);a++}this.monthCharacter=this.monthCharacter.substring(1,this.monthCharacter.length)}}else{for(;h>12;){var g=h;0===(h=parseInt(h.toString().slice(1),10))&&(h=parseInt(g.toString().slice(0,1),10))}if(h>=1){if(o.setMonth(h-1),this.isNavigate=2===h.toString().length,o.getMonth()!==h-1&&(o.setDate(1),o.setMonth(h-1)),this.isDayPart){var f=new Date(this.previousDate.getFullYear(),this.previousDate.getMonth()+1,0).getDate(),m=new Date(o.getFullYear(),o.getMonth()+1,0).getDate();this.previousDate.getDate()==f&&m<=f&&o.setDate(m)}this.previousDate=new Date(o.getFullYear(),o.getMonth(),o.getDate()),this.isMonthPart=!0,this.monthTypeCount=this.monthTypeCount+1}else o.setMonth(0),this.isMonthPart=!1,this.monthTypeCount=this.isMonthZero?this.monthTypeCount+1:this.monthTypeCount}break;case"y":var y=(this.isYearPart&&o.getFullYear().toString().length<4&&!this.isShortYear?10*o.getFullYear():0)+parseInt(n[t-1],10);if(this.isShortYear=!1,this.isYearZero="0"==n[t-1],isNaN(y))return;for(;y>9999;)y=parseInt(y.toString().slice(1),10);y<1?this.isYearPart=!1:(o.setFullYear(y),4===y.toString().length&&(this.isNavigate=!0),this.previousDate=new Date(o.getFullYear(),o.getMonth(),o.getDate()),this.isYearPart=!0);break;case"h":if(this.hour=(this.isHourPart&&(o.getHours()%12||12).toString().length<2&&!this.isPersist()?10*(o.getHours()%12||12):0)+parseInt(n[t-1],10),this.isFocused=!this.isFocused&&this.isFocused,this.navigated=!this.navigated&&this.navigated,isNaN(this.hour))return;for(;this.hour>12;)this.hour=parseInt(this.hour.toString().slice(1),10);o.setHours(12*Math.floor(o.getHours()/12)+this.hour%12),this.isNavigate=2===this.hour.toString().length,this.isHourPart=!0,this.hourTypeCount=this.hourTypeCount+1;break;case"H":if(this.hour=(this.isHourPart&&o.getHours().toString().length<2&&!this.isPersist()?10*o.getHours():0)+parseInt(n[t-1],10),this.isFocused=!this.isFocused&&this.isFocused,this.navigated=!this.navigated&&this.navigated,isNaN(this.hour))return;for(a=0;this.hour>23;a++)this.hour=parseInt(this.hour.toString().slice(1),10);o.setHours(this.hour),this.isNavigate=2===this.hour.toString().length,this.isHourPart=!0,this.hourTypeCount=this.hourTypeCount+1;break;case"m":var v=(this.isMinutePart&&o.getMinutes().toString().length<2&&!this.isPersist()?10*o.getMinutes():0)+parseInt(n[t-1],10);if(this.isFocused=!this.isFocused&&this.isFocused,this.navigated=!this.navigated&&this.navigated,isNaN(v))return;for(a=0;v>59;a++)v=parseInt(v.toString().slice(1),10);o.setMinutes(v),this.isNavigate=2===v.toString().length,this.isMinutePart=!0,this.minuteTypeCount=this.minuteTypeCount+1;break;case"s":var b=(this.isSecondsPart&&o.getSeconds().toString().length<2&&!this.isPersist()?10*o.getSeconds():0)+parseInt(n[t-1],10);if(this.isFocused=!this.isFocused&&this.isFocused,this.navigated=!this.navigated&&this.navigated,isNaN(b))return;for(a=0;b>59;a++)b=parseInt(b.toString().slice(1),10);o.setSeconds(b),this.isNavigate=2===b.toString().length,this.isSecondsPart=!0,this.secondTypeCount=this.secondTypeCount+1;break;case"t":this.periodCharacter+=n[t-1].toLowerCase();var w=this.dayPeriod,x=Object.keys(w);for(a=0;this.periodCharacter.length>0;a++)(0===w[x[0]].toLowerCase().indexOf(this.periodCharacter)&&o.getHours()>=12||0===w[x[1]].toLowerCase().indexOf(this.periodCharacter)&&o.getHours()<12)&&(o.setHours((o.getHours()+12)%24),this.maskDateValue=o),this.periodCharacter=this.periodCharacter.substring(1,this.periodCharacter.length)}this.maskDateValue=o},t.prototype.maskKeydownHandler=function(t){var i=this.element;if(this.dayTypeCount=this.monthTypeCount=this.hourTypeCount=this.minuteTypeCount=this.secondTypeCount=0,"Delete"!==t.key){if(!(t.altKey||t.ctrlKey||"ArrowLeft"!==t.key&&"ArrowRight"!==t.key&&"shiftTab"!==t.key&&t.key!==e&&"shiftTab"!==t.action&&"End"!==t.key&&"Home"!==t.key)){var r=i.selectionStart,n=i.selectionEnd,o=i.value.length;if(0==r&&n==o&&(t.key===e&&!t.shiftKey||t.key===e&&t.shiftKey)){var s=t.key===e&&t.shiftKey?n:0;i.selectionStart=i.selectionEnd=s}if("End"===t.key||"Home"===t.key){var a="End"===t.key?o:0;i.selectionStart=i.selectionEnd=a}if(("ArrowLeft"===t.key||"ArrowRight"===t.key)&&0===r&&n===o){if("ArrowLeft"===t.key)for(var l=i.selectionEnd,h=l,d=l-1;h<this.hiddenMask.length||d>=0;h++,d--){if(h<this.hiddenMask.length&&-1!==this.validCharacters.indexOf(this.hiddenMask[h]))return void this.setSelection(this.hiddenMask[h]);if(d>=0&&-1!==this.validCharacters.indexOf(this.hiddenMask[d]))return void this.setSelection(this.hiddenMask[d])}else this.validCharacterCheck();return}this.navigateSelection(!!("ArrowLeft"===t.key||t.shiftKey&&t.key===e||"End"===t.key))}if(!(t.altKey||t.ctrlKey||"ArrowUp"!==t.key&&"ArrowDown"!==t.key)){r=i.selectionStart;var c="";-1!==this.validCharacters.indexOf(this.hiddenMask[r])&&(c=this.hiddenMask[r]),this.dateAlteration("ArrowDown"===t.key);var p=this.dateformat.replace(this.formatRegex,this.formatCheck());this.isHiddenMask=!0,this.hiddenMask=this.dateformat.replace(this.formatRegex,this.formatCheck()),this.isHiddenMask=!1,this.previousHiddenMask=this.hiddenMask,this.previousValue=p,i.value=p;for(h=0;h<this.hiddenMask.length;h++)if(c===this.hiddenMask[h]){r=h;break}i.selectionStart=r,this.validCharacterCheck()}}else this.isDeleteKey=!0},t.prototype.dateAlteration=function(e){var t=this.element.selectionStart,i="";if(-1!==this.validCharacters.indexOf(this.hiddenMask[t])){i=this.hiddenMask[t];var r=new Date(this.maskDateValue.getFullYear(),this.maskDateValue.getMonth(),this.maskDateValue.getDate(),this.maskDateValue.getHours(),this.maskDateValue.getMinutes(),this.maskDateValue.getSeconds());this.previousDate=new Date(this.maskDateValue.getFullYear(),this.maskDateValue.getMonth(),this.maskDateValue.getDate(),this.maskDateValue.getHours(),this.maskDateValue.getMinutes(),this.maskDateValue.getSeconds());var n=e?-1:1;switch(i){case"d":r.setDate(r.getDate()+n);break;case"M":var o=r.getMonth()+n;if(r.setDate(1),r.setMonth(o),this.isDayPart){var s=new Date(this.previousDate.getFullYear(),this.previousDate.getMonth()+1,0).getDate(),a=new Date(r.getFullYear(),r.getMonth()+1,0).getDate();this.previousDate.getDate()==s&&a<=s?r.setDate(a):r.setDate(this.previousDate.getDate())}else r.setDate(this.previousDate.getDate());this.previousDate=new Date(r.getFullYear(),r.getMonth(),r.getDate());break;case"y":r.setFullYear(r.getFullYear()+n);break;case"H":case"h":r.setHours(r.getHours()+n);break;case"m":r.setMinutes(r.getMinutes()+n);break;case"s":r.setSeconds(r.getSeconds()+n);break;case"t":r.setHours((r.getHours()+12)%24)}this.maskDateValue=r.getFullYear()>0?r:this.maskDateValue,-1!==this.validCharacters.indexOf(this.hiddenMask[t])&&this.handleDeletion(this.hiddenMask[t],!0)}},t.prototype.handleDeletion=function(e,t){switch(e){case"d":this.isDayPart=t;break;case"M":this.isMonthPart=t,t||(this.maskDateValue.setMonth(0),this.monthCharacter="");break;case"y":this.isYearPart=t;break;case"H":case"h":this.isHourPart=t,t||(this.periodCharacter="");break;case"m":this.isMinutePart=t;break;case"s":this.isSecondsPart=t;break;default:return!1}return!0},t.prototype.isPersist=function(){return this.isFocused||this.navigated},t.prototype.setDynamicValue=function(){this.maskDateValue=new Date(this.options.valueString),this.isDayPart=this.isMonthPart=this.isYearPart=this.isHourPart=this.isMinutePart=this.isSecondsPart=!0,this.updateValue(),this.validCharacterCheck()},t.prototype.validCharacterCheck=function(){var e=this.element,t=e.selectionStart;if("TimePicker"==this.componentName){if(t==this.hiddenMask.length)return void e.setSelectionRange(0,t);if(this.isPopupOpen)return void e.setSelectionRange(0,this.hiddenMask.length)}for(var i=t,r=t-1;i<this.hiddenMask.length||r>=0;i++,r--){if(i<this.hiddenMask.length&&-1!==this.validCharacters.indexOf(this.hiddenMask[i]))return void this.setSelection(this.hiddenMask[i]);if(r>=0&&-1!==this.validCharacters.indexOf(this.hiddenMask[r]))return void this.setSelection(this.hiddenMask[r])}},t.prototype.setSelection=function(e){for(var t=this.element,i=-1,r=0,n=0;n<this.hiddenMask.length;n++)this.hiddenMask[n]===e&&(r=n+1,-1===i&&(i=n));i<0&&(i=0),t.setSelectionRange(i,r)},t.prototype.maskInputHandler=function(){var e,t=this.element,i=t.selectionStart,r="";-1!==this.validCharacters.indexOf(this.hiddenMask[i])&&(r=this.hiddenMask[i]),this.differenceCheck(),e=this.dateformat.replace(this.formatRegex,this.formatCheck()),this.isHiddenMask=!0,this.hiddenMask=this.dateformat.replace(this.formatRegex,this.formatCheck()),this.isDateZero=this.isMonthZero=this.isYearZero=!1,this.isHiddenMask=!1,this.previousHiddenMask=this.hiddenMask,this.previousValue=e,t.value=e;for(var n=0;n<this.hiddenMask.length;n++)if(r===this.hiddenMask[n]){i=n;break}if(t.selectionStart=i,this.validCharacterCheck(),(this.isNavigate||this.isDeletion)&&!this.isDeleteKey){var o=!this.isNavigate;this.isNavigate=this.isDeletion=!1,this.navigateSelection(o)}this.isDeleteKey&&(this.isDeletion=!1),this.isDeleteKey=!1},t.prototype.navigateSelection=function(e){var t=this.element,i=t.selectionStart,r=t.selectionEnd,n=e?i-1:r;for(this.navigated=!0;n<this.hiddenMask.length&&n>=0;){if(this.validCharacters.indexOf(this.hiddenMask[n])>=0){this.setSelection(this.hiddenMask[n]);break}n+=e?-1:1}},t.prototype.createMask=function(e){this.options=e;this.element;this.isDayPart=this.isMonthPart=this.isYearPart=this.isHourPart=this.isMinutePart=this.isSecondsPart=!1,this.dateformat=this.options.format;var t=this.dateformat.replace(this.formatRegex,this.formatCheck());return this.isHiddenMask=!0,this.hiddenMask=this.dateformat.replace(this.formatRegex,this.formatCheck()),this.isHiddenMask=!1,this.previousHiddenMask=this.hiddenMask,this.mask=this.previousValue=t,this.options.value&&(this.value=this.options.value,this.setDynamicValue()),t=this.dateformat.replace(this.formatRegex,this.formatCheck()),{currentMaskFormat:this.mask,inputElementValue:t}},t.prototype.updateCurrentValue=function(e){this.element.value=e},t}(),i="e-datepicker",r=function(){function e(e,i,r,n,o){window.sfBlazor=window.sfBlazor,this.maskObj=new t,this.componentName="DatePicker",this.dataId=e,this.containerElement=i,this.element=r,this.options=o,window.sfBlazor.setCompInstance(this),this.dotNetRef=n,this.maskObj.element=this.element,this.enableMask=this.options.enableMask,this.enableMask&&(this.maskObj.dateformat=this.options.format,this.maskObj.isRendered=this.options.isRendered,this.maskObj.componentName=this.componentName,this.maskObj.offset=this.options.offset,this.maskObj.floatLabelType=this.options.floatLabelType,this.maskObj.maskPlaceholderDictionary=this.options.maskPlaceholderDictionary,this.maskObj.dayAbbreviatedName=this.options.dayAbbreviatedName,this.maskObj.dayName=this.options.dayName,this.maskObj.dayPeriod=this.options.dayPeriod,this.maskObj.monthAbbreviatedName=this.options.monthAbbreviatedName,this.maskObj.monthName=this.options.monthName,this.maskObj.maskDateValue=sf.base.isNullOrUndefined(this.options.value)?new Date:new Date(this.options.value.toString()),this.maskObj.maskDateValue.setMonth(0),this.maskObj.maskDateValue.setHours(0),this.maskObj.maskDateValue.setMinutes(0),this.maskObj.maskDateValue.setSeconds(0),this.maskObj.previousDate=new Date(this.maskObj.maskDateValue.getFullYear(),this.maskObj.maskDateValue.getMonth(),this.maskObj.maskDateValue.getDate(),this.maskObj.maskDateValue.getHours(),this.maskObj.maskDateValue.getMinutes(),this.maskObj.maskDateValue.getSeconds()),this.removeEventListener(),this.addEventListener())}return e.prototype.initialize=function(){this.defaultKeyConfigs={altUpArrow:"alt+uparrow",altDownArrow:"alt+downarrow",escape:"escape",enter:"enter",controlUp:"ctrl+38",controlDown:"ctrl+40",moveDown:"downarrow",moveUp:"uparrow",moveLeft:"leftarrow",moveRight:"rightarrow",select:"enter",home:"home",end:"end",pageUp:"pageup",pageDown:"pagedown",shiftPageUp:"shift+pageup",shiftPageDown:"shift+pagedown",controlHome:"ctrl+home",controlEnd:"ctrl+end",shiftTab:"shift+tab",tab:"tab"},this.defaultKeyConfigs=sf.base.extend(this.defaultKeyConfigs,this.options.keyConfigs),new sf.base.KeyboardEvents(this.element,{eventName:"keydown",keyAction:this.inputKeyActionHandle.bind(this),keyConfigs:this.defaultKeyConfigs}),this.index=this.options.showClearButton?2:1,sf.base.EventHandler.add(this.element,"blur",this.inputBlurHandler,this)},e.prototype.bindInputEvent=function(){this.enableMask?sf.base.EventHandler.add(this.element,"input",this.inputHandler,this):sf.base.EventHandler.remove(this.element,"input",this.inputHandler)},e.prototype.addEventListener=function(){sf.base.EventHandler.add(this.element,"mouseup",this.mouseUpHandler,this),sf.base.EventHandler.add(this.element,"keydown",this.keydownHandler,this),this.bindInputEvent()},e.prototype.removeEventListener=function(){sf.base.EventHandler.remove(this.element,"mouseup",this.mouseUpHandler),sf.base.EventHandler.remove(this.element,"keydown",this.keydownHandler)},e.prototype.mouseUpHandler=function(e){this.enableMask&&(this.maskObj.element=this.element,e.preventDefault(),this.maskObj.validCharacterCheck())},e.prototype.inputHandler=function(){this.enableMask&&(this.maskObj.element=this.element,this.maskObj.maskInputHandler())},e.prototype.keydownHandler=function(e){this.enableMask&&(this.maskObj.element=this.element,this.maskObj.keydownHandler(e))},e.prototype.inputKeyActionHandle=function(e){var t,i=this.element;if(this.popupObj&&this.popupObj.element.classList.contains("e-popup")&&this.options.isDatePopup){var r=this.tableBodyElement.querySelector("tr td.e-focused-date"),n=this.tableBodyElement.querySelector("tr td.e-selected");this.tableBodyElement.focus(),t={Action:e.action,Key:e.key,Events:e,SelectDate:n?n.id:null,FocusedDate:r?r.id:null,classList:n?n.classList.toString():r?r.classList.toString():"e-cell",Id:r?r.id:n?n.id:null,TargetClassList:this.calendarElement.classList.toString()}}else t={Action:e.action,Key:e.key,Events:e};this.options.isDatePopup&&this.maskObj.isPopupOpen&&"Enter"==e.key&&(i.value=null),this.isDisposed||this.dotNetRef.invokeMethodAsync("InputKeyActionHandle",t,i.value),"select"!==e.action&&this.popupObj&&document.body.contains(this.popupObj.element)&&e.preventDefault()},e.prototype.inputBlurHandler=function(e){this.isCalendar()&&document.activeElement===this.element&&this.dotNetRef.invokeMethodAsync("HidePopup",e)},e.prototype.renderPopup=function(e,t,i,r){if(this.options=r,this.maskObj.isPopupOpen=!0,this.popupHolder=t,e){var n=document.getElementById(e.id);n&&sf.base.remove(n)}this.createCalendar(e,r),sf.base.Browser.isDevice&&(this.mobilePopupContainer=sf.base.createElement("div",{className:"e-datepick-mob-popup-wrap"}),document.body.appendChild(this.mobilePopupContainer)),("model"===i.appendTo&&this.mobilePopupContainer?this.mobilePopupContainer:document.body).appendChild(this.popupContainer),this.popupObj.refreshPosition(this.element),r.isDatePopup||this.setScrollPosition();var o={name:"FadeIn",duration:sf.base.Browser.isDevice?0:300};1e3===this.options.zIndex?this.popupObj.show(new sf.base.Animation(o),this.element):this.popupObj.show(new sf.base.Animation(o),null),this.setOverlayIndex(this.mobilePopupContainer,this.popupObj.element,this.modal,sf.base.Browser.isDevice),sf.base.EventHandler.add(document,"mousedown touchstart",this.documentHandler,this)},e.prototype.setOverlayIndex=function(e,t,i,r){if(r&&!sf.base.isNullOrUndefined(t)&&!sf.base.isNullOrUndefined(i)&&!sf.base.isNullOrUndefined(e)){var n=parseInt(t.style.zIndex,10)?parseInt(t.style.zIndex,10):1e3;i.style.zIndex=(n-1).toString(),e.style.zIndex=n.toString()}},e.prototype.closePopup=function(e,t){this.options=t,this.maskObj.isPopupOpen=!1,this.closeEventCallback(e)},e.prototype.CalendarScrollHandler=function(e){var t="Up"===e.scrollDirection||"Down"===e.scrollDirection;this.isTouchstart&&t&&(this.dotNetRef.invokeMethodAsync("ScrollToNextSection","Up"==e.scrollDirection),this.isTouchstart=!1)},e.prototype.TouchStartHandler=function(e){this.isTouchstart=!0},e.prototype.createCalendar=function(e,t){var r=this;this.popupContainer=e,this.calendarElement=this.popupContainer.firstElementChild,this.tableBodyElement=sf.base.select("tbody",this.calendarElement);var n=i+" e-date-modal",o="e-date-overflow";t.isDatePopup?this.calendarElement.querySelector("table tbody").className="":(n="e-datetimepicker e-time-modal",o="e-time-overflow"),sf.base.Browser.isDevice&&(this.modal=sf.base.createElement("div"),this.modal.className=n,document.body.classList.add(o),this.modal.style.display="block",document.body.appendChild(this.modal)),this.popupObj=new sf.popups.Popup(this.popupContainer,{width:t.isDatePopup?"auto":this.setPopupWidth(this.options.width),relateTo:sf.base.Browser.isDevice?document.body:this.containerElement,position:sf.base.Browser.isDevice?{X:"center",Y:"center"}:{X:"left",Y:"bottom"},offsetY:4,targetType:"container",enableRtl:t.enableRtl,zIndex:t.zIndex,collision:sf.base.Browser.isDevice?{X:"fit",Y:"fit"}:{X:"flip",Y:"flip"},open:function(){sf.base.Browser.isDevice&&(r.touchModule=new sf.base.Touch(r.calendarElement.children[1].querySelector(".e-content.e-month"),{scroll:r.CalendarScrollHandler.bind(r)}),sf.base.EventHandler.add(r.calendarElement.children[1].querySelector(".e-content.e-month"),"touchstart",r.TouchStartHandler,r)),document.activeElement!==r.element&&t.isDatePopup&&(r.defaultKeyConfigs=sf.base.extend(r.defaultKeyConfigs,t.keyConfigs),r.calendarElement.children[1].firstElementChild.focus(),new sf.base.KeyboardEvents(r.calendarElement.children[1].firstElementChild,{eventName:"keydown",keyAction:r.CalendarKeyActionHandle.bind(r),keyConfigs:r.defaultKeyConfigs}),new sf.base.KeyboardEvents(r.containerElement.children[r.index],{eventName:"keydown",keyAction:r.CalendarKeyActionHandle.bind(r),keyConfigs:r.defaultKeyConfigs}))},close:function(){r.popupHolder.appendChild(r.popupContainer),r.popupObj&&r.popupObj.destroy(),r.isDisposed||r.dotNetRef.invokeMethodAsync("ClosePopup").catch((function(){})),r.popupObj=null},targetExitViewport:function(){sf.base.Browser.isDevice||r.isDisposed||r.dotNetRef.invokeMethodAsync("HidePopup",null)}}),t.isDatePopup||(this.popupObj.element.style.maxHeight="240px")},e.prototype.getPopupHeight=function(){var e=parseInt("240px",10),t=this.popupContainer.getBoundingClientRect().height;return t>e?e:t},e.prototype.setScrollPosition=function(){if((this.popupContainer&&this.popupContainer.querySelector(".e-navigation")||this.popupContainer.querySelector(".e-active"))&&!this.options.isDatePopup){var e=this.popupContainer.querySelector(".e-navigation")||this.popupContainer.querySelector(".e-active");this.findScrollTop(e)}},e.prototype.findScrollTop=function(e){var t=this.getPopupHeight(),i=e.nextElementSibling,r=i?i.offsetTop:e.offsetTop,n=e.getBoundingClientRect().height;r+e.offsetTop>t?this.popupContainer.scrollTop=i?r-(t/2+n/2):r:this.popupContainer.scrollTop=0},e.prototype.closeEventCallback=function(e){var t=e;this.isCalendar()&&!t.cancel&&this.popupObj&&this.popupObj.hide(),sf.base.Browser.isDevice&&this.modal&&(this.modal.style.display="none",this.modal.outerHTML="",this.modal=null),sf.base.Browser.isDevice&&(sf.base.removeClass([document.body],"e-date-overflow"),sf.base.removeClass([document.body],"e-time-overflow"),sf.base.isNullOrUndefined(this.mobilePopupContainer)||(this.mobilePopupContainer.remove(),this.mobilePopupContainer=null)),sf.base.EventHandler.remove(document,"mousedown touchstart",this.documentHandler),sf.base.Browser.isDevice&&this.options.allowEdit&&!this.options.readonly&&this.element.removeAttribute("readonly")},e.prototype.documentHandler=function(e){!sf.base.isNullOrUndefined(this.popupObj)&&(this.containerElement.contains(e.target)||this.popupObj.element&&this.popupObj.element.contains(e.target))&&"touchstart"!==e.type&&e.preventDefault();var t=this.containerElement.querySelector(".e-clear-icon"),r=this.tableBodyElement?this.tableBodyElement.querySelector(".e-selected"):null,n=this.options.value?this.options.value.toString():null,o=e.target;o==t&&r&&sf.base.removeClass([this.tableBodyElement.querySelector(".e-selected")],"e-selected"),sf.base.closest(o,"."+i+".e-popup-wrapper")||sf.base.closest(o,".e-datetimepicker.e-popup-wrapper")||sf.base.closest(o,".e-input-group")===this.containerElement||o.classList.contains("e-day")||this.isDisposed?sf.base.closest(o,"."+i+".e-popup-wrapper")&&(o.classList.contains("e-day")&&!sf.base.isNullOrUndefined(e.target.parentElement)&&e.target.parentElement.classList.contains("e-selected")&&sf.base.closest(o,".e-content")&&sf.base.closest(o,".e-content").classList.contains("e-"+this.options.depth.toLowerCase())&&!this.isDisposed||sf.base.closest(o,".e-footer-container")&&o.classList.contains("e-today")&&o.classList.contains("e-btn")&&+new Date(n)==+this.generateTodayVal(new Date(n))&&!this.isDisposed)&&this.dotNetRef.invokeMethodAsync("HidePopup",e):(this.dotNetRef.invokeMethodAsync("HidePopup",e),this.element.focus())},e.prototype.generateTodayVal=function(e){var t=new Date;return e?(t.setHours(e.getHours()),t.setMinutes(e.getMinutes()),t.setSeconds(e.getSeconds()),t.setMilliseconds(e.getMilliseconds())):t=new Date(t.getFullYear(),t.getMonth(),t.getDate(),0,0,0,0),t},e.prototype.isCalendar=function(){return this.popupContainer&&this.popupContainer.classList.contains("e-popup-wrapper")},e.prototype.CalendarKeyActionHandle=function(e){switch(e.action){case this.defaultKeyConfigs.escape:this.isCalendar()?this.dotNetRef.invokeMethodAsync("HidePopup",e):this.element.blur();break;case this.defaultKeyConfigs.enter:this.isCalendar()||this.dotNetRef.invokeMethodAsync("ShowPopup",e);break;case this.defaultKeyConfigs.tab:this.dotNetRef.invokeMethodAsync("HidePopup",e)}},e.prototype.setWidth=function(e){return e="number"==typeof e?sf.base.formatUnit(e):"string"==typeof e?e.match(/px|%|em/)?e:sf.base.formatUnit(e):"100%"},e.prototype.setPopupWidth=function(e){(e=this.setWidth(e)).indexOf("%")>-1&&(e=(this.containerElement.getBoundingClientRect().width*parseFloat(e)/100).toString()+"px");return e},e.prototype.updateAriaActiveDescendant=function(e){this.element.setAttribute("aria-activedescendant",e)},e}();return{initialize:function(e,t,i,n,o){if(i&&e){var s=new r(e,t,i,n,o);if(s.initialize(),o.enableMask)return s.maskObj.createMask(o)}return{currentMaskFormat:null,inputElementValue:o.value}},createMask:function(e,t){return e&&t.enableMask?window.sfBlazor.getCompInstance(e).maskObj.createMask(t):{currentMaskFormat:null,inputElementValue:t.value}},updateCurrentValue:function(e,t){window.sfBlazor.getCompInstance(e).maskObj.updateCurrentValue(t)},renderPopup:function(e,t,i,r,n){var o=window.sfBlazor.getCompInstance(e);!sf.base.isNullOrUndefined(o)&&t&&i&&o.renderPopup(t,i,r,n)},updateScrollPosition:function(e){var t=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(t)||t.setScrollPosition()},closePopup:function(e,t,i){var r=window.sfBlazor.getCompInstance(e);!sf.base.isNullOrUndefined(r)&&t&&r.closePopup(t,i)},focusIn:function(e){var t=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(t)||t.element.focus()},updateAriaActiveDescendant:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||i.updateAriaActiveDescendant(t)},focusOut:function(e){var t=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(t)||t.element.blur()},destroy:function(e,t,i,r,n){var o=window.sfBlazor.getCompInstance(e);!sf.base.isNullOrUndefined(o)&&t&&t instanceof HTMLElement&&i&&(o.isDisposed=!0,o.closePopup(r,n))}}}()},"./modules/sf-dialog.js":function(e,t){window.sfBlazor=window.sfBlazor||{},window.sfBlazor.Dialog=function(){"use strict";var e="e-dlg-target",t=function(){function t(e){this.popupObj=null,this.zIndex=1e3,this.height="auto",this.width="100%",this.resizeIconDirection="SouthEast",this.visible=!0,this.isModal=!1,this.enableRtl=!1,this.enableResize=!1,this.closeOnEscape=!0,this.allowDragging=!1,this.allowMaxHeight=!0,this.allowPrerender=!1,this.hasFocusableNode=!1,this.openedEnabled=!1,this.closedEnabled=!1,this.onDragEnabled=!1,this.onDragStartEnabled=!1,this.onDragStopEnabled=!1,this.resizingEnabled=!1,this.onResizeStartEnabled=!1,this.onResizeStopEnabled=!1,this.isOpenFullScreen=!1,this.dlgContainer=void 0,this.animationSettings={delay:0,duration:400,effect:"Fade"},this.position={X:"center",Y:"center"},window.sfBlazor=window.sfBlazor,this.updateContext(e),this.isInitialLoad=e.isInitial,window.sfBlazor.setCompInstance(this),this.initialize()}return t.prototype.updateContext=function(e){sf.base.extend(this,this,e)},t.prototype.initialize=function(){this.calculatezIndex=1e3===this.zIndex,this.render(),this.element.classList.remove("e-blazor-hidden"),this.setWidth(),this.setMinHeight(),this.enableResize&&(this.setResize(!0),("None"===this.animationSettings.effect&&"Enable"!==sf.base.animationMode||"Disable"===sf.base.animationMode)&&this.getMinHeight()),this.bindEvent(this.element)},t.prototype.setWidth=function(){"100%"===this.width?this.element.style.width="":(sf.base.setStyleAttribute(this.element,{width:sf.base.formatUnit(this.width)}),"auto"===this.width&&this.refreshPosition())},t.prototype.setHeight=function(){sf.base.setStyleAttribute(this.element,{height:sf.base.formatUnit(this.height)})},t.prototype.setMinHeight=function(){""!==this.minHeight&&sf.base.setStyleAttribute(this.element,{minHeight:sf.base.formatUnit(this.minHeight)})},t.prototype.render=function(){var e=this;if(this.checkPositionData(),this.targetEle=this.getTargetEle(this.target),sf.base.Browser.isDevice&&sf.base.addClass([this.element],"e-device"),sf.base.isNullOrUndefined(this.headerContent)&&(this.headerContent=this.element.querySelector(".e-dlg-header-content")),sf.base.isNullOrUndefined(this.contentEle)&&(this.contentEle=this.element.querySelector(".e-dlg-content")),this.setMaxHeight(),1e3===this.zIndex&&this.setzIndex(this.element,!1),this.allowDragging&&!sf.base.isNullOrUndefined(this.headerContent)&&this.setAllowDragging(),this.isModal&&sf.base.isNullOrUndefined(this.dlgContainer)&&(this.dlgContainer=this.element.parentElement,this.dlgOverlay=this.element.parentElement.getElementsByClassName("e-dlg-overlay")[0]),!sf.base.isNullOrUndefined(this.element.parentElement)&&(this.allowPrerender||!this.allowPrerender&&(!this.isInitialLoad||this.visible&&this.isInitialLoad))){var t=this.isModal?this.dlgContainer.parentElement:this.element.parentElement;this.refElement=sf.base.createElement("div",{className:"e-dlg-ref-element"}),t.insertBefore(this.refElement,this.isModal?this.dlgContainer:this.element)}sf.base.isNullOrUndefined(this.targetEle)||(this.isModal?this.targetEle.appendChild(this.dlgContainer):this.targetEle.appendChild(this.element)),this.popupObj=new sf.popups.Popup(this.element,{height:this.height,width:this.width,zIndex:this.zIndex,relateTo:this.targetEle,actionOnScroll:"none",enableRtl:this.enableRtl,position:{X:this.position.X,Y:this.position.Y},open:function(){e.enableResize&&e.resetResizeIcon(),e.openedEnabled?e.dotNetRef.invokeMethodAsync("OpenEvent",e.element.classList.toString()):e.focusContent()},close:function(){e.isModal&&(sf.base.addClass([e.dlgOverlay],"e-fade"),e.dlgContainer.style.display="none"),e.hasFocusableNode=!1,e.closedEnabled?e.dotNetRef.invokeMethodAsync("CloseEvent",e.element.classList.toString()):e.popupCloseHandler()}}),this.isModal&&this.positionChange()},t.prototype.checkPositionData=function(){sf.base.isNullOrUndefined(this.position)||(this.isNumberString(this.position.X)&&(this.position.X=parseFloat(this.position.X)),this.isNumberString(this.position.Y)&&(this.position.Y=parseFloat(this.position.Y)))},t.prototype.isNumberString=function(e){return!sf.base.isNullOrUndefined(e)&&"number"!=typeof e&&/^[-+]?\d*\.?\d+$/.test(e)},t.prototype.getTargetEle=function(e){var t;return sf.base.isNullOrUndefined(e)||"string"!=typeof e||(t=document.querySelector(e)),sf.base.isNullOrUndefined(t)?document.body:t},t.prototype.setMaxHeight=function(){if(this.allowMaxHeight){var e=this.element.style.display;this.element.style.display="none",this.element.style.maxHeight=!sf.base.isNullOrUndefined(this.target)&&this.targetEle.offsetHeight<window.innerHeight?this.targetEle.offsetHeight-20+"px":window.innerHeight-20+"px",this.element.style.display=e,sf.base.Browser.isIE&&"auto"===this.height&&!sf.base.isNullOrUndefined(this.contentEle)&&this.element.offsetHeight<this.contentEle.offsetHeight&&(this.element.style.height="inherit")}},t.prototype.setzIndex=function(e,t){this.zIndex=sf.popups.getZindexPartial(e),t&&(this.popupObj.zIndex=this.zIndex)},t.prototype.updatezIndex=function(){this.popupObj.zIndex=this.zIndex,this.isModal&&this.setOverlayZindex(this.zIndex),this.calculatezIndex=this.element.style.zIndex===this.zIndex.toString()},t.prototype.updateTarget=function(){this.targetEle=this.getTargetEle(this.target),this.popupObj.relateTo=this.targetEle,this.dragObj&&(this.dragObj.dragArea=this.targetEle),this.setMaxHeight(),this.isModal&&this.targetEle.appendChild(this.dlgContainer),this.enableResize&&this.setResize(!1)},t.prototype.resetResizeIcon=function(){var e=this.getMinHeight();if(this.targetEle.offsetHeight<e){var t=this.element.querySelector("."+this.resizeIconDirection);sf.base.isNullOrUndefined(t)||(t.style.bottom="-"+e.toString()+"px")}},t.prototype.getMouseEvtArgs=function(e){return{altKey:e.altKey,button:e.button,buttons:e.buttons,clientX:e.clientX,clientY:e.clientY,ctrlKey:e.ctrlKey,detail:e.detail,metaKey:e.metaKey,screenX:e.screenX,screenY:e.screenY,shiftKey:e.shiftKey,type:e.type}},t.prototype.setAllowDragging=function(){var e=this,t=this;this.dragObj=new sf.base.Draggable(this.element,{clone:!1,isDragScroll:!0,abort:".e-dlg-closeicon-btn",handle:".e-dlg-header-content",dragStart:function(i){e.onDragStartEnabled&&t.dotNetRef.invokeMethodAsync("DragStartEvent",{target:{ID:i.target.id},event:t.getMouseEvtArgs(i.event)}),i.bindEvents(i.dragElement)},drag:function(i){e.onDragEnabled&&t.dotNetRef.invokeMethodAsync("DragEvent",{target:{ID:i.target.id},event:t.getMouseEvtArgs(i.event)})},dragStop:function(i){t.isModal&&(sf.base.isNullOrUndefined(t.position)||t.dlgContainer.classList.remove("e-dlg-"+t.position.X+"-"+t.position.Y),t.element.style.position="relative"),e.onDragStopEnabled&&t.dotNetRef.invokeMethodAsync("DragStopEvent",{target:{ID:i.target.id},event:t.getMouseEvtArgs(i.event)}),t.element.classList.remove("e-restrict-left")}}),sf.base.isNullOrUndefined(this.targetEle)||(this.dragObj.dragArea=this.targetEle)},t.prototype.positionChange=function(){this.isModal&&(isNaN(parseFloat(this.position.X))||isNaN(parseFloat(this.position.Y)))?!isNaN(parseFloat(this.position.X))&&isNaN(parseFloat(this.position.Y))||isNaN(parseFloat(this.position.X))&&!isNaN(parseFloat(this.position.Y))?this.setPopupPosition():(this.element.style.top="0px",this.element.style.left="0px",this.dlgContainer.classList.add("e-dlg-"+this.position.X+"-"+this.position.Y)):this.setPopupPosition()},t.prototype.setPopupPosition=function(){this.popupObj.setProperties({position:{X:this.position.X,Y:this.position.Y}})},t.prototype.setEnableRTL=function(){var e=this.element.querySelector(".e-resize-handle");sf.base.isNullOrUndefined(e)||e.parentElement!==this.element||(sf.popups.removeResize(),this.setResize(!1))},t.prototype.setResize=function(e){if(this.enableResize){if(!sf.base.isNullOrUndefined(this.element.querySelector(".e-icons.e-resize-handle")))return;var t=getComputedStyle(this.element).minHeight,i=getComputedStyle(this.element).minWidth;this.isModal&&this.enableRtl?this.element.classList.add("e-restrict-left"):!this.isModal||this.target!==document.body&&"body"!==this.target||this.element.classList.add("e-resize-viewport"),sf.popups.createResize({element:this.element,direction:this.resizeIconDirection,minHeight:parseInt(t.slice(0,i.indexOf("p")),10),maxHeight:this.targetEle.clientHeight,minWidth:parseInt(i.slice(0,i.indexOf("p")),10),maxWidth:this.targetEle.clientWidth,boundary:"body"===this.target||"document.body"===this.target?null:this.targetEle,resizeBegin:this.onResizeStart.bind(this),resizeComplete:this.onResizeComplete.bind(this),resizing:this.onResizing.bind(this),proxy:this}),this.wireWindowResizeEvent()}else{if(e)return;sf.popups.removeResize(),this.unWireWindowResizeEvent(),this.isModal?this.element.classList.remove("e-restrict-left"):this.element.classList.remove("e-resize-viewport")}},t.prototype.getMinHeight=function(){var e="0px",t="0px";sf.base.isNullOrUndefined(this.element.querySelector(".e-dlg-header-content"))||(e=getComputedStyle(this.headerContent).height);var i=sf.base.select(".e-footer-content",this.element);sf.base.isNullOrUndefined(i)||(t=getComputedStyle(i).height);var r=parseInt(e.slice(0,e.indexOf("p")),10),n=parseInt(t.slice(0,t.indexOf("p")),10);return sf.popups.setMinHeight(r+30+(isNaN(n)?0:n)),r+30+n},t.prototype.changePosition=function(e){this.isModal&&this.dlgContainer.classList.contains("e-dlg-"+this.position.X+"-"+this.position.Y)&&this.dlgContainer.classList.remove("e-dlg-"+this.position.X+"-"+this.position.Y),this.updateContext(e),this.checkPositionData(),this.positionChange()},t.prototype.setOverlayZindex=function(e){var t;t=sf.base.isNullOrUndefined(e)?parseInt(this.element.style.zIndex,10)?parseInt(this.element.style.zIndex,10):this.zIndex:e,this.dlgOverlay.style.zIndex=(t-1).toString(),this.dlgContainer.style.zIndex=t.toString()},t.prototype.focusContent=function(){var e=this.getAutoFocusNode(this.element);(sf.base.isNullOrUndefined(e)?this.element:e).focus(),this.hasFocusableNode=!0},t.prototype.getAutoFocusNode=function(e){var t=e.querySelector(".e-dlg-closeicon-btn"),i=e.querySelectorAll("[autofocus]"),r=this.getValidFocusNode(i);if(this.primaryButtonEle=this.element.getElementsByClassName("e-primary")[0],sf.base.isNullOrUndefined(r)){if(r=this.focusableElements(this.contentEle),!sf.base.isNullOrUndefined(r))return r;if(!sf.base.isNullOrUndefined(this.primaryButtonEle))return this.element.querySelector(".e-primary")}else t=r;return t},t.prototype.getValidFocusNode=function(e){for(var t,i=0;i<e.length;i++){if(((t=e[i]).clientHeight>0||"a"===t.tagName.toLowerCase()&&t.hasAttribute("href"))&&t.tabIndex>-1&&!t.disabled&&!this.disableElement(t,'[disabled],[aria-disabled="true"],[type="hidden"]'))return t;t=null}return t},t.prototype.disableElement=function(e,t){var i=e?e.matches||e.webkitMatchesSelector||e.msGetRegionContent:null;if(i)for(;e;e=e.parentNode)if(e instanceof Element&&i.call(e,t))return e;return null},t.prototype.focusableElements=function(e){if(!sf.base.isNullOrUndefined(e)){var t=e.querySelectorAll('input,select,textarea,button,a,[contenteditable="true"],[tabindex]');return this.getValidFocusNode(t)}return null},t.prototype.getMaxHeight=function(){return this.element.style.maxHeight},t.prototype.OnPropertyChanged=function(e){this.updateContext(e);for(var t=0,i=Object.keys(e);t<i.length;t++){switch(i[t]){case"width":sf.base.setStyleAttribute(this.element,{width:sf.base.formatUnit(this.width)}),this.refreshPosition();break;case"height":this.setHeight(),this.refreshPosition();break;case"minHeight":this.setMinHeight();break;case"target":this.updateTarget();break;case"zIndex":this.updatezIndex();break;case"allowDragging":this.allowDragging?this.setAllowDragging():this.destroyDraggable();break;case"enableRtl":this.setEnableRTL();break;case"enableResize":this.setResize(!1)}}},t.prototype.fullScreen=function(t){if(t){sf.base.addClass([this.element],"e-dlg-fullscreen"),this.element.style.top=document.scrollingElement.scrollTop+"px";var i=this.element.style.display;this.element.style.display="none",this.element.style.maxHeight=sf.base.isNullOrUndefined(this.target)?window.innerHeight+"px":this.targetEle.offsetHeight+"px",this.element.style.display=i,sf.base.addClass([document.body],[e,"e-scroll-disabled"]),this.allowDragging&&!sf.base.isNullOrUndefined(this.dragObj)&&(this.dragObj.destroy(),this.dragObj=void 0)}else sf.base.removeClass([this.element],"e-dlg-fullscreen"),sf.base.removeClass([document.body],[e,"e-scroll-disabled"]),this.allowDragging&&!sf.base.isNullOrUndefined(this.headerContent)&&sf.base.isNullOrUndefined(this.dragObj)&&this.setAllowDragging()},t.prototype.show=function(t,i){if(this.isOpenFullScreen=t,!this.element.classList.contains("e-popup-open")||!sf.base.isNullOrUndefined(t)){sf.base.isNullOrUndefined(t)||this.fullScreen(t),this.element.style.maxHeight!==i&&(this.allowMaxHeight=!1,this.element.style.maxHeight=i),this.storeActiveElement=document.activeElement,this.element.tabIndex=-1,this.isModal&&sf.base.isNullOrUndefined(this.dlgOverlay)&&(this.dlgOverlay=this.element.parentElement.querySelector(".e-dlg-overlay")),this.isModal&&!sf.base.isNullOrUndefined(this.dlgOverlay)&&(this.dlgOverlay.style.display="block",this.dlgContainer.style.display="flex",sf.base.removeClass([this.dlgOverlay],"e-fade"),sf.base.isNullOrUndefined(this.targetEle)?sf.base.addClass([document.body],[e,"e-scroll-disabled"]):(this.targetEle===document.body?this.dlgContainer.style.position="fixed":this.dlgContainer.style.position="absolute",this.dlgOverlay.style.position="absolute",this.element.style.position="relative",sf.base.addClass([this.targetEle],[e,"e-scroll-disabled"])));var r={name:"None"===this.animationSettings.effect&&"Enable"===sf.base.animationMode?"Fade":this.animationSettings.effect+"In",duration:this.animationSettings.duration,delay:this.animationSettings.delay},n=this.isModal?this.element.parentElement:this.element;this.calculatezIndex&&(this.setzIndex(n,!0),sf.base.setStyleAttribute(this.element,{zIndex:this.zIndex}),this.isModal&&this.setOverlayZindex(this.zIndex)),"None"===this.animationSettings.effect&&"Enable"!==sf.base.animationMode||"Disable"===sf.base.animationMode?this.popupObj.show():this.popupObj.show(r)}},t.prototype.hide=function(){(this.isModal||this.isOpenFullScreen)&&(sf.base.isNullOrUndefined(this.targetEle)?sf.base.removeClass([document.body],[e,"e-scroll-disabled"]):sf.base.removeClass([this.targetEle],[e,"e-scroll-disabled"]));var t={name:"None"===this.animationSettings.effect&&"Enable"===sf.base.animationMode?"Fade":this.animationSettings.effect+"Out",duration:this.animationSettings.duration,delay:this.animationSettings.delay};return"None"===this.animationSettings.effect&&"Enable"!==sf.base.animationMode||"Disable"===sf.base.animationMode?this.popupObj.hide():this.popupObj.hide(t),this.allowPrerender||this.destroyRefElement(),this.element.classList.toString()},t.prototype.refreshPosition=function(){this.isModal&&isNaN(parseFloat(this.position.X))&&isNaN(parseFloat(this.position.Y))?(this.element.style.top=this.element.style.left="0px",this.dlgContainer.classList.add("e-dlg-"+this.position.X+"-"+this.position.Y)):this.popupObj.refreshPosition()},t.prototype.getDimension=function(){return{width:this.element.offsetWidth,height:this.element.offsetHeight}},t.prototype.destroyDraggable=function(){sf.base.isNullOrUndefined(this.dragObj)||(this.dragObj.destroy(),this.dragObj=void 0)},t.prototype.destroyRefElement=function(){sf.base.isNullOrUndefined(this.refElement)||sf.base.isNullOrUndefined(this.refElement.parentElement)||(this.refElement.parentElement.insertBefore(this.isModal?this.dlgContainer:this.element,this.refElement),sf.base.detach(this.refElement),this.refElement=void 0)},t.prototype.destroy=function(t,i){this.updateContext(t);var r=["role","aria-modal","aria-labelledby","aria-describedby","aria-grabbed","tabindex","style"];if(!sf.base.isNullOrUndefined(this.cssClass)&&""!==this.cssClass){var n=this.cssClass.split(" ");sf.base.removeClass([this.element],n)}if(sf.base.Browser.isDevice&&sf.base.removeClass([this.element],"e-device"),sf.base.removeClass([this.getTargetEle(this.target)],[e,"e-scroll-disabled"]),this.unBindEvent(this.element),this.element.classList.contains("e-dlg-fullscreen")&&sf.base.removeClass([document.body],[e,"e-scroll-disabled"]),this.isModal&&sf.base.removeClass([sf.base.isNullOrUndefined(this.targetEle)?document.body:this.targetEle],"e-scroll-disabled"),this.element.classList.contains("e-dlg-resizable")&&this.element.classList.remove("e-dlg-resizable"),this.element.classList.contains("e-draggable")&&(this.dragObj.destroy(),this.dragObj=void 0),this.element.classList.contains("e-popup")&&(this.popupObj.destroy(),this.popupObj=void 0),this.destroyRefElement(),i)for(var o=0;o<this.element.children.length;o++)this.element.children[o].classList.add("e-hide");else if(!sf.base.isNullOrUndefined(this.element.children))for(o=0;o<=this.element.children.length;o++)o-=o,sf.base.detach(this.element.children[o]);for(o=0;o<r.length;o++)this.element.removeAttribute(r[o]);if(this.isModal){sf.base.detach(this.element.nextElementSibling);var s=this.element.parentElement;s.removeAttribute("class"),s.removeAttribute("style"),this.element.classList.remove("e-dlg-modal")}this.element.classList.remove("e-dialog")},t.prototype.bindEvent=function(e){sf.base.EventHandler.add(e,"keydown",this.keyDown,this),sf.base.Browser.isDevice&&sf.base.EventHandler.add(window,"orientationchange",this.orientationOnChange,this)},t.prototype.unBindEvent=function(e){sf.base.EventHandler.remove(e,"keydown",this.keyDown),sf.base.Browser.isDevice&&sf.base.EventHandler.remove(window,"orientationchange",this.orientationOnChange)},t.prototype.wireWindowResizeEvent=function(){window.addEventListener("resize",this.windowResizeHandler.bind(this))},t.prototype.unWireWindowResizeEvent=function(){window.removeEventListener("resize",this.windowResizeHandler.bind(this))},t.prototype.orientationOnChange=function(){var e=this;this.element.style.display="none",setTimeout((function(){sf.popups.setMaxWidth(e.targetEle.clientWidth),sf.popups.setMaxHeight(e.targetEle.clientHeight),e.setMaxHeight(),e.refreshPosition(),e.element.style.display=""}),250)},t.prototype.popupCloseHandler=function(){var e=document.activeElement;sf.base.isNullOrUndefined(e)||sf.base.isNullOrUndefined(e.blur)||e.blur(),sf.base.isNullOrUndefined(this.storeActiveElement)||sf.base.isNullOrUndefined(this.storeActiveElement.focus)||this.storeActiveElement.focus()},t.prototype.windowResizeHandler=function(){sf.popups.setMaxWidth(this.targetEle.clientWidth),sf.popups.setMaxHeight(this.targetEle.clientHeight),this.setMaxHeight()},t.prototype.onResizeStart=function(e,t){var i=this.getMouseEvtArgs(e);this.onResizeStartEnabled&&this.dotNetRef.invokeMethodAsync("ResizeStartEvent",i)},t.prototype.onResizing=function(e,t){this.resizingEnabled&&this.dotNetRef.invokeMethodAsync("ResizingEvent",this.getMouseEvtArgs(e))},t.prototype.onResizeComplete=function(e,t){this.onResizeStopEnabled&&this.dotNetRef.invokeMethodAsync("ResizeStopEvent",this.getMouseEvtArgs(e))},t.prototype.getFocusElement=function(e){var t=e.querySelectorAll('input,select,textarea,button:enabled,a,[contenteditable="true"],[tabindex]');return t[t.length-1]},t.prototype.keyDown=function(e){var t=this;if(9===e.keyCode&&this.isModal){var i=void 0,r=void 0,n=this.element.querySelector(".e-footer-content");sf.base.isNullOrUndefined(n)||(r=n.querySelectorAll("button"),!sf.base.isNullOrUndefined(i)&&r.length>0&&(i=r[r.length-1]),sf.base.isNullOrUndefined(i)&&n.childNodes.length>0&&(i=this.getFocusElement(n))),sf.base.isNullOrUndefined(n)&&!sf.base.isNullOrUndefined(this.contentEle)&&(i=this.getFocusElement(this.contentEle)),sf.base.isNullOrUndefined(i)||document.activeElement!==i||e.shiftKey||(e.preventDefault(),this.focusableElements(this.element).focus()),document.activeElement===this.focusableElements(this.element)&&e.shiftKey&&(e.preventDefault(),sf.base.isNullOrUndefined(i)||i.focus())}if(27===e.keyCode&&this.closeOnEscape&&(document.querySelector(".e-popup-open:not(.e-dialog)")||this.dotNetRef.invokeMethodAsync("CloseDialog",{altKey:e.altKey,ctrlKey:e.ctrlKey,code:e.code,key:e.key,location:e.location,repeat:e.repeat,shiftKey:e.shiftKey,metaKey:e.metaKey,type:e.type})),this.hasFocusableNode){var o=document.activeElement,s=["input","textarea"].indexOf(o.tagName.toLowerCase())>-1,a=!1;s||(a=o.hasAttribute("contenteditable")&&"true"===o.getAttribute("contenteditable")),(13===e.keyCode&&!e.ctrlKey&&"textarea"!==o.tagName.toLowerCase()&&s&&!sf.base.isNullOrUndefined(this.primaryButtonEle)||13===e.keyCode&&e.ctrlKey&&("textarea"===o.tagName.toLowerCase()||a)&&!sf.base.isNullOrUndefined(this.primaryButtonEle))&&setTimeout((function(){t.element.querySelector(".e-footer-content button.e-btn.e-primary").click()}))}},t}();return{initialize:function(e){e.dataId&&new t(e)},getClassList:function(e){return e&&e.classList.toString()},getMaxHeight:function(e){return e&&window.sfBlazor.getCompInstance(e).getMaxHeight()},changePosition:function(e){e.dataId&&window.sfBlazor.getCompInstance(e.dataId).changePosition(e)},updateAnimation:function(e){e.dataId&&window.sfBlazor.getCompInstance(e.dataId).updateContext(e)},focusContent:function(e){e&&window.sfBlazor.getCompInstance(e).focusContent()},refreshPosition:function(e){e&&window.sfBlazor.getCompInstance(e).refreshPosition()},getDimension:function(e){return e&&window.sfBlazor.getCompInstance(e).getDimension()},popupCloseHandler:function(e){e&&window.sfBlazor.getCompInstance(e).popupCloseHandler()},propertyChanged:function(e){e.dataId&&window.sfBlazor.getCompInstance(e.dataId).OnPropertyChanged(e)},show:function(e){e.dataId&&window.sfBlazor.getCompInstance(e.dataId).show(e.fullScreen,e.maxHeight)},hide:function(e){return e&&window.sfBlazor.getCompInstance(e).hide()},destroy:function(e){e.dataId&&window.sfBlazor.getCompInstance(e.dataId).destroy(e,e.isClient)}}}()},"./modules/sf-documenteditor.js":function(e,t){function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}window.sfBlazor=window.sfBlazor||{},window.sfBlazor.DocumentEditor=function(){"use strict";!function(){function e(e,t,i,r,n){this.isDestroyed=!1,window.sfBlazor=window.sfBlazor,this.previousContext="",this.showHeaderProperties=!0,this.element=t,sf.base.isNullOrUndefined(t)||(this.dotNetRef=n,this.element=t,this.dataId=e,window.sfBlazor.setCompInstance(this),this.options=i,this.editorOptions=r,this.updateOptions(i))}Object.defineProperty(e.prototype,"documentEditor",{get:function(){return this.documentEditorInternal},enumerable:!0,configurable:!0}),e.prototype.updateOptions=function(e){this.showPropertiesPane=e.showPropertiesPane,this.currentUser=e.currentUser,this.enableComment=e.enableComment,this.enableLocalPaste=e.enableLocalPaste,this.enableSpellCheck=e.enableSpellCheck,this.enableTrackChanges=e.enableTrackChanges,this.height=e.height,this.serviceUrl=e.serviceUrl,this.userColor=e.userColor,this.width=e.width,this.zIndex=e.zIndex,this.documentEditorSettings=e.documentEditorSettings,this.requiredModules()},e.prototype.setOptions=function(e,t){for(var i=0,r=Object.keys(e);i<r.length;i++){var n=r[i],o=e[n];if(!sf.base.isNullOrUndefined(o))switch(n){case"zoomFactor":this.documentEditor.zoomFactor=o,this.documentEditor.onPropertyChanged({zoomFactor:o},null);break;case"layoutType":this.documentEditor.layoutType=o,this.documentEditor.onPropertyChanged({layoutType:o},null);break;case"enableTrackChanges":this.enableTrackChanges=o,this.documentEditor.enableTrackChanges=o,this.documentEditor.showRevisions=o,this.documentEditor.onPropertyChanged({enableTrackChanges:o},null),this.documentEditor.onPropertyChanged({showRevisions:o},null);break;case"restrictEditing":this.restrictEditing=o,this.documentEditor.isReadOnly=o,this.documentEditor.onPropertyChanged({isReadOnly:o},null);break;case"enableLocalPaste":this.enableLocalPaste=o,this.documentEditor.enableLocalPaste=o,this.documentEditor.onPropertyChanged({enableLocalPaste:o},null);break;case"documentEditorSettings":this.documentEditorSettings=o,this.customizeDocumentEditorSettings()}}},e.prototype.getModuleName=function(){return"DocumentEditorContainer"},e.prototype.onPropertyChanged=function(e,t){for(var i=0,r=Object.keys(e);i<r.length;i++){switch(r[i]){case"restrictEditing":this.documentEditor.isReadOnly=e.restrictEditing,sf.base.isNullOrUndefined(this.documentEditor.trackChangesPane)||this.documentEditor.trackChangesPane.enableDisableButton(!e.restrictEditing&&!this.documentEditor.documentHelper.isDocumentProtected);break;case"showPropertiesPane":this.showHidePropertiesPane(e.showPropertiesPane);break;case"enableTrackChanges":this.documentEditor&&(this.documentEditor.enableTrackChanges=e.enableTrackChanges,this.documentEditor.showRevisions=e.enableTrackChanges,this.documentEditor.resize());break;case"enableLocalPaste":this.documentEditor&&(this.documentEditor.enableLocalPaste=e.enableLocalPaste);break;case"serviceUrl":this.documentEditor&&(this.documentEditor.serviceUrl=e.serviceUrl);break;case"serverActionSettings":this.documentEditor&&this.setserverActionSettings();break;case"zIndex":this.documentEditor&&(this.documentEditor.zIndex=e.zIndex);break;case"headers":break;case"locale":case"enableRtl":break;case"enableComment":this.documentEditor&&(this.documentEditor.enableComment=e.enableComment);break;case"enableSpellCheck":this.documentEditor&&(this.documentEditor.enableSpellCheck=e.enableSpellCheck);break;case"documentEditorSettings":this.documentEditor&&this.customizeDocumentEditorSettings();break;case"toolbarItems":break;case"currentUser":this.documentEditor&&(this.documentEditor.currentUser=e.currentUser);break;case"userColor":this.documentEditor&&(this.documentEditor.userColor=e.userColor);break;case"layoutType":this.documentEditor&&(this.documentEditor.layoutType=e.layoutType);break;case"enableToolbar":this.documentEditor&&this.documentEditor.resize();break;case"height":var n="";n=-1!==this.height.indexOf("%")?window.innerHeight*(parseInt(this.height)/100)+"px":sf.base.formatUnit(this.height),this.element.style.height=n,this.documentEditor&&this.documentEditor.resize();break;case"width":this.element.style.width=sf.base.formatUnit(this.width),this.documentEditor&&this.documentEditor.resize()}}},e.prototype.preRender=function(e){var t="";t=-1!==this.height.indexOf("%")?window.innerHeight*(parseInt(this.height)/100)+"px":sf.base.formatUnit(this.height),this.element.style.height=t,""!==this.width&&(this.element.style.width=sf.base.formatUnit(this.width)),this.element.style.minHeight="320px"},e.prototype.render=function(e,t){this.initializeDocumentEditor(e,t),this.setserverActionSettings(),this.customizeDocumentEditorSettings()},e.prototype.setFormat=function(){},e.prototype.setserverActionSettings=function(){},e.prototype.setShowHiddenMarks=function(e){var t=this;this.documentEditorSettings.showHiddenMarks=e,this.documentEditor.documentEditorSettings.showHiddenMarks=e,this.documentEditor.viewer.updateScrollBars(),setTimeout((function(){t.documentEditor.viewer&&t.documentEditor.focusIn()}),30)},e.prototype.customizeDocumentEditorSettings=function(){if(this.documentEditorSettings.formFieldSettings){var e=this.documentEditorSettings.formFieldSettings,t=this.documentEditor;sf.base.isNullOrUndefined(e.applyShading)||(t.documentEditorSettings.formFieldSettings.applyShading=e.applyShading),sf.base.isNullOrUndefined(e.formFillingMode)||(t.documentEditorSettings.formFieldSettings.formFillingMode=e.formFillingMode),sf.base.isNullOrUndefined(e.formattingExceptions)||(t.documentEditorSettings.formFieldSettings.formattingExceptions=e.formattingExceptions),sf.base.isNullOrUndefined(e.selectionColor)||(t.documentEditorSettings.formFieldSettings.selectionColor=e.selectionColor),sf.base.isNullOrUndefined(e.shadingColor)||(t.documentEditorSettings.formFieldSettings.shadingColor=e.shadingColor)}this.documentEditorSettings.searchHighlightColor&&(this.documentEditor.documentEditorSettings.searchHighlightColor=this.documentEditorSettings.searchHighlightColor),this.documentEditorSettings.fontFamilies&&(this.documentEditor.documentEditorSettings.fontFamilies=this.documentEditorSettings.fontFamilies),this.documentEditorSettings.printDevicePixelRatio&&(this.documentEditor.documentEditorSettings.printDevicePixelRatio=this.documentEditorSettings.printDevicePixelRatio),sf.base.isNullOrUndefined(this.documentEditorSettings.enableOptimizedTextMeasuring)||(this.documentEditor.documentEditorSettings.enableOptimizedTextMeasuring=this.documentEditorSettings.enableOptimizedTextMeasuring),sf.base.isNullOrUndefined(this.documentEditorSettings.showHiddenMarks)||(this.documentEditor.documentEditorSettings.showHiddenMarks=this.documentEditorSettings.showHiddenMarks)},e.prototype.getPersistData=function(){return"documenteditor-container"},e.prototype.requiredModules=function(){var e=[];return this.enableToolbar&&e.push({member:"toolbar",args:[this]}),e},e.prototype.initializeDocumentEditor=function(e,t){var i=t,r=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(r)||sf.base.isNullOrUndefined(r.element)||(this.documentEditorInternal=r,sf.base.EventHandler.add(i,"selectionChange",this.onSelectionChange,this),this.documentEditor.enableAllModules(),this.documentEditor.enableComment=this.enableComment,this.setFormat(),this.documentEditor.resize())},e.prototype.showHidePropertiesPane=function(e){this.showPropertiesPane&&this.showPropertiesPaneOnSelection(),this.documentEditor.resize()},e.prototype.resize=function(e,t){this.element&&(sf.base.isNullOrUndefined(t)&&this.element&&this.element.parentElement.parentElement&&(t=this.element.parentElement.parentElement.clientHeight),sf.base.isNullOrUndefined(e)&&this.element&&this.element.parentElement.parentElement&&(e=this.element.parentElement.parentElement.clientWidth),!sf.base.isNullOrUndefined(e)&&e>200&&(this.width=e.toString(),this.element.style.width=e+"px"),!sf.base.isNullOrUndefined(t)&&t>200&&(this.height=t.toString(),this.element.style.height=t+"px"),this.documentEditor&&this.documentEditor.resize())},e.prototype.onContentChange=function(){},e.prototype.onDocumentChange=function(){this.enableTrackChanges=this.documentEditor.enableTrackChanges},e.prototype.onSelectionChange=function(){this.showPropertiesPaneOnSelection()},e.prototype.showPropertiesPaneOnSelection=function(){var e=this.documentEditor.selection.contextType,t=e.indexOf("Header")>=0||e.indexOf("Footer")>=0;t||(this.showHeaderProperties=!0,this.documentEditor.fireBeforePaneSwitch("PropertiesPane")),this.showPropertiesPane?t&&this.showHeaderProperties?this.showProperties("headerfooter"):e.indexOf("List")>=0||e.indexOf("Text")>=0&&e.indexOf("Table")<0?this.showProperties("text"):e.indexOf("Image")>=0?this.showProperties("image"):e.indexOf("TableOfContents")>=0?this.showProperties("toc"):e.indexOf("Table")>=0&&this.showProperties("table"):this.showHidePropertiesPane(!1),this.previousContext=this.documentEditor.selection.contextType},e.prototype.showProperties=function(e){this.tableProperties.showTableProperties("text"===e||"table"===e),this.imageProperties.showImageProperties("image"===e),this.headerFooterProperties.showHeaderFooterPane("headerfooter"===e),this.tocProperties.showTocPane("toc"===e)},e.prototype.destroy=function(){this.propertiesPaneContainer&&this.editorContainer.parentElement&&(this.propertiesPaneContainer.innerHTML="",this.propertiesPaneContainer.parentElement.removeChild(this.propertiesPaneContainer)),this.propertiesPaneContainer=void 0,this.editorContainer&&this.editorContainer.parentElement&&(this.editorContainer.innerHTML="",this.editorContainer.parentElement.removeChild(this.editorContainer)),this.statusBarElement&&this.statusBarElement.parentElement&&(this.statusBarElement.innerHTML="",this.statusBarElement.parentElement.removeChild(this.statusBarElement)),this.containerTarget&&this.containerTarget.parentElement&&(this.containerTarget.innerHTML="",this.containerTarget.parentElement.removeChild(this.containerTarget)),this.containerTarget=void 0,this.statusBarElement=void 0,this.editorContainer=void 0}}();var e,t,r,n,o,s=function(){function e(){}return e.prototype.getModuleName=function(){return"Print"},e.prototype.print=function(e,t){this.printWindow(e,void 0!==navigator?navigator.userAgent:"",t)},e.prototype.printWindow=function(e,t,i){var r=this.getPageHeight(e.pages),n=this.getPageWidth(e.pages),o=document.createElement("div");o.style.width="100%",o.style.height="100%",o.style.overflow="scroll",this.generatePrintContent(e,o),sf.base.isNullOrUndefined(i)&&(i=window.open("","print","height=452,width=1024,tabbar=no"));var s=n.toString()+"px "+r.toString()+"px";n>r&&(s="landscape"),-1!==t.indexOf("Chrome")||-1!==t.indexOf("Firefox")?(i.document.write("<!DOCTYPE html>"),i.document.write("<html moznomarginboxes mozdisallowselectionprint><head><style>html, body { height: 100 %; } img { height: 100 %; width: 100 %; display: block;}img { box-sizing: border-box; }br, button { display: none; }@page{ margin: 0cm; size:"+s+"; }@media print{ body { margin: 0cm; size:"+s+"; }</style></head> <body><center>")):i.document.write("<html><head><style>@page{margin:0;size:"+s+";}</style></head><body><center>"),i.document.write(o.innerHTML+"</center><script> (function() { window.ready = true; })(); <\/script></body></html>"),o=void 0,i.document.close(),i.focus();var a=setInterval((function(){i.ready&&(i.print(),i.close(),clearInterval(a))}),500)},e.prototype.exportAsImage=function(e,t,i){var r;if(!sf.base.isNullOrUndefined(t)&&t<=e.pages.length&&t>=1){var n=e.pages[t-1];n.boundingRectangle.height,n.boundingRectangle.width;e.render.isPrinting=!0,e.render.renderWidgets(n,0,0,0,0);var o=e.render.pageCanvas.toDataURL(i,1);e.render.isPrinting=!1,r=o}return r},e.prototype.generatePrintContent=function(e,t){for(var i="",r=0;r<e.pages.length;r++){var n=e.pages[r],o=n.boundingRectangle.height,s=n.boundingRectangle.width;e.render.isPrinting=!0,e.render.renderWidgets(n,0,0,s,0);var a=e.render.pageCanvas.toDataURL();e.render.isPrinting=!1,i+="<div><img src="+a+' style="margin:0px;display:block;width: '+s.toString()+"px; height:"+o.toString()+'px; "/></div><br/>'}t.innerHTML=i},e.prototype.getPageWidth=function(e){for(var t=0,i=0;i<e.length;i++)t<e[i].boundingRectangle.width&&(t=e[i].boundingRectangle.width);return t},e.prototype.getPageHeight=function(e){for(var t=0,i=0;i<e.length;i++)t<e[i].boundingRectangle.height&&(t=e[i].boundingRectangle.height);return t},e.prototype.destroy=function(){},e}(),a=function(){function e(){this.keysInternal=[],this.valuesInternal=[]}return Object.defineProperty(e.prototype,"length",{get:function(){return this.keysInternal.length},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"keys",{get:function(){return this.keysInternal},enumerable:!0,configurable:!0}),e.prototype.add=function(e,t){if(sf.base.isNullOrUndefined(e))throw new ReferenceError("Provided key or value is not valid.");return this.keysInternal.indexOf(e)<0&&(this.keysInternal.push(e),this.valuesInternal.push(t)),1},e.prototype.get=function(e){if(sf.base.isNullOrUndefined(e))throw new ReferenceError("Provided key is not valid.");var t=this.keysInternal.indexOf(e);return t<0||t>this.keysInternal.length-1?void 0:this.valuesInternal[t]},e.prototype.set=function(e,t){if(sf.base.isNullOrUndefined(e))throw new ReferenceError("Provided key is not valid.");var i=this.keysInternal.indexOf(e);if(i<0||i>this.keysInternal.length-1)throw new RangeError("No item with the specified key has been added.");this.valuesInternal[i]=t},e.prototype.remove=function(e){if(sf.base.isNullOrUndefined(e))throw new ReferenceError("Provided key is not valid.");var t=this.keysInternal.indexOf(e);if(t<0||t>this.keysInternal.length-1)throw new RangeError("No item with the specified key has been added.");return this.keysInternal.splice(t,1),this.valuesInternal.splice(t,1),!0},e.prototype.containsKey=function(e){if(sf.base.isNullOrUndefined(e))throw new ReferenceError("Provided key is not valid.");var t=this.keysInternal.indexOf(e);return!(t<0||t>this.keysInternal.length-1)},e.prototype.clear=function(){this.keysInternal=[],this.valuesInternal=[]},e.prototype.destroy=function(){this.clear(),this.keysInternal=void 0,this.valuesInternal=void 0},e}(),l=function(){function e(e){this.referenceCount=0,this.uniqueFormatType=e,this.propertiesHash=new a}return e.prototype.isEqual=function(e,t,i){var r=!1;switch(this.uniqueFormatType){case 1:r=this.isBorderEqual(e,t,i);break;case 2:r=this.isCharacterFormatEqual(e,t,i);break;case 3:r=this.isParagraphFormatEqual(e,t,i);break;case 4:r=this.isCellFormatEqual(e,t,i);break;case 5:r=this.isShadingEqual(e,t,i);break;case 6:r=this.isRowFormatEqual(e,t,i);break;case 7:r=this.isListFormatEqual(e,t,i);break;case 8:r=this.isTableFormatEqual(e,t,i);break;case 9:r=this.isListLevelEqual(e,t,i);break;case 10:r=this.isSectionFormatEqual(e,t,i);break;case 11:r=this.isColumnFormatEqual(e,t,i)}return r},e.prototype.isNotEqual=function(t,i,r,n,o){var s=void 0,a=e.getPropertyType(o,t);this.propertiesHash.containsKey(a)&&(s=this.propertiesHash.get(a));var l=void 0;return t===r?l=n:i.containsKey(a)&&(l=i.get(a)),!(s===l||!sf.base.isNullOrUndefined(s)&&!sf.base.isNullOrUndefined(l)&&s===l)},e.getPropertyType=function(e,t){var i=0;switch(e){case 1:i=this.getBorderPropertyType(t);break;case 2:i=this.getCharacterFormatPropertyType(t);break;case 3:i=this.getParaFormatPropertyType(t);break;case 4:i=this.getCellFormatPropertyType(t);break;case 5:i=this.getShadingPropertyType(t);break;case 6:i=this.getRowFormatType(t);break;case 7:i=this.getListFormatType(t);break;case 8:i=this.getTableFormatType(t);break;case 9:i=this.getListLevelType(t);break;case 10:i=this.getSectionFormatType(t);break;case 11:i=this.getColumnFormatType(t)}return i},e.getRowFormatType=function(e){return"allowBreakAcrossPages"===e?1:"isHeader"===e?2:"height"===e?3:"heightType"===e?4:"gridBefore"===e?5:"gridBeforeWidth"===e?6:"gridBeforeWidthType"===e?7:"gridAfter"===e?8:"gridAfterWidth"===e?9:"gridAfterWidthType"===e?10:"leftMargin"===e?11:"topMargin"===e?12:"bottomMargin"===e?13:"rightMargin"===e?14:"leftIndent"===e?15:0},e.getListFormatType=function(e){return"listId"===e?1:"listLevelNumber"===e?2:0},e.getTableFormatType=function(e){return"leftMargin"===e?1:"rightMargin"===e?2:"topMargin"===e?3:"bottomMargin"===e?4:"cellSpacing"===e?5:"leftIndent"===e?6:"tableAlignment"===e?7:"preferredWidth"===e?8:"preferredWidthType"===e?9:"bidi"===e?10:"allowAutoFit"===e?11:"horizontalPositionAbs"===e?12:"horizontalPosition"===e?13:0},e.getListLevelType=function(e){return"listLevelPattern"===e?1:"startAt"===e?2:"followCharacter"===e?3:"numberFormat"===e?4:"restartLevel"===e?5:0},e.getShadingPropertyType=function(e){return"backgroundColor"===e?1:"foregroundColor"===e?2:"textureStyle"===e?3:0},e.getCellFormatPropertyType=function(e){return"leftMargin"===e?1:"rightMargin"===e?2:"topMargin"===e?3:"bottomMargin"===e?4:"columnSpan"===e?5:"rowSpan"===e?6:"verticalAlignment"===e?7:"preferredWidthType"===e?8:"preferredWidth"===e?9:"cellWidth"===e?10:0},e.getBorderPropertyType=function(e){return"color"===e?1:"lineStyle"===e?2:"lineWidth"===e?3:"shadow"===e?4:"space"===e?5:"hasNoneStyle"===e?6:0},e.getCharacterFormatPropertyType=function(e){return"fontColor"===e?1:"fontFamily"===e?2:"fontSize"===e?3:"bold"===e?4:"italic"===e?5:"underline"===e?6:"strikethrough"===e?7:"baselineAlignment"===e?8:"highlightColor"===e?9:"bidi"===e?10:"bdo"===e?11:"boldBidi"===e?12:"italicBidi"===e?13:"fontFamilyBidi"===e?14:"fontSizeBidi"===e?15:"allCaps"===e?16:"localeIdBidi"===e?17:"complexScript"===e?18:"fontFamilyFarEast"===e?19:"fontFamilyAscii"===e?20:"fontFamilyNonFarEast"===e?21:"localeIdAscii"===e?22:"localeIdFarEast"===e?23:0},e.getParaFormatPropertyType=function(e){return"leftIndent"===e?1:"rightIndent"===e?2:"firstLineIndent"===e?3:"textAlignment"===e?4:"beforeSpacing"===e?5:"afterSpacing"===e?6:"lineSpacing"===e?7:"lineSpacingType"===e?8:"outlineLevel"===e?9:"bidi"===e?10:"contextualSpacing"===e?11:"keepWithNext"===e?12:"keepLinesTogether"===e?13:"widowControl"===e?14:"spaceBeforeAuto"===e?15:"spaceAfterAuto"===e?16:0},e.getColumnFormatType=function(e){return"width"===e?1:"space"===e?2:0},e.getSectionFormatType=function(e){return"headerDistance"===e?1:"footerDistance"===e?2:"differentFirstPage"===e?3:"differentOddAndEvenPages"===e?4:"pageWidth"===e?5:"pageHeight"===e?6:"leftMargin"===e?7:"topMargin"===e?8:"rightMargin"===e?9:"bottomMargin"===e?10:"bidi"===e?11:"restartPageNumbering"===e?12:"pageStartingNumber"===e?13:"endnoteNumberFormat"===e?14:"endnotePosition"===e?15:"footNoteNumberFormat"===e?16:"footnotePosition"===e?17:"restartIndexForEndnotes"===e?18:"restartIndexForFootnotes"===e?19:"initialFootNoteNumber"===e?20:"initialEndNoteNumber"===e?21:"pageNumberStyle"===e?22:"numberOfColumns"===e?23:"equalWidth"===e?24:"lineBetweenColumns"===e?25:"columns"===e?26:"breakCode"===e?27:0},e.prototype.isBorderEqual=function(e,t,i){return!this.isNotEqual("color",e,t,i,1)&&(!this.isNotEqual("lineStyle",e,t,i,1)&&(!this.isNotEqual("lineWidth",e,t,i,1)&&(!this.isNotEqual("shadow",e,t,i,1)&&(!this.isNotEqual("space",e,t,i,1)&&!this.isNotEqual("hasNoneStyle",e,t,i,1)))))},e.prototype.isCharacterFormatEqual=function(e,t,i){return!this.isNotEqual("fontColor",e,t,i,2)&&(!this.isNotEqual("fontFamily",e,t,i,2)&&(!this.isNotEqual("fontSize",e,t,i,2)&&(!this.isNotEqual("bold",e,t,i,2)&&(!this.isNotEqual("italic",e,t,i,2)&&(!this.isNotEqual("underline",e,t,i,2)&&(!this.isNotEqual("strikethrough",e,t,i,2)&&(!this.isNotEqual("baselineAlignment",e,t,i,2)&&(!this.isNotEqual("highlightColor",e,t,i,2)&&(!this.isNotEqual("bidi",e,t,i,2)&&(!this.isNotEqual("bdo",e,t,i,2)&&(!this.isNotEqual("fontColor",e,t,i,2)&&(!this.isNotEqual("fontFamilyBidi",e,t,i,2)&&(!this.isNotEqual("fontSizeBidi",e,t,i,2)&&(!this.isNotEqual("boldBidi",e,t,i,2)&&(!this.isNotEqual("italicBidi",e,t,i,2)&&(!this.isNotEqual("allCaps",e,t,i,2)&&(!this.isNotEqual("localeIdBidi",e,t,i,2)&&(!this.isNotEqual("complexScript",e,t,i,2)&&(!this.isNotEqual("fontFamilyFarEast",e,t,i,2)&&(!this.isNotEqual("fontFamilyAscii",e,t,i,2)&&!this.isNotEqual("fontFamilyNonFarEast",e,t,i,2)))))))))))))))))))))},e.prototype.isParagraphFormatEqual=function(e,t,i){return!this.isNotEqual("leftIndent",e,t,i,3)&&(!this.isNotEqual("rightIndent",e,t,i,3)&&(!this.isNotEqual("firstLineIndent",e,t,i,3)&&(!this.isNotEqual("textAlignment",e,t,i,3)&&(!this.isNotEqual("beforeSpacing",e,t,i,3)&&(!this.isNotEqual("afterSpacing",e,t,i,3)&&(!this.isNotEqual("spaceBeforeAuto",e,t,i,3)&&(!this.isNotEqual("spaceAfterAuto",e,t,i,3)&&(!this.isNotEqual("lineSpacing",e,t,i,3)&&(!this.isNotEqual("lineSpacingType",e,t,i,3)&&(!this.isNotEqual("outlineLevel",e,t,i,3)&&(!this.isNotEqual("bidi",e,t,i,3)&&(!this.isNotEqual("contextualSpacing",e,t,i,3)&&(!this.isNotEqual("keepWithNext",e,t,i,3)&&(!this.isNotEqual("keepLinesTogether",e,t,i,3)&&!this.isNotEqual("widowControl",e,t,i,3)))))))))))))))},e.prototype.isCellFormatEqual=function(e,t,i){return!this.isNotEqual("leftMargin",e,t,i,4)&&(!this.isNotEqual("rightMargin",e,t,i,4)&&(!this.isNotEqual("topMargin",e,t,i,4)&&(!this.isNotEqual("bottomMargin",e,t,i,4)&&(!this.isNotEqual("columnSpan",e,t,i,4)&&(!this.isNotEqual("rowSpan",e,t,i,4)&&(!this.isNotEqual("verticalAlignment",e,t,i,4)&&(!this.isNotEqual("preferredWidthType",e,t,i,4)&&(!this.isNotEqual("preferredWidth",e,t,i,4)&&!this.isNotEqual("cellWidth",e,t,i,4)))))))))},e.prototype.isShadingEqual=function(e,t,i){return!this.isNotEqual("backgroundColor",e,t,i,5)&&(!this.isNotEqual("foregroundColor",e,t,i,5)&&!this.isNotEqual("textureStyle",e,t,i,5))},e.prototype.isRowFormatEqual=function(e,t,i){return!this.isNotEqual("allowBreakAcrossPages",e,t,i,6)&&(!this.isNotEqual("isHeader",e,t,i,6)&&(!this.isNotEqual("height",e,t,i,6)&&(!this.isNotEqual("heightType",e,t,i,6)&&(!this.isNotEqual("gridBefore",e,t,i,6)&&(!this.isNotEqual("gridBeforeWidth",e,t,i,6)&&(!this.isNotEqual("gridBeforeWidthType",e,t,i,6)&&(!this.isNotEqual("gridAfter",e,t,i,6)&&(!this.isNotEqual("gridAfterWidth",e,t,i,6)&&(!this.isNotEqual("gridAfterWidthType",e,t,i,6)&&(!this.isNotEqual("leftMargin",e,t,i,6)&&(!this.isNotEqual("topMargin",e,t,i,6)&&(!this.isNotEqual("bottomMargin",e,t,i,6)&&(!this.isNotEqual("rightMargin",e,t,i,6)&&!this.isNotEqual("leftIndent",e,t,i,6))))))))))))))},e.prototype.isListFormatEqual=function(e,t,i){return!this.isNotEqual("listId",e,t,i,7)&&!this.isNotEqual("listLevelNumber",e,t,i,7)},e.prototype.isTableFormatEqual=function(e,t,i){return!this.isNotEqual("leftMargin",e,t,i,8)&&(!this.isNotEqual("rightMargin",e,t,i,8)&&(!this.isNotEqual("topMargin",e,t,i,8)&&(!this.isNotEqual("bottomMargin",e,t,i,8)&&(!this.isNotEqual("cellSpacing",e,t,i,8)&&(!this.isNotEqual("leftIndent",e,t,i,8)&&(!this.isNotEqual("tableAlignment",e,t,i,8)&&(!this.isNotEqual("preferredWidth",e,t,i,8)&&(!this.isNotEqual("preferredWidthType",e,t,i,8)&&(!this.isNotEqual("bidi",e,t,i,8)&&(!this.isNotEqual("allowAutoFit",e,t,i,8)&&(!this.isNotEqual("horizontalPositionAbs",e,t,i,8)&&!this.isNotEqual("horizontalPosition",e,t,i,8))))))))))))},e.prototype.isListLevelEqual=function(e,t,i){return!this.isNotEqual("listLevelPattern",e,t,i,9)&&(!this.isNotEqual("startAt",e,t,i,9)&&(!this.isNotEqual("followCharacter",e,t,i,9)&&(!this.isNotEqual("numberFormat",e,t,i,9)&&!this.isNotEqual("restartLevel",e,t,i,9))))},e.prototype.isSectionFormatEqual=function(e,t,i){return!this.isNotEqual("headerDistance",e,t,i,10)&&(!this.isNotEqual("footerDistance",e,t,i,10)&&(!this.isNotEqual("differentFirstPage",e,t,i,10)&&(!this.isNotEqual("differentOddAndEvenPages",e,t,i,10)&&(!this.isNotEqual("pageWidth",e,t,i,10)&&(!this.isNotEqual("pageHeight",e,t,i,10)&&(!this.isNotEqual("leftMargin",e,t,i,10)&&(!this.isNotEqual("topMargin",e,t,i,10)&&(!this.isNotEqual("rightMargin",e,t,i,10)&&(!this.isNotEqual("bottomMargin",e,t,i,10)&&(!this.isNotEqual("bidi",e,t,i,10)&&(!this.isNotEqual("restartPageNumbering",e,t,i,10)&&(!this.isNotEqual("pageStartingNumber",e,t,i,10)&&(!this.isNotEqual("endnoteNumberFormat",e,t,i,10)&&(!this.isNotEqual("endnotePosition",e,t,i,10)&&(!this.isNotEqual("footNoteNumberFormat",e,t,i,10)&&(!this.isNotEqual("footnotePosition",e,t,i,10)&&(!this.isNotEqual("restartIndexForEndnotes",e,t,i,10)&&(!this.isNotEqual("restartIndexForFootnotes",e,t,i,10)&&(!this.isNotEqual("initialFootNoteNumber",e,t,i,10)&&(!this.isNotEqual("initialEndNoteNumber",e,t,i,10)&&(!this.isNotEqual("pageNumberStyle",e,t,i,10)&&(!this.isNotEqual("numberOfColumns",e,t,i,10)&&(!this.isNotEqual("equalWidth",e,t,i,10)&&(!this.isNotEqual("lineBetweenColumns",e,t,i,10)&&!this.isNotEqual("breakCode",e,t,i,10)))))))))))))))))))))))))},e.prototype.isColumnFormatEqual=function(e,t,i){return!this.isNotEqual("width",e,t,i,11)&&!this.isNotEqual("space",e,t,i,11)},e.prototype.cloneItems=function(t,i,r,n){for(var o=e.getPropertyType(n,i),s=t.propertiesHash.keys,a=0;a<s.length;a++)s[a]===o?this.propertiesHash.add(o,r):this.propertiesHash.add(s[a],t.propertiesHash.get(s[a]));t.propertiesHash.containsKey(o)||this.propertiesHash.add(o,r)},e.prototype.mergeProperties=function(e){for(var t=e.cloneProperties(),i=this.propertiesHash.keys,r=0;r<i.length;r++)t.containsKey(i[r])||t.add(i[r],this.propertiesHash.get(i[r]));return t},e.prototype.cloneProperties=function(){for(var e=new a,t=this.propertiesHash.keys,i=0;i<t.length;i++)e.add(t[i],this.propertiesHash.get(t[i]));return e},e.prototype.destroy=function(){sf.base.isNullOrUndefined(this.propertiesHash)||this.propertiesHash.destroy(),this.propertiesHash=void 0,this.referenceCount=void 0,this.uniqueFormatType=void 0},e}(),h=function(){function e(){this.items=[]}return e.prototype.addUniqueFormat=function(e,t){for(var i=void 0,r=0;r<this.items.length;r++)if(this.items[r].isEqual(e,void 0,void 0)){i=this.items[r];break}return sf.base.isNullOrUndefined(i)?((i=new l(t)).propertiesHash=e,i.referenceCount=1,this.items.push(i)):i.referenceCount++,i},e.prototype.updateUniqueFormat=function(e,t,i){for(var r=void 0,n=0;n<this.items.length;n++)if(this.items[n].isEqual(e.propertiesHash,t,i)){r=this.items[n];break}return sf.base.isNullOrUndefined(r)?((r=new l(e.uniqueFormatType)).cloneItems(e,t,i,e.uniqueFormatType),r.referenceCount=1,this.items.push(r)):r.referenceCount++,this.remove(e),r},e.prototype.remove=function(e){e.referenceCount--,e.referenceCount<=0&&(this.items.splice(this.items.indexOf(e),1),e.destroy(),e=void 0)},e.prototype.clear=function(){if(sf.base.isNullOrUndefined(this.items))for(var e=0;e<this.items.length;e++)this.items[e].destroy();this.items=[]},e.prototype.destroy=function(){this.clear(),this.items=void 0},e}(),d=function(){function e(e){this.uniqueSectionFormat=void 0,this.columns=[],this.ownerBase=e,this.columns=[]}return Object.defineProperty(e.prototype,"headerDistance",{get:function(){return this.getPropertyValue("headerDistance")},set:function(e){this.setPropertyValue("headerDistance",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"footerDistance",{get:function(){return this.getPropertyValue("footerDistance")},set:function(e){this.setPropertyValue("footerDistance",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"differentFirstPage",{get:function(){return this.getPropertyValue("differentFirstPage")},set:function(e){this.setPropertyValue("differentFirstPage",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"differentOddAndEvenPages",{get:function(){return this.getPropertyValue("differentOddAndEvenPages")},set:function(e){this.setPropertyValue("differentOddAndEvenPages",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pageHeight",{get:function(){return this.getPropertyValue("pageHeight")},set:function(e){this.setPropertyValue("pageHeight",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rightMargin",{get:function(){return this.getPropertyValue("rightMargin")},set:function(e){this.setPropertyValue("rightMargin",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pageWidth",{get:function(){return this.getPropertyValue("pageWidth")},set:function(e){this.setPropertyValue("pageWidth",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"leftMargin",{get:function(){return this.getPropertyValue("leftMargin")},set:function(e){this.setPropertyValue("leftMargin",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bottomMargin",{get:function(){return this.getPropertyValue("bottomMargin")},set:function(e){this.setPropertyValue("bottomMargin",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"topMargin",{get:function(){return this.getPropertyValue("topMargin")},set:function(e){this.setPropertyValue("topMargin",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bidi",{get:function(){return this.getPropertyValue("bidi")},set:function(e){this.setPropertyValue("bidi",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"restartPageNumbering",{get:function(){return this.getPropertyValue("restartPageNumbering")},set:function(e){this.setPropertyValue("restartPageNumbering",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pageStartingNumber",{get:function(){return this.getPropertyValue("pageStartingNumber")},set:function(e){this.setPropertyValue("pageStartingNumber",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"endnoteNumberFormat",{get:function(){return this.getPropertyValue("endnoteNumberFormat")},set:function(e){this.setPropertyValue("endnoteNumberFormat",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"restartIndexForEndnotes",{get:function(){return this.getPropertyValue("restartIndexForEndnotes")},set:function(e){this.setPropertyValue("restartIndexForEndnotes",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"restartIndexForFootnotes",{get:function(){return this.getPropertyValue("restartIndexForFootnotes")},set:function(e){this.setPropertyValue("restartIndexForFootnotes",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"footNoteNumberFormat",{get:function(){return this.getPropertyValue("footNoteNumberFormat")},set:function(e){this.setPropertyValue("footNoteNumberFormat",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"initialFootNoteNumber",{get:function(){return this.getPropertyValue("initialFootNoteNumber")},set:function(e){this.setPropertyValue("initialFootNoteNumber",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"initialEndNoteNumber",{get:function(){return this.getPropertyValue("initialEndNoteNumber")},set:function(e){this.setPropertyValue("initialEndNoteNumber",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pageNumberStyle",{get:function(){return this.getPropertyValue("pageNumberStyle")},set:function(e){this.setPropertyValue("pageNumberStyle",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"numberOfColumns",{get:function(){return this.getPropertyValue("numberOfColumns")},set:function(e){this.setPropertyValue("numberOfColumns",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"equalWidth",{get:function(){return this.getPropertyValue("equalWidth")},set:function(e){this.setPropertyValue("equalWidth",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lineBetweenColumns",{get:function(){return this.getPropertyValue("lineBetweenColumns")},set:function(e){this.setPropertyValue("lineBetweenColumns",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"breakCode",{get:function(){return this.getPropertyValue("breakCode")},set:function(e){this.setPropertyValue("breakCode",e)},enumerable:!0,configurable:!0}),e.prototype.destroy=function(){sf.base.isNullOrUndefined(this.uniqueSectionFormat)||e.uniqueSectionFormats.remove(this.uniqueSectionFormat),this.uniqueSectionFormat=void 0,this.columns=void 0},e.prototype.hasValue=function(e){if(!sf.base.isNullOrUndefined(this.uniqueSectionFormat)){var t=l.getPropertyType(this.uniqueSectionFormat.uniqueFormatType,e);return this.uniqueSectionFormat.propertiesHash.containsKey(t)}return!1},e.getPropertyDefaultValue=function(e){var t=void 0;switch(e){case"headerDistance":case"footerDistance":t=36;break;case"differentFirstPage":case"differentOddAndEvenPages":t=!1;break;case"pageWidth":t=612;break;case"pageHeight":t=792;break;case"leftMargin":case"topMargin":case"rightMargin":case"bottomMargin":t=72;break;case"bidi":case"restartPageNumbering":t=!1;break;case"pageStartingNumber":t=1;break;case"footnotePosition":t="PrintAtBottomOfPage";break;case"endnoteNumberFormat":t="LowerCaseRoman";break;case"endnotePosition":t="DisplayEndOfDocument";break;case"restartIndexForEndnotes":case"restartIndexForFootnotes":t="DoNotRestart";break;case"footNoteNumberFormat":t="Arabic";break;case"initialFootNoteNumber":case"initialEndNoteNumber":t=1;break;case"pageNumberStyle":t="Arabic";break;case"numberOfColumns":t=1;break;case"equalWidth":t=!0;break;case"lineBetweenColumns":t=!1;break;case"breakCode":t="NewPage"}return t},e.prototype.getPropertyValue=function(t){if(this.hasValue(t)){var i=l.getPropertyType(e.uniqueFormatType,t);if(!sf.base.isNullOrUndefined(this.uniqueSectionFormat)&&this.uniqueSectionFormat.propertiesHash.containsKey(i))return this.uniqueSectionFormat.propertiesHash.get(i)}return e.getPropertyDefaultValue(t)},e.prototype.setPropertyValue=function(t,i){if((sf.base.isNullOrUndefined(i)||""===i)&&(i=e.getPropertyDefaultValue(t)),sf.base.isNullOrUndefined(this.uniqueSectionFormat))this.initializeUniqueSectionFormat(t,i);else{var r=l.getPropertyType(this.uniqueSectionFormat.uniqueFormatType,t);if(this.uniqueSectionFormat.propertiesHash.containsKey(r)&&this.uniqueSectionFormat.propertiesHash.get(r)===i)return;this.uniqueSectionFormat=e.uniqueSectionFormats.updateUniqueFormat(this.uniqueSectionFormat,t,i)}},e.prototype.initializeUniqueSectionFormat=function(t,i){var r=new a;this.addUniqueSectionFormat("headerDistance",t,i,r),this.addUniqueSectionFormat("footerDistance",t,i,r),this.addUniqueSectionFormat("differentFirstPage",t,i,r),this.addUniqueSectionFormat("differentOddAndEvenPages",t,i,r),this.addUniqueSectionFormat("pageWidth",t,i,r),this.addUniqueSectionFormat("pageHeight",t,i,r),this.addUniqueSectionFormat("leftMargin",t,i,r),this.addUniqueSectionFormat("topMargin",t,i,r),this.addUniqueSectionFormat("rightMargin",t,i,r),this.addUniqueSectionFormat("bottomMargin",t,i,r),this.addUniqueSectionFormat("bidi",t,i,r),this.addUniqueSectionFormat("restartPageNumbering",t,i,r),this.addUniqueSectionFormat("pageStartingNumber",t,i,r),this.addUniqueSectionFormat("endnoteNumberFormat",t,i,r),this.addUniqueSectionFormat("endnotePosition",t,i,r),this.addUniqueSectionFormat("footNoteNumberFormat",t,i,r),this.addUniqueSectionFormat("footnotePosition",t,i,r),this.addUniqueSectionFormat("restartIndexForEndnotes",t,i,r),this.addUniqueSectionFormat("restartIndexForFootnotes",t,i,r),this.addUniqueSectionFormat("initialFootNoteNumber",t,i,r),this.addUniqueSectionFormat("initialEndNoteNumber",t,i,r),this.addUniqueSectionFormat("pageNumberStyle",t,i,r),this.addUniqueSectionFormat("numberOfColumns",t,i,r),this.addUniqueSectionFormat("equalWidth",t,i,r),this.addUniqueSectionFormat("lineBetweenColumns",t,i,r),this.addUniqueSectionFormat("breakCode",t,i,r),this.uniqueSectionFormat=e.uniqueSectionFormats.addUniqueFormat(r,e.uniqueFormatType)},e.prototype.addUniqueSectionFormat=function(t,i,r,n){var o=l.getPropertyType(e.uniqueFormatType,t);t===i?n.add(o,r):n.add(o,e.getPropertyDefaultValue(t))},e.prototype.copyFormat=function(e,t){t&&(t.isUndoing||t.isRedoing)?(this.uniqueSectionFormat=e.uniqueSectionFormat,this.columns=e.columns):sf.base.isNullOrUndefined(e)||!sf.base.isNullOrUndefined(e.uniqueSectionFormat)&&e.uniqueSectionFormat.propertiesHash&&(this.updateUniqueSectionFormat(e),this.columns=e.columns)},e.prototype.updateUniqueSectionFormat=function(t){var i=void 0;this.uniqueSectionFormat&&(i=this.uniqueSectionFormat.mergeProperties(t.uniqueSectionFormat),0===this.uniqueSectionFormat.referenceCount&&(e.uniqueSectionFormats.remove(this.uniqueSectionFormat),this.uniqueSectionFormat=void 0)),this.uniqueSectionFormat=new l(e.uniqueFormatType),sf.base.isNullOrUndefined(i)&&(i=this.uniqueSectionFormat.mergeProperties(t.uniqueSectionFormat)),this.uniqueSectionFormat=e.uniqueSectionFormats.addUniqueFormat(i,e.uniqueFormatType)},e.prototype.cloneFormat=function(){var t=new e;return t.uniqueSectionFormat=this.uniqueSectionFormat,t.columns=this.columns,t},e.clear=function(){this.uniqueSectionFormats.clear()},e.uniqueSectionFormats=new h,e.uniqueFormatType=10,e}(),c=function(){function e(e){this.uniqueColumnFormat=void 0,this.ownerBase=e}return e.prototype.destroy=function(){sf.base.isNullOrUndefined(this.uniqueColumnFormat)||e.uniqueColumnFormats.remove(this.uniqueColumnFormat),this.uniqueColumnFormat=void 0,this.ownerBase=void 0},e.prototype.hasValue=function(e){if(!sf.base.isNullOrUndefined(this.uniqueColumnFormat)){var t=l.getPropertyType(this.uniqueColumnFormat.uniqueFormatType,e);return this.uniqueColumnFormat.propertiesHash.containsKey(t)}return!1},Object.defineProperty(e.prototype,"index",{get:function(){return this.indexIn},set:function(e){this.indexIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return this.getPropertyValue("width")},set:function(e){this.setPropertyValue("width",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"space",{get:function(){return this.getPropertyValue("space")},set:function(e){this.setPropertyValue("space",e)},enumerable:!0,configurable:!0}),e.prototype.getPropertyValue=function(t){if(this.hasValue(t)){var i=l.getPropertyType(e.uniqueFormatType,t);if(!sf.base.isNullOrUndefined(this.uniqueColumnFormat)&&this.uniqueColumnFormat.propertiesHash.containsKey(i))return this.uniqueColumnFormat.propertiesHash.get(i)}return e.getPropertyDefaultValue(t)},e.getPropertyDefaultValue=function(e){var t=void 0;switch(e){case"width":t=36;break;case"space":t=0}return t},e.prototype.setPropertyValue=function(t,i){if((sf.base.isNullOrUndefined(i)||""===i)&&(i=e.getPropertyDefaultValue(t)),sf.base.isNullOrUndefined(this.uniqueColumnFormat))this.initializeUniqueColumnFormat(t,i);else{var r=l.getPropertyType(this.uniqueColumnFormat.uniqueFormatType,t);if(this.uniqueColumnFormat.propertiesHash.containsKey(r)&&this.uniqueColumnFormat.propertiesHash.get(r)===i)return;this.uniqueColumnFormat=e.uniqueColumnFormats.updateUniqueFormat(this.uniqueColumnFormat,t,i)}},e.prototype.initializeUniqueColumnFormat=function(t,i){var r=new a;this.addUniqueColumnFormat("width",t,i,r),this.addUniqueColumnFormat("space",t,i,r),this.uniqueColumnFormat=e.uniqueColumnFormats.addUniqueFormat(r,e.uniqueFormatType)},e.prototype.addUniqueColumnFormat=function(t,i,r,n){var o=l.getPropertyType(e.uniqueFormatType,t);t===i?n.add(o,r):n.add(o,e.getPropertyDefaultValue(t))},e.prototype.updateUniqueColumnFormat=function(t){var i=void 0;this.uniqueColumnFormat&&(i=this.uniqueColumnFormat.mergeProperties(t.uniqueColumnFormat),0===this.uniqueColumnFormat.referenceCount&&(e.uniqueColumnFormats.remove(this.uniqueColumnFormat),this.uniqueColumnFormat=void 0)),this.uniqueColumnFormat=new l(e.uniqueFormatType),sf.base.isNullOrUndefined(i)&&(i=this.uniqueColumnFormat.mergeProperties(t.uniqueColumnFormat)),this.uniqueColumnFormat=e.uniqueColumnFormats.addUniqueFormat(i,e.uniqueFormatType)},e.prototype.cloneFormat=function(){var t=new e(void 0);return t.width=this.width,t.space=this.space,t},e.prototype.copyFormat=function(e){sf.base.isNullOrUndefined(e)||sf.base.isNullOrUndefined(e.uniqueColumnFormat)||(this.width=e.width,this.space=e.space)},e.clear=function(){this.uniqueColumnFormats.clear()},e.uniqueColumnFormats=new h,e.uniqueFormatType=11,e}(),p=function(){function e(e){this.uniqueBorderFormat=void 0,this.ownerBase=void 0,this.ownerBase=e}return Object.defineProperty(e.prototype,"color",{get:function(){return this.getPropertyValue("color")},set:function(e){this.setPropertyValue("color",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lineStyle",{get:function(){return this.getPropertyValue("lineStyle")},set:function(e){this.setPropertyValue("lineStyle",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lineWidth",{get:function(){return this.getPropertyValue("lineWidth")},set:function(e){this.setPropertyValue("lineWidth",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"shadow",{get:function(){return this.getPropertyValue("shadow")},set:function(e){this.setPropertyValue("shadow",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"space",{get:function(){return this.getPropertyValue("space")},set:function(e){this.setPropertyValue("space",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hasNoneStyle",{get:function(){return this.getPropertyValue("hasNoneStyle")},set:function(e){this.setPropertyValue("hasNoneStyle",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isBorderDefined",{get:function(){return"None"!==this.lineStyle||this.hasNoneStyle&&this.hasValue("hasNoneStyle")},enumerable:!0,configurable:!0}),e.prototype.getPropertyValue=function(t){if(this.hasValue(t)){var i=l.getPropertyType(e.uniqueFormatType,t);if(!sf.base.isNullOrUndefined(this.uniqueBorderFormat)){var r=this.uniqueBorderFormat.propertiesHash.get(i);if(!sf.base.isNullOrUndefined(r))return r}}return e.getPropertyDefaultValue(t)},e.prototype.setPropertyValue=function(t,i){if((sf.base.isNullOrUndefined(i)||""===i)&&(i=e.getPropertyDefaultValue(t)),sf.base.isNullOrUndefined(this.uniqueBorderFormat))this.initializeUniqueBorder(t,i);else{var r=l.getPropertyType(this.uniqueBorderFormat.uniqueFormatType,t);if(this.uniqueBorderFormat.propertiesHash.containsKey(r)&&this.uniqueBorderFormat.propertiesHash.get(r)===i)return;this.uniqueBorderFormat=e.uniqueBorderFormats.updateUniqueFormat(this.uniqueBorderFormat,t,i)}},e.prototype.initializeUniqueBorder=function(t,i){var r=new a;this.addUniqueBorderFormat("color",t,i,r),this.addUniqueBorderFormat("lineStyle",t,i,r),this.addUniqueBorderFormat("lineWidth",t,i,r),this.addUniqueBorderFormat("shadow",t,i,r),this.addUniqueBorderFormat("space",t,i,r),this.addUniqueBorderFormat("hasNoneStyle",t,i,r),this.uniqueBorderFormat=e.uniqueBorderFormats.addUniqueFormat(r,e.uniqueFormatType)},e.prototype.addUniqueBorderFormat=function(t,i,r,n){var o=l.getPropertyType(e.uniqueFormatType,t);t===i&&n.add(o,r)},e.prototype.isEqualFormat=function(e){var t=!1;return this.color===e.color&&this.lineStyle===e.lineStyle&&this.lineWidth===e.lineWidth&&this.shadow==e.shadow&&this.space===e.space&&(t=!0),t},e.getPropertyDefaultValue=function(e){var t=void 0;switch(e){case"color":t="#000000";break;case"lineStyle":t="None";break;case"lineWidth":t=0;break;case"shadow":t=!1;break;case"space":t=0;break;case"hasNoneStyle":t=!1}return t},e.prototype.getLineWidth=function(){switch(this.lineStyle){case"None":case"Cleared":return 0;case"Triple":case"Double":case"ThinThickSmallGap":case"ThickThinSmallGap":case"ThinThickThinSmallGap":case"ThinThickMediumGap":case"ThickThinMediumGap":case"ThinThickThinMediumGap":case"ThinThickLargeGap":case"ThickThinLargeGap":case"ThinThickThinLargeGap":case"Emboss3D":case"Engrave3D":for(var e=this.getBorderLineWidthArray(this.lineStyle,this.lineWidth),t=0,i=0;i<e.length;i++)t+=e[i];return t;case"Single":case"DashLargeGap":case"DashSmallGap":case"Dot":case"DashDot":case"DashDotDot":case"Thick":return this.lineWidth;case"SingleWavy":return 1.5===this.lineWidth?3:2.5;case"DoubleWavy":return 6.75;case"DashDotStroked":case"Outset":return this.lineWidth}return this.lineWidth},e.prototype.getBorderLineWidthArray=function(e,t){var i=[t];switch(e){case"Double":i=[1,1,1];break;case"ThinThickSmallGap":i=[1,-.75,-.75];break;case"ThickThinSmallGap":i=[-.75,-.75,1];break;case"ThinThickMediumGap":i=[1,.5,.5];break;case"ThickThinMediumGap":i=[.5,.5,1];break;case"ThinThickLargeGap":i=[-1.5,1,-.75];break;case"ThickThinLargeGap":i=[-.75,1,-1.5];break;case"Triple":i=[1,1,1,1,1];break;case"ThinThickThinSmallGap":i=[-.75,-.75,1,-.75,-.75];break;case"ThinThickThinMediumGap":i=[.5,.5,1,.5,.5];break;case"ThinThickThinLargeGap":i=[-.75,1,-1.5,1,-.75];break;case"Emboss3D":case"Engrave3D":i=[.25,0,1,0,.25]}if(1===i.length)return[t];for(var r=0;r<i.length;r++)i[parseInt(r.toString(),10)]>=0?i[parseInt(r.toString(),10)]=i[parseInt(r.toString(),10)]*t:i[parseInt(r.toString(),10)]=Math.abs(i[parseInt(r.toString(),10)]);return i},e.prototype.getBorderWeight=function(){var e=0,t=(this.getNumberOfLines(),this.getBorderNumber());switch(this.lineStyle){case"Single":case"DashSmallGap":case"DashDot":case"DashDotDot":case"Double":case"Triple":case"ThinThickSmallGap":case"ThickThinSmallGap":case"ThinThickThinSmallGap":case"ThinThickMediumGap":case"ThickThinMediumGap":case"ThinThickThinMediumGap":case"ThinThickLargeGap":case"ThickThinLargeGap":case"ThinThickThinLargeGap":case"SingleWavy":case"DoubleWavy":case"DashDotStroked":case"Emboss3D":case"Engrave3D":case"Outset":case"Inset":case"Thick":e=this.lineWidth*t;break;case"Dot":case"DashLargeGap":e=1}return e},e.prototype.getBorderNumber=function(){var e=0;switch(this.lineStyle){case"Single":e=1;break;case"Thick":e=2;break;case"Double":e=3;break;case"Dot":e=4;break;case"DashLargeGap":e=5;break;case"DashDot":e=6;break;case"DashDotDot":e=7;break;case"Triple":e=8;break;case"ThinThickSmallGap":e=9;break;case"ThickThinSmallGap":e=10;break;case"ThinThickThinSmallGap":e=11;break;case"ThinThickMediumGap":e=12;break;case"ThickThinMediumGap":e=13;break;case"ThinThickThinMediumGap":e=14;break;case"ThinThickLargeGap":e=15;break;case"ThickThinLargeGap":e=16;break;case"ThinThickThinLargeGap":e=17;break;case"SingleWavy":e=18;break;case"DoubleWavy":e=19;break;case"DashSmallGap":e=20;break;case"DashDotStroked":e=21;break;case"Emboss3D":e=22;break;case"Engrave3D":e=23;break;case"Outset":e=24;break;case"Inset":e=25}return e},e.prototype.getNumberOfLines=function(){var e=0;switch(this.lineStyle){case"Single":case"Dot":case"DashSmallGap":case"DashLargeGap":case"DashDot":case"DashDotDot":e=1;break;case"Double":e=3;break;case"Triple":e=5;break;case"ThinThickSmallGap":case"ThickThinSmallGap":e=3;break;case"ThinThickThinSmallGap":e=5;break;case"ThinThickMediumGap":case"ThickThinMediumGap":e=3;break;case"ThinThickThinMediumGap":e=5;break;case"ThinThickLargeGap":case"ThickThinLargeGap":e=3;break;case"ThinThickThinLargeGap":e=5;break;case"SingleWavy":e=1;break;case"DoubleWavy":e=2;break;case"DashDotStroked":e=1;break;case"Emboss3D":case"Engrave3D":e=3;break;case"Outset":case"Inset":case"Thick":e=1}return e},e.prototype.getPrecedence=function(){var e=0;switch(this.lineStyle){case"Single":e=1;break;case"Thick":e=2;break;case"Double":e=3;break;case"Dot":e=4;break;case"DashLargeGap":e=5;break;case"DashDot":e=6;break;case"DashDotDot":e=7;break;case"Triple":e=8;break;case"ThinThickSmallGap":e=9;break;case"ThickThinSmallGap":e=10;break;case"ThinThickThinSmallGap":e=11;break;case"ThinThickMediumGap":e=12;break;case"ThickThinMediumGap":e=13;break;case"ThinThickThinMediumGap":e=14;break;case"ThinThickLargeGap":e=15;break;case"ThickThinLargeGap":e=16;break;case"ThinThickThinLargeGap":e=17;break;case"SingleWavy":e=18;break;case"DoubleWavy":e=19;break;case"DashSmallGap":e=20;break;case"DashDotStroked":e=21;break;case"Emboss3D":e=22;break;case"Engrave3D":e=23;break;case"Outset":e=24;break;case"Inset":e=25}return e},e.prototype.hasValues=function(){return this.hasValue("color")||this.hasValue("lineStyle")||this.hasValue("lineWidth")||this.hasValue("shadow")||this.hasValue("space")||this.hasValue("hasNoneStyle")},e.prototype.hasValue=function(e){if(!sf.base.isNullOrUndefined(this.uniqueBorderFormat)){var t=l.getPropertyType(this.uniqueBorderFormat.uniqueFormatType,e);return this.uniqueBorderFormat.propertiesHash.containsKey(t)}return!1},e.prototype.cloneFormat=function(){var t=new e(void 0);return t.color=this.color,t.lineStyle=this.lineStyle,t.lineWidth=this.lineWidth,t.shadow=this.shadow,t.space=this.space,t},e.prototype.destroy=function(){sf.base.isNullOrUndefined(this.uniqueBorderFormat)||e.uniqueBorderFormats.remove(this.uniqueBorderFormat),this.uniqueBorderFormat=void 0},e.prototype.copyFormat=function(e){sf.base.isNullOrUndefined(e)||sf.base.isNullOrUndefined(e.uniqueBorderFormat)||(e.hasValue("color")&&(this.color=e.color),e.hasValue("lineStyle")&&(this.lineStyle=e.lineStyle),e.hasValue("lineWidth")&&(this.lineWidth=e.lineWidth),e.hasValue("shadow")&&(this.shadow=e.shadow),e.hasValue("space")&&(this.space=e.space),e.hasValue("hasNoneStyle")&&(this.hasNoneStyle=e.hasNoneStyle))},e.clear=function(){this.uniqueBorderFormats.clear()},e.uniqueBorderFormats=new h,e.uniqueFormatType=1,e}(),u=function(){function e(e){this.leftIn=new p(this),this.rightIn=new p(this),this.topIn=new p(this),this.bottomIn=new p(this),this.horizontalIn=new p(this),this.verticalIn=new p(this),this.diagonalUpIn=new p(this),this.diagonalDownIn=new p(this),this.isParsing=!1,this.ownerBase=e}return Object.defineProperty(e.prototype,"left",{get:function(){return this.ownerBase instanceof ct?this.getPropertyValue("left"):this.leftIn},set:function(e){this.leftIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"right",{get:function(){return this.ownerBase instanceof ct?this.getPropertyValue("right"):this.rightIn},set:function(e){this.rightIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"top",{get:function(){return this.ownerBase instanceof ct?this.getPropertyValue("top"):this.topIn},set:function(e){this.topIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bottom",{get:function(){return this.ownerBase instanceof ct?this.getPropertyValue("bottom"):this.bottomIn},set:function(e){this.bottomIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"horizontal",{get:function(){return this.ownerBase instanceof ct?this.getPropertyValue("horizontal"):this.horizontalIn},set:function(e){this.horizontalIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"vertical",{get:function(){return this.ownerBase instanceof ct?this.getPropertyValue("vertical"):this.verticalIn},set:function(e){this.verticalIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"diagonalUp",{get:function(){return this.diagonalUpIn},set:function(e){this.diagonalUpIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"diagonalDown",{get:function(){return this.diagonalDownIn},set:function(e){this.diagonalDownIn=e},enumerable:!0,configurable:!0}),e.prototype.getPropertyValue=function(e){var t=this.getBorder(e);if(this.isParsing)return t;if(t.hasValues())return t;var i=this.ownerBase.baseStyle;if(!sf.base.isNullOrUndefined(i)){for(var r=this;!sf.base.isNullOrUndefined(i);){var n=void 0;if(this.ownerBase.listFormat.hasValue("listId")||(n=i.paragraphFormat.getListPargaraphFormat(e)),i.paragraphFormat.borders.getBorder(e).hasValues()){r=i.paragraphFormat.borders;break}if(!sf.base.isNullOrUndefined(n)&&n.borders.getBorder(e).hasValues()){r=n.borders;break}i=i.basedOn}if(!sf.base.isNullOrUndefined(i))return r.getBorder(e)}return this.getDefaultValue(e)},e.prototype.getDefaultValue=function(e){var t,i=this.documentParagraphFormat();return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.borders)||(t=i.borders.getBorder(e)),t},e.prototype.documentParagraphFormat=function(){var e;return this.ownerBase instanceof ct&&(e=this.ownerBase.getDocumentParagraphFormat()),e},e.prototype.getBorder=function(e){switch(e){case"left":return this.leftIn;case"right":return this.rightIn;case"top":return this.topIn;case"bottom":return this.bottomIn;case"vertical":return this.verticalIn;case"horizontal":return this.horizontalIn}},e.prototype.destroy=function(){sf.base.isNullOrUndefined(this.leftIn)||this.leftIn.destroy(),sf.base.isNullOrUndefined(this.topIn)||this.topIn.destroy(),sf.base.isNullOrUndefined(this.bottomIn)||this.bottomIn.destroy(),sf.base.isNullOrUndefined(this.rightIn)||this.rightIn.destroy(),sf.base.isNullOrUndefined(this.horizontalIn)||this.horizontalIn.destroy(),sf.base.isNullOrUndefined(this.verticalIn)||this.verticalIn.destroy(),sf.base.isNullOrUndefined(this.diagonalDown)||this.diagonalDown.destroy(),sf.base.isNullOrUndefined(this.diagonalUp)||this.diagonalUp.destroy(),this.topIn=void 0,this.bottomIn=void 0,this.leftIn=void 0,this.rightIn=void 0,this.horizontalIn=void 0,this.verticalIn=void 0,this.diagonalDownIn=void 0,this.diagonalUpIn=void 0},e.prototype.cloneFormat=function(){var t=new e(void 0);return t.top=sf.base.isNullOrUndefined(this.topIn)?void 0:this.topIn.cloneFormat(),t.bottom=sf.base.isNullOrUndefined(this.bottomIn)?void 0:this.bottomIn.cloneFormat(),t.left=sf.base.isNullOrUndefined(this.leftIn)?void 0:this.leftIn.cloneFormat(),t.right=sf.base.isNullOrUndefined(this.rightIn)?void 0:this.rightIn.cloneFormat(),t.horizontal=sf.base.isNullOrUndefined(this.horizontalIn)?void 0:this.horizontalIn.cloneFormat(),t.vertical=sf.base.isNullOrUndefined(this.verticalIn)?void 0:this.verticalIn.cloneFormat(),t.diagonalUp=sf.base.isNullOrUndefined(this.diagonalUp)?void 0:this.diagonalUp.cloneFormat(),t.diagonalDown=sf.base.isNullOrUndefined(this.diagonalDown)?void 0:this.diagonalDown.cloneFormat(),t},e.prototype.copyFormat=function(e){if(!sf.base.isNullOrUndefined(e.getBorder("left"))&&e.getBorder("left")instanceof p){var t=new p(this);t.copyFormat(e.getBorder("left")),this.left=t}if(!sf.base.isNullOrUndefined(e.getBorder("right"))&&e.getBorder("right")instanceof p){var i=new p(this);i.copyFormat(e.getBorder("right")),this.right=i}if(!sf.base.isNullOrUndefined(e.getBorder("top"))&&e.getBorder("top")instanceof p){var r=new p(this);r.copyFormat(e.getBorder("top")),this.top=r}if(!sf.base.isNullOrUndefined(e.getBorder("bottom"))&&e.getBorder("bottom")instanceof p){var n=new p(this);n.copyFormat(e.getBorder("bottom")),this.bottom=n}if(!sf.base.isNullOrUndefined(e.getBorder("horizontal"))&&e.getBorder("horizontal")instanceof p){var o=new p(this);o.copyFormat(e.getBorder("horizontal")),this.horizontal=o}if(!sf.base.isNullOrUndefined(e.getBorder("vertical"))&&e.getBorder("vertical")instanceof p){var s=new p(this);s.copyFormat(e.getBorder("vertical")),this.vertical=s}!sf.base.isNullOrUndefined(e.diagonalDown)&&e.diagonalDown instanceof p&&(this.diagonalDown=new p(this),this.diagonalDown.copyFormat(e.diagonalDown)),!sf.base.isNullOrUndefined(e.diagonalUp)&&e.diagonalUp instanceof p&&(this.diagonalUp=new p(this),this.diagonalUp.copyFormat(e.diagonalUp))},e}(),g=function(){function e(){}return e.prototype.destroy=function(){sf.base.isNullOrUndefined(this.overrideListLevel)||this.overrideListLevel.destroy(),this.levelNumber=void 0,this.startAt=void 0,this.overrideListLevel=void 0},e.prototype.clone=function(){var t=new e;return t.startAt=this.startAt,t.levelNumber=this.levelNumber,sf.base.isNullOrUndefined(this.overrideListLevel)||(t.overrideListLevel=this.overrideListLevel.clone(t)),t},e}(),f=function(){function e(){this.listId=-1,this.sourceListId=-1,this.abstractListId=-1,this.abstractList=void 0,this.levelOverrides=[]}return e.prototype.getListLevel=function(e){var t=this.getLevelOverride(e);return sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t.overrideListLevel)?this.abstractList.levels[parseInt(e.toString(),10)]:t.overrideListLevel},e.prototype.getLevelOverride=function(e){for(var t=0;t<this.levelOverrides.length;t++)if(this.levelOverrides[parseInt(t.toString(),10)]instanceof g){var i=this.levelOverrides[parseInt(t.toString(),10)];if(i.levelNumber===e)return i}},e.prototype.destroy=function(){sf.base.isNullOrUndefined(this.levelOverrides)||(this.levelOverrides=[]),this.abstractListId=void 0,this.listId=void 0,this.sourceListId=void 0,this.levelOverrides=void 0},e.prototype.mergeList=function(e){sf.base.isNullOrUndefined(this.abstractListId)||-1===this.abstractListId||(this.abstractListId=e.abstractListId),sf.base.isNullOrUndefined(this.listId)||-1===this.listId||(this.listId=e.listId),sf.base.isNullOrUndefined(this.sourceListId)||-1===this.sourceListId||(this.sourceListId=e.sourceListId),sf.base.isNullOrUndefined(this.levelOverrides)||0===this.levelOverrides.length||(this.levelOverrides=e.levelOverrides)},e.prototype.clone=function(){for(var t=new e,i=0;i<this.levelOverrides.length;i++)t.levelOverrides.push(this.levelOverrides[parseInt(i.toString(),10)].clone());return t},e}(),m=function(){function e(e){this.uniqueListFormat=void 0,this.ownerBase=void 0,this.baseStyle=void 0,this.list=void 0,this.ownerBase=e}return Object.defineProperty(e.prototype,"listId",{get:function(){return this.getPropertyValue("listId")},set:function(e){if(e>=0){if(!sf.base.isNullOrUndefined(this.ownerBase)){var t=this.ownerBase.getDocumentHelperObject();sf.base.isNullOrUndefined(t)||(this.list=t.getListById(e))}}else!sf.base.isNullOrUndefined(this.list)&&e<0&&(this.list=void 0);this.setPropertyValue("listId",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"listLevelNumber",{get:function(){return this.getPropertyValue("listLevelNumber")},set:function(e){this.setPropertyValue("listLevelNumber",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"listLevel",{get:function(){var e=void 0;if(sf.base.isNullOrUndefined(this.list))for(var t=this.baseStyle;!sf.base.isNullOrUndefined(t)&&t instanceof gt;){if(t.paragraphFormat.listFormat.list){e=t.paragraphFormat.listFormat.list;break}t=t.basedOn}else e=this.list;return sf.base.isNullOrUndefined(e)?void 0:e.getListLevel(this.listLevelNumber)},enumerable:!0,configurable:!0}),e.prototype.getPropertyValue=function(t){if(this.hasValue(t)){r=l.getPropertyType(e.uniqueFormatType,t);if(!sf.base.isNullOrUndefined(this.uniqueListFormat)&&this.uniqueListFormat.propertiesHash.containsKey(r))return this.uniqueListFormat.propertiesHash.get(r)}else if(this.baseStyle instanceof gt){for(var i=this.baseStyle;!sf.base.isNullOrUndefined(i)&&!i.paragraphFormat.listFormat.hasValue(t);)i=i.basedOn;if(!sf.base.isNullOrUndefined(i)){var r=l.getPropertyType(e.uniqueFormatType,t);return i.paragraphFormat.listFormat.uniqueListFormat.propertiesHash.get(r)}}return e.getPropertyDefaultValue(t)},e.prototype.setPropertyValue=function(t,i){if((sf.base.isNullOrUndefined(i)||""===i)&&(i=e.getPropertyDefaultValue(t)),sf.base.isNullOrUndefined(this.uniqueListFormat))this.initializeUniqueListFormat(t,i);else{var r=l.getPropertyType(this.uniqueListFormat.uniqueFormatType,t);if(this.uniqueListFormat.propertiesHash.containsKey(r)&&this.uniqueListFormat.propertiesHash.get(r)===i)return;this.uniqueListFormat=e.uniqueListFormats.updateUniqueFormat(this.uniqueListFormat,t,i)}},e.prototype.initializeUniqueListFormat=function(t,i){var r=new a;this.addUniqueListFormat("listId",t,i,r),this.addUniqueListFormat("listLevelNumber",t,i,r),this.uniqueListFormat=e.uniqueListFormats.addUniqueFormat(r,e.uniqueFormatType)},e.prototype.addUniqueListFormat=function(t,i,r,n){var o=l.getPropertyType(e.uniqueFormatType,t);t===i&&n.add(o,r)},e.getPropertyDefaultValue=function(e){var t=void 0;switch(e){case"listId":t=-1;break;case"listLevelNumber":t=0}return t},e.prototype.copyFormat=function(e){sf.base.isNullOrUndefined(e)||(sf.base.isNullOrUndefined(e.uniqueListFormat)||(this.listId=e.listId,this.listLevelNumber=e.listLevelNumber),sf.base.isNullOrUndefined(e.baseStyle)||(this.baseStyle=e.baseStyle),sf.base.isNullOrUndefined(e.list)||(this.list=e.list))},e.prototype.hasValue=function(e){if(!sf.base.isNullOrUndefined(this.uniqueListFormat)){var t=l.getPropertyType(this.uniqueListFormat.uniqueFormatType,e);return this.uniqueListFormat.propertiesHash.containsKey(t)}return!1},e.prototype.clearFormat=function(){sf.base.isNullOrUndefined(this.uniqueListFormat)||0!==this.uniqueListFormat.referenceCount||e.uniqueListFormats.remove(this.uniqueListFormat),this.uniqueListFormat=void 0,this.list=void 0},e.prototype.destroy=function(){this.clearFormat()},e.clear=function(){this.uniqueListFormats.clear()},e.prototype.applyStyle=function(e){this.baseStyle=e},e.prototype.getValue=function(e){return this.hasValue(e)?this.getPropertyValue(e):void 0},e.prototype.mergeFormat=function(e){sf.base.isNullOrUndefined(this.getValue("listId"))&&(this.listId=e.getValue("listId")),sf.base.isNullOrUndefined(this.getValue("listLevelNumber"))&&(this.listLevelNumber=e.getValue("listLevelNumber")),sf.base.isNullOrUndefined(e.list)||(sf.base.isNullOrUndefined(this.list)&&(this.list=new f),this.list.mergeList(e.list))},e.prototype.cloneListFormat=function(){var t=new e(void 0);return t.list=this.list,t.listId=this.listId,t.baseStyle=this.baseStyle,t.listLevelNumber=this.listLevelNumber,t.uniqueListFormat=this.uniqueListFormat,t},e.uniqueListFormats=new h,e.uniqueFormatType=7,e}();!function(e){e[e.LeftToRight=0]="LeftToRight",e[e.RightToLeft=1]="RightToLeft",e[e.WordSplit=2]="WordSplit",e[e.Number=4]="Number",e[e.Tab=6]="Tab"}(e||(e={})),function(e){e[e.English=0]="English",e[e.Hindi=1]="Hindi",e[e.Korean=2]="Korean",e[e.Chinese=3]="Chinese",e[e.Arabic=4]="Arabic",e[e.Hebrew=5]="Hebrew",e[e.Japanese=6]="Japanese",e[e.Thai=7]="Thai"}(t||(t={})),function(e){e[e.Default=0]="Default",e[e.EastAsia=1]="EastAsia",e[e.CS=2]="CS"}(r||(r={})),function(e){e[e.af_ZA=1078]="af_ZA",e[e.sq_AL=1052]="sq_AL",e[e.am_ET=1118]="am_ET",e[e.gsw_FR=1156]="gsw_FR",e[e.ar_DZ=5121]="ar_DZ",e[e.ar_BH=15361]="ar_BH",e[e.ar_EG=3073]="ar_EG",e[e.ar_IQ=2049]="ar_IQ",e[e.ar_JO=11265]="ar_JO",e[e.ar_KW=13313]="ar_KW",e[e.ar_LB=12289]="ar_LB",e[e.ar_LY=4097]="ar_LY",e[e.ar_MA=6145]="ar_MA",e[e.ar_OM=8193]="ar_OM",e[e.ar_QA=16385]="ar_QA",e[e.ar_SA=1025]="ar_SA",e[e.ar_SY=10241]="ar_SY",e[e.ar_TN=7169]="ar_TN",e[e.ar_AE=14337]="ar_AE",e[e.ar_YE=9217]="ar_YE",e[e.hy_AM=1067]="hy_AM",e[e.as_IN=1101]="as_IN",e[e.az_Cyrl_AZ=2092]="az_Cyrl_AZ",e[e.az_Latn_AZ=1068]="az_Latn_AZ",e[e.ba_RU=1133]="ba_RU",e[e.eu_ES=1069]="eu_ES",e[e.be_BY=1059]="be_BY",e[e.bn_BD=2117]="bn_BD",e[e.bn_IN=1093]="bn_IN",e[e.bs_Cyrl_BA=8218]="bs_Cyrl_BA",e[e.bs_Latn_BA=5146]="bs_Latn_BA",e[e.bg_BG=1026]="bg_BG",e[e.br_FR=1150]="br_FR",e[e.my_MM=1109]="my_MM",e[e.ca_ES=1027]="ca_ES",e[e.chr_US=1116]="chr_US",e[e.zh_HK=3076]="zh_HK",e[e.zh_MO=5124]="zh_MO",e[e.zh_CN=2052]="zh_CN",e[e.zh_SG=4100]="zh_SG",e[e.zh_TW=1028]="zh_TW",e[e.co_FR=1155]="co_FR",e[e.hr_BA=4122]="hr_BA",e[e.hr_HR=1050]="hr_HR",e[e.cs_CZ=1029]="cs_CZ",e[e.da_DK=1030]="da_DK",e[e.prs_AF=1164]="prs_AF",e[e.dv_MV=1125]="dv_MV",e[e.nl_BE=2067]="nl_BE",e[e.nl_NL=1043]="nl_NL",e[e.bin_NG=1126]="bin_NG",e[e.et_EE=1061]="et_EE",e[e.en_AU=3081]="en_AU",e[e.en_BZ=10249]="en_BZ",e[e.en_CA=4105]="en_CA",e[e.en_029=9225]="en_029",e[e.en_HK=15369]="en_HK",e[e.en_IN=16393]="en_IN",e[e.en_ID=14345]="en_ID",e[e.en_IE=6153]="en_IE",e[e.en_JM=8201]="en_JM",e[e.en_MY=17417]="en_MY",e[e.en_NZ=5129]="en_NZ",e[e.en_PH=13321]="en_PH",e[e.en_SG=18441]="en_SG",e[e.en_ZA=7177]="en_ZA",e[e.en_TT=11273]="en_TT",e[e.en_GB=2057]="en_GB",e[e.en_US=1033]="en_US",e[e.en_ZW=12297]="en_ZW",e[e.fo_FO=1080]="fo_FO",e[e.fil_PH=1124]="fil_PH",e[e.fi_FI=1035]="fi_FI",e[e.fr_BE=2060]="fr_BE",e[e.fr_CM=11276]="fr_CM",e[e.fr_CA=3084]="fr_CA",e[e.fr_CD=9228]="fr_CD",e[e.fr_CI=12300]="fr_CI",e[e.fr_FR=1036]="fr_FR",e[e.fr_HT=15372]="fr_HT",e[e.fr_LU=5132]="fr_LU",e[e.fr_ML=13324]="fr_ML",e[e.fr_MC=6156]="fr_MC",e[e.fr_MA=14348]="fr_MA",e[e.fr_RE=8204]="fr_RE",e[e.fr_SN=10252]="fr_SN",e[e.fr_CH=4108]="fr_CH",e[e.fy_NL=1122]="fy_NL",e[e.ff_NG=1127]="ff_NG",e[e.gd_GB=1084]="gd_GB",e[e.gl_ES=1110]="gl_ES",e[e.ka_GE=1079]="ka_GE",e[e.de_AT=3079]="de_AT",e[e.de_DE=1031]="de_DE",e[e.de_LI=5127]="de_LI",e[e.de_LU=4103]="de_LU",e[e.de_CH=2055]="de_CH",e[e.el_GR=1032]="el_GR",e[e.gn_PY=1140]="gn_PY",e[e.gu_IN=1095]="gu_IN",e[e.kl_GL=1135]="kl_GL",e[e.ha_Latn_NG=1128]="ha_Latn_NG",e[e.haw_US=1141]="haw_US",e[e.he_IL=1037]="he_IL",e[e.hi_IN=1081]="hi_IN",e[e.hu_HU=1038]="hu_HU",e[e.ibb_NG=1129]="ibb_NG",e[e.is_IS=1039]="is_IS",e[e.ig_NG=1136]="ig_NG",e[e.id_ID=1057]="id_ID",e[e.iu_Latn_CA=2141]="iu_Latn_CA",e[e.iu_Cans_CA=1117]="iu_Cans_CA",e[e.it_IT=1040]="it_IT",e[e.it_CH=2064]="it_CH",e[e.ga_IE=2108]="ga_IE",e[e.xh_ZA=1076]="xh_ZA",e[e.zu_ZA=1077]="zu_ZA",e[e.kn_IN=1099]="kn_IN",e[e.kr_NG=1137]="kr_NG",e[e.ks_Deva=2144]="ks_Deva",e[e.ks_Arab=1120]="ks_Arab",e[e.kk_KZ=1087]="kk_KZ",e[e.km_KH=1107]="km_KH",e[e.kok_IN=1111]="kok_IN",e[e.ko_KR=1042]="ko_KR",e[e.ky_KG=1088]="ky_KG",e[e.qut_GT=1158]="qut_GT",e[e.rw_RW=1159]="rw_RW",e[e.lo_LA=1108]="lo_LA",e[e.la_Latn=1142]="la_Latn",e[e.lv_LV=1062]="lv_LV",e[e.lt_LT=1063]="lt_LT",e[e.dsb_DE=2094]="dsb_DE",e[e.lb_LU=1134]="lb_LU",e[e.mk_MK=1071]="mk_MK",e[e.ms_BN=2110]="ms_BN",e[e.ms_MY=1086]="ms_MY",e[e.ml_IN=1100]="ml_IN",e[e.mt_MT=1082]="mt_MT",e[e.mni_IN=1112]="mni_IN",e[e.mi_NZ=1153]="mi_NZ",e[e.mr_IN=1102]="mr_IN",e[e.arn_CL=1146]="arn_CL",e[e.mn_MN=1104]="mn_MN",e[e.mn_Mong_CN=2128]="mn_Mong_CN",e[e.ne_NP=1121]="ne_NP",e[e.ne_IN=2145]="ne_IN",e[e.nb_NO=1044]="nb_NO",e[e.nn_NO=2068]="nn_NO",e[e.oc_FR=1154]="oc_FR",e[e.or_IN=1096]="or_IN",e[e.om_Ethi_ET=1138]="om_Ethi_ET",e[e.pap_AN=1145]="pap_AN",e[e.ps_AF=1123]="ps_AF",e[e.fa_IR=1065]="fa_IR",e[e.pl_PL=1045]="pl_PL",e[e.pt_BR=1046]="pt_BR",e[e.pt_PT=2070]="pt_PT",e[e.pa_IN=1094]="pa_IN",e[e.pa_PK=2118]="pa_PK",e[e.quz_BO=1131]="quz_BO",e[e.guz_EC=2155]="guz_EC",e[e.guz_PE=3179]="guz_PE",e[e.ro_RO=1048]="ro_RO",e[e.ro_MO=2072]="ro_MO",e[e.rm_CH=1047]="rm_CH",e[e.ru_RU=1049]="ru_RU",e[e.ru_MO=2073]="ru_MO",e[e.smn_FI=9275]="smn_FI",e[e.smj_NO=4155]="smj_NO",e[e.smj_SE=5179]="smj_SE",e[e.se_FI=3131]="se_FI",e[e.se_NO=1083]="se_NO",e[e.se_SE=2107]="se_SE",e[e.sms_FI=8251]="sms_FI",e[e.sma_NO=6203]="sma_NO",e[e.sma_SE=7227]="sma_SE",e[e.sa_IN=1103]="sa_IN",e[e.sr_Cyrl_BA=7194]="sr_Cyrl_BA",e[e.sr_Cyrl_CS=3098]="sr_Cyrl_CS",e[e.sr_Latn_BA=6170]="sr_Latn_BA",e[e.sr_Latn_CS=2074]="sr_Latn_CS",e[e.nso_ZA=1132]="nso_ZA",e[e.tn_ZA=1074]="tn_ZA",e[e.sd_Arab_PK=2137]="sd_Arab_PK",e[e.sd_Deva_IN=1113]="sd_Deva_IN",e[e.si_LK=1115]="si_LK",e[e.sk_SK=1051]="sk_SK",e[e.sl_SI=1060]="sl_SI",e[e.so_SO=1143]="so_SO",e[e.es_AR=11274]="es_AR",e[e.es_BO=16394]="es_BO",e[e.es_CL=13322]="es_CL",e[e.es_CO=9226]="es_CO",e[e.es_CR=5130]="es_CR",e[e.es_DO=7178]="es_DO",e[e.es_EC=12298]="es_EC",e[e.es_SV=17418]="es_SV",e[e.es_GT=4106]="es_GT",e[e.es_HN=18442]="es_HN",e[e.es_MX=2058]="es_MX",e[e.es_NI=19466]="es_NI",e[e.es_PA=6154]="es_PA",e[e.es_PY=15370]="es_PY",e[e.es_PE=10250]="es_PE",e[e.es_PR=20490]="es_PR",e[e.es_ES=3082]="es_ES",e[e.es_ES_tradnl=1034]="es_ES_tradnl",e[e.es_US=21514]="es_US",e[e.es_UY=14346]="es_UY",e[e.es_VE=8202]="es_VE",e[e.st_ZA=1072]="st_ZA",e[e.sw_KE=1089]="sw_KE",e[e.sv_FI=2077]="sv_FI",e[e.sv_SE=1053]="sv_SE",e[e.syr_SY=1114]="syr_SY",e[e.tg_Cyrl_TJ=1064]="tg_Cyrl_TJ",e[e.tzm_Arab_MA=1119]="tzm_Arab_MA",e[e.tzm_Latn_DZ=2143]="tzm_Latn_DZ",e[e.ta_IN=1097]="ta_IN",e[e.tt_RU=1092]="tt_RU",e[e.te_IN=1098]="te_IN",e[e.th_TH=1054]="th_TH",e[e.bo_CN=1105]="bo_CN",e[e.ti_ER=2163]="ti_ER",e[e.ti_ET=1139]="ti_ET",e[e.ts_ZA=1073]="ts_ZA",e[e.tr_TR=1055]="tr_TR",e[e.tk_TM=1090]="tk_TM",e[e.ug_CN=1152]="ug_CN",e[e.uk_UA=1058]="uk_UA",e[e.hsb_DE=1070]="hsb_DE",e[e.ur_PK=1056]="ur_PK",e[e.uz_Cyrl_UZ=2115]="uz_Cyrl_UZ",e[e.uz_Latn_UZ=1091]="uz_Latn_UZ",e[e.ve_ZA=1075]="ve_ZA",e[e.vi_VN=1066]="vi_VN",e[e.cy_GB=1106]="cy_GB",e[e.wo_SN=1160]="wo_SN",e[e.sah_RU=1157]="sah_RU",e[e.ii_CN=1144]="ii_CN",e[e.yi_Hebr=1085]="yi_Hebr",e[e.yo_NG=1130]="yo_NG",e[e.ja_JP=1041]="ja_JP"}(n||(n={})),function(e){e.EvenPage="EvenPage",e.NewPage="NewPage",e.Continuous="NoBreak",e.OddPage="OddPage"}(o||(o={}));var y,v,b,w,x=function(){function e(){}return e.insert=function(e,t,i){return t>=0?[e.slice(0,t)+i+e.slice(t)].join(""):i+this},e.remove=function(e,t){return 0===t?e.substring(t+1,e.length):e.substring(0,t)+e.substring(t+1,e.length)},e.indexOfAny=function(e,t){for(var i=void 0,r=0;r<t.length;r++){var n=e.indexOf(t[parseInt(r.toString(),10)]);(-1!==n&&sf.base.isNullOrUndefined(i)||-1!==n&&n<i)&&(i=n)}return sf.base.isNullOrUndefined(i)?-1:i},e.lastIndexOfAny=function(e,t){for(var i=e.length-1;i>=0;i--)for(var r=0;r<=t.length-1;r++)if(e[parseInt(i.toString(),10)]===t[parseInt(r.toString(),10)])return i;return-1},e.convertArgbToRgb=function(e){return e.length>=8?e.substr(0,6):e},e.convertRgbToHex=function(e){var t=Number(e).toString(16);return t.length<2&&(t="0"+t),t},e.convertHexToRgb=function(e){var t,i,r;if(e){e=e.replace(/[^0-9A-â€Œâ€‹F]/gi,"");var n=parseInt(e,16);return 8==e.length?(t=n>>32&255,i=n>>16&255,r=n>>8&255):6==e.length&&(t=n>>16&255,i=n>>8&255,r=255&n),{r:t,g:i,b:r}}},e.addCssStyle=function(e){var t=document.createElement("style");t.style.cssText?t.style.cssText=e:t.appendChild(document.createTextNode(e)),document.getElementsByTagName("head")[0].appendChild(t)},e.getHighlightColorCode=function(e){var t="#ffffff";switch(e){case"Yellow":t="#ffff00";break;case"BrightGreen":t="#00ff00";break;case"Turquoise":t="#00ffff";break;case"Pink":t="#ff00ff";break;case"Blue":t="#0000ff";break;case"Red":t="#ff0000";break;case"DarkBlue":t="#000080";break;case"Teal":t="#008080";break;case"Green":t="#008000";break;case"Violet":t="#800080";break;case"DarkRed":t="#800000";break;case"DarkYellow":t="#808000";break;case"Gray50":t="#808080";break;case"Gray25":t="#c0c0c0";break;case"Black":t="#000000"}return t},e.isVeryDark=function(e){var t=e.substring(1);return(299*parseInt(t.substr(0,2),16)+587*parseInt(t.substr(2,2),16)+114*parseInt(t.substr(4,2),16))/1e3<=60},e.getColor=function(e){return e.length>0&&"#"===e[0]&&e.length>7?e.substr(0,7):e},e.convertPointToPixel=function(t){return e.round(96*t/72,5)},e.convertPixelToPoint=function(t){return e.round(72*t/96,5)},e.isLinkedFieldCharacter=function(e){return e instanceof fe&&0===e.fieldType?!sf.base.isNullOrUndefined(e.fieldEnd):e instanceof fe&&2===e.fieldType?!sf.base.isNullOrUndefined(e.fieldBegin)&&!sf.base.isNullOrUndefined(e.fieldEnd):!sf.base.isNullOrUndefined(e.fieldBegin)},e.removeSpace=function(e){if(!sf.base.isNullOrUndefined(e)&&0!==e.length)for(var t=0;t<e.length;t++)" "===e.charAt(t)&&(e=e.replace(" ",""));return e},e.trimStart=function(e){for(var t=0;t<e.length&&" "===e[parseInt(t.toString(),10)];t++);return e.substring(t,e.length)},e.trimEnd=function(e){for(var t=e.length-1;t>=0&&" "===e[parseInt(t.toString(),10)];t--);return e.substring(0,t+1)},e.endsWith=function(e){return!sf.base.isNullOrUndefined(e)&&0!==e.length&&" "===e[e.length-1]},e.addSpace=function(e){var t="";if(e>0)for(var i=0;i<e;i++)t+=" ";return t},e.writeCharacterFormat=function(e,t,i){e.bold=t?i.bold:i.getValue("bold"),e.italic=t?i.italic:i.getValue("italic"),e.fontSize=t?this.toWriteInline(i,"fontSize"):i.getValue("fontSize"),e.fontFamily=t?this.toWriteInline(i,"fontFamily"):i.getValue("fontFamily"),e.underline=t?i.underline:i.getValue("underline"),e.strikethrough=t?i.strikethrough:i.getValue("strikethrough"),e.baselineAlignment=t?i.baselineAlignment:i.getValue("baselineAlignment"),e.highlightColor=t?i.highlightColor:i.getValue("highlightColor"),e.fontColor=t?this.toWriteInline(i,"fontColor"):i.getValue("fontColor"),e.styleName=sf.base.isNullOrUndefined(i.baseCharStyle)?void 0:i.baseCharStyle.name,e.bidi=t?i.bidi:i.getValue("bidi"),e.bdo=t?i.bdo:i.getValue("bdo"),e.boldBidi=t?i.boldBidi:i.getValue("boldBidi"),e.italicBidi=t?i.italicBidi:i.getValue("italicBidi"),e.fontSizeBidi=t?i.fontSizeBidi:i.getValue("fontSizeBidi"),e.fontFamilyBidi=t?i.fontFamilyBidi:i.getValue("fontFamilyBidi"),e.allCaps=t?i.allCaps:i.getValue("allCaps"),e.localeIdBidi=t?i.localeIdBidi:i.getValue("localeIdBidi"),e.complexScript=t?i.complexScript:i.getValue("complexScript"),e.fontFamilyAscii=t?this.toWriteInline(i,"fontFamilyAscii"):i.getValue("fontFamilyAscii"),e.fontFamilyNonFarEast=t?this.toWriteInline(i,"fontFamilyNonFarEast"):i.getValue("fontFamilyNonFarEast"),e.fontFamilyFarEast=t?this.toWriteInline(i,"fontFamilyFarEast"):i.getValue("fontFamilyFarEast"),i.hasValue("fontFamily")&&(sf.base.isNullOrUndefined(e.fontFamilyAscii)&&(e.fontFamilyAscii=i.fontFamily),sf.base.isNullOrUndefined(e.fontFamilyNonFarEast)&&(e.fontFamilyNonFarEast=i.fontFamily),sf.base.isNullOrUndefined(e.fontFamilyFarEast)&&(e.fontFamilyFarEast=i.fontFamily))},e.isThemeFont=function(e){return"majorAscii"==e||"majorBidi"==e||"majorEastAsia"==e||"majorHAnsi"==e||"minorAscii"==e||"minorBidi"==e||"minorEastAsia"==e||"minorHAnsi"==e},e.toWriteInline=function(e,t){return!sf.base.isNullOrUndefined(e.ownerBase)&&e.ownerBase instanceof ge?e.hasValue(t)?e[t]:e.getValue(t):e[t]},e.round=function(e,t){for(var i=e,r=0;r<t;r++)i*=10;i=Math.round(i);for(r=0;r<t;r++)i/=10;return i},e.reverseString=function(e){if(!sf.base.isNullOrUndefined(e)&&""!==e){var t=e.split("");e=t.reverse().join("")}return e},e.formatClippedString=function(e){var t="",i="";return this.startsWith(e,"data:image/svg+xml;base64,")?(t=".svg",i=e.replace("data:image/svg+xml;base64,","")):this.startsWith(e,"data:image/bmp;base64,")?(t=".bmp",i=e.replace("data:image/bmp;base64,","")):this.startsWith(e,"data:image/x-emf;base64,")?(t=".emf",i=e.replace("data:image/x-emf;base64,","")):this.startsWith(e,"data:image/exif;base64,")?(t=".exif",i=e.replace("data:image/exif;base64,","")):this.startsWith(e,"data:image/gif;base64,")?(t=".gif",i=e.replace("data:image/gif;base64,","")):this.startsWith(e,"data:image/icon;base64,")?(t=".ico",i=e.replace("data:image/icon;base64,","")):this.startsWith(e,"data:image/jpeg;base64,")?(t=".jpeg",i=e.replace("data:image/jpeg;base64,","")):this.startsWith(e,"data:image/jpg;base64,")?(t=".jpg",i=e.replace("data:image/jpg;base64,","")):this.startsWith(e,"data:image/png;base64,")?(t=".png",i=e.replace("data:image/png;base64,","")):this.startsWith(e,"data:image/tiff;base64,")?(t=".tif",i=e.replace("data:image/tiff;base64,","")):this.startsWith(e,"data:image/x-wmf;base64,")?(t=".wmf",i=e.replace("data:image/x-wmf;base64,","")):t=".jpeg",{extension:t,formatClippedString:i}},e.startsWith=function(e,t){return t.length>0&&e.substring(0,t.length)===t},e.formatText=function(e,t){var i=t;switch(e.toLowerCase()){case"uppercase":i=t.toUpperCase();break;case"lowercase":i=t.toLowerCase();break;case"firstlower":i=this.lowerFirstChar(t);break;case"firstcapital":i=this.capitaliseFirst(t,"FirstCapital");break;case"titlecase":i=this.capitaliseFirst(t,"Titlecase")}return i},e.formatNumber=function(e,t){var i=new sf.base.Internationalization,r=t.split(".");t=r[0];var n=i.parseNumber(t);if("NaN"===t.toString())return"";""===e&&(e="0");var o={format:e};return i.formatNumber(n,o)},e.formatDate=function(e,t){var i=new sf.base.Internationalization,r=new Date(t);if(isNaN(r.getDate()))return"";if(""===e)return t;-1!==e.indexOf("am/pm")&&(e=e.replace(/am\/pm/gi,"a"));var n={format:e};return i.formatDate(r,n)},e.capitaliseFirst=function(e,t,i){var r="";if("Titlecase"===t){for(var n=i?e.split(i):e.split(" "),o=0;o<n.length;o++)r+=i?n[parseInt(o.toString(),10)].charAt(0).toUpperCase()+n[parseInt(o.toString(),10)].slice(1,n[parseInt(o.toString(),10)].length):this.capitaliseFirstInternal(n[parseInt(o.toString(),10)]),n.length>=0&&!i&&(r+=" ");i||(r=this.capitaliseFirst(r,"Titlecase","\r"))}else"FirstCapital"===t&&(r=this.capitaliseFirstInternal(e));return r},e.lowerFirstChar=function(e){return e.charAt(0).toLowerCase()+e.slice(1,e.length)},e.capitaliseFirstInternal=function(e){return e.charAt(0).toUpperCase()+e.slice(1,e.length).toLowerCase()},e.getModifiedDate=function(t){var i=e.getLocaleDate(t);return i.toLocaleDateString([],{year:"numeric",month:"long",day:"numeric"})+" "+i.toLocaleTimeString([],{hour:"numeric",minute:"numeric"})},e.getUtcDate=function(){var e=new Date;return new Date(e.getTime()-6e4*e.getTimezoneOffset()).toISOString()},e.getLocaleDate=function(e){var t=new Date(e);return new Date(t.getTime()+6e4*t.getTimezoneOffset())},e.getCompatibilityModeValue=function(e){var t;switch(e){case"Word2003":t="11";break;case"Word2007":t="12";break;case"Word2010":t="14";break;default:t="15"}return t},e.wordBefore="\\b",e.wordAfter="\\b",e.wordSplitCharacters=[" ",",",".",":",";","<",">","=","+","-","_","{","}","[","]","`","~","!","@","#","$","%","^","&","*","(",")",'"',"?","/","|","\\","”","　","،","؟","؛","’","‘"],e}(),M=function(){function e(e,t){this.xIn=0,this.yIn=0,this.xIn=e,this.yIn=t}return Object.defineProperty(e.prototype,"x",{get:function(){return this.xIn},set:function(e){this.xIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this.yIn},set:function(e){this.yIn=e},enumerable:!0,configurable:!0}),e.prototype.copy=function(e){this.xIn=e.xIn,this.yIn=e.yIn},e.prototype.destroy=function(){this.xIn=void 0,this.yIn=void 0},e}(),N=function(){function e(){this.keyStr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}return e.prototype.encodeString=function(e){var t,i,r,n,o,s,a,l="",h=0;for(e=this.unicodeEncode(e);h<e.length;)n=(t=e.charCodeAt(h++))>>2,o=(3&t)<<4|(i=e.charCodeAt(h++))>>4,s=(15&i)<<2|(r=e.charCodeAt(h++))>>6,a=63&r,isNaN(i)?s=a=64:isNaN(r)&&(a=64),l=l+this.keyStr.charAt(n)+this.keyStr.charAt(o)+this.keyStr.charAt(s)+this.keyStr.charAt(a);return l},e.prototype.unicodeEncode=function(e){for(var t=e.replace(/\r\n/g,"\n"),i="",r=0;r<t.length;r++){var n=t.charCodeAt(r);n<128?i+=String.fromCharCode(n):n>127&&n<2048?(i+=String.fromCharCode(n>>6|192),i+=String.fromCharCode(63&n|128)):(i+=String.fromCharCode(n>>12|224),i+=String.fromCharCode(n>>6&63|128),i+=String.fromCharCode(63&n|128))}return i},e.prototype.decodeString=function(e){var t,i,r,n,o,s,a=0,l=0,h=3*(e=e.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(e.charAt(e.length-1)===this.keyStr.charAt(64)&&h--,e.charAt(e.length-2)===this.keyStr.charAt(64)&&h--,h%1!=0)throw new Error("Invalid base64 input, bad content length.");for(var d=new Uint8Array(0|h);a<e.length;)t=this.keyStr.indexOf(e.charAt(a++))<<2|(n=this.keyStr.indexOf(e.charAt(a++)))>>4,i=(15&n)<<4|(o=this.keyStr.indexOf(e.charAt(a++)))>>2,r=(3&o)<<6|(s=this.keyStr.indexOf(e.charAt(a++))),d[l++]=t,64!==o&&(d[l++]=i),64!==s&&(d[l++]=r);return d},e}(),I=function(){function e(e,t){this.x=0,this.width=0,this.x=e,this.width=t}return Object.defineProperty(e.prototype,"right",{get:function(){return this.x+this.width},enumerable:!0,configurable:!0}),e}(),S=function(){function e(){this.abstractListIdIn=-1,this.levels=[]}return Object.defineProperty(e.prototype,"abstractListId",{get:function(){return this.abstractListIdIn},set:function(e){this.abstractListIdIn=e},enumerable:!0,configurable:!0}),e.prototype.destroy=function(){if(!sf.base.isNullOrUndefined(this.levels)){for(var e=0;e<this.levels.length;e++){var t=this.levels[parseInt(e.toString(),10)];t.destroy(),this.levels.splice(this.levels.indexOf(t),1),e--}this.levels=[]}this.levels=void 0},e.prototype.clone=function(){for(var t=new e,i=0;i<this.levels.length;i++)t.levels.push(this.levels[parseInt(i.toString(),10)].clone(t));return t},e}(),C=function(){function e(e){this.uniqueRowFormat=void 0,this.borders=new u(this),this.ownerBase=void 0,this.beforeWidth=0,this.afterWidth=0,this.revisions=[],this.removedIds=[],this.ownerBase=e}return Object.defineProperty(e.prototype,"gridBefore",{get:function(){return this.getPropertyValue("gridBefore")},set:function(e){this.setPropertyValue("gridBefore",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"gridBeforeWidth",{get:function(){return this.getPropertyValue("gridBeforeWidth")},set:function(e){this.setPropertyValue("gridBeforeWidth",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"gridBeforeWidthType",{get:function(){return this.getPropertyValue("gridBeforeWidthType")},set:function(e){this.setPropertyValue("gridBeforeWidthType",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"gridAfter",{get:function(){return this.getPropertyValue("gridAfter")},set:function(e){this.setPropertyValue("gridAfter",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"gridAfterWidth",{get:function(){return this.getPropertyValue("gridAfterWidth")},set:function(e){this.setPropertyValue("gridAfterWidth",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"gridAfterWidthType",{get:function(){return this.getPropertyValue("gridAfterWidthType")},set:function(e){this.setPropertyValue("gridAfterWidthType",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"allowBreakAcrossPages",{get:function(){return this.getPropertyValue("allowBreakAcrossPages")},set:function(e){this.setPropertyValue("allowBreakAcrossPages",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isHeader",{get:function(){return this.getPropertyValue("isHeader")},set:function(e){this.setPropertyValue("isHeader",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rightMargin",{get:function(){return this.getPropertyValue("rightMargin")},set:function(e){this.setPropertyValue("rightMargin",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this.getPropertyValue("height")},set:function(e){0!==e||"AtLeast"!==this.heightType&&"Exactly"!==this.heightType?"Auto"===this.heightType&&(e=0):e=1,this.setPropertyValue("height",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"heightType",{get:function(){return this.getPropertyValue("heightType")},set:function(e){this.height="AtLeast"===e||"Exactly"===e?1:0,this.setPropertyValue("heightType",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bottomMargin",{get:function(){return this.getPropertyValue("bottomMargin")},set:function(e){this.setPropertyValue("bottomMargin",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"leftIndent",{get:function(){return this.getPropertyValue("leftIndent")},set:function(e){this.setPropertyValue("leftIndent",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"topMargin",{get:function(){return this.getPropertyValue("topMargin")},set:function(e){this.setPropertyValue("topMargin",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"leftMargin",{get:function(){return this.getPropertyValue("leftMargin")},set:function(e){this.setPropertyValue("leftMargin",e)},enumerable:!0,configurable:!0}),e.prototype.getPropertyValue=function(t){if(this.hasValue(t)){var i=l.getPropertyType(e.uniqueFormatType,t);if(!sf.base.isNullOrUndefined(this.uniqueRowFormat)&&this.uniqueRowFormat.propertiesHash.containsKey(i))return this.uniqueRowFormat.propertiesHash.get(i)}return e.getPropertyDefaultValue(t)},e.prototype.setPropertyValue=function(t,i){if((sf.base.isNullOrUndefined(i)||""===i)&&(i=e.getPropertyDefaultValue(t)),sf.base.isNullOrUndefined(this.uniqueRowFormat))this.initializeUniqueRowFormat(t,i);else{var r=l.getPropertyType(this.uniqueRowFormat.uniqueFormatType,t);if(this.uniqueRowFormat.propertiesHash.containsKey(r)&&this.uniqueRowFormat.propertiesHash.get(r)===i)return;this.uniqueRowFormat=e.uniqueRowFormats.updateUniqueFormat(this.uniqueRowFormat,t,i)}},e.prototype.initializeUniqueRowFormat=function(t,i){var r=new a;this.addUniqueRowFormat("allowBreakAcrossPages",t,i,r),this.addUniqueRowFormat("isHeader",t,i,r),this.addUniqueRowFormat("height",t,i,r),this.addUniqueRowFormat("heightType",t,i,r),this.addUniqueRowFormat("gridBefore",t,i,r),this.addUniqueRowFormat("gridBeforeWidth",t,i,r),this.addUniqueRowFormat("gridBeforeWidthType",t,i,r),this.addUniqueRowFormat("gridAfter",t,i,r),this.addUniqueRowFormat("gridAfterWidth",t,i,r),this.addUniqueRowFormat("gridgridAfterWidth",t,i,r),this.addUniqueRowFormat("gridBeforeWidthType",t,i,r),this.addUniqueRowFormat("leftMargin",t,i,r),this.addUniqueRowFormat("rightMargin",t,i,r),this.addUniqueRowFormat("topMargin",t,i,r),this.addUniqueRowFormat("bottomMargin",t,i,r),this.addUniqueRowFormat("leftIndent",t,i,r),this.uniqueRowFormat=e.uniqueRowFormats.addUniqueFormat(r,e.uniqueFormatType)},e.prototype.addUniqueRowFormat=function(t,i,r,n){var o=l.getPropertyType(e.uniqueFormatType,t);t===i&&n.add(o,r)},e.getPropertyDefaultValue=function(e){var t=void 0;switch(e){case"allowBreakAcrossPages":t=!0;break;case"isHeader":t=!1;break;case"height":t=0;break;case"heightType":t="Auto";break;case"gridBefore":case"gridBeforeWidth":t=0;break;case"gridBeforeWidthType":t="Point";break;case"gridAfter":case"gridAfterWidth":t=0;break;case"gridAfterWidthType":t="Point";break;case"leftMargin":case"topMargin":case"bottomMargin":case"rightMargin":t=void 0;break;case"leftIndent":t=0}return t},e.prototype.containsMargins=function(){return!(sf.base.isNullOrUndefined(this.leftMargin)&&sf.base.isNullOrUndefined(this.rightMargin)&&sf.base.isNullOrUndefined(this.bottomMargin)&&sf.base.isNullOrUndefined(this.topMargin))},e.prototype.cloneFormat=function(){var t=new e;return t.allowBreakAcrossPages=this.allowBreakAcrossPages,t.heightType=this.heightType,t.height=this.height,t.isHeader=this.isHeader,t.gridBefore=this.gridBefore,t.gridBeforeWidth=this.gridBeforeWidth,t.gridBeforeWidthType=this.gridBeforeWidthType,t.gridAfter=this.gridAfter,t.gridAfterWidth=this.gridAfterWidth,t.gridAfterWidthType=this.gridAfterWidthType,t.leftMargin=this.leftMargin,t.rightMargin=this.rightMargin,t.topMargin=this.topMargin,t.bottomMargin=this.bottomMargin,t.leftIndent=this.leftIndent,this.revisions.length>0?t.removedIds=O.cloneRevisions(this.revisions):t.removedIds=this.removedIds.slice(),t},e.prototype.hasValue=function(e){if(!sf.base.isNullOrUndefined(this.uniqueRowFormat)){var t=l.getPropertyType(this.uniqueRowFormat.uniqueFormatType,e);return this.uniqueRowFormat.propertiesHash.containsKey(t)}return!1},e.prototype.copyFormat=function(e){sf.base.isNullOrUndefined(e)||(sf.base.isNullOrUndefined(e.uniqueRowFormat)||(this.allowBreakAcrossPages=e.allowBreakAcrossPages,this.isHeader=e.isHeader,this.heightType=e.heightType,this.height=e.height,this.gridBefore=e.gridBefore,this.gridBeforeWidth=e.gridBeforeWidth,this.gridBeforeWidthType=e.gridBeforeWidthType,this.gridAfter=e.gridAfter,this.gridAfterWidth=e.gridAfterWidth,this.gridAfterWidthType=e.gridAfterWidthType,this.leftMargin=e.leftMargin,this.topMargin=e.topMargin,this.rightMargin=e.rightMargin,this.bottomMargin=e.bottomMargin,this.leftIndent=e.leftIndent,this.revisions=e.revisions),sf.base.isNullOrUndefined(e.borders)||(this.borders=new u(this),this.borders.ownerBase=e,this.borders.copyFormat(e.borders)),e.revisions.length>0?this.removedIds=O.cloneRevisions(e.revisions):this.removedIds=e.removedIds.slice())},e.prototype.destroy=function(){sf.base.isNullOrUndefined(this.borders)||this.borders.destroy(),sf.base.isNullOrUndefined(this.uniqueRowFormat)||e.uniqueRowFormats.remove(this.uniqueRowFormat),this.beforeWidth=void 0,this.afterWidth=void 0,this.borders=void 0,this.uniqueRowFormat=void 0},e.clear=function(){this.uniqueRowFormats.clear()},e.uniqueRowFormats=new h,e.uniqueFormatType=6,e}(),O=function(){function e(e,t,i){this.author=null,this.date=null,this.range=[],this.revisionID="",this.isContentRemoved=!1,this.isTableRevision=!1,this.canSkipTableItems=!1,this.skipUnLinkElement=!1,this.author=t,this.date=i,this.owner=e}return e.prototype.handleAcceptReject=function(e){this.owner.selection.selectRevision(this);var t=this.owner.selection,i=t.start,r=t.end;t.start.isExistBefore(t.end)||(i=t.end,r=t.start);var n=t.getParagraphInfo(i);if(this.owner.editor.initHistory(e?"Accept Change":"Reject Change"),"Deletion"===this.revisionType?(n=t.getParagraphInfo(this.owner.selection.start),t.editPosition=this.owner.selection.getHierarchicalIndex(n.paragraph,n.offset.toString())):t.editPosition=this.owner.selection.getHierarchicalIndex(n.paragraph,n.offset.toString()),this.owner.editor.updateInsertPosition(),this.isContentRemoved=!1,this.canSkipTableItems=!1,this.skipUnLinkElement=!1,"Insertion"===this.revisionType||"Deletion"===this.revisionType||"MoveFrom"===this.revisionType||"MoveTo"===this.revisionType)for(var o=0;this.range.length>0&&(this.range[o]instanceof ge||this.range[o]instanceof P||this.range[o]instanceof C);){if(this.range[o]instanceof Ce&&e&&"Deletion"===this.revisionType){var s=this.range[o];this.owner.documentHelper.bookmarks.containsKey(s.name)&&this.owner.documentHelper.bookmarks.remove(s.name)}this.unlinkRangeItem(this.range[o],this,e)?o++:o=0}if(this.isTableRevision=!1,this.isContentRemoved){var a=t.getTextPosBasedOnLogicalIndex(t.editPosition);this.owner.selection.selectContent(a,!0),this.owner.editor.updateEndPosition()}else t.selectRange(i,r),this.owner.editor.updateHistoryPosition(r,!1);if(this.owner.editorHistory&&"BackSpace"!==this.owner.editorHistory.currentBaseHistoryInfo.action&&this.owner.editorHistory.currentBaseHistoryInfo.removedNodes.reverse(),this.owner.editorHistory){this.owner.trackChangesPane.isTrackingPageBreak&&(this.owner.editorHistory.currentBaseHistoryInfo.action="TrackingPageBreak");var l=this.owner.editorHistory;!l.currentHistoryInfo||"Accept All"!==l.currentHistoryInfo.action&&"Reject All"!==l.currentHistoryInfo.action||this.owner.documentHelper.blockToShift&&this.owner.documentHelper.layout.shiftLayoutedItems(!1),l.updateHistory()}this.owner.editor.reLayout(this.owner.selection),n.paragraph.isInHeaderFooter&&this.owner.editor.updateHeaderFooterWidget()},e.prototype.handleGroupAcceptReject=function(e){if(this.owner.trackChangesPane.tableRevisions.containsKey(this)){this.owner.editor.initComplexHistory(e?"Accept All":"Reject All");for(var t=this.owner.trackChangesPane.tableRevisions.get(this),i=0;i<t.length;i++)e?t[i].handleAcceptReject(!0):t[i].handleAcceptReject(!1);this.owner.editorHistory&&this.owner.editorHistory.updateComplexHistory()}},e.prototype.accept=function(){this.owner.documentHelper.isTrackedOnlyMode||(!this.owner.revisions.skipGroupAcceptReject&&this.range[0]instanceof C&&this.owner.trackChangesPane.tableRevisions.containsKey(this)?this.handleGroupAcceptReject(!0):this.handleAcceptReject(!0))},e.prototype.reject=function(){this.owner.documentHelper.isTrackedOnlyMode||(!this.owner.revisions.skipGroupAcceptReject&&this.range[0]instanceof C&&this.owner.trackChangesPane.tableRevisions.containsKey(this)?this.handleGroupAcceptReject(!1):this.handleAcceptReject(!1))},e.prototype.unlinkRangeItem=function(e,t,i){if(this.isTableRevision)return this.removeRangeRevisionForItem(e),0===t.range.length&&this.owner.revisions.remove(t),!1;var r=!sf.base.isNullOrUndefined(i)&&("MoveFrom"===t.revisionType||"Deletion"===t.revisionType)&&i||("Insertion"===t.revisionType||"MoveTo"===t.revisionType)&&!i;if(this.owner.selection.isTOC()){if(r)this.owner.editor.deleteSelectedContents(this.owner.selection,!0),0===t.range.length&&this.owner.revisions.remove(t),this.isContentRemoved=!0,this.owner.editorHistory.currentBaseHistoryInfo.action="BackSpace";else{for(;this.range.length>0;){var n=this.range[0];this.removeRangeRevisionForItem(n),0===t.range.length&&this.owner.revisions.remove(t)}this.owner.editor.addRemovedNodes(this.revisionID),this.owner.editorHistory.currentBaseHistoryInfo.action="AcceptTOC"}return!1}if(e instanceof ge&&!this.canSkipTableItems)if(r){if(this.skipeElementRemoval(e))return this.skipUnLinkElement=!0,!0;this.owner.editor.addRemovedNodes(e.clone())}else this.owner.editorHistory.currentBaseHistoryInfo.action="ClearRevisions",this.updateRevisionID();else if(!this.canSkipTableItems&&e instanceof P&&!r)this.owner.editorHistory.currentBaseHistoryInfo.action="ClearRevisions",this.updateRevisionID();else if(e instanceof C&&!r){this.isTableRevision=!0;var o=e.ownerBase.ownerTable,s=e.ownerBase;this.owner.editorHistory.currentBaseHistoryInfo.action="RemoveRowTrack",this.owner.editor.cloneTableToHistoryInfo(o)}if(r=r&&!this.canSkipTableItems,e instanceof ge&&r){var a=e.line.paragraph;this.removeRevisionItemsFromRange(e),this.removeItem(e),this.isContentRemoved=!0,this.owner.documentHelper.layout.reLayoutParagraph(a,0,0)}else if(e instanceof P&&r){if(this.isContentRemoved=!0,this.skipUnLinkElement=!1,this.removeRevisionItemsFromRange(e),1===t.range.length)this.owner.editor.deleteSelectedContents(this.owner.selection,!0);else{this.owner.editor.deleteSelectedContents(this.owner.selection,!0);var l=t.range.indexOf(e);for(t.range.splice(l,1);this.range.length>0;)this.removeRangeRevisionForItem(this.range[0])}this.owner.editorHistory.currentBaseHistoryInfo.action="BackSpace"}else if(e instanceof C&&r){o=e.ownerBase.ownerTable,s=e.ownerBase;this.removeRevisionItemsFromRange(e),this.owner.editorHistory.currentBaseHistoryInfo.action="DeleteCells",this.owner.editor.cloneTableToHistoryInfo(o),this.owner.editor.removeDeletedCellRevision(s),this.isContentRemoved=!0,o.removeChild(o.childWidgets.indexOf(s)),this.canSkipTableItems=!0,this.owner.editor.removeFieldInBlock(s,!0),this.owner.editor.removeFieldInBlock(s,void 0,!0),s.destroy(),0===o.childWidgets.length?(this.owner.selection.editPosition=this.owner.selection.getHierarchicalIndex(o,"0"),this.owner.editor.removeBlock(o),o.destroy()):this.owner.editor.updateTable(o)}return e instanceof C&&r||this.skipUnLinkElement||this.removeRangeRevisionForItem(e),0===t.range.length&&this.owner.revisions.remove(t),!1},e.prototype.updateRevisionID=function(){for(this.owner.editor.addRemovedNodes(this.revisionID);this.range.length>0;)this.removeRangeRevisionForItem(this.range[0])},e.prototype.removeRevisionItemsFromRange=function(e){if(e.revisions.length>0)for(var t=0;t<e.revisions.length;t++){var i=e.revisions[t];if(this.revisionID!==i.revisionID){var r=i.range.indexOf(e);e.revisions[t].range.splice(r,1)}0===i.range.length&&this.owner.revisions.remove(i)}},e.prototype.removeRangeRevisionForItem=function(e){var t=e.revisions.indexOf(this);if(t>=0){e.revisions.splice(t,1);var i=this.range.indexOf(e);this.range.splice(i,1)}},e.prototype.skipeElementRemoval=function(e){var t=e.paragraph;if(t.characterFormat.revisions.length>0)for(var i=0;i<t.characterFormat.revisions.length;i++){if(t.characterFormat.revisions[i].range.indexOf(e)>=0)return!0}return!1},e.prototype.removeRevisionFromRow=function(e){this.owner.editor.unlinkRangeFromRevision(e.rowFormat);for(var t=0;t<e.childWidgets.length;t++){var i=e.childWidgets[t];this.owner.editor.removeRevisionForCell(i,!1)}},e.prototype.removeItem=function(e){var t=e.line.paragraph;this.owner.editor.unLinkFieldCharacter(e);var i=e.line.children.indexOf(e);e.line.children.splice(i,1);var r=e.line.paragraph.floatingElements.indexOf(e);e.line.paragraph.floatingElements.splice(r,1);var n=e.line.paragraph.bodyWidget.floatingElements.indexOf(e);n>-1&&e.line.paragraph.bodyWidget.floatingElements.splice(n,1),this.owner.editor.removeEmptyLine(t)},e.prototype.canSkipCloning=function(){if(!sf.base.isNullOrUndefined(this.owner)&&this.owner.editorHistory&&this.owner.editorHistory.currentBaseHistoryInfo&&"DeleteCells"===this.owner.editorHistory.currentBaseHistoryInfo.action)return!0;return!1},e.prototype.clone=function(){if(this.canSkipCloning())return this;var t=new e(void 0,this.author,this.date);return t.revisionID=this.revisionID,t.revisionType=this.revisionType,t},e.cloneRevisions=function(e){for(var t=[],i=0;i<e.length;i++)t.push(e[i].revisionID);return t},e}(),T=function(){function e(e){this.changes=[],this.skipGroupAcceptReject=!1,this.owner=e}return e.prototype.get=function(e){if(e>=this.changes.length||e<0)throw new ReferenceError("Provided index is not within the range");return this.changes[e]},Object.defineProperty(e.prototype,"length",{get:function(){return this.changes.length},enumerable:!0,configurable:!0}),e.prototype.remove=function(e){sf.base.isNullOrUndefined(e)||this.changes.indexOf(e)<0||this.changes.splice(this.changes.indexOf(e),1)},e.prototype.acceptAll=function(){this.owner.isReadOnly||this.handleRevisionCollection(!0)},e.prototype.rejectAll=function(){this.owner.isReadOnly||this.handleRevisionCollection(!1)},e.prototype.handleRevisionCollection=function(e,t){this.skipGroupAcceptReject=!0;var i=this.owner.selection,r=i.start,n=i.end;i.start.isExistBefore(i.end)||(r=i.end,n=i.start),r=r.clone(),n=n.clone(),e?this.owner.editor.initComplexHistory("Accept All"):this.owner.editor.initComplexHistory("Reject All");for(var o=t||this.changes;o.length>0;)e?o[0].accept():o[0].reject(),t&&o.splice(0,1),this.owner.enableHeaderAndFooter&&this.owner.editor.updateHeaderFooterWidget();var s=i.getTextPosBasedOnLogicalIndex(i.editPosition);this.owner.selection.selectContent(s,!0),this.owner.editorHistory&&this.owner.editorHistory.updateComplexHistory(),this.owner.editor.reLayout(this.owner.selection,!1),this.skipGroupAcceptReject=!1},e.prototype.destroy=function(){this.changes=[]},e}(),P=function(){function e(e){this.uniqueCharacterFormat=void 0,this.ownerBase=void 0,this.baseCharStyle=void 0,this.removedIds=[],this.revisions=[],this.ownerBase=e}return Object.defineProperty(e.prototype,"bold",{get:function(){return this.getPropertyValue("bold")},set:function(e){this.setPropertyValue("bold",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"italic",{get:function(){return this.getPropertyValue("italic")},set:function(e){this.setPropertyValue("italic",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fontSize",{get:function(){return this.getPropertyValue("fontSize")},set:function(e){this.setPropertyValue("fontSize",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fontFamily",{get:function(){return this.getPropertyValue("fontFamily")},set:function(e){this.setPropertyValue("fontFamily",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"underline",{get:function(){return this.getPropertyValue("underline")},set:function(e){this.setPropertyValue("underline",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"strikethrough",{get:function(){return this.getPropertyValue("strikethrough")},set:function(e){this.setPropertyValue("strikethrough",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"baselineAlignment",{get:function(){return this.getPropertyValue("baselineAlignment")},set:function(e){this.setPropertyValue("baselineAlignment",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"highlightColor",{get:function(){return this.getPropertyValue("highlightColor")},set:function(e){this.setPropertyValue("highlightColor",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fontColor",{get:function(){return this.getPropertyValue("fontColor")},set:function(e){this.setPropertyValue("fontColor",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bidi",{get:function(){return this.getPropertyValue("bidi")},set:function(e){this.setPropertyValue("bidi",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"localeIdBidi",{get:function(){return this.getPropertyValue("localeIdBidi")},set:function(e){this.setPropertyValue("localeIdBidi",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"localeIdFarEast",{get:function(){return this.getPropertyValue("localeIdFarEast")},set:function(e){this.setPropertyValue("localeIdFarEast",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"localeIdAscii",{get:function(){return this.getPropertyValue("localeIdAscii")},set:function(e){this.setPropertyValue("localeIdAscii",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bdo",{get:function(){return this.getPropertyValue("bdo")},set:function(e){this.setPropertyValue("bdo",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"boldBidi",{get:function(){return this.getPropertyValue("boldBidi")},set:function(e){this.setPropertyValue("boldBidi",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"italicBidi",{get:function(){return this.getPropertyValue("italicBidi")},set:function(e){this.setPropertyValue("italicBidi",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fontSizeBidi",{get:function(){return this.getPropertyValue("fontSizeBidi")},set:function(e){this.setPropertyValue("fontSizeBidi",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fontFamilyBidi",{get:function(){return this.getPropertyValue("fontFamilyBidi")},set:function(e){this.setPropertyValue("fontFamilyBidi",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"allCaps",{get:function(){return this.getPropertyValue("allCaps")},set:function(e){this.setPropertyValue("allCaps",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"complexScript",{get:function(){return this.getPropertyValue("complexScript")},set:function(e){this.setPropertyValue("complexScript",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fontFamilyFarEast",{get:function(){return this.getPropertyValue("fontFamilyFarEast")},set:function(e){this.setPropertyValue("fontFamilyFarEast",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fontFamilyAscii",{get:function(){return this.getPropertyValue("fontFamilyAscii")},set:function(e){this.setPropertyValue("fontFamilyAscii",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fontFamilyNonFarEast",{get:function(){return this.getPropertyValue("fontFamilyNonFarEast")},set:function(e){this.setPropertyValue("fontFamilyNonFarEast",e)},enumerable:!0,configurable:!0}),e.prototype.getPropertyValue=function(t){if(this.hasValue(t)){var i=l.getPropertyType(e.uniqueFormatType,t);if(!sf.base.isNullOrUndefined(this.uniqueCharacterFormat)&&this.uniqueCharacterFormat.propertiesHash.containsKey(i))return this.uniqueCharacterFormat.propertiesHash.get(i)}else{var r=this.checkCharacterStyle(t);if(!sf.base.isNullOrUndefined(r))return r;if(!sf.base.isNullOrUndefined(this.baseCharStyle)){var n=this.ownerBase.paragraph,o=this.ownerBase.line;if(!sf.base.isNullOrUndefined(n)&&!sf.base.isNullOrUndefined(o))for(var s=o.children.length,a=0;a<s;a++){var h=this.ownerBase.line.children[a];if(h instanceof we){var d=h.text;if(d.startsWith("HYPERLINK"))-1!==d.indexOf("_Toc")&&(this.baseCharStyle=this.ownerBase.paragraph.paragraphFormat.baseStyle)}}}var c=this.checkBaseStyle(t);if(!sf.base.isNullOrUndefined(c))return c}return this.getDefaultValue(t)},e.prototype.getDefaultValue=function(t){var i=l.getPropertyType(e.uniqueFormatType,t),r=this.documentCharacterFormat();return sf.base.isNullOrUndefined(r)||sf.base.isNullOrUndefined(r.uniqueCharacterFormat)||!r.uniqueCharacterFormat.propertiesHash.containsKey(i)?e.getPropertyDefaultValue(t):r.uniqueCharacterFormat.propertiesHash.get(i)},e.prototype.documentCharacterFormat=function(){var e;return sf.base.isNullOrUndefined(this.ownerBase)||(sf.base.isNullOrUndefined(this.ownerBase.paragraph)||sf.base.isNullOrUndefined(this.ownerBase.paragraph.bodyWidget)?sf.base.isNullOrUndefined(this.ownerBase.bodyWidget)||(e=this.ownerBase.bodyWidget.page.documentHelper.characterFormat):e=this.ownerBase.paragraph.bodyWidget.page.documentHelper.characterFormat),e},e.prototype.checkBaseStyle=function(t){var i;for(sf.base.isNullOrUndefined(this.ownerBase)||(sf.base.isNullOrUndefined(this.ownerBase.paragraph)?this.ownerBase instanceof le&&!sf.base.isNullOrUndefined(this.ownerBase.paragraphFormat)?i=this.ownerBase.paragraphFormat.baseStyle:sf.base.isNullOrUndefined(this.ownerBase instanceof gt)||(i=this.ownerBase.basedOn):i=this.ownerBase.paragraph.paragraphFormat.baseStyle);!sf.base.isNullOrUndefined(i)&&!i.characterFormat.hasValue(t);)i=i.basedOn;if(!sf.base.isNullOrUndefined(i)){var r=l.getPropertyType(e.uniqueFormatType,t);return i.characterFormat.uniqueCharacterFormat.propertiesHash.get(r)}},e.prototype.checkCharacterStyle=function(t){var i=this.baseCharStyle;if(!sf.base.isNullOrUndefined(i))for(;!sf.base.isNullOrUndefined(i)&&"Default Paragraph Font"!==i.name;){if(i.characterFormat.hasValue(t)){var r=l.getPropertyType(e.uniqueFormatType,t);return i.characterFormat.uniqueCharacterFormat.propertiesHash.get(r)}i=i.basedOn}},e.prototype.setPropertyValue=function(t,i){if((sf.base.isNullOrUndefined(i)||""===i)&&(i=e.getPropertyDefaultValue(t)),sf.base.isNullOrUndefined(this.uniqueCharacterFormat))this.initializeUniqueCharacterFormat(t,i);else{var r=l.getPropertyType(this.uniqueCharacterFormat.uniqueFormatType,t);if(this.uniqueCharacterFormat.propertiesHash.containsKey(r)&&this.uniqueCharacterFormat.propertiesHash.get(r)===i)return;this.uniqueCharacterFormat=e.uniqueCharacterFormats.updateUniqueFormat(this.uniqueCharacterFormat,t,i)}},e.prototype.initializeUniqueCharacterFormat=function(t,i){var r=new a;this.addUniqueCharacterFormat("fontColor",t,i,r),this.addUniqueCharacterFormat("fontFamily",t,i,r),this.addUniqueCharacterFormat("fontSize",t,i,r),this.addUniqueCharacterFormat("bold",t,i,r),this.addUniqueCharacterFormat("italic",t,i,r),this.addUniqueCharacterFormat("underline",t,i,r),this.addUniqueCharacterFormat("strikethrough",t,i,r),this.addUniqueCharacterFormat("baselineAlignment",t,i,r),this.addUniqueCharacterFormat("highlightColor",t,i,r),this.addUniqueCharacterFormat("styleName",t,i,r),this.addUniqueCharacterFormat("bidi",t,i,r),this.addUniqueCharacterFormat("bdo",t,i,r),this.addUniqueCharacterFormat("fontFamilyBidi",t,i,r),this.addUniqueCharacterFormat("fontSizeBidi",t,i,r),this.addUniqueCharacterFormat("boldBidi",t,i,r),this.addUniqueCharacterFormat("italicBidi",t,i,r),this.addUniqueCharacterFormat("allCaps",t,i,r),this.addUniqueCharacterFormat("localeIdAscii",t,i,r),this.addUniqueCharacterFormat("localeIdFarEast",t,i,r),this.addUniqueCharacterFormat("localeIdBidi",t,i,r),this.addUniqueCharacterFormat("fontFamilyFarEast",t,i,r),this.addUniqueCharacterFormat("fontFamilyAscii",t,i,r),this.addUniqueCharacterFormat("fontFamilyNonFarEast",t,i,r),this.addUniqueCharacterFormat("complexScript",t,i,r),this.uniqueCharacterFormat=e.uniqueCharacterFormats.addUniqueFormat(r,e.uniqueFormatType)},e.prototype.addUniqueCharacterFormat=function(t,i,r,n){var o=l.getPropertyType(e.uniqueFormatType,t);t===i&&n.add(o,r)},e.getPropertyDefaultValue=function(e){var t=void 0;switch(e){case"bold":case"italic":t=!1;break;case"fontSize":t=11;break;case"underline":case"strikethrough":t="None";break;case"baselineAlignment":t="Normal";break;case"highlightColor":t="NoColor";break;case"fontColor":t="#00000000";break;case"fontFamily":t="Calibri";break;case"styleName":t="Default Paragraph Font";break;case"bidi":t=!1;break;case"bdo":t="None";break;case"boldBidi":case"italicBidi":t=!1;break;case"fontSizeBidi":t=11;break;case"fontFamilyBidi":t="Calibri";break;case"allCaps":t=!1;break;case"localeIdAscii":case"localeIdFarEast":case"localeIdBidi":t=0;break;case"complexScript":t=!1;break;case"fontFamilyFarEast":case"fontFamilyAscii":case"fontFamilyNonFarEast":t=void 0}return t},e.prototype.isEqualFormat=function(e){return this.fontSize===e.fontSize&&this.fontFamily===e.fontFamily&&this.bold===e.bold&&this.italic===e.italic&&this.baselineAlignment===e.baselineAlignment&&this.underline===e.underline&&this.fontColor===e.fontColor&&this.strikethrough===e.strikethrough&&this.highlightColor===e.highlightColor&&this.bidi===e.bidi&&this.bdo===e.bdo&&this.allCaps===e.allCaps&&this.localeIdBidi===e.localeIdBidi&&this.localeIdAscii===e.localeIdAscii&&this.localeIdFarEast===e.localeIdFarEast&&this.complexScript===e.complexScript&&this.fontFamilyAscii===e.fontFamilyAscii&&this.fontFamilyBidi===e.fontFamilyBidi&&this.fontFamilyFarEast===e.fontFamilyFarEast&&this.fontFamilyNonFarEast===e.fontFamilyNonFarEast},e.prototype.isSameFormat=function(e){return this.baseCharStyle===e.baseCharStyle&&this.uniqueCharacterFormat===e.uniqueCharacterFormat},e.prototype.cloneFormat=function(){var t=new e(void 0);return t.uniqueCharacterFormat=this.uniqueCharacterFormat,t.baseCharStyle=this.baseCharStyle,this.revisions.length>0?t.removedIds=O.cloneRevisions(this.revisions):t.removedIds=this.removedIds.slice(),t},e.prototype.hasValue=function(e){if(!sf.base.isNullOrUndefined(this.uniqueCharacterFormat)&&!sf.base.isNullOrUndefined(this.uniqueCharacterFormat.propertiesHash)){var t=l.getPropertyType(this.uniqueCharacterFormat.uniqueFormatType,e);return this.uniqueCharacterFormat.propertiesHash.containsKey(t)}return!1},e.prototype.clearFormat=function(){sf.base.isNullOrUndefined(this.uniqueCharacterFormat)||0!==this.uniqueCharacterFormat.referenceCount||e.uniqueCharacterFormats.remove(this.uniqueCharacterFormat),this.uniqueCharacterFormat=void 0,this.baseCharStyle=void 0},e.prototype.destroy=function(){this.clearFormat()},e.prototype.copyFormat=function(e){sf.base.isNullOrUndefined(e)||(!sf.base.isNullOrUndefined(e.uniqueCharacterFormat)&&e.uniqueCharacterFormat.propertiesHash&&this.updateUniqueCharacterFormat(e),sf.base.isNullOrUndefined(e.baseCharStyle)||(this.baseCharStyle=e.baseCharStyle),e.revisions.length>0?this.removedIds=O.cloneRevisions(e.revisions):this.removedIds=e.removedIds.slice())},e.prototype.updateUniqueCharacterFormat=function(t){var i=void 0;this.uniqueCharacterFormat&&(i=this.uniqueCharacterFormat.mergeProperties(t.uniqueCharacterFormat),0===this.uniqueCharacterFormat.referenceCount&&(e.uniqueCharacterFormats.remove(this.uniqueCharacterFormat),this.uniqueCharacterFormat=void 0)),this.uniqueCharacterFormat=new l(e.uniqueFormatType),sf.base.isNullOrUndefined(i)&&(i=this.uniqueCharacterFormat.mergeProperties(t.uniqueCharacterFormat)),this.uniqueCharacterFormat=e.uniqueCharacterFormats.addUniqueFormat(i,e.uniqueFormatType)},e.clear=function(){this.uniqueCharacterFormats.clear()},e.prototype.applyStyle=function(e){this.baseCharStyle=e},e.prototype.getValue=function(e){return this.hasValue(e)?this.getPropertyValue(e):void 0},e.prototype.mergeFormat=function(e){sf.base.isNullOrUndefined(this.getValue("bold"))&&(this.bold=e.getValue("bold")),sf.base.isNullOrUndefined(this.getValue("italic"))&&(this.italic=e.getValue("italic")),sf.base.isNullOrUndefined(this.getValue("fontSize"))&&(this.fontSize=e.getValue("fontSize")),sf.base.isNullOrUndefined(this.getValue("fontFamily"))&&(this.fontFamily=e.getValue("fontFamily")),sf.base.isNullOrUndefined(this.getValue("underline"))&&(this.underline=e.getValue("underline")),sf.base.isNullOrUndefined(this.getValue("strikethrough"))&&(this.strikethrough=e.getValue("strikethrough")),sf.base.isNullOrUndefined(this.getValue("baselineAlignment"))&&(this.baselineAlignment=e.getValue("baselineAlignment")),sf.base.isNullOrUndefined(this.getValue("highlightColor"))&&(this.highlightColor=e.getValue("highlightColor")),sf.base.isNullOrUndefined(this.getValue("fontColor"))&&(this.fontColor=e.getValue("fontColor")),sf.base.isNullOrUndefined(this.getValue("bidi"))&&(this.bidi=e.getValue("bidi")),sf.base.isNullOrUndefined(this.getValue("bdo"))&&(this.bdo=e.getValue("bdo")),sf.base.isNullOrUndefined(this.getValue("allCaps"))&&(this.allCaps=e.getValue("allCaps")),sf.base.isNullOrUndefined(this.getValue("localeIdBidi"))&&(this.localeIdBidi=e.getValue("localeIdBidi")),sf.base.isNullOrUndefined(this.getValue("localeIdAscii"))&&(this.localeIdAscii=e.getValue("localeIdAscii")),sf.base.isNullOrUndefined(this.getValue("localeIdFarEast"))&&(this.localeIdFarEast=e.getValue("localeIdFarEast")),sf.base.isNullOrUndefined(this.getValue("complexScript"))&&(this.complexScript=e.getValue("complexScript")),sf.base.isNullOrUndefined(this.getValue("fontFamilyAscii"))&&(this.fontFamilyAscii=e.getValue("fontFamilyAscii")),sf.base.isNullOrUndefined(this.getValue("fontFamilyBidi"))&&(this.fontFamilyBidi=e.getValue("fontFamilyBidi")),sf.base.isNullOrUndefined(this.getValue("fontFamilyFarEast"))&&(this.fontFamilyFarEast=e.getValue("fontFamilyFarEast")),sf.base.isNullOrUndefined(this.getValue("fontFamilyNonFarEast"))&&(this.fontFamilyNonFarEast=e.getValue("fontFamilyNonFarEast"))},e.prototype.hasValueWithParent=function(e){var t=this.hasValue(e);!t&&!sf.base.isNullOrUndefined(this.baseCharStyle)&&this.baseCharStyle instanceof ft&&(t=this.baseCharStyle.characterFormat.hasValue(e));var i=this.documentCharacterFormat();return t||sf.base.isNullOrUndefined(i)||(t=i.hasValue(e)),t},e.uniqueCharacterFormats=new h,e.uniqueFormatType=2,e}(),A=function(){function e(e){this.uniqueListLevel=void 0,this.paragraphFormat=void 0,this.characterFormat=void 0,this.ownerBase=e,this.characterFormat=new P(void 0),this.paragraphFormat=new ct(void 0)}return Object.defineProperty(e.prototype,"listLevelPattern",{get:function(){return this.getPropertyValue("listLevelPattern")},set:function(e){this.setPropertyValue("listLevelPattern",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"followCharacter",{get:function(){return this.getPropertyValue("followCharacter")},set:function(e){this.setPropertyValue("followCharacter",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"startAt",{get:function(){return this.getPropertyValue("startAt")},set:function(e){this.setPropertyValue("startAt",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"numberFormat",{get:function(){return this.getPropertyValue("numberFormat")},set:function(e){this.setPropertyValue("numberFormat",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"restartLevel",{get:function(){return this.getPropertyValue("restartLevel")},set:function(e){this.setPropertyValue("restartLevel",e)},enumerable:!0,configurable:!0}),e.prototype.getPropertyValue=function(t){var i=l.getPropertyType(e.uniqueFormatType,t);return!sf.base.isNullOrUndefined(this.uniqueListLevel)&&this.uniqueListLevel.propertiesHash.containsKey(i)?this.uniqueListLevel.propertiesHash.get(i):e.getPropertyDefaultValue(t)},e.prototype.setPropertyValue=function(t,i){if((sf.base.isNullOrUndefined(i)||""===i)&&(i=e.getPropertyDefaultValue(t)),sf.base.isNullOrUndefined(this.uniqueListLevel))this.initializeUniqueWListLevel(t,i);else{var r=l.getPropertyType(this.uniqueListLevel.uniqueFormatType,t);if(this.uniqueListLevel.propertiesHash.containsKey(r)&&this.uniqueListLevel.propertiesHash.get(r)===i)return;this.uniqueListLevel=e.uniqueListLevels.updateUniqueFormat(this.uniqueListLevel,t,i)}},e.prototype.initializeUniqueWListLevel=function(t,i){var r=new a;this.addUniqueWListLevel("listLevelPattern",t,i,r),this.addUniqueWListLevel("startAt",t,i,r),this.addUniqueWListLevel("followCharacter",t,i,r),this.addUniqueWListLevel("numberFormat",t,i,r),this.addUniqueWListLevel("restartLevel",t,i,r),this.uniqueListLevel=e.uniqueListLevels.addUniqueFormat(r,e.uniqueFormatType)},e.prototype.addUniqueWListLevel=function(t,i,r,n){var o;o=l.getPropertyType(e.uniqueFormatType,t),t===i?n.add(o,r):n.add(o,e.getPropertyDefaultValue(t))},e.getPropertyDefaultValue=function(e){var t=void 0;switch(e){case"listLevelPattern":t="Arabic";break;case"startAt":t=0;break;case"followCharacter":t="Tab";break;case"numberFormat":t="";break;case"restartLevel":t=0}return t},e.prototype.destroy=function(){sf.base.isNullOrUndefined(this.characterFormat)||this.characterFormat.destroy(),sf.base.isNullOrUndefined(this.paragraphFormat)||this.paragraphFormat.destroy(),sf.base.isNullOrUndefined(this.uniqueListLevel)||e.uniqueListLevels.remove(this.uniqueListLevel),this.uniqueListLevel=void 0,this.characterFormat=void 0,this.paragraphFormat=void 0},e.clear=function(){this.uniqueListLevels.clear()},e.prototype.clone=function(t){var i=new e(t);return i.paragraphFormat=this.paragraphFormat.cloneFormat(),i.characterFormat=this.characterFormat.cloneFormat(),this.uniqueListLevel&&(i.uniqueListLevel=this.uniqueListLevel,i.uniqueListLevel.referenceCount++),i},e.dotBullet=String.fromCharCode(61623),e.squareBullet=String.fromCharCode(61607),e.arrowBullet=String.fromCharCode(10148),e.circleBullet=String.fromCharCode(61551)+String.fromCharCode(32),e.uniqueListLevels=new h,e.uniqueFormatType=9,e}(),L=function(){function t(e){this.islayoutFootnote=!1,this.allowLayout=!0,this.isReplaceAll=!1,this.footHeight=0,this.existFootnoteHeight=0,this.isfootMove=!1,this.footnoteHeight=0,this.endNoteHeight=0,this.isTableFootNote=!1,this.isRelayout=!1,this.isRelayoutneed=!1,this.isOverlapFloatTable=!1,this.isInitialLoad=!0,this.fieldBegin=void 0,this.maxTextHeight=0,this.maxBaseline=0,this.maxTextBaseline=0,this.isFieldCode=!1,this.isRtlFieldCode=!1,this.isRTLLayout=!1,this.currentCell=void 0,this.isFootnoteContentChanged=!1,this.isEndnoteContentChanged=!1,this.keepWithNext=!1,this.is2013Justification=!1,this.nextElementToLayout=void 0,this.isLayoutWhole=!1,this.isBidiReLayout=!1,this.defaultTabWidthPixel=48,this.isRelayoutFootnote=!1,this.isRelayoutOverlap=!1,this.isWrapText=!1,this.isYPositionUpdated=!1,this.isXPositionUpdated=!1,this.hasFloatingElement=!1,this.isFootNoteLayoutStart=!1,this.wrapPosition=[],this.shiftedFloatingItemsFromTable=[],this.isDocumentContainsRtl=!1,this.layoutedFootnoteElement=[],this.documentHelper=e}return t.prototype.isSameStyle=function(e,t){var i=void 0;if(t?e.nextWidget instanceof le&&(i=e.nextWidget):e.previousWidget instanceof le&&(i=e.previousWidget),sf.base.isNullOrUndefined(i)){if(e.isInsideTable)if(0===e.index)i=this.updateFirstParagraphSpacingBasedOnContextualSpacing(e,t);else if(e.index===e.associatedCell.childWidgets.length-1&&(i=this.updateLastParagraphSpacingBasedOnContextualSpacing(e))===e)return!0;if(sf.base.isNullOrUndefined(i))return!1}if(i instanceof le&&e.paragraphFormat.baseStyle===i.paragraphFormat.baseStyle){if(e.paragraphFormat.listFormat.listId>=0&&i.paragraphFormat.listFormat.listId>=0&&!e.paragraphFormat.contextualSpacing){if(t&&e.paragraphFormat.spaceAfterAuto)return!0;if(!t&&e.paragraphFormat.spaceBeforeAuto)return!0}return e.paragraphFormat.contextualSpacing}return!1},t.prototype.updateFirstParagraphSpacingBasedOnContextualSpacing=function(e,t){var i,r=e.associatedCell,n=r.ownerRow,o=n.ownerTable;if(i=t?sf.base.isNullOrUndefined(e.nextRenderedWidget)?sf.base.isNullOrUndefined(r.nextRenderedWidget)?void 0:r.nextRenderedWidget.firstChild:e.nextRenderedWidget:sf.base.isNullOrUndefined(e.previousRenderedWidget)?sf.base.isNullOrUndefined(r.previousRenderedWidget)?void 0:r.previousRenderedWidget.firstChild:e.previousRenderedWidget,0===r.index&&0===e.index){if(0!==n.index)return i;if(!o.isInsideTable||0!=o.index)return o.previousRenderedWidget;i=this.checkOwnerTablePrevItem(o,e)}else if(0===e.index&&!t){var s=n.childWidgets[r.index-1];if(s.childWidgets[s.childWidgets.length-1]instanceof de&&"Normal"===e.paragraphFormat.baseStyle.name&&e.paragraphFormat.listFormat.listId<0)return e}return i},t.prototype.updateLastParagraphSpacingBasedOnContextualSpacing=function(e){var t,i=e.associatedCell,r=i.ownerRow;if(i.index===r.childWidgets.length-1&&e.index===i.childWidgets.length-1){if("Normal"===e.paragraphFormat.baseStyle.name&&e.paragraphFormat.listFormat.listId<0)return e}else if(e.index===i.childWidgets.length-1){for(t=r.childWidgets[i.index+1].firstChild;t instanceof de;)t=t.childWidgets[0].childWidgets[0].childWidgets[0]}return t},t.prototype.checkOwnerTablePrevItem=function(e,t){var i=e.associatedCell.ownerRow;if(i.index>0){if("Normal"===t.paragraphFormat.baseStyle.name&&t.paragraphFormat.listFormat.listId<0)return t}else{if(!i.ownerTable.isInsideTable||0!==i.ownerTable.index)return i.ownerTable.previousRenderedWidget;this.checkOwnerTablePrevItem(i.ownerTable,t)}},Object.defineProperty(t.prototype,"viewer",{get:function(){return this.documentHelper.owner.viewer},enumerable:!0,configurable:!0}),t.prototype.layout=function(){},t.prototype.destroy=function(){this.documentHelper=void 0,this.value=void 0,this.allowLayout=void 0,this.isInitialLoad=void 0,this.fieldBegin=void 0,this.maxTextHeight=void 0,this.maxBaseline=void 0,this.maxTextBaseline=void 0,this.isFieldCode=void 0,this.footnoteHeight=void 0},t.prototype.layoutItems=function(e,t){for(var i,r=this,n=0,o=0,s=0;s<e.length;s++){var a=e[s];this.viewer.columnLayoutArea.setColumns(a.sectionFormat);var l=this.documentHelper.pages[this.documentHelper.pages.length-1];if(s>0&&(e[s-1].lastChild.isEndsWithPageBreak||e[s-1].lastChild.isEndsWithColumnBreak)&&0===l.bodyWidgets[0].childWidgets.length&&(this.documentHelper.pages.splice(this.documentHelper.pages.length-1,1),l=this.documentHelper.pages[this.documentHelper.pages.length-1]),0===s||sf.base.isNullOrUndefined(a.sectionFormat.breakCode)||"NewPage"===a.sectionFormat.breakCode||n!==a.sectionFormat.pageHeight||o!==a.sectionFormat.pageWidth||a.sectionFormat.columns.length>1||s-1>=0&&e[s-1].sectionFormat.columns.length>1||l.bodyWidgets[l.bodyWidgets.length-1].lastChild.isEndsWithPageBreak)i=this.viewer.createNewPage(a);else{var h=this.documentHelper.viewer.clientActiveArea.y,d=this.documentHelper.viewer.clientActiveArea.height;(i=l).bodyWidgets.push(a),i.bodyWidgets[i.bodyWidgets.length-1].page=i,this.documentHelper.viewer.updateClientArea(a,i),this.documentHelper.viewer.clientActiveArea.y=h,this.documentHelper.viewer.clientActiveArea.height=d}if(n=a.sectionFormat.pageHeight,o=a.sectionFormat.pageWidth,this.addBodyWidget(this.viewer.clientActiveArea,a),this.documentHelper.pages.length>1){for(var c=0,p=0;p<this.documentHelper.pages.length;p++){var u=this.documentHelper.pages[p];if(u.sectionIndex>a.index||u===i)break;c++}c<this.documentHelper.pages.length-1&&this.documentHelper.insertPage(c,i)}this.layoutSection(a,0)}t||this.layoutComments(this.documentHelper.comments),this.updateFieldElements(),"Pages"===this.documentHelper.owner.layoutType&&this.layoutEndNoteElement(),setTimeout((function(){r.documentHelper&&(r.documentHelper.isScrollHandler=!0,r.documentHelper.owner.isSpellCheck&&r.documentHelper.owner.spellChecker.enableOptimizedSpellCheck&&(r.documentHelper.triggerElementsOnLoading=!0),r.documentHelper.clearContent(),r.viewer.updateScrollBars(),sf.base.isNullOrUndefined(r.documentHelper.owner.selection)||r.documentHelper.owner.selection.updateCaretPosition(),r.documentHelper.isScrollHandler=!1,r.isInitialLoad=!1)}),50)},t.prototype.layoutComments=function(e){sf.base.isNullOrUndefined(e)},t.prototype.layoutSection=function(e,t){var i,r,n,o=e.firstChild;do{o instanceof de&&"Auto"===o.tableFormat.preferredWidthType&&!o.tableFormat.allowAutoFit&&o.calculateGrid(),this.viewer.updateClientAreaForBlock(o,!0,void 0,!0);o.containerWidget.indexInOwner;i=this.layoutBlock(o,t),t=0,this.viewer.updateClientAreaForBlock(o,!1),r=o,o=i,(sf.base.isNullOrUndefined(o)||(o.bodyWidget&&o.bodyWidget.page)!==(r.bodyWidget&&r.bodyWidget.page))&&r.bodyWidget.page.footnoteWidget&&this.layoutfootNote(r.bodyWidget.page.footnoteWidget)}while(o);for((o=e.firstChild)&&o.bodyWidget&&o.bodyWidget.page&&(n=o.bodyWidget.page);n;)n.footnoteWidget?(this.layoutfootNote(n.footnoteWidget),n=n.nextPage):n=n.nextPage;n=void 0,o=void 0},t.prototype.layoutHeaderFooter=function(e,t,i){var r=t.getCurrentPageHeaderFooter(e,!0);if(r){var n=r;sf.base.isNullOrUndefined(r.page)&&(r.page=i,r.height=0,this.clearBlockWidget(r.childWidgets,!0,!0,!0),t.updateHFClientArea(e.sectionFormat,!0),this.layoutHeaderFooterItems(t,r)),(r=n.clone()).parentHeaderFooter=n,this.clearBlockWidget(r.childWidgets,!0,!0,!0);var o=r;o.page=i,o.height=0,this.updateRevisionsToHeaderFooter(o,i),t.updateHFClientArea(e.sectionFormat,!0),i.headerWidget=this.layoutHeaderFooterItems(t,o),o.parentHeaderFooter=o,e.sectionFormat.topMargin<i.boundingRectangle.bottom&&i.headerWidget.floatingElements.length>0&&(i.headerWidget=this.shiftItemsForVerticalAlignment(i.headerWidget))}if(r=t.getCurrentPageHeaderFooter(e,!1)){n=r;sf.base.isNullOrUndefined(r.page)&&(r.page=i,r.height=0,this.clearBlockWidget(r.childWidgets,!0,!0,!0),t.updateHFClientArea(e.sectionFormat,!1),this.layoutHeaderFooterItems(t,r)),(r=n.clone()).parentHeaderFooter=n,this.clearBlockWidget(r.childWidgets,!0,!0,!0);var s=r;s.page=i,s.height=0,t.updateHFClientArea(e.sectionFormat,!1),this.updateRevisionsToHeaderFooter(s,i),i.footerWidget=this.layoutHeaderFooterItems(t,s)}},t.prototype.shiftItemsForVerticalAlignment=function(e){for(var t=e.floatingElements,i=0;i<t.length;i++){var r=t[i],n=r.verticalOrigin,o=r.paragraph;if("Margin"===n&&!o.isInsideTable){var s=r.verticalPosition;if(0!=s){var a=(s+=this.viewer.clientActiveArea.y)-r.y;if(r.y=s,r instanceof Ee)for(var l=0;l<r.textFrame.childWidgets.length;l++){var h=r.textFrame.childWidgets[l];h instanceof le&&(h.y=h.y+a)}}}}return e},t.prototype.updateHeaderFooterToParent=function(e){var t=e.page.sectionIndex,i=this.viewer.getHeaderFooter(e.headerFooterType),r=e.clone();this.documentHelper.headersFooters[t][i]=r;for(var n=0;n<r.childWidgets.length;n++){var o=r.childWidgets[n];o instanceof de&&this.clearTableWidget(o,!1,!0)}return r},t.prototype.updateRevisionsToHeaderFooter=function(e,t){var i=e.childWidgets;if(e instanceof oe&&i.length>0)for(var r=0;r<i.length;r++)if(i[r].childWidgets.length>0)for(var n=i[r].childWidgets,o=0;o<n.length;o++){var s=n[o].children;if(s)for(var a=0;a<s.length;a++)if(s[a].removedIds.length>0)for(var l=s[a].removedIds,h=0;h<l.length;h++){var d=this.documentHelper.revisionsInternal.get(l[h]);s[a].revisions[h]=d,this.updateRevisionRange(d,t)}}},t.prototype.updateRevisionRange=function(e,t){for(var i=0;i<e.range.length;i++){var r=e.range[i];r.line.paragraph.bodyWidget.page||(r.line.paragraph.bodyWidget.page=t)}},t.prototype.linkFieldInHeaderFooter=function(e){var t=e.firstChild;do{t instanceof le?this.linkFieldInParagraph(t):this.linkFieldInTable(t)}while(t=t.nextWidget)},t.prototype.linkFieldInParagraph=function(e){for(var t=0;t<e.childWidgets.length;t++)for(var i=e.childWidgets[t],r=0;r<i.children.length;r++){var n=i.children[r];if(n instanceof fe&&(0!==n.fieldType||0===n.fieldType&&-1===this.documentHelper.fields.indexOf(n))&&n.linkFieldCharacter(this.documentHelper),n instanceof Ie&&n.fieldBegin!==n.previousElement.fieldBegin&&(n.fieldBegin=n.previousElement.fieldBegin),n instanceof Ee){var o=n.textFrame.firstChild;if(o)do{o instanceof le?this.linkFieldInParagraph(o):this.linkFieldInTable(o)}while(o=o.nextWidget)}}},t.prototype.linkFieldInTable=function(e){for(var t=0;t<e.childWidgets.length;t++)for(var i=e.childWidgets[t],r=0;r<i.childWidgets.length;r++)for(var n=i.childWidgets[r],o=0;o<n.childWidgets.length;o++){var s=n.childWidgets[o];s instanceof le?this.linkFieldInParagraph(s):this.linkFieldInTable(s)}},t.prototype.layoutHeaderFooterItems=function(e,t){if(this.viewer.updateClientAreaLocation(t,e.clientActiveArea),0===t.childWidgets.length){var i=new le,r=new ue(i);i.childWidgets.push(r),t.childWidgets.push(i),i.containerWidget=t}this.linkFieldInHeaderFooter(t);for(var n=0;n<t.childWidgets.length;n++){var o=t.childWidgets[n];o instanceof de&&"Auto"===o.tableFormat.preferredWidthType&&!o.tableFormat.allowAutoFit&&!o.isGridUpdated&&o.calculateGrid(),e.updateClientAreaForBlock(o,!0),this.layoutBlock(o,0),e.updateClientAreaForBlock(o,!1)}var s=t.headerFooterType;return"OddFooter"!==s&&"EvenFooter"!==s&&"FirstPageFooter"!==s||this.shiftChildLocation(e.clientArea.y-e.clientActiveArea.y,t),t},t.prototype.shiftChildLocation=function(e,t){var i=t.y+e,r=t.page.boundingRectangle.height-t.page.boundingRectangle.height/100*40;e=(i=Math.max(i,r))-t.y;for(var n=t.y=i,o=0;o<t.childWidgets.length;o++){var s=t.childWidgets[o];if(s instanceof le){s.x=s.x,s.y=0===o?s.y+e:n,n+=s.height;for(var a=0;a<s.childWidgets.length;a++)for(var l=s.childWidgets[a],h=0;h<l.children.length;h++){var d=l.children[h];if(d instanceof De&&"Inline"!==d.textWrappingStyle){if("Paragraph"===d.verticalOrigin||"Line"===d.verticalOrigin)d.y=s.y+d.verticalPosition;else{var c=this.getFloatingItemPoints(d);d.y=c.y}if(d instanceof Ee){var p=d.textFrame.marginTop;this.updateChildLocationForCellOrShape(d.y+p,d)}}}}else this.shiftChildLocationForTableWidget(s,e),n+=s.height}},t.prototype.shiftChildLocationForTableWidget=function(e,t){e.y=e.y+t;for(var i=0;i<e.childWidgets.length;i++){var r=e.childWidgets[i];r instanceof ce&&this.shiftChildLocationForTableRowWidget(r,t)}},t.prototype.shiftChildLocationForTableRowWidget=function(e,t){e.y=e.y+t;for(var i=0;i<e.childWidgets.length;i++)this.shiftChildLocationForTableCellWidget(e.childWidgets[i],t)},t.prototype.shiftChildLocationForTableCellWidget=function(e,t){e.y=e.y+t;for(var i=0;i<e.childWidgets.length;i++)e.childWidgets[i]instanceof le?(e.childWidgets[i].x=e.childWidgets[i].x,e.childWidgets[i].y=e.childWidgets[i].y+t):this.shiftChildLocationForTableWidget(e.childWidgets[i],t)},t.prototype.layoutBlock=function(e,t){var i;if(e instanceof le){e.splitTextRangeByScriptType(0),e.splitLtrAndRtlText(0),e.combineconsecutiveRTL(0),i=this.layoutParagraph(e,t);var r=this.checkAndRelayoutPreviousOverlappingBlock(e);r&&(i=r)}else i=this.layoutTable(e,t),this.checkAndRelayoutPreviousOverlappingBlock(e),this.updateTableYPositionBasedonTextWrap(i);return i.nextRenderedWidget},t.prototype.updateTableYPositionBasedonTextWrap=function(e){var t=this;if(!sf.base.isNullOrUndefined(e.bodyWidget)){var i=e.y,r=new $(e.x,e.y,e.width,e.height);e.bodyWidget.floatingElements.forEach((function(n){if(n instanceof Ee&&!n.paragraph.isInsideTable){var o=new $(n.x,n.y,n.width,n.height);if(("TopAndBottom"===n.textWrappingStyle||"Square"===n.textWrappingStyle)&&r.isIntersecting(o)){e.y=n.y+n.height+n.distanceBottom,t.updateChildLocationForTable(e.y,e);var s=e.y-i;t.viewer.cutFromTop(t.viewer.clientActiveArea.y+s)}}}))}},t.prototype.checkAndRelayoutPreviousOverlappingBlock=function(e){if(!(e.containerWidget instanceof ze||this.isRelayoutOverlap)){var t=e.previousWidget;if(e instanceof le)if(e.floatingElements.length>0)for(var i=0;i<e.floatingElements.length;i++){var r=e.floatingElements[i];if("InFrontOfText"!==r.textWrappingStyle&&"Behind"!==r.textWrappingStyle&&"Inline"!==r.textWrappingStyle){for(var n=new $(r.x,r.y,r.width,r.height);t;){if(t instanceof le){var o=new $(t.x,t.y,t.width,t.height);n.isIntersecting(o)&&this.startOverlapWidget!==t&&(this.startOverlapWidget=t,this.endOverlapWidget=e)}t=t.previousWidget}t=e.previousWidget}}else{var s=e.getSplitWidgets();if(s)return s[s.length-1]}else{var a=e;if(!a.wrapTextAround)return a;for(var l=new $(a.x,a.y,a.getTableCellWidth(),a.height);t;){if(t instanceof le){var h=new $(t.x,t.y,t.width,t.height);l.isIntersecting(h)&&this.startOverlapWidget!==t&&(this.startOverlapWidget=t,this.endOverlapWidget=e)}t=t.previousWidget}t=e.previousWidget}this.startOverlapWidget&&(this.isRelayoutOverlap=!0,this.layoutStartEndBlocks(this.startOverlapWidget,e),this.isRelayoutOverlap=!1),this.startOverlapWidget=void 0,this.endOverlapWidget=void 0}return e},t.prototype.addParagraphWidget=function(e,t){if(!t.isEmpty()||sf.base.isNullOrUndefined(t.paragraphFormat)||"Center"!==t.paragraphFormat.textAlignment&&"Right"!==t.paragraphFormat.textAlignment||-1!==t.paragraphFormat.listFormat.listId)this.viewer.clientActiveArea.width<=0&&this.viewer instanceof Z?t.x=this.previousPara:(t.x=e.x,this.previousPara=t.x),t.width=e.width,t.y=e.y,t.clientX=void 0;else{var i=this.documentHelper.textHelper.getParagraphMarkWidth(t.characterFormat);t.clientX=e.x;var r=e.x;"Center"===t.paragraphFormat.textAlignment?r+=(e.width-i)/2:r+=e.width-i,t.width=i,t.x=r,t.y=e.y}return t},t.prototype.addLineWidget=function(e){var t=void 0;return(t=new ue(e)).width=e.width,e.childWidgets.push(t),t.paragraph=e,t},t.prototype.isFirstElementWithPageBreak=function(e){var t=!1;if(this.viewer instanceof X){var i=e.childWidgets[0];if(i)for(var r=i.children[0];r;){if(!(r instanceof Ce&&r.name.indexOf("_")>=0)){r instanceof we&&("\f"===r.text||r.text===String.fromCharCode(14))&&(t=!0);break}r=r.nextElement}}return t},t.prototype.layoutfootNote=function(e){if("Pages"===this.documentHelper.owner.layoutType){var t=this.viewer.clientActiveArea.clone(),i=this.viewer.clientArea.clone();"Footnote"===e.footNoteType?this.viewer.updateFootnoteClientArea(e.sectionFormat,e):e.sectionFormat.columns.length>1&&(this.viewer.updateClientArea(e,e.page),this.viewer.clientActiveArea.y=t.y,this.viewer.clientActiveArea.height=t.height),e.height=0;var r=void 0,n=0;this.isRelayoutFootnote=!1;for(var o=0,s=0;s<e.bodyWidgets.length;s++){if(0===s){var a=new le;a.characterFormat=new P,a.paragraphFormat=new ct,a.index=0;var l=new ue(a);if(a.childWidgets.push(l),n=this.documentHelper.textHelper.getParagraphMarkSize(a.characterFormat).Height,e.height+=n,this.endNoteHeight+=n,e.page.bodyWidgets[e.page.bodyWidgets.length-1].sectionFormat.columns.length>1&&"Endnote"===e.footNoteType){var h=e.page.bodyWidgets[0].firstChild;for(this.viewer.updateClientArea(e.page.bodyWidgets[0],e.page),this.viewer.clientActiveArea.height-=this.viewer.clientActiveArea.height>this.endNoteHeight?this.endNoteHeight:0,this.viewer.clientArea.height-=this.viewer.clientArea.height>this.endNoteHeight?this.endNoteHeight:0;h;)this.viewer.updateClientAreaForBlock(h,!0),this.layoutBlock(h,0),this.viewer.updateClientAreaForBlock(h,!1),void 0!==h.previousRenderedWidget&&h.bodyWidget.indexInOwner!==h.previousRenderedWidget.bodyWidget.indexInOwner&&(this.viewer.updateClientArea(h.bodyWidget,h.bodyWidget.page),this.viewer.clientActiveArea.height-=this.viewer.clientActiveArea.height>this.endNoteHeight?this.endNoteHeight:0,this.viewer.clientArea.height-=this.viewer.clientArea.height>this.endNoteHeight?this.endNoteHeight:0,this.viewer.updateClientAreaForBlock(h,!0),this.layoutBlock(h,0),this.viewer.updateClientAreaForBlock(h,!1),h.bodyWidget.page!==h.previousRenderedWidget.bodyWidget.page&&(e.page=h.bodyWidget.page,h.bodyWidget.page.endnoteWidget=e,h.previousRenderedWidget.bodyWidget.page.endnoteWidget=void 0)),h=h.nextRenderedWidget;this.endNoteHeight=0,this.viewer.updateClientArea(e,e.page);var d=e.page.bodyWidgets[0].lastChild;this.viewer.clientActiveArea.y=d.y+d.height,this.viewer.clientActiveArea.height=t.height}e.y=this.viewer.clientActiveArea.y,"Endnote"===e.footNoteType&&this.viewer.updateClientArea(e,e.page,!0),this.viewer.cutFromTop(e.y+n),e.margin=new te(0,n,0,0)}for(var c=0;c<e.bodyWidgets[s].childWidgets.length;c++)(r=e.bodyWidgets[s].childWidgets[c]).index=o,o++,r.containerWidget=e.bodyWidgets[s],r.containerWidget.page=e.page,r.containerWidget.containerWidget=e,this.viewer.updateClientAreaForBlock(r,!0),r instanceof de&&(this.clearTableWidget(r,!0,!0,!0),this.isRelayoutFootnote=!0,this.viewer.clientArea.height=Number.POSITIVE_INFINITY,this.viewer.clientActiveArea.height=Number.POSITIVE_INFINITY),this.layoutBlock(r,0),"Footnote"===e.footNoteType&&(e.height+=r.height),this.viewer.updateClientAreaForBlock(r,!1)}if("Footnote"===e.footNoteType&&this.shiftChildWidgetInFootnote(e),this.viewer.clientActiveArea=t,this.viewer.clientArea=i,!this.islayoutFootnote&&this.viewer.clientActiveArea.y+this.viewer.clientActiveArea.height>e.y){this.viewer.clientActiveArea.height-=e.height;var p=this.viewer.clientActiveArea.y+this.viewer.clientActiveArea.height-e.y;this.viewer.clientActiveArea.height-=p}}return this.footnoteHeight=0,e},t.prototype.shiftChildWidgetInFootnote=function(e){var t=e.page,i=e.y-e.height;if(1===t.bodyWidgets[0].childWidgets.length&&t.bodyWidgets[0].firstChild){var r=t.bodyWidgets[0].firstChild.y,n=this.getBodyWidgetHeight(t.bodyWidgets[0]);i<r+n&&(i=r+n)}e.y=i,i+=e.margin.top;for(var o=0;o<e.bodyWidgets.length;o++)for(var s=0;s<e.bodyWidgets[o].childWidgets.length;s++){var a=e.bodyWidgets[o].childWidgets[s];a instanceof le?(a.y=i,i+=a.height):(this.shiftChildLocationForTableWidget(a,i-a.y),i+=a.height)}},t.prototype.getBodyWidgetHeight=function(e){for(var t=0,i=0;i<e.childWidgets.length;i++)t+=e.childWidgets[i].height;return t},t.prototype.layoutParagraph=function(e,t){this.addParagraphWidget(this.viewer.clientActiveArea,e);var i=!0;if(this.isFirstElementWithPageBreak(e)||(this.layoutListItems(e),i=!1),e.isEmpty())this.layoutEmptyLineWidget(e,!0);else{var r=t<e.childWidgets.length?e.childWidgets[t]:void 0;for(this.isRelayoutOverlap||e.containerWidget instanceof ze||this.layoutFloatElements(e);r instanceof ue;){if(e!==r.paragraph&&0===r.indexInOwner&&i&&this.layoutListItems(r.paragraph),r.isFirstLine()&&sf.base.isNullOrUndefined(this.fieldBegin)&&!sf.base.isNullOrUndefined(e.paragraphFormat)){var n=-x.convertPointToPixel(e.paragraphFormat.firstLineIndent);this.viewer.updateClientWidth(n)}r.marginTop=0,e=(r=this.layoutLine(r,0)).paragraph,r=r.nextLine}}return this.updateWidgetToPage(this.viewer,e),e.isLayouted=!0,e},t.prototype.clearLineMeasures=function(){this.maxBaseline=0,this.maxTextBaseline=0,this.maxTextHeight=0},t.prototype.layoutFloatElements=function(e){var t=this;e.floatingElements.forEach((function(e){e instanceof De&&"Inline"!==e.textWrappingStyle&&(t.isRelayoutOverlap||t.layoutShape(e))}))},t.prototype.layoutShape=function(e){if("Inline"!==e.textWrappingStyle){var t=this.getFloatingItemPoints(e);e.x=t.x,e.y=t.y,0!==e.paragraph.indexInOwner&&e.verticalPosition>=0&&Math.round(e.paragraph.y)>=Math.round(e.y)&&this.viewer.clientArea.bottom<=e.y+e.height&&("Line"==e.verticalOrigin||"Paragraph"==e.verticalOrigin)&&"InFrontOfText"!==e.textWrappingStyle&&"Behind"!==e.textWrappingStyle&&this.moveToNextPage(this.viewer,e.line);var i=e.paragraph.bodyWidget;-1===i.floatingElements.indexOf(e)&&(i.floatingElements.push(e),i.floatingElements.sort((function(e,t){return e.y-t.y}))),-1===e.paragraph.floatingElements.indexOf(e)&&e.paragraph.floatingElements.push(e)}else if(0===e.width&&0!==e.widthScale){var r=x.convertPointToPixel(e.line.paragraph.getContainerWidth());e.width=r/100*e.widthScale}var n=this.viewer.clientArea,o=this.viewer.clientActiveArea;if(e instanceof Ee){var s=e.textFrame.childWidgets;this.viewer.updateClientAreaForTextBoxShape(e,!0);for(var a=0;a<s.length;a++){var l=s[a];this.viewer.updateClientAreaForBlock(l,!0),l instanceof de&&this.clearTableWidget(l,!0,!0),this.layoutBlock(l,0),this.viewer.updateClientAreaForBlock(l,!1)}}this.viewer.clientActiveArea=o,this.viewer.clientArea=n},t.prototype.moveElementFromNextLine=function(e){for(var t=e.nextLine;t instanceof ue;){if(t.children.length>0){var i=t.children.splice(0,1)[0];e.children.push(i),i.line=e;break}1===t.paragraph.childWidgets.length?t.paragraph.destroy():t.paragraph.childWidgets.splice(t.paragraph.childWidgets.indexOf(t),1),t=e.nextLine}},t.prototype.layoutLine=function(e,t){var i=e.paragraph;0===e.children.length&&this.moveElementFromNextLine(e);var r=e.children[t],n=!0;if(r instanceof fe&&e.children[e.children.length-1]instanceof fe){n=!1;for(var o=0;o<e.children.length;o++)if(2==e.children[o].fieldType&&null!=e.children[o].nextElement&&!(e.children[o].nextElement instanceof fe)){n=!0;break}}this.clearLineMeasures(),e.marginTop=0;for(i.bodyWidget.indexInOwner,e.indexInOwner;r instanceof ge;){if(r.padding.left=0,n?this.layoutElement(r,i):(this.layoutElement(r,i,!0),n=!0),e=r.line,r instanceof we){var s=r;!sf.base.isNullOrUndefined(s.errorCollection)&&s.errorCollection.length>0&&(s.ischangeDetected=!0)}if(this.isRTLLayout)r=void 0,this.isRTLLayout=!1;else{var a=i.childWidgets.indexOf(r.line);if(a>0&&this.hasFloatingElement)this.hasFloatingElement=!1,i.bodyWidget.floatingElements.length>0&&r instanceof we&&!(i.containerWidget instanceof pe)&&(r=i.childWidgets[a].children[0]);else{if(this.hasFloatingElement=!1,this.is2013Justification&&!sf.base.isNullOrUndefined(this.nextElementToLayout))r=this.nextElementToLayout;else if((r=r.nextElement)instanceof we&&0==r.text.indexOf(" ")&&r.text.length>2&&sf.base.isNullOrUndefined(r.nextElement)&&r.text.trim().length>0){r.text=r.text.substring(1,r.text.length);var l=r.line.children.indexOf(r);r.line.children.splice(l,1),(s=new we).text=" ",s.line=r.line,s.characterFormat.copyFormat(r.characterFormat),r.line.children.splice(l,0,s),r.line.children.splice(l+1,0,r),r=s}this.nextElementToLayout=void 0}}}return e},t.prototype.layoutElement=function(e,t,i){var r=e.line,n="",o=e.indexInOwner;if(e instanceof fe){if(0===e.fieldType&&(-1===this.documentHelper.fields.indexOf(e)&&this.documentHelper.fields.push(e),sf.base.isNullOrUndefined(e.formFieldData)||-1!==this.documentHelper.formFields.indexOf(e)||this.documentHelper.formFields.push(e)),this.layoutFieldCharacters(e),e.line.isLastLine()&&sf.base.isNullOrUndefined(e.nextNode)&&!this.isFieldCode)this.moveToNextLine(r);else if(sf.base.isNullOrUndefined(e.nextElement)&&this.viewer.clientActiveArea.width>0&&!e.line.isLastLine())this.moveElementFromNextLine(r),e.line.isLastLine()&&sf.base.isNullOrUndefined(e.nextNode)&&!this.isFieldCode&&(2!==e.fieldType&&sf.base.isNullOrUndefined(e.fieldSeparator)&&this.layoutEmptyLineWidget(t,!1,e.line),this.moveToNextLine(r));else if(sf.base.isNullOrUndefined(e.nextElement)&&0===this.viewer.clientActiveArea.width)this.moveToNextLine(r),r.paragraph.lastChild===r&&!sf.base.isNullOrUndefined(r.nextLine)&&this.viewer.clientActiveArea.height>=0&&this.moveFromNextPage(r);else if(i){var s=this.documentHelper.textHelper.getHeight(t.characterFormat);e.height=s.Height}}else{if(e instanceof je||this.isFieldCode||e instanceof Ce||e instanceof Ue||e instanceof He||e instanceof Oe||e instanceof De&&"Inline"!==e.textWrappingStyle){if(e instanceof Ce)if(0!==e.bookmarkType||this.documentHelper.bookmarks.containsKey(e.name))if(1===e.bookmarkType&&this.documentHelper.bookmarks.containsKey(e.name)){var a=this.documentHelper.bookmarks.get(e.name);(sf.base.isNullOrUndefined(a.reference)||sf.base.isNullOrUndefined(a.reference.paragraph.bodyWidget))&&(a.reference=e,e.reference=a)}else 0===e.bookmarkType&&this.documentHelper.bookmarks.containsKey(e.name)&&sf.base.isNullOrUndefined(e.reference)&&this.documentHelper.bookmarks.remove(e.name);else this.documentHelper.bookmarks.add(e.name,e);if(e instanceof De&&"Inline"!==e.textWrappingStyle&&-1==t.floatingElements.indexOf(e)&&e instanceof Ee&&(-1===t.floatingElements.indexOf(e)&&t.floatingElements.push(e),-1===t.bodyWidget.floatingElements.indexOf(e)&&t.bodyWidget.floatingElements.push(e)),e instanceof Oe&&-1===this.documentHelper.contentControlCollection.indexOf(e))if(0===e.type)this.documentHelper.contentControlCollection.push(e);else if(1===e.type)for(var l=e.paragraph.bodyWidget.page,h=0;h<this.documentHelper.contentControlCollection.length;h++){var d=this.documentHelper.contentControlCollection[h],c=d.line.paragraph.isInHeaderFooter;c&&e.contentControlProperties===d.contentControlProperties&&l===d.line.paragraph.bodyWidget.page?(e.reference=d,d.reference=e):c||e.contentControlProperties!==d.contentControlProperties||(e.reference=d,d.reference=e)}return sf.base.isNullOrUndefined(e.nextElement)&&this.viewer.clientActiveArea.width>0&&!e.line.isLastLine()&&this.moveElementFromNextLine(r),void(e.line.isLastLine()&&sf.base.isNullOrUndefined(e.nextElement)&&(this.hasValidElement(r.paragraph)&&!t.isContainsShapeAlone()?this.moveToNextLine(r):this.isInitialLoad||this.hasValidElement(r.paragraph)||!r.paragraph.paragraphFormat.bidi||-1===r.paragraph.paragraphFormat.listFormat.listId?this.layoutEmptyLineWidget(r.paragraph,!1,r,!1):this.moveToNextLine(r)))}var p,u=e.width;if(e instanceof Ie&&!this.isTocField(e.fieldBegin)?""!==(n=this.documentHelper.getFieldResult(e.fieldBegin,e.paragraph.bodyWidget.page))?e.text=n:n=e.text:e instanceof Me?""!==(n=this.startAt(e,n))&&(e.text=n):e instanceof we&&(this.checkAndSplitTabOrLineBreakCharacter(e.text,e),n=e.text),e instanceof we&&(u=this.documentHelper.textHelper.getTextSize(e,e.characterFormat),"\t"===e.text?(u=this.getTabWidth(t,this.viewer,o,r,e),e.width=u):e.text!==String.fromCharCode(31)&&e.text!==String.fromCharCode(14)||(e.width=u=0)),sf.base.isNullOrUndefined(t.containerWidget)||!(t.bodyWidget.floatingElements.length>0)||e instanceof Ee||t.containerWidget instanceof ze||e instanceof nt||this.adjustPosition(e,e.line.paragraph.bodyWidget),this.viewer instanceof X&&(e instanceof Ee&&"Inline"===e.textWrappingStyle||!(e instanceof Ee))&&this.viewer.clientActiveArea.height<e.height&&this.viewer.clientActiveArea.y!==this.viewer.clientArea.y&&(!(e instanceof we&&"\f"!==e.text&&e.text!==String.fromCharCode(14))&&e instanceof we||this.moveToNextPage(this.viewer,r),e instanceof Ie&&this.updateFieldText(e),!e.previousElement||!(e.previousElement instanceof Ee&&"Inline"===e.previousElement.textWrappingStyle)&&e.previousElement instanceof Ee||this.cutClientWidth(e.previousElement)),e instanceof Ee&&"Inline"===e.textWrappingStyle&&(-1===t.floatingElements.indexOf(e)&&t.floatingElements.push(e),this.layoutShape(e)),e instanceof Me&&(!e.isLayout||this.isLayoutWhole)&&"Pages"===this.documentHelper.owner.layoutType){this.layoutFootEndNoteElement(e);var g=void 0,f=!1,m=new $(this.viewer.clientArea.x,this.viewer.clientArea.y,this.viewer.clientArea.width,this.viewer.clientArea.height),y=new $(this.viewer.clientActiveArea.x,this.viewer.clientActiveArea.y,this.viewer.clientActiveArea.width,this.viewer.clientActiveArea.height);if(e.line.paragraph.bodyWidget.sectionFormat.columns.length>1&&e.line.paragraph.bodyWidget.indexInOwner>0&&e.height<=this.viewer.clientActiveArea.height){g=e.line.paragraph.bodyWidget.previousRenderedWidget.lastChild;var v=e.line.paragraph.bodyWidget.previousRenderedWidget.lastChild;this.viewer.updateClientArea(e.line.paragraph.bodyWidget,g.bodyWidget.page),this.isInitialLoad&&v.y+v.height>=this.viewer.clientArea.height+this.viewer.clientArea.y?f=!0:(this.viewer.clientActiveArea=y,this.viewer.clientArea=m)}if(f)for(h=0;h<g.bodyWidget.page.bodyWidgets.length;h++){var b=!1,w=g.bodyWidget.page.bodyWidgets[h],x=w.nextRenderedWidget;if(void 0===x)break;for(g=w.lastChild;g&&g.y+g.height>=this.viewer.clientArea.y+this.viewer.clientArea.height;)if(!(g.y>=this.viewer.clientArea.y+this.viewer.clientArea.height)&&g.childWidgets.length>1){for(var M=g.y,N=0;N<g.childWidgets.length;N++)if((M+=g.childWidgets[N].height)>=this.viewer.clientArea.y+this.viewer.clientArea.height){var I=g.childWidgets.indexOf(g.childWidgets[N]),S=new le;S=this.moveChildsToParagraph(g,I,S),b=!0,x.childWidgets.splice(0,0,S),S.containerWidget=x,S.isLayouted=!0,g=void 0;break}}else{var C=w.childWidgets.indexOf(g);w.childWidgets.splice(C,1),x.childWidgets.splice(0,0,g),g.containerWidget=x,g=g.previousRenderedWidget,b=!0}if(b){for(this.viewer.updateClientArea(x,x.page),g=x.firstChild;g&&g.isLayouted;)this.viewer.updateClientAreaForBlock(g,!0),this.layoutParagraph(g,0),this.viewer.updateClientAreaForBlock(g,!1),void 0!==g.nextRenderedWidget&&g.bodyWidget.indexInOwner!==g.nextRenderedWidget.bodyWidget.indexInOwner&&this.viewer.updateClientArea(g.nextRenderedWidget.bodyWidget,g.nextRenderedWidget.bodyWidget.page),g=g.nextRenderedWidget;if(g&&!g.isLayouted)this.viewer.updateClientAreaForBlock(g,!0),this.layoutBlock(g,0),this.viewer.updateClientAreaForBlock(g,!1);else if(sf.base.isNullOrUndefined(g))break}}}if(e instanceof Me&&(this.isfootMove&&(this.moveToNextPage(this.viewer,e.line),!e.previousElement||!(e.previousElement instanceof Ee&&"Inline"===e.previousElement.textWrappingStyle)&&e.previousElement instanceof Ee||this.cutClientWidth(e.previousElement),this.isfootMove=!1),t.paragraphFormat.keepWithNext&&t.paragraphFormat.keepLinesTogether&&e.isLayout&&!this.isLayoutWhole&&0!==t.bodyWidget.page.footnoteWidget.y&&t.bodyWidget.page.footnoteWidget.y<this.viewer.clientActiveArea.y+this.viewer.clientActiveArea.height)){var O=this.viewer.clientActiveArea.y+this.viewer.clientActiveArea.height-t.bodyWidget.page.footnoteWidget.y;this.viewer.clientActiveArea.height-=O}if(parseFloat(u.toFixed(4))<=parseFloat(this.viewer.clientActiveArea.width.toFixed(4))||!this.viewer.textWrap)this.addElementToLine(t,e),sf.base.isNullOrUndefined(e.nextElement)&&this.viewer.clientActiveArea.width>0&&!e.line.isLastLine()?this.moveElementFromNextLine(r):!e.line.isLastLine()&&sf.base.isNullOrUndefined(e.nextElement)&&0===this.viewer.clientActiveArea.width&&(this.moveToNextLine(r),r.paragraph.lastChild===r&&this.viewer.clientActiveArea.height>=0&&this.moveFromNextPage(r));else if(e instanceof we){if("\t"===e.text){var T=e.line,P=!1;if(0!==e.indexInOwner&&e instanceof Se?(P=!0,this.addSplittedLineWidget(T,T.children.indexOf(e)-1)):(this.isWrapText&&this.viewer.clientActiveArea.x+this.viewer.clientActiveArea.width===this.viewer.clientActiveArea.right&&(this.isWrapText=!1),this.addSplittedLineWidget(T,T.children.indexOf(e))),this.moveToNextLine(T),T.paragraph.bodyWidget.floatingElements.length>0&&P)return this.nextElementToLayout=e,void(this.hasFloatingElement=!0);e.width=this.getTabWidth(t,this.viewer,o,e.line,e),P&&(this.addElementToLine(t,e),sf.base.isNullOrUndefined(e.nextElement)&&this.viewer.clientActiveArea.width>0&&!e.line.isLastLine()&&this.moveElementFromNextLine(e.line))}else do{if(r=e.line,e.previousElement instanceof fe&&2==e.previousElement.fieldType&&!sf.base.isNullOrUndefined(e.previousElement.fieldBeginInternal)&&e.previousElement.fieldBeginInternal.formFieldData instanceof be||this.splitTextForClientArea(r,e,e.text,e.width,e.characterFormat),this.checkLineWidgetWithClientArea(r,e),e instanceof Ie&&this.updateFieldText(e),e.line!==r&&!sf.base.isNullOrUndefined(this.nextElementToLayout)&&this.is2013Justification)return}while(e.line!==r&&this.cutClientWidth(e))}else do{r=e.line,this.splitElementForClientArea(t,e),this.checkLineWidgetWithClientArea(r,e),e instanceof Ie&&this.updateFieldText(e)}while(e.line!==r&&this.cutClientWidth(e));if(!sf.base.isNullOrUndefined(e.nextNode)&&e.nextNode instanceof Oe&&(p=e.nextNode),("\v"===n||"\f"===n||n===String.fromCharCode(14))&&!p){var A=r.children.indexOf(e);A>-1&&this.addSplittedLineWidget(r,A)}if(e.line.isLastLine()&&sf.base.isNullOrUndefined(e.nextElement)||"\v"===n||"\f"===n||n===String.fromCharCode(14)){if(this.isXPositionUpdated)return void(this.isXPositionUpdated=!1);if(this.moveToNextLine(e.line),"\v"===n&&sf.base.isNullOrUndefined(e.nextNode))this.layoutEmptyLineWidget(t,!0,r,!0);else if(("\f"===n||n===String.fromCharCode(14))&&this.viewer instanceof X){var L=this.isRTLLayout;this.isRTLLayout=!1,sf.base.isNullOrUndefined(e.nextNode)||e.nextNode instanceof Oe?this.moveToNextPage(this.viewer,e.line,!0):sf.base.isNullOrUndefined(e.line.nextLine)||this.moveToNextPage(this.viewer,e.line.nextLine,!1),this.isRTLLayout=L}}this.isXPositionUpdated=!1}},t.prototype.adjustPosition=function(e,t){var i=this.viewer.clientActiveArea,r=this.viewer.clientActiveArea.x,n=this.viewer.clientActiveArea.y,o=this.viewer.clientActiveArea.width,s=this.adjustClientAreaBasedOnTextWrap(e,new $(i.x,i.y,i.width,i.height));this.viewer.clientActiveArea.width=s.width;var a=this.viewer.clientActiveArea.x-r;if(e.padding.left=a>0?a:0,o!==this.viewer.clientActiveArea.width){var l=new I(this.viewer.clientActiveArea.x,this.viewer.clientActiveArea.width);this.updateWrapPosition(l)}0===this.viewer.clientActiveArea.width&&(this.isWrapText=!1),this.isYPositionUpdated&&(e.line.isFirstLine()?e.line.paragraph.y=this.viewer.clientActiveArea.y:e.line.children[0]===e&&(e.line.marginTop+=this.viewer.clientActiveArea.y-n),e.line.paragraph.containerWidget instanceof oe&&(e.line.paragraph.containerWidget.height+=this.viewer.clientActiveArea.y-n),e instanceof je||(this.isYPositionUpdated=!1))},t.prototype.updateWrapPosition=function(e){for(var t=0;t<this.wrapPosition.length;t++){var i=this.wrapPosition[t];if(!(Math.abs(i.right-e.right)>1))return}this.wrapPosition.push(e)},t.prototype.isFirstitemInPage=function(e,t){return!e.line.paragraph.isInHeaderFooter&&Math.round(t)===this.viewer.clientArea.y},t.prototype.isTextFitBelow=function(e,t,i){return!1},t.prototype.isNeedToWrapForSquareTightAndThrough=function(e,t,i,r,n,o,s,a,l,h,d,c,p){return e.floatingElements.length>0&&i!==a&&r!==a&&"Inline"!==n&&"Behind"!==n&&"TopAndBottom"!==n&&"InFrontOfText"!==n&&(Math.round(d.y+p)>Math.round(o.y)||this.isTextFitBelow(o,d.y+p,l))&&Math.round(d.y)<Math.round(o.y+o.height)&&!(s&&(h||t instanceof Re&&"Inline"!==t.textWrappingStyle&&t.allowOverlap))},t.prototype.isNeedToWrapForSquareTightAndThroughForTable=function(e,t,i,r,n,o,s,a,l,h,d,c,p){return e.floatingElements.length>0&&i!==a&&r!==a&&"Inline"!==n&&"Behind"!==n&&"TopAndBottom"!==n&&"InFrontOfText"!==n&&(Math.round(d.y+p)>=Math.round(o.y)&&Math.round(d.y)<Math.round(o.bottom)||Math.round(d.y+p)<=Math.round(o.bottom)&&Math.round(d.y+p)>=Math.round(o.y))&&!(s&&h)},t.prototype.isNeedToWrapLeafWidget=function(e,t){return e.bodyWidget.floatingElements.length>0&&!(t instanceof De&&("InFrontOfText"===t.textWrappingStyle||"Behind"===t.textWrappingStyle))},t.prototype.getMinWidth=function(e,t,i,r){var n=e.text,o=n.split(" ");""!==n&&""===n.trim()&&e&&e.line.paragraph&&e.previousNode&&e.nextNode&&e.line.paragraph.isEmpty&&(o=[""]);var s=this.documentHelper.textHelper.measureText(o[0],e.characterFormat,e.scriptType).Width,a=this.getNextSibling(e);if(1===o.length&&a){var l=a.text;s+=this.getNextTextRangeWidth(a,l,t,i,r)}return s},t.prototype.getNextTextRangeWidth=function(e,t,i,r,n){for(var o=e,s=new $(0,0,0,0),a=this.isNextSibligSizeNeedToBeMeasure(s,e,n,i,r);a&&this.isLeafWidgetNextSiblingIsTextRange(o)&&i+s.width<n.width&&(o=this.getNextSibling(o),this.isNextSibligSizeNeedToBeMeasure(s,o,n,i,r));)o.text;return s.width},t.prototype.isLeafWidgetNextSiblingIsTextRange=function(e){var t=this.getNextSibling(e);return!!(t&&t instanceof we)},t.prototype.isNextSibligSizeNeedToBeMeasure=function(e,t,i,r,n){var o=null,s=t;if(s){if(-1!==(o=s.text).indexOf(" ")||-1!==o.indexOf("-")||-1!==o.indexOf("_")&&r+e.width+this.documentHelper.textHelper.measureText(o.split("-")[0],s.characterFormat,s.scriptType).Width<i.width||"\t"===s.text){var a=s.width;return o!==o.split(" ")[0]&&(a=this.documentHelper.textHelper.measureText(o.split(" ")[0],s.characterFormat,s.scriptType).Width),r+e.width+a>i.width&&o.indexOf("-")&&o!==o.split("-")[0]+"-"&&(a=this.documentHelper.textHelper.measureText(o.split("-")[0]+"-",s.characterFormat,s.scriptType).Width),e.width+=a,!1}if(s.text.length>0){var l=this.documentHelper.textHelper.measureText(s.text,s.characterFormat,s.scriptType);e.height+=l.Height,e.width+=l.Width}}return!0},t.prototype.isNeedDoIntermediateWrapping=function(e,t,i,r,n,o,s,a,l){return e>l&&((Math.round(i.width)<=Math.round(a)||i.width<r&&s.paragraph.isInsideTable)&&"Left"!==t&&"Largest"!==t||"Right"===t||i.width<e&&"Largest"===t)||(Math.round(o.x-n.x+n.leftIndent)<l||s instanceof we&&this.isFloatingItemOnLeft(i,a,o))&&("Left"!==t||e<l)},t.prototype.isFloatingItemOnLeft=function(e,t,i){return!1},t.prototype.getNextSibling=function(e){for(var t=e.nextNode,i=!1;t;){if(t instanceof fe||t instanceof Ce||i||t instanceof je)t instanceof fe&&(0===t.fieldType?i=!0:2===t.fieldType&&(i=!1));else if(t instanceof we)break;t=t.nextNode}return t},t.prototype.adjustClientAreaBasedOnTextWrap=function(e,t){var i=e.line.paragraph,r=i.bodyWidget,n=this.viewer,o=t.y;this.isFirstitemInPage(e,o);if(sf.base.isNullOrUndefined(i.previousWidget),this.isNeedToWrapLeafWidget(i,e)){var s=n.clientArea;r.floatingElements.sort((function(e,t){return e.y-t.y})),r.floatingElements.sort((function(e,t){return e.x-t.x}));for(var a=0;a<r.floatingElements.length;a++){var l=r.floatingElements[a],h=!1;if(h=l instanceof De?l.allowOverlap:l.positioning.allowOverlap,(!(i.isInsideTable&&l instanceof de)||l.isInsideTable)&&!(this.isRelayout&&!this.isRelayoutOverlap&&this.viewer.documentHelper.selection.isExistAfter(l instanceof de?l:l.line.paragraph,e.line.paragraph)||this.isRelayout&&this.isRelayoutOverlap&&this.viewer.documentHelper.selection.isExistAfter(l instanceof de?l:l.line.paragraph,this.endOverlapWidget))){l.x;var d=0,c=0,p=0,u=0,g=0;l instanceof De?(d=l.distanceLeft,c=l.distanceTop,p=l.distanceRight,u=l.distanceBottom,g=l.width):(g=l.getTableCellWidth(),d=l.positioning.distanceLeft,c=l.positioning.distanceTop,p=l.positioning.distanceRight,u=l.positioning.distanceBottom);var f=new $(l.x-d,l.y-c,g+d+p,l.height+c+u),m=l instanceof de?"Square":l.textWrappingStyle,y=l instanceof de?"Both":l.textWrappingType,v=24;n.clientArea.y,l.height;if(!(s.x>f.right+v||s.right<f.x-v)&&this.isNeedToWrapForSquareTightAndThrough(r,e,-1,-1,m,f,h,1,l,!1,t,e.width,e.height)){var b=0,w=0,M=0,N=x.convertPointToPixel(e.paragraph.paragraphFormat.firstLineIndent),I=x.convertPointToPixel(i.paragraphFormat.leftIndent),S=x.convertPointToPixel(i.paragraphFormat.rightIndent);N=0===e.indexInOwner&&e.line.isFirstLine()&&N>0?N:0;var C=e instanceof we||e instanceof je?e:null,O=l instanceof de?l.containerWidget:l.line.paragraph.containerWidget,T=!1;if(e.line.paragraph){t.x>=f.x&&"Left"!==y&&(b=S),t.x<f.x&&"Right"!==y&&(w=I);var P=i.paragraphFormat.listFormat,A=this.getListLevel(P.list,P.listLevelNumber);t.x===s.x+I&&P&&P.baseStyle&&A&&0!==A.paragraphFormat.leftIndent&&(M=I,T=!0)}var L=0,F=!1,D=void 0,E=0,z=void 0;if(l instanceof de&&(D=l,z=l.positioning.horizontalAlignment,L=this.getMaximumRightCellBorderWidth(l),F=this.getDefaultBorderSpacingValue(L,F,z),E=l.tableFormat.borders.left.lineWidth/2),t.x+E>=f.x&&t.x<f.right&&"Left"!==y){t.width=t.width-(f.right-t.x)-b,this.isWrapText=!0;if(sf.base.isNullOrUndefined(D)||(v=this.getMinimumWidthRequiredForTable(F,z,L)),Math.round(t.width)<v||t.width<e.width&&"\t"===e.text||f.x<i.x+I){t.width=this.viewer.clientArea.right-f.right-(T?M:0);var k=0;if(k=sf.base.isNullOrUndefined(C)?e.width:this.getMinWidth(e,e.width,e.height,t),Math.round(t.width)<v||t.width<k){if(f.x-(i.x+i.leftIndent)>v&&this.viewer.clientArea.right-f.right>v)t.width=0;else{var W=0;this.isYPositionUpdated=!0,t.width=this.viewer.clientArea.width,t.height-=f.bottom+W-t.y,t.y=f.bottom+W}this.viewer.updateClientAreaForTextWrap(t),this.isWrapText=!1}else{var R=t.x;if(t.x=f.right+(T?M:0)+N,t.width-=N,"Square"===m&&t.width<0&&e.width>0){W=0;this.isYPositionUpdated=!0,t.width=this.viewer.clientArea.width,t.height-=f.bottom+W-t.y,t.y=f.bottom+W,t.x=R}this.viewer.updateClientAreaForTextWrap(t)}}else{R=t.x;if(t.x=f.right+(T?M:0)+N,t.width=this.viewer.clientArea.right-f.right-(T?M:0)-N,"Square"===m&&t.width<0&&e.width>0){W=0;this.isYPositionUpdated=!0,t.width=this.viewer.clientArea.width,t.height-=f.bottom+W-t.y,t.y=f.bottom+W,t.x=R}this.isWrapText=!0,this.viewer.updateClientAreaForTextWrap(t)}}else if(f.x>=t.x&&t.right>f.x){t.width=f.x-t.x-b;var j=this.viewer.clientArea.right-f.right;j=j>0?j:0,this.isWrapText=!0;var U=!1;k=0;if(k=sf.base.isNullOrUndefined(C)?e.width:this.getMinWidth(C,e.width,e.height,t),sf.base.isNullOrUndefined(D)||(v=this.getMinimumWidthRequiredForTable(F,z,L)),this.isNeedDoIntermediateWrapping(j,y,t,e.width,e.paragraph,f,e,k,v)){if(t.width=j,this.isWrapText=!0,(t.x+k>f.x||"Right"===y||s.x>f.x-24)&&(t.x=f.right,t.width>k||"Right"===y?this.viewer.updateClientAreaForTextWrap(t):t.width<k&&e.line.children[0]!==e&&"Both"===y&&l instanceof De&&(this.viewer.updateClientAreaForTextWrap(t),U=!0)),t.width<v&&!(k<j&&"Tight"===m)||t.width<k&&Math.round(t.right)===Math.round(this.viewer.clientArea.right)&&"Both"===y){var H=f;if(Math.round(t.x)===Math.round(r.sectionFormat.leftMargin+i.paragraphFormat.leftIndent)){W=0;t.y=H.bottom+W,this.isYPositionUpdated=!0,t.width=this.viewer.clientArea.width,t.height=t.height-(H.height+W),this.viewer.updateClientAreaForTextWrap(t),this.isWrapText=!1}else if(!U&&Math.round(t.right)>=Math.round(this.viewer.clientArea.right)&&"Both"===y){W=0;t.y=H.bottom+W,t.width=this.viewer.clientArea.width,t.height=t.height-(H.height+W),t.x=this.viewer.clientArea.x+w,this.viewer.updateClientAreaForTextWrap(t),this.isYPositionUpdated=!0,this.isWrapText=!1}else t.width=0,this.viewer.updateClientAreaForTextWrap(t)}}else(e.line.isFirstLine()&&0===e.indexInOwner||0===j&&e.line.children[0]===e)&&"Square"===m&&Math.round(t.width)<=Math.round(k)&&i.containerWidget===O?(t.x=s.x,t.y=f.bottom,t.width=s.width,t.height-=f.bottom-t.y,this.isYPositionUpdated=!0):Math.round(t.width)<=Math.round(k)&&Math.round(t.x-w)!==Math.round(this.viewer.clientArea.x)&&(t.width=0),this.viewer.updateClientAreaForTextWrap(t)}"Both"!==y&&(this.isWrapText=!1)}}}}return t},t.prototype.adjustClientAreaBasedOnTextWrapForTable=function(e,t){if(sf.base.isNullOrUndefined(e.containerWidget)||sf.base.isNullOrUndefined(e.bodyWidget))return t;var i=e.bodyWidget,r=this.viewer;t.y,sf.base.isNullOrUndefined(e.previousWidget);if(i.floatingElements.length>0){var n=r.clientActiveArea;i.floatingElements.sort((function(e,t){return e.y-t.y})),i.floatingElements.sort((function(e,t){return e.x-t.x}));for(var o=0;o<i.floatingElements.length;o++){var s=i.floatingElements[o],a=!1;if(a=s instanceof De?s.allowOverlap:s.positioning.allowOverlap,(!(e.isInsideTable&&s instanceof de)||s.isInsideTable)&&!(s instanceof de&&s.wrapTextAround&&s.positioning.allowOverlap&&e.wrapTextAround&&e.positioning.allowOverlap)){var l=e.getTableCellWidth(),h=s instanceof De,d=h?s.distanceLeft:s.positioning.distanceLeft,c=h?s.distanceTop:s.positioning.distanceTop,p=h?s.distanceRight:s.positioning.distanceRight,u=h?s.distanceBottom:s.positioning.distanceBottom,g=h?s.width:s.getTableCellWidth(),f=new $(s.x-d,s.y-c,g+d+p,s.height+c+u),m=s instanceof de?"Square":s.textWrappingStyle,y=s instanceof de?"Both":s.textWrappingType,v=e.childWidgets.length>0?e.childWidgets[0].rowFormat.height:0;if(!(n.x>f.right+24||n.right<f.x-24)&&this.isNeedToWrapForSquareTightAndThroughForTable(i,e,-1,-1,m,f,a,1,s,!1,t,l,v)&&t.x>=f.x&&t.x<f.right&&"Left"!==y){t.width=t.width-(f.right-t.x),this.isWrapText=!0;if(Math.round(t.width)<24||t.width<l||f.x<e.x){t.width=this.viewer.clientArea.right-f.right;var b=l;if(Math.round(t.width)<24||t.width<b){if(f.x-e.x>24&&this.viewer.clientArea.right-f.right>24)t.width=0;else{var w=0;this.isYPositionUpdated=!0,t.width=this.viewer.clientArea.width,t.height-=f.bottom+w-t.y,t.y=f.bottom+w}this.viewer.updateClientAreaForTextWrap(t),this.isWrapText=!1}else{var x=t.x;if(t.x=f.right,"Square"===m&&t.width<0&&l>0){this.isYPositionUpdated=!0,t.height-=f.bottom+0-t.y,t.width=this.viewer.clientArea.width,t.y=f.bottom+0,t.x=x}this.viewer.updateClientAreaForTextWrap(t)}}else{x=t.x;if(t.x=f.right+e.firstChild.firstChild.leftMargin,t.width=this.viewer.clientArea.right-f.right,"Square"===m&&t.width<0&&l>0){w=0;this.isYPositionUpdated=!0,t.width=this.viewer.clientArea.width,t.height-=f.bottom+w-t.y,t.y=f.bottom+w,t.x=x}this.viewer.updateClientAreaForTextWrap(t)}}}}}return t},t.prototype.startAt=function(e,t){return"Footnote"===e.footnoteType?(this.startat=e.paragraph.bodyWidget.sectionFormat.initialFootNoteNumber,t=this.getFootEndNote(e.paragraph.bodyWidget.sectionFormat.footNoteNumberFormat,this.documentHelper.footnoteCollection.indexOf(e)+this.startat)):(this.startat=e.paragraph.bodyWidget.sectionFormat.initialEndNoteNumber,t=this.getFootEndNote(e.paragraph.bodyWidget.sectionFormat.endnoteNumberFormat,this.documentHelper.endnoteCollection.indexOf(e)+this.startat)),t},t.prototype.layoutFootEndNoteElement=function(e){var t;this.isFootnoteContentChanged=!0;var i,r=!1,n=this.documentHelper.footnoteCollection.indexOf(e),o=1;this.islayoutFootnote=!0;var s=new $(this.viewer.clientArea.x,this.viewer.clientArea.y,this.viewer.clientArea.width,this.viewer.clientArea.height),a=new $(this.viewer.clientActiveArea.x,this.viewer.clientActiveArea.y,this.viewer.clientActiveArea.width,this.viewer.clientActiveArea.height),l=e.paragraph.bodyWidget,h=!1,d=0;if(l.page.footnoteWidget)for(var c=0;c<l.page.footnoteWidget.bodyWidgets.length;c++){o=l.page.footnoteWidget.bodyWidgets.length;var p=this.documentHelper.footnoteCollection.indexOf(l.page.footnoteWidget.bodyWidgets[c].footNoteReference);if(p>n&&p-n==1){o=c,r=!0;break}}if(e.isLayout=!0,"Footnote"===e.footnoteType){if(l.page.footnoteWidget&&l.page.footnoteWidget instanceof ae)t=l.page.footnoteWidget;else{h=!0,(t=new ae).footNoteType="Footnote",t.page=l.page;var u=new le;u.characterFormat=new P,u.paragraphFormat=new ct,u.index=0;var g=new ue(u);u.childWidgets.push(g),d=this.documentHelper.textHelper.getParagraphMarkSize(u.characterFormat).Height,t.margin=new te(0,d,0,0)}this.isFootNoteLayoutStart=!0,h&&(l.page.footnoteWidget=t);var f=e.bodyWidget;this.viewer.updateClientArea(t,t.page),this.viewer.clientArea.y=s.y,this.viewer.clientActiveArea.y=a.y;for(var m=0;m<e.bodyWidget.childWidgets.length;m++){(v=e.bodyWidget.childWidgets[m]).containerWidget=f,f.page=l.page,f.sectionFormat=t.sectionFormat,v.containerWidget.containerWidget=t,this.viewer.updateClientAreaForBlock(v,!0),v instanceof de&&this.clearTableWidget(v,!0,!0),this.layoutBlock(v,0),d+=v.height,v.y=0,this.viewer.updateClientAreaForBlock(v,!1),f.height+=v.height}if(this.isFootNoteLayoutStart=!1,i=!1,d>=a.height&&(this.isfootMove=!0),r?t.bodyWidgets.splice(o,0,f):t.bodyWidgets.push(f),e.line.paragraph.isInsideTable){var y=this.getParentTable(e.line.paragraph.associatedCell.ownerTable);sf.base.isNullOrUndefined(y.footnoteElement)&&(y.footnoteElement=[]),-1==y.footnoteElement.indexOf(e)&&(y.footnoteElement.push(e),this.layoutedFootnoteElement.push(e))}t.height+=d,i=!0,this.viewer.clientActiveArea=a,this.viewer.clientActiveArea.height-=d,this.footnoteHeight+=d,this.viewer.clientArea=s}else if("Endnote"===e.footnoteType)for(m=0;m<e.bodyWidget.childWidgets.length;m++){var v;(v=e.bodyWidget.childWidgets[m]).isLayouted||(v.bodyWidget.page=e.paragraph.bodyWidget.page,this.viewer.updateClientAreaForBlock(v,!0),this.layoutBlock(v,0),this.viewer.updateClientAreaForBlock(v,!1),this.endNoteHeight+=v.height,v.x=0,v.y=0,v.height=0,v.width=0,v.isLayouted=!1,this.viewer.clientArea=s,this.viewer.clientActiveArea=a)}return i},t.prototype.layoutEndNoteElement=function(){var e=this.documentHelper.pages.length;if(this.documentHelper.endnoteCollection.length>0){for(var t=void 0,i=void 0,r=void 0,n=this.documentHelper.pages[e-1].bodyWidgets[0],o=0;o<this.documentHelper.endnoteCollection.length;o++){t=this.documentHelper.endnoteCollection[o],n.page.endnoteWidget instanceof ae&&"Endnote"===n.page.endnoteWidget.footNoteType?i=n.page.endnoteWidget:(r=!0,(i=new ae).footNoteType="Endnote",i.page=n.page);var s=t.bodyWidget;s.page=i.page;for(var a=0;a<t.bodyWidget.childWidgets.length;a++){t.bodyWidget.childWidgets[a].containerWidget=s}-1===i.bodyWidgets.indexOf(s)&&(i.bodyWidgets.push(s),s.sectionFormat=i.sectionFormat),r&&(n.page.endnoteWidget=i)}this.layoutfootNote(i)}},t.prototype.hasValidElement=function(e){var t=e.firstChild;if(t&&!sf.base.isNullOrUndefined(this.documentHelper.selection))for(var i=t.children[0];i;){if(i instanceof fe&&(i=this.documentHelper.selection.getNextValidElementForField(i),!sf.base.isNullOrUndefined(i)&&!i.line.paragraph.equals(e)))return!1;if(i instanceof we||i instanceof Re)return!0;sf.base.isNullOrUndefined(i)||(i=i.nextNode)}return!1},t.prototype.updateFieldText=function(e){var t=this.documentHelper.getFieldResult(e.fieldBegin,e.paragraph.bodyWidget.page);""!==t&&(e.text=t,this.documentHelper.textHelper.getTextSize(e,e.characterFormat))},t.prototype.checkLineWidgetWithClientArea=function(e,t){if(e!==t.line||t.line===e&&sf.base.isNullOrUndefined(t.nextElement)&&!t.line.isLastLine()){if(this.moveToNextLine(e),"Word2013"!==this.documentHelper.compatibilityMode&&this.isOverlapFloatTable){var i=void 0;t.line.paragraph.previousRenderedWidget instanceof de&&t.line.paragraph.previousRenderedWidget.wrapTextAround&&(i=t.line.paragraph.previousRenderedWidget,this.viewer.clientActiveArea.x=this.viewer.clientActiveArea.x-x.convertPointToPixel(i.firstChild.firstChild.leftMargin)),this.viewer.clientActiveArea.x+=e.paragraph.leftIndent,this.isOverlapFloatTable=!1}e!==t.line&&(this.isRTLLayout=!1)}t.line!==e&&this.viewer instanceof X&&this.viewer.clientActiveArea.height<t.height&&this.viewer.clientActiveArea.y!==this.viewer.clientArea.y?this.moveToNextPage(this.viewer,t.line):t.line===e&&sf.base.isNullOrUndefined(t.nextElement)&&e.paragraph.lastChild===e&&!e.isLastLine()&&this.viewer.clientActiveArea.height>=0&&this.moveFromNextPage(e)},t.prototype.checkAndSplitTabOrLineBreakCharacter=function(e,t){var i=x.indexOfAny(e,["\t","\v","\f"]);if(i>-1){var r=e[i];("\t"===r&&"\t"!==e||"\v"===r&&"\v"!==e||"\f"===r&&"\f"!==e)&&this.splitByLineBreakOrTab(this.viewer,t,i,r)}},t.prototype.moveFromNextPage=function(e){var t=e.nextLine;if(t&&-1===e.paragraph.childWidgets.indexOf(t)){var i=t.paragraph;t.paragraph.childWidgets.splice(t.indexInOwner,1),e.paragraph.childWidgets.push(t),t.paragraph=e.paragraph,0===i.childWidgets.length&&i.destroy()}},t.prototype.cutClientWidth=function(e){if(this.is2013Justification)return!1;this.clearLineMeasures();var t=e.line;t.marginTop=0;for(var i=0,r=0;r<t.children.length;r++){var n=t.children[r];if(i+=n.width,e===n)break}var o=this.viewer.clientActiveArea.width-i<0,s=e.line.paragraph.bodyWidget;return s&&s.floatingElements.length>0?(this.hasFloatingElement=!0,this.isXPositionUpdated=!0,!1):(o?e.previousElement&&this.cutClientWidth(e.previousElement):(this.viewer.cutFromLeft(this.viewer.clientActiveArea.x+i),"Justify"===e.line.paragraph.paragraphFormat.textAlignment&&e instanceof we&&this.splitTextElementWordByWord(e),sf.base.isNullOrUndefined(e.nextElement)&&this.viewer.clientActiveArea.width>0&&!e.line.isLastLine()&&this.moveElementFromNextLine(t)),o)},t.prototype.layoutFieldCharacters=function(e){if(0===e.fieldType)!sf.base.isNullOrUndefined(e.formFieldData)&&this.isInitialLoad&&this.checkAndUpdateFieldData(e),this.isFieldCode||sf.base.isNullOrUndefined(e.fieldEnd)&&!e.hasFieldEnd||(-1===this.documentHelper.fieldStacks.indexOf(e)&&this.documentHelper.fieldStacks.push(e),this.isFieldCode=!0,e.hasFieldEnd=!0);else if(this.documentHelper.fieldStacks.length>0){var t;if(2===e.fieldType)(t=this.documentHelper.fieldStacks[this.documentHelper.fieldStacks.length-1]).fieldSeparator!==e||sf.base.isNullOrUndefined(t.fieldEnd)&&!t.hasFieldEnd||(this.isFieldCode=!1);else e===(t=this.documentHelper.fieldStacks[this.documentHelper.fieldStacks.length-1]).fieldEnd&&(this.documentHelper.fieldStacks.pop(),this.isFieldCode=!1)}},t.prototype.checkAndUpdateFieldData=function(e){if(e.hasFieldEnd&&!sf.base.isNullOrUndefined(e.fieldEnd)){if(sf.base.isNullOrUndefined(e.fieldSeparator)){var t=new fe(2);t.fieldBegin=e,t.fieldEnd=e.fieldEnd,t.line=e.line,e.line.children.splice(e.fieldEnd.indexInOwner,0,t),e.fieldSeparator=t,e.fieldEnd.fieldSeparator=t}var i=e.fieldEnd.previousNode;if(i instanceof fe&&2===i.fieldType){var r=e.formFieldData;if(r instanceof ve){var n=new we;n.line=e.line;var o=e.line.children.indexOf(e.fieldEnd);e.line.children.splice(o,0,n),n.characterFormat.copyFormat(e.characterFormat),r.checked?n.text=String.fromCharCode(9745):n.text=String.fromCharCode(9744),"Auto"!==r.sizeType?n.characterFormat.fontSize=1.4*r.size:n.characterFormat.fontSize=1.4*n.characterFormat.fontSize}else if(r instanceof be){var s=new we;s.characterFormat.copyFormat(e.characterFormat),s.line=e.line,r.dropdownItems.length>0?s.text=r.dropdownItems[r.selectedIndex]:s.text=this.documentHelper.textHelper.repeatChar(this.documentHelper.textHelper.getEnSpaceCharacter(),5);o=e.line.children.indexOf(e.fieldEnd);e.line.children.splice(o,0,s)}}}},t.prototype.layoutEmptyLineWidget=function(e,t,i,r){var n=e.paragraphFormat,o=0,s=0;r=!sf.base.isNullOrUndefined(r)&&r;var a,l=n.borders,h=this.documentHelper.canRenderBorder(e),d=this.documentHelper.textHelper.getParagraphMarkSize(e.characterFormat).Height,c=this.getBeforeSpacing(e);if(e.childWidgets.length>0&&!r){if((a=e.childWidgets[0]).children.length>0){(n.bidi||this.isContainsRtl(a))&&this.shiftElementsForRTLLayouting(a,n.bidi);var p=a.isFirstLine(),u=a.isLastLine(),g=0;if(p&&(c=this.getBeforeSpacing(e),g=x.convertPointToPixel(n.firstLineIndent)),"Left"!==(S=n.textAlignment)&&this.viewer.textWrap&&("Justify"!==S||!u||"Justify"===S&&n.bidi)){var f=this.getSubWidth(a,"Justify"===S,s,g,u);o=f[0].subWidth,s=f[0].spaceCount}}}else a=t?this.addLineWidget(e):i;if(!sf.base.isNullOrUndefined(e.containerWidget)&&e.bodyWidget.floatingElements.length>0&&!(e.containerWidget instanceof ze)){var m=new we;m.line=a,a.children.push(m),m.text="¶",m.characterFormat=e.characterFormat,m.width=this.documentHelper.textHelper.getTextSize(m,m.characterFormat),this.adjustPosition(m,e.bodyWidget),e.x+=m.padding.left,t&&this.checkInbetweenShapeOverlap(a),a.children.splice(m.indexInOwner,1)}!(this.viewer instanceof X&&this.viewer.clientActiveArea.height<c+d&&this.viewer.clientActiveArea.y!==this.viewer.clientArea.y)||a.isFirstLine()&&sf.base.isNullOrUndefined(a.paragraph.previousWidget)||this.moveToNextPage(this.viewer,a);var y=this.getLineSpacing(e,d);!isNaN(this.maxTextHeight)&&d<this.maxTextHeight&&(d=this.maxTextHeight);var v=0,b=0,w=0,M=d,N=e.paragraphFormat.lineSpacingType;"Multiple"===N?y>d?b+=y-d:v+=y-d:("Exactly"===N||y>v+M+b)&&(v+=y-(v+M+b)),v+=c,b+=x.convertPointToPixel(this.getAfterSpacing(e)),"None"!=l.top.lineStyle&&a.isFirstLine()&&!h.skipTopBorder&&(v+=x.convertPointToPixel(l.top.lineWidth+l.top.space)),"None"!=l.bottom.lineStyle&&a.isLastLine()&&!h.skipBottomBorder&&(b+=x.convertPointToPixel(l.bottom.lineWidth+l.bottom.space));for(var I=0;I<a.children.length;I++){var S,C=a.children[I];if(0===I&&C instanceof je)"Right"===(S=e.paragraphFormat.textAlignment)?w=o:"Center"===S&&(w=o/2),C.margin=new te(w,v,0,b),C.line=a,a.height=v+M+b}a.margin=new te(0,v,0,b),a.height=v+M+b,this.adjustPositionBasedOnTopAndBottom(a),sf.base.isNullOrUndefined(e.nextRenderedWidget)&&e.isInsideTable&&e.previousRenderedWidget instanceof de&&1==e.childWidgets.length&&(a.height=0),this.viewer.cutFromTop(this.viewer.clientActiveArea.y+a.height),this.wrapPosition=[]},t.prototype.adjustPositionBasedOnTopAndBottom=function(e){!sf.base.isNullOrUndefined(e.paragraph.bodyWidget)&&!sf.base.isNullOrUndefined(e.paragraph.bodyWidget.page.headerWidget)&&e.paragraph.bodyWidget.page.headerWidget.floatingElements.length>0&&e.paragraph===e.paragraph.bodyWidget.childWidgets[0]&&0===e.indexInOwner&&this.checkInbetweenShapeOverlap(e,e.paragraph.bodyWidget.page.headerWidget.floatingElements)},t.prototype.layoutListItems=function(e){this.isFieldCode||(!sf.base.isNullOrUndefined(e.paragraphFormat)&&!sf.base.isNullOrUndefined(e.paragraphFormat.listFormat)&&!sf.base.isNullOrUndefined(this.documentHelper.getListById(e.paragraphFormat.listFormat.listId))&&e.paragraphFormat.listFormat.listLevelNumber>=0&&e.paragraphFormat.listFormat.listLevelNumber<9?(this.clearListElementBox(e),this.layoutList(e,this.documentHelper)):e.paragraphFormat.listFormat&&-1===e.paragraphFormat.listFormat.listId&&this.clearListElementBox(e))},t.prototype.layoutList=function(e,t){var i=t.getListById(e.paragraphFormat.listFormat.listId),r=this.getListLevel(i,e.paragraphFormat.listFormat.listLevelNumber);if(!sf.base.isNullOrUndefined(r)&&!sf.base.isNullOrUndefined(r.numberFormat)){var n=e.childWidgets[0];sf.base.isNullOrUndefined(n)&&(n=new ue(e),e.childWidgets.push(n));var o=new je(r,!1);if(o.line=n,"Bullet"===r.listLevelPattern?o.text=r.numberFormat:o.text=this.getListNumber(e.paragraphFormat.listFormat),""!==r.numberFormat){if(this.viewer.updateClientWidth(-x.convertPointToPixel(e.paragraphFormat.firstLineIndent)),this.documentHelper.isIosDevice){var s=o.text;(s=s===String.fromCharCode(61623)?String.fromCharCode(9679):s===String.fromCharCode(61551)+String.fromCharCode(32)?String.fromCharCode(9675):s)!==o.text&&(o.text=s)}var a;t.textHelper.updateTextSize(o,e),this.viewer instanceof X&&this.viewer.clientActiveArea.height<o.height&&this.viewer.clientActiveArea.y!==this.viewer.clientArea.y&&(a=!0),this.viewer.cutFromLeft(this.viewer.clientActiveArea.x+o.width);var l=o;if(n.children.splice(0,0,o),"None"!==r.followCharacter){if(o=new je(r,!0),"Tab"===r.followCharacter){o.text="\t";var h=n.children.indexOf(o),d=this.getTabWidth(e,this.viewer,h,n,o);t.textHelper.updateTextSize(o,e),o.width=d}else o.text=" ",t.textHelper.updateTextSize(o,e);this.viewer.cutFromLeft(this.viewer.clientActiveArea.x+o.width),n.children.splice(1,0,o),o.line=n}if(sf.base.isNullOrUndefined(e.containerWidget)||!(e.bodyWidget.floatingElements.length>0)||l instanceof Ee||e.containerWidget instanceof ze||(this.adjustPosition(l,l.line.paragraph.bodyWidget),this.isYPositionUpdated&&(this.viewer.clientActiveArea.width>l.width+o.width&&(this.viewer.clientActiveArea.width-=l.width+o.width),this.isYPositionUpdated=!1)),a)return this.moveToNextPage(this.viewer,n,void 0,!0),this.cutClientWidth(o),this.hasFloatingElement=!1,void(this.isXPositionUpdated=!1);"None"!==r.followCharacter&&this.viewer.updateClientWidth(x.convertPointToPixel(e.paragraphFormat.firstLineIndent))}}},t.prototype.addBodyWidget=function(e,t){var i;return(i=t||new ne).width=e.width,i.x=e.x,i.y=e.y,i},t.prototype.addListLevels=function(e){for(var t=e.levels.length;t<9;t++){var i=new A(e),r=t%3;"Bullet"===e.levels[0].listLevelPattern?(i.listLevelPattern="Bullet",i.numberFormat=0===r?String.fromCharCode(61623):1===r?String.fromCharCode(61551)+String.fromCharCode(32):String.fromCharCode(61607),i.characterFormat.fontFamily=i.numberFormat===String.fromCharCode(61607)?"Wingdings":"Symbol"):(i.listLevelPattern=this.getListLevelPattern(r),i.numberFormat="%"+(t+1).toString()+".",i.startAt=1,i.restartLevel=t),i.paragraphFormat=new ct(void 0),i.paragraphFormat.leftIndent=48*(t+1),i.paragraphFormat.firstLineIndent=-24,e.levels.push(i)}},t.prototype.addSplittedLineWidget=function(e,t,i){var r=t;if(this.isWrapText)sf.base.isNullOrUndefined(i)||(e.children.splice(r+1,0,i),i.line=e);else{var n=e.paragraph,o=[],s=n.childWidgets.indexOf(e);sf.base.isNullOrUndefined(i)||o.push(i);var a=void 0,l=e.children[r];l instanceof nt&&0===l.commentType&&0!=r&&(r-=1);for(var h=r+1;h<e.children.length;h++)o.push(e.children[h]);if(o.length>0){a=s===n.childWidgets.length-1?new ue(n):n.childWidgets[s+1];for(var d=0;d<o.length;d++)o[d].line=a;e.children.splice(r+1,e.children.length-1),a.children=o.concat(a.children),-1===n.childWidgets.indexOf(a)&&n.childWidgets.splice(s+1,0,a)}}},t.prototype.addElementToLine=function(e,t){t instanceof De&&"Inline"!==t.textWrappingStyle||(this.isWrapText&&(this.isWrapText=!1,this.viewer.clientActiveArea.width=this.viewer.clientArea.right-this.viewer.clientActiveArea.x),this.viewer.cutFromLeft(this.viewer.clientActiveArea.x+t.width)),"Justify"===e.paragraphFormat.textAlignment&&t instanceof we&&this.splitTextElementWordByWord(t)},t.prototype.splitElementForClientArea=function(e,t){if(t.line.children.length>0){var i=t.previousElement,r=t.indexInOwner;t.line.children.length>1&&i&&this.viewer.clientActiveArea.x!==this.viewer.clientArea.x&&(r-=1),this.addSplittedLineWidget(t.line,r)}},t.prototype.splitByWord=function(e,t,i,r,n,o){var s=this.getSplitIndexByWord(this.viewer.clientActiveArea.width,r,n,o,i.scriptType);if(s>0&&s<i.length){var a=e.children.indexOf(i),l=new we;if(r=r.substring(s),l.text=r," "===r[0])s+=r.length-(r=x.trimStart(r)).length;l.characterFormat.copyFormat(i.characterFormat),l.width=this.documentHelper.textHelper.getWidth(l.text,o,l.scriptType),l.trimEndWidth=l.width,l.characterRange=i.characterRange,i.text=i.text.substr(0,s),i.width-=l.width,i.trimEndWidth=i.width,i.revisions.length>0&&(this.updateRevisionForSplittedElement(i,l,!0),l.isMarkedForRevision=i.isMarkedForRevision),l.height=i.height,l.baselineOffset=i.baselineOffset,this.splitErrorCollection(i,l),this.addSplittedLineWidget(e,a,l),this.addElementToLine(t,i),0===i.width&&e.children.splice(a,1)}},t.prototype.splitErrorCollection=function(e,t){if(e.errorCollection.length>0){for(var i=[],r=e.ignoreOnceItems,n=0;n<e.errorCollection.length;n++)i.push(e.errorCollection[n]);for(var o=0;o<e.errorCollection.length;o++){var s=e.text.indexOf(e.errorCollection[o].text),a=e.errorCollection[o];s<0?(i.splice(0,1),t.errorCollection.push(a)):t.text.indexOf(a.text)>0&&t.errorCollection.push(a)}t.ignoreOnceItems=r,e.ignoreOnceItems=[],e.errorCollection=i}},t.prototype.splitByCharacter=function(e,t,i,r,n){var o=e.paragraph,s=this.getTextSplitIndexByCharacter(this.viewer.clientArea.width,this.viewer.clientActiveArea.width,i,r,n,t.scriptType),a=0;if(s<t.length&&(a=this.documentHelper.textHelper.measureTextExcludingSpaceAtEnd(i.substring(0,s),n,t.scriptType),i=i.substring(s)),a>this.viewer.clientActiveArea.width&&t.indexInOwner>0)this.addSplittedLineWidget(e,t.indexInOwner-1);else{var l=e.children.indexOf(t);if(s<t.length){var h=new we;h.text=i,h.errorCollection=t.errorCollection,t.text=t.text.substr(0,s),h.characterFormat.copyFormat(t.characterFormat),h.width=this.documentHelper.textHelper.getWidth(h.text,n,h.scriptType),h.trimEndWidth=h.width,h.characterRange=t.characterRange,t.width-=h.width,t.trimEndWidth=t.width,h.height=t.height,h.baselineOffset=t.baselineOffset,e.children.splice(t.indexInOwner+1,0,h),t.revisions.length>0&&(this.updateRevisionForSplittedElement(t,h,s>0),h.isMarkedForRevision=t.isMarkedForRevision),this.addElementToLine(o,t),this.addSplittedLineWidget(e,l),0===t.width&&e.children.splice(l,1)}else this.addSplittedLineWidget(e,l),this.addElementToLine(o,t)}},t.prototype.updateRevisionForSplittedElement=function(e,t,i,r){if(e.revisions.length>0)for(var n=0;n<e.revisions.length;n++){var o=e.revisions[n];if(i){t.revisions.push(o);var s=o.range.indexOf(e);s<0?o.range.push(t):r?o.range.splice(s,0,t):o.range.splice(s+1,0,t)}else o.range.splice(o.range.length-1,1),o.range.push(t),t.revisions.push(o)}},t.prototype.splitTextElementWordByWord=function(e){var t=e.line,i=t.children.indexOf(e),r=i,n=e.padding.left;e.padding.left=0;var o,s=e.text;if(s.trim().indexOf(" ")>=0){t.children.splice(i,1),o=e.characterFormat;for(var a=e.length-x.trimStart(s).length;a<e.length&&0!==(a=this.getTextIndexAfterSpace(s,a))&&a!==e.length;)if(a<e.length){var l=new we,h=s.substring(0,a);" "===(s=s.substring(a)).substring(0,1)&&(a+=s.length-x.trimStart(s).length),l.text=h,l.characterFormat.copyFormat(e.characterFormat),l.line=t,l.width=this.documentHelper.textHelper.getWidth(l.text,o,l.scriptType),l.trimEndWidth=l.width,l.height=e.height,l.baselineOffset=e.baselineOffset,l.characterRange=e.characterRange,t.children.splice(i,0,l),e.revisions.length>0&&(this.updateRevisionForSplittedElement(e,l,a>0,!0),l.isMarkedForRevision=e.isMarkedForRevision),e.text=s,e.width-=l.width,e.trimEndWidth=e.width,0===e.width&&-1!==t.children.indexOf(e)&&t.children.splice(t.children.indexOf(e),1),a=0,i++}e.text=s,t.children.splice(i,0,e)}t.children[r].padding.left=n},t.prototype.isSplitByHyphen=function(e,t){if(!sf.base.isNullOrUndefined(e.previousElement)&&(e.previousElement instanceof we||e.previousElement instanceof je)){var i=e.previousElement.text;return"-"===t.substring(0,1)&&" "!==i.substring(i.length-1,i.length)}return"-"===t.substring(0,1)},t.prototype.splitTextForClientArea=function(e,t,i,r,n){var o=e.paragraph,s=!0,a=-1;if(" "===i.substring(0,1)||this.isSplitByHyphen(t,i))a=1;else{var l=r,h=0;if(0==(h=x.trimEnd(i).indexOf(" ")+1)&&(h=x.trimEnd(i).indexOf("-")+1),(a=h)>0&&(l=this.documentHelper.textHelper.measureTextExcludingSpaceAtEnd(i.slice(0,a),n,t.scriptType)),this.viewer.clientActiveArea.width<l&&(s=this.checkPreviousElement(e,e.children.indexOf(t),n)))return}r<=this.viewer.clientActiveArea.width?this.addElementToLine(o,t):s&&(a>0||-1!==i.indexOf(" ")||-1!==i.indexOf("-"))?this.splitByWord(e,o,t,i,r,n):this.splitByCharacter(e,t,i,r,n)},t.prototype.splitByLineBreakOrTab=function(e,t,i,r){var n=t.line.children.indexOf(t),o=t.text,s=o.substring(i),a="\t"===r?new Se:new we;if(a.line=t.line,this.updateRevisionForSplittedElement(t,a,!0),a.characterFormat.copyFormat(t.characterFormat),a.characterRange=t.characterRange,t.line.children.splice(n+1,0,a),i>0&&1===s.length)a.text=o.substring(i),t.text=o.substring(0,i);else if(i>0){a.text=r;var l=new we;l.line=t.line,l.text=o.substring(i+1),this.updateRevisionForSplittedElement(t,l,!0),l.characterFormat.copyFormat(t.characterFormat),l.characterRange=t.characterRange,t.line.children.splice(n+2,0,l),t.text=o.substring(0,i)}else""!==s&&(a.text=o.substring(i+1),t.text=r)},t.prototype.moveToNextLine=function(e){var t=e.paragraph,i=t.paragraphFormat,r=e.isFirstLine(),n=e.isLastLine(),o=0,s=0,a=0,l=0,h=0,d=0,c=i.borders;this.updateLineWidget(e),s=(o=this.maxTextHeight)-this.maxTextBaseline;var p=0,u=!1,g=this.documentHelper.canRenderBorder(t);if(!t.bodyWidget||t.bodyWidget instanceof oe||(p=this.documentHelper.pages.indexOf(t.bodyWidget.page)),r&&(l=this.getBeforeSpacing(t,p),d=x.convertPointToPixel(i.firstLineIndent)),n&&(a=x.convertPointToPixel(this.getAfterSpacing(t))),(i.bidi||this.isContainsRtl(e))&&(this.shiftElementsForRTLLayouting(e,i.bidi),this.isRTLLayout=!0),isNaN(this.maxTextHeight)){var f=this.documentHelper.textHelper.measureText("a",t.characterFormat);s=(o=f.Height)-f.BaselineOffset}else s=(o=this.maxTextHeight)-this.maxTextBaseline;h=this.getLineSpacing(t,o),"Exactly"===i.lineSpacingType&&h<s+this.maxBaseline&&(h=s+this.maxBaseline);var m,y=0,v=0,b=i.textAlignment,w=0;if("Left"!==b&&this.viewer.textWrap&&("Justify"!==b||!n||"Justify"===b&&i.bidi||this.is2013Justification&&n)&&(y=(m=this.getSubWidth(e,"Justify"===b,v,d,n))[0].subWidth,v=m[0].spaceCount,w=m[0].totalSpaceCount,u=e.isEndsWithPageBreak||e.isEndsWithColumnBreak||e.isEndsWithLineBreak||e.paragraph.bidi||this.isRTLLayout),!u&&m&&1===m.length&&this.viewer.clientActiveArea.width>0&&!n&&!this.is2013Justification&&"Justify"===b&&"Word2013"===this.documentHelper.compatibilityMode){var M=this.viewer.clientActiveArea.width,N=this.getTotalSpaceWidth(e),I=0;return I=M/w/(N/w)*100<=33?N/8:N/4,this.viewer.clientActiveArea.x-=I,this.viewer.clientActiveArea.width+=I,this.is2013Justification=!0,this.moveElementFromNextLine(e),void(this.nextElementToLayout=e.children[e.children.length-1])}this.is2013Justification&&n&&y>0&&(y=0,v=0),this.is2013Justification=!1,this.nextElementToLayout=void 0;for(var S=!1,C=0,O=i.lineSpacingType,T=!1,P=e.renderedElements,A=0;A<P.length;A++){var L=0,F=0,D=0,E=P[A];if(!sf.base.isNullOrUndefined(m)&&T&&E.padding.left>0&&m.length>C+1){var z=y;"Justify"===b?z=y*m[C].spaceCount:"Center"===b&&(z=y/2),E.padding.left=E.padding.left-z;var k=m[++C];y=k.subWidth,v=k.spaceCount}if(!(E instanceof De&&"Inline"!==E.textWrappingStyle)){T=!0;var W=this.alignLineElements(E,L,F,s,S,y,b,v,A===P.length-1);e.maxBaseLine=this.maxBaseline,L=W.topMargin,F=W.bottomMargin,S=W.addSubWidth,v=W.whiteSpaceCount,"Multiple"===O?h>o?F+=h-o:L+=h-o:("Exactly"===O||h>L+E.height+F)&&(L+=h-(L+E.height+F)),p>0&&t===t.bodyWidget.childWidgets[0]&&this.documentHelper.pages[p].sectionIndex===this.documentHelper.pages[p-1].sectionIndex?L+=0:L+=l,"None"!=c.top.lineStyle&&e.isFirstLine()&&!g.skipTopBorder&&(L+=x.convertPointToPixel(c.top.lineWidth+c.top.space)),"None"!=c.bottom.lineStyle&&e.isLastLine()&&!g.skipBottomBorder&&(F+=x.convertPointToPixel(c.bottom.lineWidth+c.bottom.space)),F+=a;var R=A>0?P[A-1]:void 0;(0===A||!(E instanceof De&&"Inline"!==E.textWrappingStyle)&&R instanceof De&&"Inline"!==R.textWrappingStyle||E.padding.left>0)&&(e.height=L+E.height+F,"Right"===b||"Justify"===b&&i.bidi&&n?D=y:"Center"===b&&(D=y<0?y:y/2)),E.margin=new te(D,L,0,F),E.line=e}}if(this.adjustPositionBasedOnTopAndBottom(e),this.checkInbetweenShapeOverlap(e),e.isLastLine()&&0===e.indexInOwner&&e.paragraph.paragraphFormat.widowControl){var j=e.paragraph.previousSplitWidget;if(!sf.base.isNullOrUndefined(j)&&!j.isEndsWithPageBreak&&!j.isEndsWithColumnBreak&&0!==j.indexInOwner){var U=j.childWidgets.length-1;2===j.childWidgets.length&&(U=0),this.splitParagraph(j,U,e.paragraph),this.updateClientAreaForNextBlock(e,e.paragraph)}}this.viewer.cutFromTop(this.viewer.clientActiveArea.y+e.height),this.wrapPosition=[]},t.prototype.checkInbetweenShapeOverlap=function(e,t){var i=this;if(!(e.paragraph.containerWidget instanceof ze)&&e.paragraph.bodyWidget){var r,n=this.getLineY(e),o=e.paragraph.isInsideTable,s=e.paragraph.y,a=!0;sf.base.isNullOrUndefined(t)&&(a=!1,t=e.paragraph.bodyWidget.floatingElements),t.sort((function(e,t){return e.y-t.y})),t.forEach((function(t){if(!(o&&t.line&&!t.line.paragraph.isInsideTable||sf.base.isNullOrUndefined(t.line))){var l;l="TopAndBottom"===t.textWrappingStyle&&t instanceof Re&&!e.paragraph.isEmpty()?new $(e.paragraph.x,i.viewer.clientActiveArea.y,e.paragraph.width,e.children[0].height):new $(e.paragraph.x,i.viewer.clientActiveArea.y,e.paragraph.width,e.height);var h=new $(t.x,t.y-t.distanceTop,t.width,t.height);if(!(t.line&&i.isRelayout&&!i.isRelayoutOverlap&&i.viewer.documentHelper.selection.isExistAfter(t.line.paragraph,e.paragraph)||i.isRelayout&&i.isRelayoutOverlap&&i.viewer.documentHelper.selection.isExistAfter(t.line.paragraph,i.endOverlapWidget))){var d="TopAndBottom"===t.textWrappingStyle,c=t.y+t.height+t.distanceBottom-n;r&&d&&r.y+r.height+r.distanceBottom+e.height>t.y-t.distanceTop&&r.y-r.distanceTop<t.y-t.distanceTop&&t.y+t.height+t.distanceBottom>r.y+r.height+r.distanceBottom?(r=t,e.paragraph.isEmpty()&&a?(e.paragraph.y=s,e.paragraph.y+=c):e.marginTop=c):d&&!r&&l.isIntersecting(h)&&(r=t,e.paragraph.isEmpty()&&a?e.paragraph.y+=c:e.marginTop=c)}}})),r?this.viewer.cutFromTop(r.y+r.height+r.distanceBottom):this.isRelayoutOverlap&&(e.marginTop=0)}},t.prototype.getLineY=function(e){var t=e.paragraph,i=t.y;if(!t.isEmpty())for(var r=t.firstChild;r!==e;)i=i+r.height+r.marginTop,r=r.nextLine;return i},t.prototype.updateLineWidget=function(e){for(var t=0,i=0,r=!1,n=!1,o=0;o<e.children.length;o++){var s=e.children[o];if(s instanceof fe&&2===s.fieldType&&(n=!1),!(n||(s instanceof fe&&0===s.fieldType&&(n=!0),s instanceof De&&"Inline"!==s.textWrappingStyle)))if(s instanceof we&&0===s.text.replace(/\s+/g,"").length)t<s.height&&(t=s.height,i=s.baselineOffset);else if(s instanceof we||s instanceof je){var a=s.height,l=s.baselineOffset;s instanceof we&&s.isCheckBoxElement&&(a/=1.4,l/=1.4),this.maxTextHeight<a&&(this.maxTextHeight=a,this.maxTextBaseline=l),this.maxBaseline<this.maxTextBaseline&&(this.maxBaseline=this.maxTextBaseline)}else this.maxBaseline<s.height&&(this.maxBaseline=s.height,s instanceof Re&&(r=!0))}if(0===this.maxTextHeight&&0!==t)if(r)this.maxTextHeight=0,this.maxTextBaseline=0;else{if(e.isLastLine()&&this.documentHelper.selection){var h=this.documentHelper.selection.getParagraphMarkSize(e.paragraph,0,0);this.maxTextHeight=h.height,this.maxTextBaseline=i}else this.maxTextHeight=t,this.maxTextBaseline=i;this.maxBaseline<this.maxTextBaseline&&(this.maxBaseline=this.maxTextBaseline)}},t.prototype.moveToNextPage=function(e,t,i,r){if(!this.isFootNoteLayoutStart){var n,o=t.paragraph,s=!1,a=!1;if(o&&(sf.base.isNullOrUndefined(o.containerWidget)||sf.base.isNullOrUndefined(o.containerWidget.containerWidget)||!(o.containerWidget.containerWidget instanceof ae))){var l=0;if(o instanceof ae)return;if(!sf.base.isNullOrUndefined(t)&&(0!==(l=o.childWidgets.indexOf(t))&&(o.paragraphFormat.keepLinesTogether&&!sf.base.isNullOrUndefined(o.previousWidget)?(l=0,s=!0):1!=l||t.previousLine.isEndsWithPageBreak||t.previousLine.isEndsWithColumnBreak||!o.paragraphFormat.widowControl||sf.base.isNullOrUndefined(o.previousWidget)||(l=0,s=!0)),(l>0||i)&&(o.height=e.clientActiveArea.y-o.y),0===l&&!o.isEndsWithPageBreak&&!o.isEndsWithColumnBreak)){var h=this.alignBlockElement(o);sf.base.isNullOrUndefined(h.node)||(o=n=h.node instanceof ce?this.splitRow(h.node):h.node,l=n instanceof de?0:parseInt(h.position.index,10),s=!1,a=!0,this.viewer.owner.isDocumentLoaded&&this.viewer.owner.editorModule&&!r&&this.viewer.owner.editorModule.updateWholeListItems(o))}sf.base.isNullOrUndefined(o.bodyWidget)||sf.base.isNullOrUndefined(o.bodyWidget.containerWidget)||o.bodyWidget.containerWidget instanceof ae||void 0===o.bodyWidget.page.footnoteWidget||this.layoutfootNote(o.bodyWidget.page.footnoteWidget);o.bodyWidget.page;var d=this.moveBlocksToNextPage(o,0===l,l);if(this.viewer.updateClientArea(d,d.page),this.viewer.updateClientAreaForBlock(o,!0),l>0){if(t.isLastLine()&&i)return;var c=void 0;c=d.firstChild instanceof le&&d.firstChild.equals(o)?d.firstChild:new le,(c=this.moveChildsToParagraph(o,l,c)).containerWidget=d;var p=this.getFootNoteWidgetsOf(c);this.moveFootNotesToPage(p,o.bodyWidget,d),o=c,this.viewer.clientActiveArea.height-=this.getFootNoteHeight(p)}else i||(o.containerWidget.removeChild(o.indexInOwner),o instanceof le&&o.floatingElements.length>0&&this.addRemoveFloatElementsFromBody(o,o.containerWidget,!1));if(!i){if(-1===d.childWidgets.indexOf(o)&&(d.childWidgets.splice(0,0,o),o instanceof le&&o.floatingElements.length>0&&this.addRemoveFloatElementsFromBody(o,d,!0)),o.containerWidget=d,this.viewer.updateClientAreaLocation(o,this.viewer.clientActiveArea),s||a){o.bodyWidget.page.footnoteWidget&&this.layoutfootNote(o.bodyWidget.page.footnoteWidget),t.paragraph!==o&&(o instanceof de&&this.clearTableWidget(o,!0,!0,!1),this.layoutBlock(o,0),e.updateClientAreaForBlock(o,!1));var u=t.paragraph;if(a){var g=o.nextWidget;if(!sf.base.isNullOrUndefined(g))do{if(e.updateClientAreaForBlock(g,!0),g===u){this.viewer.updateClientAreaLocation(g,this.viewer.clientActiveArea);break}g instanceof de&&this.clearTableWidget(g,!0,!0,!1),this.layoutBlock(g,0),e.updateClientAreaForBlock(g,!1),g=g.nextWidget}while(g)}this.updateClientAreaForNextBlock(t,u)}if(t.isFirstLine()&&0===t.indexInOwner&&!(t.children[0]instanceof je)){var f=-x.convertPointToPixel(t.paragraph.paragraphFormat.firstLineIndent);this.viewer.updateClientWidth(f)}}}if(o instanceof le&&o.floatingElements.length>0&&!i)for(var m=0;m<o.floatingElements.length;m++){var y=o.floatingElements[m],v=this.getFloatingItemPoints(y);y.y=v.y,y.x=v.x,y instanceof Ee&&this.updateChildLocationForCellOrShape(y.y,y)}if(this.isRelayoutOverlap&&this.endOverlapWidget){var b=this.endOverlapWidget.previousRenderedWidget,w=t.paragraph;for(this.startOverlapWidget=w,w=(t=this.endOverlapWidget.childWidgets[0]).paragraph;w;)w.floatingElements.forEach((function(e){-1!==b.bodyWidget.floatingElements.indexOf(e)&&"Inline"!==e.textWrappingStyle&&(b.bodyWidget.floatingElements.splice(b.bodyWidget.floatingElements.indexOf(e),1),t.paragraph.bodyWidget.floatingElements.push(e))})),w=w!==this.endOverlapWidget?w.nextWidget:void 0;this.layoutStartEndBlocks(this.startOverlapWidget,this.endOverlapWidget),this.startOverlapWidget=void 0,this.viewer.clientActiveArea.height=this.viewer.clientActiveArea.bottom-this.endOverlapWidget.y,this.viewer.clientActiveArea.y=this.endOverlapWidget.y}}},t.prototype.moveChildsToParagraph=function(e,t,i){i=this.addParagraphWidget(this.viewer.clientActiveArea,i);for(var r=0,n=t;n<e.childWidgets.length;n++){var o=e.childWidgets[n];o.paragraph=i,i.childWidgets.splice(r,0,o),o.paragraph=i,r++}return i.paragraphFormat=e.paragraphFormat,i.characterFormat=e.characterFormat,i.index=e.index,e.childWidgets.splice(t),i},t.prototype.addRemoveFloatElementsFromBody=function(e,t,i){if(e.floatingElements.length>0)for(var r=0;r<e.floatingElements.length;r++)i?-1===t.floatingElements.indexOf(e.floatingElements[r])&&"Inline"!==e.floatingElements[r].textWrappingStyle&&t.floatingElements.push(e.floatingElements[r]):-1!==t.floatingElements.indexOf(e.floatingElements[r])&&t.floatingElements.splice(t.floatingElements.indexOf(e.floatingElements[r]),1)},t.prototype.alignBlockElement=function(e){if(e instanceof le&&(e.isEndsWithPageBreak||e.isEndsWithColumnBreak))return{node:void 0,position:{index:""}};for(var t,i=0,r=this.getPreviousBlock(e);r;){if(r instanceof le){if(!r.paragraphFormat.keepWithNext||r.isEndsWithPageBreak||r.isEndsWithColumnBreak)break;if(t=r,r.paragraphFormat.keepLinesTogether)sf.base.isNullOrUndefined(this.getPreviousBlock(r))?t=void 0:i=0;else if(sf.base.isNullOrUndefined(this.getPreviousBlock(r))&&1===r.childWidgets.length)t=void 0;else if(r.paragraphFormat.widowControl){if((1===(i=r.lastChild.indexInOwner-1)||i<0)&&(i=0),0!==i)break}else i=r.lastChild.indexInOwner}else if(r instanceof ce){var n=r.childWidgets[0];if(!(n.childWidgets.length>0))break;var o=this.documentHelper.getFirstParagraphInCell(n);if(!o.paragraphFormat.keepWithNext)break;o.paragraphFormat.keepWithNext&&(sf.base.isNullOrUndefined(this.getPreviousBlock(r))?t=void 0:i=(t=r).indexInOwner)}r=this.getPreviousBlock(r)}return{node:t,position:{index:i.toString()}}},t.prototype.getPreviousBlock=function(e){var t;return e instanceof le?t=e.previousWidget:e instanceof ce&&(t=e.previousWidget,sf.base.isNullOrUndefined(t)&&(t=e.ownerTable.previousWidget)),t instanceof de&&(t=t.lastChild),t},t.prototype.splitRow=function(e){var t=e.ownerTable;if(0===e.indexInOwner)return t;for(var i=this.createTableWidget(t),r=e.indexInOwner;r<t.childWidgets.length;){var n=t.childWidgets.splice(r,1)[0];i.childWidgets.push(n),n.containerWidget=i,t.height-=n.height,i.height+=n.height}return t.containerWidget.childWidgets.splice(t.indexInOwner+1,0,i),i.containerWidget=t.containerWidget,i},t.prototype.splitParagraph=function(e,t,i){if(0===t&&sf.base.isNullOrUndefined(i))return e;var r=!1;if(sf.base.isNullOrUndefined(i))(i=new le).containerWidget=e.containerWidget,e.containerWidget.childWidgets.splice(e.indexInOwner+1,0,i),i.paragraphFormat=e.paragraphFormat,i.characterFormat=e.characterFormat,i.index=e.index;else if(0===t){r=!0;var n=e;e=i,i=n}for(var o=0,s=t;s<e.childWidgets.length;s++){var a=e.childWidgets[s];a.paragraph=i,r?i.childWidgets.push(a):i.childWidgets.splice(o,0,a),i.height+=a.height,e.height-=a.height,a.paragraph=i,o++}return r?(i.containerWidget.childWidgets.splice(i.indexInOwner,1),i.y=e.y,i.x=e.x,i.containerWidget=e.containerWidget,e.containerWidget.childWidgets.unshift(i)):e.childWidgets.splice(t),(0===e.childWidgets.length||r)&&e.containerWidget.childWidgets.splice(e.indexInOwner,1),i},t.prototype.updateClientPositionForBlock=function(e,t){var i=e instanceof ce?e.ownerTable:e,r=!1;do{if(this.viewer.updateClientAreaForBlock(i,!0),i instanceof le){if(t instanceof le&&t.equals(i)){r=!0;break}this.addParagraphWidget(this.viewer.clientActiveArea,i),this.viewer.cutFromTop(this.viewer.clientActiveArea.y+i.height),this.viewer.updateClientAreaForBlock(i,!1)}else if(i instanceof de){this.addTableWidget(this.viewer.clientActiveArea,[i]);var n=i.firstChild;if(t instanceof ce&&i.equals(t.ownerTable)&&!sf.base.isNullOrUndefined(n))do{if(n.equals(t)){r=!0;break}this.addTableRowWidget(this.viewer.clientActiveArea,[n]),this.updateChildLocationForRow(this.viewer.clientActiveArea.y,n),this.viewer.cutFromTop(this.viewer.clientActiveArea.y+n.height),i.height+=n.height,n=n.nextWidget}while(n);else this.updateChildLocationForTable(i.y,i),this.viewer.cutFromTop(this.viewer.clientActiveArea.y+i.height),this.viewer.updateClientAreaForBlock(i,!1)}i=i.nextWidget}while(i&&!r)},t.prototype.updateClientAreaForNextBlock=function(e,t){for(var i=0;i<t.childWidgets.length;i++){var r=t.childWidgets[i];if(e===r)break;this.viewer.cutFromTop(this.viewer.clientActiveArea.y+r.height)}},t.prototype.layoutStartEndBlocks=function(e,t){var i,r=e;for(this.isOverlapFloatTable=!0,this.viewer.clientActiveArea.height=this.viewer.clientActiveArea.bottom-e.y,this.viewer.clientActiveArea.y=e.y,i=e instanceof de?this.documentHelper.getFirstParagraphInFirstCell(e):e,this.viewer.owner.isDocumentLoaded&&this.viewer.owner.editorModule&&this.viewer.owner.editorModule.updateWholeListItems(i);r;)this.viewer.updateClientAreaForBlock(r,!0),r instanceof le?this.layoutParagraph(r,0):(this.clearTableWidget(r,!0,!0,!0),this.layoutTable(r,0)),this.viewer.updateClientAreaForBlock(r,!1),r=r!==t?r.nextWidget:void 0},t.prototype.alignLineElements=function(e,t,i,r,n,o,s,a,l){if(e.width>0&&(e instanceof we||e instanceof je)){var h=e instanceof we?e:void 0,d=e instanceof we?h.baselineOffset:e.baselineOffset;if(t+=this.maxBaseline-d,i+=r-(e.height-d),!sf.base.isNullOrUndefined(h)&&"Justify"===s&&a>0){var c=h.width,p=h.text;if(n||(n=(p=x.trimStart(p)).length>0),n){var u=p.length-x.removeSpace(p).length;l&&(u-=p.length-x.trimEnd(p).length),a<u&&(c=this.documentHelper.textHelper.measureTextExcludingSpaceAtEnd(p,h.characterFormat,h.scriptType),u=a),u>0&&(h.width=c+o*u,a-=u)}}}else n=!0,t+=this.maxBaseline-e.height,i+=r;return{topMargin:t,bottomMargin:i,addSubWidth:n,whiteSpaceCount:a}},t.prototype.updateWidgetToPage=function(e,t){if(t.isInsideTable){var i=t.associatedCell;if(t.height=e.clientActiveArea.y-t.y,sf.base.isNullOrUndefined(t.associatedCell)||sf.base.isNullOrUndefined(t.associatedCell.ownerRow)||sf.base.isNullOrUndefined(t.associatedCell.ownerRow.rowFormat))return;"Exactly"===t.associatedCell.ownerRow.rowFormat.heightType?i.height=x.convertPointToPixel(t.associatedCell.ownerRow.rowFormat.height):[i].length<=1&&"AtLeast"===t.associatedCell.ownerRow.rowFormat.heightType?i.height=Math.max(x.convertPointToPixel(t.associatedCell.ownerRow.rowFormat.height),this.getCellContentHeight(i)):i.height=i.height+t.height,t.containerWidget=i}else(!t.isEndsWithPageBreak&&!t.isEndsWithColumnBreak||e instanceof Z)&&(t.height=e.clientActiveArea.y-t.y);this.isRelayoutFootnote&&t.bodyWidget instanceof ae&&(t.isInsideTable||(t.containerWidget.height+=t.height),this.shiftFootnoteChildLocation(t.bodyWidget,this.viewer)),t.bodyWidget instanceof oe&&(t.isInsideTable||(t.containerWidget.height+=t.height),this.viewer.owner.enableHeaderAndFooter&&-1!==t.bodyWidget.headerFooterType.indexOf("Footer")&&this.shiftFooterChildLocation(t.bodyWidget,this.viewer)),e instanceof Z&&t.containerWidget instanceof ne&&(t.containerWidget.height+=t.height)},t.prototype.shiftFooterChildLocation=function(e,t){var i=e.page.bodyWidgets[0].sectionFormat.pageHeight;if(-1!==e.headerFooterType.indexOf("Footer")){var r,n=e.page.bodyWidgets[0].sectionFormat.footerDistance,o=x.convertPointToPixel(i-n);e.y+e.height>o?r=o-(e.y+e.height):e.y+e.height<o&&(r=e.y+e.height-o),sf.base.isNullOrUndefined(r)||(r=o-(e.y+e.height),this.shiftChildLocation(r,e),t.clientActiveArea.y+=r)}},t.prototype.shiftFootnoteChildLocation=function(e,t){var i,r=e.page.bodyWidgets[0].sectionFormat.pageHeight,n=(e.page.bodyWidgets[0].sectionFormat.footerDistance,e.page.bodyWidgets[0].sectionFormat.bottomMargin),o=x.convertPointToPixel(r-n);e.y+e.height>o?i=o-(e.y+e.height):e.y+e.height<o&&(i=e.y+e.height-o),sf.base.isNullOrUndefined(i)||(i=o-(e.y+e.height),this.shiftChildLocation(i,e),t.clientActiveArea.y+=i)},t.prototype.checkPreviousElement=function(e,t,i){for(var r=e.paragraph,n=!1,o=0,s=t-1;s>=0;s--){var a=e.children[s];if(a instanceof we&&a.width>0){var l=a.text;if(o=s,l.length>0&&(" "===l[l.length-1]||"-"===l[l.length-1])){if(s===t-1)return this.addSplittedLineWidget(e,t-1),!0;n=!0;break}if("\t"===l)return!1;if(l.indexOf(" ")>=0){n=!0;var h=l.lastIndexOf(" ")+1,d=new we;d.text=l.substr(h),d.characterFormat.copyFormat(a.characterFormat),d.characterRange=a.characterRange,a.revisions.length>0&&(this.updateRevisionForSplittedElement(a,d,h>0),d.isMarkedForRevision=a.isMarkedForRevision),a.text=l.substr(0,h),this.documentHelper.textHelper.getTextSize(d,i),a.width-=d.width,a.height=d.height,0===a.width&&e.children.splice(s,1),e.children.splice(s+1,0,d);break}}else if(!(a instanceof je||a instanceof fe||a instanceof we&&0===a.width)){o=s,n=!0;break}}if(n&&++o<e.children.length){var c=0;for(s=o;s<e.children.length;s++)c+=e.children[s].width,this.addSplittedLineWidget(e,s-1),s--;"Justify"===r.paragraphFormat.textAlignment&&"Word2013"===this.documentHelper.compatibilityMode||this.viewer.updateClientWidth(c)}return n},t.prototype.clearListElementBox=function(e){if(0!==e.childWidgets.length){var t=e.childWidgets[0];if(!sf.base.isNullOrUndefined(t.children)){for(var i=t.children.length-1;i>0&&t.children[i]instanceof je;i--)t.children.splice(i,1);for(i=0;i<t.children.length&&t.children[i]instanceof je;i++)t.children.splice(i,1),i--}}},t.prototype.getListNumber=function(e,t){var i=this.documentHelper.getListById(e.listId),r=e.listLevelNumber,n=this.getListLevel(i,e.listLevelNumber),o=sf.base.isNullOrUndefined(i.levelOverrides)?void 0:i.levelOverrides[r];if(!sf.base.isNullOrUndefined(o)&&-1===this.documentHelper.renderedLevelOverrides.indexOf(o)&&sf.base.isNullOrUndefined(o.overrideListLevel)){this.documentHelper.renderedLevelOverrides.push(o);var s=this.documentHelper.getAbstractListById(i.abstractListId);if(this.documentHelper.renderedLists.containsKey(s)){var a=this.documentHelper.renderedLists.get(s);a.containsKey(r)&&(a.remove(r),this.ClearSubListLevelValues(i,s,r))}}return sf.base.isNullOrUndefined(t)&&this.updateListValues(i,r),this.getListText(i,r,n)},t.prototype.ClearSubListLevelValues=function(e,t,i){for(var r=this.documentHelper.renderedLists.get(t),n=i+1;n<t.levels.length;){var o=this.getListLevel(e,n);r.containsKey(n)&&o.restartLevel>i&&r.remove(n),n++}},t.prototype.getListStartValue=function(e,t){var i=sf.base.isNullOrUndefined(t.levelOverrides)?void 0:t.levelOverrides[e];if(!sf.base.isNullOrUndefined(i)&&sf.base.isNullOrUndefined(i.overrideListLevel))return i.startAt;var r=this.getListLevel(t,e);return sf.base.isNullOrUndefined(r)?0:r.startAt},t.prototype.updateListValues=function(e,t){var i=this.documentHelper.getAbstractListById(e.abstractListId);if(this.documentHelper.renderedLists.containsKey(i)){var r=this.documentHelper.renderedLists.get(i);if(r.containsKey(t)){var n=r.get(t);r.set(t,n+1);for(var o=t+1;o<this.documentHelper.getAbstractListById(e.abstractListId).levels.length;){l=this.getListLevel(e,o);r.containsKey(o)&&l.restartLevel>t&&r.remove(o),o++}}else{for(o=t;!r.containsKey(o-1)&&o>0;){l=this.getListLevel(e,o-1);r.add(o-1,this.getListStartValue(o-1,e)),o--}n=this.getListStartValue(t,e);r.add(t,n)}}else{var s=new a;this.documentHelper.renderedLists.add(i,s);for(var l=this.getListLevel(e,t),h=0;h<=t;h++)s.add(h,this.getListStartValue(h,e))}},t.prototype.getListText=function(e,t,i){var r=i.numberFormat;if(this.documentHelper.renderedLists.containsKey(this.documentHelper.getAbstractListById(e.abstractListId)))for(var n=this.documentHelper.renderedLists.get(this.documentHelper.getAbstractListById(e.abstractListId)),o=n.keys,s=0;s<o.length;s++){var a=o[s],l="%"+(a+1).toString(),h=this.getListLevel(e,a);if(r.match(l)){if(a>t)return"";r=n.containsKey(a)&&!sf.base.isNullOrUndefined(h)?r.replace(l,this.getListTextListLevel(h,n.get(a))):r.replace(l,"0")}}return r},t.prototype.getAsLetter=function(e){var t=e/26,i=e%26;0===i&&(i=26,t--);for(var r=String.fromCharCode(64+i),n="";t>=0;)n+=r.toString(),t--;return n},t.prototype.getListTextListLevel=function(e,t){switch(e.listLevelPattern){case"UpRoman":return this.getAsRoman(t).toUpperCase();case"LowRoman":return this.getAsRoman(t).toLowerCase();case"UpLetter":return this.getAsLetter(t).toUpperCase();case"LowLetter":return this.getAsLetter(t).toLowerCase();case"Arabic":return t.toString();case"LeadingZero":return this.getAsLeadingZero(t);case"Number":case"OrdinalText":return t.toString();case"Ordinal":return this.getAsOrdinal(t,e.characterFormat).toString();case"FarEast":case"Special":return t.toString();default:return""}},t.prototype.getFootEndNote=function(e,t){switch(e){case"UpperCaseRoman":return this.getAsRoman(t).toUpperCase();case"LowerCaseRoman":return this.getAsRoman(t).toLowerCase();case"UpperCaseLetter":return this.getAsLetter(t).toUpperCase();case"LowerCaseLetter":return this.getAsLetter(t).toLowerCase();default:return t.toString()}},t.prototype.generateNumber=function(e,t,i){for(var r="";e>=t;)e-=t,r+=i,this.value=e;return r.toString()},t.prototype.getAsLeadingZero=function(e){return e<10?"0"+e.toString():e.toString()},t.prototype.getAsRoman=function(e){var t="";return this.value=e,t+=this.generateNumber(this.value,1e3,"M"),t+=this.generateNumber(this.value,900,"CM"),t+=this.generateNumber(this.value,500,"D"),t+=this.generateNumber(this.value,400,"CD"),t+=this.generateNumber(this.value,100,"C"),t+=this.generateNumber(this.value,90,"XC"),t+=this.generateNumber(this.value,50,"L"),t+=this.generateNumber(this.value,40,"XL"),t+=this.generateNumber(this.value,10,"X"),t+=this.generateNumber(this.value,9,"IX"),t+=this.generateNumber(this.value,5,"V"),t+=this.generateNumber(this.value,4,"IV"),(t+=this.generateNumber(this.value,1,"I")).toString()},t.prototype.getAsOrdinal=function(e,t){switch(t.localeIdAscii){case 1069:case 8218:case 5146:case 4122:case 1050:case 1029:case 1061:case 1035:case 3079:case 1031:case 5127:case 4103:case 2055:case 1038:case 1060:case 1055:case 1044:case 2068:case 1045:case 6170:case 2074:return e.toString()+".";case 2060:case 11276:case 3084:case 9228:case 12300:case 1036:case 15372:case 5132:case 13324:case 6156:case 14348:case 8204:case 10252:case 4108:return 1==e?e.toString()+"er":e.toString()+"e";case 2067:case 1043:return e.toString()+"e";case 1032:return e.toString()+"o";case 1040:case 2064:return e.toString()+String.fromCharCode(176);case 5130:case 7178:case 12298:case 17418:case 4106:case 1046:case 2070:case 11274:case 16394:case 13322:case 9226:case 18442:case 2058:case 19466:case 6154:case 15370:case 10250:case 20490:case 3082:case 1034:case 21514:case 14346:case 8202:return e.toString()+String.fromCharCode(186);case 1049:case 2073:return e.toString()+"-"+String.fromCharCode(1081);case 2077:case 1053:return this.getOrdinalInSwedish(e);case 1027:return this.getOrdinalInCatalan(e);case 1030:return this.getOrdinalInDanish(e);default:return this.getOrdinalInEnglish(e)}},t.prototype.getOrdinalInEnglish=function(e){switch(e%100){case 11:case 12:case 13:return e.toString()+"th"}switch(e%10){case 1:return e.toString()+"st";case 2:return e.toString()+"nd";case 3:return e.toString()+"rd";default:return e.toString()+"th"}},t.prototype.getOrdinalInSwedish=function(e){return 11==e||12==e?e.toString()+":e":e%10==1||e%10==2?e.toString()+":a":e.toString()+":e"},t.prototype.getOrdinalInCatalan=function(e){switch(e){case 1:return e.toString()+".";case 2:return e.toString()+"n";case 3:return e.toString()+"r";case 4:return e.toString()+"t";case 14:return e.toString()+String.fromCharCode(232)+"h";default:return e.toString()+String.fromCharCode(232)}},t.prototype.getOrdinalInDanish=function(e){if(0==e)return e.toString()+"te";switch(e%100){case 0:return e.toString()+"ende";case 1:return e.toString()+"ste";case 2:return e.toString()+"nden";case 3:return e.toString()+"dje";case 4:return e.toString()+"rde";case 5:case 6:case 11:case 12:case 30:return e.toString()+"te";default:return e.toString()+"nde"}},t.prototype.getListLevel=function(e,t){if(!sf.base.isNullOrUndefined(e)){var i=this.documentHelper.getAbstractListById(e.abstractListId);!sf.base.isNullOrUndefined(e)&&i.levels.length<=t&&t>=0&&t<9&&this.addListLevels(i);var r=void 0;if(!sf.base.isNullOrUndefined(e.levelOverrides)&&!sf.base.isNullOrUndefined(r=this.getOverrideListLevel(e.levelOverrides,t))&&!sf.base.isNullOrUndefined(r.overrideListLevel))return sf.base.isNullOrUndefined(r.startAt)&&(r.overrideListLevel.startAt=i.levels[t].startAt),r.overrideListLevel;if(!sf.base.isNullOrUndefined(i)&&t>=0&&t<i.levels.length)return i.levels[t]}},t.prototype.getOverrideListLevel=function(e,t){for(var i=0;i<e.length;i++)if(e[i].levelNumber==t)return e[i]},t.prototype.getTabWidth=function(e,t,i,r,n){var o=0,s=!1,a=e.paragraphFormat.getUpdatedTabs(),l=!1,h=e.bodyWidget.sectionFormat,d=(x.convertPointToPixel(h.leftMargin),!1);if(!sf.base.isNullOrUndefined(e.paragraphFormat.listFormat.listLevel)&&!sf.base.isNullOrUndefined(e.paragraphFormat.listFormat.listLevel.paragraphFormat)){var c=e.paragraphFormat.listFormat.listLevel.paragraphFormat;e.paragraphFormat.leftIndent!==c.leftIndent&&(l=!0)}var p=0,u=t.clientActiveArea.x,g=x.convertPointToPixel(e.paragraphFormat.firstLineIndent),f=x.convertPointToPixel(e.paragraphFormat.leftIndent);if(!sf.base.isNullOrUndefined(n)&&r.isFirstLine()?(p=this.viewer.clientArea.x+g,l&&(u+=g)):p=this.viewer.clientArea.x,u<p)return t.clientArea.x-t.clientActiveArea.x;for(var m=t.clientActiveArea.x-(t.clientArea.x-x.convertPointToPixel(e.paragraphFormat.leftIndent)),y=0;y<a.length;y++){var v=a[y],b=x.convertPointToPixel(v.position);b<f&&(d=parseFloat(m.toFixed(2))<parseFloat(b.toFixed(2)))}if(r.isFirstLine()&&f>0&&g<0&&(n instanceof je||!d)){if(t.clientArea.x-t.clientActiveArea.x>0)return t.clientArea.x-t.clientActiveArea.x;0===a.length&&e.paragraphFormat.listFormat&&e.paragraphFormat.listFormat.listLevel&&(a=e.paragraphFormat.listFormat.listLevel.paragraphFormat.tabs)}var w=x.convertPointToPixel(this.documentHelper.defaultTabWidth);if(0===a.length&&(m>0&&w>Math.round(m)&&l||w===this.defaultTabWidthPixel&&w>Math.round(m)))return w-m;var M=!1;if(a.length>0){for(y=a.length-1;y>-1;y--){v=a[y];var N=x.convertPointToPixel(v.position);if(!(parseFloat(N.toFixed(2))>parseFloat(m.toFixed(2)))){if(y>0&&x.convertPointToPixel(a[y-1].position)>parseFloat(m.toFixed(2)))continue;if(y!=a.length-1){var I=this.getJustificationTabWidth(a[y+1],n,r,e,w,m,o);w=I.defaultTabWidth,o=I.fPosition,m=I.position,s=!0}M=!0;break}}if(!M){var S=this.getJustificationTabWidth(a[0],n,r,e,w,m,o);w=S.defaultTabWidth,o=S.fPosition,m=S.position,s=!0}}return s||(o=((m-parseFloat((100*m%(100*w)/100).toFixed(2)))/w+1)*w),parseFloat(o.toFixed(1))===parseFloat(m.toFixed(1))?w:o-m>0?o-m:w},t.prototype.getJustificationTabWidth=function(e,t,i,r,n,o,s){var a=t?this.documentHelper.textHelper.getTextSize(t,t.characterFormat):0;if("Left"===e.tabJustification||"List"===e.tabJustification)s=x.convertPointToPixel(e.position),t instanceof Se&&(t.tabLeader=e.tabLeader,t.tabText="");else{var l=x.convertPointToPixel(e.position)-o,h=this.getRightTabWidth(t.indexInOwner+1,i,r);if(h<l&&"Decimal"!=e.tabJustification)if("Right"===e.tabJustification){n=l-h;var d=x.convertPointToPixel(r.rightIndent),c=this.viewer.clientActiveArea.width+d-n;this.viewer.clientActiveArea.width+=d,c<0?n+=c-h:h>c&&(n-=h-c)}else n=l-h/2;else if("Center"===e.tabJustification&&h/2<l)n=l-h/2;else if("Decimal"===e.tabJustification)if(!sf.base.isNullOrUndefined(t.nextElement)&&t.nextElement instanceof we){var p=t.nextElement;if(-1!=p.text.indexOf(".")){var u=p.text.indexOf("."),g=p.text.substring(0,u);n=l-this.documentHelper.textHelper.getWidth(g,p.characterFormat,p.scriptType)}else n=h<l?l-h:l}else n=l;else n="Right"===e.tabJustification?0:a;s=o,t instanceof Se&&(t.tabLeader=e.tabLeader,t.tabText="")}return{defaultTabWidth:n,fPosition:s,position:o}},t.prototype.getRightTabWidth=function(e,t,i){for(var r=0,n=!1,o=t.children[e];o;){if(o instanceof fe||o instanceof Ce||n)o instanceof fe&&(0===o.fieldType?n=!0:2===o.fieldType&&(n=!1)),o.width=0;else{if(o instanceof Ie&&!this.isTocField(o.fieldBegin)){var s=this.documentHelper.getFieldResult(o.fieldBegin,o.paragraph.bodyWidget.page);""!==s&&(o.text=s)}o instanceof we&&this.documentHelper.textHelper.getTextSize(o,o.characterFormat)}if(o instanceof we&&"\t"===o.text)return r;r+=o.width,o=o.nextNode}return r},t.prototype.getSplitIndexByWord=function(e,t,i,r,n){for(var o=0,s=t.length;o<s;){var a=this.getTextIndexAfterSpace(t,o);0!==a&&a!==s||(a=s-1);var l=i;if((a<s-1||a===s-1&&" "===t[a-1])&&o!==a&&(l=this.documentHelper.textHelper.measureTextExcludingSpaceAtEnd(t.slice(0,a),r,n)),!(l<=e)){0===o&&" "===t[0]&&(o=this.getTextIndexAfterSpace(t,0));break}o=a}return o},t.prototype.getTextSplitIndexByCharacter=function(e,t,i,r,n,o){for(var s=i.length,a=0;a<s;a++){var l=r;if(a+1<s&&(l=this.documentHelper.textHelper.measureTextExcludingSpaceAtEnd(i.substring(0,a+1),n,o)),l>t)return 0===a&&l>e?s>1&&" "===i[1]?this.getTextIndexAfterSpace(i,1):1:a}return 0},t.prototype.getSubWidth=function(e,t,i,r,n){var o=0,s=!0,a="",l=0;if(this.wrapPosition.length>0){var h=this.getSubWidthBasedOnTextWrap(e,t,i,r,n);if(h.length>0)return h}for(var d=e.renderedElements,c=d.length-1;c>=0;c--){var p=d[c];if(p.width>0&&p instanceof we){var u=p.text;if(a=u+a,!s||""===u.trim()&&"\t"!==u)s?l+=p.width:o+=p.width;else{if(x.endsWith(u)){var g=this.documentHelper.textHelper.measureTextExcludingSpaceAtEnd(u,p.characterFormat,p.scriptType);o+=g,l+=p.width-g}else o+=p.width;s=!1}}else{if(a="a"+a,s=!1,p instanceof De&&"Inline"!==p.textWrappingStyle)continue;o+=p.width}o=t?o:Math.round(o)}var f=a.length-x.removeSpace(a).length;i=(a=a.trim()).length-x.removeSpace(a).length;var m=this.viewer.clientArea.width-r-o;return m<=0&&!this.is2013Justification||0===i&&t&&!e.paragraph.paragraphFormat.bidi?(i=0,m=0):t?!n&&i>0||n&&this.is2013Justification&&i>0?m/=i:i=0:l>0&&e.paragraph.paragraphFormat.bidi&&n&&(m-=l),[{subWidth:m,spaceCount:i,totalSpaceCount:f}]},t.prototype.getSubWidthBasedOnTextWrap=function(e,t,i,r,n){for(var o=[],s=0,a="",l=this.wrapPosition.length-1,h=!0,d=e.children.length-1;d>=0;d--){var c=e.children[d];if(c.width>0&&c instanceof we){var p=c.text;a=p+a,!h||""===p.trim()&&"\t"!==p?h||(s+=c.width):(x.endsWith(p)?s+=this.documentHelper.textHelper.measureTextExcludingSpaceAtEnd(p,c.characterFormat,c.scriptType):s+=c.width,h=!1)}else a="a"+a,h=!1,c instanceof De&&"Inline"!==c.textWrappingStyle||(s+=c.width);if((c.padding.left>0||0===d)&&l>=0){for(var u=this.wrapPosition[l--];u.width<=0&&l>=0;)u=this.wrapPosition[l--];var g=this.getSubWidthInfo(e,u.width,s,a,i,t,n);sf.base.isNullOrUndefined(g)||(s=0,a="",o.unshift(g))}}return o},t.prototype.getTotalSpaceWidth=function(e){var t=0;if(e)for(var i=0;i<e.children.length;i++){var r=e.children[i];if(r instanceof we){var n=r.text.length-x.removeSpace(r.text).length;if(n>0)t+=n*this.documentHelper.textHelper.getWidth(" ",r.characterFormat,r.scriptType)}}return t},t.prototype.getSubWidthInfo=function(e,t,i,r,n,o,s){if(t>0){var a=t-i;n=(r=r.trim()).length-x.removeSpace(r).length;var l=a;return l<=0||0===n&&o&&!e.paragraph.paragraphFormat.bidi?(n=0,l=0):o&&(!s&&n>0?l/=n:n=0),{subWidth:l,spaceCount:n,totalSpaceCount:n}}},t.prototype.getBeforeSpacing=function(e,t){var i=0;if(this.documentHelper.dontUseHtmlParagraphAutoSpacing)i=e.paragraphFormat.beforeSpacing;else{var r=e.previousWidget;if(r instanceof le){var n=this.getAfterSpacing(r),o=e.paragraphFormat.beforeSpacing;e.paragraphFormat.spaceBeforeAuto&&(o=14),n<o&&(i=o-n)}else r instanceof de?i=e.paragraphFormat.spaceBeforeAuto?14:e.paragraphFormat.beforeSpacing:t>0&&e===e.bodyWidget.childWidgets[0]?this.documentHelper.pages[t].sectionIndex!==this.documentHelper.pages[t-1].sectionIndex&&(i=e.paragraphFormat.spaceBeforeAuto?14:e.paragraphFormat.beforeSpacing):i=e.paragraphFormat.spaceBeforeAuto?0:e.paragraphFormat.beforeSpacing}return this.isSameStyle(e,!1)?0:x.convertPointToPixel(i)},t.prototype.getAfterSpacing=function(e){var t=e.paragraphFormat.afterSpacing;return!this.documentHelper.dontUseHtmlParagraphAutoSpacing&&e.paragraphFormat.spaceAfterAuto&&(t=sf.base.isNullOrUndefined(e.nextWidget)&&e.isInsideTable?0:14),this.isSameStyle(e,!0)?0:t},t.prototype.getLineSpacing=function(e,t,i){if(sf.base.isNullOrUndefined(e.paragraphFormat))return 0;var r=0;switch(e.paragraphFormat.lineSpacingType){case"AtLeast":case"Exactly":r=x.convertPointToPixel(e.paragraphFormat.lineSpacing);break;default:r=e.paragraphFormat.lineSpacing,i&&(r-=1),r*=t}return r},t.prototype.isParagraphFirstLine=function(e,t){var i=e;return!(!sf.base.isNullOrUndefined(i.childWidgets)&&0!==i.childWidgets.indexOf(t))&&(!(t.children.length>0&&!sf.base.isNullOrUndefined(e.previousWidget)&&e.previousWidget instanceof le)||t.paragraph.index!==e.previousWidget.index)},t.prototype.isParagraphLastLine=function(e){var t=e.line.paragraph,i=t.childWidgets[t.childWidgets.length-1],r=i.children[i.children.length-1];return e===r&&(r instanceof fe||!(r instanceof we&&"\v"===r.text))},t.prototype.getTextIndexAfterSpace=function(e,t){var i=e.length,r=0,n=0;r=e.indexOf(" ",t)+1,1==(n=e.indexOf("-",t)+1)&&(n=e.indexOf("-",n+1)+1),n>0&&r>0?r=Math.min(r,n):n>0&&0==r&&(r=n);var o=r;if(0===o||o===i)return o;for(;(" "===e[o]||"-"===e[o])&&++o!==i;);return o},t.prototype.moveNextWidgetsToTable=function(e,t,i){var r=t.indexInOwner,n=e[e.length-1];i&&(r+=1);for(var o=t.containerWidget.childWidgets.splice(r),s=0;s<o.length;s++)n.childWidgets.push(o[s]),o[s].containerWidget=n},t.prototype.addTableCellWidget=function(e,t,i,r){var n,o=0,s=0,a=i,l=0,h=r;sf.base.isNullOrUndefined(e.cellFormat)||(e.cellFormat.containsMargins()?(s=sf.base.isNullOrUndefined(e.cellFormat.leftMargin)?x.convertPointToPixel(e.ownerTable.tableFormat.leftMargin):x.convertPointToPixel(e.cellFormat.leftMargin),l=sf.base.isNullOrUndefined(e.cellFormat.rightMargin)?x.convertPointToPixel(e.ownerTable.tableFormat.rightMargin):x.convertPointToPixel(e.cellFormat.rightMargin)):(s=0===e.columnIndex&&e.ownerRow.rowFormat.hasValue("leftMargin")?x.convertPointToPixel(e.ownerRow.rowFormat.leftMargin):x.convertPointToPixel(e.ownerTable.tableFormat.leftMargin),l=e.columnIndex===e.ownerTable.tableHolder.columns.length-1&&e.ownerRow.rowFormat.hasValue("rightMargin")?x.convertPointToPixel(e.ownerRow.rowFormat.rightMargin):x.convertPointToPixel(e.ownerTable.tableFormat.rightMargin))),e.margin=new te(s,a,l,h);e.ownerTable.tableFormat.allowAutoFit;var d=e.cellFormat.cellWidth;if("Percent"===e.cellFormat.preferredWidthType&&0!==e.cellFormat.preferredWidth&&d<=0){var c=x.convertPointToPixel(e.ownerTable.getTableClientWidth(e.ownerTable.getContainerWidth()));d=e.ownerTable.getCellWidth(e.cellFormat.preferredWidth,e.cellFormat.preferredWidthType,c,e)}e.width=x.convertPointToPixel(d),sf.base.isNullOrUndefined(e.previousWidget)||(o=e.previousWidget.columnIndex+e.previousWidget.cellFormat.columnSpan),n=sf.base.isNullOrUndefined(e.ownerTable)||sf.base.isNullOrUndefined(e.ownerTable.tableFormat)?0:x.convertPointToPixel(e.ownerTable.tableFormat.cellSpacing);var p=0;o<e.columnIndex&&(p=x.convertPointToPixel(e.ownerTable.tableHolder.getPreviousSpannedCellWidth(o,e.columnIndex)),0===o&&(p-=n/2)),e.x=t.x+p+e.margin.left,e.y=t.y+e.margin.top+n,e.width=e.width-e.margin.left-e.margin.right,n>0&&(e.x+=n,1===e.ownerTable.tableHolder.columns.length?e.width-=2*n:0===e.columnIndex||e.columnIndex===e.ownerTable.tableHolder.columns.length-1?e.width-=2*n-n/2:e.width-=n);var u=x.convertPointToPixel(pe.getCellLeftBorder(e).getLineWidth()),g=x.convertPointToPixel(pe.getCellRightBorder(e).getLineWidth()),f=!1;e.leftBorderWidth=e.ownerTable.isBidiTable?g:u;var m="None"===e.cellFormat.borders.left.lineStyle,y="None"===e.cellFormat.borders.right.lineStyle;e.x+=m?e.leftBorderWidth>0?0:e.leftBorderWidth:0,e.width-=m?e.leftBorderWidth>0?0:e.leftBorderWidth:0;e.ownerTable.isBidiTable?e.cellIndex:(e.cellIndex,e.ownerRow.childWidgets.length);return(n>0||e.columnIndex===e.ownerTable.tableHolder.columns.length-1||e.index===e.containerWidget.childWidgets.length-1)&&(e.rightBorderWidth=e.ownerTable.isBidiTable?u:g,e.ownerTable.tableFormat.allowAutoFit||(e.width-=e.rightBorderWidth),this.isInsertTable()||(f=this.checkPreviousMargins(e.ownerTable))),e.margin.right+=y&&!f?0:e.rightBorderWidth,e.width<e.sizeInfo.minimumWidth/2&&!this.isInitialLoad&&(e.width=e.sizeInfo.minimumWidth/2),e},t.prototype.isInsertTable=function(){return!(!this.documentHelper.owner.editorHistory||!this.documentHelper.owner.editorHistory.currentBaseHistoryInfo||"InsertTable"!==this.documentHelper.owner.editorHistory.currentBaseHistoryInfo.action)},t.prototype.checkPreviousMargins=function(e){for(var t=0;t<e.childWidgets.length;t++)for(var i=e.childWidgets[t],r=0;r<i.childWidgets.length;r++){if("None"!==i.childWidgets[i.childWidgets.length-1].cellFormat.borders.right.lineStyle)return!0}return!1},t.prototype.addWidgetToTable=function(e,t,i,r,n,o,s,a){var l=t[0],h=l.childWidgets.length,d=void 0,c=i.indexOf(r),p=[];if(c>0?d=i[c-1]:r.previousRenderedWidget instanceof ce&&r.previousRenderedWidget.ownerTable.equals(r.ownerTable)&&(d=r.previousRenderedWidget),!sf.base.isNullOrUndefined(d)){if(h=(l=d.containerWidget).childWidgets.indexOf(d)+1,Math.round(r.y)!==Math.round(d.y+d.height)){var u=t.indexOf(l);u+1>=t.length&&this.addTableWidget(e.clientActiveArea,t,!0),h=(l=t[u+1]).childWidgets.length}c>0&&(h=0)}if(this.updateRowHeightBySpannedCell(l,r,h),this.updateRowHeightByCellSpacing(t,r,e),r.containerWidget&&r.containerWidget!==l&&-1!==r.containerWidget.childWidgets.indexOf(r)&&r.containerWidget.childWidgets.splice(r.containerWidget.childWidgets.indexOf(r),1),-1===l.childWidgets.indexOf(r)&&l.childWidgets.splice(h,0,r),r.containerWidget=l,!r.ownerTable.isInsideTable){if(n.length>0)sf.base.isNullOrUndefined(n)||(p=this.getFootnoteBody(n));else if(!sf.base.isNullOrUndefined(r))for(var g=0;g<r.childWidgets.length;g++)for(var f=r.childWidgets[g],m=0;m<f.childWidgets.length;m++)for(var y=this.getFootNoteWidgetsOf(f.childWidgets[m],!0),v=0;v<y.length;v++)p.splice(p.length,0,y[v]);p.length>0&&sf.base.isNullOrUndefined(p[0].containerWidget)?this.layoutFootnoteInSplittedRow(r,p):!sf.base.isNullOrUndefined(p)&&p.length>0&&void 0!==r.bodyWidget.previousRenderedWidget&&a!==r.bodyWidget.page.index&&p[0].containerWidget.page.index!==r.bodyWidget.page.index?this.moveFootNotesToPage(p,p[0].containerWidget.page.bodyWidgets[0],r.bodyWidget):this.isInitialLoad||sf.base.isNullOrUndefined(r.bodyWidget.page.footnoteWidget)||this.layoutfootNote(r.bodyWidget.page.footnoteWidget),n.length=0}l.height=l.height+r.height,this.viewer instanceof X&&(sf.base.isNullOrUndefined(l.containerWidget)||!(l.containerWidget.childWidgets.indexOf(l)>=0)||l.containerWidget instanceof oe||(l.containerWidget.height+=r.height)),this.updateHeightForRowWidget(e,!1,t,i,r,!1,o,s),e.cutFromTop(r.y+r.height),this.viewer.clientActiveArea.height-=this.getFootNoteHeight(p),this.existFootnoteHeight=0},t.prototype.layoutFootnoteInSplittedRow=function(e,t){if(t&&t.length>0){sf.base.isNullOrUndefined(e.ownerTable.bodyWidget.page.footnoteWidget)&&this.addEmptyFootNoteToBody(e.ownerTable.bodyWidget);var i=e.ownerTable.bodyWidget.page.footnoteWidget;if(i){for(var r=0;r<t.length;r++)i.bodyWidgets.push(t[r]),t[r].containerWidget=i;this.layoutfootNote(i)}}},t.prototype.getFootNoteHeight=function(e){var t=0;if(Array.isArray(e))for(var i=0;i<e.length;i++)t+=this.getFootnoteHeightInternal(e[i]);else t=this.getFootnoteHeightInternal(e);return t},t.prototype.getFootnoteHeightInternal=function(e){for(var t=0,i=0;i<e.childWidgets.length;i++)t+=e.childWidgets[i].height,0===e.indexInOwner&&(t+=e.containerWidget.margin.top);return t},t.prototype.updateRowHeightBySpannedCell=function(e,t,i){var r=1;if(0!==e.childWidgets.length&&0!==i){for(var n=0;n<t.childWidgets.length;n++){var o=t.childWidgets[n];r=sf.base.isNullOrUndefined(o)||sf.base.isNullOrUndefined(o.cellFormat)?r:o.cellFormat.rowSpan,this.updateSpannedRowCollection(r,t,o)}if(!sf.base.isNullOrUndefined(t.ownerTable))for(n=0;n<t.ownerTable.spannedRowCollection.length;n++)if(t.ownerTable.spannedRowCollection.keys[n]===t.index){for(var s=0;s<i;s++){var a=e.childWidgets[s];this.updateRowHeight(a,t)}t.ownerTable.spannedRowCollection.remove(t.ownerTable.spannedRowCollection.keys[n]);break}}else this.updateRowHeight(t,t)},t.prototype.updateRowHeight=function(e,t){for(var i=t.index,r=1,n=0;n<e.childWidgets.length;n++){var o=e.childWidgets[n];if(r=sf.base.isNullOrUndefined(o)||sf.base.isNullOrUndefined(o.cellFormat)?r:o.cellFormat.rowSpan,this.updateSpannedRowCollection(r,t,o),i-o.rowIndex==r-1){var s=o.y+o.height+o.margin.bottom-t.y;("Exactly"!==t.rowFormat.heightType||"Exactly"===t.rowFormat.heightType&&t.rowFormat.height>s)&&t.height<s&&(t.height=s)}}},t.prototype.updateSpannedRowCollection=function(e,t,i){e>1&&!sf.base.isNullOrUndefined(t.ownerTable)&&(t.ownerTable.spannedRowCollection.containsKey(t.index+e-1)||t.ownerTable.spannedRowCollection.add(t.index+e-1,t.index))},t.prototype.updateRowHeightByCellSpacing=function(e,t,i){t.ownerTable.tableFormat.cellSpacing>0&&e.length>1&&t.y===i.clientArea.y&&i instanceof X&&(t.height=t.height-x.convertPointToPixel(t.ownerTable.tableFormat.cellSpacing)/2)},t.prototype.isRowSpanEnd=function(e,t){for(var i=e.index,r=1,n=0;n<this.documentHelper.splittedCellWidgets.length;n++){var o=this.documentHelper.splittedCellWidgets[n];if(r=sf.base.isNullOrUndefined(o)||sf.base.isNullOrUndefined(o.cellFormat)?r:o.cellFormat.rowSpan,i-o.rowIndex==r-1)return!0}return!1},t.prototype.isVerticalMergedCellContinue=function(e){for(var t=0,i=0;i<e.childWidgets.length;i++){var r=e.childWidgets[i];if(t<r.columnIndex)return!0;t+=r.cellFormat.columnSpan}return t<e.ownerTable.tableHolder.columns.length},t.prototype.splitWidgets=function(e,t,i,r,n,o,s){if(this.isFirstLineFitForRow(t.clientArea.bottom,e)&&e.childWidgets.length>0){if(n=this.getSplittedWidgetForRow(t.clientArea.bottom,i,r,e,s),this.documentHelper.splittedCellWidgets.length>0||n!==e){if(o)for(var a=0;a<n.childWidgets.length;a++){n.childWidgets[a].rowIndex!==n.index&&(n.childWidgets.splice(a,1),a--)}this.insertSplittedCellWidgets(t,i,n,e.index-1)}}else this.insertSplittedCellWidgets(t,i,n,e.index-1);return n},t.prototype.getSplittedWidgetForRow=function(e,t,i,r,n){var o=void 0,s=r.index;this.isRelayoutneed=!1;for(var a=!1,l=0;l<r.childWidgets.length;l++){var h=r.childWidgets[l],d=this.getSplittedWidget(e,!0,t,i,h,n);if(n=[],!sf.base.isNullOrUndefined(d)){if(d===h)return r;-1!==r.childWidgets.indexOf(d)&&r.childWidgets.splice(r.childWidgets.indexOf(d),1),r.height-=d.height,(0===l||r.height<h.height+h.margin.top+h.margin.bottom)&&(r.height=h.height+h.margin.top+h.margin.bottom),sf.base.isNullOrUndefined(o)&&((o=new ce).containerWidget=r.containerWidget,o.index=r.index,o.rowFormat=r.rowFormat,this.updateWidgetLocation(r,o),i.push(o));var c=1;c=sf.base.isNullOrUndefined(d)||sf.base.isNullOrUndefined(d.cellFormat)?c:d.cellFormat.rowSpan,s-d.rowIndex==c-1&&o.height<d.height+d.margin.top+d.margin.bottom?o.height=d.height+d.margin.top+d.margin.bottom:("Exactly"===r.rowFormat.heightType||"AtLeast"===r.rowFormat.heightType&&o.height<r.rowFormat.height)&&(o.height=r.rowFormat.height),o.childWidgets.push(d),d.containerWidget=o,this.isRelayoutneed=!0;for(var p=l;p>0&&!a;){var u=r.childWidgets[p-1];d=this.getSplittedWidget(e,!0,t,i,u,n),o.childWidgets.splice(0,0,d),d.containerWidget=o,p--}a=!0}}return o},t.prototype.getFootNoteHeightInLine=function(e){for(var t=0,i=0;i<e.children.length;i++){var r=e.children[i];r instanceof Me&&(t+=this.getFootNoteHeight(r.bodyWidget))}return t},t.prototype.getFootnoteFromLine=function(e,t){for(var i=0;i<e.children.length;i++)e.children[i]instanceof Me&&t.push(e.children[i])},t.prototype.updateWidgetsToTable=function(e,t,i,r){var n,o=i.bodyWidget.page.index,s=this.getRowHeight(i,[i]),a=this.viewer,l=i.rowFormat.isHeader,h=void 0,d=i.rowFormat.allowBreakAcrossPages,c=i.rowFormat.heightType,p=0,u=i,g=!1,f=this.layoutedFootnoteElement;void 0!==u.bodyWidget.page.footnoteWidget?(this.footHeight=u.bodyWidget.page.footnoteWidget.height,0===this.footnoteHeight&&(this.footnoteHeight=this.footHeight)):this.footHeight=0,i.ownerTable.continueHeader&&!l&&(i.ownerTable.continueHeader=!1);var m=i.ownerTable.isInsideTable,y=!1;for(n=sf.base.isNullOrUndefined(i.ownerTable)||sf.base.isNullOrUndefined(i.ownerTable.tableFormat)?0:x.convertPointToPixel(i.ownerTable.tableFormat.cellSpacing);p<t.length;){if(p=t.length,this.isRowSpanEnd(i,a)&&"Exactly"===i.rowFormat.heightType&&1===this.documentHelper.splittedCellWidgets.length&&(this.documentHelper.splittedCellWidgets=[]),i.ownerTable.isInsideTable||0===this.documentHelper.splittedCellWidgets.length&&u.y+u.height+n+this.footnoteHeight<=a.clientArea.bottom)!this.isVerticalMergedCellContinue(i)||u.y!==a.clientArea.y&&u.y!==this.viewer.clientArea.y+u.ownerTable.headerHeight||this.insertSplittedCellWidgets(a,e,u,u.index-1),this.addWidgetToTable(a,e,t,u,f,void 0,m,o),this.documentHelper.splittedCellWidgets.length>0&&sf.base.isNullOrUndefined(t[t.length-1].nextRow)&&(p--,y=!0),m=!1;else{if(f=[],m=!1,this.documentHelper.splittedCellWidgets.length>0&&u.y+u.height+this.footHeight<=a.clientArea.bottom)if(!this.isRowSpanEnd(i,a)){!this.isVerticalMergedCellContinue(i)||u.y!==a.clientArea.y&&u.y!==this.viewer.clientArea.y+u.ownerTable.headerHeight||this.insertSplittedCellWidgets(a,e,u,u.indexInOwner-1),this.addWidgetToTable(a,e,t,u,f);continue}var v=u,b=e[e.length-1];if(s+u.y+this.footHeight>a.clientArea.bottom)if(!d||l&&i.ownerTable.continueHeader||"AtLeast"===c&&x.convertPointToPixel(i.rowFormat.height)<a.clientArea.bottom){if(("AtLeast"===c&&x.convertPointToPixel(i.rowFormat.height)<a.clientActiveArea.height&&(d||0===i.indexInOwner)||"Exactly"!==c&&u.y===a.clientArea.y||"Auto"===c&&d)&&(v=this.splitWidgets(u,a,e,t,v,y,f),sf.base.isNullOrUndefined(v)&&u.y===a.clientArea.y&&this.addWidgetToTable(a,e,t,u,f)),"Exactly"===c&&u.y===a.clientArea.y&&(this.addWidgetToTable(a,e,t,u,f),p++),l&&i.ownerTable.continueHeader){i.ownerTable.header=!1,i.ownerTable.headerHeight=0;var w=void 0;if(a instanceof X&&(w=this.documentHelper.pages),!sf.base.isNullOrUndefined(w))for(var M=0;M<w.length;M++)!w[M].repeatHeaderRowTableWidget||sf.base.isNullOrUndefined(w[M].bodyWidgets[0].firstChild)||w[M].bodyWidgets[0].firstChild instanceof de&&w[M].bodyWidgets[0].firstChild.header||(w[M].repeatHeaderRowTableWidget=!1,i.ownerTable.continueHeader=!1)}}else"Auto"!==c&&"AtLeast"!==c||!d?"Exactly"===c&&u.y===a.clientArea.y&&(this.addWidgetToTable(a,e,t,u,f),p++):x.convertPointToPixel(i.rowFormat.height)>a.clientArea.bottom&&u.y!==a.clientArea.y||(v=this.splitWidgets(u,a,e,t,v,y,f),sf.base.isNullOrUndefined(v)&&u.y===a.clientArea.y&&this.addWidgetToTable(a,e,t,u,f));else{var N=!1;if(this.isVerticalMergedCellContinue(i)&&(d||(N=u.y===a.clientArea.y||u.y===this.viewer.clientArea.y+u.ownerTable.headerHeight))){if(N)this.insertSplittedCellWidgets(a,e,v,u.indexInOwner-1);else if(v=this.splitWidgets(u,a,e,t,v,y,f),sf.base.isNullOrUndefined(v)&&(N=u.y===a.clientArea.y||u.y===this.viewer.clientArea.y+u.ownerTable.headerHeight)){this.insertSplittedCellWidgets(a,e,u,u.indexInOwner-1),p--;continue}}else y&&!d&&(v=this.splitWidgets(u,a,e,t,v,y,f))}if(!sf.base.isNullOrUndefined(v)&&(sf.base.isNullOrUndefined(this.documentHelper.owner.editor)||this.documentHelper.owner.editor&&!this.documentHelper.owner.editor.isTableInsert)&&!(v.bodyWidget.containerWidget instanceof ae)){if(v!==u){this.addWidgetToTable(a,e,t,u,f,u.nextRow),this.updateWidgetsToPage(e,t,i.ownerTable,r,u.nextRow),e.indexOf(u.containerWidget)+1>=e.length&&this.addTableWidget(a.clientActiveArea,e,!0),u=v}else{if(i.index>0)if(this.updateWidgetsToPage(e,t,i.ownerTable,r,i),i.previousRenderedWidget instanceof ce){var I=i.previousRenderedWidget;if(x.round(u.y,2)===x.round(I.y+I.height,2))e.indexOf(I.containerWidget)+1>=e.length&&this.addTableWidget(a.clientActiveArea,e,!0);else this.addTableWidget(a.clientActiveArea,e,!0)}else this.addTableWidget(a.clientActiveArea,e,!0);g=!0,p--}b=e[e.length-1];var S=void 0;if(e.length>1)S=e[e.length-2].containerWidget;else S=i.ownerTable.previousRenderedWidget.containerWidget;sf.base.isNullOrUndefined(S)||this.documentHelper.pages.indexOf(S.page);var C=i,O=!1,T=(i.ownerTable.containerWidget.index,void 0),P=void 0;P=g&&1===e.length?e[e.length-1]:e[e.length-2];var A=!0;if(g&&1===t.length){var L=this.alignBlockElement(i);if(!sf.base.isNullOrUndefined(L.node)){var F=L.node;if(F instanceof ce&&0===F.indexInOwner)e.length>1&&0===e[e.length-1].childWidgets.length&&(e.pop(),(b=e[e.length-1]).height=0);else if(L.node instanceof le){P=this.splitParagraph(L.node,parseInt(L.position.index,10)),e.length>1&&0===e[e.length-1].childWidgets.length&&(e.pop(),b=e[e.length-1]),A=!1}F instanceof ce&&((C=F).ownerTable.equals(i.ownerTable)||(P=C.ownerTable,A=!1)),O=!0}}T=this.moveBlocksToNextPage(P instanceof le||O?P.previousWidget:P,O);var D=e[e.length-1];if(g&&A&&0===C.index&&D.containerWidget&&-1!==D.containerWidget.childWidgets.indexOf(D)&&D.containerWidget.childWidgets.splice(D.containerWidget.childWidgets.indexOf(D),1),A&&(-1!==T.childWidgets.indexOf(D)&&T.childWidgets.splice(T.childWidgets.indexOf(D),1),T.childWidgets.unshift(D),this.shiftFloatingItemsFromTable(D,T)),D.containerWidget=T,g&&C.index>0||t.length>1){var E=g?t[t.length-1]:t[t.length-2];O&&(E=C),this.moveNextWidgetsToTable(e,E,!g),C=i}if(O&&this.updateClientPositionForBlock(A?D:P,i),g=!1,C.ownerTable.header&&u.height<a.clientArea.bottom&&!O){a instanceof X&&(a.documentHelper.currentRenderingPage.repeatHeaderRowTableWidget=!0),a.updateClientAreaForBlock(C.ownerTable,!0,e),v.x=v.x,v.y=b.y+C.ownerTable.headerHeight;var z=n/2;this.updateChildLocationForRow(b.y+C.ownerTable.headerHeight-z,v)}else{if(a.updateClientAreaForBlock(C.ownerTable,!0,e),v.bodyWidget.sectionFormat.columns.length>1){var k=new $(this.viewer.clientArea.x,this.viewer.clientArea.y,this.viewer.clientArea.width,this.viewer.clientArea.height),W=new $(this.viewer.clientActiveArea.x,this.viewer.clientActiveArea.y,this.viewer.clientActiveArea.width,this.viewer.clientActiveArea.height);v.x=this.viewer.clientActiveArea.x;var R=this.getMaxTopCellMargin(v),j=this.getMaxBottomCellMargin(v);for(M=0;M<v.childWidgets.length;M++){var U=v.childWidgets[M];this.addTableCellWidget(U,this.viewer.clientActiveArea,R+v.topBorderWidth,j+v.bottomBorderWidth),this.viewer.updateClientAreaForCell(U,!0);for(var H=0;H<U.childWidgets.length;H++){var B=U.childWidgets[H];a.updateClientAreaForBlock(B,!0),B.containerWidget=U,this.layoutBlock(B,0),a.updateClientAreaForBlock(B,!1)}this.viewer.updateClientAreaForCell(U,!1)}this.viewer.clientActiveArea=W,this.viewer.clientArea=k}v.x=v.x,v.y=b.y;z=n/2;this.updateChildLocationForRow(b.y-z,v)}if(A&&this.shiftedFloatingItemsFromTable.length>0){for(M=0;M<this.shiftedFloatingItemsFromTable.length;M++){var _=this.shiftedFloatingItemsFromTable[M],V=this.getFloatingItemPoints(_);_.y=V.y,_.x=V.x,_ instanceof Ee&&this.updateChildLocationForCellOrShape(_.y,_)}this.shiftedFloatingItemsFromTable=[]}}y=!1}if(l&&(i.ownerTable.continueHeader&&(i.ownerTable.header=!0,i.ownerTable.headerHeight=s+i.ownerTable.headerHeight),h=this.getHeader(i.ownerTable),!sf.base.isNullOrUndefined(h)&&i.index===h.index)){var Y=this.getHeaderHeight(i.ownerTable,i,t);if((Y>i.ownerTable.headerHeight||Y>i.ownerTable.headerHeight)&&(i.ownerTable.headerHeight=Y),i.ownerTable.headerHeight>a.clientArea.height){i.ownerTable.header=!1,i.ownerTable.continueHeader=!1,i.ownerTable.headerHeight=0;for(w=this.documentHelper.pages,M=0;M<w.length;M++)w[M].repeatHeaderRowTableWidget&&(w[M].repeatHeaderRowTableWidget=!1)}}e.length>2&&i.ownerTable.header&&u.height<a.clientActiveArea.bottom&&!a.documentHelper.currentRenderingPage.repeatHeaderRowTableWidget&&(a.documentHelper.currentRenderingPage.repeatHeaderRowTableWidget=!0)}},t.prototype.getHeader=function(e){var t=void 0,i=!0;e=e.getSplitWidgets()[0];for(var r=0;r<e.childWidgets.length;r++){var n=e.childWidgets[r];if(n.rowFormat.isHeader?t=n:i=!1,!i)break}return t},t.prototype.getHeaderHeight=function(e,t,i){var r=0;if(t.ownerTable.childWidgets.length>0&&e.childWidgets[0].rowFormat.isHeader)for(var n=0;n<e.childWidgets.length;n++){var o=e.childWidgets[n];if(!o.rowFormat.isHeader)break;r+=o.height}return r},t.prototype.updateWidgetToRow=function(e){var t=e.ownerRow;if(e.containerWidget=t,!sf.base.isNullOrUndefined(e.ownerRow)&&"Exactly"!==e.ownerRow.rowFormat.heightType&&x.convertPointToPixel(e.ownerRow.rowFormat.height)>0&&0===e.cellIndex&&(t.height=t.height+x.convertPointToPixel(e.ownerRow.rowFormat.height)),1===e.cellFormat.rowSpan){var i=void 0;i="Exactly"===t.rowFormat.heightType?e.height+e.margin.bottom:e.height+e.margin.top+e.margin.bottom,t.height-x.convertPointToPixel(e.ownerTable.tableFormat.cellSpacing)<i&&(t.height=i+x.convertPointToPixel(e.ownerTable.tableFormat.cellSpacing))}},t.prototype.updateHeightForRowWidget=function(e,t,i,r,n,o,s,a){for(var l=0;l<n.childWidgets.length;l++){var h,d=0,c=void 0;if(h=(c=n.childWidgets[l]).cellFormat.rowSpan,d=x.convertPointToPixel(c.ownerTable.tableFormat.cellSpacing),h>1){var p=n.containerWidget.childWidgets.indexOf(n),u=p+h-1-(n.index-c.rowIndex);!a&&(e.clientArea.bottom<c.y+c.height+c.margin.bottom||u>=p+1)&&(1===r.length||r.length>=1&&n===r[r.length-1])&&this.splitSpannedCellWidget(c,i,r,e);var g=n;if(u>0)if(u<n.containerWidget.childWidgets.length){var f=n.containerWidget.childWidgets[u];f instanceof ce&&(g=f)===s&&(g=n)}else g=n.containerWidget.childWidgets[n.containerWidget.childWidgets.length-1];c.y+c.height+c.margin.bottom<g.y+g.height?c.height=g.y+g.height-c.y-c.margin.bottom:o&&g&&0!==g.y&&0!==g.height&&c.y+c.height+c.margin.bottom>g.y+g.height&&("Exactly"!==g.rowFormat.heightType||"Exactly"===g.rowFormat.heightType&&g.rowFormat.height>c.y+c.height+c.margin.bottom-g.y?g.height=c.y+c.height+c.margin.bottom-g.y:c.height=g.y-c.y+g.height)}else d>0&&i.length>1&&n.y===e.clientArea.y&&e instanceof X&&(d/=2),c.height=n.height-c.margin.top-c.margin.bottom-d;this.updateHeightForCellWidget(e,i,r,c);for(var m=n.containerWidget;m.containerWidget instanceof ie;)m=m.containerWidget;var y=void 0;m instanceof ne&&(y=m.page),(e instanceof X&&-1!==e.visiblePages.indexOf(y)||t)&&this.updateCellVerticalPosition(c,!1,c.ownerTable.isInsideTable)}},t.prototype.updateHeightForCellWidget=function(e,t,i,r){for(var n=0;n<r.childWidgets.length;n++)r.childWidgets[n]instanceof de&&this.updateHeightForTableWidget(t,i,r.childWidgets[n])},t.prototype.getRowHeight=function(e,t){var i=0;if("Exactly"===e.rowFormat.heightType)i=e.rowFormat.height;else{for(var r=0;r<t.length;r++)t[r]instanceof ce&&(i=t[r].height+i);i=Math.max(i,e.rowFormat.height)}return i},t.prototype.splitSpannedCellWidget=function(e,t,i,r){var n=this.getSplittedWidget(r.clientArea.bottom,!1,t,i,e,void 0);sf.base.isNullOrUndefined(n)||this.documentHelper.splittedCellWidgets.push(n)},t.prototype.insertSplittedCellWidgets=function(e,t,i,r){if(!sf.base.isNullOrUndefined(i)){var n,o=i.x,s=0,a=0,l=!1;n=x.convertPointToPixel(i.ownerTable.tableHolder.tableWidth);for(var h=0;h<i.childWidgets.length;h++){var d=i.childWidgets[h],c="None"===d.cellFormat.borders.right.lineStyle;if(a=sf.base.isNullOrUndefined(d.ownerTable)||sf.base.isNullOrUndefined(d.ownerTable.tableFormat)?0:x.convertPointToPixel(d.ownerTable.tableFormat.cellSpacing),Math.round(o)<Math.round(d.x-d.margin.left)){if(this.insertRowSpannedWidget(i,e,o,h)){h--;continue}var p=i.childWidgets.length;if(this.insertEmptySplittedCellWidget(i,t,o,h,r),p<i.childWidgets.length){if(h===s)break;h--;continue}}if(o+=d.margin.left+d.width+d.margin.right,(a>0||d.columnIndex===d.ownerTable.tableHolder.columns.length-1||d.index===d.containerWidget.childWidgets.length-1)&&(d.ownerTable.tableFormat.allowAutoFit||(o+=d.rightBorderWidth),this.isInsertTable()||(l=this.checkPreviousMargins(d.ownerTable))),o-=c&&!l?0:d.rightBorderWidth,s++,h===i.childWidgets.length-1&&Math.round(o)<Math.round(i.x+n)){if(this.insertRowSpannedWidget(i,e,o,h+1))continue;this.insertEmptySplittedCellWidget(i,t,o,h+1,r)}else;}if((sf.base.isNullOrUndefined(i.childWidgets)||0===i.childWidgets.length)&&this.documentHelper.splittedCellWidgets.length>0)for(var u=0;u<this.documentHelper.splittedCellWidgets.length;u++){var g=this.documentHelper.splittedCellWidgets[u];if(Math.round(o)<=Math.round(g.x-g.margin.left)){if(this.insertRowSpannedWidget(i,e,o,u)){u--;continue}var f=i.childWidgets.length;if(this.insertEmptySplittedCellWidget(i,t,o,u,r),f<i.childWidgets.length){u--;continue}}if(o+=g.margin.left+g.width+g.margin.right,u===i.childWidgets.length-1&&Math.round(o)<Math.round(i.x+n)){if(this.insertRowSpannedWidget(i,e,o,u+1))continue;this.insertEmptySplittedCellWidget(i,t,o,u+1,r)}else;}this.documentHelper.splittedCellWidgets.length>0&&(this.documentHelper.splittedCellWidgets=[])}},t.prototype.insertRowSpannedWidget=function(e,t,i,r){var n=0;e.ownerTable.tableFormat.cellSpacing>0&&(n=x.convertPointToPixel(e.ownerTable.tableFormat.cellSpacing));for(var o=0;o<this.documentHelper.splittedCellWidgets.length;o++){var s=this.documentHelper.splittedCellWidgets[o];if(Math.round(i)===Math.round(s.x-s.margin.left))return e.childWidgets.splice(r,0,s),s.containerWidget=e,s.height>e.height&&(e.height=s.height),s.y!==e.y+s.margin.top+n&&this.updateChildLocationForRow(e.y,e),this.documentHelper.splittedCellWidgets.splice(o,1),!0}return!1},t.prototype.insertEmptySplittedCellWidget=function(e,t,i,r,n){for(var o,s=t[t.length-1],a=t.length-1;a>=0;a--)for(var l=t[a],h=l.childWidgets.length-1;h>=0;h--){var d=l.childWidgets[h];if(d.index===n){o=d;break}}o&&(s=o.ownerTable,n=o.indexInOwner);for(var c=n;c>=0;c--){var p=s.childWidgets[c],u=p.x;for(a=0;a<p.childWidgets.length;a++){var g=1,f=p.childWidgets[a];if(Math.round(i)===Math.round(u)&&(g=sf.base.isNullOrUndefined(f)||sf.base.isNullOrUndefined(f.cellFormat)?g:f.cellFormat.rowSpan)>1){var m=this.createCellWidget(f);return e.childWidgets.splice(r,0,m),m.containerWidget=e,void this.updateChildLocationForRow(e.y,e)}u+=f.margin.left+f.width+f.margin.right}}},t.prototype.getSplittedWidget=function(e,t,i,r,n,o){var s=void 0,a=0;if(n.y+n.height>e-this.footHeight-n.margin.bottom){for(var l=0;l<n.ownerRow.childWidgets.length;l++){var h=n.ownerRow.childWidgets[l];if(h.y+h.height<e-this.footHeight-h.margin.bottom)for(var d=0;d<h.childWidgets.length;d++)if(h.childWidgets[d]instanceof le)for(var c=h.childWidgets[d],p=0;p<c.childWidgets.length;p++){var u=c.childWidgets[p],g=this.getFootNoteHeightInLine(u);this.existFootnoteHeight+=g,a+=g}}for(l=0;l<n.childWidgets.length;l++)if(n.childWidgets[l]instanceof le){c=n.childWidgets[l];var f=this.getSplittedWidgetForPara(e-n.margin.bottom,c,o);if(!sf.base.isNullOrUndefined(f)){if(0===l&&f===c)return n;-1!==n.childWidgets.indexOf(f)&&(n.childWidgets.splice(n.childWidgets.indexOf(f),1),l--),n.height-=f.height,sf.base.isNullOrUndefined(s)&&(s=this.createCellWidget(n)),s.height+=f.height,s.childWidgets.push(f),f.containerWidget=s}}else{var m=n.childWidgets[l],y=[m];if(e-n.margin.bottom<m.y+m.height){var v=m.height,b=this.getSplittedWidgetForTable(e-n.margin.bottom,y,m,o);if(sf.base.isNullOrUndefined(b)&&!m.childWidgets[0].rowFormat.allowBreakAcrossPages&&(b=m),!sf.base.isNullOrUndefined(b)){if(0===l&&b===m)return n;-1!==n.childWidgets.indexOf(b)?(n.childWidgets.splice(n.childWidgets.indexOf(b),1),l--,n.height-=b.height):n.height-=v-m.height,sf.base.isNullOrUndefined(s)&&(s=this.createCellWidget(n)),s.height+=b.height,s.childWidgets.push(b),b.containerWidget=s}}}}return this.existFootnoteHeight-=a,sf.base.isNullOrUndefined(s)&&t&&this.isRelayoutneed&&(s=this.createCellWidget(n)),s},t.prototype.getListLevelPattern=function(e){switch(e){case 0:return"Arabic";case 1:return"LowLetter";case 2:return"LowRoman";case 3:return"UpLetter";case 4:return"UpRoman";case 5:return"Ordinal";case 6:return"Number";case 7:return"OrdinalText";case 8:return"LeadingZero";case 9:return"Bullet";case 10:return"FarEast";case 11:return"Special";default:return"None"}},t.prototype.createCellWidget=function(e){var t=new pe;return t.cellFormat=e.cellFormat,t.index=e.index,t.rowIndex=e.rowIndex,t.columnIndex=e.columnIndex,t.containerWidget=e.containerWidget,this.updateWidgetLocation(e,t),t.margin=e.margin,t.leftBorderWidth=e.leftBorderWidth,t.rightBorderWidth=e.rightBorderWidth,t},t.prototype.createTableWidget=function(e){var t=new de;return e.header&&(t.header=e.header,t.headerHeight=e.headerHeight),t.index=e.index,t.tableFormat=e.tableFormat,t.tableHolder=e.tableHolder,t.footnoteElement=e.footnoteElement,t.isGridUpdated=e.isGridUpdated,t.wrapTextAround=e.wrapTextAround,t.positioning=e.positioning,t.isContainInsideTable=e.isContainInsideTable,t.isBidiTable=e.isBidiTable,t},t.prototype.getSplittedWidgetForPara=function(e,t,i){for(var r=t.y,n=void 0,o=!1,s=0;s<t.childWidgets.length;s++){var a=t.childWidgets[s],l=this.getFootNoteHeightInLine(a);if(l+=this.existFootnoteHeight,!sf.base.isNullOrUndefined(i))for(var h=0;h<i.length;h++)l+=this.getFootNoteHeight(i[h].bodyWidget);if(e<r+l+a.height){if((t.paragraphFormat.keepLinesTogether&&(0!==t.index||0===t.index&&!sf.base.isNullOrUndefined(t.associatedCell.ownerRow.previousWidget))||t.paragraphFormat.widowControl&&1===s)&&(o=!0,s=0,a=t.childWidgets[0]),0===s){if(a.paragraph.containerWidget instanceof pe&&!o&&a.paragraph.containerWidget.y===t.y){r+=a.height;continue}n=t;break}-1!==t.childWidgets.indexOf(a)&&(t.childWidgets.splice(t.childWidgets.indexOf(a),1),s--),t.height-=a.height,sf.base.isNullOrUndefined(n)?((n=new le).characterFormat=t.characterFormat,n.paragraphFormat=t.paragraphFormat,n.index=t.index,this.updateWidgetLocation(t,n),n.height=a.height):n.height+=a.height,n.childWidgets.push(a),a.paragraph=n}this.getFootnoteFromLine(a,i),r+=a.height}return n},t.prototype.getSplittedWidgetForTable=function(e,t,i,r){for(var n=i.y,o=void 0,s=0;s<i.childWidgets.length;s++){var a,l=(a=i.childWidgets[s]).height;if(e<n+l||!sf.base.isNullOrUndefined(o)){var h=void 0,d=!0;if(sf.base.isNullOrUndefined(a)||sf.base.isNullOrUndefined(a.rowFormat)||(d=a.rowFormat.allowBreakAcrossPages),d?h=sf.base.isNullOrUndefined(o)&&this.isFirstLineFitForRow(e,a)?this.getSplittedWidgetForRow(e,t,[a],a,r):a:sf.base.isNullOrUndefined(i.containerWidget.containerWidget.previousWidget)&&this.isFirstLineFitForRow(e,a)||i.isInsideTable&&!i.containerWidget.containerWidget.rowFormat.allowBreakAcrossPages?h=this.getSplittedWidgetForRow(e,t,[a],a,r):sf.base.isNullOrUndefined(i.containerWidget.containerWidget.previousWidget)||(h=a),!sf.base.isNullOrUndefined(h)){if(0===s&&h===a)return i;-1!==i.childWidgets.indexOf(h)?(i.childWidgets.splice(i.childWidgets.indexOf(h),1),s--,i.height-=h.height):i.height-=l-a.height,sf.base.isNullOrUndefined(o)?(o=this.createTableWidget(i),this.updateWidgetLocation(i,o),o.height=h.height):o.height+=h.height,o.childWidgets.push(h),h.containerWidget=o}}n+=a.height}return o},t.prototype.isFirstLineFitForPara=function(e,t){var i=t.childWidgets[0],r=i.height,n=this.getFootNoteHeightInLine(i);r+=n+=this.existFootnoteHeight,t.paragraphFormat.keepLinesTogether&&(r=t.height);var o=i.paragraph.containerWidget;if(this.documentHelper.isFirstLineFitInShiftWidgets){if(this.viewer.clientActiveArea.y===this.viewer.clientArea.y&&t.y+r>=e)return!0}else if(!o.ownerTable.isInsideTable&&o.containerWidget.y===this.viewer.clientArea.y&&t.y+r>=e)return!0;return t.y+r<=e},t.prototype.isFirstLineFitForTable=function(e,t){var i,r=!1;return i=t.childWidgets[0],sf.base.isNullOrUndefined(i)||(r=this.isFirstLineFitForRow(e,i)),r},t.prototype.isFirstLineFitForRow=function(e,t){for(var i=0;i<t.childWidgets.length;i++){var r=t.childWidgets[i];if(!this.isFirstLineFitForCell(e,r))return!1}return!0},t.prototype.isFirstLineFitForCell=function(e,t){if(0===t.childWidgets.length)return!0;if(t.childWidgets[0]instanceof le){var i=t.childWidgets[0];return this.isFirstLineFitForPara(e-t.margin.bottom,i)}var r=t.childWidgets[0];return this.isFirstLineFitForTable(e-t.margin.bottom,r)},t.prototype.updateWidgetLocation=function(e,t){t.x=e.x,t.y=e.y,t.width=e.width},t.prototype.updateChildLocationForTable=function(e,t){for(var i=0;i<t.childWidgets.length;i++){var r=t.childWidgets[i];r.y=e,this.updateChildLocationForRow(e,r),e+=r.height}},t.prototype.updateChildLocationForRow=function(e,t){var i=0;t.ownerTable.tableFormat.cellSpacing>0&&(i=x.convertPointToPixel(t.ownerTable.tableFormat.cellSpacing));for(var r=0;r<t.childWidgets.length;r++){var n=t.childWidgets[r];n.index=n.cellIndex,n.y=e+n.margin.top+i,this.updateChildLocationForCellOrShape(n.y,n)}},t.prototype.updateChildLocationForCellOrShape=function(e,t){var i=t;t instanceof Ee&&(i=t.textFrame);for(var r=0;r<i.childWidgets.length;r++){var n=!1;i.childWidgets[r]instanceof de&&i.childWidgets[r].wrapTextAround&&!sf.base.isNullOrUndefined(i.childWidgets[r+1])&&i.childWidgets[r+1].y>i.childWidgets[r].y&&i.childWidgets[r+1].y<i.childWidgets[r].y+i.childWidgets[r].height&&(n=!0),i.childWidgets[r].x=i.childWidgets[r].x,i.childWidgets[r].y=e,i.childWidgets[r]instanceof de&&this.updateChildLocationForTable(e,i.childWidgets[r]),n||(e+=i.childWidgets[r].height)}},t.prototype.updateCellVerticalPosition=function(e,t,i){var r=e.ownerTable.containerWidget;if(r instanceof re||r instanceof ze||i){var n=this.getDisplacement(e,t);this.updateCellContentVerticalPosition(e,n,t)}},t.prototype.updateCellContentVerticalPosition=function(e,t,i){if(0!==t)for(var r=e.y+t,n=0;n<e.childWidgets.length;n++){if(e.childWidgets[n]instanceof le){var o=e.childWidgets[n];o.y=r,this.updateShapeInsideCell(o,t)}else this.updateTableWidgetLocation(e.childWidgets[n],r,i);r+=e.childWidgets[n].height}},t.prototype.updateShapeInsideCell=function(e,t){for(var i=0;i<e.floatingElements.length;i++){var r=e.floatingElements[i];r.y+=t,r instanceof Ee&&this.updateChildLocationForCellOrShape(r.y,r)}},t.prototype.updateTableWidgetLocation=function(e,t,i){e.y=t+=e.topBorderWidth;for(var r=0;r<e.childWidgets.length;r++){var n=e.childWidgets[r];n.y=t;for(var o=0;o<n.childWidgets.length;o++){var s=n.childWidgets[o];s.y=t+s.margin.top+0,this.updateCellVerticalPosition(s,i,!0)}t+=n.height}return t},t.prototype.getDisplacement=function(e,t){var i=0,r=e.containerWidget,n=e.margin.top+e.margin.bottom;i=!sf.base.isNullOrUndefined(e.cellFormat)&&e.cellFormat.rowSpan>1?e.height:(sf.base.isNullOrUndefined(r)?0:r.height)-n;var o=this.getCellContentHeight(e,!0),s=0;return i>o&&(s=i-o,"Center"===e.cellFormat.verticalAlignment?s/=2:("Top"===e.cellFormat.verticalAlignment||t)&&(s=0)),s},t.prototype.getCellContentHeight=function(e,t){if(sf.base.isNullOrUndefined(e.childWidgets))return 0;for(var i=0,r=e.y,n=0,o=0,s=!1,a=!1,l=0;l<e.childWidgets.length;l++)if(e.childWidgets[l]instanceof le){var h=e.childWidgets[l];i+=e.childWidgets[l].height;for(var d=0;d<h.floatingElements.length;d++){s=!0;var c=h.floatingElements[d];e.y+e.containerWidget.height>c.y+c.height&&c.y+c.height>o?(n=Math.abs(r-(c.y+c.height)),o=c.y+c.height,a=!1):a=!0}}else this.considerPositionTableHeight(e,e.childWidgets[l])&&(i+=e.childWidgets[l].height);return r+i>o&&(s=!1),t&&s?n:t&&a?e.ownerRow.height:i},t.prototype.considerPositionTableHeight=function(e,t){if(t.isLayouted&&t.wrapTextAround)for(var i=0;i<e.childWidgets.length;i++){var r=e.childWidgets[i];if(t!==r&&(r.y===t.y||r.y+r.height<t.y))return!1}return!0},t.prototype.getTableLeftBorder=function(e){if(sf.base.isNullOrUndefined(e.left)){var t=new p(e);return t.lineStyle="Single",t.lineWidth=.66,t}return e.left},t.prototype.getTableRightBorder=function(e){if(sf.base.isNullOrUndefined(e.right)){var t=new p(e);return t.lineStyle="Single",t.lineWidth=.66,t}return e.right},t.prototype.getTableTopBorder=function(e){if(sf.base.isNullOrUndefined(e.top)){var t=new p(e);return t.lineStyle="Single",t.lineWidth=.66,t}return e.top},t.prototype.getTableBottomBorder=function(e){if(sf.base.isNullOrUndefined(e.bottom)){var t=new p(e);return t.lineStyle="Single",t.lineWidth=.66,t}return e.bottom},t.prototype.getCellDiagonalUpBorder=function(e){return e.cellFormat.borders.diagonalUp},t.prototype.getCellDiagonalDownBorder=function(e){return e.cellFormat.borders.diagonalDown},t.prototype.getTableWidth=function(e){for(var t=0,i=0;i<e.childWidgets.length;i++){for(var r=e.childWidgets[i],n=0,o=0;o<r.childWidgets.length;o++){var s=r.childWidgets[o];n+=x.convertPointToPixel(s.cellFormat.cellWidth)}t<n&&(t=n)}return t},t.prototype.layoutNextItemsBlock=function(e,t,i){var r=e.bodyWidget.sectionIndex,n=e,o=n.getSplitWidgets(),s=o[o.length-1].nextRenderedWidget;(sf.base.isNullOrUndefined(s)||this.documentHelper.blockToShift===n)&&(this.documentHelper.blockToShift=void 0);for(var a=!0;s instanceof se&&(s.bodyWidget.sectionIndex===r||"NoBreak"===s.bodyWidget.sectionFormat.breakCode)&&(sf.base.isNullOrUndefined(i)||!i||s.isLayouted||!this.isInitialLoad);){var l,h=n.getSplitWidgets();l=h[h.length-1],n=s,this.documentHelper.blockToShift===n&&(this.documentHelper.blockToShift=void 0),a=!1;var d;if(d=n.getSplitWidgets()[0],0===this.documentHelper.fieldStacks.length&&!sf.base.isNullOrUndefined(d)&&l.containerWidget===d.containerWidget&&x.round(d.y,2)===x.round(l.y+l.height,2)){if(sf.base.isNullOrUndefined(this.documentHelper.blockToShift)){if(d.bodyWidget){d.bodyWidget.floatingElements.length>0&&(this.documentHelper.blockToShift=n)}}else this.documentHelper.blockToShift=n;break}if(a=!0,t.owner.isShiftingEnabled&&0===this.documentHelper.fieldStacks.length){this.documentHelper.blockToShift=n;break}!sf.base.isNullOrUndefined(this.viewer.owner.editorModule)&&this.viewer.owner.editorModule.isInsertingTOC||(n=n.combineWidget(this.viewer),l.containerWidget!==n.containerWidget&&(l instanceof le&&(!(l instanceof le)||l.isEndsWithPageBreak||l.isEndsWithColumnBreak||l.containerWidget.page===n.containerWidget.page||n.bodyWidget instanceof ne&&"NoBreak"===n.bodyWidget.sectionFormat.breakCode)||this.updateContainerWidget(n,l.containerWidget,l.indexInOwner+1,!1)),n instanceof de&&(this.clearTableWidget(n,!0,!0),n.isGridUpdated=!1),t.updateClientAreaForBlock(n,!0),(this.viewer instanceof Z||n.bodyWidget instanceof oe)&&(n.containerWidget.height-=n.height),this.documentHelper.layout.layoutBlock(n,0),t.updateClientAreaForBlock(n,!1)),o=s.getSplitWidgets(),s=o[o.length-1].nextRenderedWidget}t.owner.isShiftingEnabled&&this.documentHelper.blockToShift===n||this.viewer.owner.editorModule.updateListItemsTillEnd(n,a)},t.prototype.updateClientAreaForLine=function(e){e.marginTop=0;var t=this.documentHelper.selection.getTop(e),i=this.viewer.clientArea.x;this.viewer.cutFromTop(t),this.viewer.cutFromLeft(i)},t.prototype.getParentTable=function(e){for(var t=e;t.containerWidget;){if(t.containerWidget instanceof re||t.containerWidget instanceof ze)return t;t=t.containerWidget}},t.prototype.reLayoutParagraph=function(e,t,i,r,n){if(!this.isReplaceAll){if(e.containerWidget instanceof ze&&"Inline"===e.containerWidget.containerShape.textWrappingStyle&&(t=e.containerWidget.containerShape.line.indexInOwner,e=e.containerWidget.containerShape.paragraph),this.isRelayout=!0,r=!sf.base.isNullOrUndefined(r)&&r,this.isRelayout=!0,this.documentHelper.blockToShift===e?(this.layoutBodyWidgetCollection(e.index,e.containerWidget,e,!1),this.isBidiReLayout=!0):this.isBidiReLayout&&(this.isBidiReLayout=!1),e.isInsideTable){if(this.isBidiReLayout=!0,this.reLayoutTable(e),this.isFootnoteContentChanged&&!sf.base.isNullOrUndefined(e.bodyWidget)&&!sf.base.isNullOrUndefined(e.bodyWidget.page.footnoteWidget)){var o=e.bodyWidget.page.footnoteWidget;this.layoutfootNote(o)}this.isBidiReLayout=!1}else this.reLayoutLine(e,t,r,n);e.bodyWidget instanceof oe&&-1!==e.bodyWidget.headerFooterType.indexOf("Footer")&&this.shiftFooterChildLocation(e.bodyWidget,this.viewer)}},t.prototype.getParentRow=function(e){for(var t=e;null!==t.ownerTable&&t.ownerTable.isInsideTable;)t=t.ownerTable.associatedCell;return t.ownerRow},t.prototype.reLayoutRow=function(e){e instanceof le&&(e=e.associatedCell);var t=this.getParentRow(e).getSplitWidgets()[0];if(sf.base.isNullOrUndefined(t)||t.ownerTable.tableFormat.allowAutoFit)this.currentCell=e,this.reLayoutTable(e),this.currentCell=void 0;else{for(var i=t.ownerTable.getSplitWidgets()[0].combineWidget(this.viewer),r=t;this.isVerticalMergedCellContinue(r);){var n=r.previousWidget;if(sf.base.isNullOrUndefined(n))break;r=n}var o=i.containerWidget;this.viewer instanceof Z&&(o.height-=i.height),!this.viewer.owner.enableHeaderAndFooter&&!e.isInHeaderFooter||o instanceof ze?o instanceof ze?this.viewer.updateClientAreaForTextBoxShape(o.containerShape,!0):this.viewer.updateClientArea(o,o.page):(e.bodyWidget.isEmpty=!1,o.height-=i.height,this.viewer.updateHeaderFooterClientAreaWithTop(i.bodyWidget.sectionFormat,this.documentHelper.isBlockInHeader(i),o.page));var s=new $(this.viewer.clientArea.x,this.viewer.clientArea.y,this.viewer.clientArea.width,this.viewer.clientArea.height),a=new $(s.x,s.y,s.width,s.height);if(this.viewer.owner.isDocumentLoaded&&this.viewer.owner.editorModule){var l=this.documentHelper.getFirstParagraphInFirstCell(i);this.viewer.owner.editorModule.updateWholeListItems(l)}this.viewer.updateClientAreaForBlock(i,!0),this.viewer.cutFromTop(r.y),this.viewer.clientActiveArea.height=Number.POSITIVE_INFINITY,i.height=0;do{if(this.clearRowWidget(t,!0,!0,!0),this.layoutRow([i],t,!0),r===t)break;r=r.nextRow}while(r&&r!==t);this.updateChildLocationForTable(i.y,i),this.viewer.clientArea=a,this.viewer.clientActiveArea=new $(a.x,a.y,a.width,a.height),this.viewer.updateClientAreaForBlock(i,!0),i.x-=i.leftBorderWidth,i.y-=i.topBorderWidth,this.viewer.cutFromTop(i.y),this.shiftTableWidget(i,this.viewer,!0),this.layoutNextItemsBlock(i,this.viewer)}},t.prototype.reLayoutTable=function(e,t){var i=this.getParentTable(e),r=i.combineWidget(this.viewer),n=r.containerWidget;if(this.viewer instanceof Z&&(n.height-=r.height),!this.viewer.owner.enableHeaderAndFooter&&!e.isInHeaderFooter||n instanceof ze?n instanceof ze?this.viewer.updateClientAreaForTextBoxShape(n.containerShape,!0):this.viewer.updateClientArea(n,n.page):(e.bodyWidget.isEmpty=!1,n.height-=r.height,this.viewer.updateHeaderFooterClientAreaWithTop(i.bodyWidget.sectionFormat,this.documentHelper.isBlockInHeader(i),n.page)),this.viewer.owner.isDocumentLoaded&&this.viewer.owner.editorModule){var o=this.documentHelper.getFirstParagraphInFirstCell(r);this.viewer.owner.editorModule.updateWholeListItems(o)}this.viewer.updateClientAreaForBlock(r,!0),r.x-=r.leftBorderWidth,r.y-=r.topBorderWidth;var s=this.getYPosition(r);this.viewer.cutFromTop(s),this.clearTableWidget(r,!0,!0,!0,!0),this.isBidiReLayout=!0,this.layoutBlock(r,0),this.viewer.updateClientAreaForBlock(r,!1),this.layoutNextItemsBlock(r,this.viewer,t)},t.prototype.getYPosition=function(e){if(e.wrapTextAround){for(var t=e.previousWidget;t;){if(t instanceof le)return t.y+t.height;if(t instanceof de){if(!t.wrapTextAround)return t.y+t.height;t=t.previousWidget}}return this.viewer.clientActiveArea.y}return e.y},t.prototype.clearFootnoteReference=function(e,t){if(e.footnoteElement&&e.footnoteElement.length>0){for(var i=e.bodyWidget.page,r=e.footnoteElement.length-1;r>=0;r--){var n=e.footnoteElement[r];n.isLayout=!1;var o=n.bodyWidget.containerWidget;if(o&&-1!==o.bodyWidgets.indexOf(n.bodyWidget)){var s=this.getFootNoteHeight(n.bodyWidget);o.height-=s,o.bodyWidgets.splice(n.bodyWidget.indexInOwner,1),t&&o.page===i&&(this.viewer.clientActiveArea.height+=s,this.viewer.clientArea.height+=s)}0===o.bodyWidgets.length&&o.page&&(o.page.footnoteWidget=void 0),n.bodyWidget.containerWidget=void 0}e.footnoteElement=[]}},t.prototype.clearTableWidget=function(e,t,i,r,n){e.height=0,r&&(e.isGridUpdated=!1),t&&(e.y=0,e.x=0,e.footnoteElement&&e.footnoteElement.length>0&&this.clearFootnoteReference(e,n));for(var o=0;o<e.childWidgets.length;o++){var s=e.childWidgets[o];this.clearRowWidget(s,t,i,r)}},t.prototype.clearRowWidget=function(e,t,i,r){e.height=0,t&&(e.y=0,e.x=0);for(var n=0;n<e.childWidgets.length;n++){var o=e.childWidgets[n];this.clearCellWidget(o,t,i,r)}},t.prototype.clearCellWidget=function(e,t,i,r){e.height=0,t&&(e.y=0,e.x=0),this.clearBlockWidget(e.childWidgets,t,i,r)},t.prototype.clearBlockWidget=function(e,t,i,r){for(var n=0;n<e.length;n++){var o=e[n];o instanceof le?(t&&(o.y=0,o.x=0),i&&(o.height=0)):this.clearTableWidget(o,t,i,r)}},t.prototype.layoutBodyWidgetCollection=function(e,t,i,r,n){if(!sf.base.isNullOrUndefined(this.documentHelper.owner)&&this.documentHelper.owner.isLayoutEnabled)if(t instanceof re||t instanceof ze){var o=this.checkAndGetBlock(t,e);if(t instanceof ne&&sf.base.isNullOrUndefined(o)&&!sf.base.isNullOrUndefined(t.nextRenderedWidget)&&"NoBreak"===t.nextRenderedWidget.sectionFormat.breakCode&&(o=t.nextRenderedWidget.firstChild,t=t.nextRenderedWidget),sf.base.isNullOrUndefined(o))return;if(this.viewer instanceof Z&&(o.containerWidget.height-=o.height),t instanceof oe)t.isEmpty=!1,this.viewer.updateHeaderFooterClientAreaWithTop(t.sectionFormat,-1!==t.headerFooterType.indexOf("Header"),t.page),o.containerWidget.height-=o.height;else if(t instanceof ze)this.viewer.updateClientAreaForTextBoxShape(t.containerShape,!0);else if(!sf.base.isNullOrUndefined(t.containerWidget)&&t.containerWidget instanceof ae){if(this.viewer.updateClientArea(t,t.page,!0),"Footnote"!==t.containerWidget.footNoteType)return this.viewer.cutFromTop(t.containerWidget.y),void this.layoutfootNote(t.containerWidget);this.isRelayoutFootnote=!0,this.viewer.clientArea.height=Number.POSITIVE_INFINITY,this.viewer.clientActiveArea.height=Number.POSITIVE_INFINITY,this.viewer.clientActiveArea.y=o.containerWidget.containerWidget.y}else sf.base.isNullOrUndefined(t.page.footnoteWidget)||t.page.footnoteWidget.footNoteType,this.viewer.updateClientArea(t,t.page,!0);if(e>0||"NoBreak"===o.bodyWidget.sectionFormat.breakCode&&0!==o.bodyWidget.index&&o===t.firstChild){var s=o.getSplitWidgets()[0].previousRenderedWidget;if(!(sf.base.isNullOrUndefined(s)||s instanceof le)||s instanceof le&&!s.isEndsWithPageBreak&&!s.isEndsWithColumnBreak)if(sf.base.isNullOrUndefined(n)&&o.containerWidget!==s.containerWidget){var a=o.containerWidget,l=s.containerWidget,h=this.getFootNoteWidgetsOf(o);this.moveFootNotesToPage(h,a,l),"NoBreak"!==o.bodyWidget.sectionFormat.breakCode?(this.viewer.cutFromTop(s.y+s.height),this.updateContainerWidget(o,l,s.indexInOwner+1,!1)):(this.viewer.updateClientArea(o.bodyWidget,o.bodyWidget.page,!0),this.viewer.cutFromTop(s.y+s.height))}else{if(s instanceof le&&s.height<=0){var d=s;this.viewer.updateClientAreaForBlock(d,!0),this.layoutParagraph(d,0),this.viewer.updateClientArea(d.bodyWidget,d.bodyWidget.page,!0)}this.viewer.cutFromTop(s.y+s.height)}else s instanceof le&&(s.isEndsWithPageBreak||s.isEndsWithColumnBreak)&&s.containerWidget===o.containerWidget&&this.moveBlocksToNextPage(s,!1)}var c=void 0;(o=o.combineWidget(this.viewer))instanceof de?(this.clearTableWidget(o,!0,!0),o.isGridUpdated=!1,c=this.documentHelper.getFirstParagraphInFirstCell(o)):c=o,this.viewer.owner.isDocumentLoaded&&this.viewer.owner.editorModule&&this.viewer.owner.editorModule.updateWholeListItems(c),this.viewer.updateClientAreaForBlock(o,!0),this.isRelayout=!0,this.documentHelper.layout.layoutBlock(o,0),this.isRelayout=!1,this.viewer.updateClientAreaForBlock(o,!1),!sf.base.isNullOrUndefined(t.containerWidget)&&t.containerWidget instanceof ae&&"Footnote"===t.containerWidget.footNoteType&&this.layoutfootNote(t.containerWidget),r?this.shiftNextWidgets(o):this.layoutNextItemsBlock(o,this.viewer)}else if(t instanceof pe){var p=this.documentHelper.layout.getParentTable(t.ownerTable).getSplitWidgets()[0];this.reLayoutTable(t.ownerTable),this.layoutNextItemsBlock(p,this.viewer)}this.isRelayoutFootnote=!1},t.prototype.checkAndGetBlock=function(e,t){if(e instanceof ze)return e.childWidgets[t];var i=e.indexInOwner;if(e.page.bodyWidgets.length<=1)for(;e&&e.indexInOwner===i;){if(e.childWidgets.length>0&&e.firstChild.index<=t&&e.lastChild.index>=t)for(var r=0;r<e.childWidgets.length;r++){if((n=e.childWidgets[r]).index===t)return n}if(!(e instanceof ne))break;e=e.nextRenderedWidget}else for(;e;){if(e.childWidgets.length>0)for(r=0;r<e.childWidgets.length;r++){var n;if((n=e.childWidgets[r]).index===t)return n}if(!(e instanceof ne))break;e=e.nextRenderedWidget}},t.prototype.layoutTable=function(e,t){e.isBidiTable=e.bidi,e.isGridUpdated||(e.buildTableColumns(),e.isGridUpdated=!0),"Word2013"===this.documentHelper.compatibilityMode||e.isInsideTable||(this.viewer.clientActiveArea.x=this.viewer.clientActiveArea.x-x.convertPointToPixel(e.firstChild.firstChild.leftMargin));var i,r,n=[e];this.addTableWidget(this.viewer.clientActiveArea,n),this.viewer.updateClientAreaTopOrLeft(e,!0);var o=0;e.wrapTextAround?(i=this.viewer.clientActiveArea.clone(),r=this.viewer.clientArea.clone(),this.updateClientAreaForWrapTable(n,e,!0,i,r)):(this.adjustClientAreaBasedOnTextWrapForTable(e,this.viewer.clientActiveArea),this.isWrapText&&(o=this.viewer.clientActiveArea.x-this.viewer.clientArea.x,this.isWrapText=!1,e.x=this.viewer.clientActiveArea.x));var s=e.childWidgets[0].rowFormat.isHeader;e.childWidgets.length>0&&(e.header=s,e.continueHeader=s,e.headerHeight=0);for(var a=e.childWidgets[t];a;)a=(a=this.layoutRow(n,a)).nextRow;return this.documentHelper.viewer instanceof X&&e.wrapTextAround&&("Bottom"===e.positioning.verticalAlignment||"Center"===e.positioning.verticalAlignment||"Outside"===e.positioning.verticalAlignment)&&(this.updateTableFloatPoints(e),this.updateChildLocationForTable(e.y,e)),this.updateWidgetsToPage(n,[],e,!0),o>0&&(this.viewer.clientArea.x=this.viewer.clientArea.x-o),e.wrapTextAround&&e.bodyWidget&&this.updateClientAreaForWrapTable(n,e,!1,i,r),n[n.length-1].isLayouted=!0,"Word2013"===this.documentHelper.compatibilityMode||e.isInsideTable||e.wrapTextAround||(this.viewer.clientArea.x=this.viewer.clientArea.x+x.convertPointToPixel(e.firstChild.firstChild.leftMargin)),n[n.length-1]},t.prototype.updateClientAreaForWrapTable=function(e,t,i,r,n){if(i){if(t.wrapTextAround){this.updateTableFloatPoints(t);var o=this.viewer.clientActiveArea.clone(),s=this.adjustClientAreaBasedOnTextWrapForTable(t,this.viewer.clientActiveArea);o.x!==s.x&&(t.x=this.viewer.clientActiveArea.x),o.y!==s.y&&(t.y=this.viewer.clientActiveArea.y)}}else if(t.wrapTextAround&&t.bodyWidget)if(1==e.length)-1===t.bodyWidget.floatingElements.indexOf(t)&&t.bodyWidget.floatingElements.push(t),!sf.base.isNullOrUndefined(t.previousWidget)||t.isInHeaderFooter||t.isInsideTable?(this.viewer.clientActiveArea=r.clone(),this.viewer.clientArea=n.clone()):this.viewer.updateClientArea(t.bodyWidget,t.bodyWidget.page);else{this.documentHelper.tableLefts.pop(),this.viewer.updateClientArea(t.bodyWidget,t.bodyWidget.page);for(var a=0;a<e.length;a++){var l=e[a].bodyWidget;sf.base.isNullOrUndefined(l)||-1!==l.floatingElements.indexOf(e[a])||l.floatingElements.push(e[a])}}},t.prototype.addTableWidget=function(e,t,i){var r=t[t.length-1];return i&&(r=this.createTableWidget(r),t.push(r)),r.width=e.width,r.x=e.x,r.y=e.y,r.tableFormat.cellSpacing>0&&(r.height=r.height+x.convertPointToPixel(r.tableFormat.cellSpacing),r.isBidiTable?(r.leftBorderWidth=x.convertPointToPixel(this.getTableRightBorder(r.tableFormat.borders).getLineWidth()),r.rightBorderWidth=x.convertPointToPixel(this.getTableLeftBorder(r.tableFormat.borders).getLineWidth())):(r.leftBorderWidth=x.convertPointToPixel(this.getTableLeftBorder(r.tableFormat.borders).getLineWidth()),r.rightBorderWidth=x.convertPointToPixel(this.getTableRightBorder(r.tableFormat.borders).getLineWidth())),r.topBorderWidth=x.convertPointToPixel(this.getTableTopBorder(r.tableFormat.borders).getLineWidth()),r.bottomBorderWidth=x.convertPointToPixel(this.getTableBottomBorder(r.tableFormat.borders).getLineWidth()),r.x+=r.leftBorderWidth,r.y+=r.topBorderWidth,r.width-=r.leftBorderWidth,r.width-=r.rightBorderWidth,r.height+=r.bottomBorderWidth),r},t.prototype.updateWidgetsToPage=function(e,t,i,r,n){var o=this.viewer,s=e[e.length-1];if(!i.isInsideTable){for(var a=0;a<e.length;a++)this.updateHeightForTableWidget(e,t,e[a],n);s.childWidgets.length>0&&s.y!==s.childWidgets[0].y&&(s.y=s.childWidgets[0].y)}if(i.isBidiTable&&r)for(a=0;a<e.length;a++)for(var l=e[a],h=0;h<l.childWidgets.length;h++){l.childWidgets[h].shiftWidgetForRtlTable()}i.tableFormat.cellSpacing>0&&(s.y+s.height+x.convertPointToPixel(i.tableFormat.cellSpacing)>o.clientArea.bottom&&o instanceof Z&&(s.height=s.height-x.convertPointToPixel(i.tableFormat.cellSpacing)/2),o.cutFromTop(s.y+s.height)),this.viewer instanceof Z&&(i.containerWidget.height+=i.height),i.bodyWidget instanceof oe&&!i.wrapTextAround&&(i.containerWidget.height+=i.height,this.viewer.owner.enableHeaderAndFooter&&-1!==i.bodyWidget.headerFooterType.indexOf("Footer")&&this.shiftFooterChildLocation(i.bodyWidget,this.viewer))},t.prototype.updateHeightForTableWidget=function(e,t,i,r){for(var n=0;n<i.childWidgets.length;n++){var o=i.childWidgets[n];if(o===r)break;this.updateHeightForRowWidget(this.viewer,!0,e,t,o,!1,r)}},t.prototype.layoutRow=function(e,t,i){var r=t.ownerTable.isInsideTable;r||this.updateExistingFootnoteHeight(t);var n=this.viewer,o=[t];this.addTableRowWidget(n.clientActiveArea,o),n.updateClientAreaForRow(t,!0);for(var s=this.getMaxTopCellMargin(t),a=this.getMaxBottomCellMargin(t),l=0;l<t.childWidgets.length;l++){var h=t.childWidgets[l];this.layoutCell(h,s+t.topBorderWidth,a+t.bottomBorderWidth)}n.updateClientAreaForRow(t,!1);var d=[t];return i||this.updateWidgetsToTable(e,d,t,!1),r||(this.layoutedFootnoteElement=[]),d[d.length-1]},t.prototype.updateExistingFootnoteHeight=function(e){this.layoutedFootnoteElement=[],sf.base.isNullOrUndefined(e.bodyWidget.page.footnoteWidget)||0===e.bodyWidget.page.footnoteWidget.bodyWidgets.length?this.existFootnoteHeight=0:this.existFootnoteHeight=e.bodyWidget.page.footnoteWidget.height},t.prototype.isIntersecting=function(e,t,i,r){return(x.round(i,2)<=x.round(e,2)||x.round(i,2)<x.round(t,2))&&x.round(r,2)>x.round(e,2)},t.prototype.getAdjacentRowCell=function(e,t,i,r){var n=[],o=e.ownerTable.tableHolder.columns.length,s=e.ownerTable.childWidgets[r];if(sf.base.isNullOrUndefined(s))return n;var a=0,l=0,h=e.cellFormat.columnSpan,d=e.columnIndex;if(s.rowFormat.gridBefore>0){if(s.rowFormat.gridBefore>d+h)return n;a=s.rowFormat.beforeWidth,l=s.rowFormat.gridBefore}for(var c=0;c<s.childWidgets.length;c++){var p=s.childWidgets[c],u=p.x-p.margin.left,g=p.x+p.width+p.margin.right,f=p.columnIndex+p.cellFormat.columnSpan;if(c==s.childWidgets.length-1||x.round(u,2)>x.round(a,2)&&x.round(u,2)>x.round(t,2)){if(c==s.childWidgets.length-1&&s.rowFormat.gridAfter>0&&f+s.rowFormat.gridAfter===o)return n;if(this.isIntersecting(t,i,a,u))for(;h>0;){var m=s.getVerticalMergeStartCell(d,h),y=0;if(sf.base.isNullOrUndefined(m))break;var v=m.cellFormat.columnSpan;if(n.push(m),t=y=m.x+m.width+m.margin.right,h-=(l=m.columnIndex+v)-d,d=l,x.round(y,2)>=x.round(i,2))break}}if(this.isIntersecting(t,i,u,g)&&(n.push(p),t=g,h-=f-d,d=f),x.round(g,2)>=x.round(i,2))break;a=g,l=f}return n},t.prototype.addTableRowWidget=function(e,t){var i=t[t.length-1];0===i.rowFormat.beforeWidth&&0===i.rowFormat.gridBeforeWidth||this.documentHelper.alignTablesRowByRow&&"Left"!==i.ownerTable.tableFormat.tableAlignment?i.x=e.x:i.x+=0!==i.rowFormat.beforeWidth?i.rowFormat.beforeWidth:i.rowFormat.gridBeforeWidth,i.y=e.y,i.width=e.width;var r=0;if(!sf.base.isNullOrUndefined(i.ownerTable)&&!sf.base.isNullOrUndefined(i.ownerTable.tableFormat)&&i.ownerTable.tableFormat.cellSpacing>0){i.height=i.height+x.convertPointToPixel(i.ownerTable.tableFormat.cellSpacing);for(var n=0;n<i.childWidgets.length;n++)if(!sf.base.isNullOrUndefined(i.childWidgets[n].cellFormat)&&!sf.base.isNullOrUndefined(i.childWidgets[n].cellFormat.borders)){var o=pe.getCellBottomBorder(i.childWidgets[n]).getLineWidth();o>r&&(r=o)}if(i.bottomBorderWidth=x.convertPointToPixel(r),i.index>0&&!sf.base.isNullOrUndefined(i.previousWidget)){var s=i.previousWidget;r=0;for(var a=0;a<s.childWidgets.length;a++)if(!sf.base.isNullOrUndefined(s.childWidgets[a].cellFormat)&&!sf.base.isNullOrUndefined(s.childWidgets[a].cellFormat.borders)){var l=pe.getCellBottomBorder(s.childWidgets[a]).getLineWidth();l>r&&(r=l)}i.topBorderWidth=x.convertPointToPixel(r)}}if(!sf.base.isNullOrUndefined(i.childWidgets))for(a=0;a<i.childWidgets.length;a++)if(!sf.base.isNullOrUndefined(i.childWidgets[a].cellFormat)&&!sf.base.isNullOrUndefined(i.childWidgets[a].cellFormat.borders)){var h=pe.getCellTopBorder(i.childWidgets[a]).getLineWidth();h>r&&(r=h)}if(i.topBorderWidth=x.convertPointToPixel(r),!sf.base.isNullOrUndefined(i.ownerTable)&&!sf.base.isNullOrUndefined(i.ownerTable.tableFormat)&&i.ownerTable.tableFormat.cellSpacing<=0&&i.rowIndex===i.ownerTable.childWidgets.length-1){for(a=0;a<i.childWidgets.length;a++)if(!sf.base.isNullOrUndefined(i.childWidgets[a].cellFormat)&&!sf.base.isNullOrUndefined(i.childWidgets[a].cellFormat.borders)){var d=pe.getCellBottomBorder(i.childWidgets[a]).getLineWidth();d>r&&(r=d)}i.bottomBorderWidth=x.convertPointToPixel(r)}return i},t.prototype.getMaxTopCellMargin=function(e){if(sf.base.isNullOrUndefined(e.childWidgets))return 0;for(var t=0,i=0;i<e.childWidgets.length;i++){var r=e.childWidgets[i],n=0;(n=r.cellFormat.hasValue("topMargin")?x.convertPointToPixel(r.cellFormat.topMargin):e.rowFormat.hasValue("topMargin")?x.convertPointToPixel(e.rowFormat.topMargin):x.convertPointToPixel(e.ownerTable.tableFormat.topMargin))>t&&(t=n)}return t},t.prototype.getMaxBottomCellMargin=function(e){if(sf.base.isNullOrUndefined(e.childWidgets))return 0;for(var t=0,i=0;i<e.childWidgets.length;i++){var r=e.childWidgets[i],n=0;(n=r.cellFormat.hasValue("bottomMargin")?x.convertPointToPixel(r.cellFormat.bottomMargin):e.rowFormat.hasValue("bottomMargin")?x.convertPointToPixel(e.rowFormat.bottomMargin):x.convertPointToPixel(e.ownerTable.tableFormat.bottomMargin))>t&&(t=n)}return t},t.prototype.layoutCell=function(e,t,i){var r=this.viewer;if(this.addTableCellWidget(e,r.clientActiveArea,t,i),this.updateTopBorders(e),r.updateClientAreaForCell(e,!0),0===e.childWidgets.length){var n=new le;n.characterFormat=new P,n.paragraphFormat=new ct,n.index=0;var o=new ue(n);n.childWidgets.push(o),e.childWidgets.push(n)}for(var s=0;s<e.childWidgets.length;s++){var a=e.childWidgets[s];r.updateClientAreaForBlock(a,!0),a.containerWidget=e,this.layoutBlock(a,0),r.updateClientAreaForBlock(a,!1)}this.updateWidgetToRow(e),r.updateClientAreaForCell(e,!1)},t.prototype.updateTopBorders=function(e){if(e.updatedTopBorders=[],0===e.ownerTable.tableFormat.cellSpacing){var t=e.cellFormat.borders.top;(!t.isBorderDefined||t.isBorderDefined&&"None"===t.lineStyle&&0===t.lineWidth&&t.hasValue("color"))&&(t=e.ownerRow.rowFormat.borders.horizontal),t.isBorderDefined||(t=e.ownerRow.ownerTable.tableFormat.borders.horizontal);for(var i=e.x-e.margin.left,r=e.x+e.width+e.margin.right,n=this.getAdjacentRowCell(e,i,r,e.ownerRow.indexInOwner-1),o=0;o<n.length;o++){var s=n[o],a=s.cellFormat.borders.bottom;(!a.isBorderDefined||a.isBorderDefined&&"None"===a.lineStyle&&0===a.lineWidth&&a.hasValue("color"))&&(a=s.ownerRow.rowFormat.borders.horizontal),a.isBorderDefined||(a=s.ownerRow.ownerTable.tableFormat.borders.horizontal);var l=void 0;l="None"===t.lineStyle||"Cleared"===t.lineStyle?a:"Cleared"===a.lineStyle||"None"===a.lineStyle?t:e.getBorderBasedOnPriority(t,a);var h=s.x-s.margin.left,d=s.x+s.width+s.margin.right;if(0===o&&i<h&&e.updatedTopBorders.push({border:t,width:h-i}),l){var c=0;(c=x.round(d,2)===x.round(r,2)&&x.round(h,2)===x.round(i,2)?r-i:x.round(h,2)>=x.round(i,2)&&x.round(d,2)>=x.round(r,2)?r-h:x.round(h,2)>=x.round(i,2)&&x.round(d,2)<=x.round(r,2)?d-h:x.round(h,2)<=x.round(i,2)&&x.round(d,2)<=x.round(r,2)?d-i:(x.round(h,2)<=x.round(i,2)&&(x.round(d,2),x.round(r,2)),r-i))<0&&(c=0),e.updatedTopBorders.push({border:l,width:c})}o===n.length-1&&r>d&&e.updatedTopBorders.push({border:t,width:r-d})}}},t.prototype.shiftLayoutedItems=function(e){if(sf.base.isNullOrUndefined(this.documentHelper.blockToShift)||sf.base.isNullOrUndefined(this.documentHelper.blockToShift.containerWidget))return this.documentHelper.blockToShift=void 0,this.checkAndShiftEndnote(),void this.documentHelper.removeEmptyPages();var t=this.documentHelper.blockToShift,i=t.bodyWidget.index;this.reLayoutOrShiftWidgets(t,this.viewer);for(var r=!0,n=t.getSplitWidgets(),o=n[n.length-1].nextRenderedWidget;o instanceof se&&(o.bodyWidget.index===i||"NoBreak"===o.bodyWidget.sectionFormat.breakCode&&(void 0!==o.bodyWidget.nextRenderedWidget&&o.bodyWidget.nextRenderedWidget.page===o.bodyWidget.page||void 0===o.bodyWidget.nextRenderedWidget));){var s,a=t.getSplitWidgets();s=a[a.length-1],r=!1;var l=void 0;if(a=(t=o).getSplitWidgets(),(t instanceof le||t instanceof de)&&(l=a[0]),s.containerWidget===l.containerWidget&&x.round(l.y,2)===x.round(this.viewer.clientActiveArea.y,2)&&sf.base.isNullOrUndefined(l.nextWidget)&&s.containerWidget.sectionFormat.columns.length<=1)break;sf.base.isNullOrUndefined(s.floatingElements),r=!0,this.reLayoutOrShiftWidgets(t,this.viewer),o=(n=t.getSplitWidgets())[n.length-1].nextRenderedWidget}this.viewer.owner.editorModule&&this.viewer.owner.editorModule.updateListItemsTillEnd(t,r),this.documentHelper.blockToShift=void 0;this.viewer;this.documentHelper.removeEmptyPages(),this.updateFieldElements(),this.viewer.updateScrollBars()},t.prototype.checkAndShiftEndnote=function(){if(this.documentHelper.owner.selection){var e=this.documentHelper.owner.selection.end.paragraph;e.isInsideTable&&(e=this.getParentTable(e)),e.isInHeaderFooter||e.bodyWidget.containerWidget instanceof ae||!sf.base.isNullOrUndefined(e.nextRenderedWidget)||e.bodyWidget instanceof ae||this.isRelayoutFootnote||!e.bodyWidget.page.endnoteWidget||this.layoutfootNote(e.bodyWidget.page.endnoteWidget)}},t.prototype.updateFieldElements=function(){for(var e=0;e<this.documentHelper.fields.length;e++){var t=this.documentHelper.fields[e];if((this.viewer instanceof X||this.viewer instanceof Z&&!(t.line.paragraph.bodyWidget instanceof oe))&&!sf.base.isNullOrUndefined(this.documentHelper.selection)){var i=this.documentHelper.selection.getFieldCode(t);if(!sf.base.isNullOrUndefined(i)&&(i.toLowerCase().match("numpages")||i.toLowerCase().match("sectionpages"))&&!sf.base.isNullOrUndefined(t.fieldSeparator)){var r=t.fieldSeparator.nextNode;if(!sf.base.isNullOrUndefined(r)){var n=r.text;r.text=this.documentHelper.pages.length.toString();var o=t.line.paragraph;if(!sf.base.isNullOrUndefined(o.bodyWidget)&&!sf.base.isNullOrUndefined(o.bodyWidget.page)&&n!==r.text){var s=o.childWidgets.indexOf(t.line),a=t.line.children.indexOf(r);this.reLayoutParagraph(o,s,a)}}}}}},t.prototype.reLayoutOrShiftWidgets=function(e,t){var i=e,r=!1;if(this.isNeedToRelayout(e.bodyWidget)?(this.updateContainerForTable(i,t),i instanceof de&&(i=i.combineWidget(this.viewer),this.clearTableWidget(i,!0,!0,!0)),t.updateClientAreaForBlock(i,!0),this.layoutBlock(i,0),t.updateClientAreaForBlock(i,!1),r=!0):this.shiftWidgetsBlock(i,t),this.documentHelper.pages.indexOf(i.bodyWidget.page)>0&&i===i.bodyWidget.childWidgets[0]&&i instanceof le)for(var n=i.bodyWidget.childWidgets[0].childWidgets[0].children,o=0;o<n.length;o++){var s=n[o];s.margin.top>0&&s.margin.top===this.getBeforeSpacing(s.paragraph)&&(s.margin.top-=this.getBeforeSpacing(s.paragraph))}this.viewer.owner.editorModule&&!r&&this.viewer.owner.editorModule.updateRenderedListItems(i),!this.isRelayoutFootnote&&i.bodyWidget.page.footnoteWidget&&this.layoutfootNote(i.bodyWidget.page.footnoteWidget),i.bodyWidget instanceof ae||this.isRelayoutFootnote||!i.bodyWidget.page.endnoteWidget||this.layoutfootNote(i.bodyWidget.page.endnoteWidget)},t.prototype.isNeedToRelayout=function(e){for(var t=0;t<e.floatingElements.length;t++){var i=e.floatingElements[t];if(i instanceof de||i instanceof De&&("Square"===i.textWrappingStyle||"TopAndBottom"===i.textWrappingStyle))return!0}return!1},t.prototype.shiftWidgetsBlock=function(e,t){e instanceof le?this.shiftWidgetsForPara(e,t):e instanceof de&&this.shiftWidgetsForTable(e,t)},t.prototype.shiftWidgetsForPara=function(e,t){if(!(e.height>t.clientArea.height+t.clientArea.y)){e.bodyWidget;for(var i=this.getBodyWidgetOfPreviousBlock(e,0),r=i.bodyWidget,n=i.index,o=void 0,s=!1,a=0;a<e.getSplitWidgets().length;a++){var l=e.getSplitWidgets()[a];if(!sf.base.isNullOrUndefined(o)){var h=!!o.lastChild&&o.lastChild.isEndsWithPageBreak,d=!!o.lastChild&&o.lastChild.isEndsWithColumnBreak;if(this.shiftToPreviousWidget(l,t,o,h,d),(sf.base.isNullOrUndefined(l.childWidgets)||0===l.childWidgets.length)&&!h&&!d){a--;continue}o=void 0,r!==l.containerWidget&&(r=l.containerWidget,(h||d)&&t.updateClientAreaByWidget(l))}var c=[];if(s||(c=this.getFootNoteWidgetsOf(l)),s=!1,this.isFitInClientArea(l,t,c)){if(this.keepWithNext&&(this.updateClientPositionForBlock(l.containerWidget.firstChild,l),this.keepWithNext=!1),o=l,t.updateClientAreaForBlock(l,!0),l.x=t.clientActiveArea.x,t.updateClientAreaForBlock(l,!1),l.y=t.clientActiveArea.y,l.floatingElements.length>0)for(var p=0;p<l.floatingElements.length;p++){var u=l.floatingElements[p],g=0;if(u instanceof Ee&&"Inline"===u.textWrappingStyle){var f=u.line.indexInOwner,m=0;g=u.textFrame.marginTop;for(var y=0;y<f;y++)m+=l.childWidgets[y].height;u.y=l.y+m}else{var v=this.getFloatingItemPoints(u);u.y=v.y,u.x=v.x}u instanceof Ee&&this.updateChildLocationForCellOrShape(u.y+g,u)}if(t.cutFromTop(t.clientActiveArea.y+l.height),!sf.base.isNullOrUndefined(r)&&r!==l.containerWidget&&(n++,r.lastChild.isEndsWithPageBreak||r.lastChild.isEndsWithColumnBreak||this.updateContainerWidget(l,r,n,!0,c),c.length>0&&r.page.footnoteWidget))for(p=0;p<c.length;p++)-1===r.page.footnoteWidget.bodyWidgets.indexOf(c[p])&&l.bodyWidget.page.index!=c[p].page.index&&(r.page.footnoteWidget.bodyWidgets.push(c[p]),r.page.footnoteWidget.height+=c[p].height);if((l.isEndsWithPageBreak||l.isEndsWithColumnBreak)&&this.viewer instanceof X){var b=this.createOrGetNextBodyWidget(r,this.viewer);b=this.moveBlocksToNextPage(l,!0),t.updateClientArea(b,b.page)}}else{var w=l.previousRenderedWidget;h=!1,d=!1;w instanceof le&&w.isEndsWithPageBreak&&this.viewer instanceof X&&(h=!0),w instanceof le&&w.isEndsWithColumnBreak&&this.viewer instanceof X&&(d=!0);var x=this.splitWidget(l,t,r,n+1,h,c,d);o=void 0,r!==l.containerWidget&&(r=l.containerWidget,a--,c.length>0&&(s=!0)),n=r.childWidgets.indexOf(l),x&&(r=e.getSplitWidgets()[a+1].containerWidget)}}}},t.prototype.getFootNotesOfBlock=function(e,t){if(sf.base.isNullOrUndefined(t)&&(t=[]),e.childWidgets.length>0)for(var i=0;i<this.documentHelper.footnoteCollection.length;i++)this.documentHelper.footnoteCollection[i].line.paragraph===e&&t.push(this.documentHelper.footnoteCollection[i]);return t},t.prototype.getFootNotesWidgetsInLine=function(e){for(var t=[],i=0;i<e.children.length;i++){var r=e.children[i];r instanceof Me&&t.push(r)}return this.getFootNoteWidgetsBy(e.paragraph,t)},t.prototype.getFootNoteWidgetsBy=function(e,t){var i=[];if(e.bodyWidget.page.footnoteWidget)for(var r=0;r<e.bodyWidget.page.footnoteWidget.bodyWidgets.length;r++)for(var n=0;n<t.length;n++)e.bodyWidget.page.footnoteWidget.bodyWidgets[r].footNoteReference===t[n]&&i.push(e.bodyWidget.page.footnoteWidget.bodyWidgets[r]);if(0===i.length&&!sf.base.isNullOrUndefined(e.previousRenderedWidget)&&e.previousRenderedWidget.bodyWidget.page.footnoteWidget)for(r=0;r<e.previousRenderedWidget.bodyWidget.page.footnoteWidget.bodyWidgets.length;r++)for(n=0;n<t.length;n++)e.previousRenderedWidget.bodyWidget.page.footnoteWidget.bodyWidgets[r].footNoteReference===t[n]&&i.push(e.previousRenderedWidget.bodyWidget.page.footnoteWidget.bodyWidgets[r]);else if(!sf.base.isNullOrUndefined(e.bodyWidget.previousRenderedWidget)&&e.bodyWidget.previousRenderedWidget.page.footnoteWidget)for(r=0;r<e.bodyWidget.previousRenderedWidget.page.footnoteWidget.bodyWidgets.length;r++)for(n=0;n<t.length;n++)e.bodyWidget.previousRenderedWidget.page.footnoteWidget.bodyWidgets[r].footNoteReference===t[n]&&i.push(e.bodyWidget.previousRenderedWidget.page.footnoteWidget.bodyWidgets[r]);else if(!sf.base.isNullOrUndefined(e.bodyWidget.nextRenderedWidget)&&e.bodyWidget.nextRenderedWidget.page.footnoteWidget)for(r=0;r<e.bodyWidget.nextRenderedWidget.page.footnoteWidget.bodyWidgets.length;r++)for(n=0;n<t.length;n++)e.bodyWidget.nextRenderedWidget.page.footnoteWidget.bodyWidgets[r].footNoteReference===t[n]&&i.push(e.bodyWidget.nextRenderedWidget.page.footnoteWidget.bodyWidgets[r]);return i},t.prototype.getFootNoteWidgetsOf=function(e,t){var i=[],r=[];if(e instanceof de)for(var n=0;n<e.childWidgets.length;n++)for(var o=e.childWidgets[n],s=0;s<o.childWidgets.length;s++)for(var a=o.childWidgets[s],l=0;l<a.childWidgets.length;l++){var h=a.childWidgets[l];r=this.getFootNotesOfBlock(h,r);for(var d=this.getFootNoteWidgetsBy(h,r),c=0;c<d.length;c++)-1===i.indexOf(d[c])&&i.push(d[c])}else if((r=this.getFootNotesOfBlock(e)).length>0&&(i=this.getFootNoteWidgetsBy(e,r)),t&&0===i.length)for(var p=0;p<r.length;p++)i.push(r[p].bodyWidget);return i},t.prototype.getFootNodeWidgetsToShiftToPage=function(e){for(var t,i=e.getSplitWidgets(),r=[],n=e.containerWidget,o=0;o<i.length;o++)for(var s=this.getFootNoteWidgetsOf(i[o]),a=0;a<s.length;a++)n!==(t=s[a].containerWidget)&&r.push(s[a]);return{footNoteWidgets:r,fromBodyWidget:t,toBodyWidget:n}},t.prototype.shiftTableWidget=function(e,t,i){void 0===i&&(i=!1);var r,n,o=[e];this.addTableWidget(this.viewer.clientActiveArea,o),this.viewer.updateClientAreaTopOrLeft(e,!0),e.wrapTextAround&&(r=this.viewer.clientActiveArea.clone(),n=this.viewer.clientArea.clone(),this.updateClientAreaForWrapTable(o,e,!0,r,n));for(var s=e.childWidgets[0];s;)s=(s=this.shiftRowWidget(o,s,i)).nextRow;return this.updateWidgetsToPage(o,[],e,!0),e.wrapTextAround&&e.bodyWidget&&this.updateClientAreaForWrapTable(o,e,!1,r,n),o[o.length-1]},t.prototype.shiftRowWidget=function(e,t,i){void 0===i&&(i=!1);var r=this.viewer;i&&(t.height=0);var n=t.ownerTable.isInsideTable;n||this.updateExistingFootnoteHeight(t);var o=[t];this.addTableRowWidget(r.clientActiveArea,o),r.updateClientAreaForRow(t,!0);for(var s=0;s<t.childWidgets.length;s++){var a=t.childWidgets[s];i&&(a.height=0),this.shiftCellWidget(a,this.getMaxTopCellMargin(t)+t.topBorderWidth,this.getMaxBottomCellMargin(t)+t.bottomBorderWidth,i)}if(r.updateClientAreaForRow(t,!1),!n){var l=this.footnoteHeight;this.updateFootnoteToBody(t,this.layoutedFootnoteElement),this.footnoteHeight=l}return this.updateWidgetsToTable(e,o,t,!1),n||(this.layoutedFootnoteElement=[]),o[o.length-1]},t.prototype.updateFootnoteToBody=function(e,t){this.layoutFootnoteInSplittedRow(e,this.getFootnoteBody(t)),sf.base.isNullOrUndefined(e.ownerTable.footnoteElement)&&(e.ownerTable.footnoteElement=[]);for(var i=0;i<t.length;i++)e.ownerTable.footnoteElement.push(t[i])},t.prototype.getFootnoteBody=function(e){for(var t=[],i=0;i<e.length;i++)t.push(e[i].bodyWidget);return t},t.prototype.shiftCellWidget=function(e,t,i,r){sf.base.isNullOrUndefined(r)&&(r=!1);var n=this.viewer;this.addTableCellWidget(e,n.clientActiveArea,t,i);var o=this.viewer.clientActiveArea.height;n.updateClientAreaForCell(e,!0);for(var s=0;s<e.childWidgets.length;s++){var a=e.childWidgets[s];n.updateClientAreaForBlock(a,!0),a instanceof le?this.shiftParagraphWidget(a):this.shiftTableWidget(a,n,r),n.updateClientAreaForBlock(a,!1)}this.updateWidgetToRow(e),n.updateClientAreaForCell(e,!1),e.ownerTable.isInsideTable||(this.viewer.clientActiveArea.height=o)},t.prototype.shiftParagraphWidget=function(e){this.addParagraphWidget(this.viewer.clientActiveArea,e),this.viewer.cutFromTop(this.viewer.clientActiveArea.y+e.height);for(var t=this.getFootNoteWidgetsOf(e,!0),i=0;i<t.length;i++)this.layoutedFootnoteElement.push(t[i].footNoteReference);this.footnoteHeight+=this.getFootNoteHeight(t),this.updateWidgetToPage(this.viewer,e)},t.prototype.updateContainerForTable=function(e,t){var i=this.getBodyWidgetOfPreviousBlock(e,0),r=i.bodyWidget,n=i.index,o=r.lastChild.lastChild.isEndsWithPageBreak,s=r.lastChild.lastChild.isEndsWithColumnBreak;r!==e.containerWidget&&(o||s?t.updateClientArea(e.bodyWidget,e.bodyWidget.page):this.updateContainerWidget(e,r,n+1,!0)),(e.isInHeaderFooter||this.viewer instanceof Z)&&(e.containerWidget.height-=e.height)},t.prototype.shiftWidgetsForTable=function(e,t){this.updateContainerForTable(e,t),this.viewer.updateClientAreaForBlock(e,!0);var i=this.viewer.clientArea.x;"Word2013"===this.documentHelper.compatibilityMode||e.isInsideTable||(this.viewer.clientActiveArea.x=this.viewer.clientActiveArea.x-x.convertPointToPixel(e.firstChild.firstChild.leftMargin)),this.updateVerticalPositionToTop(e,!0);var r=e.combineWidget(this.viewer);this.documentHelper.layout.updateChildLocationForTable(r.y,r),this.clearTableWidget(r,!0,!1,!1,!0),this.shiftTableWidget(r,this.viewer),this.updateVerticalPositionToTop(e,!1),"Word2013"===this.documentHelper.compatibilityMode||e.isInsideTable||(this.viewer.clientArea.x=i),this.viewer.updateClientAreaForBlock(e,!1)},t.prototype.updateVerticalPositionToTop=function(e,t){for(var i=0;i<e.getSplitWidgets().length;i++)for(var r=e.getSplitWidgets()[i],n=0;n<r.childWidgets.length;n++)for(var o=r.childWidgets[n],s=0;s<o.childWidgets.length;s++){var a=o.childWidgets[s];this.documentHelper.layout.updateCellVerticalPosition(a,t,!1)}},t.prototype.splitWidget=function(e,t,i,r,n,o,s){var a=e.childWidgets[0],l=e.paragraphFormat.keepLinesTogether&&this.viewer.clientActiveArea.y!==this.viewer.clientArea.y?e.height:this.getMaxElementHeight(a),h=e.getSplitWidgets(),d=e.containerWidget;l=this.getMaximumLineHeightToSplit(e,l,t);var c=this.getFootNotesWidgetsInLine(a);if(sf.base.isNullOrUndefined(e.previousWidget)&&c.length>0)for(var p=0;p<c.length;p++)for(var u=0;u<c[p].childWidgets.length;u++)l+=c[p].childWidgets[u].height;if(t.clientActiveArea.height>=l&&!n&&!s){var g=void 0,f=h.indexOf(e);f<h.length-1?d=(g=h[f+1]).containerWidget:((g=new le).index=e.index,g.characterFormat=e.characterFormat,g.paragraphFormat=e.paragraphFormat,g.width=e.width,g.x=e.x,g.y=e.y,h.push(g)),i!==e.containerWidget&&this.updateContainerWidget(e,i,r,!0);for(p=e.childWidgets.length-1;p>0;p--){var m=e.childWidgets[p];if(this.isFitInClientArea(e,t,void 0)){1===g.childWidgets.length&&this.updateParagraphWidgetInternal(m,g,0);break}var y=e.childWidgets[p];this.updateParagraphWidgetInternal(y,g,0)}if(sf.base.isNullOrUndefined(g.containerWidget)&&g.childWidgets.length>0){var v=t.clientActiveArea.y,b=new $(t.clientArea.x,t.clientArea.y,t.clientArea.width,t.clientArea.height),w=new $(t.clientActiveArea.x,t.clientActiveArea.y,t.clientActiveArea.width,t.clientActiveArea.height),x=e.bodyWidget.page;if(d=this.moveBlocksToNextPage(e,!1,-1),g.containerWidget=d,d.childWidgets.splice(0,0,g),x===d.page)return e.x!==e.containerWidget.x&&(e.x=e.containerWidget.x),e.y=v,t.updateClientArea(d,d.page),g=this.addParagraphWidget(this.viewer.clientActiveArea,g),!0;if(d.height+=g.height,d!=i&&this.moveFootNotesToPage(o,i,d),1===d.childWidgets.length&&d.firstChild instanceof le&&d.firstChild.equals(e))return e.y=v,!0;t.clientArea=b,t.clientActiveArea=w}}else if(d=this.createOrGetNextBodyWidget(i,this.viewer),e.containerWidget!==d){x=e.bodyWidget.page;if(i!==(d=this.moveBlocksToNextPage(e,!0))&&(t.updateClientArea(d,d.page),this.updateContainerWidget(e,d,0,!0),this.addParagraphWidget(this.viewer.clientActiveArea,e),this.moveFootNotesToPage(o,i,d)),i.page===d.page)return i!==d||(t.updateClientArea(d,d.page),!1)}return i===e.containerWidget?(e.x!==e.containerWidget.x&&(e.x=e.containerWidget.x),e.y=t.clientActiveArea.y,t.cutFromTop(t.clientActiveArea.y+e.height)):t.updateClientArea(d,d.page),!1},t.prototype.getMaximumLineHeightToSplit=function(e,t,i){if(i.clientActiveArea.height>=t&&!e.paragraphFormat.keepLinesTogether&&e.paragraphFormat.widowControl&&!sf.base.isNullOrUndefined(e.previousWidget)&&sf.base.isNullOrUndefined(e.previousSplitWidget))for(var r=e.height,n=e.childWidgets.length-1;n>=0;n--){var o=e.childWidgets[n],s=this.getMaxElementHeight(o);if(o.height>s&&(r-=o.height-s),i.clientActiveArea.height>=r){0===n&&(t=e.height);break}r-=o.height}return t},t.prototype.moveFootNotesToPage=function(e,t,i){if(e.length>0&&t.page.footnoteWidget&&t.page!==i.page){for(var r=-1,n=void 0,o=0,s=!1,a=0;a<e.length;a++)if(n=e[a],(r=t.page.footnoteWidget.bodyWidgets.indexOf(n))>=0){void 0===i.page.footnoteWidget&&this.addEmptyFootNoteToBody(i);for(var l=0;l<i.page.footnoteWidget.bodyWidgets.length;l++){i.page.footnoteWidget.bodyWidgets[l].footNoteReference===n.footNoteReference&&(s=!0)}if(t.page.footnoteWidget.bodyWidgets.splice(r,1),i.page.footnoteWidget.bodyWidgets.indexOf(n)<0&&!s){i.page.footnoteWidget.bodyWidgets.length;var h=this.documentHelper.pages.indexOf(t.page),d=this.documentHelper.pages.indexOf(i.page);n.containerWidget=i.page.footnoteWidget,n.page=i.page,h>d?(i.page.footnoteWidget.bodyWidgets.push(n),o++):i.page.footnoteWidget.bodyWidgets.splice(o++,0,n),i.page.footnoteWidget.height+=n.height}t.page.footnoteWidget.height-=n.height}t.page.footnoteWidget&&0===t.page.footnoteWidget.bodyWidgets.length&&(t.page.footnoteWidget=void 0),void 0!==t.page.footnoteWidget&&this.layoutfootNote(t.page.footnoteWidget),void 0!==i.page.footnoteWidget&&this.layoutfootNote(i.page.footnoteWidget)}},t.prototype.addEmptyFootNoteToBody=function(e){var t=new ae;t.footNoteType="Footnote",t.page=e.page;var i=new le;i.characterFormat=new P,i.paragraphFormat=new ct,i.index=0;var r=new ue(i);i.childWidgets.push(r),t.height=this.documentHelper.textHelper.getParagraphMarkSize(i.characterFormat).Height,t.margin=new te(0,t.height,0,0),e.page.footnoteWidget=t},t.prototype.getMaxElementHeight=function(e){var t=0;if(0===e.children.length||1===e.children.length&&e.children[0]instanceof je||2===e.children.length&&e.children[0]instanceof je&&e.children[1]instanceof je){if(t=this.documentHelper.selection.getParagraphMarkSize(e.paragraph,0,0).height,t+=0,e.children.length>0)t<(r=e.children[0]).margin.top+r.height&&(t=r.margin.top+r.height)}else for(var i=0;i<e.children.length;i++){var r;t<(r=e.children[i]).margin.top+r.height&&(t=r.margin.top+r.height)}return t},t.prototype.createOrGetNextBodyWidget=function(e,t){var i=this.viewer.columnLayoutArea.getNextColumnByBodyWidget(e);if(!sf.base.isNullOrUndefined(i))return this.createOrGetNextColumnBody(e);var r,n=void 0;r=this.documentHelper.pages.indexOf(e.page);var o,s=void 0;if(o=e.index,r===this.documentHelper.pages.length-1||this.documentHelper.pages[r+1].sectionIndex!==o){var a=new ne;a.sectionFormat=e.sectionFormat,a.index=e.index,s=t.createNewPage(a),this.documentHelper.pages[r+1].sectionIndex!==o&&this.documentHelper.insertPage(r+1,s),n=s.bodyWidgets[0]}else n=(s=this.documentHelper.pages[r+1]).bodyWidgets[0];return n},t.prototype.isFitInClientArea=function(e,t,i){var r=e.childWidgets[e.childWidgets.length-1],n=e.height,o=this.getMaxElementHeight(r);r.height>o&&(n-=r.height-o);var s=0;if(!sf.base.isNullOrUndefined(i)&&i.length>0){i[0].containerWidget instanceof ae&&(s=i[0].containerWidget.margin.top);for(var a=0;a<i.length;a++)for(var l=0;l<i[a].childWidgets.length;l++)s+=i[a].childWidgets[l].height}return t.clientActiveArea.height>=n+s},t.prototype.isLineInFootNote=function(e,t){for(var i=0;i<t.length;i++)if(t[i].line===e)return!0;return!1},t.prototype.shiftToPreviousWidget=function(e,t,i,r,n){var o=e.containerWidget,s=i.containerWidget,a=[],l=[];s!==o&&(a=this.getFootNotesOfBlock(e));for(var h=0;h<e.childWidgets.length;h++){var d=e.childWidgets[h],c=this.getMaxElementHeight(d);if(this.isLineInFootNote(d,a)){for(var p=this.getFootNoteWidgetsBy(d.paragraph,a),u=0,g=0;g<p.length;g++)for(var f=p[g],m=0;m<f.childWidgets.length;m++)u+=f.childWidgets[m].height;p.length>0&&p[0].containerWidget&&(u+=p[0].containerWidget.margin.top),c+=u}if(!(t.clientActiveArea.height>=c)||r||n){var y=i.containerWidget,v=this.createOrGetNextBodyWidget(y,t);e.containerWidget!==v&&(v=this.moveBlocksToNextPage(e,!0)),y!==v&&((a=this.getFootNotesOfBlock(e)).length>0&&(l=l.concat(this.getFootNoteWidgetsBy(e,a)),s=v),this.updateContainerWidget(e,v,0,!0)),t.updateClientArea(v,v.page);break}if(a.length>0&&this.isLineInFootNote(d,a)&&(l=l.concat(this.getFootNoteWidgetsBy(d.paragraph,a))),this.updateParagraphWidgetInternal(d,i,i.childWidgets.length),h--,t.cutFromTop(t.clientActiveArea.y+d.height),sf.base.isNullOrUndefined(e.childWidgets))break}!sf.base.isNullOrUndefined(l)&&l.length>0&&o.page.footnoteWidget&&o!=s&&this.moveFootNotesToPage(l,o,s)},t.prototype.updateParagraphWidgetInternal=function(e,t,i){sf.base.isNullOrUndefined(e.paragraph)||(e.paragraph.childWidgets.splice(e.paragraph.childWidgets.indexOf(e),1),e.paragraph.height-=e.height,sf.base.isNullOrUndefined(e.paragraph.containerWidget)||(e.paragraph.containerWidget.height-=e.height),(sf.base.isNullOrUndefined(e.paragraph.childWidgets)||0===e.paragraph.childWidgets.length)&&e.paragraph.destroyInternal(this.viewer)),t.childWidgets.splice(i,0,e),e.paragraph=t,t.height+=e.height,sf.base.isNullOrUndefined(t.containerWidget)||(t.containerWidget.height+=e.height)},t.prototype.shiftNextWidgets=function(e){for(var t=e;t.nextWidget instanceof se;)t=t.nextWidget,this.reLayoutOrShiftWidgets(t,this.viewer)},t.prototype.updateContainerWidget=function(e,t,i,r,n){if(!(e.containerWidget&&e.containerWidget.containerWidget instanceof ae)){var o=e.containerWidget;if(!sf.base.isNullOrUndefined(e.containerWidget)&&(e.containerWidget.childWidgets.splice(e.containerWidget.childWidgets.indexOf(e),1),e.containerWidget.height-=t.height,(sf.base.isNullOrUndefined(e.containerWidget.childWidgets)||0===e.containerWidget.childWidgets.length)&&e.containerWidget instanceof ne&&e.containerWidget!==t&&r)){var s=e.containerWidget.page;this.documentHelper.pages[this.documentHelper.pages.length-1]===s&&-1!==this.viewer.visiblePages.indexOf(s)&&this.documentHelper.scrollToBottom(),(sf.base.isNullOrUndefined(s.nextPage)||s.nextPage.bodyWidgets[0].index!==e.containerWidget.index)&&e.containerWidget.destroyInternal(this.viewer)}if(t.childWidgets.splice(i,0,e),e instanceof le&&!sf.base.isNullOrUndefined(e.floatingElements))for(var a=0;a<e.floatingElements.length;a++){var l=e.floatingElements[a];"Inline"!==l.textWrappingStyle&&(t.floatingElements.push(l),e.bodyWidget.floatingElements.splice(e.bodyWidget.floatingElements.indexOf(l),1),t.floatingElements.sort((function(e,t){return e.y-t.y})))}e instanceof de&&e.wrapTextAround&&-1!==e.bodyWidget.floatingElements.indexOf(e)&&e.bodyWidget.floatingElements.splice(e.bodyWidget.floatingElements.indexOf(e),1),t.height+=t.height,e.containerWidget=t,o&&o.page&&o.page.footnoteWidget&&n&&n.length>0&&this.moveFootNotesToPage(n,o,t)}},t.prototype.getBodyWidgetOfPreviousBlock=function(e,t){var i=void 0,r=e.previousRenderedWidget;return i=r&&r.containerWidget.equals(e.containerWidget)?r.containerWidget:e.containerWidget,t=r&&r.containerWidget.equals(e.containerWidget)?i.childWidgets.indexOf(r):e.containerWidget.childWidgets.indexOf(e),{bodyWidget:i,index:t}},t.prototype.moveBlocksToNextPage=function(e,t,i,r){var n=e.bodyWidget,o=this.viewer.columnLayoutArea.getNextColumnByBodyWidget(e.bodyWidget),s=void 0,a=void 0;if(!sf.base.isNullOrUndefined(o)&&(a=this.moveToNextColumnByBodyWidget(e,i),this.viewer.updateClientArea(a,a.page),e.bodyWidget.sectionFormat.columns.length>1))for(var l=e.bodyWidget.page.bodyWidgets.indexOf(e.bodyWidget),h=e.bodyWidget.x+e.bodyWidget.sectionFormat.columns[l].width+e.bodyWidget.sectionFormat.columns[l].space,d=0;d<e.bodyWidget.floatingElements.length;d++)e.bodyWidget.floatingElements[d]instanceof Ee&&h<e.bodyWidget.floatingElements[d].x+e.bodyWidget.floatingElements[d].width&&a.floatingElements.push(e.bodyWidget.floatingElements[d]);if(sf.base.isNullOrUndefined(a)){var c=!1,p=n.page.index+1;this.documentHelper.pages.length>p&&(0!==(s=this.documentHelper.pages[p]).bodyWidgets.length&&n.equals(s.bodyWidgets[0])?(a=s.bodyWidgets[0],this.viewer.updateClientArea(a,a.page)):(s=void 0,c=!0)),sf.base.isNullOrUndefined(s)&&(a=this.createSplitBody(n),this.documentHelper.owner.editorHistory&&this.documentHelper.owner.editorHistory.isRedoing&&this.documentHelper.owner.editorHistory.currentBaseHistoryInfo&&"SectionBreakContinuous"===this.documentHelper.owner.editorHistory.currentBaseHistoryInfo.action&&"NoBreak"===e.bodyWidget.sectionFormat.breakCode||r||(s=this.viewer.createNewPage(a,p),this.viewer.updateClientArea(a,a.page),a.y=this.viewer.clientActiveArea.y),c&&this.documentHelper.insertPage(p,s),this.clearLineMeasures())}for(;;){var u=void 0;if(u=n.lastChild instanceof ae?n.lastChild.previousWidget:n.lastChild,t){var g=this.getFootNoteWidgetsOf(u);this.moveFootNotesToPage(g,n,a)}if(e===u)break;if(n.childWidgets.splice(n.childWidgets.indexOf(u),1),a.childWidgets.splice(0,0,u),u instanceof de&&-1!==n.floatingElements.indexOf(u)&&n.floatingElements.splice(n.floatingElements.indexOf(u),1),u instanceof le&&u.floatingElements.length>0)for(var f=0;f<u.floatingElements.length;f++)-1!==n.floatingElements.indexOf(u.floatingElements[f])&&"Inline"!==u.floatingElements[f].textWrappingStyle&&(n.floatingElements.splice(n.floatingElements.indexOf(u.floatingElements[f]),1),a.floatingElements.push(u.floatingElements[f]));u.containerWidget=a,a.height+=u.height}return a},t.prototype.createSplitBody=function(e){var t=this.addBodyWidget(this.viewer.clientActiveArea);return this.isInitialLoad||"NoBreak"!==e.sectionFormat.breakCode?t.sectionFormat=e.sectionFormat:(t.sectionFormat=new d(t),this.viewer.owner.parser.parseSectionFormat(e.sectionFormat,t.sectionFormat)),t.index=e.index,t},t.prototype.createOrGetNextColumnBody=function(e){var t=e.page.bodyWidgets[e.page.bodyWidgets.indexOf(e)+1];return sf.base.isNullOrUndefined(t)&&((t=new ne).sectionFormat=e.sectionFormat,t.index=e.index,t.page=e.page,e.page.bodyWidgets.push(t)),t},t.prototype.moveToNextColumnByBodyWidget=function(e,t){var i=e.containerWidget;return this.createOrGetNextColumnBody(i)},t.prototype.reLayoutLine=function(e,t,i,r){var n;this.isFootnoteContentChanged=!1,this.viewer.owner.isDocumentLoaded&&this.viewer.owner.editorModule&&this.viewer.owner.editorModule.updateWholeListItems(e);var o=(n=e.paragraphFormat.listFormat&&-1!==e.paragraphFormat.listFormat.listId?e.getSplitWidgets()[0].firstChild:e.childWidgets[t]).previousLine;sf.base.isNullOrUndefined(o)&&(o=n),this.allowLayout&&(o.paragraph.splitTextRangeByScriptType(o.indexInOwner),o.paragraph.splitLtrAndRtlText(o.indexInOwner),o.paragraph.combineconsecutiveRTL(o.indexInOwner));var s=e.containerWidget;if(s.height-=e.height,!this.viewer.owner.enableHeaderAndFooter&&!e.isInHeaderFooter||s instanceof ze?s instanceof ze?this.viewer.updateClientAreaForTextBoxShape(s.containerShape,!0):this.viewer.updateClientArea(s,s.page,!0):(e.bodyWidget.isEmpty=!1,this.viewer.updateHeaderFooterClientAreaWithTop(e.bodyWidget.sectionFormat,this.documentHelper.isBlockInHeader(e),s.page)),this.viewer.updateClientAreaForBlock(e,!0),!sf.base.isNullOrUndefined(e.containerWidget)&&!sf.base.isNullOrUndefined(e.containerWidget.containerWidget)&&e.containerWidget.containerWidget instanceof ae){var a=e.bodyWidget.containerWidget.y;return this.viewer.cutFromTop(a),this.documentHelper.owner.editor.isFootNoteInsert=!0,void this.layoutfootNote(e.containerWidget.containerWidget)}if(o.paragraph.isEmpty())this.viewer.cutFromTop(e.y),this.layoutParagraph(e,0);else{if(this.updateClientAreaForLine(o),this.layoutListItems(o.paragraph),o.isFirstLine()&&!sf.base.isNullOrUndefined(e.paragraphFormat)){var l=-x.convertPointToPixel(e.paragraphFormat.firstLineIndent);this.viewer.updateClientWidth(l)}do{e=(o=this.layoutLine(o,0)).paragraph,o=o.nextLine}while(o);this.updateWidgetToPage(this.viewer,e),this.viewer.updateClientAreaForBlock(e,!1)}this.layoutNextItemsBlock(e,this.viewer);var h=e.getSplitWidgets()[0].previousRenderedWidget;if(!(sf.base.isNullOrUndefined(h)||e.isEndsWithPageBreak||e.isEndsWithColumnBreak||h instanceof le&&(!(h instanceof le)||h.isEndsWithPageBreak||h.isEndsWithColumnBreak)||(this.viewer.cutFromTop(e.y+e.height),e.containerWidget===h.containerWidget||sf.base.isNullOrUndefined(h.containerWidget)))){var d=e.containerWidget,c=h.containerWidget,p=this.getFootNoteWidgetsOf(e);sf.base.isNullOrUndefined(c.page.footnoteWidget)||this.moveFootNotesToPage(p,c,d)}var u,g=this.documentHelper.pages.length,f=this.documentHelper.pages[g-1].bodyWidgets[0];if(this.isFootnoteContentChanged&&!sf.base.isNullOrUndefined(e.bodyWidget.page.footnoteWidget)&&(u=e.bodyWidget.page.footnoteWidget,this.layoutfootNote(u)),this.isEndnoteContentChanged&&!sf.base.isNullOrUndefined(f.page.endnoteWidget)){u=f.page.endnoteWidget;var m=this.viewer.clientArea.clone(),y=this.viewer.clientActiveArea.clone();this.viewer.cutFromTop(f.childWidgets[f.childWidgets.length-1].y+f.childWidgets[f.childWidgets.length-1].height),this.layoutfootNote(u),this.viewer.clientArea=m,this.viewer.clientActiveArea=y}},t.prototype.isContainsRtl=function(e){if(this.viewer.documentHelper.isSelectionChangedOnMouseMoved&&!this.isDocumentContainsRtl)return!1;for(var t=!1,i=0;i<e.children.length;i++)if(e.children[i]instanceof we&&(t=e.children[i].characterFormat.bidi||"RTL"===e.children[i].characterFormat.bdo||this.documentHelper.textHelper.isRTLText(e.children[i].text))){this.isDocumentContainsRtl||(this.isDocumentContainsRtl=t);break}return t},t.prototype.shiftElementsForRTLLayouting=function(t,i){var r=this.hasTextRangeBidi(t);if(this.isContainsRTLText(t)||i||r){for(var n=[],o=[],s=0;s<t.children.length;s++){var a=t.children[s];if(a instanceof we&&a.height>0&&!a.isPageBreak){var l=a;o.push(l.characterFormat.bidi),"\t"==l.text?n.push(e.Tab):n.push(l.characterRange),a.isRightToLeft=n[n.length-1]==e.RightToLeft}else if(a instanceof nt||a instanceof Ce||a instanceof He||a instanceof Ue||a instanceof Oe||a instanceof fe){var h=this.isStartMarker(a),d=this.isEndMarker(a);if(h&&s<t.children.length-1){var c=this.getNextValidWidget(s+1,t);if(!sf.base.isNullOrUndefined(c)&&c instanceof we&&c.height>0){l=c;o.push(l.characterFormat.bidi),"\t"===c.text?n.push(e.Tab):n.push(l.characterRange)}else o.push(!1),n.push(e.LeftToRight)}else!d&&s>0?(o.push(o[o.length-1]),n.push(n[n.length-1])):(o.push(!1),n.push(e.LeftToRight))}else a instanceof je&&i?(o.push(i),n.push(e.RightToLeft)):(o.push(!1),n.push(e.LeftToRight))}var p=-1,u=void 0;for(s=0;s<n.length;s++)if(s+1<o.length&&o[s]!=o[s+1])-1!=p&&(this.updateCharacterRange(t,s,p,o,n),p=-1),u=null;else{if(s>0&&s!=n.length-1&&n[s]==e.WordSplit&&o[s]&&n[s-1]==e.Number&&o[s-1]&&n[s+1]==e.Number&&o[s+1]&&this.isNumberNonReversingCharacter(t.children[s]))n[s]=e.Number;else if(n[s]==e.RightToLeft||n[s]==e.LeftToRight||n[s]==e.Number&&-1!=p||(sf.base.isNullOrUndefined(u)||!u)&&o[s])if(-1==p&&n[s]!=e.LeftToRight)p=s;else{if(-1==p){n[s]==e.LeftToRight?u=!0:n[s]==e.RightToLeft&&(u=!1);continue}n[s]==e.LeftToRight&&(this.updateCharacterRange(t,s,p,o,n),p=n[s]==e.RightToLeft||n[s]==e.Number&&-1!=p?s:-1)}n[s]==e.LeftToRight?u=!0:n[s]==e.RightToLeft&&(u=!1)}if(-1!=p&&p<n.length-1&&(this.updateCharacterRange(t,n.length-1,p,o,n),p=-1),n.length!=t.children.length)throw new Error("Splitted Widget count mismatch while reordering layouted child widgets of a line");var g=this.reorderElements(t,n,o,i);o.length=0,n.length=0,t.children.length>0&&(t.layoutedElements=g)}return i},t.prototype.isNumberNonReversingCharacter=function(e){if(e instanceof we){var t=e;if(!t.characterFormat.hasValueWithParent("localeIdBidi"))return z.isNumberNonReversingCharacter(t.text,t.characterFormat.bidi);var i=t.text.charCodeAt(0);if(47==i&&!this.isNumberReverseLangForSlash(t.characterFormat.localeIdBidi)||(35==i||36==i||37==i||43==i||45==i)&&!this.isNumberReverseLangForOthers(t.characterFormat.localeIdBidi)||44==i||46==i||58==i||1548==i)return!0}return!1},t.prototype.isNumberReverseLangForSlash=function(e){return this.isNumberReverseLangForOthers(e)||6145==e||1164==e||1125==e||1120==e||1123==e||1065==e||2137==e||1114==e||1119==e||1152==e||1056==e},t.prototype.isNumberReverseLangForOthers=function(e){return 14337==e||15361==e||5121==e||3073==e||2049==e||11265==e||13313==e||12289==e||4097==e||8193==e||16385==e||1025==e||10241==e||7169==e||9217==e},t.prototype.isStartMarker=function(e){return e instanceof nt?0===e.commentType:e instanceof Ce?0===e.bookmarkType:e instanceof He||(e instanceof Oe?0===e.type:e instanceof fe&&0===e.fieldType)},t.prototype.isEndMarker=function(e){return e instanceof nt?1===e.commentType:e instanceof Ce?1===e.bookmarkType:e instanceof He||(e instanceof Oe?1===e.type:e instanceof fe&&1===e.fieldType)},t.prototype.getNextValidWidget=function(e,t){for(var i=e;i<t.children.length;i++){var r=t.children[i];if(!(r instanceof nt||r instanceof Ce||r instanceof He||r instanceof Ue||r instanceof Oe||r instanceof fe))return r[i]}return null},t.prototype.hasTextRangeBidi=function(e){for(var t=0;t<e.children.length;t++){var i=e.children[t];if(i instanceof we)if(i.characterFormat.bidi)return!0}return!1},t.prototype.isContainsRTLText=function(e){for(var t=e.paragraph.bodyWidget.page.documentHelper.textHelper,i=!1,r=0;r<e.children.length&&!(e.children[r]instanceof we&&(i=e.children[r].characterFormat.bidi||1==e.children[r].characterFormat.bidi||t.isRTLText(e.children[r].text)));r++);return i},t.prototype.updateCharacterRange=function(t,i,r,n,o){var s=i;if(!n[i]){o[i]===e.LeftToRight&&s--;for(var a=s;a>=r;a--)if(o[a]!=e.WordSplit){s=a;break}}for(a=r;a<=s;a++)if(o[a]==e.WordSplit){o[a]=e.RightToLeft|e.WordSplit;var l=a-1,h=a+1;if(l>=0&&h<o.length&&o[l]==e.RightToLeft&&(o[h]==e.RightToLeft||o[h]==e.Number)&&t.children[a]instanceof we){var d=t.children[a];if("Times New Roman"==d.characterFormat.fontFamilyBidi){var c=d.text.split("").reverse().join("");d.text=c}}}},t.prototype.reorderElements=function(t,i,r,n){for(var o=0,s=-1,a=0,l=0,h=[],d=e.LeftToRight,c=!1,p=0;p<t.children.length;p++){var u=t.children[p],g=u;g.characterRange=i[p];var f=(g.characterRange&e.RightToLeft)==e.RightToLeft||g.characterRange==e.Number,m=r[p];if(i[p]==e.Tab){if(n){o=0,s=-1,a=0,d=e.LeftToRight,c=!1,h.splice(o,0,u);continue}m&&(m=!1)}p>0&&c!=m&&(n?(o=0,s=-1,a=0):s=h.length-1,l=0),m||f?f||m&&g.characterRange==e.WordSplit&&(d==e.RightToLeft||this.isInsertWordSplitToLeft(i,r,p))?(a++,o=s+1,g.characterRange==e.Number&&(d==e.Number&&(o+=l),l++),h.splice(o,0,u)):(h.splice(o,0,u),o++,a=0):(n?(a>0&&c==m&&(o+=a),h.splice(o,0,u),o++):(h.push(u),o=p+1),a=0,s=n?o-1:h.length-1),g.characterRange!=e.Number&&(l=0),g.characterRange!=e.WordSplit&&(d=g.characterRange),c=m}return h},t.prototype.isInsertWordSplitToLeft=function(t,i,r){for(var n=r+1;n<t.length;n++){if((t[n]&e.RightToLeft)==e.RightToLeft)return!0;if(t[n]==e.LeftToRight)return!i[n]}return!0},t.prototype.shiftLayoutFloatingItems=function(e){for(var t=0;t<e.floatingElements.length;t++){var i=e.floatingElements[t],r=this.getFloatingItemPoints(i),n=r.y-i.y;if(i.x=r.x,i.y=r.y,i instanceof Ee)for(var o=0;o<i.textFrame.childWidgets.length;o++){var s=i.textFrame.childWidgets[o];s instanceof le?s.y=s.y+n:s instanceof de&&this.shiftChildLocationForTableWidget(s,n)}}},t.prototype.getFloatingItemPoints=function(e){var t=e.line.paragraph,i=t.bodyWidget.sectionFormat,r=0,n=0;if(t){var o=x.convertPointToPixel(i.leftMargin),s=x.convertPointToPixel(i.rightMargin),a=x.convertPointToPixel(i.topMargin),l=i.bottomMargin>0?x.convertPointToPixel(i.bottomMargin):48,h=x.convertPointToPixel(i.headerDistance),d=x.convertPointToPixel(i.footerDistance),c=x.convertPointToPixel(i.pageWidth),p=x.convertPointToPixel(i.pageHeight),u=c-(o+s),g=p-a-l;a=t.isInHeaderFooter&&i.topMargin<=0?Math.abs(a)>0?Math.abs(a):x.convertPointToPixel(i.headerDistance)+t.height:a>0?a:48,!t.isInHeaderFooter&&a<this.viewer.clientArea.y&&(a=this.viewer.clientArea.y);var f="InFrontOfText",m=!1,y=e.verticalOrigin,v=e.horizontalOrigin,b=e.horizontalAlignment,w=e.verticalAlignment,N=e.verticalRelativePercent,I=(e.horizontalRelativePercent,e.height),S=e.width,C=e.verticalPosition,O=e.horizontalPosition,T=e.layoutInCell,P=void 0;if(e instanceof Ee&&(P=e.autoShapeType),t.isInsideTable&&T)m=!0,n=this.getVerticalPosition(e,C,y,f),r=this.getHorizontalPosition(e.width,e,b,v,O,f,t.associatedCell.cellFormat.cellWidth);else if(this.documentHelper.viewer instanceof Z){switch(y){case"Line":n=this.documentHelper.selection.getTop(e.line);break;default:n=this.viewer.clientActiveArea.y}switch(v){case"Character":r=this.viewer.clientActiveArea.x;break;default:switch(b){case"Center":r=this.viewer.clientArea.width/2-e.width/2;break;default:r=this.viewer.clientArea.x}}}else{switch(y){case"Page":case"TopMargin":switch(n=C,w){case"Top":n=C;break;case"Center":n="TopMargin"===y?(a-I)/2:(p-I)/2;break;case"Outside":case"Bottom":n="Page"===y&&"Bottom"===w?p-I:"TopMargin"===y?a-I:(t.bodyWidget.page.index+1)%2!=0?p-I-d/2:h/2;break;case"Inside":"Page"===y?n=(t.bodyWidget.page.index+1)%2==0?p-I-d/2:h/2:(t.bodyWidget.page.index+1)%2==0&&(n=(a-I)/2-h);break;case"None":n=Math.abs(N)<=1e3?p*(N/100):C}break;case"Line":switch(n=C,w){case"Inside":case"Top":n=this.viewer.clientActiveArea.y;break;case"Center":n=this.viewer.clientActiveArea.y-I/2;break;case"Outside":case"Bottom":n=this.viewer.clientActiveArea.y-I;break;case"None":n=Math.round(t.y)+C}break;case"BottomMargin":switch(n=C,w){case"Inside":case"Top":n=p-l;break;case"Center":n=p-l+(l-I)/2;break;case"Outside":case"Bottom":n=t.bodyWidget.page.index+1!==0&&"Outside"===w?p-l:p-I;break;case"None":n=p-l+C}break;case"InsideMargin":case"OutsideMargin":switch(n=C,w){case"Inside":n="InsideMargin"===y?"InsideMargin"===y&&t.bodyWidget.page.index+1===0?p-I:0:(t.bodyWidget.page.index+1)%2!=0?p-l:a-I;break;case"Top":n="InsideMargin"===y?(t.bodyWidget.page.index+1)%2==0?p-l:0:(t.bodyWidget.page.index+1)%2!=0?p-l:0;break;case"Center":n="OutsideMargin"===y?(t.bodyWidget.page.index+1)%2!=0?p-l+(l-I)/2:(a-I)/2:(t.bodyWidget.page.index+1)%2==0?p-l+(l-I)/2:(a-I)/2;break;case"Outside":n="InsideMargin"===y?(t.bodyWidget.page.index+1)%2==0?p-l:a-I:(t.bodyWidget.page.index+1)%2!=0?a-I:p-l;break;case"Bottom":n="OutsideMargin"===y?t.bodyWidget.page.index+1!==0?p-I:a-I:(t.bodyWidget.page.index+1)%2==0?p-I:a-I}break;case"Paragraph":n=Math.round(t.y)+0+C;break;case"Margin":switch(n=t.isInHeaderFooter&&h>a?h+t.height+C:a+C,w){case"Top":n=a;break;case"Center":n=a+(g-I)/2;break;case"Outside":case"Bottom":n=(t.bodyWidget.page.index+1)%2!=0?a+g-I:a;break;case"Inside":n=(t.bodyWidget.page.index+1)%2==0?a+g-I:a}break;default:n=this.viewer.clientArea.y-C}switch(v){case"Page":switch(r=O,b){case"Center":r=m?(t.associatedCell.cellFormat.cellWidth-S)/2:(c-S)/2;break;case"Left":r=0;break;case"Outside":case"Right":r=m?t.associatedCell.cellFormat.cellWidth-S:c-S;break;case"None":r=m?t.associatedCell.x+O:O}r<0&&m&&(r=t.associatedCell.x);break;case"Column":var A=!1;if(this.viewer.clientActiveArea.x<t.x?r=t.x+O:!e.paragraph.isInsideTable&&("StraightConnector"===P||"Rectangle"===P||e instanceof Re)?(A=!0,r=O+t.bodyWidget.x):r=t.x+O,t.paragraphFormat.leftIndent&&!A)r-=x.convertPointToPixel(t.leftIndent);switch(b){case"Center":r=this.viewer.clientActiveArea.x+(this.viewer.clientActiveArea.width-S)/2;break;case"Left":r=this.viewer.clientActiveArea.x;break;case"Right":r=this.viewer.clientActiveArea.x+this.viewer.clientActiveArea.width-S}break;case"Margin":if(t.bodyWidget)switch(r=o+O,b){case"Center":r=o+(u-S)/2;break;case"Left":r=o;break;case"Outside":(t.bodyWidget.page.index+1)%2!=0&&(r=o+u-S);break;case"Right":r=o+u-S;break;case"Inside":(t.bodyWidget.page.index+1)%2==0&&(r=o+u-S)}else r=this.viewer.clientArea.x+O;break;case"Character":r="Right"===b||"Center"===b?this.getLeftMarginHorizPosition(o,b,O,S,f):this.viewer.clientArea.x+O;break;case"LeftMargin":r=this.getLeftMarginHorizPosition(o,b,O,S,f);break;case"RightMargin":r=this.getRightMarginHorizPosition(c,s,b,O,S,f);break;case"InsideMargin":r=(t.bodyWidget.page.index+1)%2==0?this.getRightMarginHorizPosition(c,s,b,O,S,f):this.getLeftMarginHorizPosition(o,b,O,S,f);break;case"OutsideMargin":r=(t.bodyWidget.page.index+1)%2==0?this.getLeftMarginHorizPosition(o,b,O,S,f):this.getRightMarginHorizPosition(c,s,b,O,S,f);break;default:r=this.viewer.clientArea.x+O}0}!t||"Paragraph"!==y&&"Line"!==y||"InFrontOfText"===e.textWrappingStyle||"Behind"===e.textWrappingStyle||"Word2013"===this.documentHelper.compatibilityMode&&(t.isInHeaderFooter||(n+e.height>this.viewer.clientArea.bottom&&(n=this.viewer.clientArea.bottom-e.height),n<i.topMargin&&(n=i.topMargin)))}return new M(r,n)},t.prototype.getLeftMarginHorizPosition=function(e,t,i,r,n){var o=i;switch(t){case"Center":o=(e-r)/2;break;case"Left":o=0;break;case"Right":o=e-r}return o<0&&"InFrontOfText"!==n&&"Behind"!==n&&(o=0),o},t.prototype.getRightMarginHorizPosition=function(e,t,i,r,n,o){var s=e-t,a=s+r;switch(i){case"Center":a=s+(t-n)/2;break;case"Left":a=s;break;case"Right":a=e-n}return(a<0||a+n>e)&&"InFrontOfText"!==o&&"Behind"!==o&&(a=e-n),a},t.prototype.getVerticalPosition=function(e,t,i,r){var n=e.line.paragraph,o=0,s=n.associatedCell.y;switch(i){case"Page":case"Margin":case"TopMargin":case"InsideMargin":case"BottomMargin":case"OutsideMargin":o=s+t;break;case"Line":case"Paragraph":o=n.y+t+0;break;default:o=this.viewer.clientActiveArea.y+t}return o},t.prototype.getHorizontalPosition=function(e,t,i,r,n,o,s){var a=0,l=t.line.paragraph.associatedCell,h=s-l.leftMargin-l.rightMargin,d=l.cellFormat.cellWidth,c=l.x,p=c-l.leftMargin;switch(r){case"Page":switch(a=n,i){case"Center":a=p+(h-e)/2;break;case"Left":a=p;break;case"Right":a=p+(h-e);break;case"None":a=p+n}break;case"Column":case"Margin":switch(i){case"Center":a=c+(d-e)/2;break;case"Left":a=c;break;case"Right":a=c+(d-e);break;case"None":a=c+n}break;default:a=c+n}return a},t.prototype.updateTableFloatPoints=function(e){if(e.wrapTextAround){var t=e.getTableCellWidth(),i=e.positioning,r=e.bodyWidget.sectionFormat;if(this.documentHelper.viewer instanceof Z)"Margin"!==i.horizontalOrigin&&"Page"!==i.horizontalOrigin&&"Column"!==i.horizontalOrigin||("Right"===i.horizontalAlignment||"Outside"===i.horizontalAlignment?this.viewer.clientActiveArea.x=this.viewer.clientArea.width-t:this.viewer.clientActiveArea.x=this.viewer.clientArea.x);else if(e.containerWidget instanceof ze||e.isInsideTable){if(e.isInsideTable){var n=e.containerWidget,o=n.cellFormat;"Page"===i.verticalOrigin?(this.viewer.clientActiveArea.y=n.y,this.viewer.clientActiveArea.y+=x.convertPointToPixel(i.verticalPosition)):"Margin"===i.verticalOrigin?(this.viewer.clientActiveArea.y+=x.convertPointToPixel(i.verticalPosition),(this.viewer.clientActiveArea.y<n.y||"Top"===i.verticalAlignment)&&(this.viewer.clientActiveArea.y=n.y)):this.viewer.clientActiveArea.y+x.convertPointToPixel(i.verticalPosition)<n.y?this.viewer.clientActiveArea.y=n.y:this.viewer.clientActiveArea.y+=x.convertPointToPixel(i.verticalPosition),"Page"===i.horizontalOrigin?"Left"===i.horizontalAlignment||"Inside"===i.horizontalAlignment?this.viewer.clientActiveArea.x=n.x:"Right"!==i.horizontalAlignment&&"Outside"!==i.horizontalAlignment||(this.viewer.clientActiveArea.x=n.x+o.preferredWidth-t):"Margin"!==i.horizontalOrigin&&"Column"!==i.horizontalOrigin||("Left"===i.horizontalAlignment||"Inside"===i.horizontalAlignment?this.viewer.clientActiveArea.x=n.x+n.leftMargin:"Right"!==i.horizontalAlignment&&"Outside"!==i.horizontalAlignment||(this.viewer.clientActiveArea.x=n.x+o.preferredWidth-(t+n.rightMargin))),Math.round(i.horizontalPosition)>0&&(this.viewer.clientActiveArea.x=n.x,"Margin"===i.horizontalOrigin&&(this.viewer.clientActiveArea.x+=n.leftMargin),this.viewer.clientActiveArea.x+=x.convertPointToPixel(i.horizontalPosition)),"Center"===i.horizontalAlignment&&(this.viewer.clientActiveArea.x=o.preferredWidth/2-t/2)}}else"Page"===i.verticalOrigin?"Top"===i.verticalAlignment||"Inside"===i.verticalAlignment?this.viewer.clientActiveArea.y=0:(sf.base.isNullOrUndefined(i.verticalAlignment)||"None"===i.verticalAlignment)&&(this.viewer.clientActiveArea.y=x.convertPointToPixel(i.verticalPosition)):"Margin"===i.verticalOrigin?"Top"===i.verticalAlignment||"Inside"===i.verticalAlignment?this.viewer.clientActiveArea.y=x.convertPointToPixel(r.topMargin):0==Math.round(i.verticalPosition)||sf.base.isNullOrUndefined(r.topMargin)?this.viewer.clientActiveArea.y=x.convertPointToPixel(i.verticalPosition):this.viewer.clientActiveArea.y=x.convertPointToPixel(r.topMargin+i.verticalPosition):"Paragraph"===i.verticalOrigin&&(sf.base.isNullOrUndefined(i.verticalAlignment)||"None"===i.verticalAlignment)&&(this.viewer.clientActiveArea.y+=x.convertPointToPixel(i.verticalPosition)),"Page"===i.horizontalOrigin?"Left"===i.horizontalAlignment||"Inside"===i.horizontalAlignment?this.viewer.clientActiveArea.x=0:"Right"===i.horizontalAlignment||"Outside"===i.horizontalAlignment?this.viewer.clientActiveArea.x=x.convertPointToPixel(r.pageWidth)-t:"Center"===i.horizontalAlignment&&(this.viewer.clientActiveArea.x=(x.convertPointToPixel(r.pageWidth)-t)/2):"Margin"!==i.horizontalOrigin&&"Column"!==i.horizontalOrigin||("Left"===i.horizontalAlignment?(this.viewer.clientActiveArea.x=x.convertPointToPixel(r.leftMargin),"Word2013"===this.documentHelper.compatibilityMode||e.isInsideTable||(this.viewer.clientActiveArea.x=this.viewer.clientActiveArea.x-x.convertPointToPixel(e.firstChild.firstChild.leftMargin))):"Inside"===i.horizontalAlignment?this.viewer.clientActiveArea.x=x.convertPointToPixel(r.leftMargin):"Right"===i.horizontalAlignment||"Outside"===i.horizontalAlignment?this.viewer.clientActiveArea.x=x.convertPointToPixel(r.pageWidth)-(x.convertPointToPixel(r.rightMargin)+t):"Center"===i.horizontalAlignment&&(this.viewer.clientActiveArea.x=x.convertPointToPixel(r.leftMargin)+(x.convertPointToPixel(r.pageWidth-r.rightMargin-r.leftMargin)-t)/2)),Math.round(i.horizontalPosition)>0&&(this.viewer.clientActiveArea.x+=x.convertPointToPixel(i.horizontalPosition))}e.x=this.viewer.clientActiveArea.x,e.y=this.viewer.clientActiveArea.y},t.prototype.isTocField=function(e){if(e instanceof fe){var t=e.nextNode;if(e instanceof fe&&0===e.fieldType&&t instanceof we&&-1!==t.text.trim().toLowerCase().indexOf("toc"))return!0}return!1},t.prototype.getTotalColumnSpan=function(e){for(var t=e,i=0,r=0;r<t.childWidgets.length;r++)i+=t.childWidgets[r].cellFormat.columnSpan;return i},t.prototype.getMaximumRightCellBorderWidth=function(e){for(var t=0,i=0;i<e.childWidgets.length;i++){var r=e.childWidgets[i],n=r.childWidgets[r.childWidgets.length-1].cellFormat.borders.right.lineWidth;t<n&&(t=n)}return t},t.prototype.getDefaultBorderSpacingValue=function(e,t,i){return 0==e?(e="Word2013"!=this.documentHelper.compatibilityMode&&"Center"==i?1.5:.75,!0):t},t.prototype.getMinimumWidthRequiredForTable=function(e,t,i){var r=0;return r="Word2013"==this.documentHelper.compatibilityMode?"Center"==t?e?18.5+Math.round(.375):18.5+Math.round(i/2):e?19.25:18.5+i:"Center"==t?e?19.25:18.5+i/2:.25==i?18.5:19.3,x.convertPointToPixel(r)},t.prototype.shiftFloatingItemsFromTable=function(e,t){if(e.containerWidget instanceof ne)for(var i=0;i<e.containerWidget.floatingElements.length;i++){var r=e.containerWidget.floatingElements[i];!(r instanceof de)&&r.paragraph.containerWidget instanceof pe&&r.paragraph.containerWidget.ownerTable.containerWidget.ownerTable==e&&(t.floatingElements.push(e.containerWidget.floatingElements[i]),e.containerWidget.floatingElements.splice(e.containerWidget.floatingElements.indexOf(e.containerWidget.floatingElements[i]),1),this.shiftedFloatingItemsFromTable.push(r),i--)}},t}(),F=function(){function e(){this.style={},this.context=new D}return e.prototype.getContext=function(e,t){return this.context},e.prototype.toDataURL=function(e,t){return this.context.renderedPath},e}(),D=function(){function e(){this.renderedPath=""}return Object.defineProperty(e.prototype,"globalAlpha",{set:function(e){this.renderedPath+="GA:"+e+";"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"globalCompositeOperation",{set:function(e){this.renderedPath+="GCP:"+e+";"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fillStyle",{set:function(e){this.renderedPath+="FS:"+e+";"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"strokeStyle",{set:function(e){this.renderedPath+="SS:"+e+";"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"direction",{set:function(e){this.renderedPath+="Dir:"+e+";"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"font",{set:function(e){this.renderedPath+="Fn:"+e+";"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"textAlign",{set:function(e){this.renderedPath+="TA:"+e+";"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"textBaseline",{set:function(e){this.renderedPath+="TBL:"+e+";"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lineWidth",{set:function(e){this.renderedPath+="LW:"+e+";"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lineCap",{set:function(e){this.renderedPath+="LC:"+e+";"},enumerable:!0,configurable:!0}),e.prototype.drawImage=function(e,t,i,r,n,o,s,a,l){this.renderedPath+="LC:"+e.src+";",this.renderedPath+="sx:"+t+";",this.renderedPath+="sy:"+i+";",this.renderedPath+="sw:"+r+";",this.renderedPath+="sh:"+n+";",o&&(this.renderedPath+="dx:"+o+";"),s&&(this.renderedPath+="dy:"+s+";"),a&&(this.renderedPath+="dw:"+a+";"),l&&(this.renderedPath+="dh:"+l+";")},e.prototype.beginPath=function(){this.renderedPath+="BP;"},e.prototype.clip=function(e){this.renderedPath+="Cl;"},e.prototype.fill=function(e){this.renderedPath+="Fl;"},e.prototype.stroke=function(){this.renderedPath+="Stk;"},e.prototype.closePath=function(){this.renderedPath+="CP;"},e.prototype.lineTo=function(e,t){this.renderedPath+="LT:x:"+e+";y:"+t+";"},e.prototype.moveTo=function(e,t){this.renderedPath+="MT:x:"+e+";y:"+t+";"},e.prototype.rect=function(e,t,i,r){this.renderedPath+="Rt:x:"+e+";y:"+t+";w:"+i+";h:"+r+";"},e.prototype.setLineDash=function(e){this.renderedPath+="Sgm:"+e.toString()+";"},e.prototype.clearRect=function(e,t,i,r){this.renderedPath+="CR:x:"+e+";y:"+t+";w:"+i+";h:"+r+";"},e.prototype.fillRect=function(e,t,i,r){this.renderedPath+="FR:x:"+e+";y:"+t+";w:"+i+";h:"+r+";"},e.prototype.strokeRect=function(e,t,i,r){this.renderedPath+="SR:x:"+e+";y:"+t+";w:"+i+";h:"+r+";"},e.prototype.restore=function(){this.renderedPath+="RES;"},e.prototype.save=function(){this.renderedPath+="S;"},e.prototype.fillText=function(e,t,i,r){this.renderedPath+="FT:"+e+";x:"+t+";y:"+i+";",r&&(this.renderedPath+="MW:"+r+";")},e.prototype.measureText=function(e){return{width:30}},e.prototype.strokeText=function(e,t,i,r){this.renderedPath+="ST:"+e+";x:"+t+";y:"+i+";",r&&(this.renderedPath+="MW:"+r+";")},e.prototype.scale=function(e,t){this.renderedPath+="SC:x:"+e+";y:"+t+";"},e}(),E=function(){function i(e){this.isPrinting=!1,this.isExporting=!1,this.pageLeft=0,this.pageTop=0,this.pageIndex=-1,this.isFieldCode=!1,this.leftPosition=0,this.topPosition=0,this.height=0,this.documentHelper=e}return Object.defineProperty(i.prototype,"pageCanvas",{get:function(){return this.isPrinting?(sf.base.isNullOrUndefined(this.pageCanvasIn)&&(this.pageCanvasIn=document.createElement("canvas"),this.pageCanvasIn.getContext("2d").save()),this.pageCanvasIn):this.isExporting?(sf.base.isNullOrUndefined(this.exportPageCanvas)&&(this.exportPageCanvas=new F),this.exportPageCanvas):sf.base.isNullOrUndefined(this.viewer)?void 0:this.documentHelper.containerCanvas},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"spellChecker",{get:function(){return this.documentHelper.owner.spellChecker},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"selectionCanvas",{get:function(){return sf.base.isNullOrUndefined(this.viewer)?void 0:this.documentHelper.selectionCanvas},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"pageContext",{get:function(){return this.pageCanvas.getContext("2d")},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"selectionContext",{get:function(){return this.selectionCanvas.getContext("2d")},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"viewer",{get:function(){return this.documentHelper.owner.viewer},enumerable:!0,configurable:!0}),i.prototype.renderWidgets=function(e,t,i,r,n){if(!sf.base.isNullOrUndefined(this.pageCanvas)&&!sf.base.isNullOrUndefined(e)){if(this.pageContext.fillStyle=x.getColor(this.documentHelper.backgroundColor),this.pageContext.beginPath(),this.viewer instanceof Z){n=n>this.documentHelper.visibleBounds.height?n:this.documentHelper.visibleBounds.height;var o=i;0===e.index&&(o=i-this.viewer.padding.top),this.pageContext.fillRect(t-this.viewer.padding.left,o,r+this.viewer.padding.left,n+this.viewer.padding.top)}else this.pageContext.fillRect(t,i,r,n);this.pageContext.closePath(),this.viewer instanceof X&&(this.pageContext.strokeStyle=this.documentHelper.owner.pageOutline,this.pageContext.strokeRect(t,i,r,n)),this.pageLeft=t,this.pageTop=i,this.pageIndex=e.index,this.isPrinting?this.setPageSize(e):(this.pageContext.beginPath(),this.pageContext.save(),this.pageContext.rect(t,i,r,n),this.pageContext.clip()),this.height=n,e.headerWidget&&this.renderHFWidgets(e,e.headerWidgetIn,r,!0),e.footerWidget&&this.renderHFWidgets(e,e.footerWidgetIn,r,!1);for(var s=0;s<e.bodyWidgets.length;s++)this.render(e,e.bodyWidgets[parseInt(s.toString(),10)]),e.footnoteWidget&&"Pages"===this.documentHelper.owner.layoutType&&this.renderfootNoteWidget(e,e.footnoteWidget,r);e.endnoteWidget&&"Pages"===this.documentHelper.owner.layoutType&&this.renderfootNoteWidget(e,e.endnoteWidget,r),this.documentHelper.owner.enableHeaderAndFooter&&!this.isPrinting&&this.renderHeaderSeparator(e,this.pageLeft,this.pageTop,e.headerWidgetIn),this.pageLeft=0,this.pageTop=0,this.pageContext.restore()}},i.prototype.setPageSize=function(e){this.pageContext.clearRect(0,0,this.pageCanvas.width,this.pageCanvas.height),this.selectionContext.clearRect(0,0,this.selectionCanvas.width,this.selectionCanvas.height),this.pageContext.restore(),this.selectionContext.restore();var t=e.boundingRectangle.width,i=e.boundingRectangle.height,r=Math.max(window.devicePixelRatio,this.documentHelper.owner.documentEditorSettings.printDevicePixelRatio);this.pageCanvas.width===t*r&&this.pageCanvas.height===i*r||(this.pageCanvas.height=i*r,this.pageCanvas.width=t*r,this.pageCanvas.style.height=i+"px",this.pageCanvas.style.width=t+"px",this.pageContext.globalAlpha=1,this.pageContext.scale(r,r)),this.pageContext.fillStyle="#FFFFFF",this.pageContext.fillRect(0,0,this.pageCanvas.width,this.pageCanvas.height),this.pageContext.fillStyle="#000000"},i.prototype.renderHFWidgets=function(e,t,i,r){this.isPrinting||(this.pageContext.globalAlpha=this.documentHelper.owner.enableHeaderAndFooter?1:.65);var n=!1,o=0,s=0,a=e.boundingRectangle.height/100*40;if(r){var l=x.convertPointToPixel(e.bodyWidgets[0].sectionFormat.topMargin);Math.max(t.y+t.height,l)>a&&(n=!0,this.pageContext.beginPath(),this.pageContext.save(),this.pageContext.rect(this.pageLeft,this.pageTop,i,this.getScaledValue(a)),this.pageContext.clip())}else{var h=x.convertPointToPixel(e.bodyWidgets[0].sectionFormat.footerDistance),d=void 0;d=(sf.base.isNullOrUndefined(e.footerWidgetIn.sectionFormat),e.boundingRectangle.height-Math.max(e.footerWidgetIn.height+h,x.convertPointToPixel(e.footerWidgetIn.sectionFormat.bottomMargin))),o=Math.max(e.boundingRectangle.height-a,d),s=e.boundingRectangle.height-h}this.renderFloatingItems(e,t.floatingElements,"Behind");for(var c=0;c<t.childWidgets.length;c++){var p=t.childWidgets[parseInt(c.toString(),10)];r||(o+=p.height),(r||!r&&this.getScaledValue(Math.round(o))<=this.getScaledValue(Math.round(s)))&&this.renderWidget(e,p)}this.renderFloatingItems(e,t.floatingElements,"InFrontOfText"),n&&this.pageContext.restore(),this.isPrinting||(this.pageContext.globalAlpha=this.documentHelper.owner.enableHeaderAndFooter?.65:1)},i.prototype.renderHeaderSeparator=function(e,t,i,r){var n=x.convertPointToPixel(e.bodyWidgets[0].sectionFormat.topMargin),o=this.getScaledValue(Math.max(r.y+r.height,n)),s=this.getScaledValue(e.boundingRectangle.width),a=this.pageContext;a.save(),a.globalAlpha=.65;var l=this.getScaledValue(e.boundingRectangle.height)/100*40;o=Math.min(o,l),this.renderDashLine(a,t,i+o,s,"#000000",!1);var h=this.getHeaderFooterType(e,!0);a.font="9pt Arial";var d=a.measureText(h).width;if(this.renderHeaderFooterMark(a,t+5,i+o,d+10,20),this.renderHeaderFooterMarkText(a,h,t+10,o+i+15),e.footerWidget){var c=x.convertPointToPixel(e.bodyWidgets[0].sectionFormat.footerDistance),p=this.getScaledValue(e.boundingRectangle.height)-this.getScaledValue(Math.max(e.footerWidgetIn.height+c,x.convertPointToPixel(e.footerWidgetIn.sectionFormat.bottomMargin)));p=Math.max(this.getScaledValue(e.boundingRectangle.height)-l,p),this.renderDashLine(a,t,i+p,s,"#000000",!1),h=this.getHeaderFooterType(e,!1),d=a.measureText(h).width,this.renderHeaderFooterMark(a,t+5,i+p-20,d+10,20),this.renderHeaderFooterMarkText(a,h,t+10,i+p-5),a.restore()}},i.prototype.getFooterHeight=function(e){var t=e.boundingRectangle.height/100*40,i=x.convertPointToPixel(e.bodyWidgets[0].sectionFormat.footerDistance),r=e.boundingRectangle.height-Math.max(e.footerWidgetIn.height+i,x.convertPointToPixel(e.footerWidgetIn.sectionFormat.bottomMargin));return Math.max(e.boundingRectangle.height-t,r)},i.prototype.getHeaderFooterType=function(e,t){var i;return i=t?this.documentHelper.owner.localeKeys.DocumentEditor_Header:this.documentHelper.owner.localeKeys.DocumentEditor_Footer,e.bodyWidgets[0].sectionFormat.differentFirstPage&&(sf.base.isNullOrUndefined(e.previousPage)||e.sectionIndex!==e.previousPage.sectionIndex)?i=t?this.documentHelper.owner.localeKeys.DocumentEditor_FirstPageHeader:this.documentHelper.owner.localeKeys.DocumentEditor_FirstPageFooter:e.bodyWidgets[0].sectionFormat.differentOddAndEvenPages&&(i=(this.documentHelper.pages.indexOf(e)+1)%2==0?t?this.documentHelper.owner.localeKeys.DocumentEditor_EvenPageHeader:this.documentHelper.owner.localeKeys.DocumentEditor_EvenPageFooter:t?this.documentHelper.owner.localeKeys.DocumentEditor_OddPageHeader:this.documentHelper.owner.localeKeys.DocumentEditor_OddPageFooter),i},i.prototype.renderDashLine=function(e,t,i,r,n,o){e.beginPath(),e.strokeStyle=n,e.lineWidth=1,o?e.setLineDash([3,2]):e.setLineDash([6,4]),e.moveTo(t,i),e.lineTo(t+r,i),e.stroke(),e.setLineDash([]),e.closePath()},i.prototype.renderSolidLine=function(e,t,i,r,n){e.beginPath(),e.strokeStyle=n,e.lineWidth=.5,e.moveTo(t,i),e.lineTo(t+r,i),e.stroke(),e.closePath()},i.prototype.renderHeaderFooterMark=function(e,t,i,r,n){e.beginPath(),e.fillStyle="lightgray",e.fillRect(t,i,r,n),e.strokeStyle="black",e.strokeRect(t,i,r,n),e.closePath()},i.prototype.renderHeaderFooterMarkText=function(e,t,i,r){e.beginPath(),e.fillStyle="#000000",e.textBaseline="alphabetic",e.fillText(t,i,r),e.closePath()},i.prototype.render=function(e,t){this.isFieldCode&&(this.isFieldCode=!1);for(var i=0;i<e.bodyWidgets.length;i++)sf.base.isNullOrUndefined(e.bodyWidgets[i].floatingElements)||this.renderFloatingItems(e,e.bodyWidgets[i].floatingElements,"Behind");var r=!1;if(!(this.viewer instanceof Z)&&t.sectionFormat.columns.length>1){var n=e.bodyWidgets.indexOf(t),o=void 0,s=void 0;0===n?(o=e.bodyWidgets[n].x-x.convertPointToPixel(e.bodyWidgets[n].sectionFormat.leftMargin),s=x.convertPointToPixel(e.bodyWidgets[n].sectionFormat.leftMargin)+t.sectionFormat.columns[n].width+t.sectionFormat.columns[n].space/2):n===t.sectionFormat.columns.length-1?(o=e.bodyWidgets[n].x-t.sectionFormat.columns[n-1].space/2,s=x.convertPointToPixel(e.bodyWidgets[n].sectionFormat.rightMargin)+t.sectionFormat.columns[n].width+t.sectionFormat.columns[n-1].space/2):(o=e.bodyWidgets[n].x-t.sectionFormat.columns[n].space/2,s=t.sectionFormat.columns[n].width+t.sectionFormat.columns[n].space),this.clipRect(o,e.bodyWidgets[n].y,this.getScaledValue(s),this.getScaledValue(e.boundingRectangle.height)),r=!0}for(i=0;i<t.childWidgets.length;i++){var a=t.childWidgets[parseInt(i.toString(),10)];0===i&&t.childWidgets[0]instanceof de&&t.childWidgets[0].childWidgets.length>0&&e.repeatHeaderRowTableWidget&&this.renderHeader(e,a,this.documentHelper.layout.getHeader(t.childWidgets[0])),this.renderWidget(e,a)}for(i=0;i<e.bodyWidgets.length;i++)sf.base.isNullOrUndefined(e.bodyWidgets[i].floatingElements)||this.renderFloatingItems(e,e.bodyWidgets[i].floatingElements,"InFrontOfText");r&&this.pageContext.restore();for(i=0;i<e.bodyWidgets.length;i++)if(!0===e.bodyWidgets[parseInt(i.toString(),10)].sectionFormat.lineBetweenColumns&&0!==e.bodyWidgets[parseInt(i.toString(),10)].indexInOwner&&e.bodyWidgets.length>1){var l=x.convertPointToPixel(e.bodyWidgets[0].sectionFormat.topMargin),h=this.getScaledValue(Math.max(e.headerWidgetIn.y+e.headerWidgetIn.height,l)),d=this.getScaledValue(e.boundingRectangle.height)/100*40,c=x.convertPointToPixel(e.bodyWidgets[0].sectionFormat.footerDistance),p=this.getScaledValue(e.boundingRectangle.height)-this.getScaledValue(Math.max(e.footerWidgetIn.height+c,x.convertPointToPixel(e.footerWidgetIn.sectionFormat.bottomMargin)));p=Math.max(this.getScaledValue(e.boundingRectangle.height)-d,p);var u=(e.bodyWidgets[parseInt(i.toString(),10)].x-(e.bodyWidgets[parseInt(i.toString(),10)].previousRenderedWidget.x+e.bodyWidgets[parseInt(i.toString(),10)].previousRenderedWidget.width))/2+(e.bodyWidgets[parseInt(i.toString(),10)].previousRenderedWidget.x+e.bodyWidgets[parseInt(i.toString(),10)].previousRenderedWidget.width),g=h/this.documentHelper.zoomFactor,f=u,m=void 0;m=e.footnoteWidget?(p-e.footerWidgetIn.height/2-e.footnoteWidget.height*this.documentHelper.zoomFactor)/this.documentHelper.zoomFactor:(p-e.footerWidgetIn.height/2)/this.documentHelper.zoomFactor;this.renderSingleBorder("#000000",u,g,f,m,.5,"Single")}},i.prototype.renderFloatingItems=function(e,t,i){if(!sf.base.isNullOrUndefined(t)&&t.length>0){t.sort((function(e,t){return e instanceof de||t instanceof de?0:e.zOrderPosition-t.zOrderPosition}));for(var r=0;r<t.length;r++)if(!(t[r]instanceof de)){var n=t[r];if(!("Behind"===i&&"Behind"!==n.textWrappingStyle||"Behind"!==i&&"Behind"===n.textWrappingStyle))if(n instanceof Re)this.renderImageElementBox(n,n.x,n.y,0);else if(n instanceof Ee){var o=this.getScaledValue(n.x,1),s=this.getScaledValue(n.y,2);this.renderShapeElementBox(n,o,s,e)}}}},i.prototype.renderShapeElementBox=function(e,t,i,r){var n=0===e.height,o=e.autoShapeType,s=e.textFrame.childWidgets;this.pageContext.beginPath(),e.fillFormat&&e.fillFormat.color&&e.fillFormat.fill&&(this.pageContext.fillStyle=e.fillFormat.color,this.pageContext.fillRect(t,i,this.getScaledValue(e.width),this.getScaledValue(e.height))),sf.base.isNullOrUndefined(o)||e.lineFormat.line&&"None"!==e.lineFormat.lineFormatType&&(this.pageContext.lineWidth=e.lineFormat.weight,this.pageContext.strokeStyle=x.getColor(e.lineFormat.color),this.pageContext.strokeRect(t,i,this.getScaledValue(e.width),this.getScaledValue(e.height))),this.pageContext.closePath();var a=!1;0!=e.width&&0!=e.height&&(a=!0,this.clipRect(e.x,e.y,this.getScaledValue(e.width),this.getScaledValue(e.height)));for(var l=0;l<s.length;l++)this.renderWidget(r,s[l]),n&&"StraightConnector"!==o&&(e.height+=s[l].height);n&&(n=!1),a&&this.pageContext.restore()},i.prototype.renderWidget=function(e,t){t instanceof le?this.renderParagraphWidget(e,t):this.renderTableWidget(e,t)},i.prototype.renderHeader=function(e,t,i){if(!sf.base.isNullOrUndefined(i)){e.viewer.updateClientArea(e.bodyWidgets[0],e);for(var r=e.viewer.clientArea.y,n=i.ownerTable.getSplitWidgets()[0],o=0;o<=i.rowIndex;o++){if(0===n.childWidgets.length)return;var s=n.childWidgets[o];if(-1===t.childWidgets.indexOf(s)){var a=s.clone();a.containerWidget=s.containerWidget,e.viewer.updateClientAreaLocation(a,new $(e.viewer.clientArea.x,r,a.width,a.height)),e.documentHelper.layout.updateChildLocationForRow(r,a);for(var l=void 0,h=0;h<a.childWidgets.length;h++)l=a.childWidgets[h],this.renderTableCellWidget(e,l);r+=a.height}}t.y!==r&&e.documentHelper.layout.updateChildLocationForTable(r,t)}},i.prototype.renderParagraphWidget=function(e,t){for(var i=t.y,r=t.x,n=!1,o=t.firstChild,s=0,a=0;a<o.children.length;a++){var l=o.children[a];if(l instanceof we){s=l.padding.left;break}}s>0&&(this.clipRect(t.x+s,this.getScaledValue(e.boundingRectangle.y),this.getScaledValue(e.boundingRectangle.width),this.getScaledValue(e.boundingRectangle.height)),n=!0),this.renderParagraphBorder(e,t),n&&this.pageContext.restore();for(a=0;a<t.childWidgets.length;a++){var h=t.childWidgets[a];i+=h.marginTop,this.renderLine(h,e,r,i),i+=h.height}},i.prototype.renderParagraphBorder=function(e,t){var i=t.paragraphFormat.borders.left,r=t.paragraphFormat.borders.top,n=t.paragraphFormat.borders.right,o=t.paragraphFormat.borders.bottom,s=0,a=0,l=0,h=0,d=0,c=t.firstChild,p=t.lastChild,u=this.documentHelper.canRenderBorder(t);"None"!==i.lineStyle&&(l=s=this.documentHelper.getParagraphLeftPosition(t)-x.convertPointToPixel(i.space),h=a+t.height,h="None"!==r.lineStyle&&c.isFirstLine()&&!u.skipTopBorder?(a=t.y+this.getTopMargin(t)-x.convertPointToPixel(r.lineWidth+r.space))+t.height-(this.getTopMargin(t)-x.convertPointToPixel(r.lineWidth+r.space)):(a=t.y)+t.height,"None"!==o.lineStyle&&p.isLastLine()&&!u.skipBottomBorder&&(h=h+x.convertPointToPixel(o.lineWidth+o.space)-this.getBottomMargin(t)),d=x.convertPointToPixel(i.lineWidth),this.renderSingleBorder(i.color,s,a,l,h,d,i.lineStyle)),"None"!==r.lineStyle&&c.isFirstLine()&&!u.skipTopBorder&&(l=(s=this.documentHelper.getParagraphLeftPosition(t))+this.getContainerWidth(t,e),h=a=t.y+this.getTopMargin(t)-x.convertPointToPixel(r.lineWidth+r.space),"None"!==i.lineStyle&&(s-=x.convertPointToPixel(i.space)),"None"!==n.lineStyle&&(l+=x.convertPointToPixel(n.space)),d=x.convertPointToPixel(r.lineWidth),this.renderSingleBorder(r.color,s,a,l,h,d,r.lineStyle)),"None"!==n.lineStyle&&(l=s=this.documentHelper.getParagraphLeftPosition(t)+this.getContainerWidth(t,e)+x.convertPointToPixel(n.space),h=(a=h)+t.height,h="None"!==r.lineStyle&&c.isFirstLine()&&!u.skipTopBorder?(a=t.y+this.getTopMargin(t)-x.convertPointToPixel(r.lineWidth+r.space))+t.height-(this.getTopMargin(t)-x.convertPointToPixel(r.lineWidth+r.space)):(a=t.y)+t.height,"None"!==o.lineStyle&&p.isLastLine()&&!u.skipBottomBorder&&(h=h+x.convertPointToPixel(o.lineWidth+o.space)-this.getBottomMargin(t)),d=x.convertPointToPixel(n.lineWidth),this.renderSingleBorder(n.color,s,a,l,h,d,n.lineStyle)),"None"!==o.lineStyle&&p.isLastLine()&&!u.skipBottomBorder&&(l=(s=this.documentHelper.getParagraphLeftPosition(t))+this.getContainerWidth(t,e),h=a=t.y+t.height+x.convertPointToPixel(o.lineWidth+o.space)-this.getBottomMargin(t),"None"!==i.lineStyle&&(s-=x.convertPointToPixel(i.space)),"None"!==n.lineStyle&&(l+=x.convertPointToPixel(n.space)),d=x.convertPointToPixel(o.lineWidth),this.renderSingleBorder(o.color,s,a,l,h,d,o.lineStyle))},i.prototype.getContainerWidth=function(e,t){var i=0;if(e.paragraphFormat.firstLineIndent<0&&(i=Math.abs(e.paragraphFormat.firstLineIndent)),e.isInsideTable){var r=e.associatedCell;return r.width+r.margin.left+r.margin.right-r.leftBorderWidth}if(this.viewer instanceof Z){var n=x.convertPointToPixel(e.leftIndent+e.rightIndent);return(this.documentHelper.visibleBounds.width-n-4*this.viewer.padding.right-2*this.viewer.padding.left)/this.documentHelper.zoomFactor}var o=e.bodyWidget;if(o instanceof ne&&o.sectionFormat.columns.length>1){var s=o.page.bodyWidgets.indexOf(o);return o.sectionFormat.columns[s].width+x.convertPointToPixel(i-(e.rightIndent+e.leftIndent))}var a=o.sectionFormat.pageWidth-o.sectionFormat.leftMargin-o.sectionFormat.rightMargin;return x.convertPointToPixel(a+i-(e.rightIndent+e.leftIndent))},i.prototype.getTopMargin=function(e){if(e.isEmpty())return e.childWidgets[0].margin.top;var t=e.childWidgets[0],i=0;sf.base.isNullOrUndefined(t.margin)||(i=t.margin.top);for(var r=0;r<t.children.length;r++){var n=t.children[r];if(n instanceof we){i=n.margin.top;break}}return i},i.prototype.getBottomMargin=function(e){if(e.isEmpty())return e.childWidgets[e.childWidgets.length-1].margin.bottom;var t=e.childWidgets[e.childWidgets.length-1],i=0;if(sf.base.isNullOrUndefined(t.margin)||(i=t.margin.bottom),t.children.length>0)for(var r=t.children.length-1;r>=0;r--){var n=t.children[r];if(n instanceof we){i=n.margin.bottom;break}}return i},i.prototype.renderfootNoteWidget=function(e,t,i){1===t.page.bodyWidgets.length&&(1===t.page.bodyWidgets[0].childWidgets.length&&null!=t.page.bodyWidgets[0].childWidgets[0].isEmpty&&t.page.bodyWidgets[0].childWidgets[0].isEmpty()||t.page.bodyWidgets[0].childWidgets.length);var r=this.getFooterHeight(e),n=t.y+t.height;n>r&&(n=r-t.y),this.pageContext.beginPath(),this.pageContext.save(),this.pageContext.rect(this.pageLeft,this.getScaledValue(t.y,2),this.getScaledValue(i),this.getScaledValue(n)),this.pageContext.clip();for(var o=0;o<t.bodyWidgets.length;o++)for(var s=t.bodyWidgets[o],a=s.footNoteReference,l=0;l<s.childWidgets.length;l++){var h=s.childWidgets[l];if(0===o&&0===l){var d=this.pageContext,c=e.bodyWidgets[0].x;if(e.bodyWidgets.length>1){var p=e.bodyWidgets[0].width;this.renderSolidLine(d,this.getScaledValue(c,1),this.getScaledValue(t.y+t.margin.top/2+1,2),p*this.documentHelper.zoomFactor,"#000000")}else this.renderSolidLine(d,this.getScaledValue(c,1),this.getScaledValue(t.y+t.margin.top/2+1,2),210*this.documentHelper.zoomFactor,"#000000")}0===l&&!sf.base.isNullOrUndefined(a)&&h.childWidgets[0].children[0]instanceof we&&!this.documentHelper.owner.editor.isFootNoteInsert&&(h.childWidgets[0].children[0].text=h.childWidgets[0].children[0].text.replace(h.childWidgets[0].children[0].text,a.text)),this.renderWidget(e,h)}this.pageContext.restore()},i.prototype.renderTableWidget=function(e,t){if(!this.isFieldCode)for(var i=0;i<t.childWidgets.length;i++){var r=t.childWidgets[i];this.renderTableRowWidget(e,r),t.tableFormat.cellSpacing>0&&this.renderTableOutline(t)}},i.prototype.renderTableRowWidget=function(e,t){for(var i=0;i<t.childWidgets.length;i++){var r=t.childWidgets[i];this.renderTableCellWidget(e,r)}},i.prototype.renderTableCellWidget=function(e,t){if(!this.isPrinting){var i,r;if(i=t.margin.top-t.containerWidget.topBorderWidth,r=t.margin.bottom-t.containerWidget.bottomBorderWidth,this.getScaledValue(t.y,2)+t.height+r*this.documentHelper.zoomFactor<0||this.getScaledValue(t.y,2)-i>this.documentHelper.visibleBounds.height)return}this.renderSelectionHighlightOnTable(e,t),this.renderTableCellOutline(e.documentHelper,t);for(var n=0;n<t.childWidgets.length;n++){var o=t.childWidgets[n],s=t.width+t.margin.left+t.margin.right-t.leftBorderWidth;this.isPrinting||this.clipRect(t.x-t.margin.left,t.y,this.getScaledValue(s),this.getScaledValue(this.height)),this.renderWidget(e,o),this.pageContext.restore()}},i.prototype.checkHeaderFooterLineWidget=function(e,t){var i;if(e instanceof ue?i=e.paragraph.bodyWidget:e instanceof pe&&(i=e.bodyWidget),!sf.base.isNullOrUndefined(i.parentHeaderFooter)){i=i.parentHeaderFooter;for(var r=0;r<t.length;r++){var n=t[r];if(n instanceof ue&&e instanceof ue){var o=n.getHierarchicalIndex(""),s=e.getHierarchicalIndex("");if(n.paragraph.isInHeaderFooter&&i===n.paragraph.bodyWidget&&o.substring(o.indexOf(";"))===s.substring(s.indexOf(";")))return n}else if(n instanceof pe&&e instanceof pe){o=n.getHierarchicalIndex(""),s=e.getHierarchicalIndex("");if(n.ownerTable.isInHeaderFooter&&i===n.ownerTable.bodyWidget&&o.substring(o.indexOf(";"))===s.substring(s.indexOf(";")))return n}}}},i.prototype.renderEditRegionHighlight=function(e,t,i){if(e.documentHelper.selection&&!sf.base.isNullOrUndefined(e.documentHelper.selection.editRegionHighlighters)){var r=e.documentHelper.selection.editRegionHighlighters.containsKey(t);if(!r&&t.paragraph.isInHeaderFooter){var n=e.documentHelper.selection.editRegionHighlighters.keys;t=this.checkHeaderFooterLineWidget(t,n),sf.base.isNullOrUndefined(t)||(r=!0)}if(r)for(var o=e.documentHelper.selection.editRegionHighlighters.get(t),s=0;s<o.length;s++)this.pageContext.fillStyle=""!==o[s].color?o[s].color:"#add8e6",this.pageContext.fillRect(this.getScaledValue(o[s].left,1),this.getScaledValue(i,2),this.getScaledValue(o[s].width),this.getScaledValue(t.height))}},i.prototype.renderSearchHighlight=function(e,t,i){if(this.documentHelper.owner.searchModule&&!sf.base.isNullOrUndefined(e.documentHelper.owner.searchModule.searchHighlighters)){var r=e.documentHelper.owner.searchModule.searchHighlighters.containsKey(t);if(!r&&t.paragraph.isInHeaderFooter){var n=e.documentHelper.owner.searchModule.searchHighlighters.keys;t=this.checkHeaderFooterLineWidget(t,n),sf.base.isNullOrUndefined(t)||(r=!0)}if(r)for(var o=e.documentHelper.owner.searchModule.searchHighlighters.get(t),s=0;s<o.length;s++)this.pageContext.fillStyle=this.viewer.owner.documentEditorSettings.searchHighlightColor,this.pageContext.fillRect(this.getScaledValue(o[s].left,1),this.getScaledValue(i,2),this.getScaledValue(o[s].width),this.getScaledValue(t.height))}},i.prototype.renderSelectionHighlight=function(e,t,i){if(!this.isPrinting&&e.documentHelper.owner.selection&&!this.documentHelper.isScrollToSpellCheck&&e.documentHelper.owner.selection.selectedWidgets.length>0){var r=e.documentHelper.owner.selection.selectedWidgets.containsKey(t);if(!r&&t.paragraph.isInHeaderFooter){var n=e.documentHelper.owner.selection.selectedWidgets.keys;t=this.checkHeaderFooterLineWidget(t,n),sf.base.isNullOrUndefined(t)||(r=!0)}r&&e.documentHelper.owner.selection.addSelectionHighlight(this.selectionContext,t,i,e)}},i.prototype.renderSelectionHighlightOnTable=function(e,t){if(!this.isPrinting&&e.documentHelper.owner.selection&&e.documentHelper.owner.selection.selectedWidgets.length>0){var i=e.documentHelper.owner.selection.selectedWidgets.containsKey(t);if(!i&&t.ownerTable.isInHeaderFooter){var r=e.documentHelper.owner.selection.selectedWidgets.keys;t=this.checkHeaderFooterLineWidget(t,r),sf.base.isNullOrUndefined(t)||(i=!0)}i&&e.documentHelper.owner.selection.addSelectionHighlightTable(this.selectionContext,t,e)}},i.prototype.renderLine=function(e,i,r,n){this.renderSelectionHighlight(i,e,n);var o=e.paragraph.paragraphFormat,s=r;if(e.isFirstLine()&&!o.bidi&&(r+=x.convertPointToPixel(o.firstLineIndent)),this.documentHelper&&this.documentHelper.selection&&!sf.base.isNullOrUndefined(this.documentHelper.selection.formFieldHighlighters)&&this.documentHelper.selection.formFieldHighlighters.containsKey(e)&&this.documentHelper.owner.documentEditorSettings&&this.documentHelper.owner.documentEditorSettings.formFieldSettings.applyShading)for(var a=i.documentHelper.selection.formFieldHighlighters.get(e),l=0;l<a.length;l++){this.pageContext.fillStyle=this.documentHelper.owner.documentEditorSettings.formFieldSettings.shadingColor;var h=e.height,d=!1;if(e.isLastLine()&&(h-=x.convertPointToPixel(this.documentHelper.layout.getAfterSpacing(e.paragraph)),e.paragraph.paragraphFormat.lineSpacing>1)){var c=this.getFormfieldInLine(e);if(!sf.base.isNullOrUndefined(c)){var p=this.documentHelper.textHelper.getHeight(c.characterFormat),u=p.Height;"Multiple"===e.paragraph.paragraphFormat.lineSpacingType?h-=x.convertPointToPixel(this.documentHelper.layout.getLineSpacing(e.paragraph,u,!0)):(n+=x.convertPointToPixel(e.paragraph.paragraphFormat.beforeSpacing),h=p.Height,d=!0)}}this.pageContext.fillRect(this.getScaledValue(a[l].left,1),this.getScaledValue(n,2),this.getScaledValue(a[l].width),this.getScaledValue(h)),d&&(d=!1,n-=x.convertPointToPixel(e.paragraph.paragraphFormat.beforeSpacing))}this.renderSearchHighlight(i,e,n),this.renderEditRegionHighlight(i,e,n);var g=!1,f=e.renderedElements,m=this.getUnderlineYPosition(e);for(l=0;l<f.length;l++){var y=f[l];if(!(y instanceof De&&"Inline"!==y.textWrappingStyle)){if(y instanceof nt||y instanceof He){var v=0;this.viewer instanceof X&&(v=this.viewer.pageGap);var b="display:block;position:absolute;";if(y instanceof nt&&0===y.commentType&&this.documentHelper.owner.selectionModule)if(this.documentHelper.owner.enableComment&&!g){g=!0,y.renderCommentMark();var w=x.convertPointToPixel(i.bodyWidgets[0].sectionFormat.rightMargin),M=x.convertPointToPixel(i.bodyWidgets[0].sectionFormat.pageWidth),N=i.boundingRectangle.x+this.getScaledValue(M-w+w/4)+"px;";this.viewer instanceof Z&&(N=i.boundingRectangle.width-2*this.viewer.padding.right-2*this.viewer.padding.left+"px;"),b=b+"left:"+N+"top:"+(this.getScaledValue(n+(i.boundingRectangle.y-v*(i.index+1)))+v*(i.index+1)+"px;"),y.commentMark.setAttribute("style",b)}else y.commentMark&&y.commentMark.setAttribute("style","display:none")}if(y instanceof fe||this.isFieldCode||0===y.width&&0===y.height)this.isFieldCode&&(y.width=0),r+=y.width+y.margin.left,this.toSkipFieldCode(y);else if(this.isPrinting||!(this.getScaledValue(n+y.margin.top,2)+y.height*this.documentHelper.zoomFactor<0||this.getScaledValue(n+y.margin.top,2)>this.documentHelper.visibleBounds.height)){if(y instanceof je)this.renderListTextElementBox(y,r,n,m);else if(y instanceof Re)r+=y.padding.left,this.renderImageElementBox(y,r,n,m);else if(y instanceof Ee){var I=this.getScaledValue(r,1),S=this.getScaledValue(n,2);this.renderShapeElementBox(y,I,S,i)}else y.isVisible=!0,r+=y.padding.left,this.renderTextElementBox(y,r,n,m);r+=y.width+y.margin.left,e.paragraph.bidi?s+=y.margin.left:s=r}else r+=y.width+y.margin.left,y instanceof we&&(y.canTrigger=!0,y.isVisible=!1,y.isSpellChecked&&!y.line.paragraph.isChangeDetected||(y.ischangeDetected=!0))}}if(this.documentHelper.owner.documentEditorSettings.showHiddenMarks&&!this.isPrinting){var C="",O=e.paragraph.characterFormat,T=0,P=this.retriveCharacterformat(O);if(this.pageContext.fillStyle=x.getColor(O.fontColor),0!=f.length||e.isEndsWithLineBreak||sf.base.isNullOrUndefined(e.paragraph)?T=1===e.paragraph.childWidgets.length?n+e.maxBaseLine+this.documentHelper.layout.getBeforeSpacing(e.paragraph):n+e.maxBaseLine:(T=e.paragraph.y+this.documentHelper.textHelper.getHeight(O).BaselineOffset,!e.isEndsWithLineBreak&&e.indexInOwner>0&&0==f.length&&(T=n+e.previousLine.maxBaseLine)),O.revisions.length>0){var A=this.documentHelper.authors.get(O.revisions[0].author);this.pageContext.fillStyle=x.getColor(A)}if(e.isEndsWithColumnBreak)P=this.retriveCharacterformat(O,.7),C="....."+this.documentHelper.owner.localeKeys.DocumentEditorContainer_ColumnBreak+".....";else if(e.isEndsWithPageBreak){P=this.retriveCharacterformat(O,.7),C=e.paragraph.bidi?String.fromCharCode(182)+"....."+this.documentHelper.owner.localeKeys.DocumentEditor_PageBreak+".....":"....."+this.documentHelper.owner.localeKeys.DocumentEditor_PageBreak+"....."+String.fromCharCode(182);var L=this.documentHelper.textHelper.getWidth(C,O,t.English);this.viewer instanceof X?e.paragraph.bidi?s<L+this.viewer.clientActiveArea.x&&(C="....."):s>this.viewer.clientActiveArea.width&&(C="....."):e.paragraph.bidi?s-L<this.viewer.clientActiveArea.x&&(C="....."):s+L>this.viewer.clientActiveArea.width+this.viewer.clientActiveArea.x&&(C=".....")}else e.isEndsWithLineBreak?C=e.paragraph.bidi?String.fromCharCode(8627):String.fromCharCode(8629):e.paragraph.isInsideTable&&sf.base.isNullOrUndefined(e.nextLine)&&sf.base.isNullOrUndefined(e.paragraph.nextWidget)?0!=e.height&&(C=String.fromCharCode(164)):sf.base.isNullOrUndefined(e.nextLine)&&(C=String.fromCharCode(182));if(e.paragraph.containerWidget instanceof ne&&!sf.base.isNullOrUndefined(e.paragraph.nextRenderedWidget)&&e.paragraph.containerWidget.sectionIndex!==e.paragraph.nextRenderedWidget.containerWidget.sectionIndex&&e.isLastLine()){C="NoBreak"===e.paragraph.nextRenderedWidget.containerWidget.sectionFormat.breakCode&&e.paragraph.containerWidget.index!==e.paragraph.nextRenderedWidget.containerWidget.index?":::::"+this.documentHelper.owner.localeKeys.DocumentEditor_SectionBreakContinuous+":::::":":::::"+this.documentHelper.owner.localeKeys.DocumentEditor_SectionBreakNextPage+":::::",P=this.retriveCharacterformat(O,.7),e.isEndsWithPageBreak&&(C=e.paragraph.bidi?C+String.fromCharCode(182)+"....."+this.documentHelper.owner.localeKeys.DocumentEditor_PageBreak+".....":"....."+this.documentHelper.owner.localeKeys.DocumentEditor_PageBreak+"....."+String.fromCharCode(182)+C);L=this.documentHelper.textHelper.getWidth(C,O,t.English);this.viewer instanceof X?e.paragraph.bidi?s<L+this.viewer.clientActiveArea.x&&(C=":::::",e.isEndsWithPageBreak&&(C=":::::.....")):s+L-this.viewer.clientActiveArea.x>this.viewer.clientActiveArea.width&&(C=":::::",e.isEndsWithPageBreak&&(C=".....:::::")):e.paragraph.bidi?s-L<this.viewer.clientActiveArea.x&&(C=":::::",e.isEndsWithPageBreak&&(C=":::::.....")):s+L-this.documentHelper.pages[0].boundingRectangle.x>this.viewer.clientActiveArea.width&&(C=":::::",e.isEndsWithPageBreak&&(C=".....:::::"))}C.length>0&&(e.paragraph.bidi&&(s-=this.documentHelper.textHelper.getWidth(C,O,t.English)),this.pageContext.font=P,this.pageContext.fillText(C,this.getScaledValue(s,1),this.getScaledValue(T,2)))}},i.prototype.retriveCharacterformat=function(e,t){sf.base.isNullOrUndefined(t)&&(t=1);this.pageContext.textBaseline="alphabetic";return(e.bold?"bold":"")+" "+(e.italic?"italic":"")+" "+(0===e.fontSize?.5:e.fontSize/("Normal"===e.baselineAlignment?1:1.5))*this.documentHelper.zoomFactor*t+'pt "'+e.fontFamily+'"'},i.prototype.toSkipFieldCode=function(e){e instanceof fe&&(0===e.fieldType?sf.base.isNullOrUndefined(e.fieldEnd)&&!e.hasFieldEnd||(this.isFieldCode=!0):2!==e.fieldType&&1!==e.fieldType||(this.isFieldCode=!1))},i.prototype.getUnderlineYPosition=function(e){for(var t=0,i=0,r=0;r<e.children.length;r++)e.children[r]instanceof fe||0===e.children[r].width&&0===e.children[r].height||e.children[r]instanceof Ee||t<e.children[r].height+e.children[r].margin.top&&(t=e.children[r].margin.top+e.children[r].height,i=e.children[r]instanceof Re?.9:e.children[r].height/20);return t-2*i},i.prototype.renderListTextElementBox=function(e,t,i,r){var n=e.margin.top,o=e.margin.left,s=e.listLevel.characterFormat,a=e.line.paragraph.characterFormat,l=s.hasValue("fontColor")?s.fontColor:a.fontColor;this.pageContext.textBaseline="alphabetic";var h,d,c=s.hasValue("fontFamily")?s.fontFamily:a.fontFamily;!this.documentHelper.isIosDevice||e.text!==String.fromCharCode(9679)&&e.text!==String.fromCharCode(9675)||(c="");var p=s.hasValue("fontSize")?s.fontSize:a.fontSize,u=s.hasValue("baselineAlignment")?s.baselineAlignment:a.baselineAlignment;h=s.hasValue("bold")?s.bold?"bold":"":a.bold?"bold":"",d=s.hasValue("italic")?s.italic?"italic":"":a.italic?"italic":"",p=0===p?.5:p/("Normal"===u?1:1.5),p=this.isPrinting?p:p*this.documentHelper.zoomFactor;var g=s.hasValue("strikethrough")?s.strikethrough:a.strikethrough,f=s.hasValue("highlightColor")?s.highlightColor:a.highlightColor;"NoColor"!==f&&("#"!==f.substring(0,1)?this.pageContext.fillStyle=x.getHighlightColorCode(f):this.pageContext.fillStyle=x.getColor(f),this.pageContext.fillRect(Math.floor(this.getScaledValue(t+o,1)-1),Math.floor(this.getScaledValue(i+n,2)-1),Math.ceil(this.getScaledValue(e.width)+1),Math.ceil(this.getScaledValue(e.height)+1))),this.pageContext.font=h+" "+d+" "+p+'pt "'+c+'"',"Subscript"===u&&(n+=e.height-e.height/1.5);var m=e.baselineOffset;n="Normal"===s.baselineAlignment?n+m:n+m/1.5;var y=e.text,v=e.paragraph.paragraphFormat.bidi;if(v&&(this.pageContext.direction="rtl",t+=e.width),"empty"===l||"#00000000"===l){var b=this.getBackgroundColorHeirachy(e);this.pageContext.fillStyle=this.getDefaultFontColor(b)}else this.pageContext.fillStyle=x.getColor(l);this.documentHelper.owner.documentEditorSettings.showHiddenMarks&&!this.isPrinting?(e instanceof je&&"\t"===e.text&&this.tabMark(e,s,t,i,o,n),this.pageContext.fillText(this.replaceSpace(y),this.getScaledValue(t+o,1),this.getScaledValue(i+n,2),this.getScaledValue(e.width))):this.pageContext.fillText(y,this.getScaledValue(t+o,1),this.getScaledValue(i+n,2),this.getScaledValue(e.width)),v&&(this.pageContext.direction="ltr",t-=e.width),"None"===s.underline||sf.base.isNullOrUndefined(s.underline)||this.renderUnderline(e,t,i,r,l,s.underline,u),"None"!==g&&this.renderStrikeThrough(e,t,i,s.strikethrough,l,u)},i.prototype.getDefaultFontColor=function(e){return x.isVeryDark(e)?"#FFFFFF":"#000000"},i.prototype.renderTextElementBox=function(t,i,r,n){var o=!1,s=t.line.paragraph.containerWidget;s instanceof pe&&(o="Exactly"===s.ownerRow.rowFormat.heightType);var a=t.margin.top,l=t.margin.left;if(o&&s instanceof pe){var h=s.width+s.margin.left+s.margin.right-s.leftBorderWidth;this.clipRect(s.x-s.margin.left,s.y,this.getScaledValue(h),this.getScaledValue(s.height))}var d=t.characterFormat;"NoColor"!==d.highlightColor&&("#"!==d.highlightColor.substring(0,1)?this.pageContext.fillStyle=x.getHighlightColorCode(d.highlightColor):this.pageContext.fillStyle=x.getColor(d.highlightColor),this.pageContext.fillRect(Math.floor(this.getScaledValue(i+l,1)-1),Math.floor(this.getScaledValue(r+a,2)-1),Math.ceil(this.getScaledValue(t.width)+1),Math.ceil(this.getScaledValue(t.height)+1)));var c=this.checkRevisionType(t),p=c.length>0?this.getRevisionColor(c):d.fontColor;this.pageContext.textBaseline="alphabetic";var u,g,f=11;u=d.bold?"bold":"",g=d.italic?"italic":"",f=0===d.fontSize?.5:d.fontSize/("Normal"===d.baselineAlignment?1:1.5),f=this.isPrinting?f:f*this.documentHelper.zoomFactor;var m=this.documentHelper.textHelper.getFontNameToRender(t.scriptType,d);this.pageContext.font=u+" "+g+" "+f+'pt "'+m+'"',"Subscript"===d.baselineAlignment&&(a+=t.height-t.height/1.5);var y=t.baselineOffset;if(a="Normal"===d.baselineAlignment?a+y:a+y/1.5,"empty"===p||"#00000000"===p){var v=this.getBackgroundColorHeirachy(t);this.pageContext.fillStyle=this.getDefaultFontColor(v)}else this.pageContext.fillStyle=x.getColor(p);var b=this.getScaledValue(t.width),w=t.text;if(t instanceof Se){var M=t;""!==M.tabText||sf.base.isNullOrUndefined(M.tabLeader)||"None"===M.tabLeader?""!==M.tabText&&(w=M.tabText):(w=this.getTabLeader(t),M.tabText=w)}var N=d.bidi||this.documentHelper.textHelper.isRTLText(t.text);w=this.documentHelper.textHelper.setText(w,N,d.bdo,!0),d.allCaps&&(w=w.toUpperCase());var I=t.characterRange;if((I==e.WordSplit||(I&e.WordSplit)==e.WordSplit&&(I&e.RightToLeft)==e.RightToLeft)&&d.bidi&&(w=this.inverseCharacter(w)),this.documentHelper.owner.documentEditorSettings.showHiddenMarks&&!this.isPrinting?((t instanceof Se||t instanceof we)&&"\t"===t.text&&this.tabMark(t,d,i,r,l,a),this.pageContext.fillText(this.replaceSpace(w),this.getScaledValue(i+l,1),this.getScaledValue(r+a,2),b)):this.pageContext.fillText(w,this.getScaledValue(i+l,1),this.getScaledValue(r+a,2),b),this.documentHelper.owner.isSpellCheck&&!this.spellChecker.removeUnderline&&(this.documentHelper.triggerSpellCheck||t.canTrigger)&&" "!==t.text&&!this.documentHelper.isScrollHandler&&(sf.base.isNullOrUndefined(t.previousNode)||!(t.previousNode instanceof fe))&&(!this.documentHelper.selection.isSelectionInsideElement(t)||this.documentHelper.triggerElementsOnLoading||this.documentHelper.owner.editor.triggerPageSpellCheck)){t.canTrigger=!0,this.leftPosition=this.pageLeft,this.topPosition=this.pageTop;var S=this.spellChecker.checktextElementHasErrors(t.text,t,i);if(S.errorFound&&!this.isPrinting){p="#FF0000";for(var C=s instanceof pe?s.cellFormat.shading.backgroundColor:this.documentHelper.backgroundColor,O=0;O<S.elements.length;O++){var T=S.elements[O];-1===t.ignoreOnceItems.indexOf(this.spellChecker.manageSpecialCharacters(T.text,void 0,!0))&&this.renderWavyLine(T,sf.base.isNullOrUndefined(T.start)?i:T.start.location.x,sf.base.isNullOrUndefined(T.start)?r:T.start.location.y-t.margin.top,n,p,"Single",d.baselineAlignment,C)}}else(t.ischangeDetected||this.documentHelper.triggerElementsOnLoading)&&(t.ischangeDetected=!1,this.handleChangeDetectedElements(t,n,i,r,d.baselineAlignment))}var P=this.getRevisionType(c,!0);("None"===d.underline||sf.base.isNullOrUndefined(d.underline))&&(sf.base.isNullOrUndefined(P)||"Insertion"!==P.type&&"MoveTo"!==P.type)||this.renderUnderline(t,i,r,n,p,d.underline,d.baselineAlignment,P),P=this.getRevisionType(c,!1),("None"===d.strikethrough||sf.base.isNullOrUndefined(d.strikethrough))&&(sf.base.isNullOrUndefined(P)||"Deletion"!==P.type&&"MoveFrom"!==P.type)||this.renderStrikeThrough(t,i,r,d.strikethrough,p,d.baselineAlignment,P),o&&this.pageContext.restore()},i.prototype.tabMark=function(e,t,i,r,n,o){var s=e.paragraph.bidi?String.fromCharCode(8592):String.fromCharCode(8594),a=this.documentHelper.textHelper.getWidth(s,t,e.scriptType),l=e.width/2,h=a/2;this.pageContext.font=this.retriveCharacterformat(e.characterFormat),l>a?this.pageContext.fillText(s,this.getScaledValue(i+n+l-h,1),this.getScaledValue(r+o,2)):this.pageContext.fillText(s,this.getScaledValue(i+n,1),this.getScaledValue(r+o,2),this.getScaledValue(e.width))},i.prototype.replaceSpace=function(e){return e=(e=e.replace(new RegExp(String.fromCharCode(32),"g"),String.fromCharCode(183))).replace(new RegExp(String.fromCharCode(160),"g"),String.fromCharCode(176))},i.prototype.inverseCharacter=function(e){switch(e){case String.fromCharCode(40):return String.fromCharCode(41);case String.fromCharCode(41):return String.fromCharCode(40);case String.fromCharCode(60):return String.fromCharCode(62);case String.fromCharCode(62):return String.fromCharCode(60);case String.fromCharCode(123):return String.fromCharCode(125);case String.fromCharCode(125):return String.fromCharCode(123);case String.fromCharCode(91):return String.fromCharCode(93);case String.fromCharCode(93):return String.fromCharCode(91);default:return e}},i.prototype.getBackgroundColorHeirachy=function(e){var t;if(e.paragraph.isInsideTable){var i=e.paragraph.containerWidget;if("empty"!==(t=i.cellFormat.shading.backgroundColor)&&"#00000000"!==t)return t;if("empty"!==(t=i.ownerTable.tableFormat.shading.backgroundColor)&&"#00000000"!==t)return t}else if(e.paragraph.containerWidget instanceof ze&&"#000000FF"===e.paragraph.containerWidget.containerShape.fillFormat.color)return e.paragraph.containerWidget.containerShape.fillFormat.color;return this.documentHelper.backgroundColor},i.prototype.handleChangeDetectedElements=function(e,t,i,r,n){var o=this,s=e.text.trim(),a=this.pageIndex;if("\v"!==e.text&&!this.spellChecker.checkElementCanBeCombined(e,t,a,!0)){var l=s.split(/[\s]+/),h=e.line.getOffset(e,0);if(l.length>1)for(var d=0;d<l.length;d++){var c=l[d],p=this.spellChecker.manageSpecialCharacters(c,void 0,!0);-1===this.spellChecker.ignoreAllItems.indexOf(p)&&-1===e.ignoreOnceItems.indexOf(p)&&(this.handleUnorderedElements(p,e,t,d,h,d===l.length-1,a),h+=c.length+1)}else{p=this.spellChecker.manageSpecialCharacters(s,void 0,!0);if(s.length>0&&-1===this.spellChecker.ignoreAllItems.indexOf(p)&&-1===e.ignoreOnceItems.indexOf(p)){var u=e.indexInOwner,g=e.line.paragraph.indexInOwner,f=this.spellChecker.checkSpellingInPageInfo(p);if(f.isElementPresent&&this.spellChecker.enableOptimizedSpellCheck){var m=JSON.parse('{"HasSpellingError":'+f.hasSpellError+"}");this.spellChecker.handleWordByWordSpellCheck(m,e,i,r,t,n,!0)}else if(this.spellChecker.isInUniqueWords(p)){var y=!!this.spellChecker.isErrorWord(p);m=JSON.parse('{"HasSpellingError":'+y+"}");this.spellChecker.handleWordByWordSpellCheck(m,e,i,r,t,n,!0)}else this.documentHelper.owner.editor.triggerPageSpellCheck&&!this.documentHelper.triggerElementsOnLoading||this.spellChecker.callSpellChecker(this.spellChecker.languageID,s,!0,this.spellChecker.allowSpellCheckAndSuggestion).then((function(s){var l=JSON.parse(s),h=(a===o.pageIndex||e.isVisible)&&u===e.indexInOwner&&g===e.line.paragraph.indexInOwner;o.spellChecker.handleWordByWordSpellCheck(l,e,i,r,t,n,h)}))}}}},i.prototype.handleUnorderedElements=function(e,t,i,r,n,o,s){var a=this,l=t.indexInOwner,h=t.line.paragraph.indexInOwner;if(e.length>0){var d=this.spellChecker.checkSpellingInPageInfo(e);if(d.isElementPresent&&this.spellChecker.enableOptimizedSpellCheck){var c=JSON.parse('{"HasSpellingError":'+d.hasSpellError+"}");this.spellChecker.handleSplitWordSpellCheck(c,e,t,!0,i,r,n,o)}else{var p=t.isVisible&&l===t.indexInOwner&&h===t.line.paragraph.indexInOwner;if(this.spellChecker.isInUniqueWords(e)){var u=!!this.spellChecker.isErrorWord(e);c=JSON.parse('{"HasSpellingError":'+u+"}");this.spellChecker.handleSplitWordSpellCheck(c,e,t,p,i,r,n,o)}else this.documentHelper.owner.editor.triggerPageSpellCheck&&!this.documentHelper.triggerElementsOnLoading||this.spellChecker.callSpellChecker(this.spellChecker.languageID,e,!0,this.spellChecker.allowSpellCheckAndSuggestion).then((function(s){var l=JSON.parse(s);a.spellChecker.handleSplitWordSpellCheck(l,e,t,p,i,r,n,o)}))}}},i.prototype.renderWavyLine=function(e,t,i,r,n,o,s,a){if(e.text.length>1){var l=e.height/("Normal"===s?1:1.5),h=e.margin.top,d=0;"Subscript"===s||e instanceof je?(d=l-2*(l/20)+i,d+=(h+=e.height-l)>0?h:0):d=r+i;var c=this.spellChecker.getSpecialCharactersInfo(e),p=this.spellChecker.getWhiteSpaceCharacterInfo(e),u=(t+c.beginningWidth+(p.isBeginning?p.width:0)+e.margin.left)*this.documentHelper.zoomFactor+this.leftPosition,g=d*this.documentHelper.zoomFactor+this.topPosition,f=u+this.getScaledValue(e.width-(c.beginningWidth+c.endWidth)-p.width),m=new M(u,g),y=new M(f,g);this.drawWavy(m,y,.5*(f-u),1,.7,n,e.height,a)}},i.prototype.drawWavy=function(e,t,i,r,n,o,s,a,l){this.pageContext.save(),this.pageContext.fillStyle=sf.base.isNullOrUndefined(a)?this.documentHelper.backgroundColor:a,this.pageContext.fillRect(e.x,e.y-r,t.x-e.x,3*r),this.pageContext.restore(),this.pageContext.lineWidth=1,this.pageContext.lineCap="round",this.pageContext.strokeStyle=o,this.pageContext.beginPath();for(var h=0,d=0,c=e.x,p=e.y,u=t.x,g=t.y,f=0,m=0,y=Math.atan2(g-p,u-c),v=Math.sqrt((c-u)*(c-u)+(p-g)*(p-g)),b=1*r,w=Math.PI*i;f<=v;f+=n)m=Math.sin(f/v*w)*b,h=e.x+Math.cos(y)*f+Math.cos(y-Math.PI/2)*m,d=e.y+Math.sin(y)*f+Math.sin(y-Math.PI/2)*m,f>0?this.pageContext.lineTo(h,d):this.pageContext.moveTo(h,d);this.pageContext.stroke(),this.pageContext.restore()},i.prototype.getTabLeader=function(e){var t,i=this.getTabLeaderString(e.tabLeader),r=i;t=this.documentHelper.textHelper.getWidth(r,e.characterFormat,e.scriptType);var n=Math.floor(e.width/t);0==t&&(n=0);for(var o=0;o<=n;o++)r+=i;return r.slice(0,-1)},i.prototype.getTabLeaderString=function(e){var t="";switch(e){case"Dot":t=".";break;case"Hyphen":t="-";break;case"Underscore":t="_"}return t},i.prototype.clipRect=function(e,t,i,r){this.pageContext.beginPath(),this.pageContext.save(),this.pageContext.rect(this.getScaledValue(e,1),this.getScaledValue(t,2),i,r),this.pageContext.clip()},i.prototype.getTrimmedWidth=function(e){var t=e.width;return e instanceof we&&!(e instanceof Se)&&sf.base.isNullOrUndefined(e.nextNode)&&(t=this.documentHelper.textHelper.getWidth(x.trimEnd(e.text),e.characterFormat,e.scriptType)),t},i.prototype.renderUnderline=function(e,t,i,r,n,o,s,a){var l=e.height/("Normal"===s?1:1.5),h=e.margin.top,d=l/20,c=0,p=l/20;"Subscript"===s||e instanceof je?(c=l-2*d+i,c+=(h+=e.height-l)>0?h:0):c=r+i;var u=0;for(sf.base.isNullOrUndefined(a)||(o="MoveTo"===a.type?"Double":"Single"),"Double"===o&&(c-=p),e instanceof Re&&(d=.9);u<("Double"===o?2:1);){u++;var g=this.getTrimmedWidth(e);this.pageContext.fillRect(this.getScaledValue(t+e.margin.left,1),this.getScaledValue(c,2),this.getScaledValue(g),this.getScaledValue(d)),c+=2*p}},i.prototype.renderStrikeThrough=function(e,t,i,r,n,o,s){var a=e.height/("Normal"===o?1:1.5),l=e.margin.top;"Subscript"===o&&(l+=e.height-a),i+=l>0?l:0;var h=a/20,d=a/2+.5*h,c=0;for(sf.base.isNullOrUndefined(s)||(r="Deletion"===s.type?"SingleStrike":"DoubleStrike"),e instanceof Re&&(h=.9),"DoubleStrike"===r&&(d-=h);c<("DoubleStrike"===r?2:1);){c++;var p=this.getTrimmedWidth(e);this.pageContext.fillRect(this.getScaledValue(t+e.margin.left,1),this.getScaledValue(d+i,2),this.getScaledValue(p),this.getScaledValue(h)),d+=2*h}},i.prototype.renderImageElementBox=function(e,t,i,r){var n=e.margin.top,o=e.margin.left,s=this.checkRevisionType(e),a=s.length>0?this.getRevisionColor(s):"black";this.pageContext.textBaseline="top";var l=0,h=!1,d=e.line.paragraph.containerWidget,c=!1;if(d instanceof pe&&(c="Exactly"===d.ownerRow.rowFormat.heightType),"Inline"===e.textWrappingStyle)if(n<0||e.line.paragraph.width<e.width){if(d instanceof pe){var p=0;if(d.childWidgets[0]instanceof le)p=d.childWidgets[0].paragraphFormat.leftIndent;l=d.width+d.margin.left-d.leftBorderWidth-p,h=!0,this.clipRect(t+o,i+n,this.getScaledValue(l),this.getScaledValue(d.height))}}else if(c){var u=d.width+d.margin.left-d.leftBorderWidth;h=!0,this.clipRect(d.x,d.y,this.getScaledValue(u),this.getScaledValue(d.height))}if(e.isMetaFile&&!sf.base.isNullOrUndefined(e.metaFileImageString))this.pageContext.drawImage(e.element,this.getScaledValue(t+o,1),this.getScaledValue(i+n,2),this.getScaledValue(e.width),this.getScaledValue(e.height));else try{e.isCrop?this.pageContext.drawImage(e.element,e.cropX,e.cropY,e.cropWidth,e.cropHeight,this.getScaledValue(t+o,1),this.getScaledValue(i+n,2),this.getScaledValue(e.width),this.getScaledValue(e.height)):this.pageContext.drawImage(e.element,this.getScaledValue(t+o,1),this.getScaledValue(i+n,2),this.getScaledValue(e.width),this.getScaledValue(e.height))}catch(r){e.imageString="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAOEAAADhCAMAAAAJbSJIAAAAgVBMVEX///8AAADgAADY2Njl5eVcXFxjY2NZWVl/f3+wsLCmpqb4+PiioqKpqam7u7vV1dX2uLj2wsLhFRXzpKT3vb30sbHhCwv74+P40dH+9vbkIyO2trbBwcHLy8tsbGycnJz529v4zMzrbGzlLS3qZmblNzfrdXXoRkbvi4vvgYHlHh7CZsBOAAADpUlEQVR4nO3da1faQBSF4ekAUQlUEFs14AXxVv7/D6yaQiZx5mSEYXF2ut+PNKzyyK5diYDmR9czx34AB49C/CjE759w3jvvWr15Tdgz3atXE54f++EcIArxoxA/CvGjED8K8aMQPwrxoxA/CvGLEeZ9jPJdhfk4GyCUjb3ECGE/Q6m/q3DwfudjP0ERZYN9hKdn2hvd3+0jHJz5/kBVuTk96bbQUEjhYR9ckiikUH8UUqg/CinUH4UU6o9CCvVHIYX6o5BC/VFIof4opFB/FFKoPwop1B+FFOqPQgrjyxfjVC38Lxk9tnAxGqZqdKtSOE4GHA5/fuNJpDCtcNHbv4VqYYqPLjgfUViPQgrjozA2CptRSGF8/59w+Wrt+rr1btNna1cPzg0wwuXavncxabnX7PfHYYXzlYARvlobQZyUR9mXm+1NMEK7SSLONgcVV9vb8IQXv4J3KSeKKlxXxNCzONkeYp8AV3p9UT1+P3FWHVAsq5thhGZSEb1DrSZq7dS5HUdoLiuBZ6jORG3tCwAkNJfCUJ2Jrqe1P0ESCkMNTdSACYNDDU7UoAkDQw1P1MAJvUMVJmrwhJ6hShM1gMIvQxUnahCFjaHKEzWQQneoxR95ogZTWBuqPFEDKnSHKk/UoArdoYoTNbDC5lBDEzW4QjMpYiZqgIXG/S76JhwHK5zVVipcnkIVuv/RW/HyFKhwYhuFr6NiCmdNoDBUSGFjovJQEYXuRN9ahwoorJ8uSZenPsMTNk+X2q6jwgm/ntHL11HhhL4zenmoYEL/Gb04VCxh6KKTNFQoYfiikzBUJKF00Sk8VCChfF00OFQcYdt10dBQYYRT5xn0n9G7Q0X8GfCzNNEyZ6iPgD/HlydaVg11DfhajJaJlm2HugIUrlomWrYZKuJKHz6vHhbSM/hROdRnxNe1meuXYvW0DB6+aflYrB7dlzDiCM3N1dVN6GDhMCDhjlHYjEIK46MwNgqbUUhhfJ/vA07wO8N1vw94ONo/3e/lTpVOYfc/UyG//ZmqW52fi/FuTNW3/lZ+eguF+qOQQv1RSKH+KKRQfxRSqD8KKdQfhRTqj0IK9UchhfqjkEL9UUih/iikUH8UUqg/CmXh6Hsv3jlK+wnvD/vgkrSHMMuyu1P9ZdmuwnycDQYn+svG3n9KEUKT9zHyf6+IEWJHIX4U4kchfhTiRyF+FOJHIX4U4kchfnVhijeZa6sunCf4ZdPamteEHY5C/CjEr/vCv0ec0g+AtS1QAAAAAElFTkSuQmCC",this.pageContext.drawImage(e.element,this.getScaledValue(t+o,1),this.getScaledValue(i+n,2),this.getScaledValue(e.width),this.getScaledValue(e.height))}this.pageContext.fillStyle=x.getColor(a);var g=this.getRevisionType(s,!1);if(sf.base.isNullOrUndefined(g)||"Deletion"!==g.type&&"MoveFrom"!==g.type||this.renderStrikeThrough(e,t,i,"SingleStrike",a,"Normal",g),g=this.getRevisionType(s,!0),!sf.base.isNullOrUndefined(g)&&("Insertion"===g.type||"MoveTo"===g.type)){var f=this.getUnderlineYPosition(e.line);this.renderUnderline(e,t,i,f,a,"Single","Normal")}h&&this.pageContext.restore()},i.prototype.renderTableOutline=function(e){var t=new L(this.documentHelper),i=e;e.width=this.documentHelper.layout.getTableWidth(i);var r=i.isBidiTable?t.getTableRightBorder(i.tableFormat.borders):t.getTableLeftBorder(i.tableFormat.borders),n=0;n=x.convertPointToPixel(r.getLineWidth()),this.renderSingleBorder(r.color,e.x-e.margin.left-n/2,e.y,e.x-e.margin.left-n/2,e.y+e.height,n,r.lineStyle),r=t.getTableTopBorder(i.tableFormat.borders),n=0,n=x.convertPointToPixel(r.getLineWidth()),this.renderSingleBorder(r.color,e.x-e.margin.left-n,e.y-n/2,e.x+e.width+n+e.margin.right,e.y-n/2,n,r.lineStyle),r=i.isBidiTable?t.getTableLeftBorder(i.tableFormat.borders):t.getTableRightBorder(i.tableFormat.borders),n=0,n=x.convertPointToPixel(r.getLineWidth()),this.renderSingleBorder(r.color,e.x+e.width+e.margin.right+n/2,e.y,e.x+e.width+e.margin.right+n/2,e.y+e.height,n,r.lineStyle),r=t.getTableBottomBorder(i.tableFormat.borders),n=0,n=x.convertPointToPixel(r.getLineWidth()),this.renderSingleBorder(r.color,e.x-e.margin.left-n,e.y+e.height-n/2,e.x+e.width+n+e.margin.right,e.y+e.height-n/2,n,r.lineStyle)},i.prototype.renderTableCellOutline=function(e,t){var i,r,n=e.layout,o=t,s=0,a=0,l=0,h=t.ownerTable.isBidiTable;o.cellFormat.borders,t.containerWidget instanceof ce&&(a=t.margin.bottom-t.containerWidget.bottomBorderWidth,s=t.margin.top-t.containerWidget.topBorderWidth),i=t.margin.left-t.leftBorderWidth,r=t.margin.right-t.rightBorderWidth,l=sf.base.isNullOrUndefined(o.ownerRow)||"Exactly"!==o.ownerRow.rowFormat.heightType?!sf.base.isNullOrUndefined(o.ownerRow)&&[o.ownerRow].length<=1?Math.max(x.convertPointToPixel(o.ownerRow.rowFormat.height),t.height)+s+a:t.height+s+a:x.convertPointToPixel(o.ownerRow.rowFormat.height)+s+a;var d=h?pe.getCellRightBorder(o):pe.getCellLeftBorder(o),c=0;c=x.convertPointToPixel(d.getLineWidth()),this.renderCellBackground(l,t,i,c);var p=c;if(0===o.index||1===o.cellFormat.rowSpan||o.cellFormat.rowSpan>1&&0===o.columnIndex)this.renderSingleBorder(d.color,t.x-i-c,t.y-t.margin.top,t.x-i-c,t.y+t.height+a,c,d.lineStyle);else for(var u=0;u<o.ownerTable.childWidgets.length;u++){for(var g=o.ownerTable.childWidgets[u],f=void 0,m=0;m<g.childWidgets.length;m++){var y=g.childWidgets[m];if(y.columnIndex+y.cellFormat.columnSpan-1==o.columnIndex-1){f=y;break}if(g.childWidgets[m].columnIndex>=o.columnIndex&&g.childWidgets[m].previousWidget){f=g.childWidgets[m].previousWidget;break}}if(f&&f.columnIndex+f.cellFormat.columnSpan-1==o.columnIndex-1){var v=h?pe.getCellLeftBorder(f):pe.getCellRightBorder(f),b=v.lineWidth;if(f.y+f.height<o.y)continue;if(f.y<o.y&&f.y+f.height>o.y)this.renderSingleBorder(v.color,o.x-i-b,o.y-s,o.x-i-b,f.y+f.height+f.margin.bottom,b,v.lineStyle);else if(f.y===o.y||f.y>o.y&&f.y+f.height<o.y+o.height)this.renderSingleBorder(v.color,o.x-i-b,f.y-f.margin.top,o.x-i-b,f.y+f.height+f.margin.bottom,b,v.lineStyle);else if(f.y<o.y+o.height&&f.y+f.height>=o.y+o.height)this.renderSingleBorder(v.color,o.x-i-b,f.y-f.margin.top,o.x-i-b,f.y+f.height+a,b,v.lineStyle);else if(f.y>o.y+o.height)break}}if(o.updatedTopBorders&&o.updatedTopBorders.length>1)for(var w=t.x-t.margin.left-p/2,M=t.y-t.margin.top,N=0;N<o.updatedTopBorders.length;N++){var I=o.updatedTopBorders[N];"None"!==(d=I.border).lineStyle&&d.lineWidth<pe.getCellTopBorder(o).lineWidth&&(d.lineWidth=pe.getCellTopBorder(o).lineWidth),sf.base.isNullOrUndefined(d)||(c=x.convertPointToPixel(d.getLineWidth()),this.renderSingleBorder(d.color,w,M+c/2,w+I.width,M+c/2,c,d.lineStyle),w+=I.width)}else{d=pe.getCellTopBorder(o),c=x.convertPointToPixel(d.getLineWidth());this.renderSingleBorder(d.color,t.x-t.margin.left-p/2,t.y-t.margin.top+c/2,t.x+t.width+t.margin.right+0,t.y-t.margin.top+c/2,c,d.lineStyle)}var S=!1;S=h?0===o.columnIndex:o.cellIndex===o.ownerRow.childWidgets.length-1;for(var C=o.containerWidget.getPreviousRowSpannedCells(),O=!1,T=0;T<C.length;T++){var P=C[T];if(o.rowIndex<P.rowIndex+P.cellFormat.rowSpan&&o.columnIndex<P.columnIndex){O=!0;break}}!(o.ownerTable.tableFormat.cellSpacing>0||S)||!h&&o.columnIndex+o.cellFormat.columnSpan!==o.ownerTable.tableHolder.columns.length&&O||(d=h?pe.getCellLeftBorder(o):pe.getCellRightBorder(o),c=x.convertPointToPixel(d.getLineWidth()),this.renderSingleBorder(d.color,t.x+t.width+t.margin.right-c/2,t.y-t.margin.top,t.x+t.width+t.margin.right-c/2,t.y+t.height+a,c,d.lineStyle));var A=o.ownerRow.nextWidget,L=!1,F=void 0;if(!sf.base.isNullOrUndefined(A)){if(A.lastChild){var D=A.lastChild;F=D.columnIndex+D.cellFormat.columnSpan}var E;(E=A)instanceof ce&&t.containerWidget instanceof ce&&t.containerWidget.containerWidget instanceof de&&(L=-1!==t.containerWidget.containerWidget.childWidgets.indexOf(E))}if(o.ownerTable.tableFormat.cellSpacing>0||o.ownerRow.rowIndex===o.ownerTable.childWidgets.length-1||o.cellFormat.rowSpan>1&&o.ownerRow.rowIndex+o.cellFormat.rowSpan>=o.ownerTable.childWidgets.length||!L||F&&A.childWidgets.length<o.ownerRow.childWidgets.length&&F<o.columnIndex+o.cellFormat.columnSpan){var z=o.cellFormat.borders.bottom;d=(sf.base.isNullOrUndefined(z)||"Cleared"!==z.lineStyle)&&o.cellFormat.rowSpan>1&&o.ownerRow.rowIndex+o.cellFormat.rowSpan===o.ownerTable.childWidgets.length?o.getBorderBasedOnPriority(o.getBorderBasedOnPriority(o.cellFormat.borders.bottom,o.ownerRow.rowFormat.borders.bottom),o.ownerTable.tableFormat.borders.bottom):pe.getCellBottomBorder(o),c=x.convertPointToPixel(d.getLineWidth()),this.renderSingleBorder(d.color,t.x-t.margin.left-p/2,t.y+t.height+a+c/2,t.x+t.width+t.margin.right,t.y+t.height+a+c/2,c,d.lineStyle)}d=n.getCellDiagonalUpBorder(o),(c=x.convertPointToPixel(d.getLineWidth()))>0&&this.renderSingleBorder(d.color,t.x-i,t.y+t.height+a,t.x+t.width+r,t.y-s,c,d.lineStyle),d=n.getCellDiagonalDownBorder(o),(c=x.convertPointToPixel(d.getLineWidth()))>0&&this.renderSingleBorder(d.color,t.x-i,t.y-s,t.x+t.width+r,t.y+t.height+a,c,d.lineStyle)},i.prototype.renderCellBackground=function(e,t,i,r){var n=t.cellFormat,o="#ffffff"===n.shading.backgroundColor?t.ownerTable.tableFormat.shading.backgroundColor:n.shading.backgroundColor,s=t.x-i-r,a=t.margin.top-t.containerWidget.topBorderWidth,l=t.y-a,h=t.width+i+t.margin.right+r/2;t.ownerRow.rowFormat.revisions.length>0&&(o="Insertion"===t.ownerRow.rowFormat.revisions[t.ownerRow.rowFormat.revisions.length-1].revisionType?"#e1f2fa":"#fce6f4");this.pageContext.beginPath(),"empty"!==o&&(this.pageContext.fillStyle=x.getColor(o),this.pageContext.fillRect(this.getScaledValue(s,1),this.getScaledValue(l,2),this.getScaledValue(h),this.getScaledValue(e)),this.pageContext.closePath()),n.shading.hasValue("foregroundColor")&&"TextureNone"!==n.shading.textureStyle&&(this.pageContext.beginPath(),this.pageContext.fillStyle=this.drawTextureStyle(n.shading.textureStyle,x.getColor(n.shading.foregroundColor),x.getColor(n.shading.backgroundColor),"empty"===n.shading.foregroundColor,"empty"===n.shading.backgroundColor),this.pageContext.fillRect(this.getScaledValue(s,1),this.getScaledValue(l,2),this.getScaledValue(h),this.getScaledValue(e)),this.pageContext.closePath())},i.prototype.drawTextureStyle=function(e,t,i,r,n){if(n&&(i="#ffffff"),r&&(t="#000000"),e.indexOf("Percent")>-1){var o=e.replace("Texture","").replace("Percent","").replace("Pt","."),s=parseInt(o);return this.getForeColor(t,i,s,r,n)}return"TextureSolid"===e?t:"#FFFFFF"},i.prototype.getForeColor=function(e,t,i,r,n){var o,s,a,l=x.convertHexToRgb(e),h=x.convertHexToRgb(t);return o=this.getColorValue(l.r,h.r,i,r,n),s=this.getColorValue(l.g,h.g,i,r,n),a=this.getColorValue(l.b,h.b,i,r,n),"#"+x.convertRgbToHex(o)+x.convertRgbToHex(s)+x.convertRgbToHex(a)},i.prototype.getColorValue=function(e,t,i,r,n){return 100==i?e:r?n?Math.round(255*(1-i/100)):Math.round(t*(1-i/100)):n?Math.round(e*(i/100)):t+Math.round(e*(i/100))-Math.round(t*(i/100))},i.prototype.renderSingleBorder=function(e,t,i,r,n,o,s){this.pageContext.beginPath(),this.pageContext.moveTo(this.getScaledValue(t,1),this.getScaledValue(i,2)),this.pageContext.lineTo(this.getScaledValue(r,1),this.getScaledValue(n,2)),this.pageContext.lineWidth=this.getScaledValue(o),this.pageContext.strokeStyle=x.getColor(e),"None"!==s&&"Cleared"!==s&&this.pageContext.stroke(),this.pageContext.closePath()},i.prototype.getScaledValue=function(e,t){return this.isPrinting?e:(sf.base.isNullOrUndefined(t)&&(t=0),e*this.documentHelper.zoomFactor+(1===t?this.pageLeft:2===t?this.pageTop:0))},i.prototype.checkRevisionType=function(e){for(var t=[],i=e.revisions.length,r=0;r<i;r++){var n=e.revisions[r],o=this.documentHelper.authors.get(n.author);t.push({type:n.revisionType,color:o})}return t},i.prototype.getRevisionColor=function(e){if(1===e.length)return e[0].color;for(var t=0;t<e.length;t++)if("Deletion"===e[t].type||"MoveFrom"===e[t].type)return e[t].color;return e.length>0?e[0].color:void 0},i.prototype.getRevisionType=function(e,t){if(0!==e.length)for(var i=0;i<e.length;i++){var r=void 0;if(t&&("Insertion"===e[i].type||"MoveTo"===e[i].type))return r=e[i],this.pageContext.fillStyle=x.getColor(r.color),e.splice(i,1),r;if(!t&&("Deletion"===e[i].type||"MoveFrom"===e[i].type))return r=e[i],this.pageContext.fillStyle=x.getColor(r.color),e.splice(i,1),r}},i.prototype.getFormfieldInLine=function(e){for(var t=0;t<e.children.length;t++)if(e.children[t]instanceof fe&&!sf.base.isNullOrUndefined(e.children[t].formFieldData))return e.children[t]},i.prototype.destroy=function(){this.documentHelper=void 0,sf.base.isNullOrUndefined(this.pageCanvasIn)||(this.pageCanvasIn.innerHTML=""),this.pageCanvasIn=void 0},i}(),z=function(){function i(e){this.paragraphMarkInfo={},this.documentHelper=e,sf.base.isNullOrUndefined(e)||(this.context=e.containerContext)}return Object.defineProperty(i.prototype,"paragraphMark",{get:function(){return"¶"},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"lineBreakMark",{get:function(){return"↲"},enumerable:!0,configurable:!0}),i.prototype.getEnSpaceCharacter=function(){return String.fromCharCode(8194)},i.prototype.repeatChar=function(e,t){for(var i="",r=0;r<t;r++)i+=e;return i},i.prototype.getParagraphMarkWidth=function(e){return this.getParagraphMarkSize(e).Width},i.prototype.getParagraphMarkSize=function(e){var t=this.getFormatText(e);if(this.paragraphMarkInfo[""+t])return this.paragraphMarkInfo[""+t];var i=this.getWidth(this.paragraphMark,e),r=this.getHeight(e),n={Width:i,Height:r.Height,BaselineOffset:r.BaselineOffset};return this.paragraphMarkInfo[""+t]=n},i.prototype.getTextSize=function(e,t){var i=0,r=t.bidi||this.isRTLText(e.text),n=this.setText(e.text,r,t.bdo);i=this.getWidth(n,t,e.scriptType),e.width=i;var o=this.getHeight(t,e.scriptType);return e.height=o.Height,e.baselineOffset=o.BaselineOffset," "===e.text[e.text.length-1]&&(i=this.getWidth(x.trimEnd(e.text),t,e.scriptType)),e.trimEndWidth=i,i},i.prototype.getHeight=function(e,t){var i=this.getFontNameToRender(t,e),r=this.getFormatText(e,i);if(!sf.base.isNullOrUndefined(this.documentHelper.heightInfoCollection[""+r]))return this.documentHelper.heightInfoCollection[""+r];var n=this.documentHelper.owner.textMeasureHelper.getHeightInternal(e,i);return this.documentHelper.heightInfoCollection[""+r]=n,n},i.prototype.getFormatText=function(e,t){var i="";return i=sf.base.isNullOrUndefined(t)?e.fontFamily.toLocaleLowerCase():t.toLocaleLowerCase(),i+=";"+e.fontSize,e.bold&&(i+=";bold"),e.italic&&(i+=";italic"),i},i.prototype.getHeightInternal=function(e){var t,i,r=document.createElement("span");r.innerText="m",this.applyStyle(r,e);var n=document.createElement("div");n.setAttribute("style","display:inline-block;position:absolute;");var o=document.createElement("div");o.setAttribute("style","display:inline-block;width: 1px; height: 0px;vertical-align: baseline;"),n.appendChild(r),n.appendChild(o),document.body.appendChild(n),t=r.offsetHeight;var s=r.offsetTop;return i=o.offsetTop-s,document.body.removeChild(n),{Height:t,BaselineOffset:i}},i.prototype.measureTextExcludingSpaceAtEnd=function(e,t,i){return this.getWidth(x.trimEnd(e),t,i)},i.prototype.getWidth=function(e,t,i){e.match("\v")&&e.replace("\v",this.lineBreakMark);var r,n,o,s=t.fontSize;return r=t.bold?"bold":"",n=t.italic?"italic":"",o=this.getFontNameToRender(i,t),s=0===s?.5:s/("Normal"===t.baselineAlignment?1:1.5),this.context.font=r+" "+n+" "+s+'pt "'+o+'"',t.allCaps&&(e=e.toUpperCase()),this.context.measureText(e).width},i.prototype.setText=function(e,t,i,r){if(sf.base.isNullOrUndefined(r)&&(r=!1),0===e.length)return"";var n=t;if(!n&&"RTL"===i||n&&"LTR"===i)e=x.reverseString(e);else if(r&&n&&x.endsWith(e)){var o=e.length-x.trimEnd(e).length;e=x.addSpace(o)+x.trimEnd(e)}return e},i.prototype.applyStyle=function(e,t){if(!sf.base.isNullOrUndefined(e)&&!sf.base.isNullOrUndefined(t)){var i="white-space:nowrap;";""!==t.fontFamily&&(i+="font-family:"+t.fontFamily+";");var r=t.fontSize;r<=.5&&(r=.5),i+="font-size:"+r.toString()+"pt;",t.bold&&(i+="font-weight:bold;"),t.italic&&(i+="font-style:italic;"),e.setAttribute("style",i)}},i.prototype.measureText=function(e,t,i){var r=this.getWidth(e,t,i),n=this.getHeight(t,i);return{Width:r,Height:n.Height,BaselineOffset:n.BaselineOffset}},i.prototype.updateTextSize=function(e,t){var i=new P(void 0),r=e.listLevel.characterFormat,n=t.characterFormat;i.fontSize=r.hasValue("fontSize")?r.fontSize:n.fontSize,i.fontFamily=r.hasValue("fontFamily")?r.fontFamily:n.fontFamily;var o,s,a="Normal"===r.baselineAlignment?n.baselineAlignment:r.baselineAlignment;o=r.hasValue("bold")?r.bold?"bold":"":n.bold?"bold":"",s=r.hasValue("italic")?r.italic?"italic":"":n.italic?"italic":"",i.baselineAlignment=a,o&&(i.bold=!0),s&&(i.italic=!0);var l=i.bidi||this.isRTLText(e.text),h=this.setText(e.text,l,i.bdo);e.width=this.getWidth(h,i);var d=this.getHeight(i);e.height=d.Height,e.baselineOffset=d.BaselineOffset},i.prototype.containsSpecialCharAlone=function(e){for(var t="*|.:[]{}-`;()@&$#%!~?, '",i=0;i<e.length;i++)if(-1===t.indexOf(e.charAt(i)))return!1;return!0},i.prototype.containsNumberAlone=function(e){if(""===e)return!1;for(var t=0;t<e.length;t++)if(-1==="0123456789".indexOf(e.charAt(t)))return!1;return!0},i.prototype.containsCombinationText=function(e){return!(!e.text.match(/^[0-9]+$/)||!e.paragraph.bidi)},i.prototype.inverseCharacter=function(e){switch(e){case"(":return")";case")":return"(";case"<":return">";case">":return"<";case"{":return"}";case"}":return"{";case"[":return"]";case"]":return"[";default:return e}},i.prototype.containsSpecialChar=function(e){for(var t="*|.:[]{}-`;()@&$#%!~? ",i=0;i<e.length;i++)if(-1!==t.indexOf(e.charAt(i)))return!0;return!1},i.prototype.isRTLText=function(e){var t=!1;if(!sf.base.isNullOrUndefined(e))for(var i=0;i<e.length;i++){var r=e[i];if(r>=String.fromCharCode(1424)&&r<=String.fromCharCode(1535)||r>=String.fromCharCode(64285)&&r<=String.fromCharCode(64335)||r>=String.fromCharCode(1536)&&r<=String.fromCharCode(1791)||r>=String.fromCharCode(1872)&&r<=String.fromCharCode(1919)||r>=String.fromCharCode(2208)&&r<=String.fromCharCode(2303)||r>=String.fromCharCode(64336)&&r<=String.fromCharCode(65023)||r>=String.fromCharCode(65136)&&r<=String.fromCharCode(65279)||r>=String.fromCharCode(43392)&&r<=String.fromCharCode(43487)||r>=String.fromCharCode(1792)&&r<=String.fromCharCode(1871)||r>=String.fromCharCode(1920)&&r<=String.fromCharCode(1983)||r>=String.fromCharCode(2112)&&r<=String.fromCharCode(2143)||r>=String.fromCharCode(1984)&&r<=String.fromCharCode(2047)||r>=String.fromCharCode(2048)&&r<=String.fromCharCode(2111)||r>=String.fromCharCode(11568)&&r<=String.fromCharCode(11647)){t=!0;break}}return t},i.prototype.getRtlLanguage=function(e){return sf.base.isNullOrUndefined(e)||""===e?{isRtl:!1,id:0}:e>=String.fromCharCode(1424)&&e<=String.fromCharCode(1535)?{isRtl:!0,id:1}:e>=String.fromCharCode(1536)&&e<=String.fromCharCode(1791)||e>=String.fromCharCode(1872)&&e<=String.fromCharCode(1919)||e>=String.fromCharCode(2208)&&e<=String.fromCharCode(2303)||e>=String.fromCharCode(64336)&&e<=String.fromCharCode(65023)||e>=String.fromCharCode(65136)&&e<=String.fromCharCode(65279)?{isRtl:!0,id:2}:e>=String.fromCharCode(43392)&&e<=String.fromCharCode(43487)?{isRtl:!0,id:3}:e>=String.fromCharCode(1792)&&e<=String.fromCharCode(1871)?{isRtl:!0,id:4}:e>=String.fromCharCode(1920)&&e<=String.fromCharCode(1983)?{isRtl:!0,id:5}:e>=String.fromCharCode(2112)&&e<=String.fromCharCode(2143)?{isRtl:!0,id:6}:e>=String.fromCharCode(1984)&&e<=String.fromCharCode(2047)?{isRtl:!0,id:7}:e>=String.fromCharCode(2048)&&e<=String.fromCharCode(2111)?{isRtl:!0,id:8}:e>=String.fromCharCode(11568)&&e<=String.fromCharCode(11647)?{isRtl:!0,id:9}:{isRtl:!1,id:0}},i.prototype.splitTextByConsecutiveLtrAndRtl=function(t,r,n,o,s,a){var l=o.length,h=[];if(sf.base.isNullOrUndefined(t)||""===t)return h;for(var d=-1,c="",p="",u="",g="",f=0;f<t.length;f++){var m=0,y=!1;(sf.base.isNullOrUndefined(s.value)?r:!s.value)&&this.isNumber(t[f])?(g+=t[f],m=4):this.isWordSplitChar(t[f])?(m=2,y=r||32==t.charCodeAt(f)&&""==u,u+=t[f]):this.isRTLText(t[f])&&!this.isNumber(t[f])?(s.value=!1,a.value=!0,p+=t[f],m=1):(s.value=!0,c+=t[f]),""!=g&&4!=m&&(h.push(g),o.push(e.Number),g=""),""!=p&&1!=m&&(h.push(p),o.push(e.RightToLeft),p=""),""!=c&&0!=m&&(h.push(c),d=h.length-1,o.push(e.LeftToRight),c=""),""==u||2==m&&!y||(h.push(u),o.push(e.WordSplit),u="")}if(""!=g?(h.push(g),o.push(e.Number)):""!=p?(h.push(p),o.push(e.RightToLeft)):""!=c?(h.push(c),d=h.length-1,o.push(e.LeftToRight)):""!=u&&(h.push(u),o.push(e.WordSplit)),a.value||!sf.base.isNullOrUndefined(s.value)&&!s.value)for(f=1;f<h.length;f++){(b=o[f+l])==e.WordSplit&&1==h[f].length&&f+l+1<o.length&&o[f+l-1]!=e.WordSplit&&(o[f+l-1]!=e.Number||i.isNumberNonReversingCharacter(h[f],r))&&o[f+l-1]==o[f+l+1]&&(h[f-1]=h[f-1]+h[f]+h[f+1],h.splice(f,1),h.splice(f,1),o.splice(f+l,1),o.splice(f+l,1),f--)}else if(-1!=d)if(r)for(f=1;f<d;f++){if((b=o[f+l])==e.WordSplit&&f<d&&o[f+l-1]==e.LeftToRight){c="";for(var v=f+1;v<=d;v++)c+=h[v],h.splice(v,1),o.splice(v+l,1),v--,d--;h[f-1]=h[f-1]+h[f]+c,h.splice(f,1),o.splice(f+l,1),f--,d--}}else h.length=0,h.push(t);else r||(h.length=0,h.push(t));if(r)for(f=1;f<h.length;f++){var b;(b=o[f+l])==e.WordSplit&&1==h[f].length&&f+l+1<o.length&&o[f+l-1]!=e.WordSplit&&(o[f+l-1]!=e.Number||i.isNumberNonReversingCharacter(h[f],r)||!n)&&o[f+l-1]==o[f+l+1]?(h[f-1]=h[f-1]+h[f]+h[f+1],h.splice(f,1),h.splice(f,1),o.splice(f+l,1),o.splice(f+l,1),f--):b==e.WordSplit&&o[f+l-1]==e.Number&&this.isNonWordSplitCharacter(h[f])&&!n?(h[f-1]=h[f-1]+h[f],h.splice(f,1),o.splice(f+l,1),f--):b!=e.LeftToRight||o[f+l-1]!=e.Number&&o[f+l-1]!=e.LeftToRight||(h[f-1]=h[f-1]+h[f],o[f+l-1]=e.LeftToRight,h.splice(f,1),o.splice(f+l,1),f--)}return h},i.prototype.isRightToLeftLanguage=function(e){return 14337==e||15361==e||5121==e||3073==e||2049==e||11265==e||13313==e||12289==e||4097==e||8193==e||16385==e||1025==e||10241==e||7169==e||9217==e||10655==e},i.prototype.isNumber=function(e){return!isNaN(parseInt(e,10))||(e>=String.fromCharCode(1632)&&e<=String.fromCharCode(1641)||e>=String.fromCharCode(1776)&&e<=String.fromCharCode(1785))},i.prototype.isWordSplitChar=function(e){for(var t=0;t<i.wordSplitCharacters.length;t++)if(i.wordSplitCharacters[t]===e)return!0;return!1},i.isNumberNonReversingCharacter=function(e,t){for(var r=0;r<i.numberNonReversingCharacters.length;r++){var n=i.numberNonReversingCharacters[r];if(e[0]==n&&(47!=n.charCodeAt(0)||!t))return!0}return!1},i.prototype.isNonWordSplitCharacter=function(e){for(var t=!1,i=0;i<e.length;i++){var r=e.charCodeAt(i);if(35!=r&&36!=r&&37!=r){t=!1;break}t=!0}return t},i.prototype.getFontNameToRender=function(e,t){return sf.base.isNullOrUndefined(e)?t.fontFamily:t.bidi||t.complexScript?this.getFontNameBidiToRender(e,t):this.isEastAsiaScript(e)?this.getFontNameEAToRender(e,t):t.fontFamily},i.prototype.isEastAsiaScript=function(e){return e==t.Japanese||e==t.Korean||e==t.Chinese},i.prototype.getFontNameEAToRender=function(e,t){var i=t.fontFamilyFarEast;return sf.base.isNullOrUndefined(i)||x.isThemeFont(i)?this.getFontNameFromTheme(t,i,e,r.EastAsia):i},i.prototype.getFontNameBidiToRender=function(e,t){var i=t.fontFamilyBidi;return!sf.base.isNullOrUndefined(i)||x.isThemeFont(i)?this.getFontNameFromTheme(t,i,e,r.CS):i},i.prototype.getFontNameFromTheme=function(e,t,i,r){var n;if(!this.documentHelper.hasThemes||sf.base.isNullOrUndefined(this.documentHelper.themes)||sf.base.isUndefined(this.documentHelper.themes.fontScheme)||(n=this.documentHelper.themes.fontScheme),"majorAscii"==t||"majorBidi"==t||"majorEastAsia"==t||"majorHAnsi"==t){var o=void 0;null!=n&&null!=n.majorFontScheme&&(o=n.majorFontScheme),t=this.updateFontNameFromTheme(e,o,i,t,r)}else if("minorAscii"==t||"minorBidi"==t||"minorEastAsia"==t||"minorHAnsi"==t){var s=void 0;null!=n&&null!=n.majorFontScheme&&(s=n.minorFontScheme),t=this.updateFontNameFromTheme(e,s,i,t,r)}return(sf.base.isNullOrUndefined(t)||x.isThemeFont(t))&&(t=R),t},i.prototype.updateFontNameFromTheme=function(e,t,i,n,o){var s="";return null!=t&&null!=t.fontSchemeList&&t.fontSchemeList.length>0&&t.fontSchemeList.forEach((function(e){("cs"!=e.name||"majorBidi"!=n&&"minorBidi"!=n)&&("ea"!=e.name||"majorEastAsia"!=n&&"minorEastAsia"!=n)&&("latin"!=e.name||"majorAscii"!=n&&"majorHAnsi"!=n&&"minorAscii"!=n&&"minorHAnsi"!=n)||(s=e.typeface)})),null!=t&&null!=t.fontTypeface&&(o==r.CS?t.fontTypeface.containsKey("Arab")&&(s=t.fontTypeface.get("Arab")):r.EastAsia),sf.base.isNullOrUndefined(s)&&(s=R),n=s},i.prototype.destroy=function(){this.documentHelper=void 0,this.context=void 0,this.paragraphMarkInfo={},this.paragraphMarkInfo=void 0},i.wordSplitCharacters=[String.fromCharCode(32),String.fromCharCode(33),String.fromCharCode(34),String.fromCharCode(35),String.fromCharCode(36),String.fromCharCode(37),String.fromCharCode(38),String.fromCharCode(39),String.fromCharCode(40),String.fromCharCode(41),String.fromCharCode(42),String.fromCharCode(43),String.fromCharCode(44),String.fromCharCode(45),String.fromCharCode(46),String.fromCharCode(47),String.fromCharCode(58),String.fromCharCode(59),String.fromCharCode(60),String.fromCharCode(61),String.fromCharCode(62),String.fromCharCode(63),String.fromCharCode(64),String.fromCharCode(91),String.fromCharCode(92),String.fromCharCode(93),String.fromCharCode(94),String.fromCharCode(95),String.fromCharCode(96),String.fromCharCode(123),String.fromCharCode(124),String.fromCharCode(125),String.fromCharCode(126),String.fromCharCode(1548),String.fromCharCode(1563),String.fromCharCode(8211),String.fromCharCode(8212),String.fromCharCode(8216),String.fromCharCode(8217),String.fromCharCode(8221),String.fromCharCode(12288),String.fromCharCode(8207)],i.numberNonReversingCharacters=[String.fromCharCode(44),String.fromCharCode(46),String.fromCharCode(47),String.fromCharCode(58),String.fromCharCode(1548)],i}(),k=function(){function e(e){var t=this;this.onMouseWheelInternal=function(e){if(!0===e.ctrlKey&&(e.preventDefault(),e.pageX-t.documentHelper.viewerContainer.offsetLeft<t.documentHelper.pageContainer.offsetWidth)){var i=void 0;void 0!==navigator&&(i=navigator.userAgent.match("Firefox"));var r=i?e.detail<0:sf.base.Browser.isIE?e.wheelDelta>0:e.deltaY<0,n=t.documentHelper.zoomFactor;r?n<=4.9?n+=.1:n=5:n>=.2?n-=.1:n=.1,t.documentHelper.zoomFactor=n}},this.documentHelper=e}return e.prototype.setZoomFactor=function(){this.onZoomFactorChanged(),sf.base.isNullOrUndefined(this.documentHelper.selection)||this.documentHelper.selection.updateCaretPosition(),this.documentHelper.updateTouchMarkPosition(),sf.base.isNullOrUndefined(this.documentHelper.owner.imageResizerModule)||this.documentHelper.owner.imageResizerModule.updateImageResizerPosition(),this.documentHelper.owner.fireZoomFactorChange()},Object.defineProperty(e.prototype,"viewer",{get:function(){return this.documentHelper.owner.viewer},enumerable:!0,configurable:!0}),e.prototype.onZoomFactorChanged=function(){this.documentHelper.zoomFactor>5?this.documentHelper.zoomFactor=5:this.documentHelper.zoomFactor<.1&&(this.documentHelper.zoomFactor=.1),this.zoom()},e.prototype.zoom=function(){var e=this.viewer;this.documentHelper.clearContent(),e.handleZoom(),this.documentHelper.updateFocus()},e}(),W=function(){function e(){this.mode=!0}return e.prototype.send=function(e){var t=this;this.xmlHttpRequest=new XMLHttpRequest,this.xmlHttpRequest.onreadystatechange=function(){t.stateChange(t)},this.xmlHttpRequest.onerror=function(){t.error(t)},this.mode?this.sendRequest(e):setTimeout((function(){t.sendRequest(e)}))},e.prototype.sendRequest=function(e){this.xmlHttpRequest.open("POST",this.url,!0),this.contentType&&this.xmlHttpRequest.setRequestHeader("Content-Type",this.contentType),this.setCustomAjaxHeaders(),this.responseType&&(this.xmlHttpRequest.responseType=this.responseType);var t=e instanceof FormData?e:JSON.stringify(e);this.xmlHttpRequest.send(t)},e.prototype.stateChange=function(e){if(4===e.xmlHttpRequest.readyState&&200===e.xmlHttpRequest.status){var t={name:"onSuccess",data:this.responseType?e.xmlHttpRequest.response:e.xmlHttpRequest.responseText,readyState:e.xmlHttpRequest.readyState,status:e.xmlHttpRequest.status};e.successHandler(t)}else if(4===e.xmlHttpRequest.readyState&&200!==e.xmlHttpRequest.status){t={name:"onFailure",status:e.xmlHttpRequest.status,statusText:e.xmlHttpRequest.statusText,url:e.url};e.failureHandler(t)}},e.prototype.error=function(e){var t={name:"onError",status:this.xmlHttpRequest.status,statusText:this.xmlHttpRequest.statusText};e.errorHandler(t)},e.prototype.successHandler=function(e){return this.onSuccess&&this.onSuccess(e),e},e.prototype.failureHandler=function(e){return this.onFailure&&this.onFailure(e),e},e.prototype.errorHandler=function(e){return this.onError&&this.onError(e),e},e.prototype.setCustomAjaxHeaders=function(){for(var e=0;e<this.customHeaders.length;e++)for(var t=this.customHeaders[e],i=0,r=Object.keys(t);i<r.length;i++){var n=r[i];this.xmlHttpRequest.setRequestHeader(n,t[n])}},e}(),R="Times New Roman",j=function(){function e(e){this.users=[],this.enableButtons=!0,this.sortedRevisions=[],this.noChangesVisibleInternal=!0,this.isTrackingPageBreak=!1,this.tableRevisions=new a,this.renderedChanges=new a,this.owner=e,this.selectedUser="All",this.selectedType="All"}return Object.defineProperty(e.prototype,"setNoChangesVisibility",{get:function(){return this.noChangesVisibleInternal},set:function(e){this.noChangeDivElement.style.display=e?"block":"none",this.noChangesVisibleInternal=e,this.enableDisableToolbarItem(!e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentSelectedRevision",{get:function(){return this.currentSelectedRevisionInternal},set:function(e){if(!sf.base.isNullOrUndefined(this.changesInfoDiv)){var t=sf.base.select(".e-de-trckchanges-inner-select",this.changesInfoDiv);if(sf.base.isNullOrUndefined(e))sf.base.isNullOrUndefined(t)||t.classList.remove("e-de-trckchanges-inner-select");else if(e!==this.currentSelectedRevisionInternal||sf.base.isNullOrUndefined(t)){if(t&&t.classList.remove("e-de-trckchanges-inner-select"),this.changes.length>0&&this.changes.containsKey(e))this.changes.get(e).singleInnerDiv.classList.add("e-de-trckchanges-inner-select")}this.currentSelectedRevisionInternal=e,t=sf.base.select(".e-de-trckchanges-inner-select",this.changesInfoDiv),sf.base.isNullOrUndefined(t)||t.parentElement.scrollIntoView({block:"nearest"})}},enumerable:!0,configurable:!0}),e.prototype.initTrackChangePane=function(){this.changes=new a,this.changesInfoDiv=this.owner.element.getElementsByClassName("e-de-tc-pane-revision")[0],this.changesInfoDiv||(this.changesInfoDiv=sf.base.createElement("div",{id:"e-de-tc-pane-revision",styles:"overflow:auto"})),this.noChangeDivElement=sf.base.createElement("div",{styles:"display:none;",className:"e-de-tc-no-chng"}),this.noChangeDivElement.textContent=this.owner.localeKeys.DocumentEditor_NoChanges,this.changesInfoDiv.appendChild(this.noChangeDivElement),this.updateTrackChanges()},e.prototype.enableDisableToolbarItem=function(e){},e.prototype.getSpanView=function(e,t){return(0===t?'<span class="e-de-track-span-user">':'<span class="e-de-track-span-view">')+e+"</span>"},e.prototype.onSelection=function(e){this.currentSelectedRevision=e},e.prototype.onUserSelect=function(e){this.selectedUser=e,this.sortCollectionToDisplay()},e.prototype.onMenuSelect=function(e){var t=this;"Accept all"===e?setTimeout((function(){t.owner.revisionsInternal.handleRevisionCollection(!0,t.sortedRevisions)})):"Reject all"===e&&setTimeout((function(){t.owner.revisionsInternal.handleRevisionCollection(!1,t.sortedRevisions)})),this.updateUsers()},e.prototype.onTypeSelect=function(e){this.selectedType=e,this.sortCollectionToDisplay()},e.prototype.updateMenuOptions=function(){"All"!==this.selectedType&&this.selectedType},e.prototype.sortCollectionToDisplay=function(){var e=!1;this.sortedRevisions=[],this.updateMenuOptions();for(var t=0;t<this.changes.length;t++){var i=this.changes.get(this.revisions[t]),r=i.outerSingleDiv;"All"===this.selectedUser&&"All"===this.selectedType?r.style.display="block":"All"===this.selectedUser&&"All"!==this.selectedType?i.revisionType===this.selectedType?r.style.display="block":r.style.display="none":"All"!==this.selectedUser&&"All"===this.selectedType?i.user===this.selectedUser?r.style.display="block":r.style.display="none":i.user===this.selectedUser&&i.revisionType===this.selectedType?r.style.display="block":r.style.display="none","block"===r.style.display&&this.sortedRevisions.push(this.revisions[t]),e=!0}this.setNoChangesVisibility=!e},e.prototype.enableDisableButton=function(e){this.enableButtons=e,this.updateTrackChanges()},e.prototype.isUpdateTrackChanges=function(e){var t=!1,i=!1;return sf.base.isNullOrUndefined(this.changesInfoDiv)||(1===this.changesInfoDiv.childNodes.length&&"e-de-tc-no-chng"===this.changesInfoDiv.childNodes[0].className?i=!0:e!==this.changesInfoDiv.childNodes.length&&(t=!0)),(i||e>0)&&(t=!0),t},e.prototype.updateTrackChanges=function(e){if(e||sf.base.isNullOrUndefined(e)){if(this.tableRevisions.clear(),this.renderedChanges.clear(),sf.base.isNullOrUndefined(this.changesInfoDiv))return;this.removeAllChanges();for(var t=0;t<this.owner.revisions.changes.length;t++){var i=this.owner.revisions.changes[t],r=this.owner.revisions.changes[t].range[0];if(!this.changes.containsKey(i))if(r instanceof C){var n=this.groupTableRevisions(this.owner.revisions.changes,t);if(n.length>1)for(var o=void 0,s=0;s<n.length;s++){var a=n[s];if(0===s)this.addChanges(a),o=this.changes.get(i);else{var l=a.range[0];o.appendRowToTable(l,s),this.revisions.push(a),this.changes.add(a,o)}this.tableRevisions.add(a,n)}else this.addChanges(i)}else this.addChanges(i)}for(t=0;t<this.renderedChanges.keys.length;t++){(o=this.renderedChanges.get(this.renderedChanges.keys[t])).updateRevisionIndexAndCount(t+1,this.renderedChanges.keys.length)}this.sortCollectionToDisplay(),this.updateUsers(),this.currentSelectedRevision=this.currentSelectedRevisionInternal,this.updateHeight(),this.owner.resize()}else this.currentSelectedRevision=void 0},e.prototype.groupTableRevisions=function(e,t){for(var i=e[t],r=[i],n=i.revisionType,o=i.range[0].ownerBase,s=o.ownerTable,a=o.index,l=this.owner.documentHelper.layout.getParentTable(s),h=t+1;h<e.length;h++){var d=e[h],c=d.revisionType,p=d.range[0];if(!(p instanceof C)){var u=void 0;if(p instanceof P?u=p.ownerBase:p instanceof ge&&(u=p.line.paragraph),u instanceof le&&u.isInsideTable){m=u.associatedCell.ownerTable;var g=this.owner.documentHelper.layout.getParentTable(m);if(s.equals(m)||!s.equals(m)&&l.equals(g))continue}break}var f=p.ownerBase,m=f.ownerTable,y=f.index;if(s.equals(m)||!l.equals(this.owner.documentHelper.layout.getParentTable(m))){if(n!==c||i.author!==d.author||!s.equals(m)||a+1!==y)break;r.push(d),a=y}}return r},e.prototype.updateUsers=function(){this.users.length>0&&(this.users=[]);for(var e=0;e<this.revisions.length;e++)-1===this.users.indexOf(this.revisions[e].author)&&this.users.push(this.revisions[e].author);this.owner.dotNetRef.invokeMethodAsync("UpdateRevisionUsers",this.users)},e.prototype.updateHeight=function(){var e=this.owner.getDocumentEditorElement(),t=0,i=this.owner.element.getElementsByClassName("e-de-review-pane")[0];if(i){var r=e.getBoundingClientRect();t=r.height>0?r.height:200;var n=i.getElementsByClassName("e-tab-header")[0].getBoundingClientRect().height,o=i.getElementsByClassName("e-de-track-toolbar")[0];o&&(this.changesInfoDiv.style.height=t-o.clientHeight-n-2+"px")}},e.prototype.removeAllChanges=function(){if(!sf.base.isNullOrUndefined(this.changesInfoDiv)){for(;this.changesInfoDiv.childNodes.length>1;)this.changesInfoDiv.removeChild(this.changesInfoDiv.lastChild);this.revisions=[],this.changes.clear()}},e.prototype.clear=function(){this.removeAllChanges(),this.selectedUser="All",this.selectedType="All",this.currentSelectedRevision=void 0},e.prototype.destroy=function(){this.removeAllChanges(),this.users.length>0&&(this.users=[]),this.tableRevisions&&(this.tableRevisions.destroy(),this.tableRevisions=void 0)},e.prototype.addChanges=function(e){if(!sf.base.isNullOrUndefined(this.changesInfoDiv)){var t=new U(this.owner,this);this.changesInfoDiv.appendChild(t.createSingleChangesDiv(e)),this.enableButtons?t.acceptButtonElement.classList.contains("e-de-overlay")&&!this.owner.documentHelper.isTrackedOnlyMode&&(t.acceptButtonElement.classList.remove("e-de-overlay"),t.rejectButtonElement.classList.remove("e-de-overlay")):t.acceptButtonElement.classList.contains("e-de-overlay")||(t.acceptButtonElement.classList.add("e-de-overlay"),t.rejectButtonElement.classList.add("e-de-overlay")),this.revisions.push(e),this.changes.add(e,t),this.renderedChanges.add(e,t)}},e.prototype.navigatePreviousChanges=function(){this.revisionNavigateInternal(!1)},e.prototype.navigateNextChanges=function(){this.revisionNavigateInternal(!0)},e.prototype.revisionNavigateInternal=function(e){var t=this.renderedChanges.keys;if(!this.currentSelectedRevisionInternal){if(0===t.length)return;this.currentSelectedRevision=t[0]}if(this.currentSelectedRevision){var i=t,r=this.currentSelectedRevision,n=i.indexOf(r);if(r=e?n===i.length-1?i[0]:i[n+1]:0===n?i[i.length-1]:i[n-1],this.owner.documentHelper.currentSelectedRevision=r,r.range[0]instanceof C){var o=this.groupTableRevisions(this.owner.revisions.changes,this.owner.revisions.changes.indexOf(r));this.owner.selection.selectTableRevision(o)}else this.owner.selection.selectRevision(r)}this.currentSelectedRevision=this.owner.documentHelper.currentSelectedRevision},e}(),U=function(){function e(e,t){this.owner=e,this.trackChangesPane=t}return e.prototype.updateRevisionIndexAndCount=function(e,t){this.changesCount.innerHTML=this.owner.localeKeys.DocumentEditor_Changes+" "+e.toString()+" "+this.owner.localeKeys.DocumentEditorContainer_Of+" "+t.toString()},e.prototype.createSingleChangesDiv=function(e){this.revision=e,this.user=e.author,this.outerSingleDiv=sf.base.createElement("div",{className:"e-de-tc-outer"}),this.singleInnerDiv=sf.base.createElement("div",{className:"e-de-trckchanges-inner"}),this.singleInnerDiv.addEventListener("click",this.selectRevision.bind(this)),this.outerSingleDiv.appendChild(this.singleInnerDiv);var t=sf.base.createElement("div",{className:"e-de-track-usernme-div"}),i=sf.base.createElement("div",{innerHTML:e.author,className:"e-de-track-user-nme"});sf.base.isNullOrUndefined(e.author)||(t.style.display="flex",this.owner.documentHelper.getAvatar(t,i,void 0,e));var r=sf.base.createElement("div");"Insertion"===e.revisionType?(this.revisionType="Inserted",r.innerHTML=this.owner.localeKeys.DocumentEditor_Inserted.toUpperCase(),r.classList.add("e-de-track-insert")):"Deletion"===e.revisionType?(this.revisionType="Deleted",r.innerHTML=this.owner.localeKeys.DocumentEditor_Deleted.toUpperCase(),r.classList.add("e-de-track-delete")):"MoveFrom"===e.revisionType?(this.revisionType="MoveFrom",r.innerHTML=this.owner.localeKeys.DocumentEditor_MoveFrom.toUpperCase(),r.classList.add("e-de-track-delete"),r.style.whiteSpace="nowrap"):"MoveTo"===e.revisionType&&(this.revisionType="MoveTo",r.innerHTML=this.owner.localeKeys.DocumentEditor_MoveTo.toUpperCase(),r.classList.add("e-de-track-insert"),r.style.whiteSpace="nowrap"),t.appendChild(r),this.singleInnerDiv.appendChild(t);var n=sf.base.createElement("div",{className:"e-de-track-date",innerHTML:x.getModifiedDate(e.date)});this.singleInnerDiv.appendChild(n);var o=sf.base.createElement("div",{className:"e-de-track-chngs-text"});this.layoutElementText(e.range,o),this.singleInnerDiv.appendChild(o);var s=sf.base.createElement("div",{styles:"display:inline-block;width:100%"});this.singleInnerDiv.appendChild(s);var a=sf.base.createElement("div",{styles:"float:left;"});this.acceptButtonElement=sf.base.createElement("button",{className:"e-de-track-accept-button e-btn e-lib e-control e-outline e-success"}),this.acceptButtonElement.textContent=this.owner.localeKeys.DocumentEditor_Accept,this.owner.documentHelper.isTrackedOnlyMode&&this.acceptButtonElement.classList.add("e-de-overlay"),a.appendChild(this.acceptButtonElement),s.appendChild(a),this.acceptButtonElement.addEventListener("click",this.acceptButtonClick.bind(this)),a=sf.base.createElement("div",{styles:"float:left;"}),this.rejectButtonElement=sf.base.createElement("button",{className:"e-de-track-reject-button e-btn e-lib e-control e-outline e-danger"}),this.rejectButtonElement.textContent=this.owner.localeKeys.DocumentEditor_Reject,this.owner.documentHelper.isTrackedOnlyMode&&this.rejectButtonElement.classList.add("e-de-overlay"),a.appendChild(this.rejectButtonElement),s.appendChild(a),this.rejectButtonElement.addEventListener("click",this.rejectButtonClick.bind(this)),this.changesCount=sf.base.createElement("div",{className:"e-de-track-chngs-count",styles:"float:right;"});var l=this.owner.revisions.changes.indexOf(e)+1,h=this.owner.revisions.changes.length;return this.changesCount.innerHTML=this.owner.localeKeys.DocumentEditor_Changes+" "+l.toString()+" "+this.owner.localeKeys.DocumentEditorContainer_Of+" "+h.toString(),s.appendChild(this.changesCount),this.outerSingleDiv},e.prototype.appendRowToTable=function(e,t){this.tableElement.insertRow();for(var i=0;i<e.ownerBase.childWidgets.length;i++)this.tableElement.rows[t].insertCell(),this.tableElement.rows[t].cells[i].classList.add("e-de-tc-tble-cell")},e.prototype.selectRevision=function(){if(this.revision.range[0]instanceof C){var e=this.trackChangesPane.groupTableRevisions(this.owner.revisions.changes,this.owner.revisions.changes.indexOf(this.revision));this.owner.selection.selectTableRevision(e)}else this.owner.selection.selectRevision(this.revision),this.trackChangesPane.onSelection(this.revision)},e.prototype.layoutElementText=function(e,t){t.style.width="100%";for(var i="",r=!1,n=0;n<e.length;n++){var o=e[n];if(o instanceof fe&&1===o.fieldType)r=!1;else if(!r)if(o instanceof fe&&0===o.fieldType&&(r=!0),o instanceof we)i+=o.text;else if(o instanceof fe&&0===o.fieldType){var s=this.owner.selection.getFieldCode(o);if(s.match("TOC ")||s.match("Toc"))return i+="<Table of Content>",void t.appendChild(this.addSpan(i));if(s.match("HYPERLINK ")||s.match("MERGEFIELD")||s.match("FORMTEXT")||s.match("PAGE "))i+=this.owner.editor.retrieveFieldResultantText(o.fieldEnd);else if(o.formFieldData){var a=this.owner.documentHelper.textHelper.repeatChar(this.owner.documentHelper.textHelper.getEnSpaceCharacter(),5);""!==i&&(t.appendChild(this.addSpan(i)),i=""),o.formFieldData instanceof ye?t.appendChild(this.addSpan(""===o.formFieldData.defaultValue?a:o.formFieldData.defaultValue,"e-de-tc-field")):o.formFieldData instanceof be?t.appendChild(this.addSpan(o.formFieldData.dropdownItems.length>0?o.formFieldData.dropdownItems[0]:a,"e-de-tc-field")):t.appendChild(this.addSpan(o.formFieldData.checked?String.fromCharCode(9745):String.fromCharCode(9744),"e-de-tc-field"))}}else if(o instanceof Re){""!==i&&(t.appendChild(this.addSpan(i)),i="");var l=sf.base.createElement("img");l.setAttribute("src",o.imageString),l.classList.add("e-de-tc-shrink-img"),t.appendChild(l)}else{if(o instanceof C){this.tableElement=sf.base.createElement("table"),this.tableElement.classList.add("e-de-track-chng-table"),this.tableElement.insertRow();for(var h=0;h<o.ownerBase.childWidgets.length;h++)this.tableElement.rows[0].insertCell(),this.tableElement.rows[0].cells[h].classList.add("e-de-tc-tble-cell");return void t.appendChild(this.tableElement)}if(o instanceof P){""!==i&&(t.appendChild(this.addSpan(i)),i="");var d="¶";o.ownerBase instanceof le&&o.ownerBase.isEndsWithPageBreak&&(d="............Page Break............"+d),t.appendChild(this.addSpan(d,"e-de-tc-pmark")),t.appendChild(sf.base.createElement("br"))}}}t.appendChild(this.addSpan(i))},e.prototype.addSpan=function(e,t){var i=sf.base.createElement("span");return i.textContent=e,t&&i.classList.add(t),i},e.prototype.acceptButtonClick=function(){this.trackChangesPane.changesInfoDiv.removeChild(this.outerSingleDiv),this.removeFromParentCollec(),this.revision.accept(),this.owner.enableHeaderAndFooter&&this.owner.editor.updateHeaderFooterWidget()},e.prototype.rejectButtonClick=function(){this.trackChangesPane.changesInfoDiv.removeChild(this.outerSingleDiv),this.removeFromParentCollec(),this.revision.reject(),this.owner.enableHeaderAndFooter&&this.owner.editor.updateHeaderFooterWidget()},e.prototype.removeFromParentCollec=function(){this.trackChangesPane.changes.remove(this.revision),this.trackChangesPane.revisions.splice(this.trackChangesPane.revisions.indexOf(this.revision),1),0===this.trackChangesPane.changes.length&&(this.trackChangesPane.setNoChangesVisibility=!0),this.trackChangesPane.updateUsers()},e}(),H=function(){function e(e){this.langIDInternal=0,this.enableSpellCheckInternal=!0,this.uniqueSpelledWords={},this.spellSuggestionInternal=!0,this.uniqueKey="",this.removeUnderlineInternal=!1,this.uniqueWordsCountInternal=15e3,this.performOptimizedCheck=!1,this.documentHelper=e,this.errorWordCollection=new a,this.uniqueWordsCollection=new a,this.errorSuggestions=new a,this.ignoreAllItems=[],this.uniqueSpelledWords={},this.textSearchResults=new Ut(this.documentHelper.owner),this.uniqueKey=this.documentHelper.owner.element.id+"_"+this.createGuid()}return e.prototype.getModuleName=function(){return"SpellChecker"},Object.defineProperty(e.prototype,"enableOptimizedSpellCheck",{get:function(){return this.performOptimizedCheck},set:function(e){this.performOptimizedCheck=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"uniqueWordsCount",{get:function(){return sf.base.isNullOrUndefined(this.uniqueWordsCountInternal)?0:this.uniqueWordsCountInternal},set:function(e){this.uniqueWordsCountInternal=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"languageID",{get:function(){return sf.base.isNullOrUndefined(this.langIDInternal)?0:this.langIDInternal},set:function(e){this.langIDInternal=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"allowSpellCheckAndSuggestion",{get:function(){return this.spellSuggestionInternal},set:function(e){this.spellSuggestionInternal=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"removeUnderline",{get:function(){return this.removeUnderlineInternal},set:function(e){this.removeUnderlineInternal=e,this.documentHelper.owner.editor.reLayout(this.documentHelper.selection)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"enableSpellCheck",{get:function(){return this.enableSpellCheckInternal},set:function(e){this.enableSpellCheckInternal=e,this.documentHelper.owner.editor.reLayout(this.documentHelper.selection)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"viewer",{get:function(){return this.documentHelper.owner.viewer},enumerable:!0,configurable:!0}),e.prototype.manageReplace=function(e,t){this.documentHelper.triggerSpellCheck=!0;if(!sf.base.isNullOrUndefined(t)&&t instanceof Ne){var i=t.text;if(this.documentHelper.selection.start=t.start,this.documentHelper.selection.end=t.end,"Ignore Once"!==e)return e=this.manageSpecialCharacters(i,e),this.documentHelper.owner.editor.insertTextInternal(e,!0),this.documentHelper.selection.start.setPositionInternal(this.documentHelper.selection.end),void this.documentHelper.clearSelectionHighlight();this.currentContextInfo={text:i,element:t}}if(!sf.base.isNullOrUndefined(this.currentContextInfo)&&this.currentContextInfo.element&&"Ignore Once"!==e){var r=this.currentContextInfo.element;this.currentContextInfo.element.text,this.documentHelper.selection.start=r.start,this.documentHelper.selection.end=r.end}else this.handleReplace(e);"Ignore Once"!==e&&(this.documentHelper.owner.editor.insertTextInternal(e,!0),sf.base.isNullOrUndefined(this.currentContextInfo)||this.removeErrorsFromCollection(this.currentContextInfo),this.documentHelper.selection.start.setPositionInternal(this.documentHelper.selection.end),this.documentHelper.clearSelectionHighlight()),this.documentHelper.triggerSpellCheck=!1},e.prototype.handleReplace=function(e){var t=this.documentHelper.selection.start,i=t.offset,r=t.currentWidget.getInline(i,0,!1,!0);r.element.line.getOffset(r.element,0)+r.element.length===i&&this.retrieveExactElementInfo(r);for(var n,o=r.element.text,s=new RegExp("^[#\\@\\!\\~\\$\\%\\^\\&\\*\\(\\)\\-\\_\\+\\=\\{\\}\\[\\]\\:\\;\\\"'\\,\\<\\.\\>\\/\\?\\`\\s]+","g"),a=[];!sf.base.isNullOrUndefined(n=s.exec(o));)a.push(n);if("Ignore Once"!==e){t.offset=i-r.index,!sf.base.isNullOrUndefined(a)&&a.length>0&&(t.offset+=a[0].toString().length),t.location=this.documentHelper.owner.selection.getPhysicalPositionInternal(t.currentWidget,t.offset,!0),(t=this.documentHelper.owner.searchModule.textSearch.getTextPosition(t.currentWidget,t.offset.toString())).setPositionParagraph(t.currentWidget,t.offset);var l=t.offset+r.element.length-t.offset,h=t.currentWidget.getOffset(r.element,l),d=t.currentWidget,c=new RegExp("[#\\@\\!\\~\\$\\%\\^\\&\\*\\(\\)\\-\\_\\+\\=\\{\\}\\[\\]\\:\\;\\\"'\\,\\<\\.\\>\\/\\?\\s\\`]+$","g");for(a=[];!sf.base.isNullOrUndefined(n=c.exec(o));)a.push(n);!sf.base.isNullOrUndefined(a)&&a.length>0&&(h-=a[0].toString().length),this.documentHelper.selection.end=this.documentHelper.owner.searchModule.textSearch.getTextPosition(d,h.toString()),this.documentHelper.selection.end.location=this.documentHelper.owner.selection.getPhysicalPositionInternal(t.currentWidget,h,!0),this.documentHelper.selection.end.setPositionParagraph(d,h),this.currentContextInfo={element:r.element,text:r.element.text}}else this.handleIgnoreOnce(r)},e.prototype.retrieveExactElementInfo=function(e){var t=e.element.nextElement;!sf.base.isNullOrUndefined(t)&&t instanceof we&&(""!=t.text.trim()&&(e.element=t))},e.prototype.handleIgnoreOnce=function(e){var t=e.element,i="";i=!sf.base.isNullOrUndefined(this.currentContextInfo)&&this.currentContextInfo.element?this.currentContextInfo.element.text:t.text,i=this.manageSpecialCharacters(i,void 0,!0),-1===t.ignoreOnceItems.indexOf(i)&&t.ignoreOnceItems.push(i),this.documentHelper.owner.editor.reLayout(this.documentHelper.selection)},e.prototype.handleIgnoreAllItems=function(e){var t=sf.base.isNullOrUndefined(e)?this.retriveText():e,i=this.manageSpecialCharacters(t.text,void 0,!0);-1===this.ignoreAllItems.indexOf(i)&&(this.ignoreAllItems.push(i),this.removeErrorsFromCollection(t),this.documentHelper.triggerSpellCheck=!0,this.documentHelper.owner.editor.reLayout(this.documentHelper.selection),this.documentHelper.triggerSpellCheck=!1,this.documentHelper.clearSelectionHighlight())},e.prototype.handleAddToDictionary=function(e){var t=this,i=sf.base.isNullOrUndefined(e)?this.retriveText():e,r=this.manageSpecialCharacters(i.text,void 0,!0);this.callSpellChecker(this.languageID,r,!1,!1,!0).then((function(e){t.documentHelper.triggerSpellCheck=!0,t.removeErrorsFromCollection(i),t.ignoreAllItems.push(r),t.documentHelper.owner.editor.reLayout(t.documentHelper.selection,!0),t.documentHelper.triggerSpellCheck=!1}))},e.prototype.manageSpecialCharacters=function(e,t,i){if(!sf.base.isNullOrUndefined(e)){sf.base.isNullOrUndefined(t)&&(t=e);for(var r=new RegExp("[#\\@\\!\\$\\%\\^\\&\\*\\(\\)\\-\\_\\+\\=\\{\\}\\[\\]\\:\\;\\\"\\”'\\,\\<\\.\\>\\/\\?\\`\\s\\’]+","g"),n=[],o=void 0;!sf.base.isNullOrUndefined(o=r.exec(e));)n.push(o);if(n.length>0)for(var s=0;s<n.length;s++){var a=n[s];t=i?t.replace(a[0],""):a[0]+t}var l=new RegExp("[#\\@\\!\\$\\%\\^\\&\\*\\(\\)\\-\\_\\+\\=\\{\\}\\[\\]\\:\\;\\\"\\”'\\,\\<\\.\\>\\/\\?\\s\\`\\’]+$","g");for(n=[];!sf.base.isNullOrUndefined(o=l.exec(t));)n.push(o);if(n.length>0)for(s=0;s<n.length;s++){a=n[s];t=i?t.slice(0,a.index):t+a[0]}}return t},e.prototype.removeErrorsFromCollection=function(e){if(!sf.base.isNullOrUndefined(e.text)&&this.errorWordCollection.containsKey(e.text)){var t=this.errorWordCollection.get(e.text);t.indexOf(e.element)>=0&&t.splice(0,1),0===t.length&&this.errorWordCollection.remove(e.text)}},e.prototype.retriveText=function(){var e,t;if(!sf.base.isNullOrUndefined(this.currentContextInfo)&&this.currentContextInfo.element)t=this.currentContextInfo.element,e=this.currentContextInfo.element.text,this.documentHelper.selection.start=t.start,this.documentHelper.selection.end=t.end;else{var i=this.documentHelper.selection.start,r=i.offset,n=i.currentWidget.getInline(r,0);t=n.element,e=n.element.text}return{text:e,element:t}},e.prototype.handleSuggestions=function(e){this.spellCheckSuggestion=[],0===e.length||(e=e.length>3?this.constructInlineMenu(e):e),this.spellCheckSuggestion.push("Add to Dictionary");var t=[];if(this.spellCheckSuggestion.length>0)for(var i=0,r=this.spellCheckSuggestion;i<r.length;i++){var n=r[i];t.push({text:n,id:this.documentHelper.owner.element.id+"_contextmenu_otherSuggestions_spellcheck_"+n,iconCss:""})}return t},e.prototype.checktextElementHasErrors=function(e,t,i){var r=!1,n=[];if(e=e.replace(/[\s]+/g,""),!sf.base.isNullOrUndefined(t.errorCollection)&&t.errorCollection.length>0){if(!this.documentHelper.isScrollHandler&&(t.ischangeDetected||t.paragraph.isChangeDetected))return this.updateStatusForGlobalErrors(t.errorCollection,t),t.errorCollection=[],t.ischangeDetected=!0,{errorFound:r,elements:n};for(var o=0;o<t.errorCollection.length;o++)this.handleErrorCollection(t.errorCollection[o])&&(r=!0,n.push(t.errorCollection[o]))}else!this.documentHelper.isScrollHandler&&t.paragraph.isChangeDetected?t.ischangeDetected=!0:!t.ischangeDetected&&this.handleErrorCollection(t)&&(r=!0,n.push(t));return{errorFound:r,elements:n}},e.prototype.updateStatusForGlobalErrors=function(e,t){if(e.length>0)for(var i=0;i<e.length;i++){var r=this.manageSpecialCharacters(e[i].text,void 0,!0);if(this.errorWordCollection.containsKey(r))for(var n=this.errorWordCollection.get(r),o=0;o<n.length;o++)if(n[o]instanceof Ne&&n[o]===e[i]){n[o].ischangeDetected=!0,n[o].start.offset=t.line.getOffset(t.istextCombined?this.getCombinedElement(t):t,0),n[o].line=t.line;break}}},e.prototype.handleErrorCollection=function(e){var t=this.errorWordCollection,i=this.manageSpecialCharacters(e.text,void 0,!0);return!!(t.containsKey(i)&&e.length>1)&&(!(this.ignoreAllItems.indexOf(i)>-1)||(t.containsKey(i)&&t.remove(i),!1))},e.prototype.constructInlineMenu=function(e){for(var t=e.length-1;t>0;t--)e.length>3&&(this.spellCheckSuggestion.push(e[t]),e.pop());return e},e.prototype.findCurretText=function(){var e,t,i=this.documentHelper.selection.start,r=i.currentWidget.getInline(this.documentHelper.selection.start.offset,0);if(!sf.base.isNullOrUndefined(r.element)){if(!sf.base.isNullOrUndefined(r.element.errorCollection)&&r.element.errorCollection.length>0)for(var n=0;n<r.element.errorCollection.length;n++){var o=r.element.errorCollection[n];if(o.start.location.x<=i.location.x&&o.end.location.x>=i.location.x){t=o.text,e=o;break}}else t=r.element.text;" "===t&&(t=(r=i.currentWidget.getInline(this.documentHelper.selection.start.offset+1,0)).element.text)}return{text:t,element:e}},e.prototype.addErrorCollection=function(e,t,i){if(e=this.manageSpecialCharacters(e,void 0,!0),this.errorWordCollection.containsKey(e)){var r=this.errorWordCollection.get(e);t instanceof Ne?this.compareErrorTextElement(t,r)||r.push(t):t instanceof we&&(this.compareTextElement(t,r)||r.push(t))}else!sf.base.isNullOrUndefined(i)&&i.length>0&&this.errorSuggestions.add(e,i),this.errorWordCollection.add(e,[t]),this.uniqueWordsCollection.containsKey(e)||this.uniqueWordsCollection.add(e,!0)},e.prototype.addCorrectWordCollection=function(e){e=this.manageSpecialCharacters(e,void 0,!0),this.uniqueWordsCollection.containsKey(e)||this.uniqueWordsCollection.add(e,!1)},e.prototype.isInUniqueWords=function(e){return e=e.replace(/[\s]+/g,""),this.uniqueWordsCollection.containsKey(e)},e.prototype.isErrorWord=function(e){return e=e.replace(/[\s]+/g,""),this.uniqueWordsCollection.get(e)},e.prototype.isCorrectWord=function(e){return e=e.replace(/[\s]+/g,""),!this.uniqueWordsCollection.get(e)},e.prototype.compareErrorTextElement=function(e,t){for(var i=[],r=!1,n=0;n<t.length;n++)i.push(t[n]);var o=t.length;for(n=0;n<o;n++)if(i[n]instanceof Ne)if(i[n].ischangeDetected){var s=this.manageSpecialCharacters(i[n].text,void 0,!0);r=!0,this.removeErrorsFromCollection({element:i[n],text:s})}else{var a=i[n];if(e.start.offset===a.start.offset&&e.end.offset===a.end.offset)return!0}return r&&this.errorWordCollection.add(this.manageSpecialCharacters(e.text,void 0,!0),[e]),!1},e.prototype.compareTextElement=function(e,t){for(var i=0;i<t.length;i++){if(t[i]instanceof we)if(t[i]===e)return!0}return!1},e.prototype.handleWordByWordSpellCheck=function(e,t,i,r,n,o,s){if(e.HasSpellingError&&s){this.addErrorCollection(t.text,t,e.Suggestions);var a=t.line.paragraph.containerWidget instanceof pe?t.line.paragraph.containerWidget.cellFormat.shading.backgroundColor:this.documentHelper.backgroundColor;this.documentHelper.render.renderWavyLine(t,i,r,n,"#FF0000","Single",o,a),t.isSpellChecked=!0}else this.addCorrectWordCollection(t.text),t.isSpellChecked=!0},e.prototype.checkElementCanBeCombined=function(e,t,i,r,n,o,s,a){var l=sf.base.isNullOrUndefined(n)?"":n,h=!sf.base.isNullOrUndefined(a)&&a,d=!!sf.base.isNullOrUndefined(s)||s,c=!!sf.base.isNullOrUndefined(o)||o,p=[],u=this.documentHelper.selection.getLineWidget(e,0),g=u.children.indexOf(e),f=e.text;p.push(e);var m=s?0:1,y=!1,v=!1;if("\v"!==e.text){if(d){for(var b=void 0,w=g-m;w>=0;w--)if((b=u.children[w])instanceof we&&!v){if(0!==f.indexOf(" ")&&b.text.lastIndexOf(" ")!==b.text.length-1)y=!sf.base.isNullOrUndefined(n),l=b.text+l,f=b.text,v=!1,p.push(b),h=!0;else if(!sf.base.isNullOrUndefined(b)){b=b.nextElement;break}}else b instanceof fe&&1!==b.fieldType&&(v=!0);var x=h?b:e;if(this.lookThroughPreviousLine(l,f,x,t,i))return!0}s?l=y?l:e.text+l:l+=e.text,v=!1;var M=e.text;if(c){var N=!1,I=void 0;for(w=g+1;w<u.children.length;w++)if((I=u.children[w])instanceof we&&!v){if(M.lastIndexOf(" ")!==M.length-1&&0!==I.text.indexOf(" "))l+=I.text,M=I.text,v=!1,p.push(I),N=!0,h=!0;else if(!sf.base.isNullOrUndefined(I)){I=I.previousElement;break}}else I instanceof fe&&2!==I.fieldType&&(v=!0);if("\f"!==(x=N?I:e).text&&x.text!==String.fromCharCode(14)&&this.lookThroughNextLine(l,f,x,t,i))return!0}}return h&&r&&!this.checkCombinedElementsBeIgnored(p,l)&&this.handleCombinedElements(e,l,t,i),h},e.prototype.lookThroughPreviousLine=function(e,t,i,r,n){if(!sf.base.isNullOrUndefined(i)&&0===i.indexInOwner&&!sf.base.isNullOrUndefined(i.line.previousLine)){var o=i.line.previousLine,s=o.children.length-1;if(!sf.base.isNullOrUndefined(o.children[s])&&o.children[s]instanceof we){var a=o.children[s];if(!sf.base.isNullOrUndefined(i.text)&&0!==i.text.indexOf(" ")&&a.text.lastIndexOf(" ")!==a.text.length-1)return e=e.length>0?e:t,this.checkElementCanBeCombined(a,r,n,!0,e,!1,!0,!0),!0}}return!1},e.prototype.lookThroughNextLine=function(e,t,i,r,n){if(!sf.base.isNullOrUndefined(i)&&i.indexInOwner===i.line.children.length-1&&!sf.base.isNullOrUndefined(i.line.nextLine)){var o=i.line.nextLine;if(!sf.base.isNullOrUndefined(o.children[0])&&o.children[0]instanceof we){var s=o.children[0];if(i.text.lastIndexOf(" ")!==i.text.length-1&&0!==s.text.indexOf(" "))return e=e.length>0?e:t,this.checkElementCanBeCombined(s,r,n,!0,e,!0,!1,!0),!0}}return!1},e.prototype.handleCombinedElements=function(e,t,i,r){e.istextCombined=!0;var n=t.split(/[\s]+/);if(-1===this.ignoreAllItems.indexOf(t)&&e instanceof we&&-1===e.ignoreOnceItems.indexOf(t))if(n.length>1)for(var o=0;o<n.length;o++){var s=n[o];s=this.manageSpecialCharacters(s,void 0,!0),this.documentHelper.render.handleUnorderedElements(s,e,i,o,0,o===n.length-1,r)}else t=this.manageSpecialCharacters(t,void 0,!0),this.documentHelper.render.handleUnorderedElements(t,e,i,0,0,!0,r)},e.prototype.checkArrayHasSameElement=function(e,t){for(var i=0;i<e.length;i++){var r=e[i];if(r.start.location.x===t.start.location.x&&r.start.location.y===t.start.location.y)return!0}return!1},e.prototype.handleSplitWordSpellCheck=function(e,t,i,r,n,o,s,a){if(e.HasSpellingError&&" "!==i.text&&r){var l=this.getMatchedResultsFromElement(i,t);s=i.istextCombined?i.line.getOffset(this.getCombinedElement(i),0):s,this.documentHelper.owner.searchModule.textSearch.updateMatchedTextLocation(l.matches,l.textResults,l.elementInfo,0,i,!1,null,s),this.handleMatchedResults(l.textResults,i,n,o,e.Suggestions,a)}else this.addCorrectWordCollection(t),a&&(i.isSpellChecked=!0);this.updateUniqueWords([{Text:t,HasSpellError:e.HasSpellingError}])},e.prototype.handleMatchedResults=function(e,t,i,r,n,o){if(0===e.length&&o)t.isSpellChecked=!0;else for(var s=0;s<e.length;s++){var a=this.createErrorElementWithInfo(e.innerList[s],t);sf.base.isNullOrUndefined(t.errorCollection)||this.checkArrayHasSameElement(t.errorCollection,a)||t.errorCollection.splice(r,0,a),this.addErrorCollection(a.text,a,n);var l=t.line.paragraph.containerWidget instanceof pe?t.paragraph.containerWidget.cellFormat.shading.backgroundColor:this.documentHelper.backgroundColor;this.documentHelper.render.renderWavyLine(a,a.start.location.x,a.start.location.y-t.margin.top,i,"#FF0000","Single",t.characterFormat.baselineAlignment,l),o&&(t.isSpellChecked=!0)}},e.prototype.callSpellChecker=function(e,t,i,r,n,o){var s=this,a=this;return new Promise((function(l,h){if(!sf.base.isNullOrUndefined(s)){var d=new XMLHttpRequest,c=s.documentHelper.owner.serviceUrl+s.documentHelper.owner.serverActionSettings.spellCheck;c=o?c+"ByPage":c,d.open("POST",c,!0),d.setRequestHeader("Content-Type","application/json"),s.setCustomHeaders(d);var p={LanguageID:e,TexttoCheck:t,CheckSpelling:i,CheckSuggestion:r,AddWord:n};d.send(JSON.stringify(p)),d.onreadystatechange=function(){if(4===d.readyState)if(200===d.status||304===d.status)l(d.response);else{var e={name:"onFailure",status:d.status,statusText:d.responseText,url:c};a.documentHelper.owner.fireServiceFailure(e),h(d.response)}}}}))},e.prototype.setCustomHeaders=function(e){for(var t=0;t<this.documentHelper.owner.headers.length;t++)for(var i=this.documentHelper.owner.headers[t],r=0,n=Object.keys(i);r<n.length;r++){var o=n[r];e.setRequestHeader(o,i[o])}},e.prototype.checkForNextError=function(){if(!sf.base.isNullOrUndefined(this.viewer)){var e=this.errorWordCollection;if(e.length>0)for(var t=0;t<e.length;t++){for(var i=e.get(e.keys[t]),r=0;r<i.length;r++){if(i[r]instanceof Ne&&!i[r].ischangeDetected)this.updateErrorElementTextBox(e.keys[t],i[r]);else if(i[r]instanceof we){var n=this.getMatchedResultsFromElement(i[r]),o=n.textResults,s=i[r].ischangeDetected?i[r].start.offset:i[r].line.getOffset(i[r],0);this.documentHelper.owner.searchModule.textSearch.updateMatchedTextLocation(n.matches,o,n.elementInfo,0,i[r],!1,null,s);for(var a=0;a<o.length;a++){var l=this.createErrorElementWithInfo(o.innerList[a],i[r]);this.updateErrorElementTextBox(l.text,l);break}}break}break}else this.documentHelper.clearSelectionHighlight()}},e.prototype.createErrorElementWithInfo=function(e,t){var i=new Ne;return i.text=e.text,i.start=e.start,i.end=e.end,i.height=t.height,i.canTrigger=t.canTrigger,i.characterFormat.copyFormat(t.characterFormat),i.width=this.documentHelper.textHelper.getWidth(i.text,t.characterFormat,t.scriptType),i},e.prototype.getMatchedResultsFromElement=function(e,t){var i=e.line,r=this.documentHelper.owner.searchModule.textSearch.stringToRegex(sf.base.isNullOrUndefined(t)?e.text:t,"CaseSensitive");this.textSearchResults.clearResults();for(var n,o=this.textSearchResults,s=this.documentHelper.owner.searchModule.textSearch.getElementInfo(i.children[0],0,!1),a=s.fullText,l=[],h=s.elementsWithOffset;!sf.base.isNullOrUndefined(n=r.exec(a));)l.push(n);return{matches:l,elementInfo:h,textResults:o}},e.prototype.updateErrorElementTextBox=function(e,t){var i=t;this.documentHelper.clearSelectionHighlight(),this.documentHelper.selection.start=i.start,this.documentHelper.selection.end=i.end,this.documentHelper.selection.highlight(t.start.paragraph,t.start,t.end)},e.prototype.getWhiteSpaceCharacterInfo=function(e){var t,i=e.text,r=e.characterFormat,n=0,o=0;if(t=i.match(/[\s]+/),!sf.base.isNullOrUndefined(t)&&t.length>0)for(var s=0;s<t.length;s++)n+=this.documentHelper.textHelper.getWidth(t[s],r,e.scriptType),o+=t[s].length;return{width:n,wordLength:o,isBeginning:!sf.base.isNullOrUndefined(t)&&0===t.index}},e.prototype.getSpecialCharactersInfo=function(e){var t=e.text,i=e.characterFormat,r=[],n=0,o=0,s=0;r=t.match(/^[\#\@\!\~\$\%\^\&\*\(\)\-\_\+\=\{\}\[\]\:\;\"\'\,\<\.\>\/\?\`]*/);for(var a=0;a<r.length;a++)!sf.base.isNullOrUndefined(r[a])&&r[a].length>0&&(n=this.documentHelper.textHelper.getWidth(r[a],i,e.scriptType)),s=r.length;r=t.match(/[\#\@\!\~\$\%\^\&\*\(\)\-\_\+\=\{\}\[\]\:\;\"\'\,\<\.\>\/\?\`]*$/);for(a=0;a<r.length;a++)!sf.base.isNullOrUndefined(r[a])&&r[a].length>0&&(o=this.documentHelper.textHelper.getWidth(r[a],i,e.scriptType)),s=r.length;return{beginningWidth:n,endWidth:o,wordLength:s}},e.prototype.getCombinedElement=function(e){for(var t=e;!sf.base.isNullOrUndefined(e)&&e instanceof we&&e.istextCombined;)t=e,e=e.previousElement;return t},e.prototype.checkCombinedElementsBeIgnored=function(e,t){t=this.manageSpecialCharacters(t,void 0,!0);for(var i=0;i<e.length;i++)if(-1!==e[i].ignoreOnceItems.indexOf(t))return!0;return!1},e.prototype.updateSplittedElementError=function(e,t){var i=e.errorCollection.length;if(i>0){for(var r=[],n=0;n<i;n++)r.push(e.errorCollection[n]);for(n=0;n<i;n++)-1===e.text.indexOf(r[n].text)&&(t.ischangeDetected=!0,e.errorCollection.splice(0,1))}},e.prototype.getPageContent=function(e){var t="";if(this.documentHelper.owner.sfdtExportModule){var i=this.documentHelper.owner.sfdtExportModule;i.Initialize();var r=i.writePage(e);if(this.documentHelper.owner.textExportModule){var n=this.documentHelper.owner.textExportModule;n.pageContent="",n.setDocument(r),n.writeInternal(),t=n.pageContent}}return t},e.prototype.updateUniqueWords=function(e){if(sf.base.isNullOrUndefined(localStorage.getItem(this.uniqueKey))||(this.uniqueSpelledWords=JSON.parse(localStorage.getItem(this.uniqueKey))),this.uniqueSpelledWords=this.uniqueSpelledWords||{},e.length+Object.keys(this.uniqueSpelledWords).length<=this.uniqueWordsCount)for(var t=0;t<e.length;t++)this.checkForUniqueWords(e[t]);localStorage.setItem(this.uniqueKey,JSON.stringify(this.uniqueSpelledWords)),this.uniqueSpelledWords={}},e.prototype.checkForUniqueWords=function(e){this.uniqueSpelledWords[e.Text]||(this.uniqueSpelledWords[e.Text]=e.HasSpellError)},e.prototype.clearCache=function(){sf.base.isNullOrUndefined(localStorage.getItem(this.uniqueKey))||localStorage.removeItem(this.uniqueKey)},e.prototype.createGuid=function(){var e=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var i=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"===t?i:3&i|8).toString(16)}))},e.prototype.checkSpellingInPageInfo=function(e){var t=JSON.parse(localStorage.getItem(this.uniqueKey));return sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t[e])?{hasSpellError:!1,isElementPresent:!1}:{hasSpellError:t[e],isElementPresent:!0}},e.prototype.destroy=function(){this.errorWordCollection=void 0,this.ignoreAllItems=void 0,this.errorSuggestions=void 0,this.uniqueWordsCollection=void 0,this.uniqueSpelledWords={},this.textSearchResults=void 0,sf.base.isNullOrUndefined(localStorage.getItem(this.uniqueKey))||localStorage.removeItem(this.uniqueKey)},e}(),B=function(){function e(){this.fntTypeface=new a,this.fntSchemeList=[],this.fntTypeface=new a,this.fntSchemeList=[]}return Object.defineProperty(e.prototype,"fontTypeface",{get:function(){return this.fntTypeface},set:function(e){this.fntTypeface=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fontSchemeList",{get:function(){return this.fntSchemeList},set:function(e){this.fntSchemeList=e},enumerable:!0,configurable:!0}),e.prototype.copyFormat=function(e){sf.base.isNullOrUndefined(e)||(this.fntTypeface=e.fntTypeface,this.fntSchemeList=e.fntSchemeList)},e.prototype.destroy=function(){this.fntTypeface=void 0,this.fntSchemeList=void 0},e}(),_=function(){function e(){this.majFontScheme=new B,this.minFontScheme=new B}return Object.defineProperty(e.prototype,"fontSchemeName",{get:function(){return this.schemeName},set:function(e){this.schemeName=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"majorFontScheme",{get:function(){return this.majFontScheme},set:function(e){this.majFontScheme=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"minorFontScheme",{get:function(){return this.minFontScheme},set:function(e){this.minFontScheme=e},enumerable:!0,configurable:!0}),e.prototype.copyFormat=function(e){sf.base.isNullOrUndefined(e)||(this.schemeName=e.schemeName,this.majFontScheme.copyFormat(e.majFontScheme),this.minFontScheme.copyFormat(e.minFontScheme))},e.prototype.destroy=function(){this.schemeName=void 0,this.majFontScheme=void 0,this.minFontScheme=void 0},e}(),V=function(){function e(){}return Object.defineProperty(e.prototype,"name",{get:function(){return this.fontName},set:function(e){this.fontName=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"typeface",{get:function(){return this.fontTypeface},set:function(e){this.fontTypeface=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"panose",{get:function(){return this.pnose},set:function(e){this.pnose=e},enumerable:!0,configurable:!0}),e.prototype.copyFormat=function(e){sf.base.isNullOrUndefined(e)||(this.fontName=e.fontName,this.fontTypeface=e.fontTypeface,this.pnose=e.panose)},e.prototype.destroy=function(){this.fontName=void 0,this.fontTypeface=void 0,this.pnose=void 0},e}(),Y=function(){function e(){this.fntScheme=new _}return Object.defineProperty(e.prototype,"fontScheme",{get:function(){return this.fntScheme},set:function(e){this.fntScheme=e},enumerable:!0,configurable:!0}),e.prototype.copyFormat=function(e){sf.base.isNullOrUndefined(e)||this.fntScheme.copyFormat(e.fntScheme)},e.prototype.destroy=function(){this.fntScheme=void 0},e}(),Q=(y=function(e,t){return(y=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}y(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),q=function(){function e(e){var t=this;this.scrollbarWidth=0,this.isWebPrinting=!1,this.isHeaderFooter=!1,this.currentPage=void 0,this.selectionStartPageIn=void 0,this.selectionEndPageIn=void 0,this.fieldStacks=[],this.showRevision=!1,this.splittedCellWidgets=[],this.tableLefts=[],this.tapCount=0,this.timer=-1,this.isTimerStarted=!1,this.isFirstLineFitInShiftWidgets=!1,this.preZoomFactor=0,this.preDifference=-1,this.fieldEndParagraph=void 0,this.fieldToLayout=void 0,this.backgroundColor="#FFFFFF",this.isMouseDown=!1,this.isMouseEntered=!1,this.scrollMoveTimer=0,this.isSelectionChangedOnMouseMoved=!1,this.isControlPressed=!1,this.isTouchInput=!1,this.isTouchMoved=!1,this.useTouchSelectionMark=!1,this.touchDownOnSelectionMark=0,this.isComposingIME=!1,this.lastComposedText="",this.isCompositionStart=!1,this.isCompositionUpdated=!1,this.isCompositionCanceled=!1,this.isCompositionEnd=!1,this.prefix="",this.suffix="",this.fields=[],this.heightInfoCollection={},this.defaultTabWidth=36,this.dontUseHtmlParagraphAutoSpacing=!1,this.alignTablesRowByRow=!1,this.compatibilityMode="Word2013",this.lists=[],this.comments=[],this.authors=new a,this.revisionsInternal=new a,this.commentUserOptionId=1,this.abstractLists=[],this.styles=new mt,this.preDefinedStyles=void 0,this.isRowOrCellResizing=!1,this.formFields=[],this.isMouseDownInFooterRegion=!1,this.pageFitTypeIn="None",this.fieldCollection=[],this.isPageField=!1,this.mouseDownOffset=new M(0,0),this.zoomFactorInternal=1,this.moveCaretPosition=0,this.isTextInput=!1,this.isScrollHandler=!1,this.triggerElementsOnLoading=!1,this.triggerSpellCheck=!1,this.restrictFormatting=!1,this.protectionType="NoProtection",this.isDocumentProtected=!1,this.hashValue="",this.saltValue="",this.userCollection=[],this.cachedPages=[],this.skipScrollToPosition=!1,this.isIosDevice=!1,this.isMobileDevice=!1,this.isFormFilling=!1,this.themes=new Y,this.hasThemes=!1,this.footnotes=new xe,this.endnotes=new xe,this.isFootnoteWidget=!1,this.onTextInput=function(e){if(!t.isComposingIME){e.preventDefault();var i=e.data;t.owner.editor.handleTextInput(i)}},this.compositionStart=function(){sf.base.Browser.isDevice||t.owner.isReadOnlyMode||(t.isComposingIME=!0,t.positionEditableTarget(),t.owner.editorHistory&&t.owner.editor.initComplexHistory("IMEInput")),t.isCompositionStart=!0},this.compositionUpdated=function(){t.isComposingIME&&!t.owner.isReadOnlyMode&&setTimeout((function(){t.owner.editor.insertIMEText(t.getEditableDivTextContent(),!0)}),0),t.isCompositionUpdated=!0},this.compositionEnd=function(e){if(t.isComposingIME&&!t.owner.isReadOnlyMode){var i=t.getEditableDivTextContent();""!==i&&t.owner.editor.insertIMEText(i,!1),t.isComposingIME=!1,t.lastComposedText="",t.iframe.setAttribute("style","pointer-events:none;position:absolute;left:"+t.owner.viewer.containerLeft+"px;top:"+t.owner.viewer.containerTop+"px;outline:none;background-color:transparent;width:0px;height:0px;overflow:hidden"),t.editableDiv.innerHTML="",t.owner.editorHistory&&(t.owner.editorHistory.updateComplexHistory(),""===i&&(t.owner.editorHistory.undo(),t.owner.editorHistory.redoStack.pop()))}e.preventDefault(),t.isCompositionUpdated=!1,t.isCompositionEnd=!0},this.onKeyPressInternal=function(e){var i=e.which||e.keyCode;t.triggerElementsOnLoading=!1;var r=!(!e.ctrlKey&&!e.metaKey)||17===i,n=e.altKey?e.altKey:18===i;if(sf.base.Browser.isIE&&n&&r&&(r=!1),r&&"v"===e.key||r&&"a"===e.key||(r||t.isControlPressed&&sf.base.Browser.isIE)&&"p"===e.key)sf.base.Browser.isIE&&(t.isControlPressed=!1);else if(!t.owner.isReadOnlyMode||t.selection&&t.selection.isInlineFormFillMode()){var o=e.keyCode||e.charCode,s="";o?s=String.fromCharCode(o):e.key&&(s=e.key)," "===s||"\r"===s||"\b"===s||s===String.fromCharCode(27)||r?" "===s&&(t.triggerSpellCheck=!0,t.owner.editorModule.handleTextInput(" "),t.triggerSpellCheck=!1):t.owner.editorModule.handleTextInput(s),e.preventDefault()}},this.onTextInputInternal=function(e){t.owner.isReadOnlyMode?t.editableDiv.innerText="":t.owner.editorModule.onTextInputInternal()},this.onPaste=function(e){(!t.owner.isReadOnlyMode&&t.owner.editor.canEditContentControl||t.selection.isInlineFormFillMode())&&t.owner.editorModule.pasteInternal(e),t.editableDiv.innerText="",e.preventDefault()},this.onFocusOut=function(){sf.base.isNullOrUndefined(t.selection)||t.selection.hideCaret()},this.updateFocus=function(){!t.selection||t.isMobileDevice&&t.owner.isReadOnly||(void 0===navigator||sf.base.Browser.isDevice||sf.base.Browser.isIE||navigator.userAgent.match("Edge")||t.iframe.focus(),t.editableDiv.focus(),t.selection.showCaret())},this.scrollHandler=function(){t.scrollTimer&&clearTimeout(t.scrollTimer),t.clearContent(),t.isScrollHandler=!0,sf.base.Browser.isDevice||t.isComposingIME||(t.iframe.style.top=t.owner.viewer.containerTop+"px",t.iframe.style.left=t.owner.viewer.containerLeft+"px"),t.owner.viewer.updateScrollBars();var e=t.owner.viewer.containerTop+t.visibleBounds.height-(t.owner.viewer.padding.top+t.owner.viewer.padding.bottom);e>t.pageContainer.offsetHeight&&(t.viewerContainer.scrollTop=t.owner.viewer.containerTop-(e-t.pageContainer.offsetHeight)),t.owner.viewer instanceof X&&!sf.base.isNullOrUndefined(t.owner)&&t.owner.fireViewChange(),t.isScrollHandler=!1,t.scrollTimer=setTimeout((function(){t.isScrollHandler||sf.base.isNullOrUndefined(t.owner)||!t.owner.isSpellCheck||(t.isScrollToSpellCheck=!0,t.owner.viewer.updateScrollBars())}),200)},this.onWindowResize=function(){t.resizeTimer&&clearTimeout(t.resizeTimer),t.resizeTimer=setTimeout((function(){sf.base.isNullOrUndefined(t.owner)||sf.base.isNullOrUndefined(t.owner.element)||(t.updateViewerSize(),t.clearContent(),t.owner.viewer.updateScrollBars(),sf.base.isNullOrUndefined(t.selection)||t.selection.updateCaretPosition(),t.updateTouchMarkPosition(),t.resizeTimer&&clearTimeout(t.resizeTimer))}),200)},this.onContextMenu=function(e){},this.onMouseDownInternal=function(e){var i=e.target;if(!(!sf.base.isNullOrUndefined(i)&&i!==t.viewerContainer||t.isTouchInput||e.offsetX>t.visibleBounds.width-(t.visibleBounds.width-t.viewerContainer.clientWidth)||e.offsetY>t.visibleBounds.height-(t.visibleBounds.height-t.viewerContainer.clientHeight)||(t.isFootnoteWidget=!1,sf.base.isNullOrUndefined(t.selection)))){if(t.updateCursor(e),t.owner.hideFormFieldPopup(),t.isLeftButtonPressed(e)&&!t.owner.isReadOnlyMode&&t.owner.enableImageResizerMode&&!sf.base.isNullOrUndefined(t.owner.imageResizerModule.selectedResizeElement)){if(t.selection.isInShape){var r=t.owner.selection.getCurrentTextFrame().containerShape;t.selection.selectShape(r)}t.owner.imageResizerModule.isImageResizing=!0}e.preventDefault(),t.isTouchInput||t.selection.hideCaret();var n=new M(e.offsetX,e.offsetY),o=t.owner.viewer.findFocusedPage(n,!0,!0);if(t.mouseDownOffset.x=o.x,t.mouseDownOffset.y=o.y,t.isMouseDownInFooterRegion=t.selection.isCursorInsidePageRect(n,t.currentPage)&&t.selection.isCursorInFooterRegion(n,t.currentPage),t.isSelectionChangedOnMouseMoved=!1,!t.owner.isReadOnlyMode&&(t.owner.editorModule.tableResize.isInCellResizerArea(o)||t.owner.editorModule.tableResize.isInRowResizerArea(o)))return t.selection.hideCaret(),t.isMouseDown=!0,t.isSelectionChangedOnMouseMoved=!1,void(t.isLeftButtonPressed(e)&&(t.owner.editorModule.tableResize.startingPoint.x=o.x,t.owner.editorModule.tableResize.startingPoint.y=o.y,t.owner.editorModule.tableResize.handleResize(o)));if(e.ctrlKey&&(t.isControlPressed=!0),t.owner.selection.isEmpty&&(t.useTouchSelectionMark=!1),3===e.which&&!t.owner.selection.isEmpty&&t.selection.checkCursorIsInSelection(t.getLineWidget(o),o))return void e.preventDefault();t.isTouchInput=!1,t.isMouseDown=!0,t.updateFocus(),t.timer=setTimeout((function(){t.tapCount++,t.tapCount>1&&(t.tapCount=1)}),100)}},this.onMouseMoveInternal=function(e){if((sf.base.isNullOrUndefined(e.target)||e.target===t.viewerContainer)&&(e.preventDefault(),!sf.base.isNullOrUndefined(t.selection))){if(!t.owner.isReadOnlyMode&&t.owner.enableImageResizerMode&&t.owner.imageResizerModule.isImageResizing)return void(t.owner.imageResizerModule.isImageMoveToNextPage||t.owner.imageResizerModule.handleImageResizingOnMouse(e));var i=new M(e.offsetX,e.offsetY),r=t.owner.viewer.findFocusedPage(i,!t.owner.enableHeaderAndFooter);if(t.isMouseDown){if(!sf.base.isNullOrUndefined(t.currentPage)){var n=r.x,o=r.y;if(!t.owner.isReadOnlyMode&&t.isRowOrCellResizing){var s=t.owner.editorModule.tableResize.currentResizingTable,a=t.selection.setPositionForBlock(s,!0),l=t.selection.setPositionForBlock(s,!1);t.owner.documentHelper.isDocumentProtected&&!t.selection.checkSelectionIsAtEditRegion(a,l)||t.owner.editorModule.tableResize.handleResizing(r)}else if(t.isTouchInput||t.isSelectionChangedOnMouseMoved||t.touchDownOnSelectionMark>0||t.updateTextPositionForSelection(r,1),t.isLeftButtonPressed(e)){e.preventDefault();var h=o,d=t.owner.selection.end,c=new M(n,h);t.owner.enableImageResizerMode&&t.owner.imageResizerModule.isImageResizerVisible&&!t.owner.imageResizerModule.isShapeResize||t.owner.selection.moveTextPosition(c,d),t.isSelectionChangedOnMouseMoved=!0}}t.selection.checkForCursorVisibility()}t.isRowOrCellResizing||t.isSelectionChangedOnMouseMoved||t.updateCursor(e),t.isRowOrCellResizing&&t.selection.hideCaret()}},this.onMouseLeaveInternal=function(e){e.preventDefault();var i=new M(e.offsetX,e.offsetY);if(t.isMouseDown){var r=t.viewerContainer.scrollTop;e.offsetY+r>r?t.scrollMoveTimer=setInterval((function(){t.scrollForwardOnSelection(i)}),100):t.scrollMoveTimer=setInterval((function(){t.scrollBackwardOnSelection(i)}),100),t.isMouseEntered&&(t.isMouseEntered=!1)}},this.onMouseEnterInternal=function(e){t.isMouseEntered||t.owner.viewer.updateScrollBars(),t.isMouseEntered=!0,t.scrollMoveTimer&&clearInterval(t.scrollMoveTimer),!t.isLeftButtonPressed(e)&&t.isMouseDown&&t.onMouseUpInternal(e)},this.onDoubleTap=function(e){if((sf.base.isNullOrUndefined(e.target)||e.target===t.viewerContainer)&&!sf.base.isNullOrUndefined(t.selection)){t.isTouchInput=!1;var i=new M(e.offsetX,e.offsetY),r=t.owner.viewer.findFocusedPage(i,!0);if(t.selection.checkAndEnableHeaderFooter(i,t.owner.viewer.findFocusedPage(i,!0)))return;var n=t.getLineWidget(r),o=t.selection.getHyperLinkFieldInCurrentSelection(n,r,!0);if(sf.base.isNullOrUndefined(o)&&(o=t.selection.getCurrentFormField()),!t.isDocumentProtected&&t.owner.enableFormField){var s=t.selection.getFormFieldType(o);s&&(""!==s.toString()&&t.selection.selectField(o),t.owner.showDialog(s))}else t.isDocumentProtected&&o&&o.formFieldData instanceof ye&&"Text"===o.formFieldData.type&&t.selection.selectField();var a=t.selection.start.clone(),l=t.selection.end.clone(),h=a.currentWidget.getInline(a.offset,0).element;if("Pages"===t.owner.layoutType)if(h instanceof Me)if("Footnote"===h.footnoteType){var d=t.currentPage.footnoteWidget,c=void 0;for(c=0;c<=d.bodyWidgets.length;c++){var p=d.bodyWidgets[c].footNoteReference;if(h.text===p.text)break}a.setPositionParagraph(d.bodyWidgets[c].childWidgets[0].childWidgets[0],0),l.setPositionParagraph(d.bodyWidgets[c].childWidgets[0].childWidgets[0],0),t.selection.selectRange(a,l)}else{var u=t.pages[t.pages.length-1].endnoteWidget;c=void 0;if(!sf.base.isNullOrUndefined(u))for(c=0;c<=u.childWidgets.length;c++){var g=u.bodyWidgets[c].footNoteReference;if(h.text===g.text)break}a.setPositionParagraph(u.childWidgets[c].childWidgets[0],0),l.setPositionParagraph(u.childWidgets[c].childWidgets[0],0),t.selection.selectRange(a,l)}else h instanceof we&&(t.selection.isinEndnote||t.selection.isinFootnote)&&t.selection.footnoteReferenceElement(a,l,h);!t.selection.isEmpty||sf.base.isNullOrUndefined(t.currentPage)||sf.base.isNullOrUndefined(t.owner.selection.start)||(t.owner.selection.selectCurrentWord(),t.selection.checkForCursorVisibility(),t.tapCount=2)}},this.onMouseUpInternal=function(e){if(sf.base.isNullOrUndefined(e.target)||e.target===t.viewerContainer){e.preventDefault(),t.isListTextSelected=!1;var i=new M(e.offsetX,e.offsetY),r=t.owner.viewer.findFocusedPage(i,!0);if(!sf.base.isNullOrUndefined(t.selection)){var n=1;sf.base.Browser.isIE?n=t.tapCount:e.detail>2&&(n=e.detail),t.isRowOrCellResizing&&t.owner.editorModule.tableResize.updateResizingHistory(r),!t.isMouseDown||t.isSelectionChangedOnMouseMoved||sf.base.isNullOrUndefined(t.currentPage)||sf.base.isNullOrUndefined(t.owner.selection.start)||t.owner.enableImageResizerMode&&t.owner.imageResizerModule.isImageResizing||(0!==t.touchDownOnSelectionMark||t.isRowOrCellResizing||(t.updateTextPositionForSelection(r,n),t.isLeftButtonPressed(e)||t.owner.fireSelectionChangeInternal(),sf.base.Browser.isIE&&2===n&&t.selection.checkAndEnableHeaderFooter(i,r)),t.selection.checkForCursorVisibility(),sf.base.isNullOrUndefined(t.currentSelectedComment)||(t.currentSelectedComment=void 0,t.owner.dotNetRef.invokeMethodAsync("SetSelectedComment","")));var o=t.isIosDevice?e.metaKey:e.ctrlKey;if(sf.base.isNullOrUndefined(t.currentPage)||sf.base.isNullOrUndefined(t.owner.selection.start)||!t.owner.selection.isEmpty&&!t.owner.selection.isImageSelected||!(o&&t.owner.useCtrlClickToFollowHyperlink||!t.owner.useCtrlClickToFollowHyperlink)||!0!==t.isLeftButtonPressed(e)||t.selection.navigateHyperLinkOnEvent(r,!1),t.isMouseDown&&t.isLeftButtonPressed(e)&&t.isDocumentProtected&&"FormFieldsOnly"===t.protectionType&&t.selection){var s=t.getLineWidget(r),a=t.selection.getHyperLinkFieldInCurrentSelection(s,r,!0);if(sf.base.isNullOrUndefined(a)&&(a=t.selection.getCurrentFormField(!0)),a&&a.formFieldData&&a.formFieldData.enabled&&!t.selection.isInlineFormFillMode(a)){var l={fieldName:a.formFieldData.name};if(a.formFieldData instanceof ye?l.value=a.resultText:a.formFieldData instanceof ve?l.value=a.formFieldData.checked:l.value=a.formFieldData.selectedIndex,t.owner.fireBeforeFormFieldFill(l),a.formFieldData instanceof ve)t.owner.editor.toggleCheckBoxFormField(a);else{var h={};if(a.formFieldData instanceof be)h.type="DropDown",h.defaultValue=a.formFieldData.dropdownItems,h.value=a.formFieldData.selectedIndex;else{var d=a.formFieldData;if(d instanceof ye){h.type="Text";var c=a.resultText,p=new RegExp(t.owner.documentHelper.textHelper.getEnSpaceCharacter(),"gi");if(""===c.replace(p,"")&&(c=""),h.maxLength=a.formFieldData.maxLength,h.textFormType=a.formFieldData.type,h.defaultValue=a.formFieldData.defaultValue,h.value=c||"",h.textFormType="Text","Number"==d.type)h.textFormType="Number",h.format=d.format,h.value=parseFloat(c.replace(/,/gi,""));else if("Date"==d.type){h.textFormType="Date";var u=d.format;-1!==u.indexOf("am/pm")&&(u=u.replace(/am\/pm/gi,"a")),h.format=u,h.value=c}}}var g=t.owner.selection.getLeftInternal(a.line,a,0),f=a.line.height*t.owner.documentHelper.zoomFactor,m=t.owner.selection.getTooltipPosition(a.line,g,370,100,!0);m.y=m.y+f,h.position=m,t.owner.showFormFieldPopup(h)}}!a&&t.isFormFillProtectedMode&&t.selection.navigateToNextFormField()}else if(t.isMouseDown){if(t.formFields.length>0)if((a=t.selection.getCurrentFormField(!0))&&a.formFieldData instanceof ye)t.selection.selectField();else if(t.isLeftButtonPressed(e)&&a&&a.formFieldData instanceof be){var y=a.line.getOffset(a,0),v=t.selection.getPhysicalPositionInternal(a.line,y,!1);t.selection.selectInternal(a.line,a,0,v)}}if(!t.owner.isReadOnlyMode&&t.isSelectionInListText(r)&&t.selection.selectListText(),!t.owner.isReadOnlyMode&&t.owner.enableImageResizerMode&&t.owner.imageResizerModule.isImageResizing&&(t.owner.imageResizerModule.mouseUpInternal(),t.scrollToPosition(t.owner.selection.start,t.owner.selection.end),t.owner.imageResizerModule.isImageResizing=!1),t.owner.enableImageResizerMode&&t.owner.imageResizerModule.isImageResizerVisible&&!sf.base.isNullOrUndefined(t.selection.caret)&&(t.selection.caret.style.display="none"),t.isMouseDown=!1,t.isFootnoteWidget=!1,t.isSelectionChangedOnMouseMoved=!1,t.isTouchInput=!1,t.useTouchSelectionMark=!0,t.isControlPressed=!1,t.updateFocus(),t.isListTextSelected&&t.selection.hideCaret(),t.owner.enableImageResizerMode){var b=t.owner.imageResizerModule;b.isImageResizing=!1,b.isImageMoveToNextPage=!1,b.leftValue=void 0,b.topValue=void 0}t.isMouseDownInFooterRegion=!1}}},this.onTouchStartInternal=function(e){if(t.selection){if(t.isTouchMoved=!1,t.isCompositionStart=!1,t.isCompositionEnd=!1,t.isCompositionUpdated=!1,t.isCompositionCanceled=!0,t.isTouchInput=!0,t.isTimerStarted?1===t.tapCount?t.tapCount=2:(t.tapCount=3,t.isTimerStarted=!1):(t.isTimerStarted=!0,t.tapCount=1),1===e.touches.length){t.zoomX=e.touches[0].clientX,t.zoomY=e.touches[0].clientY,t.owner.selection.isEmpty&&(t.useTouchSelectionMark=!1),t.isMouseDown=!0,t.isSelectionChangedOnMouseMoved=!1;var i=void 0;if(t.isMouseDown&&(i=t.getTouchOffsetValue(e)),i=t.owner.viewer.findFocusedPage(i,!0,!0),t.owner.enableImageResizerMode){var r=t.owner.imageResizerModule.getImagePointOnTouch(i);t.owner.imageResizerModule.selectedResizeElement=r.selectedElement}t.owner.enableImageResizerMode&&!sf.base.isNullOrUndefined(t.owner.imageResizerModule.selectedResizeElement)&&(t.owner.imageResizerModule.isImageResizing=!0);var n=t.owner.selection.end.location.x,o=t.selection.getCaretBottom(t.owner.selection.end,t.owner.selection.isEmpty)+9;t.touchDownOnSelectionMark=(i.y<=o&&i.y>=o-20||i.y>=o&&i.y<=o+20)&&(i.x<=n&&i.x>=n-20||i.x>=n&&i.x<=n+20)?1:0,t.owner.selection.isEmpty||0!==t.touchDownOnSelectionMark||(n=t.owner.selection.start.location.x,o=t.selection.getCaretBottom(t.owner.selection.start,!1)+9,t.touchDownOnSelectionMark=(i.y<=o&&i.y>=o-20||i.y>=o&&i.y<=o+20)&&(i.x<=n&&i.x>=n-20||i.x>=n&&i.x<=n+20)?2:0)}(t.touchDownOnSelectionMark||e.touches.length>1)&&e.preventDefault(),t.longTouchTimer=setTimeout(t.onLongTouch,500,e),t.timer=setTimeout((function(){t.isTimerStarted=!1}),200)}},this.onLongTouch=function(e){if(!(sf.base.isNullOrUndefined(t.owner)||sf.base.isNullOrUndefined(t.viewerContainer)||t.isTouchMoved||1!==e.touches.length)){var i=t.getTouchOffsetValue(e),r=t.owner.viewer.findFocusedPage(i,!0),n=t.selection.start,o=t.selection.end,s=!1;t.selection.isForward||(n=t.selection.end,o=t.selection.start);var a=n.location,l=o.location;s=n.currentWidget!==o.currentWidget?!(r.x>=a.x&&r.x<=l.x||r.y>=a.y&&r.y<=l.y):!(r.x>=a.x&&r.x<=l.x&&r.y>=a.y&&r.y<=l.y),1===e.changedTouches.length&&s&&(t.updateSelectionOnTouch(i,r),t.isMouseDown=!1,t.touchDownOnSelectionMark=0,t.useTouchSelectionMark=!0,t.isSelectionChangedOnMouseMoved=!1),t.selection.isEmpty&&t.selection.selectCurrentWord()}},this.onTouchMoveInternal=function(e){t.isTouchMoved=!0;var i,r=e.touches;if(!sf.base.isNullOrUndefined(t.selection)){if(t.owner.editorModule&&t.owner.enableImageResizerMode&&t.owner.imageResizerModule.isImageResizing)return e.preventDefault(),void(t.owner.imageResizerModule.isImageMoveToNextPage||(t.owner.imageResizerModule.handleImageResizingOnTouch(e),t.selection.caret.style.display="none"));if(t.isMouseDown){i=t.getTouchOffsetValue(e);var n=t.owner.viewer.findFocusedPage(i,!0);if(t.touchDownOnSelectionMark>0){e.preventDefault();var o=n.y,s=t.owner.selection.end;n.y<=26?o-=n.y<0?0:n.y+.5:o-=36.5,s=2===t.touchDownOnSelectionMark?t.selection.start:t.selection.end,n=new M(n.x,o),t.owner.selection.moveTextPosition(n,s),t.isSelectionChangedOnMouseMoved=!0}t.selection.checkForCursorVisibility(),t.updateTouchMarkPosition()}}if(r.length>1){e.preventDefault(),t.isMouseDown=!1,t.zoomX=(r[0].clientX+r[1].clientX)/2,t.zoomY=(r[0].clientY+r[1].clientY)/2;var a=Math.sqrt(Math.pow(r[0].clientX-r[1].clientX,2)+Math.pow(r[0].clientY-r[1].clientY,2));t.preDifference>-1?a>t.preDifference?t.onPinchOutInternal(e):a<t.preDifference&&t.onPinchInInternal(e):t.zoomFactor<2?-1!==t.preDifference&&a>t.preDifference&&t.onPinchInInternal(e):-1===t.preDifference&&t.zoomFactor>2&&a>t.preDifference&&t.onPinchInInternal(e),t.preDifference=a}t.longTouchTimer&&(clearTimeout(t.longTouchTimer),t.longTouchTimer=void 0)},this.onTouchUpInternal=function(e){if(!sf.base.isNullOrUndefined(t.selection)){var i=t.getTouchOffsetValue(e),r=t.owner.viewer.findFocusedPage(i,!0);1===e.changedTouches.length&&((!t.isTouchMoved||t.owner.enableImageResizerMode&&t.owner.imageResizerModule.isImageResizing)&&(t.updateSelectionOnTouch(i,r),sf.base.isNullOrUndefined(t.currentPage)||sf.base.isNullOrUndefined(t.selection.start)||t.isSelectionChangedOnMouseMoved||!(t.selection.isEmpty||t.selection.isImageField()&&(!t.owner.enableImageResizerMode||t.owner.enableImageResizerMode&&!t.owner.imageResizerModule.isImageResizing))||t.selection.navigateHyperLinkOnEvent(r,!0)),t.isMouseDown=!1,t.touchDownOnSelectionMark=0,t.useTouchSelectionMark=!0,t.isSelectionChangedOnMouseMoved=!1),t.owner.enableImageResizerMode&&t.owner.imageResizerModule.isImageResizing&&(t.owner.imageResizerModule.mouseUpInternal(),t.owner.imageResizerModule.isImageResizing=!1,t.owner.imageResizerModule.isImageMoveToNextPage=!1,t.scrollToPosition(t.owner.selection.start,t.owner.selection.end)),t.owner.enableImageResizerMode&&t.owner.imageResizerModule.isImageResizerVisible&&t.isTouchInput&&(t.touchStart.style.display="none",t.touchEnd.style.display="none"),e.preventDefault()}t.preDifference=-1,t.isTouchInput=!1,t.longTouchTimer&&(clearTimeout(t.longTouchTimer),t.longTouchTimer=void 0),t.isTimerStarted||(t.tapCount=1),t.isListTextSelected&&t.selection.hideCaret()},this.onKeyUpInternal=function(e){sf.base.Browser.isDevice&&e.target===t.editableDiv&&window.getSelection().anchorOffset!==t.prefix.length&&t.selection.setEditableDivCaretPosition(t.editableDiv.innerText.length),(e.ctrlKey||17===e.keyCode||17===e.which)&&(t.isControlPressed=!1)},this.onKeyDownInternal=function(e){if(sf.base.isNullOrUndefined(e.target)||e.target===t.editableDiv){var i=!1,r={event:e,isHandled:!1};if(t.owner.dotNetRef.invokeMethodAsync("KeyDown",r),!r.isHandled){var n=e.which||e.keyCode,o=!(!e.ctrlKey&&!e.metaKey)||17===n,s=e.shiftKey?e.shiftKey:16===n,a=e.altKey?e.altKey:18===n;if(o&&!s&&!a)switch(n){case 80:e.preventDefault(),t.owner.print(),i=!0;break;case 83:e.preventDefault(),t.owner.save(""===t.owner.documentName?"sample":t.owner.documentName,"Sfdt"),i=!0}i||sf.base.isNullOrUndefined(t.selection)||t.selection.onKeyDownInternal(e,o,s,a),i&&e.preventDefault()}}},this.owner=e,this.pages=[],this.lists=[],this.abstractLists=[],this.render=new E(this),this.characterFormat=new P(this),this.themeFontLanguage=new P(this),this.paragraphFormat=new ct(this),this.renderedLists=new a,this.renderedLevelOverrides=[],this.headersFooters=[],this.styles=new mt,this.preDefinedStyles=new a,this.initalizeStyles(),this.bookmarks=new a,this.editRanges=new a,this.isIosDevice="undefined"!=typeof window&&/Mac|iPad|iPod/i.test(navigator.userAgent),this.isMobileDevice="undefined"!=typeof window&&/Android|Windows Phone|webOS/i.test(navigator.userAgent),this.customXmlData=new a,this.contentControlCollection=[],this.footnoteCollection=[],this.endnoteCollection=[],this.themes=new Y}return Object.defineProperty(e.prototype,"visibleBounds",{get:function(){return this.visibleBoundsIn},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"viewer",{get:function(){return this.owner.viewer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"containerCanvas",{get:function(){return sf.base.isNullOrUndefined(this.containerCanvasIn)&&(this.containerCanvasIn=document.createElement("canvas"),this.containerCanvasIn.getContext("2d").save()),sf.base.isNullOrUndefined(this.pageContainer)||this.containerCanvasIn.parentElement===this.pageContainer||this.pageContainer.appendChild(this.containerCanvasIn),this.containerCanvasIn},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selectionCanvas",{get:function(){return sf.base.isNullOrUndefined(this.selectionCanvasIn)&&(this.selectionCanvasIn=document.createElement("canvas"),this.selectionCanvas.getContext("2d").save()),sf.base.isNullOrUndefined(this.pageContainer)||this.selectionCanvasIn.parentElement===this.pageContainer||this.pageContainer.appendChild(this.selectionCanvasIn),this.selectionCanvasIn},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"containerContext",{get:function(){return this.containerCanvas.getContext("2d")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selectionContext",{get:function(){return this.selectionCanvas.getContext("2d")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentRenderingPage",{get:function(){if(0!==this.pages.length)return this.pages[this.pages.length-1]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"zoomFactor",{get:function(){return this.zoomFactorInternal},set:function(e){this.zoomFactorInternal!==e&&(this.preZoomFactor=this.zoomFactor,this.zoomFactorInternal=e,this.zoomModule.setZoomFactor(),this.owner.zoomFactor=e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selection",{get:function(){return this.owner.selection},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selectionStartPage",{get:function(){return this.selectionStartPageIn},set:function(e){this.selectionStartPageIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selectionEndPage",{get:function(){return this.selectionEndPageIn},set:function(e){this.selectionEndPageIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentSelectedComment",{get:function(){return this.currentSelectedCommentInternal},set:function(e){this.selection&&(this.selection.updatePreviousCommentMark(e),this.selection.hightlightCommentSelectionMark()),this.currentSelectedCommentInternal=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentSelectedRevision",{get:function(){return this.currentSelectedRevisionInternal},set:function(e){this.currentSelectedRevisionInternal=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isInlineFormFillProtectedMode",{get:function(){return this.isFormFillProtectedMode&&"Inline"===this.owner.documentEditorSettings.formFieldSettings.formFillingMode},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isFormFillProtectedMode",{get:function(){return this.isDocumentProtected&&"FormFieldsOnly"===this.protectionType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isCommentOnlyMode",{get:function(){return this.isDocumentProtected&&"CommentsOnly"===this.protectionType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isTrackedOnlyMode",{get:function(){return this.isDocumentProtected&&"RevisionsOnly"===this.protectionType},enumerable:!0,configurable:!0}),e.prototype.initalizeStyles=function(){this.preDefinedStyles.add("Normal",'{"type":"Paragraph","name":"Normal","next":"Normal"}'),this.preDefinedStyles.add("Heading 1",'{"type":"Paragraph","name":"Heading 1","basedOn":"Normal","next":"Normal","link":"Heading 1 Char","characterFormat":{"fontSize":16.0,"fontFamily":"Calibri Light","fontColor":"#2F5496"},"paragraphFormat":{"leftIndent":0.0,"rightIndent":0.0,"firstLineIndent":0.0,"beforeSpacing":12.0,"afterSpacing":0.0,"lineSpacing":1.0791666507720947,"lineSpacingType":"Multiple","textAlignment":"Left","outlineLevel":"Level1"}}'),this.preDefinedStyles.add("Heading 2",'{"type":"Paragraph","name":"Heading 2","basedOn":"Normal","next":"Normal","link":"Heading 2 Char","characterFormat":{"fontSize":13.0,"fontFamily":"Calibri Light","fontColor":"#2F5496"},"paragraphFormat":{"leftIndent":0.0,"rightIndent":0.0,"firstLineIndent":0.0,"beforeSpacing":2.0,"afterSpacing":0.0,"lineSpacing":1.0791666507720947,"lineSpacingType":"Multiple","textAlignment":"Left","outlineLevel":"Level2"}}'),this.preDefinedStyles.add("Heading 3",'{"type":"Paragraph","name":"Heading 3","basedOn":"Normal","next":"Normal","link":"Heading 3 Char","characterFormat":{"fontSize":12.0,"fontFamily":"Calibri Light","fontColor":"#1F3763"},"paragraphFormat":{"leftIndent":0.0,"rightIndent":0.0,"firstLineIndent":0.0,"beforeSpacing":2.0,"afterSpacing":0.0,"lineSpacing":1.0791666507720947,"lineSpacingType":"Multiple","textAlignment":"Left","outlineLevel":"Level3"}}'),this.preDefinedStyles.add("Heading 4",'{"type":"Paragraph","name":"Heading 4","basedOn":"Normal","next":"Normal","link":"Heading 4 Char","characterFormat":{"italic":true,"fontFamily":"Calibri Light","fontColor":"#2F5496"},"paragraphFormat":{"leftIndent":0.0,"rightIndent":0.0,"firstLineIndent":0.0,"beforeSpacing":2.0,"afterSpacing":0.0,"lineSpacing":1.0791666507720947,"lineSpacingType":"Multiple","textAlignment":"Left","outlineLevel":"Level4"}}'),this.preDefinedStyles.add("Heading 5",'{"type":"Paragraph","name":"Heading 5","basedOn":"Normal","next":"Normal","link":"Heading 5 Char","characterFormat":{"fontFamily":"Calibri Light","fontColor":"#2F5496"},"paragraphFormat":{"leftIndent":0.0,"rightIndent":0.0,"firstLineIndent":0.0,"beforeSpacing":2.0,"afterSpacing":0.0,"lineSpacing":1.0791666507720947,"lineSpacingType":"Multiple","textAlignment":"Left","outlineLevel":"Level5"}}'),this.preDefinedStyles.add("Heading 6",'{"type":"Paragraph","name":"Heading 6","basedOn":"Normal","next":"Normal","link":"Heading 6 Char","characterFormat":{"fontFamily":"Calibri Light","fontColor":"#1F3763"},"paragraphFormat":{"leftIndent":0.0,"rightIndent":0.0,"firstLineIndent":0.0,"beforeSpacing":2.0,"afterSpacing":0.0,"lineSpacing":1.0791666507720947,"lineSpacingType":"Multiple","textAlignment":"Left","outlineLevel":"Level6"}}'),this.preDefinedStyles.add("Default Paragraph Font",'{"type":"Character","name":"Default Paragraph Font"}'),this.preDefinedStyles.add("Heading 1 Char",'{"type":"Character","name":"Heading 1 Char","basedOn":"Default Paragraph Font","characterFormat":{"fontSize":16.0,"fontFamily":"Calibri Light","fontColor":"#2F5496"}}'),this.preDefinedStyles.add("Heading 2 Char",'{"type":"Character","name":"Heading 2 Char","basedOn":"Default Paragraph Font","characterFormat":{"fontSize":13.0,"fontFamily":"Calibri Light","fontColor":"#2F5496"}}'),this.preDefinedStyles.add("Heading 3 Char",'{"type":"Character","name":"Heading 3 Char","basedOn":"Default Paragraph Font","characterFormat":{"fontSize":12.0,"fontFamily":"Calibri Light","fontColor": "#1F3763"}}'),this.preDefinedStyles.add("Heading 4 Char",'{"type":"Character","name":"Heading 4 Char","basedOn":"Default Paragraph Font","characterFormat":{"italic":true,"fontFamily":"Calibri Light","fontColor":"#2F5496"}}'),this.preDefinedStyles.add("Heading 5 Char",'{"type":"Character","name":"Heading 5 Char","basedOn":"Default Paragraph Font","characterFormat":{"fontFamily":"Calibri Light","fontColor":"#2F5496"}}'),this.preDefinedStyles.add("Heading 6 Char",'{"type":"Character","name":"Heading 6 Char","basedOn":"Default Paragraph Font","characterFormat":{"fontFamily":"Calibri Light","fontColor":"#1F3763"}}'),this.preDefinedStyles.add("Hyperlink",'{"type":"Character","name":"Hyperlink","basedOn":"Default Paragraph Font","next":"Normal","characterFormat":{"fontColor":"#0563C1","underline": "Single"}}'),this.preDefinedStyles.add("TOC 1",'{"type":"Paragraph","name":"TOC 1","basedOn":"Normal","next":"Normal","paragraphFormat":{"afterSpacing":5.0}}'),this.preDefinedStyles.add("TOC 2",'{"type":"Paragraph","name":"TOC 2","basedOn":"Normal","next":"Normal","paragraphFormat":{"leftIndent" :11.0,"afterSpacing":5.0}}'),this.preDefinedStyles.add("TOC 3",'{"type":"Paragraph","name":"TOC 3","basedOn":"Normal","next":"Normal","paragraphFormat":{"leftIndent" :22.0,"afterSpacing":5.0}}'),this.preDefinedStyles.add("TOC 4",'{"type":"Paragraph","name":"TOC 4","basedOn":"Normal","next":"Normal","paragraphFormat":{"leftIndent" :33.0,"afterSpacing":5.0}}'),this.preDefinedStyles.add("TOC 5",'{"type":"Paragraph","name":"TOC 5","basedOn":"Normal","next":"Normal","paragraphFormat":{"leftIndent" :44.0,"afterSpacing":5.0}}'),this.preDefinedStyles.add("TOC 6",'{"type":"Paragraph","name":"TOC 6","basedOn":"Normal","next":"Normal","paragraphFormat":{"leftIndent" :55.0,"afterSpacing":5.0}}'),this.preDefinedStyles.add("TOC 7",'{"type":"Paragraph","name":"TOC 7","basedOn":"Normal","next":"Normal","paragraphFormat":{"leftIndent" :66.0,"afterSpacing":5.0}}'),this.preDefinedStyles.add("TOC 8",'{"type":"Paragraph","name":"TOC 8","basedOn":"Normal","next":"Normal","paragraphFormat":{"leftIndent" :77.0,"afterSpacing":5.0}}'),this.preDefinedStyles.add("TOC 9",'{"type":"Paragraph","name":"TOC 9","basedOn":"Normal","next":"Normal","paragraphFormat":{"leftIndent" :88.0,"afterSpacing":5.0}}')},e.prototype.clearDocumentItems=function(){this.owner.editor&&this.owner.editor.clear(),this.editRanges.clear(),this.headersFooters=[],this.fields=[],this.formFields=[],this.currentSelectedComment=void 0,this.currentSelectedRevision=void 0;for(var e=0;e<this.comments.length;e++){var t=this.comments[e].commentStart;t&&t.destroy()}this.comments=[],this.bookmarks.clear(),this.styles.clear(),this.authors.clear(),this.revisionsInternal.clear(),this.owner.revisions.destroy(),this.characterFormat.clearFormat(),this.themeFontLanguage.clearFormat(),this.paragraphFormat.clearFormat(),this.owner.trackChangesPane&&this.owner.trackChangesPane.clear(),this.setDefaultCharacterValue(this.characterFormat),this.setDefaultParagraphValue(this.paragraphFormat),this.isHeaderFooter=!1,this.defaultTabWidth=36,this.isDocumentProtected=!1,this.protectionType="NoProtection",this.restrictFormatting=!1,this.hashValue="",this.saltValue="",this.userCollection=[],this.customXmlData.clear(),this.contentControlCollection=[],this.endnotes.clear(),this.footnotes.clear(),this.footnoteCollection=[],this.endnoteCollection=[],this.themes=new Y,this.hasThemes=!1},e.prototype.setDefaultDocumentFormat=function(){this.owner.parser.parseCharacterFormat(this.owner.characterFormat,this.characterFormat),this.owner.parser.parseParagraphFormat(this.owner.paragraphFormat,this.paragraphFormat)},e.prototype.setDefaultCharacterValue=function(e){e.bold=!1,e.italic=!1,e.fontFamily="Calibri",e.fontSize=11,e.underline="None",e.strikethrough="None",e.fontSizeBidi=11,e.fontFamilyBidi="Calibri",e.baselineAlignment="Normal",e.highlightColor="NoColor",e.fontColor="#00000000",e.allCaps=!1},e.prototype.setDefaultParagraphValue=function(e){e.leftIndent=0,e.rightIndent=0,e.firstLineIndent=0,e.textAlignment="Left",e.beforeSpacing=0,e.afterSpacing=0,e.lineSpacing=1,e.lineSpacingType="Multiple",e.bidi=!1,e.keepWithNext=!1,e.keepLinesTogether=!1,e.widowControl=!0},e.prototype.getAbstractListById=function(e){if(!sf.base.isNullOrUndefined(this.abstractLists))for(var t=0;t<this.abstractLists.length;t++){var i=this.abstractLists[t];if(i instanceof S&&i.abstractListId===e)return i}},e.prototype.getListById=function(e){if(!sf.base.isNullOrUndefined(this.lists))for(var t=0;t<this.lists.length;t++)if(!sf.base.isNullOrUndefined(this.lists[t])&&this.lists[t].listId===e)return this.lists[t]},e.getListLevelNumber=function(e){return e.ownerBase instanceof g?e.ownerBase.levelNumber:e.ownerBase instanceof S&&!sf.base.isNullOrUndefined(e.ownerBase.levels)?e.ownerBase.levels.indexOf(e):-1},e.prototype.getBookmarks=function(e){for(var t=[],i=0;i<this.bookmarks.keys.length;i++){var r=this.bookmarks.keys[i];(e||0!==r.indexOf("_"))&&t.push(r)}return t},e.prototype.selectComment=function(e){var t=this;this.owner.selection&&setTimeout((function(){t.owner&&t.owner.selection&&t.owner.selection.selectComment(e)}))},e.prototype.showComments=function(e){this.owner&&e&&this.owner.enableComment&&this.owner.fireBeforePaneSwitch("Comment")},e.prototype.showRevisions=function(e){this.owner&&e&&this.owner.fireBeforePaneSwitch("Comment"),!e&&this.owner.showComments||(this.showRevision||this.owner.enableTrackChanges||!this.owner.showRevisions?(this.owner.dotNetRef.invokeMethodAsync("ShowRevisions",e),this.owner.enableComment,this.showRevision=!1):(this.owner.dotNetRef.invokeMethodAsync("ShowRevisions",!e),this.owner.showRevisions=!1)),e&&this.owner.trackChangesPane.enableDisableButton(!this.owner.isReadOnly&&!this.isDocumentProtected)},e.prototype.initializeComponents=function(){var e=this.owner.element;sf.base.isNullOrUndefined(e)||(this.optionsPaneContainer=this.owner.element.getElementsByClassName("e-documenteditor-optionspane")[0],sf.base.isNullOrUndefined(this.optionsPaneContainer)&&(this.optionsPaneContainer=sf.base.createElement("div",{className:"e-documenteditor-optionspane"}),e.appendChild(this.optionsPaneContainer)),this.restrictEditingElement=this.owner.element.getElementsByClassName("e-de-restrict-pane")[0],this.optionsPaneElement=this.owner.element.getElementsByClassName("e-de-op")[0],this.commentPaneElement=this.owner.element.getElementsByClassName("e-de-review-pane")[0],this.viewerContainer=this.owner.element.getElementsByClassName("e-de-viewercontainer")[0],sf.base.isNullOrUndefined(this.viewerContainer)&&(this.viewerContainer=sf.base.createElement("div",{id:this.owner.containerId+"_viewerContainer"}),this.optionsPaneContainer.appendChild(this.viewerContainer)),this.viewerContainer.style.cssText="position:relative;backgroundColor:#FBFBFB;overflow:auto;direction:ltr;",this.viewerContainer.tabIndex=0,this.viewerContainer.style.outline="none",this.pageContainer=sf.base.createElement("div",{id:this.owner.containerId+"_pageContainer",className:"e-de-background"}),this.viewerContainer.appendChild(this.pageContainer),this.pageContainer.style.top="0px",this.pageContainer.style.left="0px",this.pageContainer.style.position="relative",this.pageContainer.style.pointerEvents="none",sf.base.Browser.isDevice?this.createEditableDiv(e):this.createEditableIFrame(),this.owner.enableImageResizerMode&&this.owner.imageResizerModule.initializeImageResizer(),this.updateViewerSizeInternal(e),this.layout=new L(this),this.textHelper=new z(this),this.zoomModule=new k(this),this.initTouchEllipse(),this.wireEvent(),this.owner.trackChangesPane=new j(this.owner),this.owner.spellCheckerModule=new H(this.owner.documentHelper))},e.prototype.measureScrollbarWidth=function(e){var t=document.createElement("div");t.setAttribute("style","visibility:hidden;overflow:scroll"),e.appendChild(t);var i=document.createElement("div");t.appendChild(i),this.scrollbarWidth=t.getBoundingClientRect().width-i.getBoundingClientRect().width,t.parentNode.removeChild(t)},e.prototype.createEditableDiv=function(e){this.editableDiv=document.createElement("div"),this.editableDiv.contentEditable="true",this.editableDiv.style.position="fixed",this.editableDiv.style.left="-150em",this.editableDiv.style.width="100%",this.editableDiv.style.height="100%",this.editableDiv.id=e.id+"_editableDiv",document.body.appendChild(this.editableDiv)},e.prototype.createEditableIFrame=function(){this.iframe=sf.base.createElement("iframe",{attrs:{scrolling:"no",style:"pointer-events:none;position:absolute;left:0px;top:0px;outline:none;background-color:transparent;width:0px;height:0px;overflow:hidden"},className:"e-de-text-target"}),this.viewerContainer.appendChild(this.iframe),this.initIframeContent()},e.prototype.initIframeContent=function(){sf.base.isNullOrUndefined(this.iframe.contentDocument)||(this.iframe.contentDocument.open(),this.iframe.contentDocument.write('<!DOCTYPE html><html><head></head><body spellcheck="false" style=background-color:transparent;width:100%;height:100%;padding: 0px; margin: 0px; ><div contenteditable="true" style=background-color:transparent;width:100%;height:100%;padding: 0px; margin: 0px;></div></body></html>'),this.iframe.contentDocument.close(),this.editableDiv=this.iframe.contentDocument.body.children[0])},e.prototype.wireEvent=function(){sf.base.isNullOrUndefined(this.selection)||this.selection.initCaret(),this.wireInputEvents(),sf.base.isNullOrUndefined(this.iframe)||this.iframe.addEventListener("load",this.onIframeLoad.bind(this)),this.viewerContainer.addEventListener("scroll",this.scrollHandler),this.viewerContainer.addEventListener("mousedown",this.onMouseDownInternal),this.viewerContainer.addEventListener("keydown",this.onKeyDownInternal),this.viewerContainer.addEventListener("mousemove",this.onMouseMoveInternal),this.viewerContainer.addEventListener("mouseleave",this.onMouseLeaveInternal),this.viewerContainer.addEventListener("mouseenter",this.onMouseEnterInternal),this.viewerContainer.addEventListener("contextmenu",this.onContextMenu),this.viewerContainer.addEventListener("dblclick",this.onDoubleTap),this.viewerContainer.addEventListener("mouseup",this.onMouseUpInternal),window.addEventListener("resize",this.onWindowResize),window.addEventListener("keyup",this.onKeyUpInternal),window.addEventListener("mouseup",this.onImageResizer.bind(this)),window.addEventListener("touchend",this.onImageResizer.bind(this)),this.viewerContainer.addEventListener("touchstart",this.onTouchStartInternal),this.viewerContainer.addEventListener("touchmove",this.onTouchMoveInternal),this.viewerContainer.addEventListener("touchend",this.onTouchUpInternal),void 0!==navigator&&navigator.userAgent.match("Firefox")&&this.viewerContainer.addEventListener("DOMMouseScroll",this.zoomModule.onMouseWheelInternal.bind(this)),this.viewerContainer.addEventListener("mousewheel",this.zoomModule.onMouseWheelInternal.bind(this))},e.prototype.wireInputEvents=function(){sf.base.isNullOrUndefined(this.editableDiv)||(this.editableDiv.addEventListener("paste",this.onPaste),sf.base.Browser.isDevice?this.editableDiv.addEventListener("input",this.onTextInputInternal):(this.editableDiv.addEventListener("keypress",this.onKeyPressInternal),"chrome"===sf.base.Browser.info.name&&this.editableDiv.addEventListener("textInput",this.onTextInput)),this.editableDiv.addEventListener("blur",this.onFocusOut),this.editableDiv.addEventListener("keydown",this.onKeyDownInternal),this.editableDiv.addEventListener("compositionstart",this.compositionStart),this.editableDiv.addEventListener("compositionupdate",this.compositionUpdated),this.editableDiv.addEventListener("compositionend",this.compositionEnd))},e.prototype.onIframeLoad=function(){sf.base.isNullOrUndefined(this.iframe)||0!==this.iframe.contentDocument.body.children.length||(this.initIframeContent(),this.wireInputEvents())},e.prototype.getEditableDivTextContent=function(){return this.editableDiv.textContent},e.prototype.updateAuthorIdentity=function(){for(var e=this.owner.revisions.changes,t=0;t<e.length;t++)this.getAuthorColor(e[t].author)},e.prototype.getAvatar=function(e,t,i,r){var n,o;if(sf.base.isNullOrUndefined(i)?n=r.author:(n=i.author,o=i.initial),!sf.base.isNullOrUndefined(n)){var s=sf.base.createElement("div",{className:"e-de-cmt-avatar"}),a=sf.base.createElement("div",{className:"e-de-ff-cmt-avatar"});if(a.style.backgroundColor=this.owner.documentHelper.getAuthorColor(n),""===o||sf.base.isNullOrUndefined(o)){var l=n.split(" "),h=l[0].charAt(0);l.length>1&&(h+=l[l.length-1][0]),a.innerText=h.toUpperCase()}else o.length>2?a.innerText=o.substring(0,2):a.innerText=o;s.appendChild(a),s.appendChild(t),e.appendChild(s)}},e.prototype.getAuthorColor=function(e){if(this.authors.containsKey(e))return this.authors.get(e);var t=this.owner.userColor;return e!==this.owner.currentUser&&(t=0===this.authors.length&&"#b5082e"!==t?"#b5082e":this.generateRandomColor()),this.authors.add(e,t),t},e.prototype.generateRandomColor=function(){return["#b5082e","#2e97d3","#bb00ff","#f37e43","#03a60b","#881824","#e09a2b","#50565e"][this.authors.length%8]},e.prototype.positionEditableTarget=function(){var e=this.selection.getRect(this.selection.start),t=this.selection.getSelectionPage(this.selection.start),i=t.bodyWidgets[0].sectionFormat,r=t.boundingRectangle.x+x.convertPointToPixel(i.leftMargin)*this.zoomFactor,n=e.y,o=i.pageWidth-i.leftMargin-i.rightMargin,s="left:"+r+"px;";s+="top:"+n+"px;",s+="width:"+x.convertPointToPixel(o)*this.zoomFactor+"px;",s+="height:250px;outline-style:none;position:absolute",this.iframe.setAttribute("style",s);var a="background-color:transparent;width:100%;height:250px;padding: 0px; margin: 0px;";a+="text-indent:"+(e.x-r)+"px;",a+="color:transparent;pointer-events:none;outline-style:none;",a+="font-size:"+x.convertPointToPixel(this.selection.characterFormat.fontSize)*this.zoomFactor+"px;",a+="font-family"+this.selection.characterFormat.fontFamily+";",a+="overflow:hidden;text-decoration:none;white-space:normal;",this.editableDiv.setAttribute("style",a)},e.prototype.onImageResizer=function(e){!sf.base.isNullOrUndefined(this.owner)&&!sf.base.isNullOrUndefined(this.owner.imageResizerModule)&&this.owner.imageResizerModule.isImageResizerVisible&&this.owner.imageResizerModule.isImageResizing&&(e instanceof MouseEvent?this.onMouseUpInternal(e):e instanceof TouchEvent&&this.onTouchUpInternal(e)),this.scrollMoveTimer&&(this.isMouseEntered=!0,clearInterval(this.scrollMoveTimer))},e.prototype.initDialog=function(e){},e.prototype.initDialog3=function(e){},e.prototype.hideDialog=function(){this.updateFocus()},e.prototype.initDialog2=function(e){},e.prototype.clearContent=function(){if(this.containerContext.clearRect(0,0,this.containerCanvas.width,this.containerCanvas.height),this.selectionContext.clearRect(0,0,this.selectionCanvas.width,this.selectionCanvas.height),this.pageContainer)for(var e=this.pageContainer.getElementsByClassName("e-de-cmt-mark"),t=0;t<e.length;t++)e[t].style.display="none"},e.prototype.onDocumentChanged=function(e){this.clearContent(),this.owner.editorModule&&(this.owner.editorModule.tocStyles={},this.owner.editorModule.tocBookmarkId=0),this.heightInfoCollection={},this.owner.isDocumentLoaded=!1,this.viewer.columnLayoutArea.clear(),this.layout.isDocumentContainsRtl=!1,this.updateAuthorIdentity();for(var t=0;t<this.pages.length;t++)for(var i=0;i<this.pages[t].bodyWidgets.length;i++)this.pages[t].bodyWidgets[i].destroy();this.pages=[],sf.base.isNullOrUndefined(this.renderedLists)||this.renderedLists.clear(),sf.base.isNullOrUndefined(this.renderedLevelOverrides)||(this.renderedLevelOverrides=[]),sf.base.isNullOrUndefined(this.owner.editorHistory)||this.owner.editorHistory.destroy(),this.owner.isDocumentLoaded=!0,this.layout.isInitialLoad=!0,this.layout.footHeight=0,this.layout.footnoteHeight=0,this.layout.layoutItems(e,!1),this.owner.selection&&(this.selection.previousSelectedFormField=void 0,this.formFields.length>0&&this.owner.selection.highlightFormFields(),this.owner.selection.editRangeCollection=[],this.owner.selection.selectRange(this.owner.documentStart,this.owner.documentStart),this.isDocumentProtected&&(this.owner.selection.isHighlightEditRegion=!0)),this.owner.optionsPaneModule,this.owner.showRevisions&&this.owner.trackChangesPane.updateTrackChanges(!0),!sf.base.isNullOrUndefined(this.owner.selection)&&this.owner.selection.isViewPasteOptions&&(this.owner.selection.isViewPasteOptions=!1,this.owner.selection.showHidePasteOptions(void 0,void 0)),this.owner.fireDocumentChange()},e.prototype.initTouchEllipse=function(){var e="height: 30px;width: 30px;position: absolute;background-color: transparent;margin: 0px;padding: 0px;z-index:5",t=" height: 12px;width: 12px;border-radius: 50%;background-color: white;position: absolute;margin: 0px 6px 0px 6px;border-width: 2px;border-style: solid;border-color: #000000;box-sizing: unset;";this.touchStart=sf.base.createElement("div",{className:"e-touch-ellipse",styles:e});var i=sf.base.createElement("div",{styles:t});this.touchEnd=sf.base.createElement("div",{className:"e-touch-ellipse",styles:e}),this.touchStart.style.display="none";var r=sf.base.createElement("div",{styles:t});this.touchStart.appendChild(i),this.touchEnd.appendChild(r),this.touchEnd.style.display="none",this.viewerContainer.appendChild(this.touchStart),this.viewerContainer.appendChild(this.touchEnd)},e.prototype.updateTouchMarkPosition=function(){if("none"!==this.touchStart.style.display&&!sf.base.isNullOrUndefined(this.selection))if(this.selection.isEmpty)this.selection.updateCaretPosition();else{var e=this.selection.getCaretBottom(this.selection.start,!1),t=this.selection.getPage(this.selection.start.paragraph),i=t.boundingRectangle.y-this.owner.viewer.pageGap*(this.pages.indexOf(t)+1)*this.zoomFactor+this.owner.viewer.pageGap*(this.pages.indexOf(t)+1);this.touchStart.style.left=t.boundingRectangle.x+(Math.round(this.selection.start.location.x)*this.zoomFactor-14)+"px",this.touchStart.style.top=i+e*this.zoomFactor+"px",this.selection.isEmpty||(e=this.selection.getCaretBottom(this.selection.end,!1),t=this.selection.getPage(this.selection.end.paragraph)),this.touchEnd.style.left=t.boundingRectangle.x+(Math.round(this.selection.end.location.x)*this.zoomFactor-14)+"px",this.touchEnd.style.top=i+e*this.zoomFactor+"px"}},e.prototype.scrollForwardOnSelection=function(e){if(this.viewerContainer){this.viewerContainer.scrollTop=this.viewerContainer.scrollTop+200;var t=this.owner.viewer.findFocusedPage(e,!this.owner.enableHeaderAndFooter),i=this.owner.selection.end;this.owner.enableImageResizerMode&&this.owner.imageResizerModule.isImageResizerVisible&&!this.owner.imageResizerModule.isShapeResize||(this.skipScrollToPosition=!0,this.owner.selection.moveTextPosition(t,i,!0))}},e.prototype.scrollBackwardOnSelection=function(e){this.viewerContainer.scrollTop=this.viewerContainer.scrollTop-200;var t=this.owner.viewer.findFocusedPage(e,!this.owner.enableHeaderAndFooter),i=this.owner.selection.end;this.owner.enableImageResizerMode&&this.owner.imageResizerModule.isImageResizerVisible&&!this.owner.imageResizerModule.isShapeResize||(this.skipScrollToPosition=!0,this.owner.selection.moveTextPosition(t,i,!0))},e.prototype.isSelectionInListText=function(e){var t=this.getLineWidget(e);if(!sf.base.isNullOrUndefined(t)&&t.children[0]instanceof je){var i=this.getLeftValue(t),r=t.children[0].width,n=t.children[0].height;if(this.isInsideRect(i,t.paragraph.y,r,n,e))return this.selectionLineWidget=t,!0}return!1},e.prototype.isInShapeBorder=function(e,t){if(!sf.base.isNullOrUndefined(e)){var i=e.width,r=e.height;if(this.isInsideRect(e.x-e.margin.left,e.y-e.margin.top,i,r,t)){if(e instanceof Re)return!0;if(e instanceof Ee){var n=e.lineFormat.weight;if(!this.isInsideRect(e.x+n,e.y+n+e.textFrame.marginTop,i-2*n,r-(2*n+e.textFrame.marginTop+e.textFrame.marginBottom),t))return!0}}}return!1},e.prototype.isInsideRect=function(e,t,i,r,n){return n.x>e&&n.x<=e+i&&n.y>t&&n.y<=t+r},e.prototype.getLeftValue=function(e){var t=e.paragraph.x,i=e.paragraph.paragraphFormat;this.selection.isParagraphFirstLine(e)&&("Right"===i.textAlignment?(t-=x.convertPointToPixel(i.firstLineIndent),t-=x.convertPointToPixel(i.leftIndent)):t+=x.convertPointToPixel(i.firstLineIndent));var r=e.children[0];return r instanceof je&&(t+=r.margin.left),t},e.prototype.isLeftButtonPressed=function(e){return this.isTouchInput=!1,1===(e.which||e.button)},e.prototype.updateSelectionOnTouch=function(e,t){this.zoomX=void 0,this.zoomY=void 0,!this.isMouseDown||this.isSelectionChangedOnMouseMoved||sf.base.isNullOrUndefined(this.currentPage)||sf.base.isNullOrUndefined(this.owner.selection.start)||(0===this.touchDownOnSelectionMark&&(this.updateTextPositionForSelection(new M(t.x,t.y),this.tapCount),2===this.tapCount&&this.selection.checkAndEnableHeaderFooter(e,t)),this.owner.selection.isEmpty&&this.selection.updateCaretPosition(),this.selection.checkForCursorVisibility())},e.prototype.getTouchOffsetValue=function(e){var t=this.viewerContainer.getBoundingClientRect(),i=e.touches[0];sf.base.isNullOrUndefined(i)&&(i=e.changedTouches[0]);var r=i.pageX-t.left,n=i.pageY-t.top;return new M(r,n)},e.prototype.onPinchInInternal=function(e){this.preZoomFactor=this.zoomFactor;var t=this.zoomFactor-.01;t<5&&t>2&&(t-=.01),t<.1&&(t=.1),this.zoomFactor=t},e.prototype.onPinchOutInternal=function(e){this.preZoomFactor=this.zoomFactor;var t=this.zoomFactor+.01;t>2&&(t+=.01),t>5&&(t=5),this.zoomFactor=t},e.prototype.getPageWidth=function(e){return e.boundingRectangle.width},e.prototype.removePage=function(e){this.currentPage===e&&(this.currentPage=void 0),e.headerWidgetIn&&(e.headerWidgetIn.page=void 0),e.footerWidgetIn&&(e.footerWidgetIn.page=void 0);var t=this.pages.indexOf(e);if(this.pages.splice(t,1),!sf.base.isNullOrUndefined(this.owner.viewer.visiblePages)&&this.owner.viewer.visiblePages.indexOf(e)>-1){var i=this.owner.viewer.visiblePages.indexOf(e);this.owner.viewer.visiblePages.splice(i,1)}for(var r=0;r<this.pages.length;r++)this.pages[r].boundingRectangle.height;e.boundingRectangle.height;var n=20;if(t>0&&(n+=this.pages[t-1].boundingRectangle.bottom),-1!==t)for(r=t;r<this.pages.length;r++)(e=this.pages[r]).boundingRectangle=new $(e.boundingRectangle.x,n,e.boundingRectangle.width,e.boundingRectangle.height),n=e.boundingRectangle.bottom+20,sf.base.isNullOrUndefined(e.bodyWidgets[0].firstChild)||e.bodyWidgets[0].firstChild instanceof de&&e.bodyWidgets[0].firstChild.header||(e.repeatHeaderRowTableWidget=!1)},e.prototype.updateViewerSize=function(){var e=this,t=this.owner.getDocumentEditorElement();this.updateViewerSizeInternal(t),this.owner.viewer.updateScrollBars(),this.owner.viewer instanceof Z&&!sf.base.isNullOrUndefined(this.owner)&&!sf.base.isNullOrUndefined(t)&&(this.resizerTimer&&clearTimeout(this.resizerTimer),this.resizerTimer=setTimeout((function(){if(!sf.base.isNullOrUndefined(e.owner)){var t=void 0;t=sf.base.isNullOrUndefined(e.visibleBounds)?0:e.visibleBounds.width,sf.base.isNullOrUndefined(e.owner.viewer.preVisibleWidth)&&(e.owner.viewer.preVisibleWidth=0),sf.base.isNullOrUndefined(e.visibleBounds)||t===e.owner.viewer.preVisibleWidth||(e.owner.editorModule.layoutWholeDocument(),e.owner.viewer.preVisibleWidth=t),e.resizerTimer&&clearTimeout(e.resizerTimer)}}),50)),sf.base.isNullOrUndefined(this.selection)||this.selection.updateCaretPosition()},e.prototype.updateViewerSizeInternal=function(e){if(!sf.base.isNullOrUndefined(e)){var t=e.getBoundingClientRect(),i=0,r=0;r=t.height>0?t.height:200;var n=void 0,o=void 0,s=void 0;if(this.restrictEditingElement&&(n="none"!==this.restrictEditingElement.style.display?this.restrictEditingElement.getBoundingClientRect():void 0),this.optionsPaneElement&&(o="none"!==this.optionsPaneElement.style.display?this.optionsPaneElement.getBoundingClientRect():void 0),this.commentPaneElement&&(s="none"!==this.commentPaneElement.style.display?this.commentPaneElement.getBoundingClientRect():void 0),n||o||s){var a=n?n.width:0;a+=o?o.width:0,a+=s?s.width:0,i=t.width-a>0?t.width-a:200}else i=t.width>0?t.width:200;this.viewerContainer.style.height=r.toString()+"px",this.viewerContainer.style.width=Math.ceil(i)+"px",this.visibleBoundsIn=new $(0,0,i,r),this.containerCanvas.width=i,this.containerCanvas.height=r,this.selectionCanvas.width=i,this.selectionCanvas.height=r,this.measureScrollbarWidth(e)}},e.prototype.insertPage=function(e,t){this.pages.indexOf(t)>-1&&this.pages.splice(this.pages.indexOf(t),1),this.pages.splice(e,0,t);var i=20;e>0&&(i+=this.pages[e-1].boundingRectangle.bottom);for(var r=e;r<this.pages.length;r++)(t=this.pages[r]).boundingRectangle=new $(t.boundingRectangle.x,i,t.boundingRectangle.width,t.boundingRectangle.height),i=t.boundingRectangle.bottom+20},e.prototype.updateTextPositionForSelection=function(e,t){var i=this.getLineWidget(e);if(sf.base.isNullOrUndefined(i)||this.selection.updateTextPosition(i,e),t>1){if(this.isMouseDown=!1,this.useTouchSelectionMark=!1,0===this.pages.length)return;sf.base.isNullOrUndefined(this.currentPage)||sf.base.isNullOrUndefined(this.owner.selection.start)||(t%2==0?this.owner.selection.selectCurrentWord():this.owner.selection.selectParagraph())}},e.prototype.scrollToPosition=function(e,t,i,r){if(this.skipScrollToPosition||this.isWebPrinting)this.skipScrollToPosition=!1;else if(!(this.owner.enableImageResizerMode&&this.owner.imageResizerModule.isImageResizing||this.isMouseDownInFooterRegion||this.isRowOrCellResizing)){var n=this.selection.getLineWidgetInternal(t.currentWidget,t.offset,!0);if(!sf.base.isNullOrUndefined(n)){this.selection.getTop(n);if(this.isMouseDown){var o=this.selection.getLineWidgetInternal(t.currentWidget,t.offset,!1),s=this.selection.getTop(o);o!==n&&t.location.y>=s&&(n=o)}n.height;var a=this.selection.getPage(n.paragraph);this.currentPage=a;var l=0,h=0;this.owner.viewer,this.owner.viewer;if(!sf.base.isNullOrUndefined(a)){var d=a.boundingRectangle.width;(l=(this.visibleBounds.width-d*this.zoomFactor)/2)<30&&(l=30),h=a.boundingRectangle.y*this.zoomFactor+(this.pages.indexOf(a)+1)*this.owner.viewer.pageGap*(1-this.zoomFactor);var c=this.owner.viewer.containerTop,p=this.owner.viewer.containerLeft,u=this.visibleBounds.height,g=this.selection.updateCaretSize(this.owner.selection.end,!0),f=g.topMargin,m=g.height;l+=t.location.x*this.zoomFactor,h+=(t.location.y+f)*this.zoomFactor,r?this.viewerContainer.scrollTop=h-96:c+20>h?this.viewerContainer.scrollTop=h-10:c+u<h+m&&(this.viewerContainer.scrollTop=h+m-u+10),i||this.selection.updateCaretToPage(e,a);var y=this.viewerContainer.offsetWidth-this.viewerContainer.clientWidth;p>l?this.viewerContainer.scrollLeft=l-this.pageContainer.offsetWidth/100*20:p+this.visibleBounds.width<l+y&&(this.viewerContainer.scrollLeft=p+this.pageContainer.offsetWidth/100*15+y)}}}},e.prototype.getLineWidget=function(e){return this.getLineWidgetInternal(e,!1)},e.prototype.getLineWidgetInternal=function(e,t){var i=void 0;if(!sf.base.isNullOrUndefined(this.currentPage)){var r=void 0;if(this.owner.enableHeaderAndFooter){var n=this.currentPage,o=n.boundingRectangle.height,s=Math.max(n.headerWidget.y+n.headerWidget.height,x.convertPointToPixel(n.bodyWidgets[0].sectionFormat.topMargin))*this.zoomFactor,a=x.convertPointToPixel(n.bodyWidgets[0].sectionFormat.footerDistance),l=n.boundingRectangle.height-Math.max(n.footerWidget.height+a,2*a);if(t?r=this.isBlockInHeader(this.selection.start.paragraph)?this.currentPage.headerWidget:this.currentPage.footerWidget:e.y<=o&&e.y>=l?r=this.currentPage.footerWidget:e.y>=0&&e.y<=s&&(r=this.currentPage.headerWidget),sf.base.isNullOrUndefined(r))return;var h=this.checkFloatingItems(r,e,t);return h.isShapeSelected?h.isInShapeBorder?h.element.line:this.selection.getLineWidgetBodyWidget(h.element.textFrame,e):this.selection.getLineWidgetBodyWidget(r,e)}var d=this.checkFloatingItems(this.currentPage.bodyWidgets[0],e,t,!1),c=this.checkFloatingItems(this.currentPage.bodyWidgets[0],e,t,!0);if(d.isShapeSelected&&!this.isEmptyShape(d)){if(d.isInShapeBorder)return d.element.line;d.element instanceof Ee&&(i=this.selection.getLineWidgetBodyWidget(d.element.textFrame,e))}else if(t&&this.isFootnoteWidget){if(void 0!==this.selection.start.paragraph.bodyWidget.footNoteReference&&this.selection.start.paragraph.bodyWidget.containerWidget instanceof ae&&"Footnote"===this.selection.start.paragraph.bodyWidget.containerWidget.footNoteType)return this.selection.getLineWidgetBodyWidget(this.currentPage.footnoteWidget,e);if(void 0!==this.selection.start.paragraph.bodyWidget.footNoteReference&&this.selection.start.paragraph.bodyWidget.containerWidget instanceof ae&&"Endnote"===this.selection.start.paragraph.bodyWidget.containerWidget.footNoteType)return this.selection.getLineWidgetBodyWidget(this.currentPage.endnoteWidget,e)}else if(!t&&this.currentPage.footnoteWidget&&this.isInFootnoteWidget(this.currentPage.footnoteWidget,e))(i=this.selection.getLineWidgetBodyWidget(this.currentPage.footnoteWidget,e))&&(this.isFootnoteWidget=!0);else if(!t&&this.currentPage.endnoteWidget&&this.isInFootnoteWidget(this.currentPage.endnoteWidget,e))(i=this.selection.getLineWidgetBodyWidget(this.currentPage.endnoteWidget,e))&&(this.isFootnoteWidget=!0);else for(var p=0;p<this.currentPage.bodyWidgets.length;p++){var u=this.currentPage.bodyWidgets[p];if(p<this.currentPage.bodyWidgets.length-1&&e.x<=u.x+u.width&&(i=this.selection.getLineWidgetBodyWidget(u,e,!0),!sf.base.isNullOrUndefined(i)&&i.paragraph.y<=e.y&&i.paragraph.y+i.paragraph.height>=e.y)){this.isFootnoteWidget=!1;break}if(p==this.currentPage.bodyWidgets.length-1&&(i=this.selection.getLineWidgetBodyWidget(u,e,!0),!sf.base.isNullOrUndefined(i)&&i.paragraph.y<=e.y&&i.paragraph.y+i.paragraph.height>=e.y)){this.isFootnoteWidget=!1;break}if(e.x<u.x&&p<this.currentPage.bodyWidgets.length-1&&(i=this.selection.getLineWidgetBodyWidget(u,e,!0),!sf.base.isNullOrUndefined(i))){this.isFootnoteWidget=!1;break}}var g=this.checkInlineShapeItems(i,e,t);if(g.isShapeSelected){if(g.isInShapeBorder)return g.element.line;g.element instanceof Ee&&(i=this.selection.getLineWidgetBodyWidget(g.element.textFrame,e))}else if(!this.checkPointIsInLine(i,e)&&c.isShapeSelected){if(c.isInShapeBorder)return c.element.line;c.element instanceof Ee&&(i=this.selection.getLineWidgetBodyWidget(c.element.textFrame,e))}}return i},e.prototype.checkInlineShapeItems=function(e,t,i){var r,n=!1,o=!1,s=this.selection.isInShape,a=i&&s;if(!sf.base.isNullOrUndefined(e)&&e.children.length>0)if(a){var l=this.owner.selection.getCurrentTextFrame();l&&(r=l.containerShape,n=!0)}else{for(var h=0;h<e.children.length;h++)if(e.children[h]instanceof Ee&&"Inline"===e.children[h].textWrappingStyle&&(r=e.children[h],t.x<r.x+r.margin.left+r.width&&t.x>r.x&&t.y<r.y+r.margin.top+r.height&&t.y>r.y)){n=!0,this.isInShapeBorder(r,t)&&(o=!0);break}i&&!s&&(n=!1)}return{element:r,caretPosition:t,isShapeSelected:n,isInShapeBorder:o}},e.prototype.checkPointIsInLine=function(e,t){if(!sf.base.isNullOrUndefined(e)&&e.children.length>0)for(var i=void 0,r=e.paragraph.x,n=this.selection.getTop(e),o=e.children.indexOf(e.children[0]);o<e.children.length;o++)if(!((i=e.children[o])instanceof De&&"Inline"!==i.textWrappingStyle)){if(t.x<r+i.margin.left+i.width+i.padding.left&&t.x>r&&t.y<n+e.height&&t.y>n)return!0;r+=i.margin.left+i.width+i.padding.left}return!1},e.prototype.isInFootnoteWidget=function(e,t){for(var i=0;i<e.bodyWidgets.length;i++)for(var r=0;r<e.bodyWidgets[i].childWidgets.length;r++){var n=e.bodyWidgets[i].childWidgets[r];if(n instanceof ie&&n.y<=t.y&&n.y+n.height>=t.y)return!0}return!1},e.prototype.checkFloatingItems=function(e,t,i,r){var n,o=!1,s=!1,a=this.selection.isInShape,l=i&&a;if(e.floatingElements.length>0){this.currentPage;if(e.floatingElements.sort((function(e,t){return e instanceof de||t instanceof de?0:e.zOrderPosition-t.zOrderPosition})),l){var h=this.owner.selection.getCurrentTextFrame();h&&(n=h.containerShape,o=!0)}else{for(var d=e.floatingElements.length-1;d>=0;d--)if(!(e.floatingElements[d]instanceof de||(!sf.base.isNullOrUndefined(r)&&r?"Behind"!==e.floatingElements[d].textWrappingStyle:"Behind"===e.floatingElements[d].textWrappingStyle))&&(n=e.floatingElements[d],t.x<n.x+n.margin.left+n.width&&t.x>n.x&&t.y<n.y+n.margin.top+n.height&&t.y>n.y)){o=!0,this.isInShapeBorder(n,t)&&(s=!0);break}i&&!a&&(o=!1)}}return{element:n,caretPosition:t,isShapeSelected:o,isInShapeBorder:s}},e.prototype.isBlockInHeader=function(e){for(;!(e.containerWidget instanceof oe);){if(!e.containerWidget)return!1;(e=e.containerWidget)instanceof ze&&(e=e.containerShape.paragraph)}return-1!==e.containerWidget.headerFooterType.indexOf("Header")},e.prototype.clearSelectionHighlight=function(){!this.isControlPressed||this.isMouseDown,this.owner.selection.clearSelectionHighlightInSelectedWidgets()&&this.selectionContext.clearRect(0,0,this.selectionCanvas.width,this.selectionCanvas.height)},e.prototype.removeEmptyPages=function(){for(var e=!1,t=0;t<this.pages.length;t++){for(var i=this.pages[t],r=0;r<i.bodyWidgets.length;r++)if((0===i.bodyWidgets.length||0===i.bodyWidgets[r].childWidgets.length)&&i.bodyWidgets.length>=1){var n=i.bodyWidgets.indexOf(i.bodyWidgets[r]);i.bodyWidgets.splice(n,1),r--}i.bodyWidgets.length<=0&&(t===this.pages.length-1&&this.owner.viewer instanceof X&&-1!==this.owner.viewer.visiblePages.indexOf(this.pages[t])&&(e=!0),this.removePage(this.pages[t]),t--)}e&&this.scrollToBottom()},e.prototype.scrollToBottom=function(){if(this.selection.start.paragraph&&this.selection.start.paragraph.bodyWidget){var e=this.selection.start.paragraph.bodyWidget.page,t=this.visibleBounds.height;this.viewerContainer.scrollTop=e.boundingRectangle.bottom-t}},e.prototype.getFieldResult=function(e,t){if(!sf.base.isNullOrUndefined(t)&&!sf.base.isNullOrUndefined(this.selection)){var i=this.selection.getFieldCode(e).split("*"),r=i[0].replace(/[^\w\s]/gi,"").trim().toLowerCase(),n="";switch(i.length>1&&" MERGEFORMAT"!==i[1]&&(n=i[1].replace(/[^\w\s]/gi,"").trim()),""==n&&(n=t.bodyWidgets[0].sectionFormat.pageNumberStyle),r=r.match("numpages")||r.match("sectionpages")||!r.match("page")?r:"page"){case"page":if(t.bodyWidgets[0].sectionFormat.restartPageNumbering&&0!==t.sectionIndex){var o=t.sectionIndex,s=t.previousPage;return o!==s.sectionIndex?(t.currentPageNum=t.bodyWidgets[0].sectionFormat.pageStartingNumber,this.getFieldText(n,t.currentPageNum)):(1===s.currentPageNum&&(s.currentPageNum=t.bodyWidgets[0].sectionFormat.pageStartingNumber),t.currentPageNum=s.currentPageNum+1,this.getFieldText(n,t.currentPageNum))}return t.bodyWidgets[0].sectionFormat.restartPageNumbering&&0===t.sectionIndex?(t.currentPageNum=t.bodyWidgets[0].sectionFormat.pageStartingNumber+t.index,this.getFieldText(n,t.currentPageNum)):(t.currentPageNum=sf.base.isNullOrUndefined(t.previousPage)?t.index+1:t.previousPage.currentPageNum+1,t.currentPageNum=t.index+1,this.getFieldText(n,t.currentPageNum));case"numpages":return this.getFieldText(n,t.documentHelper.pages.length);case"sectionpages":for(var a=t.sectionIndex,l=0,h=0;h<t.documentHelper.pages.length;h++)if(t.documentHelper.pages[h].sectionIndex===a)l++;else if(0!==l)break;return this.getFieldText(n,l)}}return""},e.prototype.getFieldText=function(e,t){switch(e){case"ALPHABETIC":return this.layout.getAsLetter(t).toUpperCase();case"alphabetic":return this.layout.getAsLetter(t).toLowerCase();case"roman":return this.layout.getAsRoman(t).toLowerCase();case"ROMAN":case"RomanUpper":return this.layout.getAsRoman(t).toUpperCase();case"RomanLower":return this.layout.getAsRoman(t).toLowerCase();case"LetterUpper":return this.layout.getAsLetter(t).toUpperCase();case"LetterLower":return this.layout.getAsLetter(t).toLowerCase();default:return t.toString()}},e.prototype.isEmptyShape=function(e){return e.element instanceof Re||0===e.element.textFrame.childWidgets.length},e.prototype.destroy=function(){sf.base.isNullOrUndefined(this.owner)||this.unWireEvent(),this.pages=[],this.pages=void 0,this.fieldStacks=[],this.fieldStacks=void 0,this.splittedCellWidgets=[],this.splittedCellWidgets=void 0,this.fields=[],this.fields=void 0,this.layout&&this.layout.destroy(),this.layout=void 0,sf.base.isNullOrUndefined(this.render)||this.render.destroy(),this.render=void 0,this.dialogTarget1&&this.dialogTarget1.parentElement&&this.dialogTarget1.parentElement.removeChild(this.dialogTarget1),this.dialogTarget1=void 0,this.dialogTarget2&&this.dialogTarget2.parentElement&&this.dialogTarget2.parentElement.removeChild(this.dialogTarget2),this.dialogTarget2=void 0,this.dialogTarget3&&this.dialogTarget3.parentElement&&this.dialogTarget3.parentElement.removeChild(this.dialogTarget3),this.dialogTarget3=void 0,sf.base.isNullOrUndefined(this.touchStart)||(this.touchStart.innerHTML=""),this.textHelper&&this.textHelper.destroy(),this.textHelper=void 0,this.touchStart=void 0,sf.base.isNullOrUndefined(this.touchEnd)||(this.touchEnd.innerHTML=""),this.touchEnd=void 0,sf.base.isNullOrUndefined(this.containerCanvasIn)||(this.containerCanvasIn.innerHTML=""),this.containerCanvasIn=void 0,sf.base.isNullOrUndefined(this.selectionCanvasIn)||(this.selectionCanvasIn.innerHTML=""),this.selectionCanvasIn=void 0,sf.base.isNullOrUndefined(this.editableDiv)||(this.editableDiv.innerHTML="",sf.base.isNullOrUndefined(this.editableDiv.parentElement)||this.editableDiv.parentElement.removeChild(this.editableDiv)),this.editableDiv=void 0,sf.base.isNullOrUndefined(this.pageContainer)||(this.pageContainer.innerHTML=""),this.pageContainer=void 0,sf.base.isNullOrUndefined(this.viewerContainer)||(this.viewerContainer.innerHTML=""),this.viewerContainer=void 0,this.owner=void 0,this.heightInfoCollection=void 0},e.prototype.unWireEvent=function(){this.viewerContainer.removeEventListener("scroll",this.scrollHandler),this.viewerContainer.removeEventListener("mousedown",this.onMouseDownInternal),this.viewerContainer.removeEventListener("mousemove",this.onMouseMoveInternal),sf.base.Browser.isDevice?this.editableDiv.removeEventListener("input",this.onTextInputInternal):(this.editableDiv.removeEventListener("keypress",this.onKeyPressInternal),"chrome"===sf.base.Browser.info.name&&this.editableDiv.removeEventListener("textInput",this.onTextInput)),this.editableDiv.removeEventListener("paste",this.onPaste),this.viewerContainer.removeEventListener("contextmenu",this.onContextMenu),this.editableDiv.removeEventListener("blur",this.onFocusOut),this.editableDiv.removeEventListener("keydown",this.onKeyDownInternal),this.editableDiv.removeEventListener("compositionstart",this.compositionStart),this.editableDiv.removeEventListener("compositionupdate",this.compositionUpdated),this.editableDiv.removeEventListener("compositionend",this.compositionEnd),this.viewerContainer.removeEventListener("mouseup",this.onMouseUpInternal),sf.base.isNullOrUndefined(this.iframe)||this.iframe.removeEventListener("load",this.onIframeLoad),this.viewerContainer.removeEventListener("dblclick",this.onDoubleTap),window.removeEventListener("resize",this.onWindowResize),window.removeEventListener("keyup",this.onKeyUpInternal),window.removeEventListener("mouseup",this.onImageResizer.bind(this)),window.removeEventListener("touchend",this.onImageResizer.bind(this))},e.prototype.updateCursor=function(e){var t,i,r,n=void 0,o=void 0,s=this.viewerContainer,a=new M(e.offsetX,e.offsetY),l=this.owner.viewer.findFocusedPage(a,!0),h=this.getLineWidget(l),d=this.owner.isReadOnlyMode?void 0:this.owner.editorModule,c=!!d&&d.tableResize.isInRowResizerArea(l),p=!!d&&d.tableResize.isInCellResizerArea(l),u=this.selection.checkAllFloatingElements(h,l),g="";if(this.owner.enableImageResizerMode){var f=this.owner.imageResizerModule.getImagePoint(l);this.owner.imageResizerModule.selectedResizeElement=f.selectedElement,g=f.resizePosition}var m=0,y=void 0,v=this.checkPointIsInLine(h,l);if(!sf.base.isNullOrUndefined(h)){if(m=this.selection.getLineStartLeft(h),n=this.selection.getHyperLinkFieldInCurrentSelection(h,l),sf.base.isNullOrUndefined(n)&&(y=this.selection.getHyperLinkFieldInCurrentSelection(h,l,!0)),!sf.base.isNullOrUndefined(n)){var b=this.selection.getFieldCode(n);0!==b.toLowerCase().indexOf("ref ")||b.match("\\h")||(n=void 0)}if(t=this.selection.updateTextPositionIn(h,void 0,0,l,!0),i=this.selection.getLeft(h),r=this.selection.getTop(h),sf.base.isNullOrUndefined(n)&&!sf.base.isNullOrUndefined(y)&&this.isDocumentProtected&&"FormFieldsOnly"===this.protectionType&&!this.isFormFilling?this.selection.setHyperlinkContentToToolTip(y,h,l.x,!0):this.selection.setHyperlinkContentToToolTip(n,h,l.x,!1),y){var w=y.formFieldData instanceof ye&&"Text"===y.formFieldData.type;"Inline"===this.owner.documentEditorSettings.formFieldSettings.formFillingMode&&w&&(y=void 0)}}sf.base.isNullOrUndefined(h)||sf.base.isNullOrUndefined(o)&&"Pages"==this.owner.layoutType&&(o=this.selection.getFootNoteElementInCurrentSelection(h,l))instanceof Me&&this.selection.setFootnoteContentToToolTip(o,h,l.x);var x=this.isIosDevice?e.metaKey:e.ctrlKey;!sf.base.isNullOrUndefined(n)&&(x&&this.owner.useCtrlClickToFollowHyperlink||!this.owner.useCtrlClickToFollowHyperlink)||y?sf.base.isNullOrUndefined(y)?s.style.cursor="pointer":this.isFormFillProtectedMode&&(s.style.cursor="default"):(l.x>=m&&e.offsetX<this.visibleBounds.width-(this.visibleBounds.width-this.viewerContainer.clientWidth)&&e.offsetY<this.visibleBounds.height-(this.visibleBounds.height-this.viewerContainer.clientHeight)?this.selection.isEmpty?s.style.cursor="text":s.style.cursor=this.selection.checkCursorIsInSelection(h,l)?"default":"text":s.style.cursor="default",sf.base.isNullOrUndefined(g)||""===g?!sf.base.isNullOrUndefined(t)&&t.isImageSelected&&i<l.x&&r<l.y&&i+h.width>l.x&&r+h.height>l.y&&(s.style.cursor="move"):(!this.owner.imageResizerModule.isShapeResize||this.owner.imageResizerModule.isShapeResize&&"move"!==g)&&(s.style.cursor=g),c?s.style.cursor="row-resize":p&&(s.style.cursor="col-resize"),u.isInShapeBorder&&!v&&(s.style.cursor="all-scroll"))},e.prototype.canRenderBorder=function(e){var t,i,r,n,o=!1,s=!1,a=e.previousRenderedWidget,l=e.nextRenderedWidget,h=this.getParagraphLeftPosition(e),d=0,c=0;return!sf.base.isNullOrUndefined(a)&&a instanceof le&&(d=this.getParagraphLeftPosition(a)),!sf.base.isNullOrUndefined(l)&&l instanceof le&&(c=this.getParagraphLeftPosition(l)),!sf.base.isNullOrUndefined(a)&&a instanceof le&&h===d&&(t=e.paragraphFormat.borders.top.isEqualFormat(a.paragraphFormat.borders.top),i=e.paragraphFormat.borders.bottom.isEqualFormat(a.paragraphFormat.borders.bottom),r=e.paragraphFormat.borders.left.isEqualFormat(a.paragraphFormat.borders.left),n=e.paragraphFormat.borders.right.isEqualFormat(a.paragraphFormat.borders.right),t&&i&&r&&n&&"None"===a.paragraphFormat.borders.horizontal.lineStyle&&(o=!0)),!sf.base.isNullOrUndefined(l)&&l instanceof le&&(h===c||this.owner.documentHelper.layout.isInitialLoad&&this.skipBottomBorder(e,l))&&(t=e.paragraphFormat.borders.top.isEqualFormat(l.paragraphFormat.borders.top),i=e.paragraphFormat.borders.bottom.isEqualFormat(l.paragraphFormat.borders.bottom),r=e.paragraphFormat.borders.left.isEqualFormat(l.paragraphFormat.borders.left),n=e.paragraphFormat.borders.right.isEqualFormat(l.paragraphFormat.borders.right),i&&t&&r&&n&&(s=!0)),{skipTopBorder:o,skipBottomBorder:s}},e.prototype.getParagraphLeftPosition=function(e){var t=0;return e.paragraphFormat.firstLineIndent<0&&(t=x.convertPointToPixel(Math.abs(e.paragraphFormat.firstLineIndent)),t=parseFloat(t.toFixed(5))),e.isEmpty()&&"Left"!==e.paragraphFormat.textAlignment&&"Justify"!==e.paragraphFormat.textAlignment?e.clientX>t?e.clientX-t:e.clientX:e.x>t?e.x-t:e.x},e.prototype.skipBottomBorder=function(e,t){var i=0,r=0;return e.paragraphFormat.leftIndent===t.paragraphFormat.leftIndent||(i=e.paragraphFormat.firstLineIndent<0?Math.abs(e.paragraphFormat.firstLineIndent):0,r=t.paragraphFormat.firstLineIndent<0?Math.abs(t.paragraphFormat.firstLineIndent):0,(i=e.paragraphFormat.leftIndent>i?e.paragraphFormat.leftIndent-i:0)===(r=t.paragraphFormat.leftIndent>r?t.paragraphFormat.leftIndent-r:0))},e.prototype.isPageInVisibleBound=function(e,t){var i=this.visibleBounds.height,r=this.viewerContainer.scrollTop,n=e.boundingRectangle.height*this.zoomFactor;return t>=r&&t<=r+i||t+n>=r&&t+n<=r+i||t<=r&&t+n>=r+i},e.prototype.getFirstParagraphInCell=function(e){var t=e.childWidgets[0];return t instanceof le?t:this.getFirstParagraphInFirstCell(t)},e.prototype.getFirstParagraphInFirstCell=function(e){if(!sf.base.isNullOrUndefined(e.childWidgets)&&e.childWidgets.length>0){var t=e.childWidgets[0].childWidgets[0].childWidgets[0];return this.getFirstParagraphBlock(t)}},e.prototype.getLastParagraphInLastCell=function(e){if(!sf.base.isNullOrUndefined(e.childWidgets)&&e.childWidgets.length>0){var t=e.lastChild.lastChild.lastChild;return this.getLastParagraphBlock(t)}},e.prototype.getFirstParagraphBlock=function(e){return e instanceof le?e:e instanceof de?this.getFirstParagraphInFirstCell(e):void 0},e.prototype.getLastParagraphBlock=function(e){return e instanceof le?e:e instanceof de?this.getLastParagraphInLastCell(e):void 0},e.prototype.getLastParagraphInFirstRow=function(e){if(e.childWidgets.length>0){var t=e.firstChild.lastChild.lastChild;return this.getLastParagraphBlock(t)}},e.prototype.getFirstParagraphInLastRow=function(e){if(e.childWidgets.length>0){var t=e.childWidgets[e.childWidgets.length-1].childWidgets[0].childWidgets[0];return this.getFirstParagraphBlock(t)}},e}(),G=function(){function e(e){this.visiblePages=[],this.padding=new ee(10,10,10,10),this.textWrap=!0,this.pageFitTypeIn="None",this.containerTop=0,this.containerLeft=0,this.owner=e,this.columnLayoutArea=new K(this)}return Object.defineProperty(e.prototype,"documentHelper",{get:function(){return this.owner.documentHelper},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pageFitType",{get:function(){return this.pageFitTypeIn},set:function(e){this.pageFitTypeIn=e,this.onPageFitTypeChanged(this.pageFitTypeIn)},enumerable:!0,configurable:!0}),e.prototype.updateClientArea=function(e,t,i){var r;sf.base.isNullOrUndefined(e)||(r=e.sectionFormat,this.columnLayoutArea.setColumns(r));var n=0,o=0;if(this instanceof Z){(n=(this.documentHelper.visibleBounds.width-4*this.padding.right-2*this.padding.left)/this.documentHelper.zoomFactor)<0&&(n=0),o=Number.POSITIVE_INFINITY,this.clientArea=new $(this.padding.left/this.documentHelper.zoomFactor,0,n,o),this.clientActiveArea=new $(this.clientArea.x,this.clientArea.y,this.clientArea.width,this.clientArea.height)}else{var s=0,a=48,l=48,h=x.convertPointToPixel(r.pageHeight),d=x.convertPointToPixel(r.bottomMargin);sf.base.isNullOrUndefined(r)||(s=x.convertPointToPixel(r.topMargin),a=x.convertPointToPixel(r.headerDistance),l=x.convertPointToPixel(r.footerDistance));var c=!1;sf.base.isNullOrUndefined(t.headerWidget)||(!(c=t.headerWidget.isEmpty)||c&&this.owner.enableHeaderAndFooter)&&(s=Math.min(Math.max(a+t.headerWidget.height,s),h/100*40));var p=.667+d;if(!sf.base.isNullOrUndefined(t.footerWidget)){c=t.footerWidget.isEmpty;var u=sf.base.isNullOrUndefined(t.footnoteWidget)?0:t.footnoteWidget.height;u=Math.min(u,(h-s-p)/100*90),(!c||c&&this.owner.enableHeaderAndFooter)&&(p=.667+Math.min(h/100*40,Math.max(l+t.footerWidget.height,d))),p+=u}sf.base.isNullOrUndefined(r)||(n=x.convertPointToPixel(r.pageWidth-r.leftMargin-r.rightMargin),o=h-s-p),n<0&&(n=0);var g=new $(x.convertPointToPixel(r.leftMargin),s,n,h-s-p);if(t.footnoteWidget&&!i&&0!==t.footnoteWidget.y&&this.clientArea.y+this.clientArea.height>t.footnoteWidget.y){var f=this.clientArea.y+this.clientArea.height-t.footnoteWidget.y;this.clientArea.height-=f/2}this.setClientArea(e,g),this.clientActiveArea=new $(this.clientArea.x,this.clientArea.y,this.clientArea.width,this.clientArea.height)}},e.prototype.setClientArea=function(e,t){this.clientArea=this.columnLayoutArea.getColumnBoundsByBodyWidget(e,t),e.x=this.clientArea.x,e.width=this.clientArea.width},e.prototype.updateClientAreaTopOrLeft=function(e,t){t&&(this.clientActiveArea.y=this.clientActiveArea.y+e.topBorderWidth,this.clientActiveArea.x=this.clientActiveArea.x+e.leftBorderWidth)},e.prototype.updateClientAreaForTable=function(e){this.clientActiveArea.x=this.clientArea.x=e.x,this.clientActiveArea.width=this.clientArea.width=e.width},e.prototype.updateClientAreaForRow=function(e,t){var i=e.ownerTable;t||(this.clientActiveArea.x=this.clientArea.x=i.x,this.clientActiveArea.width=this.clientArea.width=i.width,this.clientArea=new $(this.clientArea.x,this.clientArea.y,this.clientArea.width,this.clientArea.height),this.clientActiveArea=new $(this.clientActiveArea.x,this.clientActiveArea.y,this.clientActiveArea.width,this.clientActiveArea.height))},e.prototype.updateClientAreaForCell=function(e,t){var i=e.ownerRow,r=e;if(t)this.clientActiveArea.x=this.clientArea.x=r.x,this.clientActiveArea.y=r.y,this.clientActiveArea.width=this.clientArea.width=r.width>0?r.width:0,this instanceof X&&(this.clientActiveArea.height=Number.POSITIVE_INFINITY),this.clientArea=new $(this.clientArea.x,this.clientArea.y,this.clientArea.width,this.clientArea.height),this.clientActiveArea=new $(this.clientActiveArea.x,this.clientActiveArea.y,this.clientActiveArea.width,this.clientActiveArea.height);else{if(this.clientActiveArea.x=this.clientArea.x=r.x+r.width+r.margin.right,i.x+i.width-this.clientArea.x<0?this.clientActiveArea.width=this.clientArea.width=0:this.clientActiveArea.width=this.clientArea.width=i.x+i.width-this.clientArea.x,this.clientActiveArea.y=r.y-r.margin.top-x.convertPointToPixel(e.ownerTable.tableFormat.cellSpacing),!e.ownerTable.isInsideTable&&(this.clientActiveArea.height=this.clientArea.bottom-i.y>0?this.clientArea.bottom-i.y:0,!e.ownerTable.wrapTextAround&&this.documentHelper.layout.existFootnoteHeight>0)){var n=this.clientActiveArea.height-this.documentHelper.layout.existFootnoteHeight;this.clientActiveArea.height=n<0?0:n}this.clientArea=new $(this.clientArea.x,this.clientArea.y,this.clientArea.width,this.clientArea.height),this.clientActiveArea=new $(this.clientActiveArea.x,this.clientActiveArea.y,this.clientActiveArea.width,this.clientActiveArea.height)}},e.prototype.updateClientAreaForTextBoxShape=function(e,t){if("Inline"===e.textWrappingStyle&&(e.y=this.clientActiveArea.y,e.x=this.clientActiveArea.x),t){var i=x.convertPointToPixel(e.textFrame.marginLeft),r=x.convertPointToPixel(e.textFrame.marginRight),n=x.convertPointToPixel(e.textFrame.marginTop),o=x.convertPointToPixel(e.textFrame.marginBottom),s=e.width,a=Number.POSITIVE_INFINITY;this.clientArea=new $(e.x+i,e.y+n,s-i-r,a-n-o),this.clientActiveArea=new $(this.clientArea.x,this.clientArea.y,this.clientArea.width,this.clientArea.height)}},e.prototype.updateClientAreaByWidgetFootNote=function(e){this.clientArea.x=e.x,this.clientArea.y=e.y,this.clientActiveArea.x=e.x,this.clientActiveArea.y=e.y},e.prototype.updateClientAreaForTextWrap=function(e){this.clientActiveArea=new $(e.x,e.y,e.width,e.height)},e.prototype.updateBoundsBasedOnTextWrap=function(e){var t=e-this.clientActiveArea.y;this.clientActiveArea.y=e,this.clientActiveArea.height=this.clientActiveArea.height-t},e.prototype.updateClientAreaByWidget=function(e){this.clientArea.x=e.x,this.clientArea.y=e.y,this.clientActiveArea.x=e.x,this.clientActiveArea.y=e.y},e.prototype.updateClientAreaLocation=function(e,t){e.x=t.x,e.y=t.y,e.width=t.width},e.prototype.updateClientAreaForBlock=function(e,t,i,r){var n=x.convertPointToPixel(e.leftIndent),o=x.convertPointToPixel(e.rightIndent),s=e.bidi,a=0;if(t)if(e instanceof de&&i){var l=i[0];e.bodyWidget.sectionFormat.columns.length<=1&&(this.clientActiveArea.x=this.clientArea.x=l.x,this.clientActiveArea.width=this.clientArea.width=l.width),(l=i[i.length-1]).x=this.clientActiveArea.x,l.y=this.clientActiveArea.y}else{if(e instanceof de&&!sf.base.isNullOrUndefined(e.tableFormat))if(e.isGridUpdated||(e.buildTableColumns(),e.isGridUpdated=!0),"Left"!==(c=this.tableAlignmentForBidi(e,s))){var h=0;h=0===(h=x.convertPointToPixel(e.tableHolder.getTotalWidth(0)))?0===e.tableHolder.tableWidth?e.getTableClientWidth(e.getOwnerWidth(!1)):e.tableHolder.tableWidth:h,this.owner.editor&&this.owner.editor.tableResize.currentResizingTable===e&&0===this.owner.editor.tableResize.resizerPosition&&(h=x.convertPointToPixel(e.tableHolder.tableWidth)),"Center"===c?(this.documentHelper.isRowOrCellResizing||(h=e.getTableCellWidth()),n=(this.clientArea.width-h)/2):n=this.clientArea.width-h,s&&(o=n-=x.convertPointToPixel(e.leftIndent)),e.isInsideTable,this.documentHelper.tableLefts.push(n)}a=this.clientArea.width-(n+x.convertPointToPixel(e.rightIndent));var d=this.clientArea.x+(s?o:n);a=a>0?a:0,this.clientActiveArea.x=this.clientArea.x=d,this.clientActiveArea.width=this.clientArea.width=a,r&&this.updateParagraphYPositionBasedonTextWrap(e,new $(this.clientActiveArea.x,this.clientActiveArea.y,this.clientActiveArea.width,this.clientActiveArea.height))}else{if(e instanceof de&&!sf.base.isNullOrUndefined(e.tableFormat)){var c=this.tableAlignmentForBidi(e,s);e.isGridUpdated||(e.buildTableColumns(),e.isGridUpdated=!0),"Left"!==c&&this.documentHelper.tableLefts.length>0&&(n=this.documentHelper.tableLefts.pop(),s&&(o=n))}a=this.clientArea.width+n+x.convertPointToPixel(e.rightIndent);d=this.clientArea.x-(s?o:n);a=a>0?a:0,this.clientActiveArea.x=this.clientArea.x=d,this.clientActiveArea.width=this.clientArea.width=a}this.clientArea=new $(this.clientArea.x,this.clientArea.y,this.clientArea.width,this.clientArea.height),this.clientActiveArea=new $(this.clientActiveArea.x,this.clientActiveArea.y,this.clientActiveArea.width,this.clientActiveArea.height)},e.prototype.updateParagraphYPositionBasedonTextWrap=function(e,t){var i=e.bodyWidget,r=this.clientActiveArea;if(i&&i.floatingElements.length>0&&e instanceof le&&!(e.containerWidget instanceof ze)&&!e.isInsideTable&&!(e.containerWidget instanceof ae)){var n="Word2013"===this.documentHelper.compatibilityMode,o=e,s=o.isEmpty(),a=o.height;if(0===a&&(a=this.documentHelper.textHelper.getParagraphMarkSize(o.characterFormat).Height),!o.isInHeaderFooter||o.isInsideTable||n){var l=t.y,h=!1;i.floatingElements.sort((function(e,t){return e.y-t.y})),i.floatingElements.sort((function(e,t){return e.x-t.x}));for(var d=o.previousRenderedWidget,c=0;c<i.floatingElements.length;c++){var p=i.floatingElements[c],u=!1;if(u=p instanceof De?p.paragraph.isInHeaderFooter:p.bodyWidget instanceof oe,!(o.isInsideTable&&p instanceof de)||p.isInsideTable){var g=this.getTextWrappingBound(p),f=p instanceof de?"Square":p.textWrappingStyle,m=p instanceof de?"Both":p.textWrappingType;if(!(r.x>g.right+24||r.right<g.x-24))if((t.y+o.height>g.y||h)&&t.y<g.bottom&&"Inline"!==f&&"TopAndBottom"!==f&&"InFrontOfText"!==f&&"Behind"!==f){var y=0,v=x.convertPointToPixel(o.paragraphFormat.rightIndent),b=x.convertPointToPixel(o.paragraphFormat.firstLineIndent);if(b=!s&&o.childWidgets[0].isFirstLine()&&b>0?b:0,t.x>=g.x&&"Left"!==m&&(y=v),y=y<0?y:0,t.x<g.x&&t.x>g.x&&"Left"!==m)t.right>g.x&&(t.width=t.width-(t.right-g.right)),t.width<24?(!n&&p instanceof de&&d===p||(this.updateBoundsBasedOnTextWrap(g.bottom),t=this.clientActiveArea),((!s&&o.childWidgets[0].isFirstLine()||s)&&n||!u)&&(o.y=this.clientActiveArea.y)):t.x=g.right;else if(t.x>=g.x&&t.x<g.right)if(t.width=t.width-(g.right-t.x)-y,t.width<24||h){t.width=this.clientActiveArea.right-g.right-y;var w=!1;if(t.width<24||h){if(this.clientActiveArea.x+24<g.x){var M=this.getIntersectingItemBounds(i.floatingElements,p,l);!sf.base.isNullOrUndefined(M)&&M.bottom<=g.bottom&&(this.updateBoundsBasedOnTextWrap(M.bottom),t=this.clientActiveArea,w=!0,o.x=M.x)}n&&!w&&(this.updateBoundsBasedOnTextWrap(g.bottom),t=this.clientActiveArea),((!s&&o.childWidgets[0].isFirstLine()||s)&&n||!u)&&(o.y=this.clientActiveArea.y)}else t.x=g.right}else t.x=g.right;else g.x>t.x&&t.right>g.x&&(t.width=g.x-t.x,t.width<24&&(t.width=this.clientActiveArea.right-g.right-y,t.width<24?(!n&&p instanceof de&&d===p||(this.updateBoundsBasedOnTextWrap(g.bottom),t=this.clientActiveArea),((!s&&o.childWidgets[0].isFirstLine()||s)&&n||!u)&&(o.y=this.clientActiveArea.y)):t.x=g.right))}else i.floatingElements.length>0&&(t.y>=g.y&&t.y<g.bottom||t.y+a>=g.y&&t.y+a<g.bottom)&&"TopAndBottom"===f&&(!n&&p instanceof de&&d===p||(this.updateBoundsBasedOnTextWrap(g.bottom),!n&&(!s&&o.childWidgets[0].isFirstLine()||s)&&(h=!0)),((!s&&o.childWidgets[0].isFirstLine()||s)&&n||!u)&&(o.y=this.clientActiveArea.y))}}}}},e.prototype.getIntersectingItemBounds=function(e,t,i){var r=this.getMinBottomFloatingItem(e,this.getIntersectingFloatingItems(e,t,i));if(!sf.base.isNullOrUndefined(r))return this.getTextWrappingBound(r)},e.prototype.getMinBottomFloatingItem=function(e,t){var i=-1,r=Number.MAX_VALUE,n=0;e.sort((function(e,t){return e.x-t.x}));for(var o=0;o<t.length;o++){var s=e[o],a=this.getTextWrappingBound(s);r>a.bottom&&(s&&t.indexOf(s)+1<t.length?n++:(r=a.bottom,i=t.indexOf(s)))}return i-n==0?t[i]:null},e.prototype.getIntersectingFloatingItems=function(e,t,i){for(var r=[],n=0;n<e.length;n++){var o=e[n],s=this.getTextWrappingBound(o),a=this.getTextWrappingBound(t);i<=s.bottom&&a.bottom>=s.bottom&&s.right>this.clientActiveArea.x&&s.x<a.x&&r.push(o)}return r},e.prototype.getTextWrappingBound=function(e){var t=0,i=0,r=0,n=0,o=0;return e instanceof De?(t=e.distanceLeft,i=e.distanceTop,r=e.distanceRight,n=e.distanceBottom,o=e.width):(o=e.getTableCellWidth(),t=e.positioning.distanceLeft,i=e.positioning.distanceTop,r=e.positioning.distanceRight,n=e.positioning.distanceBottom),new $(e.x-t,e.y-i,o+t+r,e.height+i+n)},e.prototype.tableAlignmentForBidi=function(e,t){var i=e.tableFormat.tableAlignment;return t&&("Left"===i?i="Right":"Right"===i&&(i="Left")),i},e.prototype.cutFromLeft=function(e){e<this.clientActiveArea.x&&(e=this.clientActiveArea.x),e>this.clientActiveArea.right&&this.textWrap&&(e=this.clientActiveArea.right),this.clientActiveArea.width=this.clientActiveArea.right>e?this.clientActiveArea.right-e:0,this.clientActiveArea.x=e},e.prototype.cutFromTop=function(e){e<this.clientActiveArea.y&&(e=this.clientActiveArea.y),e>this.clientActiveArea.bottom&&(e=this.clientActiveArea.bottom),this.clientActiveArea.height=this.clientActiveArea.bottom-e,this.clientActiveArea.x=this.clientArea.x,this.clientActiveArea.width=this.clientArea.width,this.clientActiveArea.y=e},e.prototype.updateClientWidth=function(e){this.clientActiveArea.x-=e,this.clientActiveArea.width+e>0?this.clientActiveArea.width+=e:this.clientActiveArea.width=0},e.prototype.findFocusedPage=function(e,t,i){var r=new M(e.x,e.y);r.x+=this.documentHelper.viewerContainer.scrollLeft,r.y+=this.documentHelper.viewerContainer.scrollTop;for(var n=0;n<this.documentHelper.pages.length;n++){var o=this.documentHelper.pages[n],s=(o.boundingRectangle.y-this.pageGap*(n+1))*this.documentHelper.zoomFactor+this.pageGap*(n+1),a=o.boundingRectangle.height*this.documentHelper.zoomFactor+this.pageGap,l=o.boundingRectangle.x,h=void 0;if(h=this instanceof X?(o.boundingRectangle.right-l)*this.documentHelper.zoomFactor+l:o.boundingRectangle.right+l,s<=r.y&&s+a>=r.y)return t&&(this.documentHelper.currentPage=o,i&&(sf.base.isNullOrUndefined(o.headerWidget)||(o.headerWidget.page=o),sf.base.isNullOrUndefined(o.footerWidget)||(o.footerWidget.page=o))),r.y=(r.y-s)/this.documentHelper.zoomFactor,r.x>h?r.x=o.boundingRectangle.right:r.x<l?r.x=0:r.x=(r.x-l)/this.documentHelper.zoomFactor,r}return r},e.prototype.getPageHeightAndWidth=function(e,t,i,r){e=0;for(var n=0;n<this.documentHelper.pages.length;n++)e+=this.documentHelper.pages[n].boundingRectangle.height;t=0;for(n=0;n<this.documentHelper.pages.length;n++)t<this.documentHelper.pages[n].boundingRectangle.width&&(t=this.documentHelper.pages[n].boundingRectangle.width);return{height:e,width:t,viewerWidth:this.documentHelper.visibleBounds.width,viewerHeight:this.documentHelper.visibleBounds.height}},e.prototype.renderVisiblePages=function(){if(!(sf.base.isNullOrUndefined(this.visiblePages)||this.visiblePages.length<1)){this.documentHelper.clearContent();for(var e=0;e<this.visiblePages.length;e++){var t=this.visiblePages[e],i=t.boundingRectangle.width*this.documentHelper.zoomFactor,r=t.boundingRectangle.height*this.documentHelper.zoomFactor,n=t.boundingRectangle.x,o=(t.boundingRectangle.y-this.pageGap*(e+1))*this.documentHelper.zoomFactor+this.pageGap*(e+1);this.owner.viewer.renderPage(t,n,o,i,r)}}},e.prototype.handleZoom=function(){var e=this.documentHelper.preZoomFactor,t=null,i=0,r=!1;if(this.documentHelper.selection&&sf.base.isNullOrUndefined(this.documentHelper.zoomX&&sf.base.isNullOrUndefined(this.documentHelper.zoomY))){var n=0,o=0,s=this.documentHelper.selection.getPage(this.documentHelper.selection.end.currentWidget.paragraph);(n=(this.documentHelper.visibleBounds.width-s.boundingRectangle.width*e)/2)<30&&(n=30),o=s.boundingRectangle.y*e+(this.documentHelper.pages.indexOf(s)+1)*this.pageGap*(1-e);var a=this.documentHelper.selection.updateCaretSize(this.owner.selection.end,!0),l=a.topMargin;a.height;n+=this.documentHelper.selection.end.location.x*e,o+=(this.documentHelper.selection.end.location.y+l)*e,n>=this.containerLeft&&n<=this.documentHelper.visibleBounds.width&&o>=this.containerTop&&o<=this.containerTop+this.documentHelper.visibleBounds.height&&(r=!0)}for(var h=0;h<this.documentHelper.pages.length;h++)i+=this.documentHelper.pages[h].boundingRectangle.height;var d=0;for(h=0;h<this.documentHelper.pages.length;h++)d<this.documentHelper.pages[h].boundingRectangle.width&&(d=this.documentHelper.pages[h].boundingRectangle.width);var c=i*this.documentHelper.zoomFactor+(this.documentHelper.pages.length+1)*this.pageGap*(1-this.documentHelper.zoomFactor)-this.documentHelper.visibleBounds.height,p=d*this.documentHelper.zoomFactor-this.documentHelper.visibleBounds.width;if(this.documentHelper.visibleBounds.width-d*this.documentHelper.zoomFactor<60&&(p+=60),c>0){var u=this.containerTop;if(this.visiblePages.length>0){var g=((t=this.visiblePages[0]).boundingRectangle.y-(t.index+1)*this.pageGap)*e+(t.index+1)*this.pageGap,f=this.documentHelper.zoomY;sf.base.isNullOrUndefined&&(f=this.documentHelper.visibleBounds.height/2);for(var m=u+f;m>g+t.boundingRectangle.height*e;){var y=t.index+1;if(y===this.documentHelper.pages.length)break;g=((t=this.documentHelper.pages[y]).boundingRectangle.y-(t.index+1)*this.pageGap)*e+(t.index+1)*this.pageGap}u=(t.boundingRectangle.y-(t.index+1)*this.pageGap)*this.documentHelper.zoomFactor+(t.index+1)*this.pageGap+(m-g<0?m-g:(m-g)*(this.documentHelper.zoomFactor/e))-f,f=this.documentHelper.visibleBounds.height/2}this.documentHelper.viewerContainer.scrollTop=u}else this.documentHelper.viewerContainer.scrollTop=0;if(p>0){u=this.containerLeft;if(this.visiblePages.length>0){null===t&&(t=this.visiblePages[0]);var v=this.documentHelper.zoomX;sf.base.isNullOrUndefined(v)&&(v=this.documentHelper.visibleBounds.width/2);var b=t.boundingRectangle.width*e/t.boundingRectangle.width,w=u+v;u=t.boundingRectangle.x+(w-t.boundingRectangle.x<0?w-t.boundingRectangle.x:(w-t.boundingRectangle.x)*(this.documentHelper.zoomFactor/b))-v,v=this.documentHelper.visibleBounds.width/2}this.documentHelper.viewerContainer.scrollLeft=u}else this.documentHelper.viewerContainer.scrollLeft=0;this.updateScrollBars(),r&&this.documentHelper.scrollToPosition(this.documentHelper.selection.start,this.documentHelper.selection.end),this instanceof Z&&this.owner.editorModule.layoutWholeDocument()},e.prototype.updateCanvasWidthAndHeight=function(e,t,i,r,n,o){this instanceof X?this.documentHelper.visibleBounds.width!==this.documentHelper.viewerContainer.clientWidth?e-=this.documentHelper.visibleBounds.width-this.documentHelper.viewerContainer.clientWidth:i>t&&(e-=this.documentHelper.viewerContainer.offsetWidth-this.documentHelper.viewerContainer.clientWidth):i>t&&(e-=this.documentHelper.scrollbarWidth,r-=this.documentHelper.scrollbarWidth),r>e&&(t-=this.documentHelper.scrollbarWidth),n=r>e?r:e,o=i>t?i:t,parseInt(this.documentHelper.pageContainer.style.width.replace("px",""),10)===n&&parseInt(this.documentHelper.pageContainer.style.height.replace("px",""),10)===n||(this.documentHelper.pageContainer.style.width=n.toString()+"px",this.documentHelper.pageContainer.style.height=o.toString()+"px");var s=Math.max(1,window.devicePixelRatio||1);return this.documentHelper.containerCanvas.width===Math.floor(e*s)&&this.documentHelper.containerCanvas.height===Math.floor(t*s)||(this.documentHelper.containerCanvas.width=e*s,this.documentHelper.containerCanvas.height=t*s,this.documentHelper.containerCanvas.style.width=e+"px",this.documentHelper.containerCanvas.style.height=t+"px",this.documentHelper.containerContext.scale(s,s),this.documentHelper.selectionCanvas.width=e*s,this.documentHelper.selectionCanvas.height=t*s,this.documentHelper.selectionCanvas.style.width=e+"px",this.documentHelper.selectionCanvas.style.height=t+"px",this.documentHelper.selectionContext.scale(s,s)),{height:o,width:n,viewerWidth:e,viewerHeight:t,containerHeight:i,containerWidth:r}},e.prototype.updateScrollBarPosition=function(e,t,i,r,n,o){this.owner.viewer.containerTop=this.documentHelper.viewerContainer.scrollTop,this.documentHelper.containerCanvas.style.position="absolute",this.documentHelper.containerCanvas.style.top=this.owner.viewer.containerTop.toString()+"px",this.documentHelper.selectionCanvas.style.position="absolute",this.documentHelper.selectionCanvas.style.top=this.owner.viewer.containerTop.toString()+"px",this.owner.viewer.containerLeft=this.documentHelper.viewerContainer.scrollLeft,this.documentHelper.containerCanvas.style.left=this.owner.viewer.containerLeft+"px",this.documentHelper.selectionCanvas.style.left=this.owner.viewer.containerLeft+"px"},e.prototype.destroy=function(){this.clientArea=void 0,this.clientActiveArea=void 0},e}(),X=function(e){function t(t){var i=e.call(this,t)||this;return i.pageLeft=30,i.owner=t,i}return Q(t,e),Object.defineProperty(t.prototype,"pageGap",{get:function(){return this.owner.pageGap},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"documentHelper",{get:function(){return this.owner.documentHelper},enumerable:!0,configurable:!0}),t.prototype.createNewPage=function(e,t){var i=this.pageGap;this.documentHelper.pages.length>0&&(i=this.documentHelper.pages[this.documentHelper.pages.length-1].boundingRectangle.bottom+this.pageGap);var r=new st(this.documentHelper);return this.updatePageBoundingRectangle(e,r,i),sf.base.isNullOrUndefined(t)?this.documentHelper.pages.push(r):this.documentHelper.pages.splice(t,0,r),r.bodyWidgets.push(e),r.bodyWidgets[r.bodyWidgets.length-1].page=r,this.updateClientArea(e,r),this.documentHelper.layout.layoutHeaderFooter(e,this,r),this.updateClientArea(e,r),this.documentHelper.layout.footnoteHeight=0,r},t.prototype.updatePageBoundingRectangle=function(e,t,i){var r=sf.base.isNullOrUndefined(e.sectionFormat)?816:x.convertPointToPixel(e.sectionFormat.pageWidth),n=sf.base.isNullOrUndefined(e.sectionFormat)?1056:x.convertPointToPixel(e.sectionFormat.pageHeight),o=(this.documentHelper.visibleBounds.width-r*this.documentHelper.zoomFactor)/2;o<this.pageLeft&&(o=this.pageLeft),t.boundingRectangle=new $(o,i,r,n)},t.prototype.onPageFitTypeChanged=function(e){var t=this.documentHelper.visibleBounds.width,i=this.documentHelper.visibleBounds.height,r=this.visiblePages[0].bodyWidgets[0],n=x.convertPointToPixel(r.sectionFormat.pageWidth),o=x.convertPointToPixel(r.sectionFormat.pageHeight);switch(e){case"FitOnePage":if(i>0&&o>0){var s=(this.documentHelper.visibleBounds.height-2*this.pageGap-(this.pageGap-2))/o;s===this.documentHelper.zoomFactor?sf.base.isNullOrUndefined(this.owner.selection)||sf.base.isNullOrUndefined(this.owner.selection.start)||sf.base.isNullOrUndefined(this.owner.selection.end)||this.documentHelper.scrollToPosition(this.owner.selection.start,this.owner.selection.end):this.documentHelper.zoomFactor=s}break;case"FitPageWidth":t>0&&n>0&&(this.documentHelper.zoomFactor=(this.documentHelper.visibleBounds.width-80)/n);break;default:this.documentHelper.zoomFactor=1}},t.prototype.getCurrentPageHeaderFooter=function(e,t){return this.getCurrentHeaderFooter(this.getHeaderFooterType(e,t),e.index)},t.prototype.getHeaderFooterType=function(e,t){var i;i=t?"OddHeader":"OddFooter";var r=e.page;return e.sectionFormat.differentFirstPage&&(sf.base.isNullOrUndefined(r.previousPage)||r.sectionIndex!==r.previousPage.sectionIndex)?i=t?"FirstPageHeader":"FirstPageFooter":e.sectionFormat.differentOddAndEvenPages&&this.documentHelper.pages.length%2==0&&(i=t?"EvenHeader":"EvenFooter"),i},t.prototype.getCurrentHeaderFooter=function(e,t){if(this.documentHelper.headersFooters[t]){var i=this.getHeaderFooter(e),r=this.documentHelper.headersFooters[t][i];if(!r){for(var n=t>0?t-1:t;!r&&-1!==n&&this.documentHelper.headersFooters[n][i];)r=this.documentHelper.headersFooters[n][i],n--;r||((r=this.createHeaderFooterWidget(e)).isEmpty=!0),this.documentHelper.headersFooters[t][i]=r}return r}if(t>0)return this.getCurrentHeaderFooter(e,t-1)},t.prototype.createHeaderFooterWidget=function(e){var t=new oe(e),i=new le;return i.childWidgets.push(new ue(i)),t},t.prototype.getHeaderFooter=function(e){switch(e){case"OddHeader":return 0;case"OddFooter":return 1;case"EvenHeader":return 2;case"EvenFooter":return 3;case"FirstPageHeader":return 4;case"FirstPageFooter":return 5}},t.prototype.updateHFClientArea=function(e,t){var i=x.convertPointToPixel(e.pageWidth-e.leftMargin-e.rightMargin);i<0&&(i=0),this.clientArea=new $(x.convertPointToPixel(e.leftMargin),t?x.convertPointToPixel(e.headerDistance):x.convertPointToPixel(e.pageHeight-e.footerDistance),i,Number.POSITIVE_INFINITY),this.clientActiveArea=new $(this.clientArea.x,this.clientArea.y,this.clientArea.width,this.clientArea.height)},t.prototype.updateHeaderFooterClientAreaWithTop=function(e,t,i){this.updateHFClientArea(e,t),t||i.footerWidget.y<this.clientActiveArea.y&&(this.clientActiveArea.y=i.footerWidget.y,this.clientActiveArea.height=Number.POSITIVE_INFINITY)},t.prototype.updateFootnoteClientArea=function(e,t,i,r){var n=x.convertPointToPixel(e.pageWidth-e.leftMargin-e.rightMargin),o=x.convertPointToPixel(e.leftMargin),s=x.convertPointToPixel(e.bottomMargin),a=x.convertPointToPixel(e.footerDistance),l=x.convertPointToPixel(e.pageHeight)-Math.max(a+t.page.footerWidget.height,s);this.clientArea=new $(o,l,n,Number.POSITIVE_INFINITY),this.clientActiveArea=new $(this.clientArea.x,this.clientArea.y,this.clientArea.width,Number.POSITIVE_INFINITY)},t.prototype.scrollToPage=function(e){for(var t=0,i=0;i<this.documentHelper.pages.length&&(t=this.documentHelper.pages[i].boundingRectangle.y-this.pageGap/2,i!==e);i++);this.documentHelper.viewerContainer.scrollTop=t,this.updateScrollBars()},t.prototype.updateScrollBars=function(){var e,t,i=(e=this.getPageHeightAndWidth(0,0,0,0)).width*this.documentHelper.zoomFactor+2*this.pageLeft,r=e.height*this.documentHelper.zoomFactor+(this.documentHelper.pages.length+1)*this.pageGap;r=(t=this.updateCanvasWidthAndHeight(e.viewerWidth,e.viewerHeight,r,i,e.width,e.height)).containerHeight,i=t.containerWidth,this.documentHelper.containerContext.globalAlpha=1,this.documentHelper.selectionContext.globalAlpha=.4;for(var n=0;n<this.documentHelper.pages.length;n++){var o=(t.width-this.documentHelper.pages[n].boundingRectangle.width*this.documentHelper.zoomFactor)/2;o>this.pageLeft?this.documentHelper.pages[n].boundingRectangle=new $(o,this.documentHelper.pages[n].boundingRectangle.y,this.documentHelper.pages[n].boundingRectangle.width,this.documentHelper.pages[n].boundingRectangle.height):this.documentHelper.pages[n].boundingRectangle=new $(this.pageLeft,this.documentHelper.pages[n].boundingRectangle.y,this.documentHelper.pages[n].boundingRectangle.width,this.documentHelper.pages[n].boundingRectangle.height)}this.updateScrollBarPosition(i,r,t.viewerWidth,t.viewerHeight,t.width,t.height),this.updateVisiblePages(),this.documentHelper.isScrollToSpellCheck=!1},t.prototype.updateVisiblePages=function(){this.visiblePages=[];for(var e=0;e<this.documentHelper.pages.length;e++){var t=this.documentHelper.pages[e],i=(t.boundingRectangle.y-this.pageGap*(e+1))*this.documentHelper.zoomFactor+this.pageGap*(e+1),r=t.boundingRectangle.x;this.documentHelper.isPageInVisibleBound(t,i)&&this.addVisiblePage(t,r,i)}},t.prototype.addVisiblePage=function(e,t,i){var r=this,n=e.boundingRectangle.width*this.documentHelper.zoomFactor,o=e.boundingRectangle.height*this.documentHelper.zoomFactor;if(this.owner.enableImageResizerMode&&void 0!==this.owner.imageResizerModule.currentPage&&this.owner.imageResizerModule.currentPage===e&&this.owner.imageResizerModule.isImageResizerVisible&&this.owner.imageResizerModule.setImageResizerPositions(t,i,n,o),this.visiblePages.push(e),this.owner.isSpellCheck&&this.owner.spellChecker.enableOptimizedSpellCheck&&(this.documentHelper.triggerElementsOnLoading||this.documentHelper.isScrollHandler)&&this.documentHelper.cachedPages.indexOf(e.index)<0){this.documentHelper.cachedPages.push(e.index);var s=this.owner.spellChecker.getPageContent(e);s.trim().length>0?(e.allowNextPageRendering=!1,this.owner.spellChecker.callSpellChecker(this.owner.spellChecker.languageID,s,!0,!1,!1,!0).then((function(s){var a=JSON.parse(s);sf.base.isNullOrUndefined(r.owner)||sf.base.isNullOrUndefined(r.owner.spellChecker)||r.owner.spellChecker.updateUniqueWords(a.SpellCollection),e.allowNextPageRendering=!0,r.documentHelper.triggerSpellCheck=!0,r.renderPage(e,t,i,n,o),r.documentHelper.triggerSpellCheck=!1,r.documentHelper.triggerElementsOnLoading=!1}))):this.renderPage(e,t,i,n,o)}else this.renderPage(e,t,i,n,o)},t.prototype.renderPage=function(e,t,i,r,n){this.documentHelper.render.renderWidgets(e,t-this.owner.viewer.containerLeft,i-this.owner.viewer.containerTop,r,n)},t}(G),Z=function(e){function t(t){var i=e.call(this,t)||this;return i.visiblePages=[],i.owner=t,i}return Q(t,e),Object.defineProperty(t.prototype,"documentHelper",{get:function(){return this.owner.documentHelper},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"pageGap",{get:function(){return 0},enumerable:!0,configurable:!0}),t.prototype.createNewPage=function(e,t){var i,r=0;return this.documentHelper.pages.length>0&&(r=this.documentHelper.pages[this.documentHelper.pages.length-1].boundingRectangle.bottom),i=new st(this.documentHelper),0===this.documentHelper.pages.length?i.boundingRectangle=new $(10,r,this.documentHelper.visibleBounds.width,this.documentHelper.visibleBounds.height):i.boundingRectangle=new $(10,r-20,this.documentHelper.visibleBounds.width,this.documentHelper.visibleBounds.height),this.documentHelper.pages.push(i),this.updateClientArea(void 0,i),i.bodyWidgets.push(e),i.bodyWidgets[i.bodyWidgets.length-1].page=i,i},t.prototype.onPageFitTypeChanged=function(e){this.documentHelper.zoomFactor=1},t.prototype.scrollToPage=function(e){this.updateScrollBars()},t.prototype.getContentHeight=function(){for(var e=0,t=0;t<this.documentHelper.pages.length;t++){var i=this.documentHelper.pages[t];0===t?(e+=this.padding.top,i.boundingRectangle.y=this.padding.top):i.boundingRectangle.y=this.documentHelper.pages[t-1].boundingRectangle.bottom,i.boundingRectangle.height=i.bodyWidgets[0].height,e+=i.bodyWidgets[0].height,t===this.documentHelper.pages.length-1&&(e+=this.padding.bottom)}return e},t.prototype.getContentWidth=function(){for(var e=this.documentHelper.visibleBounds.width,t=e,i=0;i<this.documentHelper.pages.length;i++){for(var r=this.documentHelper.pages[i],n=0;n<r.bodyWidgets[0].childWidgets.length;n++)if(r.bodyWidgets[0].childWidgets[n]instanceof de){var o=r.bodyWidgets[0].childWidgets[n],s=x.convertPointToPixel(o.getTableWidth())*this.documentHelper.zoomFactor+4*this.padding.left+4*this.padding.right+r.boundingRectangle.x;t<s&&(e=s,t=s)}r.boundingRectangle.width=e}return e},t.prototype.updateScrollBars=function(){var e;e=this.getPageHeightAndWidth(0,0,0,0);var t,i=this.getContentWidth()*this.documentHelper.zoomFactor+this.padding.left+this.padding.right,r=this.getContentHeight()*this.documentHelper.zoomFactor+this.padding.top+this.padding.bottom;t=this.updateCanvasWidthAndHeight(e.viewerWidth,e.viewerHeight,r,i,e.width,e.height),this.documentHelper.containerContext.globalAlpha=1,this.documentHelper.selectionContext.globalAlpha=.4,this.updateScrollBarPosition(i,r,t.viewerWidth,t.viewerHeight,t.width,t.height),this.updateVisiblePages(),this.documentHelper.isScrollToSpellCheck=!1},t.prototype.updateVisiblePages=function(){var e,t;this.visiblePages=[];for(var i=this.documentHelper.visibleBounds.height,r=this.documentHelper.viewerContainer.scrollTop,n=0;n<this.documentHelper.pages.length;n++){t=(e=this.documentHelper.pages[n]).boundingRectangle.y*this.documentHelper.zoomFactor;var o=e.boundingRectangle.height*this.documentHelper.zoomFactor;(t>=r&&t<=r+i||t+o>=r&&t+o<=r+i||t<=r&&t+o>=r+i)&&this.addVisiblePage(e,this.padding.left,t)}},t.prototype.addVisiblePage=function(e,t,i){var r=this,n=this.getContentWidth(),o=this.getContentHeight()*this.documentHelper.zoomFactor+this.padding.top+this.padding.bottom;if(this.owner.enableImageResizerMode&&void 0!==this.owner.imageResizerModule.currentPage&&this.owner.imageResizerModule.currentPage===e&&this.owner.imageResizerModule.isImageResizerVisible&&this.owner.imageResizerModule.setImageResizerPositions(t,i,n,o),this.visiblePages.push(e),this.documentHelper.owner.isSpellCheck&&this.documentHelper.owner.spellChecker.enableOptimizedSpellCheck&&(this.owner.documentHelper.triggerElementsOnLoading||this.owner.documentHelper.isScrollHandler)&&this.documentHelper.cachedPages.indexOf(e.index)<0){this.owner.documentHelper.cachedPages.push(e.index);var s=this.documentHelper.owner.spellChecker.getPageContent(e);s.trim().length>0?(e.allowNextPageRendering=!1,this.owner.spellChecker.callSpellChecker(this.owner.spellChecker.languageID,s,!0,!1,!1,!0).then((function(s){var a=JSON.parse(s);sf.base.isNullOrUndefined(r.owner)||sf.base.isNullOrUndefined(r.owner.spellChecker)||r.owner.spellChecker.updateUniqueWords(a.SpellCollection),e.allowNextPageRendering=!0,r.owner.documentHelper.triggerSpellCheck=!0,r.renderPage(e,t,i,n,o),r.owner.documentHelper.triggerSpellCheck=!1,r.owner.documentHelper.triggerElementsOnLoading=!1}))):this.renderPage(e,t,i,n,o)}else this.renderPage(e,t,i,n,o)},t.prototype.renderPage=function(e,t,i,r,n){this.documentHelper.render.renderWidgets(e,t-this.owner.viewer.containerLeft,i-this.owner.viewer.containerTop,r,n)},t}(G),K=function(){function e(e){this.viewerIn=e,this.clear()}return Object.defineProperty(e.prototype,"currentIndex",{get:function(){return this.currentIndexIn},set:function(e){e>=0&&(this.currentIndexIn=e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"columnCount",{get:function(){var e;return sf.base.isNullOrUndefined(this.columnIn)||(e=this.numberOfColumnsIn),e=e>0?e:1},enumerable:!0,configurable:!0}),e.prototype.setColumns=function(e){if(this.pageWidth=x.convertPointToPixel(e.pageWidth-e.leftMargin-e.rightMargin),this.numberOfColumnsIn=e.numberOfColumns,!sf.base.isNullOrUndefined(e.columns)){for(var t=e.columns,i=[],r=0;r<e.numberOfColumns;r++){var n=this.defaultSpaceIn,o=0;!sf.base.isNullOrUndefined(t)&&t.length>0&&(n=t[r].space,o=t[r].width);var s=this.getColumnObj(o,n,e.numberOfColumns,e.equalWidth);s.index=r,i.push(s)}this.columnIn=i}},e.prototype.clear=function(){this.currentIndexIn=0,this.defaultSpaceIn=36,this.columnIn=null,this.pageWidth=0},e.prototype.reset=function(){this.currentIndex=0},e.prototype.getColumnBounds=function(e,t){var i=this.currentIndexIn;return this.getColumnBoundsByIndex(i,t)},e.prototype.getColumnBoundsByBodyWidget=function(e,t){var i=e.page.bodyWidgets.indexOf(e);return this.getColumnBoundsByIndex(i,t)},e.prototype.getNextColumnByBodyWidget=function(e){var t=e.page.bodyWidgets.indexOf(e);return this.getColumnByIndex(t+1)},e.prototype.getColumnByIndex=function(e){if(e>=0&&e<this.columnCount&&!sf.base.isNullOrUndefined(this.columnIn)&&this.columnIn.length>0)return this.columnIn[e]},e.prototype.getColumnObj=function(e,t,i,r){var n=(i-1)*t,o=new c;return!r&&0!==e||sf.base.isNullOrUndefined(this.pageWidth)||(e=(this.pageWidth-n)/i),o.width=e,o.space=t,o},e.prototype.getColumnBoundsByIndex=function(e,t){var i=new $(t.x,t.y,t.width,t.height);if(e>=0&&this.columnIn.length>0){var r=void 0,n=void 0;if(!sf.base.isNullOrUndefined(this.columnIn[e])){r=this.getColumnByIndex(e),i.width=r.width;for(var o=0;o<e;o++)n=this.columnIn[o],i.x+=n.width,i.x+=n.space}}return i},e}(),J=(v=function(e,t){return(v=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}v(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),$=function(){function e(e,t,i,r){this.x=e,this.y=t,this.width=i,this.height=r}return Object.defineProperty(e.prototype,"right",{get:function(){return this.x+this.width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!0,configurable:!0}),e.prototype.isIntersecting=function(e){return!(e.y>this.bottom||this.y>e.bottom||e.x>this.right||this.x>e.right)},e.prototype.clone=function(){return new e(this.x,this.y,this.width,this.height)},e}(),ee=function(e,t,i,r){this.right=10,this.left=10,this.top=10,this.bottom=10,this.right=e,this.left=t,this.top=i,this.bottom=r},te=function(){function e(e,t,i,r){this.left=e,this.top=t,this.right=i,this.bottom=r}return e.prototype.clone=function(){return new e(this.left,this.top,this.right,this.bottom)},e.prototype.destroy=function(){this.left=void 0,this.right=void 0,this.top=void 0,this.bottom=void 0},e}(),ie=function(){function e(){this.childWidgets=[],this.x=0,this.y=0,this.width=0,this.height=0,this.index=0}return Object.defineProperty(e.prototype,"indexInOwner",{get:function(){return this instanceof ne&&this.page?this.containerWidget instanceof ae?this.containerWidget.bodyWidgets.indexOf(this):this.page.bodyWidgets.indexOf(this):this.containerWidget&&this.containerWidget.childWidgets?this.containerWidget.childWidgets.indexOf(this):this instanceof ae?0:-1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"firstChild",{get:function(){return this.childWidgets.length>0?this.childWidgets[0]:void 0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lastChild",{get:function(){if(this.childWidgets)return this.childWidgets.length>0?this.childWidgets[this.childWidgets.length-1]:void 0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"previousWidget",{get:function(){var e=this,t=this.indexInOwner;return e=e instanceof ne?t>0?e.page.bodyWidgets[t-1]:void 0:t>0?e.containerWidget.childWidgets[t-1]:void 0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nextWidget",{get:function(){var e=this,t=this.indexInOwner;if(-1!==t)return e=e instanceof ne?t<e.page.bodyWidgets.length-1?e.page.bodyWidgets[t+1]:void 0:t<e.containerWidget.childWidgets.length-1?e.containerWidget.childWidgets[t+1]:void 0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"previousRenderedWidget",{get:function(){var e=this,t=this.indexInOwner;if(!(t<0)){if(e instanceof ne)if(t>0&&!(e.containerWidget instanceof ae))e=e.page.bodyWidgets[t-1];else if(e.containerWidget instanceof ae&&!e.page.documentHelper.owner.editor.removeEditRange){if(t<=0)return;e=e.containerWidget.bodyWidgets[t-1]}else{e=(i=e.page.previousPage)&&i.bodyWidgets.length>0?i.bodyWidgets[i.bodyWidgets.length-1]:void 0}else if(e instanceof ae)for(var i=e.page;i.previousPage&&(e=(i=i.previousPage).footnoteWidget,sf.base.isNullOrUndefined(e)););else if(t>0)e=e.containerWidget.childWidgets[t-1];else{var r=void 0;for(e.containerWidget instanceof pe?r=e.containerWidget.getPreviousSplitWidget():e.containerWidget&&e.containerWidget.containerWidget instanceof ae&&"Endnote"===e.containerWidget.containerWidget.footNoteType?r=e.containerWidget.previousWidget?e.containerWidget.previousWidget:e.containerWidget.previousRenderedWidget:e.containerWidget instanceof ce||e.containerWidget instanceof oe||e.containerWidget&&e.containerWidget.containerWidget instanceof ae||(r=e.containerWidget.previousRenderedWidget);r&&0===r.childWidgets.length&&(r=r.previousRenderedWidget,!sf.base.isNullOrUndefined(r)););e=r&&r.constructor===e.containerWidget.constructor?r.lastChild:void 0}return e}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nextRenderedWidget",{get:function(){var e=this,t=this.indexInOwner;if(!(t<0)){if(e instanceof ne)if(t<e.page.bodyWidgets.length-1&&!(e.containerWidget instanceof ae))e=e.page.bodyWidgets[t+1];else if(e.containerWidget instanceof ae){if(t>=e.containerWidget.bodyWidgets.length-1&&!e.page.documentHelper.owner.editor.removeEditRange)return;e=e.containerWidget.bodyWidgets[t+1]}else if(e.page.allowNextPageRendering){e=(i=e.page.nextPage)&&i.bodyWidgets.length>0?i.bodyWidgets[0]:void 0}else e=void 0;else if(e instanceof ae)for(var i=e.page;i.allowNextPageRendering&&i.nextPage&&(e=(i=i.nextPage).footnoteWidget,sf.base.isNullOrUndefined(e)););else if(t<e.containerWidget.childWidgets.length-1)e=e.containerWidget.childWidgets[t+1];else{var r=void 0;for(e.containerWidget instanceof pe?r=e.containerWidget.getNextSplitWidget():e.containerWidget&&e.containerWidget.containerWidget instanceof ae&&"Endnote"===e.containerWidget.containerWidget.footNoteType?r=e.containerWidget.nextWidget?e.containerWidget.nextWidget:e.containerWidget.nextRenderedWidget:e.containerWidget instanceof ce||e.containerWidget instanceof oe||e.containerWidget&&e.containerWidget.containerWidget instanceof ae||(r=e.containerWidget.nextRenderedWidget);r&&0===r.childWidgets.length&&!(r instanceof pe)&&(r=r.nextRenderedWidget,!sf.base.isNullOrUndefined(r)););e=r&&r.constructor===e.containerWidget.constructor?r.firstChild:void 0}return e}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"previousSplitWidget",{get:function(){if(this instanceof pe)return this.getPreviousSplitWidget();var e=this.previousRenderedWidget;return this instanceof ne&&e instanceof ne&&this.equals(e)||e instanceof se&&this.index===e.index&&this.equals(e)?e:void 0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nextSplitWidget",{get:function(){if(this instanceof pe)return this.getNextSplitWidget();var e=this.nextRenderedWidget;return this instanceof ne&&e instanceof ne&&this.equals(e)||e instanceof se&&this.index===e.index&&this.equals(e)?e:void 0},enumerable:!0,configurable:!0}),e.prototype.getPreviousSplitWidgets=function(){for(var e=[],t=this.previousSplitWidget;t;)e.unshift(t),t=t.previousSplitWidget;return e},e.prototype.getSplitWidgets=function(){for(var e=this.getPreviousSplitWidgets(),t=this;t;)e.push(t),t=t.nextSplitWidget;return e},e.prototype.combineWidget=function(e){var t=this,i=this.getSplitWidgets();if(i.length>1)for(t=i.shift();i.length>0;){var r=i.shift();t.combine(r,e)}return t instanceof de&&t.combineRows(e),t},e.prototype.combine=function(t,i){if(t.childWidgets.length>0){var r=this.lastChild;if(r instanceof de)r.combineWidget(i);else{var n=t.firstChild;!(t instanceof de)&&r instanceof e&&n instanceof e&&r.index===n.index&&r.combine(t.childWidgets.shift(),i)}this.addWidgets(t.childWidgets),t.childWidgets=[]}t.destroyInternal(i)},e.prototype.addWidgets=function(t){for(;t.length>0;){var i=t.shift();if(i instanceof ue&&this instanceof le)i.paragraph=this,this.height+=i.height;else if(i instanceof e){var r=this.lastChild;i.containerWidget=this,i.y=r instanceof e?r.y+r.height:this.y,this.height+=i.height}this.childWidgets.push(i)}},e.prototype.removeChild=function(e){e>-1&&e<this.childWidgets.length&&this.childWidgets.splice(e,1)},e.prototype.destroy=function(){if(this.childWidgets)for(;this.childWidgets.length>0;){var t=this.childWidgets.pop();(t instanceof ue||t instanceof e)&&t.destroy()}this.childWidgets=void 0,this.containerWidget&&this.containerWidget.removeChild(this.indexInOwner),this.containerWidget=void 0,this.margin=void 0,this.x=void 0,this.y=void 0,this.width=void 0,this.height=void 0,this.index=void 0},e}(),re=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.floatingElements=[],t.footNoteReference=void 0,t.sectionFormatIn=void 0,t}return J(t,e),Object.defineProperty(t.prototype,"sectionFormat",{get:function(){return this instanceof ne?this.sectionFormatIn:this.page&&!sf.base.isNullOrUndefined(this.page.bodyWidgets)?this.page.bodyWidgets[0].sectionFormat:void 0},set:function(e){this instanceof ne&&(this.sectionFormatIn=e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"sectionIndex",{get:function(){var e=0;return this instanceof ne?e=this.index:this.page&&(e=this.page.bodyWidgets[0].index),e},enumerable:!0,configurable:!0}),t.prototype.getHierarchicalIndex=function(e){return e=this instanceof ne?this.index+";"+e:this instanceof ae?"Footnote"===this.footNoteType?"FN;"+e:"EN;"+e:-1!==this.headerFooterType.indexOf("Header")?"H;"+e:"F;"+e,sf.base.isNullOrUndefined(this.page)?e:this.page.documentHelper.pages.indexOf(this.page)+";"+e},t}(ie),ne=function(e){function t(){return e.call(this)||this}return J(t,e),t.prototype.equals=function(e){return e instanceof t&&e.sectionFormat===this.sectionFormat},t.prototype.getHierarchicalIndex=function(e){return this.containerWidget instanceof ae?(e=this.containerWidget.bodyWidgets.indexOf(this)+";"+e,e="Footnote"===this.containerWidget.footNoteType?"FN;"+e:"EN;"+e):e=this.page&&-1!==this.page.bodyWidgets.indexOf(this)?this.page.bodyWidgets.indexOf(this)+";"+e:this.index+";"+e,sf.base.isNullOrUndefined(this.page)?e:this.page.documentHelper.pages.indexOf(this.page)+";"+e},t.prototype.getTableCellWidget=function(e){for(var t=0;t<this.childWidgets.length;t++)if(this.childWidgets[t]instanceof de){var i=this.childWidgets[t],r=0;if(i.wrapTextAround&&(r=i.getTableCellWidth()),!i.wrapTextAround&&i.y<=e.y&&i.y+i.height>=e.y)return i.getTableCellWidget(e);if(i.wrapTextAround&&i.x<=e.x&&i.x+r>=e.x&&i.y<=e.y&&i.y+i.height>=e.y)return i.getTableCellWidget(e)}var n=void 0;return this.childWidgets.length>0&&(n=this.childWidgets[0].y<=e.y?this.childWidgets[this.childWidgets.length-1].getTableCellWidget(e):this.childWidgets[0].getTableCellWidget(e)),n},t.prototype.destroyInternal=function(e){this.height;if(!sf.base.isNullOrUndefined(this.childWidgets)){for(var t=0;t<this.childWidgets.length;t++){var i=this.childWidgets[t];if(i.destroyInternal(e),sf.base.isNullOrUndefined(this.childWidgets))break;t--}this.childWidgets=void 0}if(!sf.base.isNullOrUndefined(this.page)){var r=this.indexInOwner;this.indexInOwner>-1&&(this.page.bodyWidgets.splice(r,1),0===this.page.bodyWidgets.length?this.page.destroy():this instanceof oe&&this.page.headerWidget===this?this.page.headerWidget=void 0:this instanceof oe&&this.page.footerWidget===this&&(this.page.footerWidget=void 0),this.page=void 0)}this.destroy()},t.prototype.destroy=function(){this.sectionFormat=void 0,this.page&&this.page.headerWidgetIn&&(this.page.headerWidgetIn.page=void 0),this.page&&this.page.footerWidgetIn&&(this.page.footerWidgetIn.page=void 0),this.page=void 0,e.prototype.destroy.call(this)},t}(re),oe=function(e){function t(t){var i=e.call(this)||this;return i.isEmpty=!1,i.headerFooterType=t,i}return J(t,e),t.prototype.getTableCellWidget=function(e){for(var t=0;t<this.childWidgets.length;t++)if(this.childWidgets[t]instanceof de){var i=this.childWidgets[t],r=0;if(i.wrapTextAround&&(r=i.getTableCellWidth()),!i.wrapTextAround&&i.y<=e.y&&i.y+i.height>=e.y)return i.getTableCellWidget(e);if(i.wrapTextAround&&i.x<=e.x&&i.x+r>=e.x&&i.y<=e.y&&i.y+i.height>=e.y)return i.getTableCellWidget(e)}var n=void 0;return this.childWidgets.length>0&&(n=this.childWidgets[0].y<=e.y?this.childWidgets[this.childWidgets.length-1].getTableCellWidget(e):this.childWidgets[0].getTableCellWidget(e)),n},t.prototype.equals=function(e){return e instanceof t&&e.containerWidget===this.containerWidget},t.prototype.clone=function(){for(var e=new t(this.headerFooterType),i=0;i<this.childWidgets.length;i++){var r=this.childWidgets[i].clone();e.childWidgets.push(r),r.index=i,r.containerWidget=e}return e.isEmpty=this.isEmpty,e.x=this.x,e.y=this.y,e.height=0,e.width=0,e},t.prototype.destroyInternal=function(t){this.page=void 0,e.prototype.destroy.call(this)},t}(re),se=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.isLayouted=!1,t.locked=!1,t.lockedBy="",t}return J(t,e),Object.defineProperty(t.prototype,"bodyWidget",{get:function(){for(var e=this;e.containerWidget;){if(e.containerWidget instanceof ze){var t=e.containerWidget.containerShape.line.paragraph;if(t)return t.bodyWidget}else if(e.containerWidget instanceof re)return e.containerWidget;e=e.containerWidget}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"leftIndent",{get:function(){return this instanceof le&&this.paragraphFormat instanceof ct?this.paragraphFormat.leftIndent:this instanceof de&&this.tableFormat instanceof vt?this.tableFormat.leftIndent:0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rightIndent",{get:function(){return this instanceof le&&this.paragraphFormat instanceof ct?this.paragraphFormat.rightIndent:0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isInsideTable",{get:function(){return this.containerWidget instanceof pe},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isInHeaderFooter",{get:function(){return this.bodyWidget instanceof oe},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"associatedCell",{get:function(){if(this.containerWidget instanceof pe)return this.containerWidget},enumerable:!0,configurable:!0}),t.prototype.isPageBreak=function(){var e=!1;if(this instanceof le){if(null!=this&&1===this.childWidgets.length&&1===this.firstChild.children.length)e=this.firstChild.children[0].isPageBreak}return e},t.prototype.isColumnBreak=function(){var e=!1;if(this instanceof le){if(null!=this&&1===this.childWidgets.length&&1===this.firstChild.children.length)e=this.firstChild.children[0].isColumnBreak}return e},t.prototype.getHierarchicalIndex=function(e){if(e=this.containerWidget.childWidgets.indexOf(this)+";"+e,!sf.base.isNullOrUndefined(this.containerWidget)){if(this.containerWidget instanceof ze)return this.containerWidget.getHierarchicalIndex(e);if(this.containerWidget instanceof t)return this.containerWidget.getHierarchicalIndex(e);this.containerWidget instanceof re&&(e=this.containerWidget.getHierarchicalIndex(e))}return e},t.prototype.getIndex=function(){return this instanceof le||this instanceof de?this.containerWidget.childWidgets.indexOf(this):this instanceof ce?this.ownerTable.childWidgets.indexOf(this):this instanceof pe?this.ownerRow.childWidgets.indexOf(this):0},t.prototype.getContainerWidth=function(){if(this.isInsideTable){if(this instanceof de&&"Auto"===this.tableFormat.preferredWidthType&&this.associatedCell.ownerTable.isGridUpdated){for(var e=0,t=this.associatedCell.cellFormat.columnSpan,i=this.associatedCell.columnIndex,r=0;r<t;r++)e+=this.associatedCell.ownerTable.tableHolder.columns[i].preferredWidth,i++;if(e>0)return e}return this.associatedCell.getCellWidth(this)}if(this.containerWidget instanceof ze){var n=this.containerWidget.containerShape;return x.convertPixelToPoint(n.width)-x.convertPixelToPoint(n.textFrame.marginLeft)-x.convertPixelToPoint(n.textFrame.marginRight)}var o=this.bodyWidget,s=o.sectionFormat,a=0;if(!sf.base.isNullOrUndefined(o.page)&&!sf.base.isNullOrUndefined(o.page.documentHelper)&&"Word2013"!==o.page.documentHelper.compatibilityMode&&!this.isInsideTable&&this instanceof de){var l=this.firstChild;a=l.firstChild.leftMargin+l.lastChild.rightMargin}if(o instanceof ne&&s.columns.length>1){var h=o.page.bodyWidgets.indexOf(o);return x.convertPixelToPoint(s.columns[h].width)}return s.pageWidth-(s.leftMargin+s.rightMargin)+a},Object.defineProperty(t.prototype,"bidi",{get:function(){return this instanceof le&&this.paragraphFormat instanceof ct?this.paragraphFormat.bidi:this instanceof de&&this.tableFormat instanceof vt&&this.tableFormat.bidi},enumerable:!0,configurable:!0}),t}(ie),ae=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.bodyWidgets=[],t}return J(t,e),t.prototype.getMinimumAndMaximumWordWidth=function(e,t){throw new Error("Method not implemented.")},t.prototype.getTableCellWidget=function(e){},t.prototype.equals=function(e){return e instanceof t&&e.containerWidget===this.containerWidget},t.prototype.clone=function(){for(var e=new t,i=0;i<this.childWidgets.length;i++){var r=this.childWidgets[i].clone();e.childWidgets.push(r),r.index=i,r.containerWidget=e}return e.block=this.block,e},t.prototype.destroyInternal=function(t){this.block=void 0,e.prototype.destroy.call(this)},t}(re),le=function(i){function r(){var e=i.call(this)||this;return e.isChangeDetected=!1,e.clientX=void 0,e.floatingElements=[],e.paragraphFormat=new ct(e),e.characterFormat=new P(e),e}return J(r,i),Object.defineProperty(r.prototype,"isEndsWithPageBreak",{get:function(){return this.childWidgets.length>0&&this.lastChild.isEndsWithPageBreak},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"isEndsWithColumnBreak",{get:function(){return this.childWidgets.length>0&&this.lastChild.isEndsWithColumnBreak},enumerable:!0,configurable:!0}),r.prototype.equals=function(e){return e instanceof r&&e.paragraphFormat===this.paragraphFormat},r.prototype.isContainsShapeAlone=function(){for(var e=!1,t=0;t<this.childWidgets.length;t++)for(var i=this.childWidgets[t],r=0;r<i.children.length;r++){var n=i.children[r];if(!(n instanceof De)||n instanceof De&&"Inline"===n.textWrappingStyle)return!1;e=!0}return!!e},r.prototype.isEmpty=function(){if(sf.base.isNullOrUndefined(this.childWidgets)||0===this.childWidgets.length)return!0;for(var e=0;e<this.childWidgets.length;e++)for(var t=this.childWidgets[e],i=0;i<t.children.length;i++){var r=t.children[i];if(0!==r.length&&(r instanceof we||r instanceof Re||r instanceof Ce||r instanceof Ue||r instanceof He||r instanceof Be||r instanceof Ee||r instanceof Oe||r instanceof fe&&x.isLinkedFieldCharacter(r)))return!1}return!0},r.prototype.getInline=function(e,t){for(var i=void 0,r=0,n=!1,o=this.getSplitWidgets(),s=0;s<o.length;s++)for(var a=o[s],l=0;l<a.childWidgets.length;l++)for(var h=a.childWidgets[l],d=0;d<h.children.length;d++)if(!((i=h.children[d])instanceof je)){if((!n&&(i instanceof we||i instanceof Re||i instanceof Ee||i instanceof Ce||i instanceof fe&&x.isLinkedFieldCharacter(i))||i instanceof Be)&&(n=!0),n&&e<=r+i.length)return{element:i,index:t=e-r};r+=i.length}return e>r&&(t=sf.base.isNullOrUndefined(i)?e:i.length),{element:i,index:t}},r.prototype.getLength=function(){for(var e=0,t=0;t<this.childWidgets.length;t++)for(var i=this.childWidgets[t],r=0;r<i.children.length;r++){var n=i.children[r];n instanceof je||(e+=n.length)}return e},r.prototype.getTableCellWidget=function(e){},r.prototype.getMinimumAndMaximumWordWidth=function(e,t){if(e=x.convertPointToPixel(e),t=x.convertPointToPixel(t),this.childWidgets.length>0){for(var i=this.childWidgets[0].children[0],r="",n=new a,o=[];;){if(i instanceof we&&""!==i.text)n.add(i,r.length),r+=i.text;else if(i instanceof fe&&0===i.fieldType){var s=i;sf.base.isNullOrUndefined(s.fieldEnd)||(i=sf.base.isNullOrUndefined(s.fieldSeparator)?s.fieldEnd:s.fieldSeparator)}else i instanceof Re&&o.push(i.width);if(sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.nextNode))break;i=i.nextNode}for(var l=new RegExp("\\b\\w+\\b","g"),h=[],d=void 0;!sf.base.isNullOrUndefined(d=l.exec(r));)h.push(d);for(var c=0;c<h.length;c++){var p=h[c],u=0;r="";for(var g="",f=0,m=p.index,y=p.index,v=0;v<n.keys.length;v++){var b=n.keys[v],w=n.get(b),M=b.length;if(y<=w+M&&(f=y-w,p.index+p[0].length<=w+M?m=p.index+p[0].length-(w+f):y+=m=M-f,g+=r=b.text.substring(f,f+m)),""!==r&&(u+=this.bodyWidget.page.documentHelper.textHelper.getWidth(r,b.characterFormat,b.scriptType)),g===p[0])break}0!==u&&(0===e||u>e)&&(e=u)}var N=0;o.length>0&&(N=Math.max.apply(null,o)),(0===e||N>e)&&(e=N);var I=this.measureParagraph();(0===t||I>t)&&(t=I)}return{maximumWordWidth:x.convertPixelToPoint(t),minimumWordWidth:x.convertPixelToPoint(e)}},r.prototype.measureParagraph=function(){for(var e=0,t=this.childWidgets[0].children[0];;){if(t instanceof we&&""!==t.text)e+=this.bodyWidget.page.documentHelper.textHelper.getWidth(t.text,t.characterFormat,t.scriptType);else if(t instanceof fe&&0===t.fieldType){var i=t;null!=i.fieldEnd&&(t=sf.base.isNullOrUndefined(i.fieldSeparator)?i.fieldEnd:i.fieldSeparator)}else t instanceof Re&&(e+=t.width);if(sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t.nextNode))break;t=t.nextNode}return this.leftIndent>0&&(e+=this.leftIndent),this.rightIndent>0&&(e+=this.rightIndent),e},r.prototype.isArabicChar=function(e){return e>=String.fromCharCode(1536)&&e<=String.fromCharCode(1791)||e>=String.fromCharCode(1872)&&e<=String.fromCharCode(1919)||e>=String.fromCharCode(2208)&&e<=String.fromCharCode(2303)||e>=String.fromCharCode(64336)&&e<=String.fromCharCode(65023)||e>=String.fromCharCode(65136)&&e<=String.fromCharCode(65279)},r.prototype.isHebrewChar=function(e){return e>=String.fromCharCode(1424)&&e<=String.fromCharCode(1535)||e>=String.fromCharCode(64285)&&e<=String.fromCharCode(64335)},r.prototype.isHindiChar=function(e){return e>=String.fromCharCode(2304)&&e<=String.fromCharCode(2431)||e>=String.fromCharCode(43232)&&e<=String.fromCharCode(43263)||e>=String.fromCharCode(7376)&&e<=String.fromCharCode(7423)},r.prototype.isKoreanChar=function(e){return e>=String.fromCharCode(44032)&&e<=String.fromCharCode(55203)||e>=String.fromCharCode(4352)&&e<=String.fromCharCode(4607)||e>=String.fromCharCode(12592)&&e<=String.fromCharCode(12687)||e>=String.fromCharCode(43360)&&e<=String.fromCharCode(43391)||e>=String.fromCharCode(55216)&&e<=String.fromCharCode(55295)||e>=String.fromCharCode(44032)&&e<=String.fromCharCode(55215)},r.prototype.isJapanese=function(e){return e>=String.fromCharCode(12448)&&e<=String.fromCharCode(12543)||e>=String.fromCharCode(12352)&&e<=String.fromCharCode(12447)},r.prototype.isThaiCharacter=function(e){return e>=String.fromCharCode(3584)&&e<=String.fromCharCode(3711)},r.prototype.isChineseChar=function(e){return e>=String.fromCharCode(19968)&&e<=String.fromCharCode(40959)||e>=String.fromCharCode(13312)&&e<=String.fromCharCode(19903)||e>=String.fromCharCode(55360)&&e<=String.fromCharCode(55401)||e>=String.fromCharCode(56320)&&e<=String.fromCharCode(57055)||e>=String.fromCharCode(43360)&&e<=String.fromCharCode(43391)||e>=String.fromCharCode(65280)&&e<=String.fromCharCode(65519)||e>=String.fromCharCode(12288)&&e<=String.fromCharCode(12351)},r.prototype.getFontScriptType=function(e){return this.isHindiChar(e)?t.Hindi:this.isKoreanChar(e)?t.Korean:this.isJapanese(e)?t.Japanese:this.isChineseChar(e)?t.Chinese:this.isArabicChar(e)?t.Arabic:this.isHebrewChar(e)?t.Hebrew:this.isThaiCharacter(e)?t.Thai:t.English},r.prototype.splitTextByFontScriptType=function(e,i){var r=[];if(sf.base.isNullOrUndefined(e)||!sf.base.isNullOrUndefined(e)&&""===e)return r;for(var n="",o=t.English,s=t.English,a=0;a<e.length;a++)e[a]!=String.fromCharCode(32)&&(s=this.getFontScriptType(e[a])),""!=n&&s!==o&&(r.push(n),i.push(o),n=""),n+=e[a],o=s;return""!=n&&(r.push(n),i.push(s),n=""),r},r.prototype.splitTextRangeByScriptType=function(e){var t=!1,i=1;if(this.childWidgets.length>0){for(var r=this.childWidgets[e],n=e+1;n<this.childWidgets.length;n++){for(var o=this.childWidgets[n],s=0;s<o.children.length;s++){var a=o.children[s];r.children.push(a),a.line=r}this.childWidgets.splice(n,1),n--}for(n=0;n<r.children.length;n+=i){var l=r.children[n];i=1;var h=void 0;if(l instanceof we&&(h=l),l instanceof fe&&0==l.fieldType?t=!0:l instanceof fe&&2===l.fieldType&&(t=!1),null!=h&&!t){var d=[],c=this.splitTextByFontScriptType(h.text,d);if(c.length>1)for(var p=0;p<c.length;p++){var u=c[p];if(p>0){var g=h.clone();g.text=u,g.scriptType=d[p],r.children.splice(n+p,0,g),g.line=r,i++}else h.text=u,h.scriptType=d[p]}else c.length>0&&(h.scriptType=d[0]);d.length=0}}}},r.prototype.splitLtrAndRtlText=function(e){var t={value:null},i=1,r={value:null},n=[],o=!1,s=this.bodyWidget.page.documentHelper.textHelper;if(this.childWidgets.length>0){for(var a=this.childWidgets[e],l=0;l<a.children.length;l+=i){var h=a.children[l];i=1;var d=void 0;if(h instanceof we&&(d=h),h instanceof fe&&0==h.fieldType?o=!0:h instanceof fe&&2===h.fieldType&&(o=!1),null!=d&&!o){var c=d.text,p=d.characterFormat.bidi,u=!1,g=n.length;p&&(u=s.isRightToLeftLanguage(h.characterFormat.localeIdBidi));var f=s.splitTextByConsecutiveLtrAndRtl(c,p,u,n,t,r);if(f.length>1)for(var m=0;m<f.length;m++)if(c=f[m],m>0){var y=d.clone();y.text=c,y.characterRange=n[m+g],a.children.splice(l+m,0,y),y.line=a,i++,d.revisions.length>0&&this.updateTextElementInRevisionRange(d,y)}else d.text=c,d.characterRange=n[g];else f.length>0&&(d.characterRange=n[g])}}n.length=0}},r.prototype.updateTextElementInRevisionRange=function(e,t){for(var i=0;i<e.revisions.length;i++){var r=e.revisions[i],n=r.range.indexOf(e);r.range.splice(n+1,0,t),t.revisions.push(r),t.removedIds=[]}},r.prototype.combineconsecutiveRTL=function(t){for(var i=!1,r=this.bodyWidget.page.documentHelper.textHelper,n=t;n<this.childWidgets.length;n++)for(var o=this.childWidgets[n],s=0;s<=o.children.length-2;s++){var a=o.children[s];if(a instanceof fe&&0===a.fieldType?i=!0:a instanceof fe&&2===a.fieldType&&(i=!1),!i&&a instanceof we&&o.children[s+1]instanceof we){var l=a,h=o.children[s+1];(l.characterFormat.complexScript&&l.scriptType==h.scriptType&&l.text.length>0&&h.text.length>0&&!r.isWordSplitChar(l.text[l.text.length-1])&&!r.isWordSplitChar(h.text[0])&&l.characterFormat.isEqualFormat(h.characterFormat)||l.characterRange==e.RightToLeft&&h.characterRange==e.RightToLeft&&l.text.length>0&&h.text.length>0&&r.isWordSplitChar(l.text[l.text.length-1])&&r.isWordSplitChar(h.text[0])&&l.characterFormat.isEqualFormat(h.characterFormat))&&(l.text=l.text+h.text,o.children.splice(s+1,1),s--)}}},r.prototype.clone=function(){var e=new r;e.paragraphFormat.copyFormat(this.paragraphFormat),e.characterFormat.copyFormat(this.characterFormat);for(var t=0;t<this.childWidgets.length;t++){var i=this.childWidgets[t].clone();e.childWidgets.push(i);for(var n=0;n<i.children.length;n++){var o=i.children[n];(o instanceof Re&&"Inline"!==o.textWrappingStyle||o instanceof Ee)&&e.floatingElements.push(o)}i.paragraph=e}return e.x=this.x,e.y=this.y,e.height=this.height,e.width=this.width,this.contentControlProperties&&(e.contentControlProperties=this.contentControlProperties),e},r.prototype.destroyInternal=function(e){var t=this.height;if(!sf.base.isNullOrUndefined(this.childWidgets)){for(var i=0;i<this.childWidgets.length;i++){if(this.childWidgets[i].destroy(),1===this.childWidgets.length&&sf.base.isNullOrUndefined(this.childWidgets[0].children)&&(this.childWidgets=void 0),sf.base.isNullOrUndefined(this.childWidgets))break;i--}this.childWidgets=void 0}sf.base.isNullOrUndefined(this.containerWidget)||sf.base.isNullOrUndefined(this.containerWidget.childWidgets)||-1===this.containerWidget.childWidgets.indexOf(this)||(this.containerWidget.childWidgets.splice(this.containerWidget.childWidgets.indexOf(this),1),this.containerWidget.height-=t,this.containerWidget=void 0),this.destroy()},r.prototype.destroy=function(){this.paragraphFormat=void 0,this.characterFormat=void 0,i.prototype.destroy.call(this)},r}(se),he=function(){function e(){}return e.prototype.clone=function(){var t=new e;return t.allowOverlap=this.allowOverlap,t.distanceTop=this.distanceTop,t.distanceRight=this.distanceRight,t.distanceLeft=this.distanceLeft,t.distanceBottom=this.distanceBottom,t.verticalAlignment=this.verticalAlignment,t.verticalOrigin=this.verticalOrigin,t.verticalPosition=this.verticalPosition,t.horizontalAlignment=this.horizontalAlignment,t.horizontalOrigin=this.horizontalOrigin,t.horizontalPosition=this.horizontalPosition,t},e}(),de=function(e){function t(){var t=e.call(this)||this;return t.flags=0,t.leftMargin=0,t.topMargin=0,t.rightMargin=0,t.bottomMargin=0,t.isDefaultFormatUpdated=!1,t.isContainInsideTable=!1,t.footnoteElement=[],t.margin=new te(t.leftMargin,t.topMargin,t.rightMargin,t.bottomMargin),t.leftBorderWidth=0,t.rightBorderWidth=0,t.topBorderWidth=0,t.bottomBorderWidth=0,t.tableFormat=new vt(t),t.tableHolder=new at,t.spannedRowCollection=new a,t}return J(t,e),Object.defineProperty(t.prototype,"isGridUpdated",{get:function(){return(4&this.flags)>>2!=0},set:function(e){this.flags=251&this.flags|(e?1:0)<<2},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"continueHeader",{get:function(){return(2&this.flags)>>1!=0},set:function(e){this.flags=253&this.flags|(e?1:0)<<1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"header",{get:function(){return 0!=(1&this.flags)},set:function(e){this.flags=254&this.flags|(e?1:0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isBidiTable",{get:function(){return(16&this.flags)>>4!=0},set:function(e){this.flags=239&this.flags|(e?1:0)<<4},enumerable:!0,configurable:!0}),t.prototype.equals=function(e){return e instanceof t&&e.tableFormat===this.tableFormat},t.prototype.combineRows=function(e){for(var t=0;t<this.childWidgets.length;t++){var i=this.childWidgets[t];0===i.childWidgets.length?(i.destroy(),t--):i.combineCells(e)}},t.prototype.contains=function(e){if(this.equals(e.ownerTable))return!0;for(;e.ownerTable.isInsideTable;){if(this.equals(e.ownerTable))return!0;e=e.ownerTable.associatedCell}return this.equals(e.ownerTable)},t.prototype.getOwnerWidth=function(e){var t=this.getContainerWidth();return(t=t-this.leftIndent-this.rightIndent)>=0?t:0},t.prototype.getTableWidth=function(){for(var e=0,t=0;t<this.childWidgets.length;t++){for(var i=0,r=this.childWidgets[t],n=0;n<r.childWidgets.length;n++)i+=r.childWidgets[n].cellFormat.cellWidth;e<i&&(e=i)}return e},t.prototype.getTableCellWidth=function(){for(var e=0,t=0;t<this.childWidgets.length;t++){for(var i=0,r=this.childWidgets[t],n=0;n<r.childWidgets.length;n++){var o=r.childWidgets[n],s=o.width;0===s&&((s=o.cellFormat.cellWidth)>o.cellFormat.preferredWidth&&0!==o.cellFormat.preferredWidth&&"Percent"!==o.cellFormat.preferredWidthType&&(s=o.cellFormat.preferredWidth),s=x.convertPointToPixel(s-(o.margin.left+o.margin.right))),i+=s+o.margin.left+o.margin.right}e<i&&(e=i)}return e},t.prototype.getTableClientWidth=function(e){var t=e;return"Point"===this.tableFormat.preferredWidthType&&this.tableFormat.preferredWidth>0?t=this.tableFormat.preferredWidth:"Percent"===this.tableFormat.preferredWidthType&&this.tableFormat.preferredWidth>0&&(t=t*this.tableFormat.preferredWidth/100),t},t.prototype.getCellWidth=function(e,t,i,r){var n=e;return"Percent"===t?n=e*i/100:"Point"===t?n=e:sf.base.isNullOrUndefined(r)||(n=this.getMinimumPreferredWidth(r)),n},t.prototype.getMinimumPreferredWidth=function(e){return 0===e.cellFormat.preferredWidth&&0!==e.cellFormat.cellWidth?e.cellFormat.cellWidth:e.getMinimumPreferredWidth()},t.prototype.fitCellsToClientArea=function(e){for(var t=e/this.getTableWidth(),i=0;i<this.childWidgets.length;i++){var r=this.childWidgets[i];r.rowFormat.gridAfterWidth*=t,r.rowFormat.gridBeforeWidth*=t;for(var n=0;n<r.childWidgets.length;n++)r.childWidgets[n].cellFormat.cellWidth*=t,r.childWidgets[n].cellFormat.preferredWidth*=t}},t.prototype.getTableCellWidget=function(e){for(var t=void 0,i=0;i<this.childWidgets.length;i++)if(this.childWidgets[i].y<=e.y&&this.childWidgets[i].y+this.childWidgets[i].height>=e.y){t=this.childWidgets[i].getTableCellWidget(e);break}return t},t.prototype.calculateGrid=function(e){var t=[],i=[],r=[],n=this.getOwnerWidth(!0),o=this.getTableClientWidth(n);this.tableCellInfo=new a;for(var s=0;s<this.childWidgets.length;s++){var l=this.childWidgets[s],h=new a,d=l.rowFormat,c=l.rowFormat.gridBefore,p=0;t.indexOf(p)<0&&(t.push(p),i.push(p)),p+=this.getCellWidth(d.gridBeforeWidth,d.gridBeforeWidthType,o,null);var u=parseFloat(p.toFixed(2));t.indexOf(u)<0&&(t.push(u),i.push(p));for(var g=0;g<l.childWidgets.length;g++){for(var f=l.childWidgets[g],m=0;m<r.length;m++)if(!(r[m].columnIndex<c)){var y=r[m].cellFormat.rowSpan,v=!0;r[m].columnIndex>c?(v=!1,g===l.childWidgets.length-1&&l.rowFormat.gridAfter>0&&(p+=this.getCellWidth(r[m].cellFormat.preferredWidth,r[m].cellFormat.preferredWidthType,o,null))):(p+=this.getCellWidth(r[m].cellFormat.preferredWidth,r[m].cellFormat.preferredWidthType,o,null),c=r[m].columnIndex+r[m].cellFormat.columnSpan),v||g!==l.childWidgets.length-1||(v=!0),v&&s-r[m].ownerRow.rowIndex==y-1&&(r.splice(m,1),m--)}if(f.cellFormat.rowSpan>1)if(0===r.length||r[r.length-1].columnIndex<=c)r.push(f);else for(var b=r.length;b>0;b--)r[b-1].columnIndex>c&&r.splice(b-1,0,f);h.containsKey(f.cellIndex)||h.add(f.cellIndex,parseFloat((p-u).toFixed(2))),c+=f.cellFormat.columnSpan,p+=this.getCellWidth(f.cellFormat.preferredWidth,f.cellFormat.preferredWidthType,o,null);var w=parseFloat(p.toFixed(2));t.indexOf(w)<0&&(t.push(w),i.push(p)),g===l.childWidgets.length-1&&d.gridAfter>0&&(p+=this.getCellWidth(d.gridAfterWidth,"Point",o,null),t.indexOf(parseFloat(p.toFixed(2)))<0&&(t.push(parseFloat(p.toFixed(2))),i.push(p)),c+=d.gridAfter),this.tableCellInfo.containsKey(l.rowIndex)||this.tableCellInfo.add(l.rowIndex,h)}}t.sort((function(e,t){return e-t})),i.sort((function(e,t){return e-t})),this.tableHolder.columns.length>0&&(t.length-1!==this.tableHolder.columns.length||e)&&this.updateColumnSpans(t,o,i),this.tableCellInfo.clear(),this.tableCellInfo=void 0},t.prototype.updateColumnSpans=function(e,t,i){for(var r=0;r<this.childWidgets.length;r++){var n=this.childWidgets[r];n.rowFormat.gridBeforeWidth>=0&&(n.rowFormat.gridBefore=n.getGridCount(e,void 0,-1,t,i));for(var o=0;o<n.childWidgets.length;o++){var s=n.childWidgets[o],a=n.getGridCount(e,s,s.getIndex(),t,i);a>0&&s.cellFormat.columnSpan!==a&&(s.cellFormat.columnSpan=a)}n.rowFormat.gridAfterWidth>=0&&(n.rowFormat.gridAfter=n.getGridCount(e,void 0,n.childWidgets.length,t,i))}},t.prototype.getMinimumAndMaximumWordWidth=function(e,t){this.checkTableColumns();var i=this.tableHolder.isAllColumnHasPointWidthType(),r=i?this.tableHolder.getTotalWidth(0):this.tableHolder.getTotalWidth(1);return r>e&&(e=r),i||(r=this.tableHolder.getTotalWidth(2)),r>t&&(t=r),{minimumWordWidth:e,maximumWordWidth:t}},t.prototype.checkTableColumns=function(){this.isGridUpdated||((this.isAutoFit()||0===this.tableHolder.columns.length)&&this.buildTableColumns(),this.isGridUpdated=!1)},t.prototype.isAutoFit=function(){var e=this.bodyWidget;return!sf.base.isNullOrUndefined(e)&&!sf.base.isNullOrUndefined(e.page)&&e.page.documentHelper.layout.getParentTable(this).tableFormat.allowAutoFit},t.prototype.buildTableColumns=function(){if(!this.isGridUpdated){this.tableHolder.resetColumns();var e,t=0,i=[],r="Auto"===this.tableFormat.preferredWidthType,n=this.tableFormat.allowAutoFit;t=!(!sf.base.isNullOrUndefined(this.bodyWidget.page)&&this.bodyWidget.page.viewer instanceof Z&&n)||this.isInsideTable||this.containerWidget instanceof ze?this.getOwnerWidth(!0):x.convertPixelToPoint(this.bodyWidget.page.viewer.clientArea.width-3*this.bodyWidget.page.viewer.padding.right),t=this.tableFormat.preferredWidth>t?this.tableFormat.preferredWidth:t;var o=r&&0===this.tableFormat.preferredWidth&&!n;e=this.getTableClientWidth(t),o&&!this.isDefaultFormatUpdated&&n&&this.splitWidthToTableCells(e,o);for(var s=!1,a=0;a<this.childWidgets.length;a++){var l=this.childWidgets[a],h=l.rowFormat,d=0,c=0,p=new ht,u=0;!(h.gridBefore>0)||0===l.rowFormat.beforeWidth&&0===l.rowFormat.gridBeforeWidth||this.bodyWidget.page.documentHelper.alignTablesRowByRow&&"Left"!==l.ownerTable.tableFormat.tableAlignment||(c=this.getCellWidth(h.gridBeforeWidth,l.rowFormat.gridAfterWidthType,e,null),p.minimumWidth=c,this.tableHolder.addColumns(d,d=h.gridBefore,c,p,u=c,"Point"));for(var g=0;g<l.childWidgets.length;g++){var f=l.childWidgets[g];(f.cellFormat.rowSpan>1||f.cellFormat.columnSpan>1)&&(s=!0),0===i.length&&(f.columnIndex=d);for(var m=0;m<i.length;m++){var y=i[m];if(y.columnIndex<d)f.columnIndex=d;else{var v,b=!0;v=y.cellFormat.rowSpan,y.columnIndex>d?(f.columnIndex=d,b=!1):(p=y.getCellSizeInfo(n),c=this.getCellWidth(y.cellFormat.preferredWidth,y.cellFormat.preferredWidthType,e,y),this.tableHolder.columns.length>0?(this.tableHolder.addColumns(d,d=this.tableHolder.columns.indexOf(y.ownerColumn)+y.cellFormat.columnSpan,c,p,u+=c,f.cellFormat.preferredWidthType),f.columnIndex=d):(this.tableHolder.addColumns(d,d=y.columnIndex+y.cellFormat.columnSpan,c,p,u+=c,f.cellFormat.preferredWidthType),f.columnIndex=d)),b||g!==l.childWidgets.length-1||(b=!0),b&&a-y.ownerRow.rowIndex==v-1&&(i.splice(m,1),m--)}}if(f.cellFormat.rowSpan>1)if(0===i.length||i[i.length-1].columnIndex<=d)i.push(f);else{for(var w=0,M=i.length;M>0;M--)i[M-1].columnIndex>d&&(w=M-1);i.splice(w,0,f)}p=f.getCellSizeInfo(n),c=this.getCellWidth(f.cellFormat.preferredWidth,f.cellFormat.preferredWidthType,e,f),this.tableHolder.addColumns(d,d+=f.cellFormat.columnSpan,c,p,u+=c,f.cellFormat.preferredWidthType),g===l.childWidgets.length-1&&h.gridAfterWidth>0&&(c=this.getCellWidth(h.gridAfterWidth,"Point",e,null),p.minimumWordWidth=p.maximumWordWidth=p.minimumWidth=c,this.tableHolder.addColumns(d,d+=h.gridAfter,c,p,u+=c,"Point"))}}o&&!this.isDefaultFormatUpdated&&(this.isDefaultFormatUpdated=!0),this.tableHolder.validateColumnWidths(),n?this.tableHolder.autoFitColumn(t,e,r,this.isInsideTable,s,this.leftIndent+this.rightIndent):this.tableHolder.fitColumns(t,e,r,this.leftIndent+this.rightIndent),this.setWidthToCells(e,r)}},t.prototype.setWidthToCells=function(e,t){for(var i=0;i<this.childWidgets.length;i++){var r=this.childWidgets[i],n=r.rowFormat;n.gridBefore>0&&(n.beforeWidth=this.tableHolder.getCellWidth(0,n.gridBefore,e));for(var o=0;o<r.childWidgets.length;o++){var s=r.childWidgets[o];s.cellFormat.cellWidth=this.tableHolder.getCellWidth(s.columnIndex,s.cellFormat.columnSpan,e)}n.gridAfter>0&&(n.afterWidth=this.tableHolder.getCellWidth(0,n.gridAfter,e))}},t.prototype.updateProperties=function(e,t,i){if(e&&(this.tableFormat.allowAutoFit="FixedColumnWidth"!==i),this===t)if("FixedColumnWidth"===i){this.tableFormat.preferredWidth=0,this.tableFormat.preferredWidthType="Auto";for(var r=0;r<this.childWidgets.length;r++)for(var n=this.childWidgets[r],o=0;o<n.childWidgets.length;o++){var s=n.childWidgets[o];s.cellFormat.preferredWidthType="Point",s.cellFormat.preferredWidth=s.cellFormat.cellWidth}}else if("FitToWindow"===i){var a=this.tableHolder.getTotalWidth(0);this.tableFormat.leftIndent=0,this.tableFormat.preferredWidth=100,this.tableFormat.preferredWidthType="Percent";for(r=0;r<this.childWidgets.length;r++)for(var l=this.childWidgets[r],h=0;h<l.childWidgets.length;h++){"Percent"!==(d=l.childWidgets[h]).cellFormat.preferredWidthType&&(d.cellFormat.preferredWidthType="Percent",d.cellFormat.preferredWidth=d.cellFormat.cellWidth/a*100)}}else{this.tableFormat.preferredWidth=0,this.tableFormat.preferredWidthType="Auto";for(r=0;r<this.childWidgets.length;r++){(l=this.childWidgets[r]).rowFormat.beforeWidth=0,l.rowFormat.gridBefore=0,l.rowFormat.gridBeforeWidth=0,l.rowFormat.gridBeforeWidthType="Auto",l.rowFormat.afterWidth=0,l.rowFormat.gridAfter=0,l.rowFormat.gridAfterWidth=0,l.rowFormat.gridAfterWidthType="Auto";for(o=0;o<l.childWidgets.length;o++){var d;(d=l.childWidgets[o]).cellFormat.preferredWidth=0,d.cellFormat.preferredWidthType="Auto"}}}else t.updateProperties(!1,t,i)},t.prototype.getMaxRowWidth=function(e){for(var t=0,i=0;i<this.childWidgets.length;i++){for(var r=this.childWidgets[i],n=0,o=0;o<r.childWidgets.length;o++){var s=r.childWidgets[o];n+=this.getCellWidth(s.cellFormat.preferredWidth,s.cellFormat.preferredWidthType,e,s)}t<n&&(t=n)}return t},t.prototype.updateWidth=function(e){var t=this.tableHolder.getTotalWidth(0),i=this.getOwnerWidth(!0),r=this.getTableClientWidth(i);if(r<=t&&"Auto"===this.tableFormat.preferredWidthType&&(this.tableFormat.preferredWidthType="Point"),"Auto"!==this.tableFormat.preferredWidthType)if("Point"===this.tableFormat.preferredWidthType)this.tableFormat.preferredWidth=this.getMaxRowWidth(r);else{var n=t/i*100;this.tableFormat.preferredWidth=n}},t.prototype.convertPointToPercent=function(e,t){var i=0;return i=e/t*100,(i=Math.round(i))<100?i:100},t.prototype.updateChildWidgetLeft=function(e){for(var t=0;t<this.childWidgets.length;t++){var i=this.childWidgets[t];i.x=e,i.updateChildWidgetLeft(e)}},t.prototype.shiftWidgetsForRtlTable=function(e,t){var i=t.x,r=e.right,n=0;t.tableFormat&&t.tableFormat.cellSpacing>0&&(n=t.tableFormat.cellSpacing);for(var o=0;o<t.childWidgets.length;o++)for(var s=t.childWidgets[o],a=r-(s.x-i),l=0;l<s.childWidgets.length;l++){var h=s.childWidgets[l];a-=h.width+h.margin.left+h.margin.right-h.rightBorderWidth+n,h.updateWidgetLeft(a+h.margin.left)}},t.prototype.clone=function(){var e=new t;e.tableHolder=this.tableHolder.clone(),e.tableFormat.copyFormat(this.tableFormat),this.wrapTextAround&&(e.wrapTextAround=this.wrapTextAround,e.positioning=this.positioning.clone());for(var i=0;i<this.childWidgets.length;i++){var r=this.childWidgets[i].clone();e.childWidgets.push(r),r.containerWidget=e,r.index=i}return e.x=this.x,e.y=this.y,e.height=this.height,e.width=this.width,e.containerWidget=this.containerWidget,this.contentControlProperties&&(e.contentControlProperties=this.contentControlProperties),e},t.getTableOf=function(e){if(e instanceof u){var i=ce.getRowOf(e);return sf.base.isNullOrUndefined(i)?e.ownerBase instanceof vt&&e.ownerBase.ownerBase instanceof t?e.ownerBase.ownerBase:void 0:i.ownerTable}},t.prototype.fitChildToClientArea=function(){var e=this.getContainerWidth();Math.round(e)<Math.round(this.getTableWidth())&&this.fitCellsToClientArea(e);for(var i=0;i<this.childWidgets.length;i++)for(var r=this.childWidgets[i],n=0;n<r.childWidgets.length;n++)for(var o=r.childWidgets[n],s=0;s<o.childWidgets.length;s++)o.childWidgets[s]instanceof t&&o.childWidgets[s].fitChildToClientArea()},t.prototype.getColumnCellsForSelection=function(e,t){for(var i=[],r=e.columnIndex,n=t.columnIndex+t.cellFormat.columnSpan,o=0;o<this.childWidgets.length;o++)for(var s=this.childWidgets[o],a=0;a<s.childWidgets.length;a++){var l=s.childWidgets[a],h=l.columnIndex,d=l.cellFormat.columnSpan;h+d>r&&h+d<n||h>r&&h<n||h>r&&h<n&&h+d<n||h<r&&h+d>n?i.indexOf(l)<0&&i.push(l):h!==r&&h+d!==n||i.indexOf(l)<0&&i.push(l)}return i},t.prototype.splitWidthToTableCells=function(e,t){for(var i=0;i<this.childWidgets.length;i++)this.childWidgets[i].splitWidthToRowCells(e,t)},t.prototype.insertTableRowsInternal=function(e,t,i){for(var r=e.length-1;r>=0;r--){var n=e.splice(r,1)[0];n.containerWidget=this,this.childWidgets.splice(t,0,n)}this.updateRowIndex(t),this.isGridUpdated=!1,i&&(this.calculateGrid(!0),this.buildTableColumns()),this.isGridUpdated=!0},t.prototype.updateRowIndex=function(e){for(var t=e;t<this.childWidgets.length;t++){var i=this.childWidgets[t];i.index=t;for(var r=0;r<i.childWidgets.length;r++)i.childWidgets[r].index=r,i.childWidgets[r].rowIndex=i.rowIndex;e++}},t.prototype.getCellStartOffset=function(e){var t=0;if(e&&this.tableCellInfo&&this.tableCellInfo.containsKey(e.ownerRow.rowIndex)){var i=this.tableCellInfo.get(e.ownerRow.rowIndex);i.containsKey(e.cellIndex)&&(t=i.get(e.cellIndex))}return t},t.prototype.destroyInternal=function(e){var t=this.height;if(!sf.base.isNullOrUndefined(this.childWidgets)){for(var i=0;i<this.childWidgets.length;i++){var r=void 0;if(r=this.childWidgets[i],sf.base.isNullOrUndefined(r)||r.destroyInternal(e),sf.base.isNullOrUndefined(this.childWidgets))break;i--}this.childWidgets=void 0}sf.base.isNullOrUndefined(this.containerWidget)||(this.containerWidget instanceof ne&&-1!==this.containerWidget.floatingElements.indexOf(this)&&this.containerWidget.floatingElements.splice(this.containerWidget.floatingElements.indexOf(this),1),sf.base.isNullOrUndefined(this.containerWidget.childWidgets)||(-1!==this.containerWidget.childWidgets.indexOf(this)&&this.containerWidget.childWidgets.splice(this.containerWidget.childWidgets.indexOf(this),1),this.containerWidget.height-=t),this.containerWidget=void 0),this.destroy()},t.prototype.destroy=function(){this.tableFormat=void 0,this.spannedRowCollection&&this.spannedRowCollection.destroy(),this.spannedRowCollection=void 0,this.tableHolder=void 0,this.flags=void 0,this.leftMargin=void 0,this.topMargin=void 0,this.rightMargin=void 0,this.bottomMargin=void 0,this.headerHeight=void 0,this.description=void 0,this.title=void 0,this.isDefaultFormatUpdated=void 0,e.prototype.destroy.call(this)},t}(se),ce=function(e){function t(){var t=e.call(this)||this;return t.topBorderWidth=0,t.bottomBorderWidth=0,t.rowFormat=new C(t),t}return J(t,e),Object.defineProperty(t.prototype,"rowIndex",{get:function(){return this.containerWidget?this.containerWidget.childWidgets.indexOf(this):-1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ownerTable",{get:function(){if(this.containerWidget instanceof de)return this.containerWidget},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"nextRow",{get:function(){var e=this.indexInOwner;if(e>-1&&e<this.ownerTable.childWidgets.length-1)return this.ownerTable.childWidgets[e+1]},enumerable:!0,configurable:!0}),t.prototype.equals=function(e){return e instanceof t&&e.rowFormat===this.rowFormat},t.prototype.combineCells=function(e){for(var t=0;t<this.childWidgets.length;t++){var i=this.childWidgets[t];if(i.combineWidget(e),sf.base.isNullOrUndefined(i.cellFormat)||1!==i.cellFormat.rowSpan)sf.base.isNullOrUndefined(i.cellFormat)&&t--;else{i.height,i.margin.top,i.margin.bottom;this.height-this.ownerTable.tableFormat.cellSpacing<i.height&&(this.height=this.ownerTable.tableFormat.cellSpacing+i.height)}}},t.getRowOf=function(e){if(e instanceof u){var i=pe.getCellOf(e);return sf.base.isNullOrUndefined(i)?e.ownerBase instanceof C&&e.ownerBase.ownerBase instanceof t?e.ownerBase.ownerBase:void 0:i.ownerRow}},t.prototype.getCell=function(e,t){for(var i=0;i<this.childWidgets.length;i++){var r=this.childWidgets[i];if(r.rowIndex===e&&r.index===t)return r}},t.prototype.splitWidthToRowCells=function(e,t){for(var i=this.childWidgets,r=e/i.length,n=0;n<i.length;n++)if(t&&0===i[n].cellFormat.preferredWidth)i[n].cellFormat.preferredWidth=r,this.ownerTable.isDefaultFormatUpdated=!1;else{if(t){this.ownerTable.isDefaultFormatUpdated=!0;break}i[n].cellFormat.preferredWidth=r}},t.prototype.getGridCount=function(e,t,i,r,n){var o=0,s=0,a=this.ownerTable,l=this.rowFormat;-1===i?s=a.getCellWidth(l.gridBeforeWidth,l.gridBeforeWidthType,r,null):(o+=a.getCellWidth(l.gridBeforeWidth,l.gridBeforeWidthType,r,null),i>=0&&(o+=a.getCellStartOffset(t)),s=i<this.childWidgets.length?a.getCellWidth(t.cellFormat.preferredWidth,t.cellFormat.preferredWidthType,r,null):a.getCellWidth(l.gridAfterWidth,l.gridAfterWidthType,r,null));var h=n[e.indexOf(o)],d=this.getOffsetIndex(e,o),c=parseFloat((s+o).toFixed(2));return(parseFloat((s+h).toFixed(2))===c||sf.base.isNullOrUndefined(h)?this.getOffsetIndex(e,o+s):this.getOffsetIndex(e,h+s))-d},t.prototype.getOffsetIndex=function(e,t){t=parseFloat(t.toFixed(2));var i=0;if(e.indexOf(t)>=0)i=e.indexOf(t);else{for(var r=0;r<e.length;r++)if(e[r]>t)return r;i=e.length-1}return i},t.prototype.getCellOffset=function(e,t){for(var i=0,r=this.ownerTable,n=0;n<this.childWidgets.length;n++){var o=this.childWidgets[n].cellFormat;if(n===e)break;i+=r.getCellWidth(o.preferredWidth,o.preferredWidthType,t,null)}return i},t.prototype.updateRowBySpannedCells=function(){for(var e=this.getPreviousRowSpannedCells(),t=this.rowIndex,i=0;i<e.length;i++){var r=e[i];r.ownerRow.rowIndex+r.cellFormat.rowSpan-1>=t&&(r.cellFormat.rowSpan-=1)}},t.prototype.getPreviousRowSpannedCells=function(e){for(var t=[],i=e?this:this.previousWidget;!sf.base.isNullOrUndefined(i);){for(var r=0;r<i.childWidgets.length;r++){var n=i.childWidgets[r];n.cellFormat.rowSpan>1&&t.splice(0,0,n)}i=i.previousWidget}return t},t.prototype.isCellsHaveSameWidthUnit=function(){if(this.childWidgets.length>0)for(var e=this.childWidgets[0].cellFormat.preferredWidthType,t=1;t<this.childWidgets.length;t++){if(e!=this.childWidgets[t].cellFormat.preferredWidthType)return!1}return!0},t.prototype.updateUniformWidthUnitForCells=function(){for(var e=0;e<this.childWidgets.length;e++){var t=this.childWidgets[e];t.cellFormat.preferredWidthType="Point",t.cellFormat.preferredWidth=t.cellFormat.cellWidth}},t.prototype.getTableCellWidget=function(e){for(var t=0;t<this.childWidgets.length;t++){var i=Math.round(this.childWidgets[t].x);if(i-this.childWidgets[t].margin.left-1<=e.x&&i+this.childWidgets[t].width>=e.x)return this.childWidgets[t];if(t===this.childWidgets.length-1&&this.childWidgets[t].x+this.childWidgets[t].width+1<=e.x)return this.childWidgets[t]}var r=void 0;return this.childWidgets.length>0&&(r=this.childWidgets[0].x<=e.x?this.childWidgets[this.childWidgets.length-1].getTableCellWidget(e):this.childWidgets[0].getTableCellWidget(e)),r},t.prototype.getCellWidget=function(e,t){var i=this.ownerTable.tableHolder.getValidColumnIndex(e);i>e&&(t-=i-e,e=i);var r=0;this.rowFormat.gridBefore>0&&(r+=this.rowFormat.gridBefore);for(var n=0;n<this.childWidgets.length;n++){var o=this.childWidgets[n],s=o.cellFormat.columnSpan;if(r<o.columnIndex&&(r<=e||r<e+t)&&o.columnIndex>e)return null;if((o.columnIndex<=e||o.columnIndex<e+t)&&o.columnIndex+s>e)return o;if(o.columnIndex>e)break;r+=s}return null},t.prototype.getVerticalMergeStartCell=function(e,t){var i=this.ownerTable.tableHolder.columns;if(this.rowFormat.gridBefore>0&&this.rowFormat.gridBefore>e+t)return null;var r,n=this.getCellWidget(e,t);if(!sf.base.isNullOrUndefined(n))return n;if(e+this.rowFormat.gridAfter===i.length)return null;var o=this.previousWidget;return sf.base.isNullOrUndefined(o)||(r=o.getVerticalMergeStartCell(e,t)),!sf.base.isNullOrUndefined(r)&&r.cellFormat.rowSpan>1&&this.index===r.rowIndex+r.cellFormat.rowSpan-1?r:null},t.prototype.getMinimumAndMaximumWordWidth=function(e,t){return{minimumWordWidth:e,maximumWordWidth:t}},t.prototype.destroyInternal=function(e){var t=this.height;if(!sf.base.isNullOrUndefined(this.childWidgets)){for(var i=0;i<this.childWidgets.length;i++){if(this.childWidgets[i].destroyInternal(e),sf.base.isNullOrUndefined(this.childWidgets))break;i--}this.childWidgets=void 0}sf.base.isNullOrUndefined(this.containerWidget)||sf.base.isNullOrUndefined(this.containerWidget.childWidgets)||(this.containerWidget.childWidgets.splice(this.containerWidget.childWidgets.indexOf(this),1),(sf.base.isNullOrUndefined(this.containerWidget.childWidgets)||0===this.containerWidget.childWidgets.length)&&this.containerWidget instanceof de?this.containerWidget.destroyInternal(e):this.containerWidget.containerWidget instanceof ne&&(this.containerWidget.containerWidget.height-=t),this.containerWidget.height-=t),this.destroy()},t.prototype.clone=function(){var e=new t;e.rowFormat.copyFormat(this.rowFormat),e.topBorderWidth=this.topBorderWidth,e.bottomBorderWidth=this.bottomBorderWidth;for(var i=0;i<this.childWidgets.length;i++){var r=this.childWidgets[i].clone();e.childWidgets.push(r),r.containerWidget=e,r.index=i,r.rowIndex=this.rowIndex}return e.x=this.x,e.y=this.y,e.height=this.height,e.width=this.width,this.contentControlProperties&&(e.contentControlProperties=this.contentControlProperties),e},t.prototype.updateChildWidgetLeft=function(e){var t=0;this.ownerTable.tableFormat.cellSpacing>0&&(t=this.ownerTable.tableFormat.cellSpacing);for(var i=0;i<this.childWidgets.length;i++){var r=this.childWidgets[i];e+=t+r.margin.left,r.x=e,r.updateChildWidgetLeft(r.x),e+=r.width+r.margin.right}},t.prototype.shiftWidgetForRtlTable=function(){var e=this.ownerTable,t=e.x,i=0;null!=e.tableFormat&&e.tableFormat.cellSpacing>0&&(i=e.tableFormat.cellSpacing);for(var r=t+x.convertPointToPixel(e.getTableWidth())-(this.x-t),n=0,o=0;o<this.childWidgets.length;o++){var s=this.childWidgets[o],a=0;sf.base.isNullOrUndefined(s.previousWidget)||(a=s.previousWidget.columnIndex+s.previousWidget.cellFormat.columnSpan),a<s.columnIndex&&(n=x.convertPointToPixel(s.ownerTable.tableHolder.getPreviousSpannedCellWidth(a,s.columnIndex)),0===a&&(n-=i/2)),r-=s.width+s.margin.left+s.margin.right+i,s.updateWidgetLeft(r+s.margin.left-n)}},t.prototype.destroy=function(){this.rowFormat=void 0,this.rowFormat=void 0,this.topBorderWidth=void 0,this.bottomBorderWidth=void 0,e.prototype.destroy.call(this)},t}(se),pe=function(e){function t(){var t=e.call(this)||this;return t.rowIndex=-1,t.sizeInfoInternal=new ht,t.updatedTopBorders=[],t.margin=new te(t.leftMargin,t.topMargin,t.rightMargin,t.bottomMargin),t.leftBorderWidth=0,t.rightBorderWidth=0,t.cellFormat=new bt(t),t}return J(t,e),Object.defineProperty(t.prototype,"ownerColumn",{get:function(){return this.ownerTable.tableHolder.columns[this.columnIndex]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"leftMargin",{get:function(){return this.cellFormat&&this.cellFormat.containsMargins()?this.cellFormat.leftMargin:!sf.base.isNullOrUndefined(this.ownerRow)&&this.ownerRow.rowFormat.hasValue("leftMargin")?this.ownerRow.rowFormat.leftMargin:sf.base.isNullOrUndefined(this.ownerTable)||sf.base.isNullOrUndefined(this.ownerTable.tableFormat)?0:this.ownerTable.tableFormat.leftMargin},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"topMargin",{get:function(){return this.cellFormat&&this.cellFormat.containsMargins()?this.cellFormat.topMargin:!sf.base.isNullOrUndefined(this.ownerRow)&&this.ownerRow.rowFormat.hasValue("topMargin")?this.ownerRow.rowFormat.topMargin:sf.base.isNullOrUndefined(this.ownerTable)||sf.base.isNullOrUndefined(this.ownerTable.tableFormat)?0:this.ownerTable.tableFormat.topMargin},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rightMargin",{get:function(){return this.cellFormat&&this.cellFormat.containsMargins()?this.cellFormat.rightMargin:!sf.base.isNullOrUndefined(this.ownerRow)&&this.ownerRow.rowFormat.hasValue("rightMargin")?this.ownerRow.rowFormat.rightMargin:sf.base.isNullOrUndefined(this.ownerTable)||sf.base.isNullOrUndefined(this.ownerTable.tableFormat)?0:this.ownerTable.tableFormat.rightMargin},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bottomMargin",{get:function(){return this.cellFormat&&this.cellFormat.containsMargins()?this.cellFormat.bottomMargin:!sf.base.isNullOrUndefined(this.ownerRow)&&this.ownerRow.rowFormat.hasValue("bottomMargin")?this.ownerRow.rowFormat.bottomMargin:sf.base.isNullOrUndefined(this.ownerTable)||sf.base.isNullOrUndefined(this.ownerTable.tableFormat)?0:this.ownerTable.tableFormat.bottomMargin},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"cellIndex",{get:function(){return this.ownerRow?this.ownerRow.childWidgets.indexOf(this):-1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ownerTable",{get:function(){if(this.containerWidget instanceof ce)return this.containerWidget.ownerTable},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ownerRow",{get:function(){return this.containerWidget},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"sizeInfo",{get:function(){return this.sizeInfoInternal},enumerable:!0,configurable:!0}),t.prototype.equals=function(e){return e instanceof t&&e.cellFormat===this.cellFormat},t.prototype.getContainerTable=function(){for(var e=this.ownerTable;e instanceof de&&e.associatedCell instanceof t;)e=e.associatedCell.getContainerTable();return e},t.prototype.getPreviousSplitWidget=function(){if(this.containerWidget instanceof ce){var e=this.containerWidget;do{if(e=e.previousRenderedWidget,sf.base.isNullOrUndefined(e)||e.index<this.rowIndex)break;var t=e.getCell(this.rowIndex,this.index);if(t&&this.equals(t))return t}while(e)}},t.prototype.getNextSplitWidget=function(){var e=this.cellFormat.rowSpan;if(this.containerWidget instanceof ce){var t=this.containerWidget;do{if(t=t.nextRenderedWidget,sf.base.isNullOrUndefined(t)||t.index>this.rowIndex+e)break;var i=t.getCell(this.rowIndex,this.index);if(i&&this.equals(i))return i}while(t)}},t.prototype.getTableCellWidget=function(e){for(var t=0;t<this.childWidgets.length;t++)if(this.childWidgets[t].y<=e.y&&this.childWidgets[t].y+this.childWidgets[t].height>=e.y)return this.childWidgets[t].getTableCellWidget(e);var i=void 0;return this.childWidgets.length>0&&(i=this.childWidgets[0].y<=e.y?this.childWidgets[this.childWidgets.length-1].getTableCellWidget(e):this.childWidgets[0].getTableCellWidget(e)),i},t.prototype.updateWidth=function(e){"Point"===this.cellFormat.preferredWidthType?this.cellFormat.preferredWidth=e:"Percent"===this.cellFormat.preferredWidthType&&(this.cellFormat.preferredWidth=this.convertPointToPercent(e)),this.cellFormat.cellWidth=e},t.prototype.getCellWidth=function(e){var t=this.ownerTable,i=t?t.getTableClientWidth(t.getOwnerWidth(!0)):0,r=i,n=sf.base.isNullOrUndefined(this.leftMargin)?0:this.leftMargin,o=sf.base.isNullOrUndefined(this.rightMargin)?0:this.rightMargin;return t&&"Auto"===t.tableFormat.preferredWidthType&&t.tableFormat.allowAutoFit?r=0===this.cellFormat.preferredWidth?i:this.cellFormat.preferredWidth-n-o:"Percent"===this.cellFormat.preferredWidthType?r=this.cellFormat.preferredWidth*i/100-n-o:"Point"===this.cellFormat.preferredWidthType&&(r=e instanceof de&&"Percent"===e.tableFormat.preferredWidthType?this.cellFormat.cellWidth-n-o:this.cellFormat.preferredWidth-n-o),r},t.prototype.convertPointToPercent=function(e){var t=0,i=this.ownerTable.getOwnerWidth(!0);return t=e/this.ownerTable.getTableClientWidth(i)*100,(t=Math.round(t))<100?t:100},t.getCellLeftBorder=function(e){var t=void 0,i=e.cellFormat.borders,r=sf.base.isNullOrUndefined(e.ownerRow)?void 0:e.ownerRow.rowFormat.borders,n=sf.base.isNullOrUndefined(e.ownerTable)?void 0:e.ownerTable.tableFormat.borders;if(sf.base.isNullOrUndefined(i.left)||(t=i.left),sf.base.isNullOrUndefined(t)&&(t=e.getLeftBorderToRenderByHierarchy(t,r,n)),e.ownerTable.tableFormat.cellSpacing>0)t=e.getLeftBorderToRenderByHierarchy(t,r,n);else{var o=this.getPreviousCell(e);t=e.getPreviousCellLeftBorder(t,o)}return sf.base.isNullOrUndefined(t)&&(t=new p(e.cellFormat.borders)),t},t.getPreviousCell=function(e){var t=void 0;if(!sf.base.isNullOrUndefined(e.previousWidget)){var i=e.previousWidget;i.columnIndex+i.cellFormat.columnSpan===e.columnIndex&&(t=i)}return t},t.prototype.getLeftBorderWidth=function(){var e=0;return null!==this.cellFormat&&null!==this.cellFormat.borders&&(e=t.getCellLeftBorder(this).getLineWidth()),e},t.prototype.getRightBorderWidth=function(){var e=0;this.ownerTable;return null!==this.cellFormat&&null!==this.cellFormat.borders&&(e=t.getCellRightBorder(this).getLineWidth()),e},t.prototype.getCellSpacing=function(){var e=this.ownerTable&&this.ownerTable.tableFormat?this.ownerTable.tableFormat.cellSpacing:0;return 1===this.ownerRow.childWidgets.length?2*e:0===this.cellIndex||this.cellIndex===this.ownerRow.childWidgets.length-1?e+e/2:e},t.prototype.getCellSizeInfo=function(e){var t=!0,i=void 0;if(sf.base.isNullOrUndefined(this.bodyWidget)||sf.base.isNullOrUndefined(this.bodyWidget.page)||sf.base.isNullOrUndefined(this.bodyWidget.page.documentHelper)||(i=this.bodyWidget.page.documentHelper.layout),sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.currentCell)||(t=!1,this===i.currentCell&&(t=!0)),t&&!this.sizeInfo.hasMinimumWidth&&(this.sizeInfo.minimumWidth=this.getMinimumPreferredWidth()),e&&t&&!this.sizeInfo.hasMinimumWordWidth){var r=this.getMinimumAndMaximumWordWidth(0,0);this.sizeInfo.minimumWordWidth=r.minimumWordWidth+this.sizeInfo.minimumWidth,this.sizeInfo.maximumWordWidth=r.maximumWordWidth+this.sizeInfo.minimumWidth}var n=new ht;return n.minimumWidth=this.sizeInfo.minimumWidth,n.minimumWordWidth=this.sizeInfo.minimumWordWidth,n.maximumWordWidth=this.sizeInfo.maximumWordWidth,n},t.prototype.getMinimumPreferredWidth=function(){return this.leftMargin+this.rightMargin+this.getLeftBorderWidth()+this.getRightBorderWidth()+this.getCellSpacing()},t.prototype.getPreviousCellLeftBorder=function(e,t){if((sf.base.isNullOrUndefined(t)||!sf.base.isNullOrUndefined(e)&&"None"===e.lineStyle&&!e.hasNoneStyle)&&(sf.base.isNullOrUndefined(e)||e.ownerBase.ownerBase instanceof vt||(e=this.getLeftBorderToRenderByHierarchy(e,ce.getRowOf(e.ownerBase).rowFormat.borders,de.getTableOf(e.ownerBase).tableFormat.borders))),sf.base.isNullOrUndefined(t))return e;var i=void 0;return sf.base.isNullOrUndefined(t.cellFormat.borders)||sf.base.isNullOrUndefined(t.cellFormat.borders.right)||"None"===t.cellFormat.borders.right.lineStyle||(i=t.cellFormat.borders.right),sf.base.isNullOrUndefined(i)||"None"===i.lineStyle?sf.base.isNullOrUndefined(e)||e.ownerBase.ownerBase instanceof vt?e:this.getLeftBorderToRenderByHierarchy(e,ce.getRowOf(e.ownerBase).rowFormat.borders,de.getTableOf(e.ownerBase).tableFormat.borders):this.getBorderBasedOnPriority(i,e)},t.prototype.getBorderBasedOnPriority=function(e,t){if(sf.base.isNullOrUndefined(e))return t;if(sf.base.isNullOrUndefined(t))return e;var i=e.getBorderWeight(),r=t.getBorderWeight();if(i===r){var n=e.getPrecedence(),o=t.getPrecedence();if(n===o){var s=x.convertHexToRgb(e.color),a=s.r,l=s.g,h=s.b,d=x.convertHexToRgb(t.color),c=d.r,p=d.g,u=d.b,g=a+h+2*l,f=c+u+2*p;return g===f&&(g=h+2*l)===(f=u+2*p)?l===p?e:l>p?t:e:g>f?t:e}return n>o?e:t}return i>r?e:t},t.prototype.getLeftBorderToRenderByHierarchy=function(e,i,r){var n=t.getCellOf(e.ownerBase);if(!sf.base.isNullOrUndefined(n)){var o=!1;(0===n.columnIndex||0===n.cellIndex&&n.ownerRow.rowFormat.gridBefore>0)&&(o=!0),(sf.base.isNullOrUndefined(e)||"None"!==e.lineStyle||e.isBorderDefined&&0!==e.lineWidth)&&!sf.base.isNullOrUndefined(e)||(o?(e=i.left,(!sf.base.isNullOrUndefined(e)&&"None"===e.lineStyle||sf.base.isNullOrUndefined(e))&&(e=r.left)):(e=i.vertical,(!sf.base.isNullOrUndefined(e)&&"None"===e.lineStyle||sf.base.isNullOrUndefined(e))&&(e=r.vertical)))}return e},t.getCellRightBorder=function(e){var t=void 0,i=e.cellFormat.borders,r=sf.base.isNullOrUndefined(e.ownerRow)?void 0:e.ownerRow.rowFormat.borders,n=sf.base.isNullOrUndefined(e.ownerTable)?void 0:e.ownerTable.tableFormat.borders;if(sf.base.isNullOrUndefined(i.right)||(t=i.right),sf.base.isNullOrUndefined(t)&&(t=e.getRightBorderToRenderByHierarchy(t,r,n)),e.ownerTable.tableFormat.cellSpacing>0)t=e.getRightBorderToRenderByHierarchy(t,r,n);else{var o=this.getNextCell(e);t=e.getAdjacentCellRightBorder(t,o)}return sf.base.isNullOrUndefined(t)&&(t=new p(e.cellFormat.borders)),t},t.getNextCell=function(e){var t=void 0,i=e.cellFormat.columnSpan;if(!sf.base.isNullOrUndefined(e.nextWidget)){var r=e.nextWidget;e.columnIndex+i===r.columnIndex&&(t=r)}return t},t.prototype.getAdjacentCellRightBorder=function(e,t){if((sf.base.isNullOrUndefined(t)||!sf.base.isNullOrUndefined(e)&&"None"===e.lineStyle&&!e.hasNoneStyle)&&(sf.base.isNullOrUndefined(e)||e.ownerBase.ownerBase instanceof vt||(e=this.getRightBorderToRenderByHierarchy(e,ce.getRowOf(e.ownerBase).rowFormat.borders,de.getTableOf(e.ownerBase).tableFormat.borders))),sf.base.isNullOrUndefined(t))return e;var i=void 0;return sf.base.isNullOrUndefined(t.cellFormat.borders)||sf.base.isNullOrUndefined(t.cellFormat.borders.left)||"None"===t.cellFormat.borders.left.lineStyle||(i=t.cellFormat.borders.left),sf.base.isNullOrUndefined(i)||"None"===i.lineStyle?sf.base.isNullOrUndefined(e)||e.ownerBase.ownerBase instanceof vt?e:this.getRightBorderToRenderByHierarchy(e,ce.getRowOf(e.ownerBase).rowFormat.borders,de.getTableOf(e.ownerBase).tableFormat.borders):this.getBorderBasedOnPriority(e,i)},t.prototype.getRightBorderToRenderByHierarchy=function(e,i,r){var n=t.getCellOf(e.ownerBase);if(!sf.base.isNullOrUndefined(n)){var o=!1;n.columnIndex+n.cellFormat.columnSpan!==n.ownerTable.tableHolder.columns.length&&n.cellIndex!==n.ownerRow.childWidgets.length-1||(o=!0),(sf.base.isNullOrUndefined(e)||"None"!==e.lineStyle||e.isBorderDefined&&0!==e.lineWidth)&&!sf.base.isNullOrUndefined(e)||(o?(e=i.right,(!sf.base.isNullOrUndefined(e)&&"None"===e.lineStyle||sf.base.isNullOrUndefined(e))&&(e=r.right)):(e=i.vertical,(!sf.base.isNullOrUndefined(e)&&"None"===e.lineStyle||sf.base.isNullOrUndefined(e))&&(e=r.vertical)))}return e},t.getCellTopBorder=function(e){var t=void 0,i=e.cellFormat.borders,r=sf.base.isNullOrUndefined(e.ownerRow)?void 0:e.ownerRow.rowFormat.borders,n=sf.base.isNullOrUndefined(e.ownerTable)?void 0:e.ownerTable.tableFormat.borders;if(sf.base.isNullOrUndefined(i.top)||(t=i.top),sf.base.isNullOrUndefined(t)&&(t=e.getTopBorderToRenderByHierarchy(t,r,n)),e.ownerTable.tableFormat.cellSpacing>0)t=e.getTopBorderToRenderByHierarchy(t,r,n);else{var o=e.getTopAdjacentCell();t=e.getPreviousCellTopBorder(t,o)}return sf.base.isNullOrUndefined(t)&&(t=new p(e.cellFormat.borders)),t},t.prototype.getTopAdjacentCell=function(){var e,t=this.ownerRow.previousWidget;return sf.base.isNullOrUndefined(t)||(e=t.getVerticalMergeStartCell(this.columnIndex,this.cellFormat.columnSpan)),e},t.prototype.getPreviousCellTopBorder=function(e,t){if((sf.base.isNullOrUndefined(t)||!sf.base.isNullOrUndefined(e)&&"None"===e.lineStyle&&!e.hasNoneStyle)&&(sf.base.isNullOrUndefined(e)||e.ownerBase.ownerBase instanceof vt||(e=this.getTopBorderToRenderByHierarchy(e,ce.getRowOf(e.ownerBase).rowFormat.borders,de.getTableOf(e.ownerBase).tableFormat.borders))),sf.base.isNullOrUndefined(t))return e;var i=void 0;return sf.base.isNullOrUndefined(t.cellFormat.borders)||sf.base.isNullOrUndefined(t.cellFormat.borders.bottom)||(i=this.getBottomBorderToRenderByHierarchy(t.cellFormat.borders.bottom,t.ownerRow.rowFormat.borders,t.ownerTable.tableFormat.borders)),sf.base.isNullOrUndefined(i)||"None"===i.lineStyle?sf.base.isNullOrUndefined(e)||e.ownerBase.ownerBase instanceof vt?e:this.getTopBorderToRenderByHierarchy(e,ce.getRowOf(e.ownerBase).rowFormat.borders,de.getTableOf(e.ownerBase).tableFormat.borders):this.getBorderBasedOnPriority(e,i)},t.prototype.getTopBorderToRenderByHierarchy=function(e,i,r){var n=t.getCellOf(e.ownerBase);if(!sf.base.isNullOrUndefined(n)){var o=sf.base.isNullOrUndefined(n.ownerRow.previousWidget);(sf.base.isNullOrUndefined(e)||"None"!==e.lineStyle||e.isBorderDefined&&0!==e.lineWidth)&&!sf.base.isNullOrUndefined(e)||(o?(e=i.top,(!sf.base.isNullOrUndefined(e)&&"None"===e.lineStyle||sf.base.isNullOrUndefined(e))&&(e=r.top)):(e=i.horizontal,(!sf.base.isNullOrUndefined(e)&&"None"===e.lineStyle||sf.base.isNullOrUndefined(e))&&(e=r.horizontal)))}return e},t.getCellBottomBorder=function(e){var t=void 0,i=e.cellFormat.borders,r=sf.base.isNullOrUndefined(e.ownerRow)?void 0:e.ownerRow.rowFormat.borders,n=sf.base.isNullOrUndefined(e.ownerTable)?void 0:e.ownerTable.tableFormat.borders;if(sf.base.isNullOrUndefined(i.bottom)||(t=i.bottom),sf.base.isNullOrUndefined(t)&&(t=e.getBottomBorderToRenderByHierarchy(t,r,n)),e.ownerTable.tableFormat.cellSpacing>0)t=e.getBottomBorderToRenderByHierarchy(t,r,n);else{var o=void 0,s=void 0,a=e.cellFormat.rowSpan;if(1===a)s=e.ownerRow.nextWidget;else if(a>1){var l=e.containerWidget;do{if(l=l.nextWidget,sf.base.isNullOrUndefined(l))break;if(l.index===e.rowIndex+a){s=l;break}}while(l)}sf.base.isNullOrUndefined(s)||(o=s.getCellWidget(e.columnIndex,e.cellFormat.columnSpan)),t=e.getAdjacentCellBottomBorder(t,o)}return sf.base.isNullOrUndefined(t)&&(t=new p(e.cellFormat.borders)),t},t.prototype.getAdjacentCellBottomBorder=function(e,t){if((sf.base.isNullOrUndefined(t)||!sf.base.isNullOrUndefined(e)&&"None"===e.lineStyle&&!e.hasNoneStyle)&&(sf.base.isNullOrUndefined(e)||e.ownerBase.ownerBase instanceof vt||(e=this.getBottomBorderToRenderByHierarchy(e,ce.getRowOf(e.ownerBase).rowFormat.borders,de.getTableOf(e.ownerBase).tableFormat.borders))),sf.base.isNullOrUndefined(t))return e;var i=void 0;return sf.base.isNullOrUndefined(t.cellFormat.borders)||sf.base.isNullOrUndefined(t.cellFormat.borders.top)||"None"===t.cellFormat.borders.top.lineStyle||(i=t.cellFormat.borders.top),sf.base.isNullOrUndefined(i)||"None"===i.lineStyle?sf.base.isNullOrUndefined(e)||e.ownerBase.ownerBase instanceof vt?e:this.getBottomBorderToRenderByHierarchy(e,ce.getRowOf(e.ownerBase).rowFormat.borders,de.getTableOf(e.ownerBase).tableFormat.borders):this.getBorderBasedOnPriority(e,i)},t.prototype.getBottomBorderToRenderByHierarchy=function(e,i,r){var n=t.getCellOf(e.ownerBase);if(!sf.base.isNullOrUndefined(n)){var o=sf.base.isNullOrUndefined(n.ownerRow.nextWidget);(sf.base.isNullOrUndefined(e)||"None"!==e.lineStyle||e.isBorderDefined&&0!==e.lineWidth)&&!sf.base.isNullOrUndefined(e)||(o?(e=i.bottom,(!sf.base.isNullOrUndefined(e)&&"None"===e.lineStyle||sf.base.isNullOrUndefined(e))&&(e=r.bottom)):(e=i.horizontal,(!sf.base.isNullOrUndefined(e)&&"None"===e.lineStyle||sf.base.isNullOrUndefined(e))&&(e=r.horizontal)))}return e},t.getCellOf=function(e){if(e instanceof u)return e.ownerBase instanceof bt&&e.ownerBase.ownerBase instanceof t?e.ownerBase.ownerBase:void 0},t.prototype.updateWidgetLeft=function(e){this.x=e,this.updateChildWidgetLeft(e)},t.prototype.updateChildWidgetLeft=function(e){for(var t=0;t<this.childWidgets.length;t++)if(this.childWidgets[t].x=e,this.childWidgets[t]instanceof de){var i=this.childWidgets[t];if(i.updateChildWidgetLeft(e),i.isBidiTable){var r=new $(i.x,i.y,i.width,i.height);i.shiftWidgetsForRtlTable(r,i)}}},t.prototype.getMinimumAndMaximumWordWidth=function(e,t){for(var i=0;i<this.childWidgets.length;i++){var r=this.childWidgets[i].getMinimumAndMaximumWordWidth(e,t);e=r.minimumWordWidth,t=r.maximumWordWidth}return{minimumWordWidth:e,maximumWordWidth:t}},t.prototype.destroyInternal=function(e){if(!sf.base.isNullOrUndefined(this.childWidgets)){for(var t=0;t<this.childWidgets.length;t++){var i=this.childWidgets[t];i.destroyInternal(e),t--}this.childWidgets=void 0}this.destroy()},t.prototype.clone=function(){var e=new t;e.cellFormat.copyFormat(this.cellFormat);for(var i=0;i<this.childWidgets.length;i++){var r=this.childWidgets[i].clone();e.childWidgets.push(r),r.containerWidget=e,r.index=i}return e.leftBorderWidth=this.leftBorderWidth,e.rightBorderWidth=this.rightBorderWidth,this.margin&&(e.margin=this.margin.clone()),e.columnIndex=this.columnIndex,e.x=this.x,e.y=this.y,e.height=this.height,e.width=this.width,this.contentControlProperties&&(e.contentControlProperties=this.contentControlProperties),e},t.prototype.destroy=function(){this.cellFormat=void 0,this.rowIndex=void 0,this.columnIndex=void 0,e.prototype.destroy.call(this)},t}(se),ue=function(){function e(e){this.children=[],this.x=0,this.y=0,this.width=0,this.height=0,this.marginTop=0,this.maxBaseLine=0,this.paragraph=e}return Object.defineProperty(e.prototype,"renderedElements",{get:function(){return sf.base.isNullOrUndefined(this.layoutedElements)?this.children:this.layoutedElements},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"indexInOwner",{get:function(){return this.paragraph&&this.paragraph.childWidgets?this.paragraph.childWidgets.indexOf(this):-1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nextLine",{get:function(){var t=this.paragraph,i=this.indexInOwner;if(i<=t.childWidgets.length-2)return t.childWidgets[i+1];if(t.nextSplitWidget){var r=t.nextSplitWidget.firstChild;if(r instanceof e&&r.paragraph.equals(this.paragraph))return r}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"previousLine",{get:function(){var t=this.paragraph,i=this.indexInOwner,r=t.previousSplitWidget;if(i>0)return t.childWidgets[i-1];if(r instanceof le){var n=r.lastChild;if(n instanceof e&&n.paragraph.equals(this.paragraph))return n}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isEndsWithPageBreak",{get:function(){if(this.children.length>0){var e=this.children[this.children.length-1];if(e instanceof we)return e.isPageBreak}return!1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isEndsWithColumnBreak",{get:function(){if(this.children.length>0){var e=this.children[this.children.length-1];if(e instanceof we)return e.isColumnBreak}return!1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isEndsWithLineBreak",{get:function(){if(this.children.length>0){var e=this.children[this.children.length-1];if(e instanceof we)return"\v"===e.text}return!1},enumerable:!0,configurable:!0}),e.prototype.isFirstLine=function(){var e=this.indexInOwner;return!!(e>-1&&(void 0===this.paragraph.previousSplitWidget||this.paragraph.previousSplitWidget instanceof le&&(this.paragraph.previousSplitWidget.isEndsWithColumnBreak||this.paragraph.previousSplitWidget.isEndsWithPageBreak)))&&0===e},e.prototype.isLastLine=function(){var e=this.indexInOwner;return e>-1&&void 0===this.paragraph.nextSplitWidget&&e===this.paragraph.childWidgets.length-1},e.prototype.getOffset=function(e,t){if(sf.base.isNullOrUndefined(e))return t;for(var i=t,r=e.line,n=0;n<r.children.length;n++){var o=r.children[n];if(e===o)break;o instanceof je||(i+=o.length)}return i},e.prototype.getEndOffset=function(){for(var e=0,t=0,i=0;i<this.children.length;i++){var r=this.children[i];0!==r.length&&(r instanceof je||((r instanceof we||r instanceof nt||r instanceof He||r instanceof Re||r instanceof Ue||r instanceof Ce||r instanceof Oe||r instanceof fe&&x.isLinkedFieldCharacter(r))&&(e=t+r.length),t+=r.length))}return e},e.prototype.getInline=function(e,t,i,r){i=sf.base.isNullOrUndefined(i)?this.paragraph.bidi:i;var n=void 0,o=0,s=!1;if(0===this.children.length&&this.previousLine){var a=this.previousLine.children[this.previousLine.children.length-1];if(a instanceof we&&"\v"===a.text)return{element:n=this.previousLine.children[this.previousLine.children.length-1],index:t=1}}for(var l=0;l<this.children.length;l++)if(!((n=this.children[l])instanceof je)){if(!s&&(n instanceof we||n instanceof Re||n instanceof Ee||n instanceof Oe||n instanceof Ce||n instanceof Ue||n instanceof He||n instanceof nt||n instanceof fe&&x.isLinkedFieldCharacter(n))&&(s=!0),s&&e<=o+n.length){if(n instanceof we&&" "===n.text&&0===n.revisions.length&&r){var h=this.getNextTextElement(this,l+1);return{element:n=sf.base.isNullOrUndefined(h)?n:h,index:t=sf.base.isNullOrUndefined(h)?e-o:0}}return e===o+n.length&&this.children[l+1]instanceof Me?{element:this.children[l+1],index:t}:{element:n,index:t=e-o}}o+=n.length}return e>o&&(t=sf.base.isNullOrUndefined(n)?e:n.length),{element:n,index:t}},e.prototype.getNextTextElement=function(e,t){return t<e.children.length-1&&e.children[t]?e.children[t]:null},e.prototype.getHierarchicalIndex=function(e){return e=this.paragraph.childWidgets.indexOf(this)+";"+e,this.paragraph instanceof se?this.paragraph.getHierarchicalIndex(e):e},e.prototype.clone=function(){for(var t=new e(void 0),i=0;i<this.children.length;i++){var r=this.children[i].clone();t.children.push(r),r.line=t}return t.width=this.width,t.height=this.height,sf.base.isNullOrUndefined(this.margin)||(t.margin=this.margin.clone()),t},e.prototype.destroy=function(){if(!sf.base.isNullOrUndefined(this.children)){for(var e=0;e<this.children.length;e++)this.children[e].destroy();this.children=[]}this.children=void 0,this.paragraph&&this.paragraph.removeChild(this.indexInOwner),this.paragraph=void 0,this.x=void 0,this.y=void 0,this.width=void 0,this.height=void 0},e}(),ge=function(){function e(){this.x=0,this.y=0,this.width=0,this.height=0,this.margin=new te(0,0,0,0),this.padding=new te(0,0,0,0),this.characterFormat=void 0,this.isRightToLeft=!1,this.canTrigger=!1,this.ischangeDetected=!1,this.isVisible=!1,this.isSpellChecked=!1,this.revisions=[],this.canTrack=!1,this.removedIds=[],this.isMarkedForRevision=!1,this.characterRange=void 0,this.characterFormat=new P(this),this.margin=new te(0,0,0,0)}return Object.defineProperty(e.prototype,"isPageBreak",{get:function(){return this instanceof we&&"\f"===this.text},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isColumnBreak",{get:function(){return this instanceof we&&this.text===String.fromCharCode(14)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isValidNodeForTracking",{get:function(){return!(this instanceof Ce||this instanceof nt||this instanceof He||this instanceof Ue||this instanceof Oe)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isCheckBoxElement",{get:function(){return this instanceof we&&!sf.base.isNullOrUndefined(this.text)&&(this.text===String.fromCharCode(9745)||this.text===String.fromCharCode(9744))},enumerable:!0,configurable:!0}),e.prototype.linkFieldCharacter=function(e){if(this instanceof fe)if(0===this.fieldType){sf.base.isNullOrUndefined(this.fieldEnd)&&(this.linkFieldTraversingForward(this.line,this,this),-1===e.fields.indexOf(this)&&e.fields.push(this),sf.base.isNullOrUndefined(this.formFieldData)||-1!==e.formFields.indexOf(this)||e.formFields.push(this))}else if(2===this.fieldType){if(sf.base.isNullOrUndefined(this.fieldBegin)&&this.linkFieldTraversingBackwardSeparator(this.line,this,this),!sf.base.isNullOrUndefined(this.fieldBegin)){this.fieldBegin.fieldSeparator=this;var t=this.linkFieldTraversingForward(this.line,this.fieldBegin,this);sf.base.isNullOrUndefined(this.fieldEnd)&&t&&(this.fieldEnd=this.fieldBegin.fieldEnd),this.fieldEnd&&(this.fieldEnd.fieldSeparator=this)}}else{sf.base.isNullOrUndefined(this.fieldBegin)&&this.linkFieldTraversingBackward(this.line,this,this)}},e.prototype.linkFieldTraversingBackward=function(e,t,i){var r=e.children.length-1;e.children.indexOf(i)>-1&&(r=e.children.indexOf(i)-1);for(var n=r;n>=0;n--){var o=e.children[n];if(o instanceof fe)if(0===o.fieldType){if(sf.base.isNullOrUndefined(o.fieldEnd))return t.fieldBegin=o,sf.base.isNullOrUndefined(o.fieldEnd)&&(o.fieldEnd=t),t.fieldSeparator&&sf.base.isNullOrUndefined(t.fieldSeparator.fieldBegin)&&(t.fieldSeparator.fieldBegin=o,sf.base.isNullOrUndefined(o.fieldSeparator)&&(o.fieldSeparator=t.fieldSeparator)),!sf.base.isNullOrUndefined(t.fieldBegin)}else 2===o.fieldType&&sf.base.isNullOrUndefined(o.fieldEnd)&&(t.fieldSeparator=o,o.fieldEnd=t,sf.base.isNullOrUndefined(o.fieldBegin)||(t.fieldBegin=o.fieldBegin))}if(e.previousLine)this.linkFieldTraversingBackward(e.previousLine,t,this);else if(e.paragraph.previousRenderedWidget instanceof le&&e.paragraph.previousRenderedWidget.childWidgets.length>0){var s=e.paragraph.previousRenderedWidget;this.linkFieldTraversingBackward(s.childWidgets[s.childWidgets.length-1],t,this)}return!0},e.prototype.linkFieldTraversingForward=function(e,t,i){var r=0;e.children.indexOf(i)>-1&&(r=e.children.indexOf(i)+1);for(var n=r;n<e.children.length;n++){var o=e.children[n];if(o instanceof fe){if(1===o.fieldType)return sf.base.isNullOrUndefined(o.fieldBegin)&&(t.fieldEnd=o),t.fieldEnd&&sf.base.isNullOrUndefined(t.fieldEnd.fieldBegin)&&(t.fieldEnd.fieldBegin=t),!0;if(sf.base.isNullOrUndefined(t.fieldSeparator)){if(2!==o.fieldType||!sf.base.isNullOrUndefined(o.fieldBegin))return!1;if(t.fieldSeparator=o,t.fieldSeparator&&sf.base.isNullOrUndefined(t.fieldSeparator.fieldBegin)&&(t.fieldSeparator.fieldBegin=t),!sf.base.isNullOrUndefined(o.fieldEnd))return t.fieldEnd=o.fieldEnd,t.fieldSeparator.fieldEnd=t.fieldEnd,!0}}}return e.nextLine?this.linkFieldTraversingForward(e.nextLine,t,this):e.paragraph.nextRenderedWidget instanceof le&&e.paragraph.nextRenderedWidget.childWidgets.length>0&&this.linkFieldTraversingForward(e.paragraph.nextRenderedWidget.childWidgets[0],t,this),!0},e.prototype.linkFieldTraversingBackwardSeparator=function(e,t,i){var r=e.children.length-1;e.children.indexOf(i)>-1&&(r=e.children.indexOf(i)-1);for(var n=r;n>=0;n--){var o=e.children[n];if(o instanceof fe&&o instanceof fe&&0===o.fieldType)return sf.base.isNullOrUndefined(o.fieldSeparator)&&(t.fieldBegin=o),!sf.base.isNullOrUndefined(t.fieldBegin)}if(e.previousLine)this.linkFieldTraversingBackwardSeparator(e.previousLine,t,this);else{if(!(e.paragraph.previousRenderedWidget instanceof le&&e.paragraph.previousRenderedWidget.childWidgets.length>0))return!0;e=e.paragraph.previousRenderedWidget.childWidgets[e.paragraph.previousRenderedWidget.childWidgets.length-1],this.linkFieldTraversingBackwardSeparator(e,t,this)}return!0},Object.defineProperty(e.prototype,"length",{get:function(){return this.getLength()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"indexInOwner",{get:function(){return this.line instanceof ue&&this.line.children?this.line.children.indexOf(this):-1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"previousElement",{get:function(){var e=this.indexInOwner;if(e>0&&e<this.line.children.length)return this.line.children[e-1]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nextElement",{get:function(){var e=this.indexInOwner;if(e>-1&&e<this.line.children.length-1)return this.line.children[e+1]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nextNode",{get:function(){var e=this.line.children.indexOf(this),t=this.line.paragraph.childWidgets.indexOf(this.line);return e<this.line.children.length-1?this.line.children[e+1]:t<this.line.paragraph.childWidgets.length-1?this.line.paragraph.childWidgets[t+1].children[0]:void 0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nextValidNodeForTracking",{get:function(){for(var e=this;!sf.base.isNullOrUndefined(e)&&(e instanceof Ce||e instanceof nt||e instanceof He||e instanceof Ue||e instanceof Oe);)e=e.nextNode;return e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"previousValidNodeForTracking",{get:function(){for(var e=this;!sf.base.isNullOrUndefined(e)&&(e instanceof Ce||e instanceof nt||e instanceof He||e instanceof Ue||e instanceof Oe);)e=e.previousNode;return e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"previousNode",{get:function(){var e=this.line.children.indexOf(this),t=this.line.paragraph.childWidgets.indexOf(this.line);if(e>0)return this.line.children[e-1];if(t>0){var i=this.line.paragraph.childWidgets[t-1];return i.children[i.children.length-1]}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"paragraph",{get:function(){if(this.line)return this.line.paragraph},enumerable:!0,configurable:!0}),e.prototype.destroy=function(){if(!sf.base.isNullOrUndefined(this.line)&&this.line.children&&this.line.children.indexOf(this)>-1){var e=this.line.children.indexOf(this);this.line.children.splice(e,1)}this.line=void 0,this.characterFormat&&this.characterFormat.destroy(),this.characterFormat=void 0,this.margin&&this.margin.destroy(),this.margin=void 0,this.x=void 0,this.y=void 0,this.width=void 0,this.height=void 0},e.objectCharacter=String.fromCharCode(65532),e}(),fe=function(e){function t(t){var i=e.call(this)||this;return i.fieldType=0,i.fieldCodeType="",i.hasFieldEnd=!1,i.fieldBeginInternal=void 0,i.fieldSeparatorInternal=void 0,i.fieldEndInternal=void 0,i.fieldType=t,i}return J(t,e),Object.defineProperty(t.prototype,"fieldBegin",{get:function(){return this.fieldBeginInternal},set:function(e){this.fieldBeginInternal=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fieldSeparator",{get:function(){return this.fieldSeparatorInternal},set:function(e){this.fieldSeparatorInternal=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fieldEnd",{get:function(){return this.fieldEndInternal},set:function(e){this.fieldEndInternal=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"resultText",{get:function(){if(!sf.base.isNullOrUndefined(this.formFieldData)&&0===this.fieldType&&!sf.base.isNullOrUndefined(this.fieldSeparator)&&!sf.base.isNullOrUndefined(this.fieldEnd)){var e=this.fieldSeparator.nextElement,t="";do{if(e instanceof we&&(t+=e.text),(e=e.nextNode)===this.fieldEnd)break}while(e);return t}},enumerable:!0,configurable:!0}),t.prototype.getLength=function(){return 1},t.prototype.clone=function(){var e=new t(this.fieldType);if(0!==this.fieldType||sf.base.isNullOrUndefined(this.formFieldData)||(e.formFieldData=this.formFieldData.clone()),e.characterFormat.copyFormat(this.characterFormat),this.margin&&(e.margin=this.margin.clone()),e.width=this.width,e.height=this.height,!sf.base.isNullOrUndefined(this.paragraph)&&this.paragraph.isInHeaderFooter){if(this.revisions.length>0)for(var i=0;i<this.revisions.length;i++){var r=this.revisions[i];e.revisions.push(r.clone())}}else this.revisions.length>0?e.removedIds=O.cloneRevisions(this.revisions):e.removedIds=this.removedIds.slice();return e.fieldCodeType=this.fieldCodeType,e},t.prototype.destroy=function(){this.fieldType=void 0,this.hasFieldEnd=void 0,this.fieldBeginInternal=void 0,this.fieldEndInternal=void 0,this.fieldSeparatorInternal=void 0,e.prototype.destroy.call(this)},t}(ge),me=function(){this.name="",this.enabled=!0,this.helpText="",this.statusText=""},ye=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type="Text",t.maxLength=0,t.defaultValue="",t.format="",t}return J(t,e),t.prototype.clone=function(){var e=new t;return e.type=this.type,e.name=this.name,e.enabled=this.enabled,e.helpText=this.helpText,e.statusText=this.statusText,e.maxLength=this.maxLength,e.defaultValue=this.defaultValue,e.format=this.format,e},t.prototype.getFormFieldInfo=function(){return{defaultValue:this.defaultValue,enabled:this.enabled,format:this.format,helpText:this.helpText,maxLength:this.maxLength,type:this.type,name:this.name}},t.prototype.copyFieldInfo=function(e){sf.base.isNullOrUndefined(e.defaultValue)||(this.defaultValue=e.defaultValue),sf.base.isNullOrUndefined(e.enabled)||(this.enabled=e.enabled),sf.base.isNullOrUndefined(e.format)||(this.format=e.format),sf.base.isNullOrUndefined(e.helpText)||(this.helpText=e.helpText),sf.base.isNullOrUndefined(e.maxLength)||(this.maxLength=e.maxLength),sf.base.isNullOrUndefined(e.type)||(this.type=e.type)},t}(me),ve=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.sizeType="Auto",t.size=11,t.defaultValue=!1,t.checked=!1,t}return J(t,e),t.prototype.clone=function(){var e=new t;return e.name=this.name,e.enabled=this.enabled,e.helpText=this.helpText,e.statusText=this.statusText,e.sizeType=this.sizeType,e.size=this.size,e.defaultValue=this.defaultValue,e.checked=this.checked,e},t.prototype.getFormFieldInfo=function(){return{defaultValue:this.defaultValue,enabled:this.enabled,helpText:this.helpText,size:this.size,sizeType:this.sizeType,name:this.name}},t.prototype.copyFieldInfo=function(e){sf.base.isNullOrUndefined(e.defaultValue)||(this.defaultValue=e.defaultValue,this.checked=e.defaultValue),sf.base.isNullOrUndefined(e.enabled)||(this.enabled=e.enabled),sf.base.isNullOrUndefined(e.size)||(this.size=e.size),sf.base.isNullOrUndefined(e.helpText)||(this.helpText=e.helpText),sf.base.isNullOrUndefined(e.sizeType)||(this.sizeType=e.sizeType)},t}(me),be=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.dropdownItems=[],t.selectedIndex=0,t}return J(t,e),t.prototype.clone=function(){var e=new t;return e.name=this.name,e.enabled=this.enabled,e.helpText=this.helpText,e.statusText=this.statusText,e.dropdownItems=this.dropdownItems.slice(),e.selectedIndex=this.selectedIndex,e},t.prototype.getFormFieldInfo=function(){return{dropdownItems:this.dropdownItems.slice(),enabled:this.enabled,helpText:this.helpText,name:this.name}},t.prototype.copyFieldInfo=function(e){sf.base.isNullOrUndefined(e.dropdownItems)||(this.dropdownItems=e.dropdownItems),sf.base.isNullOrUndefined(e.enabled)||(this.enabled=e.enabled),sf.base.isNullOrUndefined(e.helpText)||(this.helpText=e.helpText)},t}(me),we=function(e){function i(){var i=e.call(this)||this;return i.baselineOffset=0,i.text="",i.trimEndWidth=0,i.ignoreOnceItems=[],i.istextCombined=!1,i.scriptType=t.English,i.renderedFontFamily=void 0,i.errorCollection=[],i}return J(i,e),i.prototype.getLength=function(){return this.text?this.text.length:0},i.prototype.clone=function(){var e=new i;if(e.characterFormat.copyFormat(this.characterFormat),e.text=this.text,this.margin&&(e.margin=this.margin.clone()),e.baselineOffset=this.baselineOffset,!sf.base.isNullOrUndefined(this.paragraph)&&this.paragraph.isInHeaderFooter){if(this.revisions.length>0)for(var t=0;t<this.revisions.length;t++){var r=this.revisions[t];e.revisions.push(r.clone())}}else this.revisions.length>0?e.removedIds=O.cloneRevisions(this.revisions):e.removedIds=this.removedIds.slice();return e.width=this.width,e.height=this.height,this.contentControlProperties&&(e.contentControlProperties=this.contentControlProperties),e},i.prototype.destroy=function(){this.text=void 0,e.prototype.destroy.call(this)},i}(ge),xe=function(){function e(){this.separator=[],this.continuationNotice=[],this.continuationSeparator=[]}return e.prototype.clear=function(){this.separator=[],this.continuationSeparator=[],this.continuationNotice=[]},e.prototype.destroy=function(){this.separator=[],this.continuationSeparator=[],this.continuationNotice=[]},e}(),Me=function(e){function t(){var t=e.call(this)||this;return t.isLayout=!1,t.bodyWidget=new ne,t.bodyWidget.footNoteReference=t,t}return J(t,e),t.prototype.clone=function(){var e=new t;return e.text=this.text,e.characterFormat.copyFormat(this.characterFormat),e.height=this.height,e.footnoteType=this.footnoteType,e.width=this.width,e.symbolCode=this.symbolCode,e.bodyWidget.childWidgets=this.bodyWidget.childWidgets,e.bodyWidget.page=this.bodyWidget.page,this.margin&&(e.margin=this.margin.clone()),e},t.prototype.getLength=function(){return 1},t.prototype.destroy=function(){this.symbolCode="",this.symbolFontName="",this.customMarker="",this.bodyWidget=void 0},t}(we),Ne=function(e){function t(){var t=e.call(this)||this;return t.startIn=void 0,t.endIn=void 0,t}return J(t,e),Object.defineProperty(t.prototype,"start",{get:function(){return this.startIn},set:function(e){this.startIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"end",{get:function(){return this.endIn},set:function(e){this.endIn=e},enumerable:!0,configurable:!0}),t.prototype.destroy=function(){this.start=void 0,this.end=void 0},t}(we),Ie=function(e){function t(){var t=e.call(this)||this;return t.fieldText="",t}return J(t,e),Object.defineProperty(t.prototype,"text",{get:function(){return this.fieldText},set:function(e){this.fieldText=e},enumerable:!0,configurable:!0}),t.prototype.clone=function(){var e=new t;if(e.characterFormat.copyFormat(this.characterFormat),e.fieldBegin=this.fieldBegin,e.text=this.text,this.margin&&(e.margin=this.margin.clone()),!sf.base.isNullOrUndefined(this.paragraph)&&this.paragraph.isInHeaderFooter){if(this.revisions.length>0)for(var i=0;i<this.revisions.length;i++){var r=this.revisions[i];e.revisions.push(r.clone())}}else this.revisions.length>0?e.removedIds=O.cloneRevisions(this.revisions):e.removedIds=this.removedIds.slice();return e.width=this.width,e.height=this.height,e},t}(we),Se=function(e){function t(){var t=e.call(this)||this;return t.tabText="",t.tabLeader="None",t}return J(t,e),t.prototype.destroy=function(){this.tabText=void 0,this.tabLeader=void 0},t.prototype.clone=function(){var e=new t;if(e.characterFormat.copyFormat(this.characterFormat),e.tabText=this.tabText,e.tabLeader=this.tabLeader,e.text=this.text,this.margin&&(e.margin=this.margin.clone()),e.width=this.width,e.height=this.height,!sf.base.isNullOrUndefined(this.paragraph)&&this.paragraph.isInHeaderFooter){if(this.revisions.length>0)for(var i=0;i<this.revisions.length;i++){var r=this.revisions[i];e.revisions.push(r.clone())}}else this.revisions.length>0?e.removedIds=O.cloneRevisions(this.revisions):e.removedIds=this.removedIds.slice();return e},t}(we),Ce=function(e){function t(t){var i=e.call(this)||this;return i.bookmarkTypeIn=0,i.refereneceIn=void 0,i.nameIn="",i.bookmarkTypeIn=t,i}return J(t,e),Object.defineProperty(t.prototype,"bookmarkType",{get:function(){return this.bookmarkTypeIn},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return this.nameIn},set:function(e){this.nameIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"reference",{get:function(){return this.refereneceIn},set:function(e){this.refereneceIn=e},enumerable:!0,configurable:!0}),t.prototype.getLength=function(){return 1},t.prototype.destroy=function(){this.name=void 0,this.reference=void 0,this.bookmarkTypeIn=void 0},t.prototype.clone=function(){var e=new t(this.bookmarkType);return e.name=this.name,e.reference=this.reference,this.margin&&(e.margin=this.margin.clone()),this.revisions.length>0?e.removedIds=O.cloneRevisions(this.revisions):e.removedIds=this.removedIds.slice(),e.width=this.width,e.height=this.height,this.contentControlProperties&&(e.contentControlProperties=this.contentControlProperties),e},t}(ge),Oe=function(e){function t(t){var i=e.call(this)||this;return i.contentControlWidgetType=t,i.contentControlProperties=new Te(t),i}return J(t,e),t.prototype.getLength=function(){return 1},t.prototype.clone=function(){var e=new t(this.contentControlWidgetType);if(e.characterFormat.copyFormat(this.characterFormat),e.contentControlProperties=this.contentControlProperties,e.contentControlWidgetType=this.contentControlWidgetType,this.margin&&(e.margin=this.margin.clone()),!sf.base.isNullOrUndefined(this.paragraph)&&this.paragraph.isInHeaderFooter){if(this.revisions.length>0)for(var i=0;i<this.revisions.length;i++){var r=this.revisions[i];e.revisions.push(r.clone())}}else this.revisions.length>0?e.removedIds=O.cloneRevisions(this.revisions):e.removedIds=this.removedIds.slice();return e.type=this.type,e.width=this.width,e.height=this.height,e.reference=this.reference,e},t.prototype.destroy=function(){this.contentControlProperties=void 0,this.contentControlWidgetType=void 0,e.prototype.destroy.call(this)},t}(ge),Te=function(){function e(e){this.contentControlListItems=[],this.contentControlWidgetType=e,this.characterFormat=new P}return e.prototype.destroy=function(){this.lockContentControl=void 0,this.lockContents=void 0,this.tag=void 0,this.color=void 0,this.title=void 0,this.appearance=void 0,this.type=void 0,this.hasPlaceHolderText=void 0,this.multiline=void 0,this.isTemporary=void 0,this.isChecked=void 0,this.dateCalendarType=void 0,this.dateStorageFormat=void 0,this.dateDisplayLocale=void 0,this.dateDisplayFormat=void 0},e.prototype.clone=function(){var t=new e(this.contentControlWidgetType);if(t.lockContentControl=this.lockContentControl,t.lockContents=this.lockContents,t.tag=this.tag,t.color=this.color,t.title=this.title,t.appearance=this.appearance,t.type=this.type,t.hasPlaceHolderText=this.hasPlaceHolderText,t.multiline=this.multiline,t.isTemporary=this.isTemporary,t.isChecked=this.isChecked,t.dateCalendarType=this.dateCalendarType,t.dateStorageFormat=this.dateStorageFormat,t.dateDisplayLocale=this.dateDisplayLocale,t.dateDisplayFormat=this.dateDisplayFormat,this.contentControlListItems.length>0)for(var i=0;i<this.contentControlListItems.length;i++)t.contentControlListItems.push(this.contentControlListItems[i].clone());return this.checkedState&&(t.checkedState=this.checkedState.clone()),this.uncheckedState&&(t.uncheckedState=this.uncheckedState.clone()),this.xmlMapping&&(t.xmlMapping=this.xmlMapping.clone()),t},e}(),Pe=function(){function e(){}return e.prototype.destroy=function(){this.displayText=void 0,this.value=void 0},e.prototype.clone=function(){var t=new e;return t.displayText=this.displayText,t.value=this.value,t},e}(),Ae=function(){function e(){}return e.prototype.destroy=function(){this.font=void 0,this.value=void 0},e.prototype.clone=function(){var t=new e;return t.font=this.font,t.value=this.value,t},e}(),Le=function(){function e(){}return e.prototype.destroy=function(){this.isMapped=void 0,this.isWordMl=void 0,this.prefixMapping=void 0,this.xPath=void 0,this.storeItemId=void 0,this.customXmlPart=void 0},e.prototype.clone=function(){var t=new e;return t.isMapped=this.isMapped,t.isWordMl=this.isWordMl,t.prefixMapping=this.prefixMapping,t.xPath=this.xPath,t.storeItemId=this.storeItemId,this.customXmlPart&&(t.customXmlPart=this.customXmlPart.clone()),t},e}(),Fe=function(){function e(){}return e.prototype.destroy=function(){this.id=void 0,this.xml=void 0},e.prototype.clone=function(){var t=new e;return t.id=this.id,t.xml=this.xml,t},e}(),De=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.verticalPosition=0,t.horizontalPosition=0,t.textWrappingStyle="Inline",t.distanceBottom=0,t.distanceLeft=0,t.distanceRight=0,t.distanceTop=0,t}return J(t,e),t}(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.name="",t.alternativeText="",t.title="",t}return J(t,e),t.prototype.getLength=function(){return 1},t.prototype.clone=function(){return new Ee},t}(ge)),Ee=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return J(t,e),t.prototype.clone=function(){var e=new t;if(e.characterFormat.copyFormat(this.characterFormat),e.x=this.x,e.y=this.y,e.width=this.width,e.height=this.height,e.shapeId=this.shapeId,e.name=this.name,e.alternativeText=this.alternativeText,e.title=this.title,e.widthScale=this.widthScale,e.heightScale=this.heightScale,e.visible=this.visible,e.verticalPosition=this.verticalPosition,e.verticalAlignment=this.verticalAlignment,e.verticalOrigin=this.verticalOrigin,e.verticalRelativePercent=this.verticalRelativePercent,e.horizontalPosition=this.horizontalPosition,e.horizontalAlignment=this.horizontalAlignment,e.horizontalRelativePercent=this.horizontalRelativePercent,e.horizontalOrigin=this.horizontalOrigin,e.zOrderPosition=this.zOrderPosition,e.allowOverlap=this.allowOverlap,e.textWrappingStyle=this.textWrappingStyle,e.textWrappingType=this.textWrappingType,e.distanceBottom=this.distanceBottom,e.distanceLeft=this.distanceLeft,e.distanceRight=this.distanceRight,e.distanceTop=this.distanceTop,e.layoutInCell=this.layoutInCell,e.lockAnchor=this.lockAnchor,e.autoShapeType=this.autoShapeType,this.lineFormat&&(e.lineFormat=this.lineFormat.clone()),this.fillFormat&&(e.fillFormat=this.fillFormat.clone()),this.textFrame&&(e.textFrame=this.textFrame.clone(),e.textFrame.containerShape=e),this.margin&&(e.margin=this.margin.clone()),!sf.base.isNullOrUndefined(this.paragraph)&&this.paragraph.isInHeaderFooter){if(this.revisions.length>0)for(var i=0;i<this.revisions.length;i++){var r=this.revisions[i];e.revisions.push(r.clone())}}else this.revisions.length>0?e.removedIds=O.cloneRevisions(this.revisions):e.removedIds=this.removedIds.slice();return e},t}(De),ze=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.marginLeft=0,t.marginRight=0,t.marginTop=0,t.marginBottom=0,t}return J(t,e),t.prototype.equals=function(){return!1},t.prototype.destroyInternal=function(){},t.prototype.getHierarchicalIndex=function(e){var t=this.containerShape.line,i=t.getOffset(this.containerShape,0).toString();return t.getHierarchicalIndex(i)},t.prototype.getTableCellWidget=function(){},t.prototype.clone=function(){var e=new t;e.textVerticalAlignment=this.textVerticalAlignment,e.marginBottom=this.marginBottom,e.marginLeft=this.marginLeft,e.marginRight=this.marginRight,e.marginTop=this.marginTop;for(var i=0;i<this.childWidgets.length;i++){var r=this.childWidgets[i].clone();e.childWidgets.push(r),r.index=i,r.containerWidget=e}return e},t}(ie),ke=function(){function e(){}return e.prototype.clone=function(){var t=new e;return t.lineFormatType=this.lineFormatType,t.color=this.color,t.weight=this.weight,t.dashStyle=this.dashStyle,t.line=this.line,t},e}(),We=function(){function e(){}return e.prototype.clone=function(){var t=new e;return t.color=this.color,t.fill=this.fill,t},e}(),Re=function(e){function t(t){var i=e.call(this)||this;return i.imageStr="",i.imgElement=void 0,i.isInlineImageIn=!0,i.crop=!1,i.left=0,i.top=0,i.right=0,i.bottom=0,i.isMetaFile=!1,i.isCompressed=!1,i.isInlineImageIn=t,i}return J(t,e),Object.defineProperty(t.prototype,"isCrop",{get:function(){return this.crop},set:function(e){if(this.crop=e,e){var t=0,i=0;0!==this.left?this.cropX=this.left*this.cropWidthScale/100:this.cropX=0,0!==this.top?this.cropY=this.top*this.cropHeightScale/100:this.cropY=0,0!==this.right&&(t=this.right*this.cropWidthScale/100),0!==this.bottom&&(i=this.bottom*this.cropHeightScale/100),this.cropWidth=this.cropWidthScale-(this.cropX+t),this.cropHeight=this.cropHeightScale-(this.cropY+i)}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isInlineImage",{get:function(){return this.isInlineImageIn},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"element",{get:function(){return sf.base.isNullOrUndefined(this.imgElement)&&(this.imgElement=document.createElement("img")),this.imgElement},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"length",{get:function(){return 1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"imageString",{get:function(){return this.imageStr},set:function(e){this.imageStr=e,sf.base.isNullOrUndefined(e)||(this.element.src=this.imageStr)},enumerable:!0,configurable:!0}),t.prototype.getLength=function(){return 1},t.prototype.clone=function(){var e=new t(this.isInlineImage);if(e.characterFormat.copyFormat(this.characterFormat),e.imageString=this.imageString,e.isMetaFile=this.isMetaFile,e.isCompressed=this.isCompressed,e.metaFileImageString=this.metaFileImageString,e.width=this.width,e.height=this.height,e.top=this.top,e.left=this.left,e.bottom=this.bottom,e.right=this.right,e.cropHeightScale=this.cropHeightScale,e.cropWidthScale=this.cropWidthScale,e.cropX=this.cropX,e.cropY=this.cropY,e.isCrop=this.isCrop,this.margin&&(e.margin=this.margin.clone()),!sf.base.isNullOrUndefined(this.paragraph)&&this.paragraph.isInHeaderFooter){if(this.revisions.length>0)for(var i=0;i<this.revisions.length;i++){var r=this.revisions[i];e.revisions.push(r.clone())}}else this.revisions.length>0?e.removedIds=O.cloneRevisions(this.revisions):e.removedIds=this.removedIds.slice();return e.name=this.name,e.alternativeText=this.alternativeText,e.title=this.title,e.visible=this.visible,e.widthScale=this.widthScale,e.heightScale=this.heightScale,e.verticalPosition=this.verticalPosition,e.verticalOrigin=this.verticalOrigin,e.verticalAlignment=this.verticalAlignment,e.horizontalPosition=this.horizontalPosition,e.horizontalOrigin=this.horizontalOrigin,e.horizontalAlignment=this.horizontalAlignment,e.allowOverlap=this.allowOverlap,e.textWrappingStyle=this.textWrappingStyle,e.textWrappingType=this.textWrappingType,e.layoutInCell=this.layoutInCell,e.zOrderPosition=this.zOrderPosition,e},t.prototype.destroy=function(){this.imgElement=void 0,this.imageString=void 0,this.isInlineImageIn=void 0,e.prototype.destroy.call(this)},t}(De),je=function(e){function t(t,i){var r=e.call(this)||this;return r.baselineOffset=0,r.trimEndWidth=0,r.isFollowCharacter=!1,r.listLevel=t,r.isFollowCharacter=i,r}return J(t,e),t.prototype.getLength=function(){return this.text?this.text.length:0},t.prototype.clone=function(){var e=new t(this.listLevel,this.isFollowCharacter);return e.text=this.text,e.baselineOffset=this.baselineOffset,this.margin&&(e.margin=this.margin.clone()),e.width=this.width,e.height=this.height,e},t.prototype.destroy=function(){this.text=void 0,e.prototype.destroy.call(this)},t}(ge),Ue=function(e){function t(){var t=e.call(this)||this;return t.editRangeStart=void 0,t.editRangeId=-1,t}return J(t,e),t.prototype.getLength=function(){return 1},t.prototype.destroy=function(){this.editRangeStart=void 0},t.prototype.clone=function(){var e=new t;return e.editRangeStart=this.editRangeStart,e.editRangeId=this.editRangeId,e},t}(ge),He=function(e){function t(){var t=e.call(this)||this;return t.columnFirst=-1,t.columnLast=-1,t.user="",t.group="",t.editRangeId=-1,t}return J(t,e),t.prototype.getLength=function(){return 1},t.prototype.renderLockMark=function(e,t){if(sf.base.isNullOrUndefined(this.editRangeMark)){var i=e===this.user?"you":this.user;this.editRangeMark=document.createElement("div"),this.editRangeMark.style.display="none",this.editRangeMark.classList.add("e-de-lock-mark");var r=document.createElement("span");r.className="e-icons e-de-ctnr-lock",this.editRangeMark.appendChild(r),this.editRangeMark.title=t.getConstant("This region is locked by")+" "+i}this.line&&sf.base.isNullOrUndefined(this.editRangeMark.parentElement)&&this.line.paragraph.bodyWidget.page.documentHelper.pageContainer.appendChild(this.editRangeMark)},t.prototype.removeEditRangeMark=function(){this.editRangeMark&&(this.editRangeMark.parentElement.removeChild(this.editRangeMark),this.editRangeMark=void 0)},t.prototype.destroy=function(){this.user=void 0,this.columnFirst=void 0,this.columnLast=void 0},t.prototype.clone=function(){var e=new t;return e.columnFirst=this.columnFirst,e.columnLast=this.columnLast,e.user=this.user,e.group=this.group,e.editRangeEnd=this.editRangeEnd,e.editRangeId=this.editRangeId,e},t}(ge),Be=function(e){function t(){var t=e.call(this)||this;return t.chartTitle="",t.chartType="",t.chartElement=void 0,t.chartCategory=[],t.chartSeries=[],t.chartArea=new _e,t.chartPlotArea=new _e,t.chartTitleArea=new Je,t.chartLegend=new Qe,t.chartPrimaryCategoryAxis=new it,t.chartPrimaryValueAxis=new it,t.chartDataTable=new rt,t}return J(t,e),t.prototype.getLength=function(){return 1},Object.defineProperty(t.prototype,"title",{get:function(){return this.chartTitle},set:function(e){this.chartTitle=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"type",{get:function(){return this.chartType},set:function(e){this.chartType=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"chartGapWidth",{get:function(){return this.gapWidth},set:function(e){this.gapWidth=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"chartOverlap",{get:function(){return this.overlap},set:function(e){this.overlap=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"targetElement",{get:function(){return sf.base.isNullOrUndefined(this.div)&&(this.div=sf.base.createElement("div")),this.div},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"officeChart",{get:function(){return this.officeChartInternal},set:function(e){e&&(this.officeChartInternal=e,this.officeChartInternal.chart.loaded=this.onChartLoaded.bind(this))},enumerable:!0,configurable:!0}),t.prototype.onChartLoaded=function(){var e=this;this.officeChart.convertChartToImage(this.officeChart.chart,this.width,this.height).then((function(t){e.imageString=t}))},t.prototype.clone=function(){var e=new t;e.chartTitle=this.chartTitle,e.chartType=this.chartType,e.height=this.height,e.width=this.width,e.gapWidth=this.gapWidth,e.overlap=this.overlap;for(var i=0;i<this.chartCategory.length;i++){var r=this.chartCategory[i].clone();e.chartCategory.push(r)}for(i=0;i<this.chartSeries.length;i++){var n=this.chartSeries[i].clone();e.chartSeries.push(n)}return e.chartArea=this.chartArea.clone(),e.chartPlotArea=this.chartPlotArea.clone(),e.chartLegend=this.chartLegend.clone(),e.chartTitleArea=this.chartTitleArea.clone(),e.chartPrimaryCategoryAxis=this.chartPrimaryCategoryAxis.clone(),e.chartPrimaryValueAxis=this.chartPrimaryValueAxis.clone(),e.chartDataTable=this.chartDataTable.clone(),e},t.prototype.destroy=function(){e.prototype.destroy.call(this),this.officeChartInternal&&(this.officeChartInternal.chart.loaded=void 0,this.officeChartInternal.destroy(),this.officeChartInternal=void 0),this.div&&(this.div=void 0),this.chartTitle=void 0,this.chartType=void 0,this.chartArea=void 0,this.chartPlotArea=void 0,this.chartCategory=[],this.chartSeries=[],this.chartTitleArea=void 0,this.chartLegend=void 0,this.chartPrimaryCategoryAxis=void 0,this.chartPrimaryValueAxis=void 0,this.chartDataTable=void 0,this.chartElement=void 0},t}(Re),_e=function(){function e(){}return Object.defineProperty(e.prototype,"chartForeColor",{get:function(){return this.foreColor},set:function(e){this.foreColor=e},enumerable:!0,configurable:!0}),e.prototype.clone=function(){var t=new e;return t.foreColor=this.foreColor,t},e.prototype.destroy=function(){this.foreColor=void 0},e}(),Ve=function(){function e(){this.categoryXName="",this.chartData=[]}return Object.defineProperty(e.prototype,"xName",{get:function(){return this.categoryXName},set:function(e){this.categoryXName=e},enumerable:!0,configurable:!0}),e.prototype.clone=function(){var t=new e;t.categoryXName=this.categoryXName;for(var i=0;i<this.chartData.length;i++){var r=this.chartData[i].clone();t.chartData.push(r)}return t},e.prototype.destroy=function(){this.categoryXName=void 0,this.chartData=[]},e}(),Ye=function(){function e(){}return Object.defineProperty(e.prototype,"yAxisValue",{get:function(){return this.yValue},set:function(e){this.yValue=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"xAxisValue",{get:function(){return this.xValue},set:function(e){this.xValue=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bubbleSize",{get:function(){return this.size},set:function(e){this.size=e},enumerable:!0,configurable:!0}),e.prototype.clone=function(){var t=new e;return t.yValue=this.yValue,t.xValue=this.xValue,t.size=this.size,t},e.prototype.destroy=function(){this.xValue=void 0,this.yValue=void 0,this.size=void 0},e}(),Qe=function(){function e(){this.chartTitleArea=new Je}return Object.defineProperty(e.prototype,"chartLegendPostion",{get:function(){return this.legendPostion},set:function(e){this.legendPostion=e},enumerable:!0,configurable:!0}),e.prototype.clone=function(){var t=new e;return t.legendPostion=this.legendPostion,t.chartTitleArea=this.chartTitleArea.clone(),t},e.prototype.destroy=function(){this.legendPostion=void 0,this.chartTitleArea=void 0},e}(),qe=function(){function e(){this.chartDataFormat=[],this.trendLines=[],this.errorBar=new Ge,this.dataLabels=new Ze,this.seriesFormat=new Xe}return Object.defineProperty(e.prototype,"seriesName",{get:function(){return this.name},set:function(e){this.name=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"firstSliceAngle",{get:function(){return this.sliceAngle},set:function(e){this.sliceAngle=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"doughnutHoleSize",{get:function(){return this.holeSize},set:function(e){this.holeSize=e},enumerable:!0,configurable:!0}),e.prototype.clone=function(){var t=new e;t.name=this.name,t.sliceAngle=this.sliceAngle,t.holeSize=this.holeSize,t.errorBar=this.errorBar.clone(),t.dataLabels=this.dataLabels.clone(),t.seriesFormat=this.seriesFormat.clone();for(var i=0;i<this.chartDataFormat.length;i++){var r=this.chartDataFormat[i].clone();t.chartDataFormat.push(r)}for(i=0;i<this.trendLines.length;i++){var n=this.trendLines[i].clone();t.trendLines.push(n)}return t},e.prototype.destroy=function(){this.name=void 0,this.errorBar=void 0,this.trendLines=void 0,this.chartDataFormat=[]},e}(),Ge=function(){function e(){}return Object.defineProperty(e.prototype,"errorType",{get:function(){return this.type},set:function(e){this.type=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"errorDirection",{get:function(){return this.direction},set:function(e){this.direction=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"errorEndStyle",{get:function(){return this.endStyle},set:function(e){this.endStyle=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"numberValue",{get:function(){return this.errorValue},set:function(e){this.errorValue=e},enumerable:!0,configurable:!0}),e.prototype.clone=function(){var t=new e;return t.type=this.type,t.errorDirection=this.errorDirection,t.endStyle=this.endStyle,t.errorValue=this.errorValue,t},e.prototype.destroy=function(){this.type=void 0,this.errorDirection=void 0,this.endStyle=void 0},e}(),Xe=function(){function e(){}return Object.defineProperty(e.prototype,"markerStyle",{get:function(){return this.style},set:function(e){this.style=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"markerColor",{get:function(){return this.color},set:function(e){this.color=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"numberValue",{get:function(){return this.size},set:function(e){this.size=e},enumerable:!0,configurable:!0}),e.prototype.clone=function(){var t=new e;return t.style=this.style,t.color=this.color,t.size=this.size,t},e.prototype.destroy=function(){this.style=void 0,this.color=void 0,this.size=void 0},e}(),Ze=function(){function e(){}return Object.defineProperty(e.prototype,"labelPosition",{get:function(){return this.position},set:function(e){this.position=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fontName",{get:function(){return this.name},set:function(e){this.name=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fontColor",{get:function(){return this.color},set:function(e){this.color=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fontSize",{get:function(){return this.size},set:function(e){this.size=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isLegendKey",{get:function(){return this.isLegend},set:function(e){this.isLegend=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isBubbleSize",{get:function(){return this.isBubble},set:function(e){this.isBubble=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isCategoryName",{get:function(){return this.isCategory},set:function(e){this.isCategory=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isSeriesName",{get:function(){return this.isSeries},set:function(e){this.isSeries=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isValue",{get:function(){return this.isValueEnabled},set:function(e){this.isValueEnabled=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isPercentage",{get:function(){return this.isPercentageEnabled},set:function(e){this.isPercentageEnabled=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isLeaderLines",{get:function(){return this.showLeaderLines},set:function(e){this.showLeaderLines=e},enumerable:!0,configurable:!0}),e.prototype.clone=function(){var t=new e;return t.position=this.position,t.name=this.name,t.color=this.color,t.size=this.size,t.isBubble=this.isBubble,t.isLegend=this.isLegend,t.isCategory=this.isCategory,t.isSeries=this.isSeries,t.isValueEnabled=this.isValueEnabled,t.isPercentageEnabled=this.isPercentageEnabled,t.showLeaderLines=this.showLeaderLines,t},e.prototype.destroy=function(){this.position=void 0},e}(),Ke=function(){function e(){}return Object.defineProperty(e.prototype,"trendLineType",{get:function(){return this.type},set:function(e){this.type=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"trendLineName",{get:function(){return this.name},set:function(e){this.name=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"interceptValue",{get:function(){return this.intercept},set:function(e){this.intercept=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"forwardValue",{get:function(){return this.forward},set:function(e){this.forward=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"backwardValue",{get:function(){return this.backward},set:function(e){this.backward=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isDisplayRSquared",{get:function(){return this.displayRSquared},set:function(e){this.displayRSquared=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isDisplayEquation",{get:function(){return this.displayEquation},set:function(e){this.displayEquation=e},enumerable:!0,configurable:!0}),e.prototype.clone=function(){var t=new e;return t.type=this.type,t.name=this.name,t.forward=this.forward,t.backward=this.backward,t.intercept=this.intercept,t.displayEquation=this.displayEquation,t.displayRSquared=this.displayRSquared,t},e.prototype.destroy=function(){this.type=void 0,this.name=void 0,this.forward=void 0,this.backward=void 0},e}(),Je=function(){function e(){this.dataFormat=new $e,this.layout=new tt}return Object.defineProperty(e.prototype,"chartfontName",{get:function(){return this.fontName},set:function(e){this.fontName=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"chartFontSize",{get:function(){return this.fontSize},set:function(e){this.fontSize=e},enumerable:!0,configurable:!0}),e.prototype.clone=function(){var t=new e;return t.fontName=this.fontName,t.fontSize=this.fontSize,t.dataFormat=this.dataFormat.clone(),t.layout=this.layout.clone(),t},e.prototype.destroy=function(){this.fontName=void 0,this.fontSize=void 0,this.dataFormat=void 0,this.layout=void 0},e}(),$e=function(){function e(){this.fill=new et,this.line=new et}return e.prototype.clone=function(){var t=new e;return t.fill=this.fill.clone(),t.line=this.line.clone(),t},e.prototype.destroy=function(){this.fill=void 0,this.line=void 0},e}(),et=function(){function e(){}return Object.defineProperty(e.prototype,"color",{get:function(){return this.fillColor},set:function(e){this.fillColor=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rgb",{get:function(){return this.fillRGB},set:function(e){this.fillRGB=e},enumerable:!0,configurable:!0}),e.prototype.clone=function(){var t=new e;return t.fillColor=this.fillColor,t.fillRGB=this.fillRGB,t},e.prototype.destroy=function(){this.fillColor=void 0,this.fillRGB=void 0},e}(),tt=function(){function e(){}return Object.defineProperty(e.prototype,"chartLayoutLeft",{get:function(){return this.layoutX},set:function(e){this.layoutX=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"chartLayoutTop",{get:function(){return this.layoutY},set:function(e){this.layoutY=e},enumerable:!0,configurable:!0}),e.prototype.clone=function(){var t=new e;return t.layoutX=this.layoutX,t.layoutY=this.layoutY,t},e.prototype.destroy=function(){this.layoutX=void 0,this.layoutY=void 0},e}(),it=function(){function e(){this.chartTitleArea=new Je}return Object.defineProperty(e.prototype,"majorTick",{get:function(){return this.majorTickMark},set:function(e){this.majorTickMark=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"minorTick",{get:function(){return this.minorTickMark},set:function(e){this.minorTickMark=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tickPosition",{get:function(){return this.tickLabelPostion},set:function(e){this.tickLabelPostion=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"minorGridLines",{get:function(){return this.hasMinorGridLines},set:function(e){this.hasMinorGridLines=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"majorGridLines",{get:function(){return this.hasMajorGridLines},set:function(e){this.hasMajorGridLines=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"interval",{get:function(){return this.majorUnit},set:function(e){this.majorUnit=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"max",{get:function(){return this.maximumValue},set:function(e){this.maximumValue=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"min",{get:function(){return this.minimumValue},set:function(e){this.minimumValue=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"categoryAxisTitle",{get:function(){return this.title},set:function(e){this.title=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"categoryAxisType",{get:function(){return this.categoryType},set:function(e){this.categoryType=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"categoryNumberFormat",{get:function(){return this.numberFormat},set:function(e){this.numberFormat=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"axisFontSize",{get:function(){return this.fontSize},set:function(e){this.fontSize=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"axisFontName",{get:function(){return this.fontName},set:function(e){this.fontName=e},enumerable:!0,configurable:!0}),e.prototype.clone=function(){var t=new e;return t.title=this.title,t.categoryType=this.categoryType,t.numberFormat=this.numberFormat,t.fontSize=this.fontSize,t.fontName=this.fontName,t.hasMajorGridLines=this.hasMajorGridLines,t.hasMinorGridLines=this.hasMinorGridLines,t.minimumValue=this.minimumValue,t.maximumValue=this.maximumValue,t.majorUnit=this.majorUnit,t.majorTickMark=this.majorTickMark,t.minorTickMark=this.minorTickMark,t.tickLabelPostion=this.tickLabelPostion,t.chartTitleArea=this.chartTitleArea.clone(),t},e.prototype.destroy=function(){this.title=void 0,this.categoryType=void 0,this.numberFormat=void 0,this.chartTitleArea=void 0,this.minimumValue=void 0,this.maximumValue=void 0,this.fontSize=void 0,this.fontName=void 0,this.majorUnit=void 0,this.majorTickMark=void 0,this.minorTickMark=void 0,this.tickLabelPostion=void 0},e}(),rt=function(){function e(){}return Object.defineProperty(e.prototype,"showSeriesKeys",{get:function(){return this.isSeriesKeys},set:function(e){this.isSeriesKeys=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hasHorzBorder",{get:function(){return this.isHorzBorder},set:function(e){this.isHorzBorder=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hasVertBorder",{get:function(){return this.isVertBorder},set:function(e){this.isVertBorder=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hasBorders",{get:function(){return this.isBorders},set:function(e){this.isBorders=e},enumerable:!0,configurable:!0}),e.prototype.clone=function(){var t=new e;return t.isSeriesKeys=this.isSeriesKeys,t.isHorzBorder=this.isHorzBorder,t.isVertBorder=this.isVertBorder,t.isBorders=this.isBorders,t},e.prototype.destroy=function(){this.isSeriesKeys=void 0,this.isHorzBorder=void 0,this.isVertBorder=void 0,this.isBorders=void 0},e}(),nt=function(e){function t(t){var i=e.call(this)||this;return i.commentType=0,i.commentId="",i.commentType=t,i}return J(t,e),Object.defineProperty(t.prototype,"comment",{get:function(){return this.commentInternal},set:function(e){this.commentInternal=e},enumerable:!0,configurable:!0}),t.prototype.getLength=function(){return 1},t.prototype.clone=function(){var e=new t(this.commentType);return e.commentId=this.commentId,e.commentType=this.commentType,e},t.prototype.renderCommentMark=function(){if(0===this.commentType&&sf.base.isNullOrUndefined(this.commentMark)){this.commentMark=document.createElement("div"),this.commentMark.style.display="none",this.commentMark.classList.add("e-de-cmt-mark");var e=document.createElement("span");e.classList.add("e-icons"),e.classList.add("e-de-cmt-mark-icon"),this.commentMark.appendChild(e)}this.line&&sf.base.isNullOrUndefined(this.commentMark.parentElement)&&(this.line.paragraph.bodyWidget.page.documentHelper.pageContainer.appendChild(this.commentMark),this.commentMark.addEventListener("click",this.selectComment.bind(this)))},t.prototype.selectComment=function(){var e=this.line.paragraph.bodyWidget.page.documentHelper;e.owner&&e.selectComment(this.comment)},t.prototype.removeCommentMark=function(){this.commentMark&&this.commentMark.parentElement&&(this.commentMark.removeEventListener("click",this.selectComment.bind(this)),this.commentMark.parentElement.removeChild(this.commentMark))},t.prototype.destroy=function(){this.commentMark&&this.removeCommentMark()},t}(ge),ot=function(e){function t(t){var i=e.call(this,0)||this;return i.authorIn="",i.initialIn="",i.done=!1,i.textIn="",i.isReply=!1,i.ownerComment=void 0,i.createdDate=t,i.replyComments=[],i}return J(t,e),Object.defineProperty(t.prototype,"commentStart",{get:function(){return this.commentStartIn},set:function(e){this.commentStartIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"commentEnd",{get:function(){return this.commentEndIn},set:function(e){this.commentEndIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"author",{get:function(){return this.authorIn},set:function(e){this.authorIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"initial",{get:function(){return this.initialIn},set:function(e){this.initialIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isResolved",{get:function(){return this.done},set:function(e){this.done=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"date",{get:function(){return this.createdDate},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"text",{get:function(){return this.textIn},set:function(e){this.textIn=e},enumerable:!0,configurable:!0}),t.prototype.getLength=function(){return 1},t.prototype.clone=function(){var e=new t(this.date);return e.author=this.author,e.initial=this.initial,e.commentId=this.commentId,e.replyComments=this.replyComments,e.isResolved=this.isResolved,e.text=this.text,e},t.prototype.destroy=function(){this.ownerComment=void 0},t}(nt),st=function(){function e(e){this.boundingRectangle=new $(96,96,816,1056),this.repeatHeaderRowTableWidget=!1,this.bodyWidgets=[],this.headerWidgetIn=void 0,this.footerWidgetIn=void 0,this.footnoteWidget=void 0,this.endnoteWidget=void 0,this.currentPageNum=1,this.allowNextPageRendering=!0,this.documentHelper=e}return Object.defineProperty(e.prototype,"headerWidget",{get:function(){return!sf.base.isNullOrUndefined(this.headerWidgetIn)&&this.headerWidgetIn.parentHeaderFooter?this.headerWidgetIn.parentHeaderFooter:this.headerWidgetIn},set:function(e){this.headerWidgetIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"footerWidget",{get:function(){return!sf.base.isNullOrUndefined(this.footerWidgetIn)&&this.footerWidgetIn.parentHeaderFooter?this.footerWidgetIn.parentHeaderFooter:this.footerWidgetIn},set:function(e){this.footerWidgetIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"index",{get:function(){return this.documentHelper?this.documentHelper.pages.indexOf(this):-1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"previousPage",{get:function(){var e=this.index;if(e>0)return this.documentHelper.pages[e-1]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nextPage",{get:function(){var e=this.index;if(e<this.documentHelper.pages.length-1)return this.documentHelper.pages[e+1]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"sectionIndex",{get:function(){return this.bodyWidgets.length>0?this.bodyWidgets[0].index:-1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"viewer",{get:function(){return this.documentHelper.owner.viewer},enumerable:!0,configurable:!0}),e.prototype.destroy=function(){this.headerWidget&&this.headerWidget.page===this&&(this.headerWidget.page=void 0),this.footerWidget&&this.footerWidget.page===this&&(this.footerWidget.page=void 0),this.headerWidgetIn&&!sf.base.isNullOrUndefined(this.headerWidgetIn.parentHeaderFooter)&&(this.viewer&&this.documentHelper.owner.editor&&(this.documentHelper.owner.editor.removeFieldInWidget(this.headerWidgetIn),this.documentHelper.owner.editor.removeFieldInWidget(this.headerWidgetIn,!1,!0)),this.headerWidgetIn.destroy(),this.headerWidget=void 0),this.footerWidgetIn&&!sf.base.isNullOrUndefined(this.footerWidgetIn.parentHeaderFooter)&&(this.viewer&&this.documentHelper.owner.editor&&(this.documentHelper.owner.editor.removeFieldInWidget(this.footerWidgetIn),this.documentHelper.owner.editor.removeFieldInWidget(this.footerWidgetIn,!1,!0)),this.footerWidgetIn.destroy(),this.footerWidgetIn=void 0),this.bodyWidgets=[],this.bodyWidgets=void 0,sf.base.isNullOrUndefined(this.documentHelper)||sf.base.isNullOrUndefined(this.documentHelper.pages)||this.documentHelper.removePage(this),this.documentHelper=void 0},e}(),at=function(){function e(){this.tableColumns=[],this.tableWidth=0}return Object.defineProperty(e.prototype,"columns",{get:function(){return this.tableColumns},enumerable:!0,configurable:!0}),e.prototype.resetColumns=function(){for(var e=0;e<this.tableColumns.length;e++)this.tableColumns[e].destroy();this.tableColumns=[]},e.prototype.getPreviousSpannedCellWidth=function(e,t){for(var i=0,r=e;r<t;r++)i+=this.tableColumns[r].preferredWidth;return i},e.prototype.addColumns=function(e,t,i,r,n,o){for(var s=this.columns.length;s<t;s++)this.columns.push(new lt);for(var a=0,l=e;l<t;l++)a+=this.columns[l].preferredWidth;!(t-e>1)&&a<i&&(this.columns[t-1].preferredWidth+=i-a),r.minimumWordWidth>this.columns[t-1].minimumWordWidth&&(this.columns[t-1].minimumWordWidth=r.minimumWordWidth),r.maximumWordWidth>this.columns[t-1].maximumWordWidth&&(this.columns[t-1].maximumWordWidth=r.maximumWordWidth),r.minimumWidth>this.columns[t-1].minimumWidth&&(this.columns[t-1].minimumWidth=r.minimumWidth),n>this.columns[t-1].endOffset&&(this.columns[t-1].endOffset=n),this.columns[t-1].widthType=o},e.prototype.getTotalWidth=function(e){for(var t=0,i=0;i<this.columns.length;i++){var r=this.columns[i];t+=0===e?r.preferredWidth:1===e?r.minimumWordWidth:2===e?r.maximumWordWidth:r.minimumWidth}return t},e.prototype.isFitColumns=function(e,t,i){var r=this.getTotalWidth(0);if(this.tableWidth=i&&t>r?r:t,r!==this.tableWidth){var n=this.tableWidth/r;n=isNaN(n)||n===1/0?1:n;for(var o=0;o<this.columns.length;o++){var s=this.columns[o];if(n*s.preferredWidth<s.minWidth)return!1}return!0}return!0},e.prototype.isAllColumnHasPointWidthType=function(){for(var e=!0,t=0;t<this.columns.length;t++)"Point"!=this.columns[t].widthType&&(e=!1);return e},e.prototype.autoFitColumn=function(e,t,i,r,n,o){for(var s=0,a=0,l=0,h=!0,d=0,c=[],p=0;p<this.columns.length;p++){0===(y=this.columns[p]).minimumWordWidth&&0===y.maximumWordWidth&&0===y.minWidth&&(y.minimumWordWidth=y.preferredWidth,y.maximumWordWidth=y.preferredWidth,y.minWidth=y.preferredWidth),"Point"!==y.widthType&&(h=!1);var u=0;s+=y.preferredWidth>y.maximumWordWidth?y.preferredWidth:y.maximumWordWidth,a+=y.preferredWidth>y.minimumWordWidth?y.preferredWidth:y.minimumWordWidth;var g=0===y.preferredWidth?y.minimumWordWidth:y.preferredWidth>y.minimumWordWidth?y.preferredWidth:y.minimumWordWidth;l+=(u=y.maximumWordWidth-g)>0?u:0,y.preferredWidth<y.minimumWordWidth?d+=y.minimumWordWidth-y.preferredWidth:c.push(p)}if(s<=t){for(p=0;p<this.columns.length;p++){"Point"!==(y=this.columns[p]).widthType?y.preferredWidth<y.maximumWordWidth&&(y.preferredWidth=y.maximumWordWidth):y.preferredWidth<y.minimumWordWidth&&(y.preferredWidth=y.minimumWordWidth)}i||this.fitColumns(e,t,i)}else{var f=this.getTotalWidth(0);if(h&&!n&&a>e&&(e>f&&(d-=e-f),c.length>0&&d>0)){var m=d/c.length;for(p=0;p<this.columns.length;p++){var y=this.columns[p];-1===c.indexOf(p)?y.preferredWidth=y.minimumWordWidth:y.preferredWidth=y.preferredWidth-m}f=this.getTotalWidth(0)}if(!i){var v=!1;return t<a&&a+(sf.base.isNullOrUndefined(o)?0:o)<e&&(v=!0),void this.fitColumns(e,v?a:t,i)}if(a<=t||a<=e){var b=e>t?e:t;b-=a;for(p=0;p<this.columns.length;p++){if("Point"!==(y=this.columns[p]).widthType){(0===y.preferredWidth||y.preferredWidth<y.minimumWordWidth)&&(y.preferredWidth=y.minimumWordWidth);var w=b*((u=(u=y.maximumWordWidth-y.preferredWidth)>0?u:0)/l);y.preferredWidth+=isNaN(w)?0:w}}}else{var x=this.getTotalWidth(1),M=this.getTotalWidth(3);if(M>2112){var N=2112/this.columns.length;for(p=0;p<this.columns.length;p++)this.columns[p].preferredWidth=N}else{b=0;if(M<e&&e-M>=1&&!h||h&&!n&&x>e){b=e-M;for(p=0;p<this.columns.length;p++){w=b*(y=this.columns[p]).minimumWordWidth/x;w=isNaN(w)?0:w,y.preferredWidth=(0==y.minimumWidth?1:y.minimumWidth)+w}}else if(f>e)for(w=e/f,p=0;p<this.columns.length;p++){(y=this.columns[p]).preferredWidth=y.preferredWidth*w}}}}this.tableWidth=this.getTotalWidth(0)},e.prototype.getValidColumnIndex=function(e){for(var t=0,i=0;i<this.columns.length;i++){var r=this.columns[i];if(i<e)t=r.endOffset;else{if(t!==r.endOffset)break;e++}}return e},e.prototype.fitColumns=function(e,t,i,r){sf.base.isNullOrUndefined(r)&&(r=0);var n=this.getTotalWidth(0);if(i&&(n-=r),this.tableWidth=i?n:t,n!==this.tableWidth){var o=this.tableWidth/n;o=isNaN(o)||o===1/0?1:o;for(var s=0;s<this.columns.length;s++){var a=this.columns[s];a.preferredWidth=o*a.preferredWidth}}},e.prototype.getCellWidth=function(e,t,i){for(var r=0,n=0;n<t;n++)r+=this.tableColumns[n+e].preferredWidth;return r},e.prototype.validateColumnWidths=function(){for(var e=0;e<this.columns.length;e++)0===e?this.columns[e].preferredWidth!==this.columns[e].endOffset&&(this.columns[e].preferredWidth=this.columns[e].endOffset):this.columns[e-1].endOffset+this.columns[e].preferredWidth<this.columns[e].endOffset&&(0===this.columns[e-1].endOffset?this.columns[e].preferredWidth=this.columns[e].endOffset-this.getPreviousValidOffset(e-2):this.columns[e].preferredWidth=this.columns[e].endOffset-this.columns[e-1].endOffset)},e.prototype.getPreviousValidOffset=function(e){for(var t=e;t>=0;t--)if(0!==this.columns[t].endOffset)return this.columns[t].endOffset;return 0},e.prototype.clone=function(){var t=new e;t.tableWidth=this.tableWidth;for(var i=0;i<this.columns.length;i++)t.columns.push(this.columns[i].clone());return t},e.prototype.destroy=function(){if(!sf.base.isNullOrUndefined(this.tableColumns))for(var e=0;e<this.tableColumns.length;e++){this.tableColumns[e].destroy()}this.tableColumns=[],this.tableColumns=void 0,this.tableWidth=void 0},e}(),lt=function(){function e(){this.preferredWidth=0,this.minWidth=0,this.maxWidth=0,this.endOffset=0,this.minimumWordWidth=0,this.maximumWordWidth=0,this.minimumWidth=0}return e.prototype.clone=function(){var t=new e;return t.preferredWidth=this.preferredWidth,t.minWidth=this.minWidth,t.maxWidth=this.maxWidth,t},e.prototype.destroy=function(){this.preferredWidth=void 0,this.minWidth=void 0,this.maxWidth=void 0},e}(),ht=function(){this.minimumWordWidth=0,this.maximumWordWidth=0,this.minimumWidth=0,this.hasMinimumWidth=!1,this.hasMinimumWordWidth=!1,this.hasMaximumWordWidth=!1},dt=function(){function e(){}return Object.defineProperty(e.prototype,"position",{get:function(){return this.positionIn},set:function(e){this.positionIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"deletePosition",{get:function(){return this.deletePositionIn},set:function(e){this.deletePositionIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tabJustification",{get:function(){return this.justification},set:function(e){this.justification=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tabLeader",{get:function(){return this.leader},set:function(e){this.leader=e},enumerable:!0,configurable:!0}),e.prototype.destroy=function(){this.position=void 0,this.deletePosition=void 0,this.tabJustification=void 0,this.leader=void 0},e}(),ct=function(){function e(e){this.uniqueParagraphFormat=void 0,this.ownerBase=void 0,this.baseStyle=void 0,this.tabs=void 0,this.ownerBase=e,this.listFormat=new m(this),this.borders=new u(this),this.tabs=[]}return e.prototype.getUpdatedTabs=function(){for(var e=[],t=new a,i=0,r=this.getTabStopsFromListFormat();i<r.length;i++){var n=r[i];t.containsKey(n.position)||t.add(n.position,n)}if(!sf.base.isNullOrUndefined(this.baseStyle)&&this.baseStyle instanceof gt){for(var o=this.baseStyle;!sf.base.isNullOrUndefined(o);){for(var s=0,l=o.paragraphFormat.tabs;s<l.length;s++){var h=l[s];t.containsKey(h.position)||t.add(h.position,h)}o=o.basedOn}for(var d=0,c=t.keys;d<c.length;d++){var p=c[d];this.hasTabStop(parseFloat(p.toFixed(4)))||e.push(t.get(p))}e=(e=e.concat(this.tabs.filter((function(e){return 0!==e.position&&0===e.deletePosition})))).sort((function(e,t){return e.position-t.position}))}return e},e.prototype.getTabStopsFromListFormat=function(){if(this.listFormat.listId>-1&&this.listFormat.listLevelNumber>-1){var e=this.listFormat.listLevel;if(e&&e.paragraphFormat)return e.paragraphFormat.tabs}return[]},e.prototype.hasTabStop=function(e){for(var t=0;t<this.tabs.length;t++)if(parseFloat(this.tabs[t].position.toFixed(4))===e||parseFloat(this.tabs[t].deletePosition.toFixed(4))===e)return!0;return!1},Object.defineProperty(e.prototype,"leftIndent",{get:function(){return this.getPropertyValue("leftIndent")},set:function(e){this.setPropertyValue("leftIndent",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rightIndent",{get:function(){return this.getPropertyValue("rightIndent")},set:function(e){this.setPropertyValue("rightIndent",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"firstLineIndent",{get:function(){return this.getPropertyValue("firstLineIndent")},set:function(e){this.setPropertyValue("firstLineIndent",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"beforeSpacing",{get:function(){return this.getPropertyValue("beforeSpacing")},set:function(e){this.setPropertyValue("beforeSpacing",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"afterSpacing",{get:function(){return this.getPropertyValue("afterSpacing")},set:function(e){this.setPropertyValue("afterSpacing",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"spaceBeforeAuto",{get:function(){return this.getPropertyValue("spaceBeforeAuto")},set:function(e){this.setPropertyValue("spaceBeforeAuto",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"spaceAfterAuto",{get:function(){return this.getPropertyValue("spaceAfterAuto")},set:function(e){this.setPropertyValue("spaceAfterAuto",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lineSpacing",{get:function(){return this.getPropertyValue("lineSpacing")},set:function(e){this.setPropertyValue("lineSpacing",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lineSpacingType",{get:function(){return this.getPropertyValue("lineSpacingType")},set:function(e){this.setPropertyValue("lineSpacingType",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"textAlignment",{get:function(){var e=this.getPropertyValue("textAlignment");return this.bidi&&("Left"===e?e="Right":"Right"===e&&(e="Left")),e},set:function(e){this.setPropertyValue("textAlignment",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"keepWithNext",{get:function(){return this.getPropertyValue("keepWithNext")},set:function(e){this.setPropertyValue("keepWithNext",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"keepLinesTogether",{get:function(){return this.getPropertyValue("keepLinesTogether")},set:function(e){this.setPropertyValue("keepLinesTogether",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"widowControl",{get:function(){return this.getPropertyValue("widowControl")},set:function(e){this.setPropertyValue("widowControl",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"outlineLevel",{get:function(){return this.getPropertyValue("outlineLevel")},set:function(e){this.setPropertyValue("outlineLevel",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bidi",{get:function(){return this.getPropertyValue("bidi")},set:function(e){this.setPropertyValue("bidi",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"contextualSpacing",{get:function(){return this.getPropertyValue("contextualSpacing")},set:function(e){this.setPropertyValue("contextualSpacing",e)},enumerable:!0,configurable:!0}),e.prototype.getListFormatParagraphFormat=function(t){var i=this.getListPargaraphFormat(t);if(!sf.base.isNullOrUndefined(i))return i.uniqueParagraphFormat.propertiesHash.get(l.getPropertyType(e.uniqueFormatType,t))},e.prototype.getListPargaraphFormat=function(t){if(this.listFormat.listId>-1&&this.listFormat.listLevelNumber>-1){var i=this.listFormat.listLevel,r=l.getPropertyType(e.uniqueFormatType,t);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.paragraphFormat.uniqueParagraphFormat)||!i.paragraphFormat.uniqueParagraphFormat.propertiesHash.containsKey(r)?void 0:i.paragraphFormat}if(this.listFormat.hasValue("listId")&&-1===this.listFormat.listId&&("leftIndent"===t||"firstLineIndent"===t)){var n=new e;return this.hasValue("leftIndent")||(n.leftIndent=0),this.hasValue("firstLineIndent")||(n.firstLineIndent=0),n}},e.prototype.getPropertyValue=function(t){if(this.hasValue(t)){s=l.getPropertyType(e.uniqueFormatType,t);if(!sf.base.isNullOrUndefined(this.uniqueParagraphFormat)&&this.uniqueParagraphFormat.propertiesHash.containsKey(s))return this.uniqueParagraphFormat.propertiesHash.get(s)}else{var i=this.getListFormatParagraphFormat(t);if(this.baseStyle instanceof gt){for(var r=this,n=this.baseStyle;!sf.base.isNullOrUndefined(n);){var o=void 0;if(this.listFormat.hasValue("listId")||(o=n.paragraphFormat.getListPargaraphFormat(t)),n.paragraphFormat.hasValue(t)){r=n.paragraphFormat;break}if(!sf.base.isNullOrUndefined(o)&&o.hasValue(t)){r=o;break}n=n.basedOn}if(!sf.base.isNullOrUndefined(n)){if(!sf.base.isNullOrUndefined(i)&&this.listFormat.hasValue("listId")&&-1===r.listFormat.listId&&r.listFormat.listLevelNumber<=1||!sf.base.isNullOrUndefined(i)&&this.listFormat.listId!==r.listFormat.listId&&r.listFormat.listLevelNumber<=1)return i;var s=l.getPropertyType(e.uniqueFormatType,t);return r.uniqueParagraphFormat.propertiesHash.get(s)}}if(!sf.base.isNullOrUndefined(i))return i}return this.getDefaultValue(t)},e.prototype.getDefaultValue=function(t){var i=l.getPropertyType(e.uniqueFormatType,t),r=this.getDocumentParagraphFormat(),n=!0;this.ownerBase&&this.ownerBase instanceof le&&(n=this.ownerBase.containerWidget instanceof re||this.ownerBase.containerWidget instanceof ze||this.ownerBase.containerWidget instanceof pe);var o=!sf.base.isNullOrUndefined(this.ownerBase)&&!sf.base.isNullOrUndefined(this.ownerBase.bodyWidget)&&this.ownerBase.bodyWidget.page&&!sf.base.isNullOrUndefined(this.ownerBase.bodyWidget.page.documentHelper)&&this.ownerBase.bodyWidget.page.documentHelper.owner.editor&&this.ownerBase.bodyWidget.page.documentHelper.owner.editor.isPaste;if(n&&!o&&!sf.base.isNullOrUndefined(r)&&!sf.base.isNullOrUndefined(r.uniqueParagraphFormat)){var s=r.uniqueParagraphFormat.propertiesHash.get(i);if(!sf.base.isNullOrUndefined(s))return s}return e.getPropertyDefaultValue(t)},e.prototype.getDocumentParagraphFormat=function(){var e;if(!sf.base.isNullOrUndefined(this.ownerBase)){var t=this.getDocumentHelperObject();sf.base.isNullOrUndefined(t)||(e=t.paragraphFormat)}return e},e.prototype.getDocumentHelperObject=function(){var e;if(this.ownerBase instanceof le){var t=this.ownerBase.bodyWidget;sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t.page)||sf.base.isNullOrUndefined(t.page.documentHelper)||(e=t.page.documentHelper)}return e},e.prototype.setPropertyValue=function(t,i,r){if((sf.base.isNullOrUndefined(i)||""===i&&!r)&&(i=e.getPropertyDefaultValue(t)),sf.base.isNullOrUndefined(this.uniqueParagraphFormat))this.initializeUniqueParagraphFormat(t,i);else{var n=l.getPropertyType(this.uniqueParagraphFormat.uniqueFormatType,t);if(this.uniqueParagraphFormat.propertiesHash.containsKey(n)&&this.uniqueParagraphFormat.propertiesHash.get(n)===i)return;this.uniqueParagraphFormat=e.uniqueParagraphFormats.updateUniqueFormat(this.uniqueParagraphFormat,t,i)}},e.prototype.initializeUniqueParagraphFormat=function(t,i){var r=new a;this.addUniqueParaFormat("leftIndent",t,i,r),this.addUniqueParaFormat("rightIndent",t,i,r),this.addUniqueParaFormat("firstLineIndent",t,i,r),this.addUniqueParaFormat("textAlignment",t,i,r),this.addUniqueParaFormat("beforeSpacing",t,i,r),this.addUniqueParaFormat("afterSpacing",t,i,r),this.addUniqueParaFormat("spaceBeforeAuto",t,i,r),this.addUniqueParaFormat("spaceAfterAuto",t,i,r),this.addUniqueParaFormat("lineSpacing",t,i,r),this.addUniqueParaFormat("lineSpacingType",t,i,r),this.addUniqueParaFormat("outlineLevel",t,i,r),this.addUniqueParaFormat("bidi",t,i,r),this.addUniqueParaFormat("contextualSpacing",t,i,r),this.addUniqueParaFormat("keepWithNext",t,i,r),this.addUniqueParaFormat("keepLinesTogether",t,i,r),this.addUniqueParaFormat("widowControl",t,i,r),this.uniqueParagraphFormat=e.uniqueParagraphFormats.addUniqueFormat(r,e.uniqueFormatType)},e.prototype.addUniqueParaFormat=function(t,i,r,n){var o=l.getPropertyType(e.uniqueFormatType,t);t===i&&n.add(o,r)},e.getPropertyDefaultValue=function(e){var t=void 0;switch(e){case"leftIndent":case"rightIndent":case"firstLineIndent":t=0;break;case"textAlignment":t="Left";break;case"beforeSpacing":case"afterSpacing":t=0;break;case"spaceBeforeAuto":case"spaceAfterAuto":t=!1;break;case"lineSpacing":t=1;break;case"lineSpacingType":t="Multiple";break;case"styleName":t="Normal";break;case"outlineLevel":t="BodyText";break;case"bidi":case"contextualSpacing":case"keepWithNext":case"keepLinesTogether":t=!1;break;case"widowControl":t=!0}return t},e.prototype.clearIndent=function(){this.clearPropertyValue("leftIndent"),this.clearPropertyValue("firstLineIndent")},e.prototype.clearPropertyValue=function(e){if(this.setPropertyValue(e,void 0,!0),!sf.base.isNullOrUndefined(this.uniqueParagraphFormat)){var t=l.getPropertyType(this.uniqueParagraphFormat.uniqueFormatType,e);this.uniqueParagraphFormat.propertiesHash.containsKey(t)&&this.uniqueParagraphFormat.propertiesHash.remove(t)}},e.prototype.clearFormat=function(){sf.base.isNullOrUndefined(this.listFormat)||this.listFormat.clearFormat(),sf.base.isNullOrUndefined(this.uniqueParagraphFormat)||0!==this.uniqueParagraphFormat.referenceCount||e.uniqueParagraphFormats.remove(this.uniqueParagraphFormat),this.uniqueParagraphFormat=void 0,this.baseStyle=void 0},e.prototype.destroy=function(){if(this.clearFormat(),sf.base.isNullOrUndefined(this.listFormat)||this.listFormat.destroy(),this.listFormat=void 0,void 0!==this.tabs){for(var e=0;e<this.tabs.length;e++)this.tabs[e].destroy();this.tabs=void 0}sf.base.isNullOrUndefined(this.borders)||this.borders.destroy(),this.borders=void 0},e.prototype.copyFormat=function(e){if(!sf.base.isNullOrUndefined(e)&&(sf.base.isNullOrUndefined(e.uniqueParagraphFormat)||this.updateUniqueParagraphFormat(e),sf.base.isNullOrUndefined(e.borders)||this.borders.copyFormat(e.borders),sf.base.isNullOrUndefined(e.listFormat)||this.listFormat.copyFormat(e.listFormat),sf.base.isNullOrUndefined(e.baseStyle)||(this.baseStyle=e.baseStyle),!sf.base.isNullOrUndefined(e.tabs)))for(var t=0;t<e.tabs.length;t++)this.tabs[t]=e.tabs[t]},e.prototype.updateUniqueParagraphFormat=function(t){var i=void 0;this.uniqueParagraphFormat&&(i=this.uniqueParagraphFormat.mergeProperties(t.uniqueParagraphFormat),0===this.uniqueParagraphFormat.referenceCount&&(e.uniqueParagraphFormats.remove(this.uniqueParagraphFormat),this.uniqueParagraphFormat=void 0)),this.uniqueParagraphFormat=new l(e.uniqueFormatType),sf.base.isNullOrUndefined(i)&&(i=this.uniqueParagraphFormat.mergeProperties(t.uniqueParagraphFormat)),this.uniqueParagraphFormat=e.uniqueParagraphFormats.addUniqueFormat(i,e.uniqueFormatType)},e.prototype.cloneFormat=function(){var t=new e(void 0);return t.uniqueParagraphFormat=this.uniqueParagraphFormat,t.baseStyle=this.baseStyle,sf.base.isNullOrUndefined(this.listFormat)?t.listFormat=void 0:(t.listFormat=this.listFormat.cloneListFormat(),t.listFormat.ownerBase=t),t.borders=sf.base.isNullOrUndefined(this.borders)?void 0:this.borders.cloneFormat(),t},e.prototype.hasValue=function(e){if(!sf.base.isNullOrUndefined(this.uniqueParagraphFormat)&&!sf.base.isNullOrUndefined(this.uniqueParagraphFormat.propertiesHash)){var t=l.getPropertyType(this.uniqueParagraphFormat.uniqueFormatType,e);return this.uniqueParagraphFormat.propertiesHash.containsKey(t)}return!1},e.clear=function(){this.uniqueParagraphFormats.clear()},e.prototype.applyStyle=function(e){this.baseStyle=e,this.listFormat.applyStyle(this.baseStyle)},e.prototype.getValue=function(e){return this.hasValue(e)?this.getPropertyValue(e):void 0},e.prototype.mergeFormat=function(e,t){t=!sf.base.isNullOrUndefined(t)&&t,sf.base.isNullOrUndefined(this.getValue("leftIndent"))&&(this.leftIndent=e.getValue("leftIndent")),sf.base.isNullOrUndefined(this.getValue("rightIndent"))&&(this.rightIndent=e.getValue("rightIndent")),sf.base.isNullOrUndefined(this.getValue("firstLineIndent"))&&(this.firstLineIndent=e.getValue("firstLineIndent")),sf.base.isNullOrUndefined(this.getValue("beforeSpacing"))&&(this.beforeSpacing=e.getValue("beforeSpacing")),sf.base.isNullOrUndefined(this.getValue("afterSpacing"))&&(this.afterSpacing=e.getValue("afterSpacing")),sf.base.isNullOrUndefined(this.getValue("spaceBeforeAuto"))&&(this.spaceBeforeAuto=e.getValue("spaceBeforeAuto")),sf.base.isNullOrUndefined(this.getValue("spaceAfterAuto"))&&(this.spaceAfterAuto=e.getValue("spaceAfterAuto")),sf.base.isNullOrUndefined(this.getValue("lineSpacing"))&&(this.lineSpacing=e.getValue("lineSpacing")),sf.base.isNullOrUndefined(this.getValue("lineSpacingType"))&&(this.lineSpacingType=e.getValue("lineSpacingType")),sf.base.isNullOrUndefined(this.getValue("textAlignment"))&&(this.textAlignment=e.getValue("textAlignment")),sf.base.isNullOrUndefined(this.getValue("outlineLevel"))&&(this.outlineLevel=e.getValue("outlineLevel")),!t&&sf.base.isNullOrUndefined(this.getValue("bidi"))&&(this.bidi=e.getValue("bidi")),sf.base.isNullOrUndefined(this.getValue("contextualSpacing"))&&(this.contextualSpacing=e.getValue("contextualSpacing")),sf.base.isNullOrUndefined(this.getValue("keepWithNext"))&&(this.keepWithNext=e.getValue("keepWithNext")),sf.base.isNullOrUndefined(this.getValue("keepLinesTogether"))&&(this.keepLinesTogether=e.getValue("keepLinesTogether")),sf.base.isNullOrUndefined(this.getValue("widowControl"))&&(this.widowControl=e.getValue("widowControl")),sf.base.isNullOrUndefined(this.listFormat)&&this.listFormat.mergeFormat(e.listFormat)},e.uniqueParagraphFormats=new h,e.uniqueFormatType=3,e}(),pt=(b=function(e,t){return(b=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}b(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),ut=function(){},gt=function(e){function t(t){var i=e.call(this)||this;return i.ownerBase=t,i.paragraphFormat=new ct(i),i.characterFormat=new P(i),i}return pt(t,e),t.prototype.destroy=function(){this.characterFormat.destroy(),this.paragraphFormat.destroy()},t.prototype.copyStyle=function(e){this.name=e.name,this.ownerBase=e.ownerBase,this.type=e.type,this.next=e.next,this.basedOn=e.basedOn,this.link=e.link,this.characterFormat.copyFormat(e.characterFormat),this.paragraphFormat.copyFormat(e.paragraphFormat)},t}(ut),ft=function(e){function t(t){var i=e.call(this)||this;return i.ownerBase=t,i.characterFormat=new P(i),i}return pt(t,e),t.prototype.destroy=function(){this.characterFormat.destroy()},t.prototype.copyStyle=function(e){this.name=e.name,this.ownerBase=e.ownerBase,this.type=e.type,this.next=e.next,this.basedOn=e.basedOn,this.characterFormat.copyFormat(e.characterFormat)},t}(ut),mt=function(){function e(){this.collection=[]}return Object.defineProperty(e.prototype,"length",{get:function(){return this.collection.length},enumerable:!0,configurable:!0}),e.prototype.remove=function(e){this.collection=this.collection.filter((function(t){return t.name!==e.name}))},e.prototype.push=function(e){return null!=e&&void 0!==e&&this.collection.push(e),1},e.prototype.getItem=function(e){return this.collection.length>e?this.collection[parseInt(e.toString(),10)]:null},e.prototype.indexOf=function(e){return this.collection.indexOf(e)},e.prototype.contains=function(e){var t=this.collection.indexOf(e);return t>-1&&t<this.collection.length},e.prototype.clear=function(){for(;this.collection.length>0;)this.collection.pop()},e.prototype.findByName=function(e,t){for(var i,r=0,n=this.collection;r<n.length;r++){var o=n[r];o.name===e&&(i=o,sf.base.isNullOrUndefined(t)||o.type!==t&&(i=void 0))}return i},e.prototype.getStyleNames=function(e){return this.collection.filter((function(t){return t.type===e})).map((function(e){return e.name}))},e.prototype.getStyles=function(e){for(var t=[],i=0,r=this.collection.filter((function(t){return t.type===e})).map((function(e){return e}));i<r.length;i++){var n=r[i],o={},s={characterFormat:{}};x.writeCharacterFormat(s.characterFormat,!0,n.characterFormat),o.name=n.name,o.style=JSON.stringify(s),t.push(o)}return t},e}(),yt=function(){function e(e){this.uniqueShadingFormat=void 0,this.ownerBase=void 0,this.ownerBase=e}return Object.defineProperty(e.prototype,"backgroundColor",{get:function(){return this.getPropertyValue("backgroundColor")},set:function(e){this.setPropertyValue("backgroundColor",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"foregroundColor",{get:function(){return this.getPropertyValue("foregroundColor")},set:function(e){this.setPropertyValue("foregroundColor",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"textureStyle",{get:function(){return this.getPropertyValue("textureStyle")},set:function(e){this.setPropertyValue("textureStyle",e)},enumerable:!0,configurable:!0}),e.prototype.getPropertyValue=function(t){if(this.hasValue(t)){var i=l.getPropertyType(e.uniqueFormatType,t);if(!sf.base.isNullOrUndefined(this.uniqueShadingFormat)&&this.uniqueShadingFormat.propertiesHash.containsKey(i))return this.uniqueShadingFormat.propertiesHash.get(i)}return e.getPropertyDefaultValue(t)},e.prototype.setPropertyValue=function(t,i){if((sf.base.isNullOrUndefined(i)||""===i)&&(i=e.getPropertyDefaultValue(t)),sf.base.isNullOrUndefined(this.uniqueShadingFormat))this.initializeUniqueShading(t,i);else{var r=l.getPropertyType(this.uniqueShadingFormat.uniqueFormatType,t);if(this.uniqueShadingFormat.propertiesHash.containsKey(r)&&this.uniqueShadingFormat.propertiesHash.get(r)===i)return;this.uniqueShadingFormat=e.uniqueShadingFormats.updateUniqueFormat(this.uniqueShadingFormat,t,i)}},e.getPropertyDefaultValue=function(e){var t=void 0;switch(e){case"backgroundColor":case"foregroundColor":t="empty";break;case"textureStyle":t="TextureNone"}return t},e.prototype.initializeUniqueShading=function(t,i){var r=new a;this.addUniqueShading("backgroundColor",t,i,r),this.addUniqueShading("foregroundColor",t,i,r),this.addUniqueShading("textureStyle",t,i,r),this.uniqueShadingFormat=e.uniqueShadingFormats.addUniqueFormat(r,e.uniqueFormatType)},e.prototype.addUniqueShading=function(t,i,r,n){var o=l.getPropertyType(e.uniqueFormatType,t);t===i?n.add(o,r):n.add(o,e.getPropertyDefaultValue(t))},e.prototype.destroy=function(){sf.base.isNullOrUndefined(this.uniqueShadingFormat)||e.uniqueShadingFormats.remove(this.uniqueShadingFormat),this.uniqueShadingFormat=void 0},e.prototype.cloneFormat=function(){var t=new e(void 0);return t.backgroundColor=this.backgroundColor,t.foregroundColor=this.foregroundColor,t.textureStyle=this.textureStyle,t},e.prototype.copyFormat=function(e){sf.base.isNullOrUndefined(e)||sf.base.isNullOrUndefined(e.uniqueShadingFormat)||(this.backgroundColor=e.backgroundColor,this.foregroundColor=e.foregroundColor,this.textureStyle=e.textureStyle)},e.prototype.hasValue=function(e){if(!sf.base.isNullOrUndefined(this.uniqueShadingFormat)){var t=l.getPropertyType(this.uniqueShadingFormat.uniqueFormatType,e);return this.uniqueShadingFormat.propertiesHash.containsKey(t)}return!1},e.clear=function(){this.uniqueShadingFormats.clear()},e.uniqueShadingFormats=new h,e.uniqueFormatType=5,e}(),vt=function(){function e(e){this.uniqueTableFormat=void 0,this.borders=new u(this),this.shading=new yt(this),this.ownerBase=void 0,this._styleName=void 0,this.ownerBase=e,this.assignTableMarginValue(5.4,0,5.4,0)}return Object.defineProperty(e.prototype,"allowAutoFit",{get:function(){return this.getPropertyValue("allowAutoFit")},set:function(e){this.setPropertyValue("allowAutoFit",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"cellSpacing",{get:function(){return this.getPropertyValue("cellSpacing")},set:function(e){if(e<0||e>264.6)throw new RangeError("The measurement must be between 0 px and 264.6 px.");this.setPropertyValue("cellSpacing",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bottomMargin",{get:function(){return this.getPropertyValue("bottomMargin")},set:function(e){this.setPropertyValue("bottomMargin",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tableAlignment",{get:function(){return this.getPropertyValue("tableAlignment")},set:function(e){this.setPropertyValue("tableAlignment",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"leftMargin",{get:function(){return this.getPropertyValue("leftMargin")},set:function(e){this.setPropertyValue("leftMargin",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"topMargin",{get:function(){return this.getPropertyValue("topMargin")},set:function(e){this.setPropertyValue("topMargin",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rightMargin",{get:function(){return this.getPropertyValue("rightMargin")},set:function(e){this.setPropertyValue("rightMargin",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"leftIndent",{get:function(){return this.getPropertyValue("leftIndent")},set:function(e){if(e<-1440||e>1440)throw new RangeError("The measurement must be between -1440 px and 1440 px.");this.setPropertyValue("leftIndent",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"preferredWidth",{get:function(){return this.getPropertyValue("preferredWidth")},set:function(e){this.setPropertyValue("preferredWidth",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"preferredWidthType",{get:function(){return this.getPropertyValue("preferredWidthType")},set:function(e){this.setPropertyValue("preferredWidthType",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bidi",{get:function(){return this.getPropertyValue("bidi")},set:function(e){this.setPropertyValue("bidi",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"horizontalPositionAbs",{get:function(){return this.getPropertyValue("horizontalPositionAbs")},set:function(e){this.setPropertyValue("horizontalPositionAbs",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"horizontalPosition",{get:function(){return this.getPropertyValue("horizontalPosition")},set:function(e){this.setPropertyValue("horizontalPosition",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"styleName",{get:function(){return this._styleName},set:function(e){this._styleName=e},enumerable:!0,configurable:!0}),e.prototype.getPropertyValue=function(t){if(this.hasValue(t)){var i=l.getPropertyType(e.uniqueFormatType,t);if(!sf.base.isNullOrUndefined(this.uniqueTableFormat)&&this.uniqueTableFormat.propertiesHash.containsKey(i))return this.uniqueTableFormat.propertiesHash.get(i)}return e.getPropertyDefaultValue(t)},e.prototype.setPropertyValue=function(t,i){if((sf.base.isNullOrUndefined(i)||""===i)&&(i=e.getPropertyDefaultValue(t)),sf.base.isNullOrUndefined(this.uniqueTableFormat))this.initializeUniqueTableFormat(t,i);else{var r=l.getPropertyType(this.uniqueTableFormat.uniqueFormatType,t);if(this.uniqueTableFormat.propertiesHash.containsKey(r)&&this.uniqueTableFormat.propertiesHash.get(r)===i)return;this.uniqueTableFormat=e.uniqueTableFormats.updateUniqueFormat(this.uniqueTableFormat,t,i)}},e.prototype.initializeUniqueTableFormat=function(t,i){var r=new a;this.addUniqueTableFormat("allowAutoFit",t,i,r),this.addUniqueTableFormat("cellSpacing",t,i,r),this.addUniqueTableFormat("leftMargin",t,i,r),this.addUniqueTableFormat("topMargin",t,i,r),this.addUniqueTableFormat("bottomMargin",t,i,r),this.addUniqueTableFormat("rightMargin",t,i,r),this.addUniqueTableFormat("leftIndent",t,i,r),this.addUniqueTableFormat("tableAlignment",t,i,r),this.addUniqueTableFormat("preferredWidth",t,i,r),this.addUniqueTableFormat("preferredWidthType",t,i,r),this.addUniqueTableFormat("bidi",t,i,r),this.addUniqueTableFormat("horizontalPositionAbs",t,i,r),this.addUniqueTableFormat("horizontalPosition",t,i,r),this.uniqueTableFormat=e.uniqueTableFormats.addUniqueFormat(r,e.uniqueFormatType)},e.prototype.addUniqueTableFormat=function(t,i,r,n){var o;o=l.getPropertyType(e.uniqueFormatType,t),t===i&&n.add(o,r)},e.getPropertyDefaultValue=function(e){var t=void 0;switch(e){case"allowAutoFit":t=!1;break;case"cellSpacing":t=0;break;case"leftMargin":t=5.4;break;case"topMargin":case"bottomMargin":t=0;break;case"rightMargin":t=5.4;break;case"leftIndent":t=0;break;case"tableAlignment":t="Left";break;case"preferredWidth":t=0;break;case"preferredWidthType":t="Point";break;case"bidi":t=!1;break;case"horizontalPositionAbs":t=null;break;case"horizontalPosition":t=0}return t},e.prototype.assignTableMarginValue=function(e,t,i,r){this.leftMargin=e,this.topMargin=t,this.rightMargin=i,this.bottomMargin=r},e.prototype.initializeTableBorders=function(){this.borders.left.lineStyle="Single",this.borders.left.lineWidth=.5,this.borders.right.lineStyle="Single",this.borders.right.lineWidth=.5,this.borders.top.lineStyle="Single",this.borders.top.lineWidth=.5,this.borders.bottom.lineStyle="Single",this.borders.bottom.lineWidth=.5,this.borders.horizontal.lineStyle="Single",this.borders.horizontal.lineWidth=.5,this.borders.vertical.lineStyle="Single",this.borders.vertical.lineWidth=.5},e.prototype.destroy=function(){sf.base.isNullOrUndefined(this.borders)||this.borders.destroy(),sf.base.isNullOrUndefined(this.shading)||this.shading.destroy(),sf.base.isNullOrUndefined(this.uniqueTableFormat)||e.uniqueTableFormats.remove(this.uniqueTableFormat),this.uniqueTableFormat=void 0,this.borders=void 0,this.shading=void 0},e.prototype.cloneFormat=function(){var t=new e(void 0);return t.leftIndent=this.leftIndent,t.tableAlignment=this.tableAlignment,t.cellSpacing=this.cellSpacing,t.leftMargin=this.leftMargin,t.rightMargin=this.rightMargin,t.topMargin=this.topMargin,t.bottomMargin=this.bottomMargin,t.preferredWidth=this.preferredWidth,t.preferredWidthType=this.preferredWidthType,t.horizontalPositionAbs=this.horizontalPositionAbs,t.horizontalPosition=this.horizontalPosition,t.borders=sf.base.isNullOrUndefined(this.borders)?void 0:this.borders.cloneFormat(),t.shading=sf.base.isNullOrUndefined(this.shading)?void 0:this.shading.cloneFormat(),t.bidi=this.bidi,t.allowAutoFit=this.allowAutoFit,t.styleName=this.styleName,t},e.prototype.hasValue=function(e){if(!sf.base.isNullOrUndefined(this.uniqueTableFormat)){var t=l.getPropertyType(this.uniqueTableFormat.uniqueFormatType,e);return this.uniqueTableFormat.propertiesHash.containsKey(t)}return!1},e.prototype.copyFormat=function(e){sf.base.isNullOrUndefined(e)||(sf.base.isNullOrUndefined(e.uniqueTableFormat)||(this.cellSpacing=e.cellSpacing,this.leftMargin=e.leftMargin,this.topMargin=e.topMargin,this.rightMargin=e.rightMargin,this.bottomMargin=e.bottomMargin,this.leftIndent=e.leftIndent,this.tableAlignment=e.tableAlignment,this.preferredWidth=e.preferredWidth,this.preferredWidthType=e.preferredWidthType,this.bidi=e.bidi,this.allowAutoFit=e.allowAutoFit,this.horizontalPosition=e.horizontalPosition,this.horizontalPositionAbs=e.horizontalPositionAbs,this.styleName=e.styleName),sf.base.isNullOrUndefined(e.borders)||(this.borders=new u(this),this.borders.copyFormat(e.borders)),sf.base.isNullOrUndefined(e.shading)||(this.shading=new yt(this),this.shading.copyFormat(e.shading)))},e.clear=function(){this.uniqueTableFormats.clear()},e.uniqueTableFormats=new h,e.uniqueFormatType=8,e}(),bt=function(){function e(e){this.uniqueCellFormat=void 0,this.borders=new u(this),this.shading=new yt(this),this.ownerBase=e,this.borders=new u(this),this.shading=new yt(this)}return Object.defineProperty(e.prototype,"leftMargin",{get:function(){return this.getPropertyValue("leftMargin")},set:function(e){this.setPropertyValue("leftMargin",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rightMargin",{get:function(){return this.getPropertyValue("rightMargin")},set:function(e){this.setPropertyValue("rightMargin",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"topMargin",{get:function(){return this.getPropertyValue("topMargin")},set:function(e){this.setPropertyValue("topMargin",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bottomMargin",{get:function(){return this.getPropertyValue("bottomMargin")},set:function(e){this.setPropertyValue("bottomMargin",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"cellWidth",{get:function(){return this.getPropertyValue("cellWidth")},set:function(e){this.setPropertyValue("cellWidth",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"columnSpan",{get:function(){return this.getPropertyValue("columnSpan")},set:function(e){this.setPropertyValue("columnSpan",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rowSpan",{get:function(){return this.getPropertyValue("rowSpan")},set:function(e){this.setPropertyValue("rowSpan",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"preferredWidth",{get:function(){return this.getPropertyValue("preferredWidth")},set:function(e){this.setPropertyValue("preferredWidth",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"verticalAlignment",{get:function(){return this.getPropertyValue("verticalAlignment")},set:function(e){this.setPropertyValue("verticalAlignment",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"preferredWidthType",{get:function(){return this.getPropertyValue("preferredWidthType")},set:function(e){this.setPropertyValue("preferredWidthType",e)},enumerable:!0,configurable:!0}),e.prototype.getPropertyValue=function(t){if(this.hasValue(t)){var i=l.getPropertyType(e.uniqueFormatType,t);if(!sf.base.isNullOrUndefined(this.uniqueCellFormat)&&this.uniqueCellFormat.propertiesHash.containsKey(i))return this.uniqueCellFormat.propertiesHash.get(i)}return e.getPropertyDefaultValue(t)},e.prototype.setPropertyValue=function(t,i){if((sf.base.isNullOrUndefined(i)||""===i)&&(i=e.getPropertyDefaultValue(t)),sf.base.isNullOrUndefined(this.uniqueCellFormat))this.initializeUniqueCellFormat(t,i);else{var r=l.getPropertyType(this.uniqueCellFormat.uniqueFormatType,t);if(this.uniqueCellFormat.propertiesHash.containsKey(r)&&this.uniqueCellFormat.propertiesHash.get(r)===i)return;this.uniqueCellFormat=e.uniqueCellFormats.updateUniqueFormat(this.uniqueCellFormat,t,i)}},e.prototype.initializeUniqueCellFormat=function(t,i){var r=new a;this.addUniqueCellFormat("leftMargin",t,i,r),this.addUniqueCellFormat("topMargin",t,i,r),this.addUniqueCellFormat("bottomMargin",t,i,r),this.addUniqueCellFormat("rightMargin",t,i,r),this.addUniqueCellFormat("cellWidth",t,i,r),this.addUniqueCellFormat("columnSpan",t,i,r),this.addUniqueCellFormat("rowSpan",t,i,r),this.addUniqueCellFormat("preferredWidth",t,i,r),this.addUniqueCellFormat("verticalAlignment",t,i,r),this.addUniqueCellFormat("preferredWidthType",t,i,r),this.uniqueCellFormat=e.uniqueCellFormats.addUniqueFormat(r,e.uniqueFormatType)},e.prototype.addUniqueCellFormat=function(t,i,r,n){var o=l.getPropertyType(e.uniqueFormatType,t);t===i&&n.add(o,r)},e.getPropertyDefaultValue=function(e){var t=void 0;switch(e){case"leftMargin":case"topMargin":case"bottomMargin":case"rightMargin":t=void 0;break;case"cellWidth":t=0;break;case"columnSpan":case"rowSpan":t=1;break;case"preferredWidth":t=0;break;case"verticalAlignment":t="Top";break;case"preferredWidthType":t="Point"}return t},e.prototype.containsMargins=function(){return!(sf.base.isNullOrUndefined(this.leftMargin)&&sf.base.isNullOrUndefined(this.rightMargin)&&sf.base.isNullOrUndefined(this.bottomMargin)&&sf.base.isNullOrUndefined(this.topMargin))},e.prototype.destroy=function(){sf.base.isNullOrUndefined(this.borders)||this.borders.destroy(),sf.base.isNullOrUndefined(this.shading)||this.shading.destroy(),sf.base.isNullOrUndefined(this.uniqueCellFormat)||e.uniqueCellFormats.remove(this.uniqueCellFormat),this.uniqueCellFormat=void 0,this.borders=void 0,this.shading=void 0},e.prototype.cloneFormat=function(){var t=new e(void 0);return t.verticalAlignment=this.verticalAlignment,t.leftMargin=this.leftMargin,t.rightMargin=this.rightMargin,t.topMargin=this.topMargin,t.bottomMargin=this.bottomMargin,t.preferredWidth=this.preferredWidth,t.preferredWidthType=this.preferredWidthType,t.cellWidth=this.cellWidth,t.borders=sf.base.isNullOrUndefined(this.borders)?void 0:this.borders.cloneFormat(),t.shading=sf.base.isNullOrUndefined(this.shading)?void 0:this.shading.cloneFormat(),t},e.prototype.hasValue=function(e){if(!sf.base.isNullOrUndefined(this.uniqueCellFormat)){var t=l.getPropertyType(this.uniqueCellFormat.uniqueFormatType,e);return this.uniqueCellFormat.propertiesHash.containsKey(t)}return!1},e.prototype.copyFormat=function(e){sf.base.isNullOrUndefined(e)||(sf.base.isNullOrUndefined(e.uniqueCellFormat)||(this.cellWidth=e.cellWidth,this.leftMargin=e.leftMargin,this.topMargin=e.topMargin,this.rightMargin=e.rightMargin,this.bottomMargin=e.bottomMargin,this.preferredWidth=e.preferredWidth,this.columnSpan=e.columnSpan,this.rowSpan=e.rowSpan,this.preferredWidthType=e.preferredWidthType,this.verticalAlignment=e.verticalAlignment),sf.base.isNullOrUndefined(e.shading)||(this.shading=new yt(this),this.shading.copyFormat(e.shading)),sf.base.isNullOrUndefined(e.borders)||(this.borders=new u(this),this.borders.copyFormat(e.borders)))},e.clear=function(){this.uniqueCellFormats.clear()},e.uniqueCellFormats=new h,e.uniqueFormatType=4,e}(),wt=function(){function e(e){this.documentHelper=void 0,this.commentStarts=void 0,this.commentEnds=void 0,this.commentsCollection=void 0,this.revisionCollection=void 0,this.isPageBreakInsideTable=!1,this.referedRevisions=[],this.isParseHeader=!1,this.footnotes=void 0,this.endnotes=void 0,this.themes=void 0,this.isCutPerformed=!1,this.isPaste=!1,this.isHtmlPaste=!1,this.isExternalImageReference=!1,this.documentHelper=e,this.editableRanges=new a}return Object.defineProperty(e.prototype,"isPasting",{get:function(){return this.viewer&&this.viewer.owner.isPastingContent},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"viewer",{get:function(){return this.documentHelper.owner.viewer},enumerable:!0,configurable:!0}),e.prototype.convertJsonToDocument=function(e){this.commentStarts=new a,this.commentEnds=new a,this.commentsCollection=new a,this.revisionCollection=new a,this.referedRevisions=[],this.images=void 0,this.footnotes=new xe,this.endnotes=new xe;var t=[],i=e;i=i instanceof Object?i:JSON.parse(i);var r=sf.base.isNullOrUndefined(i.characterFormat)?this.viewer.owner.characterFormat:i.characterFormat;this.parseCharacterFormat(r,this.documentHelper.characterFormat);var n=sf.base.isNullOrUndefined(i.paragraphFormat)?this.viewer.owner.paragraphFormat:i.paragraphFormat;return this.parseParagraphFormat(n,this.documentHelper.paragraphFormat),sf.base.isNullOrUndefined(i.themeFontLanguages)||this.parseCharacterFormat(i.themeFontLanguages,this.documentHelper.themeFontLanguage),this.parseDocumentProtection(i),sf.base.isNullOrUndefined(i.images)||(this.images=i.images),sf.base.isNullOrUndefined(i.defaultTabWidth)||(this.documentHelper.defaultTabWidth=i.defaultTabWidth),sf.base.isNullOrUndefined(i.trackChanges)||(this.documentHelper.owner.showRevisions=i.trackChanges,this.documentHelper.owner.enableTrackChanges=i.trackChanges),sf.base.isNullOrUndefined(i.dontUseHTMLParagraphAutoSpacing)||(this.documentHelper.dontUseHtmlParagraphAutoSpacing=i.dontUseHTMLParagraphAutoSpacing),sf.base.isNullOrUndefined(i.alignTablesRowByRow)||(this.documentHelper.alignTablesRowByRow=i.alignTablesRowByRow),sf.base.isNullOrUndefined(i.background)||(this.documentHelper.backgroundColor=this.getColor(i.background.color)),sf.base.isNullOrUndefined(i.compatibilityMode)||(this.documentHelper.compatibilityMode=i.compatibilityMode,sf.base.isNullOrUndefined(this.documentHelper.owner.documentSettings)||(this.documentHelper.owner.documentSettings.compatibilityMode=i.compatibilityMode)),sf.base.isNullOrUndefined(i.abstractLists)||this.parseAbstractList(i,this.documentHelper.abstractLists),sf.base.isNullOrUndefined(i.lists)||this.parseList(i,this.documentHelper.lists),sf.base.isNullOrUndefined(i.styles)||this.parseStyles(i,this.documentHelper.styles),sf.base.isNullOrUndefined(i.comments)||this.parseComments(i,this.documentHelper.comments),sf.base.isNullOrUndefined(i.revisions)||this.parseRevisions(i,this.viewer.owner.revisionsInternal.changes),sf.base.isNullOrUndefined(i.sections)||this.parseSections(i.sections,t),sf.base.isNullOrUndefined(i.customXml)||this.parseCustomXml(i),sf.base.isNullOrUndefined(i.formFieldShading)||(this.documentHelper.owner.documentEditorSettings.formFieldSettings.applyShading=i.formFieldShading),sf.base.isNullOrUndefined(i.footnotes)||this.parseFootnotes(i.footnotes,this.documentHelper.footnotes),sf.base.isNullOrUndefined(i.endnotes)||this.parseEndtnotes(i.endnotes,this.documentHelper.endnotes),sf.base.isNullOrUndefined(i.themes)||this.parseThemes(i.themes,this.documentHelper.themes),this.generalizeRevisions(),t},e.prototype.generalizeRevisions=function(){var e=this,t=new a,i=[];this.referedRevisions.forEach((function(r){var n=e.documentHelper.revisionsInternal.get(r);-1===i.indexOf(n)&&(i.push(n),t.add(r,n))})),this.viewer.owner.revisionsInternal.changes=i,this.documentHelper.revisionsInternal=t},e.prototype.parseFootnotes=function(e,t){sf.base.isNullOrUndefined(e.separator)||this.parseBody(e.separator,t.separator),sf.base.isNullOrUndefined(e.continuationNotice)||this.parseBody(e.continuationNotice,t.continuationNotice),sf.base.isNullOrUndefined(e.continuationSeparator)||this.parseBody(e.continuationSeparator,t.continuationSeparator)},e.prototype.parseEndtnotes=function(e,t){sf.base.isNullOrUndefined(e.separator)||this.parseBody(e.separator,t.separator),sf.base.isNullOrUndefined(e.continuationNotice)||this.parseBody(e.continuationNotice,t.continuationNotice),sf.base.isNullOrUndefined(e.continuationSeparator)||this.parseBody(e.continuationSeparator,t.continuationSeparator)},e.prototype.parseCustomXml=function(e){for(var t=0;t<e.customXml.length;t++){var i=e.customXml[t];this.revisionCollection.containsKey(i.itemID)||this.documentHelper.customXmlData.add(i.itemID,i.xml)}},e.prototype.parseDocumentProtection=function(e){sf.base.isNullOrUndefined(e.formatting)||(this.documentHelper.restrictFormatting=e.formatting),sf.base.isNullOrUndefined(e.enforcement)||(this.documentHelper.isDocumentProtected=e.enforcement),sf.base.isNullOrUndefined(e.protectionType)||(this.documentHelper.protectionType=e.protectionType),sf.base.isNullOrUndefined(e.hashValue)||(this.documentHelper.hashValue=e.hashValue),sf.base.isNullOrUndefined(e.saltValue)||(this.documentHelper.saltValue=e.saltValue)},e.prototype.parseStyles=function(e,t){for(var i=0;i<e.styles.length;i++)sf.base.isNullOrUndefined(this.documentHelper.styles.findByName(e.styles[i].name))&&this.parseStyle(e,e.styles[i],t)},e.prototype.parseRevisions=function(e,t){for(var i=0;i<e.revisions.length;i++){var r=e.revisions[i];if(!sf.base.isNullOrUndefined(r.revisionId)&&!sf.base.isNullOrUndefined(r.revisionType)){var n=this.parseRevision(r),o=!0;if(!this.documentHelper.owner.sfdtExportModule.copyWithTrackChange&&this.isPaste){if("Insertion"===r.revisionType&&this.isPaste&&this.documentHelper.owner.enableTrackChanges)continue;this.revisionCollection.containsKey(r.revisionId)||this.revisionCollection.add(r.revisionId,n)}else this.revisionCollection.add(r.revisionId,n);for(var s=0;s<t.length;s++)t[s].revisionID===n.revisionID&&(o=!1);o&&t.push(n)}}this.documentHelper.revisionsInternal=this.revisionCollection,this.documentHelper.owner.sfdtExportModule&&(this.documentHelper.owner.sfdtExportModule.copyWithTrackChange=!1)},e.prototype.parseRevision=function(e){if(!sf.base.isNullOrUndefined(e)){var t=new O(this.viewer.owner,e.author,e.date);return t.revisionID=e.revisionId,t.revisionType=e.revisionType,t}},e.prototype.checkAndApplyRevision=function(e,t){if(!sf.base.isNullOrUndefined(e.revisionIds)&&e.revisionIds.length>0)for(var i=0;i<e.revisionIds.length;i++){var r=e.revisionIds[i];if(this.revisionCollection.containsKey(r)){this.referedRevisions.push(r);var n=this.revisionCollection.get(r);t instanceof ct||n.range.push(t),t.revisions.push(n)}}},e.prototype.parseComments=function(e,t){for(var i=0,r=0;r<e.comments.length;r++){var n=e.comments[r],o=void 0;for(o=this.parseComment(n,o);i<n.replyComments.length;){var s=void 0;(s=this.parseComment(n.replyComments[i],s)).ownerComment=o,s.isReply=!0,o.replyComments.push(s),this.commentsCollection.add(s.commentId,s),i++}this.commentsCollection.add(o.commentId,o),t.push(o),i=0}},e.prototype.parseComment=function(e,t){return(t=new ot(e.date)).author=e.author,t.initial=e.initial,t.commentId=e.commentId,t.isResolved=e.done,t.text=this.parseCommentText(e.blocks),t},e.prototype.parseCommentText=function(e){for(var t="",i=0;i<e.length;i++){0!==i&&(t+="\n");for(var r=0;r<e[i].inlines.length;r++)t+=e[i].inlines[r].text}return t},e.prototype.parseStyle=function(e,t,i){var r;if(!sf.base.isNullOrUndefined(t.type)){if("Paragraph"===t.type&&((r=new gt).type="Paragraph"),"Character"===t.type&&((r=new ft).type="Character"),sf.base.isNullOrUndefined(t.name)||(r.name=t.name),i.push(r),!sf.base.isNullOrUndefined(t.basedOn)){var n=i.findByName(t.basedOn);if(sf.base.isNullOrUndefined(n)){var o=this.getStyle(t.basedOn,e),s=void 0;s=sf.base.isNullOrUndefined(o)||o.type!==r.type?"Paragraph"===r.type?JSON.parse('{"type":"Paragraph","name":"Normal","next":"Normal"}'):JSON.parse('{"type": "Character","name": "Default Paragraph Font"}'):o,this.parseStyle(e,s,i),r.basedOn=i.findByName(s.name)}else n.type===r.type&&(r.basedOn=n)}if(!sf.base.isNullOrUndefined(t.link)){var a=i.findByName(t.link),l=this.getStyle(t.link,e);s=void 0;if(sf.base.isNullOrUndefined(a)){if(sf.base.isNullOrUndefined(l)){var h={};h.characterFormat=t.characterFormat,h.name=t.name+" Char",h.type="Character",h.basedOn="Normal"===t.basedOn?"Default Paragraph Font":t.basedOn+" Char",s=h}else s=l;this.parseStyle(e,s,i),r.link=sf.base.isNullOrUndefined(i.findByName(s.name))?t.link:i.findByName(s.name)}else r.link=a}if(sf.base.isNullOrUndefined(t.characterFormat)||this.parseCharacterFormat(t.characterFormat,r.characterFormat),sf.base.isNullOrUndefined(t.paragraphFormat)||this.parseParagraphFormat(t.paragraphFormat,r.paragraphFormat),!sf.base.isNullOrUndefined(t.next))if(t.next===t.name)r.next=r;else{var d=i.findByName(t.next);if(sf.base.isNullOrUndefined(d)||d.type!==r.type){var c=this.getStyle(t.next,e);sf.base.isNullOrUndefined(c)?r.next=r:(this.parseStyle(e,c,i),r.next=i.findByName(c.name))}else r.next=d}}},e.prototype.getStyle=function(e,t){for(var i=0;i<t.styles.length;i++)if(t.styles[i].name===e)return t.styles[i]},e.prototype.parseAbstractList=function(e,t){for(var i=0;i<e.abstractLists.length;i++){var r=new S,n=e.abstractLists[i];if(t.push(r),!sf.base.isNullOrUndefined(n)&&(sf.base.isNullOrUndefined(n.abstractListId)||(r.abstractListId=n.abstractListId),!sf.base.isNullOrUndefined(n.levels)))for(var o=0;o<n.levels.length;o++){var s=n.levels[o];if(!sf.base.isNullOrUndefined(s)){var a=this.parseListLevel(s,r);r.levels.push(a)}}}},e.prototype.parseListLevel=function(e,t){var i=new A(t);return"Bullet"===e.listLevelPattern?(i.listLevelPattern="Bullet",i.numberFormat=sf.base.isNullOrUndefined(e.numberFormat)?"":e.numberFormat):(i.listLevelPattern=e.listLevelPattern,i.startAt=e.startAt,i.numberFormat=sf.base.isNullOrUndefined(e.numberFormat)?"":e.numberFormat,e.restartLevel>=0?i.restartLevel=e.restartLevel:i.restartLevel=e.levelNumber),i.followCharacter=e.followCharacter,this.parseCharacterFormat(e.characterFormat,i.characterFormat),this.parseParagraphFormat(e.paragraphFormat,i.paragraphFormat),i},e.prototype.parseList=function(e,t){for(var i=0;i<e.lists.length;i++){var r=new f,n=e.lists[i];sf.base.isNullOrUndefined(n.abstractListId)||(r.abstractListId=n.abstractListId,r.abstractList=this.documentHelper.getAbstractListById(n.abstractListId)),t.push(r),sf.base.isNullOrUndefined(n.listId)||(r.listId=n.listId),n.hasOwnProperty("levelOverrides")&&this.parseLevelOverride(n.levelOverrides,r)}},e.prototype.parseLevelOverride=function(e,t){if(!sf.base.isNullOrUndefined(e))for(var i=0;i<e.length;i++){var r=new g,n=e[i];r.startAt=n.startAt,r.levelNumber=n.levelNumber,sf.base.isNullOrUndefined(n.overrideListLevel)||(r.overrideListLevel=this.parseListLevel(n.overrideListLevel,r)),t.levelOverrides.push(r)}},e.prototype.parseSections=function(e,t){for(var i=0;i<e.length;i++){var r=new ne;r.sectionFormat=new d(r),r.index=i;var n=e[i];sf.base.isNullOrUndefined(n.sectionFormat)||this.parseSectionFormat(n.sectionFormat,r.sectionFormat),sf.base.isNullOrUndefined(n.headersFooters)&&(n.headersFooters={}),this.documentHelper.headersFooters.push(this.parseHeaderFooter(n.headersFooters,this.documentHelper.headersFooters)),this.isParseHeader=!1,this.parseTextBody(n.blocks,r,i+1<e.length);for(var o=0;o<r.childWidgets.length;o++)r.childWidgets[o].containerWidget=r;t.push(r)}},e.prototype.parseHeaderFooter=function(e,t){this.isParseHeader=!0;var i={};if(!sf.base.isNullOrUndefined(e.header)){var r=new oe("OddHeader");i[0]=r,this.parseTextBody(e.header.blocks,r)}if(!sf.base.isNullOrUndefined(e.footer)){var n=new oe("OddFooter");i[1]=n,this.parseTextBody(e.footer.blocks,n)}if(!sf.base.isNullOrUndefined(e.evenHeader)){var o=new oe("EvenHeader");i[2]=o,this.parseTextBody(e.evenHeader.blocks,o)}if(!sf.base.isNullOrUndefined(e.evenFooter)){var s=new oe("EvenFooter");i[3]=s,this.parseTextBody(e.evenFooter.blocks,s)}if(!sf.base.isNullOrUndefined(e.firstPageHeader)){var a=new oe("FirstPageHeader");i[4]=a,this.parseTextBody(e.firstPageHeader.blocks,a)}if(!sf.base.isNullOrUndefined(e.firstPageFooter)){var l=new oe("FirstPageFooter");i[5]=l,this.parseTextBody(e.firstPageFooter.blocks,l)}return i},e.prototype.parseTextBody=function(e,t,i){this.parseBody(e,t.childWidgets,t,i)},e.prototype.addCustomStyles=function(e){if(!sf.base.isNullOrUndefined(e.styles))for(var t=0;t<e.styles.length;t++){void 0===this.documentHelper.styles.findByName(e.styles[t].name)&&this.parseStyle(e,e.styles[t],this.documentHelper.styles)}},e.prototype.parseBody=function(e,t,i,r,n){if(!sf.base.isNullOrUndefined(e))for(var o=0;o<e.length;o++){var s=e[o],a=!1;if(s.hasOwnProperty("inlines")){var l=new le;if(l.characterFormat=new P(l),l.paragraphFormat=new ct(l),s.inlines.length>0&&(a=this.parseParagraph(s.inlines,l,!1)),!r||s!==e[e.length-1]||a){this.parseCharacterFormat(s.characterFormat,l.characterFormat),this.parseParagraphFormat(s.paragraphFormat,l.paragraphFormat);var h,d="Normal";sf.base.isNullOrUndefined(s.paragraphFormat)||sf.base.isNullOrUndefined(s.paragraphFormat.styleName)||(d=s.paragraphFormat.styleName),h=this.documentHelper.styles.findByName(d,"Paragraph"),sf.base.isNullOrUndefined(h)||l.paragraphFormat.applyStyle(h),t.push(l)}else r&&1===e.length&&t.push(l);l.index=t.length-1,l.containerWidget=i}else if(s.hasOwnProperty("rows"))this.parseTable(s,t,t.length,i);else if(s.hasOwnProperty("contentControlProperties")){var c=new Oe("Block"),p=new Oe("Block");this.parseContentControlProperties(s.contentControlProperties,c.contentControlProperties),p.contentControlProperties=c.contentControlProperties,c.type=0,p.type=1,this.parseBody(s.blocks,t,i,r,c.contentControlProperties);for(var u=0;u<2;u++){var g=t.length<s.blocks.length?t[0]:0===u?t[t.length-s.blocks.length]:t[t.length-1],f=void 0;if(g instanceof le)f=g;else if(g instanceof de){if(0===u)f=g.firstChild.firstChild.firstChild;else f=g.lastChild.lastChild.lastChild}if(!sf.base.isNullOrUndefined(f)&&0===f.childWidgets.length){var m=new ue(f);f.childWidgets.push(m)}0===u?(f.firstChild.children.splice(0,0,c),c.line=f.firstChild):(f.lastChild.children.push(p),p.line=f.lastChild)}}sf.base.isNullOrUndefined(n)||(t[t.length-1].contentControlProperties=n)}},e.prototype.parseTable=function(e,t,i,r){var n=new de;n.index=i,sf.base.isNullOrUndefined(e.tableFormat)||this.parseTableFormat(e.tableFormat,n.tableFormat),n.title=e.title,n.description=e.description,this.parseTablePositioning(e,n);for(var o=0;o<e.rows.length;o++){var s=new ce;s.rowFormat=new C(s);var a=e.rows[o];if(sf.base.isNullOrUndefined(a.contentControlProperties)||(s.contentControlProperties=new Te("Row"),this.parseContentControlProperties(a.contentControlProperties,s.contentControlProperties)),a.hasOwnProperty("rowFormat")){this.parseRowFormat(a.rowFormat,s.rowFormat),this.parseRowGridValues(a,s.rowFormat),this.parseRowGridValues(a.rowFormat,s.rowFormat),s.index=o;for(var l=0;l<e.rows[o].cells.length;l++){var h=new pe;h.cellFormat=new bt(h),sf.base.isNullOrUndefined(e.rows[o].cells[l].contentControlProperties)||(h.contentControlProperties=new Te("Cell"),this.parseContentControlProperties(e.rows[o].cells[l].contentControlProperties,h.contentControlProperties)),s.childWidgets.push(h),h.containerWidget=s,h.index=l,h.rowIndex=o,h.columnIndex=l,e.rows[o].cells[l].hasOwnProperty("cellFormat")&&this.parseCellFormat(e.rows[o].cells[l].cellFormat,h.cellFormat);for(var d=e.rows[o].cells[l].blocks,c=0;c<d.length;c++)d[c].hasOwnProperty("rows")&&(n.isContainInsideTable=!0);if(this.isPageBreakInsideTable=!0,this.parseTextBody(e.rows[o].cells[l].blocks,h,!1),!sf.base.isNullOrUndefined(h.contentControlProperties)){var p=new Oe("Cell"),u=new Oe("Cell");if(p.contentControlProperties=h.contentControlProperties,u.contentControlProperties=h.contentControlProperties,p.type=0,u.type=1,0===h.firstChild.childWidgets.length){var g=new ue(h.firstChild);h.firstChild.childWidgets.push(g)}p.line=h.firstChild.firstChild,h.firstChild.firstChild.children.splice(0,0,p),u.line=h.lastChild.lastChild,h.lastChild.lastChild.children.push(u)}if(!sf.base.isNullOrUndefined(s.contentControlProperties))if(s.firstChild===h){var f=new Oe("Row");if(f.contentControlProperties=s.contentControlProperties,f.type=0,0===h.firstChild.childWidgets.length){g=new ue(h.firstChild);h.firstChild.childWidgets.push(g)}f.line=h.firstChild.firstChild,h.firstChild.firstChild.children.splice(0,0,f)}else if(s.lastChild===h){var m=new Oe("Row");if(m.contentControlProperties=s.contentControlProperties,m.type=1,0===h.lastChild.childWidgets.length){g=new ue(h.lastChild);h.lastChild.childWidgets.push(g)}m.line=h.lastChild.lastChild,h.lastChild.lastChild.children.push(m)}this.isPageBreakInsideTable=!1}}n.childWidgets.push(s),s.containerWidget=n}n.containerWidget=r,t.push(n),n.isGridUpdated=!1},e.prototype.parseTablePositioning=function(e,t){t.wrapTextAround=!sf.base.isNullOrUndefined(e.wrapTextAround)&&e.wrapTextAround,t.wrapTextAround&&(t.positioning=new he,t.positioning.allowOverlap=e.positioning.allowOverlap,t.positioning.distanceBottom=x.convertPointToPixel(e.positioning.distanceBottom),t.positioning.distanceLeft=x.convertPointToPixel(e.positioning.distanceLeft),t.positioning.distanceRight=x.convertPointToPixel(e.positioning.distanceRight),t.positioning.distanceTop=x.convertPointToPixel(e.positioning.distanceTop),sf.base.isNullOrUndefined(e.positioning.verticalAlignment)||(t.positioning.verticalAlignment=e.positioning.verticalAlignment),sf.base.isNullOrUndefined(e.positioning.verticalOrigin)||(t.positioning.verticalOrigin=e.positioning.verticalOrigin),t.positioning.verticalPosition=e.positioning.verticalPosition,sf.base.isNullOrUndefined(e.positioning.horizontalAlignment)||(t.positioning.horizontalAlignment=e.positioning.horizontalAlignment),sf.base.isNullOrUndefined(e.positioning.horizontalOrigin)||(t.positioning.horizontalOrigin=e.positioning.horizontalOrigin),t.positioning.horizontalPosition=e.positioning.horizontalPosition)},e.prototype.parseRowGridValues=function(e,t){sf.base.isNullOrUndefined(e.gridBefore)||(t.gridBefore=e.gridBefore),sf.base.isNullOrUndefined(e.gridBeforeWidth)||(t.gridBeforeWidth=e.gridBeforeWidth),sf.base.isNullOrUndefined(e.gridBeforeWidthType)||(t.gridBeforeWidthType=e.gridBeforeWidthType),sf.base.isNullOrUndefined(e.gridAfter)||(t.gridAfter=e.gridAfter),sf.base.isNullOrUndefined(e.gridAfterWidth)||(t.gridAfterWidth=e.gridAfterWidth),sf.base.isNullOrUndefined(e.gridAfterWidthType)||(t.gridAfterWidthType=e.gridAfterWidthType)},e.prototype.parseContentControlProperties=function(e,t){if(sf.base.isNullOrUndefined(e.lockContentControl)||(t.lockContentControl=e.lockContentControl),sf.base.isNullOrUndefined(e.lockContents)||(t.lockContents=e.lockContents),sf.base.isNullOrUndefined(e.tag)||(t.tag=e.tag),sf.base.isNullOrUndefined(e.color)||(t.color=e.color),sf.base.isNullOrUndefined(e.title)||(t.title=e.title),sf.base.isNullOrUndefined(e.appearance)||(t.appearance=e.appearance),sf.base.isNullOrUndefined(e.type)||(t.type=e.type),sf.base.isNullOrUndefined(e.hasPlaceHolderText)||(t.hasPlaceHolderText=e.hasPlaceHolderText),sf.base.isNullOrUndefined(e.multiline)||(t.multiline=e.multiline),sf.base.isNullOrUndefined(e.isTemporary)||(t.isTemporary=e.isTemporary),sf.base.isNullOrUndefined(e.characterFormat)||this.parseCharacterFormat(e.characterFormat,t.characterFormat),"CheckBox"===t.type)sf.base.isNullOrUndefined(e.isChecked)||(t.isChecked=e.isChecked),sf.base.isNullOrUndefined(e.uncheckedState)||(t.uncheckedState=new Ae,t.uncheckedState.font=e.uncheckedState.font,t.uncheckedState.value=e.uncheckedState.value),sf.base.isNullOrUndefined(e.checkedState)||(t.checkedState=new Ae,t.checkedState.font=e.checkedState.font,t.checkedState.value=e.checkedState.value);else if("Date"===t.type)sf.base.isNullOrUndefined(e.dateCalendarType)||(t.dateCalendarType=e.dateCalendarType),sf.base.isNullOrUndefined(e.dateStorageFormat)||(t.dateStorageFormat=e.dateStorageFormat),sf.base.isNullOrUndefined(e.dateDisplayLocale)||(t.dateDisplayLocale=e.dateDisplayLocale),sf.base.isNullOrUndefined(e.dateDisplayFormat)||(t.dateDisplayFormat=e.dateDisplayFormat);else if(("ComboBox"===t.type||"DropDownList"===t.type)&&!sf.base.isNullOrUndefined(e.contentControlListItems))for(var i=0;i<e.contentControlListItems.length;i++){var r=new Pe;r.displayText=e.contentControlListItems[i].displayText,r.value=e.contentControlListItems[i].value,t.contentControlListItems.push(r)}sf.base.isNullOrUndefined(e.xmlMapping)||(t.xmlMapping=new Le,t.xmlMapping.isMapped=e.xmlMapping.isMapped,t.xmlMapping.isWordMl=e.xmlMapping.isWordMl,sf.base.isNullOrUndefined(e.xmlMapping.prefixMapping)||(t.xmlMapping.prefixMapping=e.xmlMapping.prefixMapping),t.xmlMapping.xPath=e.xmlMapping.xPath,t.xmlMapping.storeItemId=e.xmlMapping.storeItemId,sf.base.isNullOrUndefined(e.xmlMapping.customXmlPart)||(t.xmlMapping.customXmlPart=new Fe,t.xmlMapping.customXmlPart.id=e.xmlMapping.customXmlPart.id,t.xmlMapping.customXmlPart.xml=e.xmlMapping.customXmlPart.xml))},e.prototype.parseParagraph=function(e,t,i,r){var n=!1;sf.base.isNullOrUndefined(r)?r=new ue(t):n=!0;for(var o,s=!1,a=this.viewer.owner.enableTrackChanges,l=0;l<e.length;l++){var h=e[l];if(h.hasOwnProperty("text")){var d=void 0;if(this.documentHelper.isPageField)(d=new Ie).fieldBegin=this.documentHelper.fieldStacks[this.documentHelper.fieldStacks.length-1];else if("\t"===h.text)d=new Se;else{if("\f"===h.text&&this.isPageBreakInsideTable)continue;d=new we}if(d.characterFormat=new P(d),this.parseCharacterFormat(h.characterFormat,d.characterFormat,i),this.applyCharacterStyle(h,d),d.text=h.text,this.isHtmlPaste&&d instanceof we){var c=void 0;r.children.length>0&&(c=r.children[r.children.length-1]),this.documentHelper.textHelper.isRTLText(d.text)?(d.characterFormat.bidi=!0,c instanceof we&&" "===c.text&&(c.characterFormat.bidi=!0)):" "===d.text&&c&&c.characterFormat.bidi&&(d.characterFormat.bidi=!0)}if(this.documentHelper.owner.parser.isPaste&&!this.isCutPerformed){if(!sf.base.isNullOrUndefined(h.revisionIds))for(var p=0;p<h.revisionIds.length;p++)if(this.revisionCollection.containsKey(h.revisionIds[p])){if(a&&(o=this.revisionCollection.get(h.revisionIds[p])),!sf.base.isNullOrUndefined(o)&&!sf.base.isNullOrUndefined(r.children[l-1].revisions[p])&&(!a||a&&"Deletion"===o.revisionType)&&o.revisionID===h.revisionIds[p]){h.revisionIds[p]=r.children[l-1].revisions[p].revisionID,this.checkAndApplyRevision(h,d);continue}a||(o=this.documentHelper.revisionsInternal.get(h.revisionIds[p])),this.documentHelper.owner.editorModule.insertRevision(d,o.revisionType,o.author),h.revisionIds[p]=d.revisions[p].revisionID}}else this.checkAndApplyRevision(h,d);d.line=r,r.children.push(d),s=!0}else if(h.hasOwnProperty("footnoteType")){var u=new Me;u.line=r,u.footnoteType=h.footnoteType,"Footnote"===u.footnoteType?this.documentHelper.footnoteCollection.push(u):this.documentHelper.endnoteCollection.push(u),u.symbolCode=h.symbolCode,u.symbolFontName=h.symbolFontName,u.customMarker=h.customMarker,u.characterFormat=new P(u),this.parseCharacterFormat(h.characterFormat,u.characterFormat,i),this.applyCharacterStyle(h,u),this.parseBody(h.blocks,u.bodyWidget.childWidgets,u.bodyWidget,!1),r.children.push(u),s=!0}else if(h.hasOwnProperty("chartType")){this.documentHelper.owner.editor&&(this.documentHelper.owner.editor.chartType=!0);var g=new Be;g.title=h.chartTitle,g.type=h.chartType,g.chartGapWidth=h.gapWidth,g.chartOverlap=h.overlap,this.parseChartTitleArea(h.chartTitleArea,g.chartTitleArea),this.parseChartArea(h.chartArea,g.chartArea),this.parseChartArea(h.plotArea,g.chartPlotArea),this.parseChartLegend(h.chartLegend,g.chartLegend),this.parseChartData(h,g),this.parseChartCategoryAxis(h.chartPrimaryCategoryAxis,g.chartPrimaryCategoryAxis),this.parseChartCategoryAxis(h.chartPrimaryValueAxis,g.chartPrimaryValueAxis),null!=h.chartDataTable&&this.parseChartDataTable(h.chartDataTable,g.chartDataTable),g.line=r,r.children.push(g),g.height=x.convertPointToPixel(h.height),g.width=x.convertPointToPixel(h.width);var f=new sf.officechart.ChartComponent;f.chartRender(h),g.officeChart=f,f.chart.appendTo(g.targetElement),s=!0}else if(h.hasOwnProperty("imageString")){var m=new Re(e[l].isInlineImage);m.isMetaFile=e[l].isMetaFile,m.isCompressed=e[l].isCompressed,m.metaFileImageString=e[l].metaFileImageString,m.characterFormat=new P(m),m.line=r,this.checkAndApplyRevision(h,m),r.children.push(m);var y=h.imageString;!sf.base.isNullOrUndefined(this.images)&&Object.keys(this.images).length>0&&(y=this.images[y]);var v=x.formatClippedString(y).formatClippedString,b=this.validateImageUrl(v);m.imageString=b?y:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAOEAAADhCAMAAAAJbSJIAAAAgVBMVEX///8AAADgAADY2Njl5eVcXFxjY2NZWVl/f3+wsLCmpqb4+PiioqKpqam7u7vV1dX2uLj2wsLhFRXzpKT3vb30sbHhCwv74+P40dH+9vbkIyO2trbBwcHLy8tsbGycnJz529v4zMzrbGzlLS3qZmblNzfrdXXoRkbvi4vvgYHlHh7CZsBOAAADpUlEQVR4nO3da1faQBSF4ekAUQlUEFs14AXxVv7/D6yaQiZx5mSEYXF2ut+PNKzyyK5diYDmR9czx34AB49C/CjE759w3jvvWr15Tdgz3atXE54f++EcIArxoxA/CvGjED8K8aMQPwrxoxA/CvGLEeZ9jPJdhfk4GyCUjb3ECGE/Q6m/q3DwfudjP0ERZYN9hKdn2hvd3+0jHJz5/kBVuTk96bbQUEjhYR9ckiikUH8UUqg/CinUH4UU6o9CCvVHIYX6o5BC/VFIof4opFB/FFKoPwop1B+FFOqPQgrjyxfjVC38Lxk9tnAxGqZqdKtSOE4GHA5/fuNJpDCtcNHbv4VqYYqPLjgfUViPQgrjozA2CptRSGF8/59w+Wrt+rr1btNna1cPzg0wwuXavncxabnX7PfHYYXzlYARvlobQZyUR9mXm+1NMEK7SSLONgcVV9vb8IQXv4J3KSeKKlxXxNCzONkeYp8AV3p9UT1+P3FWHVAsq5thhGZSEb1DrSZq7dS5HUdoLiuBZ6jORG3tCwAkNJfCUJ2Jrqe1P0ESCkMNTdSACYNDDU7UoAkDQw1P1MAJvUMVJmrwhJ6hShM1gMIvQxUnahCFjaHKEzWQQneoxR95ogZTWBuqPFEDKnSHKk/UoArdoYoTNbDC5lBDEzW4QjMpYiZqgIXG/S76JhwHK5zVVipcnkIVuv/RW/HyFKhwYhuFr6NiCmdNoDBUSGFjovJQEYXuRN9ahwoorJ8uSZenPsMTNk+X2q6jwgm/ntHL11HhhL4zenmoYEL/Gb04VCxh6KKTNFQoYfiikzBUJKF00Sk8VCChfF00OFQcYdt10dBQYYRT5xn0n9G7Q0X8GfCzNNEyZ6iPgD/HlydaVg11DfhajJaJlm2HugIUrlomWrYZKuJKHz6vHhbSM/hROdRnxNe1meuXYvW0DB6+aflYrB7dlzDiCM3N1dVN6GDhMCDhjlHYjEIK46MwNgqbUUhhfJ/vA07wO8N1vw94ONo/3e/lTpVOYfc/UyG//ZmqW52fi/FuTNW3/lZ+eguF+qOQQv1RSKH+KKRQfxRSqD8KKdQfhRTqj0IK9UchhfqjkEL9UUih/iikUH8UUqg/CmXh6Hsv3jlK+wnvD/vgkrSHMMuyu1P9ZdmuwnycDQYn+svG3n9KEUKT9zHyf6+IEWJHIX4U4kchfhTiRyF+FOJHIX4U4kchfnVhijeZa6sunCf4ZdPamteEHY5C/CjEr/vCv0ec0g+AtS1QAAAAAElFTkSuQmCC",m.width=x.convertPointToPixel(h.width),m.height=x.convertPointToPixel(h.height),m.top=h.top,m.left=h.left,m.bottom=h.bottom,m.right=h.right,m.cropHeightScale=h.getimageheight,m.cropWidthScale=h.getimagewidth,m.name=h.name,m.alternativeText=h.alternativeText,m.title=h.title,m.visible=h.visible,m.widthScale=h.widthScale,m.heightScale=h.heightScale,m.verticalPosition=x.convertPointToPixel(h.verticalPosition),m.verticalOrigin=h.verticalOrigin,m.verticalAlignment=h.verticalAlignment,m.horizontalPosition=x.convertPointToPixel(h.horizontalPosition),m.horizontalOrigin=h.horizontalOrigin,m.horizontalAlignment=h.horizontalAlignment,m.allowOverlap=h.allowOverlap,m.textWrappingStyle=sf.base.isNullOrUndefined(h.textWrappingStyle)?"Inline":h.textWrappingStyle,m.textWrappingType=h.textWrappingType,m.distanceBottom=x.convertPointToPixel(h.distanceBottom),m.distanceLeft=x.convertPointToPixel(h.distanceLeft),m.distanceRight=x.convertPointToPixel(h.distanceRight),m.distanceTop=x.convertPointToPixel(h.distanceTop),m.zOrderPosition=h.zOrderPosition,m.layoutInCell=h.layoutInCell,(!sf.base.isNullOrUndefined(h.top)&&0!==h.top||!sf.base.isNullOrUndefined(h.bottom)&&0!==h.bottom||!sf.base.isNullOrUndefined(h.left)&&0!==h.left||!sf.base.isNullOrUndefined(h.right)&&0!==h.right)&&(m.isCrop=!0),"Inline"!==m.textWrappingStyle&&t.floatingElements.push(m),this.parseCharacterFormat(h.characterFormat,m.characterFormat),s=!0}else if(h.hasOwnProperty("hasFieldEnd")||h.hasOwnProperty("fieldType")&&0===h.fieldType){var w=new fe(0);if(this.parseCharacterFormat(h.characterFormat,w.characterFormat,i),this.applyCharacterStyle(h,w),w.fieldCodeType=h.fieldCodeType,w.hasFieldEnd=h.hasFieldEnd,h.hasOwnProperty("formFieldData")){var M=void 0;h.formFieldData.hasOwnProperty("textInput")?((M=new ye).type=h.formFieldData.textInput.type,M.maxLength=h.formFieldData.textInput.maxLength,M.defaultValue=h.formFieldData.textInput.defaultValue,M.format=h.formFieldData.textInput.format):h.formFieldData.hasOwnProperty("checkBox")?((M=new ve).sizeType=h.formFieldData.checkBox.sizeType,M.size=h.formFieldData.checkBox.size,M.defaultValue=h.formFieldData.checkBox.defaultValue,M.checked=h.formFieldData.checkBox.checked):((M=new be).dropdownItems=h.formFieldData.dropDownList.dropDownItems,M.selectedIndex=h.formFieldData.dropDownList.selectedIndex),M.name=h.formFieldData.name,M.enabled=h.formFieldData.enabled,M.helpText=h.formFieldData.helpText,M.statusText=h.formFieldData.statusText,w.formFieldData=M,this.documentHelper.formFields.push(w)}this.documentHelper.fieldStacks.push(w),this.checkAndApplyRevision(h,w),w.line=r,this.documentHelper.fields.push(w),r.children.push(w)}else if(h.hasOwnProperty("fieldType")){var N=void 0;if(2===h.fieldType){if(N=new fe(2),this.parseCharacterFormat(h.characterFormat,N.characterFormat,i),this.checkAndApplyRevision(h,N),this.fieldSeparator=N,this.documentHelper.fieldStacks.length>0)if(N.fieldBegin=this.documentHelper.fieldStacks[this.documentHelper.fieldStacks.length-1],N.fieldBegin.fieldSeparator=N,r.children.length>=2){var I=this.containsFieldBegin(r);if(!sf.base.isNullOrUndefined(I)&&I instanceof we&&(I.text.match("PAGE")||I.text.match("page")))I.text.startsWith("HYPERLINK")||(this.documentHelper.isPageField=!0)}}else 1===h.fieldType&&(N=new fe(1),this.parseCharacterFormat(h.characterFormat,N.characterFormat,i),this.applyCharacterStyle(h,N),this.checkAndApplyRevision(h,N),this.documentHelper.fieldStacks.length>0&&(N.fieldBegin=this.documentHelper.fieldStacks[this.documentHelper.fieldStacks.length-1],N.fieldBegin.fieldEnd=N),!sf.base.isNullOrUndefined(N.fieldBegin)&&N.fieldBegin.fieldSeparator&&(N.fieldSeparator=N.fieldBegin.fieldSeparator,N.fieldBegin.fieldSeparator.fieldEnd=N,s=!0),this.documentHelper.fieldStacks.splice(this.documentHelper.fieldStacks.length-1,1),this.fieldSeparator=void 0,this.documentHelper.isPageField=!1,this.documentHelper.fieldCollection.push(N.fieldBegin));N.line=r,r.children.push(N)}else if(h.hasOwnProperty("bookmarkType")){var S=void 0;if((S=new Ce(h.bookmarkType)).name=h.name,this.checkAndApplyRevision(h,S),r.children.push(S),S.line=r,!this.isParseHeader||this.isPaste)if(0===h.bookmarkType){var C=this.isPaste&&!this.documentHelper.bookmarks.containsKey(S.name);!this.isPaste||C?this.documentHelper.bookmarks.add(S.name,S):C||r.children.splice(r.children.indexOf(S),1)}else if(1===h.bookmarkType&&this.documentHelper.bookmarks.containsKey(S.name)){var O=this.documentHelper.bookmarks.get(S.name),T=this.isPaste&&sf.base.isNullOrUndefined(O.reference);!this.isPaste||T?(O.reference=S,S.reference=O):T||r.children.splice(r.children.indexOf(S),1)}0!==S.name.indexOf("_")&&(s=!0)}else if(h.hasOwnProperty("editRangeId")){if(h.hasOwnProperty("editableRangeStart")){var A=new Ue;if(this.editableRanges.containsKey(h.editRangeId)){var L=this.editableRanges.get(h.editRangeId);A.editRangeStart=L,L.editRangeEnd=A,this.editableRanges.remove(h.editRangeId)}r.children.push(A),A.line=r}else{var F=this.parseEditableRangeStart(h);r.children.push(F),F.line=r,this.editableRanges.containsKey(h.editRangeId)||this.editableRanges.add(h.editRangeId,F)}s=!0}else if(h.hasOwnProperty("commentId")&&!this.isPaste){var D=h.commentId,E=void 0;this.commentStarts.containsKey(D)&&this.commentStarts.get(D);if(this.commentEnds.containsKey(D)&&this.commentEnds.get(D),h.hasOwnProperty("commentCharacterType")){if(0===h.commentCharacterType){var z=new nt(0);z.commentId=D,this.commentStarts.containsKey(D)||this.commentStarts.add(D,z),z.line=r,r.children.push(z),E=this.commentsCollection.get(D),sf.base.isNullOrUndefined(E)||(E.commentStart=z,z.comment=E)}else{var k=new nt(1);k.commentId=D,this.commentEnds.containsKey(D)||this.commentEnds.add(D,k),k.line=r,r.children.push(k),E=this.commentsCollection.get(D),sf.base.isNullOrUndefined(E)||(E.commentEnd=k,k.comment=E)}!sf.base.isNullOrUndefined(E)&&E.isReply&&(sf.base.isNullOrUndefined(E.ownerComment.commentStart)&&(E.ownerComment.commentStart=E.commentStart),sf.base.isNullOrUndefined(E.ownerComment.commentEnd)&&(E.ownerComment.commentEnd=E.commentEnd))}}else if(h.hasOwnProperty("shapeId")){var W=new Ee;if(W.shapeId=h.shapeId,W.name=h.name,W.alternativeText=h.alternativeText,W.title=h.title,W.visible=h.visible,W.width=x.convertPointToPixel(h.width),W.height=x.convertPointToPixel(h.height),W.widthScale=h.widthScale,W.heightScale=h.heightScale,W.verticalPosition=x.convertPointToPixel(h.verticalPosition),W.verticalOrigin=h.verticalOrigin,W.verticalAlignment=h.verticalAlignment,W.verticalRelativePercent=h.verticalRelativePercent,W.horizontalPosition=x.convertPointToPixel(h.horizontalPosition),W.horizontalOrigin=h.horizontalOrigin,W.horizontalAlignment=h.horizontalAlignment,W.horizontalRelativePercent=h.horizontalRelativePercent,W.zOrderPosition=h.zOrderPosition,W.allowOverlap=h.allowOverlap,W.textWrappingStyle=sf.base.isNullOrUndefined(h.textWrappingStyle)?"InFrontOfText":h.textWrappingStyle,W.textWrappingType=h.textWrappingType,W.distanceBottom=x.convertPointToPixel(h.distanceBottom),W.distanceLeft=x.convertPointToPixel(h.distanceLeft),W.distanceRight=x.convertPointToPixel(h.distanceRight),W.distanceTop=x.convertPointToPixel(h.distanceTop),W.layoutInCell=h.layoutInCell,W.lockAnchor=h.lockAnchor,W.autoShapeType=h.autoShapeType,h.hasOwnProperty("lineFormat")){var R=new ke;R.line=h.lineFormat.line,R.lineFormatType=h.lineFormat.lineFormatType,R.color=h.lineFormat.color,R.weight=h.lineFormat.weight,R.dashStyle=h.lineFormat.lineStyle,W.lineFormat=R}if(h.hasOwnProperty("fillFormat")){var j=new We;j.color=h.fillFormat.color,j.fill=h.fillFormat.fill,W.fillFormat=j}if(h.hasOwnProperty("textFrame")){var U=new ze;U.textVerticalAlignment=h.textFrame.textVerticalAlignment,U.marginLeft=x.convertPointToPixel(h.textFrame.leftMargin),U.marginRight=x.convertPointToPixel(h.textFrame.rightMargin),U.marginTop=x.convertPointToPixel(h.textFrame.topMargin),U.marginBottom=x.convertPointToPixel(h.textFrame.bottomMargin),this.parseBody(h.textFrame.blocks,U.childWidgets,U),W.textFrame=U,U.containerShape=W}W.line=r,this.checkAndApplyRevision(h,W),r.children.push(W),t.floatingElements.push(W)}else if(h.hasOwnProperty("contentControlProperties")){var H=new Oe("Inline"),B=new Oe("Inline");this.parseContentControlProperties(h.contentControlProperties,H.contentControlProperties),B.contentControlProperties=H.contentControlProperties,H.line=r,B.line=r,H.type=0,B.type=1,r.children.push(H),this.parseParagraph(h.inlines,t,i,r);for(var _=r.children[r.children.length-1];!(_ instanceof Oe);)_.contentControlProperties=H.contentControlProperties,_=_.previousElement;r.children.push(B),s=!0}}return this.isCutPerformed=!1,n||t.childWidgets.push(r),s},e.prototype.applyCharacterStyle=function(e,t){if(!sf.base.isNullOrUndefined(e.characterFormat)&&!sf.base.isNullOrUndefined(e.characterFormat.styleName)){var i=this.documentHelper.styles.findByName(e.characterFormat.styleName,"Character");t.characterFormat.applyStyle(i)}},e.prototype.parseEditableRangeStart=function(e){var t=new He;return sf.base.isNullOrUndefined(e.columnFirst)||(t.columnFirst=e.columnFirst),sf.base.isNullOrUndefined(e.columnLast)||(t.columnLast=e.columnLast),sf.base.isNullOrUndefined(e.user)||(t.user=e.user,-1===this.documentHelper.userCollection.indexOf(t.user)&&this.documentHelper.userCollection.push(t.user),this.addEditRangeCollection(t.user,t)),sf.base.isNullOrUndefined(e.group)||""===e.group||(t.group=e.group,t.group="everyone"===t.group?"Everyone":t.group,-1===this.documentHelper.userCollection.indexOf(t.group)&&this.documentHelper.userCollection.push(t.group),this.addEditRangeCollection(t.group,t)),t},e.prototype.addEditRangeCollection=function(e,t){if(this.documentHelper.editRanges.containsKey(e)){this.documentHelper.editRanges.get(e).push(t)}else{var i=[];i.push(t),this.documentHelper.editRanges.add(e,i)}},e.prototype.parseChartTitleArea=function(e,t){t.chartfontName=e.fontName,t.chartFontSize=e.fontSize,this.parseChartDataFormat(e.dataFormat,t.dataFormat),this.parseChartLayout(e.layout,t.layout)},e.prototype.parseChartDataFormat=function(e,t){t.fill.color=e.fill.foreColor,t.fill.rgb=e.fill.rgb,t.line.color=e.line.color,t.line.rgb=e.line.rgb},e.prototype.parseChartLayout=function(e,t){t.chartLayoutLeft=e.layoutX,t.chartLayoutTop=e.layoutY},e.prototype.parseChartLegend=function(e,t){t.chartLegendPostion=e.position,this.parseChartTitleArea(e.chartTitleArea,t.chartTitleArea)},e.prototype.parseChartCategoryAxis=function(e,t){t.categoryAxisType=e.categoryType,t.categoryNumberFormat=e.numberFormat,t.interval=e.majorUnit,t.axisFontSize=e.fontSize,t.axisFontName=e.fontName,t.max=e.maximumValue,t.min=e.minimumValue,t.majorGridLines=e.hasMajorGridLines,t.minorGridLines=e.hasMinorGridLines,t.majorTick=e.majorTickMark,t.minorTick=e.minorTickMark,t.tickPosition=e.tickLabelPosition,t.categoryAxisTitle=e.chartTitle,null!=e.chartTitle&&this.parseChartTitleArea(e.chartTitleArea,t.chartTitleArea)},e.prototype.parseChartDataTable=function(e,t){t.showSeriesKeys=e.showSeriesKeys,t.hasHorzBorder=e.hasHorzBorder,t.hasVertBorder=e.hasVertBorder,t.hasBorders=e.hasBorders},e.prototype.parseChartArea=function(e,t){t.chartForeColor=e.foreColor},e.prototype.parseChartData=function(e,t){for(var i=0;i<e.chartCategory.length;i++){var r=new Ve,n=e.chartCategory[i];n.hasOwnProperty("categoryXName")&&(r.xName=n.categoryXName);for(var o=0;o<n.chartData.length;o++){var s=new Ye,a=n.chartData[o];s.yAxisValue=a.yValue,"Bubble"===e.chartType&&(s.bubbleSize=a.size),r.chartData.push(s)}t.chartCategory.push(r)}this.parseChartSeries(e,t)},e.prototype.parseChartSeries=function(e,t){for(var i=e.chartType,r="Pie"===i||"Doughnut"===i,n=0;n<e.chartSeries.length;n++){var o=new qe,s=e.chartSeries[n];if(s.hasOwnProperty("seriesName")){if(o.seriesName=s.seriesName,r&&(s.hasOwnProperty("firstSliceAngle")&&(o.firstSliceAngle=s.firstSliceAngle),"Doughnut"===i&&(o.doughnutHoleSize=s.holeSize)),s.hasOwnProperty("dataLabel")&&this.parseChartDataLabels(s.dataLabel,o),s.hasOwnProperty("seriesFormat")){var a=new Xe,l=s.seriesFormat;a.markerStyle=l.markerStyle,a.markerColor=l.markerColor,a.numberValue=l.markerSize,o.seriesFormat=a}if(s.hasOwnProperty("errorBar")){var h=o.errorBar;h.errorType=s.errorBar.type,h.errorDirection=s.errorBar.direction,h.errorEndStyle=s.errorBar.endStyle,h.numberValue=s.errorBar.numberValue}s.hasOwnProperty("trendLines")&&this.parseChartTrendLines(s.trendLines,o),this.parseChartSeriesDataPoints(s.dataPoints,o)}t.chartSeries.push(o)}},e.prototype.parseChartDataLabels=function(e,t){var i=new Ze;i.labelPosition=e.position,i.fontName=e.fontName,i.fontColor=e.fontColor,i.fontSize=e.fontSize,i.isLegendKey=e.isLegendKey,i.isBubbleSize=e.isBubbleSize,i.isCategoryName=e.isCategoryName,i.isSeriesName=e.isSeriesName,i.isValue=e.isValue,i.isPercentage=e.isPercentage,i.isLeaderLines=e.isLeaderLines,t.dataLabels=i},e.prototype.parseChartSeriesDataPoints=function(e,t){for(var i=0;i<e.length;i++){var r=new $e;this.parseChartDataFormat(e[i],r),t.chartDataFormat.push(r)}},e.prototype.parseChartTrendLines=function(e,t){for(var i=0;i<e.length;i++){var r=e[i],n=new Ke;n.trendLineName=r.name,n.trendLineType=r.type,n.forwardValue=r.forward,n.backwardValue=r.backward,n.interceptValue=r.intercept,n.isDisplayEquation=r.isDisplayEquation,n.isDisplayRSquared=r.isDisplayRSquared,t.trendLines.push(n)}},e.prototype.parseTableFormat=function(e,t){this.parseBorders(e.borders,t.borders),sf.base.isNullOrUndefined(e.allowAutoFit)||(t.allowAutoFit=e.allowAutoFit),sf.base.isNullOrUndefined(e.cellSpacing)||(t.cellSpacing=e.cellSpacing),sf.base.isNullOrUndefined(e.leftMargin)||(t.leftMargin=e.leftMargin),sf.base.isNullOrUndefined(e.topMargin)||(t.topMargin=e.topMargin),sf.base.isNullOrUndefined(e.rightMargin)||(t.rightMargin=e.rightMargin),sf.base.isNullOrUndefined(e.bottomMargin)||(t.bottomMargin=e.bottomMargin),sf.base.isNullOrUndefined(e.leftIndent)||(t.leftIndent=e.leftIndent),this.parseShading(e.shading,t.shading),sf.base.isNullOrUndefined(e.tableAlignment)||(t.tableAlignment=e.tableAlignment),sf.base.isNullOrUndefined(e.preferredWidth)||(t.preferredWidth=e.preferredWidth),sf.base.isNullOrUndefined(e.preferredWidthType)||(t.preferredWidthType=e.preferredWidthType),sf.base.isNullOrUndefined(e.bidi)||(t.bidi=e.bidi),sf.base.isNullOrUndefined(e.horizontalPositionAbs)||(t.horizontalPositionAbs=e.horizontalPositionAbs),sf.base.isNullOrUndefined(e.horizontalPosition)||(t.horizontalPosition=e.horizontalPosition),sf.base.isNullOrUndefined(e.styleName)||(t.styleName=e.styleName)},e.prototype.parseCellFormat=function(e,t){sf.base.isNullOrUndefined(e)||(this.parseBorders(e.borders,t.borders),e.isSamePaddingAsTable||this.parseCellMargin(e,t),sf.base.isNullOrUndefined(e.cellWidth)||(t.cellWidth=e.cellWidth),sf.base.isNullOrUndefined(e.columnSpan)||(t.columnSpan=e.columnSpan),sf.base.isNullOrUndefined(e.rowSpan)||(t.rowSpan=e.rowSpan),this.parseShading(e.shading,t.shading),sf.base.isNullOrUndefined(e.verticalAlignment)||(t.verticalAlignment=e.verticalAlignment),sf.base.isNullOrUndefined(e.preferredWidthType)||(t.preferredWidthType=e.preferredWidthType),sf.base.isNullOrUndefined(e.preferredWidth)||(t.preferredWidth=e.preferredWidth))},e.prototype.parseCellMargin=function(e,t){sf.base.isNullOrUndefined(e.leftMargin)||(t.leftMargin=e.leftMargin),sf.base.isNullOrUndefined(e.rightMargin)||(t.rightMargin=e.rightMargin),sf.base.isNullOrUndefined(e.topMargin)||(t.topMargin=e.topMargin),sf.base.isNullOrUndefined(e.bottomMargin)||(t.bottomMargin=e.bottomMargin)},e.prototype.parseRowFormat=function(e,t){sf.base.isNullOrUndefined(e)||(sf.base.isNullOrUndefined(e.allowBreakAcrossPages)||(t.allowBreakAcrossPages=e.allowBreakAcrossPages),sf.base.isNullOrUndefined(e.isHeader)||(t.isHeader=e.isHeader),sf.base.isNullOrUndefined(e.heightType)||(t.heightType=e.heightType),sf.base.isNullOrUndefined(e.height)||(t.height=e.height),sf.base.isNullOrUndefined(e.leftMargin)||(t.leftMargin=e.leftMargin),sf.base.isNullOrUndefined(e.topMargin)||(t.topMargin=e.topMargin),sf.base.isNullOrUndefined(e.rightMargin)||(t.rightMargin=e.rightMargin),sf.base.isNullOrUndefined(e.bottomMargin)||(t.bottomMargin=e.bottomMargin),sf.base.isNullOrUndefined(e.leftIndent)||(t.leftIndent=e.leftIndent),!sf.base.isNullOrUndefined(e.revisionIds)&&e.revisionIds.length>0&&this.checkAndApplyRevision(e,t),this.parseBorders(e.borders,t.borders))},e.prototype.parseBorders=function(e,t){sf.base.isNullOrUndefined(e)||(t.isParsing=!0,this.parseBorder(e.left,t.left),this.parseBorder(e.right,t.right),this.parseBorder(e.top,t.top),this.parseBorder(e.bottom,t.bottom),this.parseBorder(e.vertical,t.vertical),this.parseBorder(e.horizontal,t.horizontal),this.parseBorder(e.diagonalDown,t.diagonalDown),this.parseBorder(e.diagonalUp,t.diagonalUp),t.isParsing=!1)},e.prototype.parseBorder=function(e,t){sf.base.isNullOrUndefined(e)||(sf.base.isNullOrUndefined(e.color)||(t.color=this.getColor(e.color)),sf.base.isNullOrUndefined(e.lineStyle)||(t.lineStyle=e.lineStyle),sf.base.isNullOrUndefined(e.lineWidth)||(t.lineWidth=e.lineWidth),sf.base.isNullOrUndefined(e.hasNoneStyle)||(t.hasNoneStyle=e.hasNoneStyle),sf.base.isNullOrUndefined(e.space)||(t.space=e.space),sf.base.isNullOrUndefined(e.shadow)||(t.shadow=e.shadow))},e.prototype.parseShading=function(e,t){sf.base.isNullOrUndefined(e)||(sf.base.isNullOrUndefined(e.backgroundColor)||(t.backgroundColor=this.getColor(e.backgroundColor)),sf.base.isNullOrUndefined(e.foregroundColor)||(t.foregroundColor=this.getColor(e.foregroundColor)),sf.base.isNullOrUndefined(e.texture)&&sf.base.isNullOrUndefined(e.textureStyle)||(t.textureStyle=sf.base.isNullOrUndefined(e.texture)?e.textureStyle:e.texture))},e.prototype.parseCharacterFormat=function(e,t,i){if(!sf.base.isNullOrUndefined(e)){if(i&&e.hasOwnProperty("inlineFormat"))return void this.parseCharacterFormat(e.inlineFormat,t);if(sf.base.isNullOrUndefined(e.baselineAlignment)||(t.baselineAlignment=e.baselineAlignment),sf.base.isNullOrUndefined(e.underline)||(t.underline=e.underline),sf.base.isNullOrUndefined(e.strikethrough)||(t.strikethrough=e.strikethrough),!sf.base.isNullOrUndefined(e.fontSize)){e.fontSize=parseFloat(e.fontSize);var r=10*e.fontSize;r%10!=0&&(r=10*e.fontSize.toFixed(1),e.fontSize=r%5==0?e.fontSize.toFixed(1):Math.round(e.fontSize));var n=parseFloat(e.fontSize);t.fontSize=n<0?0:n}sf.base.isNullOrUndefined(e.fontFamily)||(-1!==e.fontFamily.indexOf('"')&&(e.fontFamily=e.fontFamily.replace('"',"")),t.fontFamily=e.fontFamily),sf.base.isNullOrUndefined(e.bold)||(t.bold=e.bold),sf.base.isNullOrUndefined(e.italic)||(t.italic=e.italic),sf.base.isNullOrUndefined(e.highlightColor)||(t.highlightColor=e.highlightColor),sf.base.isNullOrUndefined(e.fontColor)||(t.fontColor=this.getColor(e.fontColor)),sf.base.isNullOrUndefined(e.bidi)||(t.bidi=e.bidi),sf.base.isNullOrUndefined(e.bdo)||(t.bdo=e.bdo),sf.base.isNullOrUndefined(e.fontSizeBidi)||(t.fontSizeBidi=e.fontSizeBidi<0?0:e.fontSizeBidi),sf.base.isNullOrUndefined(e.fontFamilyBidi)||(-1!==e.fontFamilyBidi.indexOf('"')&&(e.fontFamilyBidi=e.fontFamilyBidi.replace('"',"")),t.fontFamilyBidi=e.fontFamilyBidi),sf.base.isNullOrUndefined(e.boldBidi)||(t.boldBidi=e.boldBidi),sf.base.isNullOrUndefined(e.italicBidi)||(t.italicBidi=e.italicBidi),!sf.base.isNullOrUndefined(e.revisionIds)&&e.revisionIds.length>0&&this.checkAndApplyRevision(e,t),sf.base.isNullOrUndefined(e.allCaps)||(t.allCaps=e.allCaps),sf.base.isNullOrUndefined(e.localeIdBidi)||(t.localeIdBidi=e.localeIdBidi),sf.base.isNullOrUndefined(e.localeIdAscii)||(t.localeIdAscii=e.localeIdAscii),sf.base.isNullOrUndefined(e.localeIdFarEast)||(t.localeIdFarEast=e.localeIdFarEast),sf.base.isNullOrUndefined(e.complexScript)||(t.complexScript=e.complexScript),sf.base.isNullOrUndefined(e.fontFamilyFarEast)||(-1!==e.fontFamilyFarEast.indexOf('"')&&(e.fontFamilyFarEast=e.fontFamilyFarEast.replace('"',"")),t.fontFamilyFarEast=e.fontFamilyFarEast),sf.base.isNullOrUndefined(e.fontFamilyAscii)||(-1!==e.fontFamilyAscii.indexOf('"')&&(e.fontFamilyAscii=e.fontFamilyAscii.replace('"',"")),t.fontFamilyAscii=e.fontFamilyAscii),sf.base.isNullOrUndefined(e.fontFamilyNonFarEast)||(-1!==e.fontFamilyNonFarEast.indexOf('"')&&(e.fontFamilyNonFarEast=e.fontFamilyNonFarEast.replace('"',"")),t.fontFamilyNonFarEast=e.fontFamilyNonFarEast)}},e.prototype.getColor=function(e){return e||"#ffffff"},e.prototype.parseThemes=function(e,t){this.parseFontScheme(e.fontScheme,t)},e.prototype.parseFontScheme=function(e,t){sf.base.isNullOrUndefined(e.fontSchemeName)||(t.fontScheme.fontSchemeName=e.fontSchemeName),sf.base.isNullOrUndefined(e.majorFontScheme)||this.parseMajorMinorFontScheme(e.majorFontScheme,t.fontScheme.majorFontScheme),sf.base.isNullOrUndefined(e.minorFontScheme)||this.parseMajorMinorFontScheme(e.minorFontScheme,t.fontScheme.minorFontScheme)},e.prototype.parseMajorMinorFontScheme=function(e,t){if(!sf.base.isNullOrUndefined(e.fontTypeface)&&Object.keys(e.fontTypeface).length>0){for(var i=0,r=Object.keys(e.fontTypeface);i<r.length;i++){var n=r[i];t.fontTypeface.add(n,e.fontTypeface[n])}this.documentHelper.hasThemes=!0}if(!sf.base.isNullOrUndefined(e.fontSchemeList)&&e.fontSchemeList.length>0){for(var o=0;o<e.fontSchemeList.length;o++){var s=e.fontSchemeList[o],a=new V;a.name=sf.base.isNullOrUndefined(s.fontName)?s.name:s.fontName,a.typeface=sf.base.isNullOrUndefined(s.fontTypeface)?s.typeface:s.fontTypeface,a.panose=sf.base.isNullOrUndefined(s.pnose)?s.panose:s.pnose,t.fontSchemeList.push(a)}this.documentHelper.hasThemes=!0}},e.prototype.parseParagraphFormat=function(e,t){sf.base.isNullOrUndefined(e)||(sf.base.isNullOrUndefined(e.borders)||this.parseBorders(e.borders,t.borders),sf.base.isNullOrUndefined(e.bidi)||(t.bidi=e.bidi),sf.base.isNullOrUndefined(e.leftIndent)||(t.leftIndent=e.leftIndent),sf.base.isNullOrUndefined(e.rightIndent)||(t.rightIndent=e.rightIndent),sf.base.isNullOrUndefined(e.firstLineIndent)||(t.firstLineIndent=e.firstLineIndent),sf.base.isNullOrUndefined(e.afterSpacing)||(t.afterSpacing=e.afterSpacing),sf.base.isNullOrUndefined(e.beforeSpacing)||(t.beforeSpacing=e.beforeSpacing),sf.base.isNullOrUndefined(e.spaceBeforeAuto)||(t.spaceBeforeAuto=e.spaceBeforeAuto),sf.base.isNullOrUndefined(e.spaceAfterAuto)||(t.spaceAfterAuto=e.spaceAfterAuto),sf.base.isNullOrUndefined(e.lineSpacing)||(t.lineSpacing=e.lineSpacing),sf.base.isNullOrUndefined(e.lineSpacingType)?sf.base.isNullOrUndefined(e.lineSpacing)||(t.lineSpacingType="Multiple"):t.lineSpacingType=e.lineSpacingType,sf.base.isNullOrUndefined(e.textAlignment)||(t.textAlignment=e.textAlignment),sf.base.isNullOrUndefined(e.outlineLevel)||(t.outlineLevel=e.outlineLevel),sf.base.isNullOrUndefined(e.contextualSpacing)||(t.contextualSpacing=e.contextualSpacing),sf.base.isNullOrUndefined(e.widowControl)||(t.widowControl=e.widowControl),sf.base.isNullOrUndefined(e.keepWithNext)||(t.keepWithNext=e.keepWithNext),sf.base.isNullOrUndefined(e.keepLinesTogether)||(t.keepLinesTogether=e.keepLinesTogether),t.listFormat=new m(t),e.hasOwnProperty("listFormat")&&this.parseListFormat(e,t.listFormat),e.hasOwnProperty("tabs")&&this.parseTabStop(e.tabs,t.tabs))},e.prototype.parseListFormat=function(e,t){sf.base.isNullOrUndefined(e.listFormat)||(sf.base.isNullOrUndefined(e.listFormat.listId)||(t.listId=e.listFormat.listId,t.list=this.documentHelper.getListById(e.listFormat.listId)),sf.base.isNullOrUndefined(e.listFormat.listLevelNumber)||(t.listLevelNumber=e.listFormat.listLevelNumber))},e.prototype.parseSectionFormat=function(e,t){if(sf.base.isNullOrUndefined(e.pageWidth)||(t.pageWidth=e.pageWidth),sf.base.isNullOrUndefined(e.pageHeight)||(t.pageHeight=e.pageHeight),sf.base.isNullOrUndefined(e.leftMargin)||(t.leftMargin=e.leftMargin),sf.base.isNullOrUndefined(e.topMargin)||(t.topMargin=e.topMargin),sf.base.isNullOrUndefined(e.rightMargin)||(t.rightMargin=e.rightMargin),sf.base.isNullOrUndefined(e.bottomMargin)||(t.bottomMargin=e.bottomMargin),sf.base.isNullOrUndefined(e.headerDistance)||(t.headerDistance=e.headerDistance),sf.base.isNullOrUndefined(e.footerDistance)||(t.footerDistance=e.footerDistance),sf.base.isNullOrUndefined(e.differentFirstPage)||(t.differentFirstPage=e.differentFirstPage),sf.base.isNullOrUndefined(e.differentOddAndEvenPages)||(t.differentOddAndEvenPages=e.differentOddAndEvenPages),sf.base.isNullOrUndefined(e.bidi)||(t.bidi=e.bidi),sf.base.isNullOrUndefined(e.restartPageNumbering)||(t.restartPageNumbering=e.restartPageNumbering),sf.base.isNullOrUndefined(e.pageStartingNumber)||(t.pageStartingNumber=e.pageStartingNumber),sf.base.isNullOrUndefined(e.endnoteNumberFormat)||(t.endnoteNumberFormat=e.endnoteNumberFormat),sf.base.isNullOrUndefined(e.footNoteNumberFormat)||(t.footNoteNumberFormat=e.footNoteNumberFormat),sf.base.isNullOrUndefined(e.restartIndexForFootnotes)||(t.restartIndexForFootnotes=e.restartIndexForFootnotes),sf.base.isNullOrUndefined(e.pageStartingNumber)||(t.restartIndexForEndnotes=e.restartIndexForEndnotes),sf.base.isNullOrUndefined(e.initialFootNoteNumber)||(t.initialFootNoteNumber=e.initialFootNoteNumber),sf.base.isNullOrUndefined(e.initialEndNoteNumber)||(t.initialEndNoteNumber=e.initialEndNoteNumber),sf.base.isNullOrUndefined(e.pageNumberStyle)||(t.pageNumberStyle=e.pageNumberStyle),!sf.base.isNullOrUndefined(e.columns)&&!sf.base.isNullOrUndefined(e.numberOfColumns)&&e.numberOfColumns>1&&(t.numberOfColumns=e.numberOfColumns,t.equalWidth=e.equalWidth,t.lineBetweenColumns=e.lineBetweenColumns,e.columns))for(var i=0;i<e.columns.length;i++){var r=new c;r.width=x.convertPointToPixel(e.columns[i].width),r.space=x.convertPointToPixel(e.columns[i].space),r.index=i,t.columns.push(r)}sf.base.isNullOrUndefined(e.breakCode)||(t.breakCode=e.breakCode)},e.prototype.parseColumns=function(e,t){if(t=[],e)for(var i=0;i<e.length;i++){var r=new c;r.width=x.convertPointToPixel(e[i].width),r.space=x.convertPointToPixel(e[i].space),r.index=i,t.push(r)}},e.prototype.parseTabStop=function(e,t){if(e)for(var i=0;i<e.length;i++){var r=new dt;r.position=e[i].position,r.tabLeader=e[i].tabLeader,r.deletePosition=e[i].deletePosition,r.tabJustification=e[i].tabJustification,t.push(r)}},e.prototype.validateImageUrl=function(e){var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",i=3*(e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"")).length/4;return e.charAt(e.length-1)===t.charAt(64)&&i--,e.charAt(e.length-2)===t.charAt(64)&&i--,i%1==0},e.prototype.containsFieldBegin=function(e){for(var t=void 0,i=e.children.length-1;i>=0;i--){if((t=e.children[i])instanceof fe&&t.hasFieldEnd&&t.nextElement instanceof we)return t.nextElement;if(t instanceof fe)return}return t},e}(),xt=function(){function e(e){this.boldIn=void 0,this.italicIn=void 0,this.underlineIn=void 0,this.strikeThroughIn=void 0,this.baselineAlignmentIn=void 0,this.highlightColorIn=void 0,this.fontSizeIn=0,this.scriptType=t.English,this.fontColorIn=void 0,this.allCapsIn=void 0,this.boldBidi=void 0,this.italicBidi=void 0,this.fontSizeBidi=0,this.bidi=void 0,this.bdo=void 0,this.selection=e}return Object.defineProperty(e.prototype,"fontSize",{get:function(){return this.fontSizeIn},set:function(e){e!==this.fontSizeIn&&(this.fontSizeIn=e,this.notifyPropertyChanged("fontSize"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"renderedFontFamily",{get:function(){return this.renderedFontFamilyIn},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fontFamily",{get:function(){return this.fontFamilyIn},set:function(e){e!==this.fontFamilyIn&&(this.fontFamilyIn=e,this.notifyPropertyChanged("fontFamily"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fontColor",{get:function(){return this.fontColorIn},set:function(e){e!==this.fontColorIn&&(this.fontColorIn=e,this.notifyPropertyChanged("fontColor"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bold",{get:function(){return this.boldIn},set:function(e){e!==this.boldIn&&(this.boldIn=e,this.notifyPropertyChanged("bold"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"italic",{get:function(){return this.italicIn},set:function(e){e!==this.italic&&(this.italicIn=e,this.notifyPropertyChanged("italic"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"strikethrough",{get:function(){return this.strikeThroughIn},set:function(e){e!==this.strikeThroughIn&&(this.strikeThroughIn=e,this.notifyPropertyChanged("strikethrough"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"baselineAlignment",{get:function(){return this.baselineAlignmentIn},set:function(e){e!==this.baselineAlignmentIn&&(this.baselineAlignmentIn=e,this.notifyPropertyChanged("baselineAlignment"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"underline",{get:function(){return this.underlineIn},set:function(e){e!==this.underlineIn&&(this.underlineIn=e,this.notifyPropertyChanged("underline"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"highlightColor",{get:function(){return this.highlightColorIn},set:function(e){e===this.highlightColorIn&&"NoColor"!==e||(this.highlightColorIn=e,this.notifyPropertyChanged("highlightColor"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"allCaps",{get:function(){return this.allCapsIn},set:function(e){e!==this.allCapsIn&&(this.allCapsIn=e,this.notifyPropertyChanged("allCaps"))},enumerable:!0,configurable:!0}),e.prototype.getPropertyValue=function(e){switch(e){case"bold":return this.bold;case"italic":return this.italic;case"fontSize":return this.fontSize>=1?this.fontSize:void 0;case"fontFamily":return this.fontFamily;case"strikethrough":return this.strikethrough;case"baselineAlignment":return this.baselineAlignment;case"highlightColor":return this.highlightColor;case"underline":return this.underline;case"fontColor":return this.fontColor;case"allCaps":return this.allCaps;default:return}},e.prototype.notifyPropertyChanged=function(e){if((sf.base.isNullOrUndefined(this.selection)||!(this.selection.isCleared||this.selection.owner.isReadOnlyMode&&!this.selection.isInlineFormFillMode()||!this.selection.owner.isDocumentLoaded||this.selection.owner.isPastingContent)||this.selection.isRetrieveFormatting)&&!sf.base.isNullOrUndefined(this.selection)&&!sf.base.isNullOrUndefined(this.selection.start)&&!this.selection.isRetrieveFormatting){var t=this.getPropertyValue(e);sf.base.isNullOrUndefined(t)||this.selection.owner.editorModule.onApplyCharacterFormat(e,t)}},e.prototype.copyFormat=function(e,t){this.styleName=sf.base.isNullOrUndefined(e.baseCharStyle)?"Default Paragraph Font":e.baseCharStyle.name,this.fontSize=e.fontSize,this.renderedFontFamilyIn=t,this.fontFamily=e.fontFamily,this.bold=e.bold,this.italic=e.italic,this.baselineAlignment=e.baselineAlignment,this.underline=e.underline,this.fontColor=e.fontColor,this.highlightColor=e.highlightColor,this.strikethrough=e.strikethrough,this.bidi=e.bidi,this.bdo=e.bdo,this.boldBidi=e.boldBidi,this.italicBidi=e.italicBidi,this.fontFamilyBidi=e.fontFamilyBidi,this.fontSizeBidi=e.fontSizeBidi,this.allCaps=e.allCaps},e.prototype.combineFormat=function(e,t){sf.base.isNullOrUndefined(this.bold)||this.bold===e.bold||(this.bold=void 0),sf.base.isNullOrUndefined(this.italic)||this.italic===e.italic||(this.italic=void 0),0!==this.fontSize&&this.fontSize!==e.fontSize&&(this.fontSize=0),sf.base.isNullOrUndefined(this.renderedFontFamily)||this.renderedFontFamily===t||(this.renderedFontFamilyIn=void 0),sf.base.isNullOrUndefined(this.fontFamily)||this.fontFamily===e.fontFamily||(this.fontFamily=void 0),sf.base.isNullOrUndefined(this.highlightColor)||this.highlightColor===e.highlightColor||(this.highlightColor=void 0),sf.base.isNullOrUndefined(this.baselineAlignment)||this.baselineAlignment===e.baselineAlignment||(this.baselineAlignment=void 0),sf.base.isNullOrUndefined(this.fontColor)||this.fontColor===e.fontColor||(this.fontColor=void 0),sf.base.isNullOrUndefined(this.underline)||this.underline===e.underline||(this.underline=void 0),sf.base.isNullOrUndefined(this.strikethrough)||this.strikethrough===e.strikethrough||(this.strikethrough=void 0),sf.base.isNullOrUndefined(this.boldBidi)||this.boldBidi===e.boldBidi||(this.boldBidi=void 0),sf.base.isNullOrUndefined(this.italicBidi)||this.italicBidi===e.italicBidi||(this.italicBidi=void 0),0!==this.fontSizeBidi&&this.fontSizeBidi!==e.fontSizeBidi&&(this.fontSizeBidi=0),sf.base.isNullOrUndefined(this.fontFamilyBidi)||this.fontFamilyBidi===e.fontFamilyBidi||(this.fontFamilyBidi=void 0),sf.base.isNullOrUndefined(this.bidi)||this.bidi===e.bidi||(this.bidi=void 0),sf.base.isNullOrUndefined(this.bdo)||this.bdo===e.bdo||(this.bdo=void 0),sf.base.isNullOrUndefined(this.allCaps)||this.allCaps===e.allCaps||(this.allCaps=void 0)},e.prototype.canRetrieveNextCharacterFormat=function(){return!(sf.base.isNullOrUndefined(this.bold)&&sf.base.isNullOrUndefined(this.italic)&&0===this.fontSize&&sf.base.isNullOrUndefined(this.fontFamily)&&sf.base.isNullOrUndefined(this.highlightColor)&&sf.base.isNullOrUndefined(this.baselineAlignment)&&sf.base.isNullOrUndefined(this.fontColor)&&sf.base.isNullOrUndefined(this.underline)&&sf.base.isNullOrUndefined(this.strikethrough)&&sf.base.isNullOrUndefined(this.boldBidi)&&sf.base.isNullOrUndefined(this.italicBidi)&&0===this.fontSizeBidi&&sf.base.isNullOrUndefined(this.fontFamilyBidi)&&sf.base.isNullOrUndefined(this.bdo)&&sf.base.isNullOrUndefined(this.allCaps))},e.prototype.cloneFormat=function(e){this.bold=e.bold,this.italic=e.italic,this.underline=e.underline,this.strikethrough=e.strikethrough,this.baselineAlignment=e.baselineAlignment,this.highlightColor=e.highlightColor,this.fontSize=e.fontSize,this.fontFamily=e.fontFamily,this.fontColor=e.fontColor,this.styleName=e.styleName,this.bidi=e.bidi,this.bdo=e.bdo,this.boldBidi=e.boldBidi,this.italicBidi=e.italicBidi,this.fontSizeBidi=e.fontSizeBidi,this.fontFamilyBidi=e.fontFamilyBidi,this.allCaps=e.allCaps},e.prototype.isEqualFormat=function(e){return this.fontSize===e.fontSize&&this.strikethrough===e.strikethrough&&this.bold===e.bold&&this.fontFamily===e.fontFamily&&this.underline===e.underline&&this.highlightColor===e.highlightColor&&this.italic===e.italic&&this.baselineAlignment===e.baselineAlignment&&this.fontColor===e.fontColor&&this.allCaps===e.allCaps},e.prototype.clearFormat=function(){this.fontSizeIn=0,this.boldIn=void 0,this.italicIn=void 0,this.fontFamilyIn=void 0,this.fontColorIn=void 0,this.underlineIn=void 0,this.strikeThroughIn=void 0,this.highlightColorIn=void 0,this.baselineAlignmentIn=void 0,this.styleName=void 0,this.bidi=void 0,this.bdo=void 0,this.boldBidi=void 0,this.italicBidi=void 0,this.fontFamilyBidi=void 0,this.fontSizeBidi=void 0,this.allCapsIn=void 0},e.prototype.destroy=function(){this.fontSizeIn=void 0,this.boldIn=void 0,this.italicIn=void 0,this.fontFamilyIn=void 0,this.fontColorIn=void 0,this.underlineIn=void 0,this.strikeThroughIn=void 0,this.baselineAlignmentIn=void 0,this.highlightColorIn=void 0,this.selection=void 0,this.styleName=void 0,this.bidi=void 0,this.bdo=void 0,this.boldBidi=void 0,this.italicBidi=void 0,this.fontFamilyBidi=void 0,this.fontSizeBidi=void 0,this.allCapsIn=void 0},e}(),Mt=function(){function e(e,t,i){this.colorIn=void 0,this.lineStyleIn=void 0,this.lineWidthIn=void 0,this.shadowIn=void 0,this.spaceIn=void 0,this.ownerBase=void 0,this.borderType=t,this.ownerBase=i,this.selection=e}return Object.defineProperty(e.prototype,"color",{get:function(){return this.colorIn},set:function(e){e!==this.colorIn&&(this.colorIn=e,this.notifyPropertyChanged("color"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lineStyle",{get:function(){return this.lineStyleIn},set:function(e){e!==this.lineStyleIn&&(this.lineStyleIn=e,this.notifyPropertyChanged("lineStyle"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lineWidth",{get:function(){return this.lineWidthIn},set:function(e){e!==this.lineWidthIn&&(this.lineWidthIn=e,this.notifyPropertyChanged("lineWidth"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"shadow",{get:function(){return this.shadowIn},set:function(e){e!==this.shadowIn&&(this.shadowIn=e,this.notifyPropertyChanged("shadow"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"space",{get:function(){return this.spaceIn},set:function(e){e!==this.spaceIn&&(this.spaceIn=e,this.notifyPropertyChanged("space"))},enumerable:!0,configurable:!0}),e.prototype.copyFormat=function(e){this.color=e.color,this.lineStyle=e.lineStyle,this.lineWidth=e.lineWidth,this.shadow=e.shadow,this.space=e.space},e.prototype.combineFormat=function(e){sf.base.isNullOrUndefined(this.color)||this.color===e.color||(this.color=void 0),sf.base.isNullOrUndefined(this.lineStyle)||this.lineStyle===e.lineStyle||(this.lineStyle=void 0),sf.base.isNullOrUndefined(this.lineWidth)||this.lineWidth===e.lineWidth||(this.lineWidth=void 0),sf.base.isNullOrUndefined(this.shadow)||this.shadow===e.shadow||(this.shadow=void 0),sf.base.isNullOrUndefined(this.space)||this.space===e.space||(this.space=void 0)},e.prototype.getPropertyValue=function(e){switch(e){case"color":return this.color;case"lineStyle":return this.lineStyle;case"lineWidth":return this.lineWidth;case"space":return this.space;case"shadow":return this.shadow}},e.prototype.notifyPropertyChanged=function(e){if((sf.base.isNullOrUndefined(this.selection)||(!this.selection.owner.isReadOnlyMode||this.selection.isInlineFormFillMode())&&this.selection.owner.isDocumentLoaded||this.selection.isRetrieveFormatting)&&!sf.base.isNullOrUndefined(this.selection)&&!sf.base.isNullOrUndefined(this.selection.start)&&!this.selection.isRetrieveFormatting){var t=this.selection.owner.editorModule,i=this.getPropertyValue(e);sf.base.isNullOrUndefined(i)||t.applyParagraphBorders(e,this.borderType,i)}},e.prototype.destroy=function(){sf.base.isNullOrUndefined(this.colorIn)||(this.colorIn=void 0),sf.base.isNullOrUndefined(this.lineStyleIn)||(this.lineStyleIn=void 0),sf.base.isNullOrUndefined(this.lineWidthIn)||(this.lineWidthIn=void 0),sf.base.isNullOrUndefined(this.spaceIn)||(this.spaceIn=void 0),sf.base.isNullOrUndefined(this.shadowIn)||(this.shadowIn=void 0)},e}(),Nt=function(){function e(e,t){this.ownerBase=t,this.selection=e,this.topIn=new Mt(this.selection,"topBorder",this),this.bottomIn=new Mt(this.selection,"bottomBorder",this),this.rightIn=new Mt(this.selection,"rightBorder",this),this.leftIn=new Mt(this.selection,"leftBorder",this),this.horizontalIn=new Mt(this.selection,"horizontalBorder",this),this.verticalIn=new Mt(this.selection,"verticalBorder",this)}return Object.defineProperty(e.prototype,"top",{get:function(){return this.topIn},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bottom",{get:function(){return this.bottomIn},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"left",{get:function(){return this.leftIn},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"right",{get:function(){return this.rightIn},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"horizontal",{get:function(){return this.horizontalIn},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"vertical",{get:function(){return this.verticalIn},enumerable:!0,configurable:!0}),e.prototype.copyFormat=function(e){this.top.copyFormat(e.top),this.bottom.copyFormat(e.bottom),this.left.copyFormat(e.left),this.right.copyFormat(e.right),this.horizontal.copyFormat(e.horizontal),this.vertical.copyFormat(e.vertical)},e.prototype.combineFormat=function(e){this.top.combineFormat(e.top),this.bottom.combineFormat(e.bottom),this.left.combineFormat(e.left),this.right.combineFormat(e.right),this.vertical.combineFormat(e.vertical),this.horizontal.combineFormat(e.horizontal)},e.prototype.destroy=function(){sf.base.isNullOrUndefined(this.topIn)||(this.topIn.destroy(),this.topIn=void 0),sf.base.isNullOrUndefined(this.topIn)||(this.bottomIn.destroy(),this.bottomIn=void 0),sf.base.isNullOrUndefined(this.leftIn)||(this.leftIn.destroy(),this.leftIn=void 0),sf.base.isNullOrUndefined(this.rightIn)||(this.rightIn.destroy(),this.rightIn=void 0),sf.base.isNullOrUndefined(this.horizontalIn)||(this.horizontalIn.destroy(),this.horizontalIn=void 0),sf.base.isNullOrUndefined(this.verticalIn)||(this.verticalIn.destroy(),this.verticalIn=void 0)},e}(),It=function(){function e(e,t){this.leftIndentIn=0,this.rightIndentIn=0,this.beforeSpacingIn=0,this.afterSpacingIn=0,this.spaceAfterAutoIn=void 0,this.spaceBeforeAutoIn=void 0,this.textAlignmentIn=void 0,this.firstLineIndentIn=0,this.lineSpacingIn=1,this.lineSpacingTypeIn=void 0,this.bidiIn=void 0,this.keepWithNextIn=void 0,this.keepLinesTogetherIn=void 0,this.widowControlIn=void 0,this.contextualSpacingIn=void 0,this.listLevelNumberIn=-1,this.selection=e,this.documentHelper=t,this.bordersIn=new Nt(this.selection,this)}return Object.defineProperty(e.prototype,"borders",{get:function(){return this.bordersIn},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"leftIndent",{get:function(){return this.leftIndentIn},set:function(e){e!==this.leftIndentIn&&(this.leftIndentIn=e,this.notifyPropertyChanged("leftIndent"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rightIndent",{get:function(){return this.rightIndentIn},set:function(e){e!==this.rightIndentIn&&(this.rightIndentIn=e,this.notifyPropertyChanged("rightIndent"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"firstLineIndent",{get:function(){return this.firstLineIndentIn},set:function(e){e!==this.firstLineIndentIn&&(this.firstLineIndentIn=e,this.notifyPropertyChanged("firstLineIndent"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"textAlignment",{get:function(){return this.textAlignmentIn},set:function(e){e!==this.textAlignmentIn&&(this.textAlignmentIn=e,this.notifyPropertyChanged("textAlignment"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"afterSpacing",{get:function(){return this.afterSpacingIn},set:function(e){e!==this.afterSpacingIn&&(this.afterSpacingIn=e,this.notifyPropertyChanged("afterSpacing"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"beforeSpacing",{get:function(){return this.beforeSpacingIn},set:function(e){e!==this.beforeSpacingIn&&(this.beforeSpacingIn=e,this.notifyPropertyChanged("beforeSpacing"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"spaceAfterAuto",{get:function(){return this.spaceAfterAutoIn},set:function(e){e!==this.spaceAfterAutoIn&&(this.spaceAfterAutoIn=e,this.notifyPropertyChanged("spaceAfterAuto"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"spaceBeforeAuto",{get:function(){return this.spaceBeforeAutoIn},set:function(e){e!==this.spaceBeforeAutoIn&&(this.spaceBeforeAutoIn=e,this.notifyPropertyChanged("spaceBeforeAuto"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lineSpacing",{get:function(){return this.lineSpacingIn},set:function(e){e!==this.lineSpacingIn&&(this.lineSpacingIn=e,this.notifyPropertyChanged("lineSpacing"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lineSpacingType",{get:function(){return this.lineSpacingTypeIn},set:function(e){e!==this.lineSpacingTypeIn&&(this.lineSpacingTypeIn=e,this.notifyPropertyChanged("lineSpacingType"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"listLevelNumber",{get:function(){return this.listLevelNumberIn},set:function(e){e!==this.listLevelNumberIn&&(this.listLevelNumberIn=e,this.notifyPropertyChanged("listLevelNumber"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bidi",{get:function(){return this.bidiIn},set:function(e){this.bidiIn=e,this.notifyPropertyChanged("bidi")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"keepWithNext",{get:function(){return this.keepWithNextIn},set:function(e){this.keepWithNextIn=e,this.notifyPropertyChanged("keepWithNext")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"keepLinesTogether",{get:function(){return this.keepLinesTogetherIn},set:function(e){this.keepLinesTogetherIn=e,this.notifyPropertyChanged("keepLinesTogether")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"widowControl",{get:function(){return this.widowControlIn},set:function(e){this.widowControlIn=e,this.notifyPropertyChanged("widowControl")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"contextualSpacing",{get:function(){return this.contextualSpacingIn},set:function(e){this.contextualSpacingIn=e,this.notifyPropertyChanged("contextualSpacing")},enumerable:!0,configurable:!0}),e.prototype.validateLineSpacing=function(){return"Multiple"!==this.lineSpacingType&&this.lineSpacingIn<12},Object.defineProperty(e.prototype,"listText",{get:function(){var e=void 0,t=this.documentHelper.getListById(this.listId);if(t instanceof f&&this.listLevelNumberIn>-1&&this.listLevelNumberIn<9){var i=t.getListLevel(this.listLevelNumber);if(i instanceof A)if("Bullet"===i.listLevelPattern)e=i.numberFormat;else{e=i.numberFormat;for(var r=0;r<9;r++){var n="%"+(r+1);if(e.indexOf(n)>-1){r===this.listLevelNumberIn||t.getListLevel(r);var o=this.selection.getListTextElementBox(this.selection.start.paragraph);e=o?o.text:""}}}}return e},enumerable:!0,configurable:!0}),e.prototype.getPropertyValue=function(e){switch(e){case"leftIndent":return this.leftIndent;case"rightIndent":return this.rightIndent;case"firstLineIndent":return this.firstLineIndent;case"beforeSpacing":return this.beforeSpacing;case"afterSpacing":return this.afterSpacing;case"spaceAfterAuto":return this.spaceAfterAuto;case"spaceBeforeAuto":return this.spaceBeforeAuto;case"textAlignment":return this.textAlignment;case"lineSpacing":return this.lineSpacing;case"lineSpacingType":return this.lineSpacingType;case"bidi":return this.bidi;case"keepWithNext":return this.keepWithNext;case"keepLinesTogether":return this.keepLinesTogether;case"widowControl":return this.widowControl;case"contextualSpacing":return this.contextualSpacing;default:return}},e.prototype.notifyPropertyChanged=function(e){if((sf.base.isNullOrUndefined(this.selection)||(!this.selection.owner.isReadOnlyMode||this.selection.isInlineFormFillMode())&&this.selection.owner.isDocumentLoaded||this.selection.isRetrieveFormatting)&&!sf.base.isNullOrUndefined(this.selection)&&!sf.base.isNullOrUndefined(this.selection.start)&&!this.selection.isRetrieveFormatting){var t=this.selection.owner.editorModule;if("lineSpacing"===e||"lineSpacingType"===e){var i=this.selection.owner.editorHistory;if((!i||!i.isUndoing&&!i.isRedoing)&&this.validateLineSpacing()){if(this.selection.owner.editorHistory.initComplexHistory(this.selection,"LineSpacing"),"lineSpacing"===e){this.lineSpacingTypeIn="Multiple";var r=this.getPropertyValue("lineSpacingType");t.onApplyParagraphFormat("lineSpacingType",r,!1,!1),t.onApplyParagraphFormat(e,this.getPropertyValue(e),!1,!1)}else t.onApplyParagraphFormat(e,this.getPropertyValue(e),!1,!1),this.lineSpacingIn=12,t.onApplyParagraphFormat("lineSpacing",this.getPropertyValue("lineSpacing"),!1,!1);return void this.selection.owner.editorHistory.updateComplexHistory()}}var n=this.getPropertyValue(e);if(!("leftIndent"!==e&&"rightIndent"!==e&&"firstLineIndent"!==e||n>=-1056&&n<1056))return;"listLevelNumber"===e?t.onApplyListInternal(this.documentHelper.getListById(this.listId),this.listLevelNumber):t.onApplyParagraphFormat(e,n,"textAlignment"===e,!1)}},e.prototype.copyFormat=function(e){this.styleName=sf.base.isNullOrUndefined(e.baseStyle)?"Normal":e.baseStyle.name,this.leftIndent=e.leftIndent,this.rightIndent=e.rightIndent,this.firstLineIndent=e.firstLineIndent,this.afterSpacing=e.afterSpacing,this.beforeSpacing=e.beforeSpacing,this.spaceAfterAuto=e.spaceAfterAuto,this.spaceBeforeAuto=e.spaceBeforeAuto,this.lineSpacing=e.lineSpacing,this.lineSpacingType=e.lineSpacingType,this.textAlignment=e.textAlignment,this.bidi=e.bidi,this.keepLinesTogether=e.keepLinesTogether,this.keepWithNext=e.keepWithNext,this.widowControl=e.widowControl,this.contextualSpacing=e.contextualSpacing,this.borders.copyFormat(e.borders),sf.base.isNullOrUndefined(e.listFormat)||sf.base.isNullOrUndefined(e.listFormat.listId)?(this.listId=void 0,this.listLevelNumber=0):(this.listId=e.listFormat.listId,this.listLevelNumber=e.listFormat.listLevelNumber)},e.prototype.copyToFormat=function(e){sf.base.isNullOrUndefined(e)||(sf.base.isNullOrUndefined(this.afterSpacing)||(e.afterSpacing=this.afterSpacing),sf.base.isNullOrUndefined(this.beforeSpacing)||(e.beforeSpacing=this.beforeSpacing),sf.base.isNullOrUndefined(this.spaceAfterAuto)||(e.spaceAfterAuto=this.spaceAfterAuto),sf.base.isNullOrUndefined(this.spaceBeforeAuto)||(e.spaceBeforeAuto=this.spaceBeforeAuto),sf.base.isNullOrUndefined(this.leftIndent)||(e.leftIndent=this.leftIndent),sf.base.isNullOrUndefined(this.rightIndent)||(e.rightIndent=this.rightIndent),sf.base.isNullOrUndefined(this.textAlignment)||(e.textAlignment=this.textAlignment),sf.base.isNullOrUndefined(this.lineSpacing)||(e.lineSpacing=this.lineSpacing),sf.base.isNullOrUndefined(this.lineSpacingType)||(e.lineSpacingType=this.lineSpacingType),sf.base.isNullOrUndefined(this.firstLineIndent)||(e.firstLineIndent=this.firstLineIndent),sf.base.isNullOrUndefined(this.bidi)||(e.bidi=this.bidi),sf.base.isNullOrUndefined(this.keepLinesTogether)||(e.keepLinesTogether=this.keepLinesTogether),sf.base.isNullOrUndefined(this.keepWithNext)||(e.keepWithNext=this.keepWithNext),sf.base.isNullOrUndefined(this.widowControl)||(e.widowControl=this.widowControl),sf.base.isNullOrUndefined(this.contextualSpacing)||(e.contextualSpacing=this.contextualSpacing))},e.prototype.combineFormat=function(e){sf.base.isNullOrUndefined(this.leftIndent)||this.leftIndent===e.leftIndent||(this.leftIndent=void 0),sf.base.isNullOrUndefined(this.rightIndent)||this.rightIndent===e.rightIndent||(this.rightIndent=void 0),sf.base.isNullOrUndefined(this.firstLineIndent)||this.firstLineIndent===e.firstLineIndent||(this.firstLineIndent=void 0),0!==this.lineSpacing&&this.lineSpacing!==e.lineSpacing&&(this.lineSpacing=0),-1!==this.beforeSpacing&&this.beforeSpacing!==e.beforeSpacing&&(this.beforeSpacing=-1),-1!==this.afterSpacing&&this.afterSpacing!==e.afterSpacing&&(this.afterSpacing=-1),sf.base.isNullOrUndefined(this.spaceAfterAuto)||this.spaceAfterAuto===e.spaceAfterAuto||(this.spaceAfterAuto=void 0),sf.base.isNullOrUndefined(this.spaceBeforeAuto)||this.spaceBeforeAuto===e.spaceBeforeAuto||(this.spaceBeforeAuto=void 0),sf.base.isNullOrUndefined(this.lineSpacingType)||this.lineSpacingType===e.lineSpacingType||(this.lineSpacingType=void 0),sf.base.isNullOrUndefined(this.textAlignment)||this.textAlignment===e.textAlignment||(this.textAlignment=void 0),this.listLevelNumber>=0&&!sf.base.isNullOrUndefined(this.listId)&&(sf.base.isNullOrUndefined(e.listFormat)||e.listFormat.listLevelNumber!==this.listLevelNumber)&&(this.listLevelNumber=-1),(sf.base.isNullOrUndefined(e.listFormat)||sf.base.isNullOrUndefined(e.listFormat.listId)||!sf.base.isNullOrUndefined(this.listId)&&this.listId!==e.listFormat.listId)&&(this.listId=void 0),sf.base.isNullOrUndefined(this.bidi)||this.bidi===e.bidi||(this.bidi=void 0),sf.base.isNullOrUndefined(this.keepLinesTogether)||this.keepLinesTogether===e.keepLinesTogether||(this.keepLinesTogether=void 0),sf.base.isNullOrUndefined(this.keepWithNext)||this.keepWithNext===e.keepWithNext||(this.keepWithNext=void 0),sf.base.isNullOrUndefined(this.widowControl)||this.widowControl===e.widowControl||(this.widowControl=void 0),sf.base.isNullOrUndefined(this.contextualSpacing)||this.contextualSpacing===e.contextualSpacing||(this.contextualSpacing=void 0),!sf.base.isNullOrUndefined(this.styleName)&&e.baseStyle&&this.styleName!==e.baseStyle.name&&(this.styleName=void 0),this.borders.combineFormat(e.borders)},e.prototype.clearFormat=function(){this.leftIndent=0,this.rightIndent=0,this.beforeSpacing=0,this.afterSpacing=0,this.spaceAfterAuto=void 0,this.spaceBeforeAuto=void 0,this.firstLineIndent=0,this.lineSpacing=1,this.textAlignment=void 0,this.lineSpacingType=void 0,this.listId=void 0,this.listLevelNumber=-1,this.styleName=void 0,this.bidi=void 0,this.contextualSpacing=void 0},e.prototype.getList=function(){var e=this.documentHelper.getListById(this.listId);if(!sf.base.isNullOrUndefined(e)){var t=new f,i=new S,r=this.documentHelper.getAbstractListById(e.abstractListId),n=this.selection.owner.editorModule;if(sf.base.isNullOrUndefined(r))i.levels.push(new A(i));else for(var o=0;o<r.levels.length;o++){var s=n.cloneListLevel(r.levels[o]);i.levels.push(s),s.ownerBase=i}if(!sf.base.isNullOrUndefined(e.levelOverrides))for(o=0;o<e.levelOverrides.length;o++){var a=n.cloneLevelOverride(e.levelOverrides[o]);t.levelOverrides.push(a)}return t.abstractList=i,t.abstractListId=i.abstractListId,t.sourceListId=e.listId,t}},e.prototype.setList=function(e){if((!this.documentHelper.owner.isReadOnlyMode||this.selection.isInlineFormFillMode())&&this.documentHelper.owner.isDocumentLoaded){var t=this.documentHelper.getListById(this.listId),i=void 0,r=e?this.documentHelper.getAbstractListById(e.abstractListId):void 0;if(sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(e)||sf.base.isNullOrUndefined(r)||e.sourceListId!==t.listId)sf.base.isNullOrUndefined(e)?this.selection.owner.editorModule.onApplyList(void 0):(this.selection.owner.isLayoutEnabled=!1,sf.base.isNullOrUndefined(r)||-1!==this.documentHelper.abstractLists.indexOf(r)||this.documentHelper.abstractLists.push(r),-1===this.documentHelper.lists.indexOf(e)&&this.documentHelper.lists.push(e),this.selection.owner.isLayoutEnabled=!0,this.selection.owner.editorModule.onApplyList(e));else{var n=this.documentHelper.owner.editorHistory;this.documentHelper.layout.getListLevel(t,1);this.selection.owner.isLayoutEnabled=!1,this.documentHelper.owner.editorModule.setOffsetValue(this.selection),n&&(i=n.updateListChangesInHistory(r,t)),this.documentHelper.owner.editorModule.updateListParagraphs(),n&&n.applyListChanges(this.selection,i),this.selection.owner.isLayoutEnabled=!0,this.documentHelper.renderedLists.clear(),this.documentHelper.renderedLevelOverrides=[],this.documentHelper.owner.editorModule.layoutWholeDocument(),this.documentHelper.owner.editorModule.updateSelectionTextPosition(!1),n&&n.currentBaseHistoryInfo&&(n.currentBaseHistoryInfo.modifiedProperties.length>0&&n.currentBaseHistoryInfo.updateSelection(),n.updateHistory()),this.documentHelper.owner.editorModule.fireContentChange()}}},e.prototype.destroy=function(){this.leftIndentIn=void 0,this.rightIndentIn=void 0,this.beforeSpacingIn=void 0,this.afterSpacingIn=void 0,this.spaceBeforeAutoIn=void 0,this.spaceAfterAutoIn=void 0,this.firstLineIndentIn=void 0,this.lineSpacingIn=void 0,this.textAlignmentIn=void 0,this.lineSpacingTypeIn=void 0,this.listId=void 0,this.listLevelNumberIn=void 0,this.documentHelper=void 0,this.selection=void 0,this.styleName=void 0,this.bidi=void 0,this.contextualSpacing=void 0,sf.base.isNullOrUndefined(this.bordersIn)||(this.bordersIn.destroy(),this.bordersIn=void 0)},e}(),St=function(){function e(e){this.differentFirstPageIn=void 0,this.differentOddAndEvenPagesIn=void 0,this.bidi=void 0,this.selection=e}return Object.defineProperty(e.prototype,"pageHeight",{get:function(){return this.pageHeightIn},set:function(e){this.pageHeightIn=e,this.notifyPropertyChanged("pageHeight")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pageWidth",{get:function(){return this.pageWidthIn},set:function(e){this.pageWidthIn=e,this.notifyPropertyChanged("pageWidth")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"leftMargin",{get:function(){return this.leftMarginIn},set:function(e){this.leftMarginIn=e,this.notifyPropertyChanged("leftMargin")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bottomMargin",{get:function(){return this.bottomMarginIn},set:function(e){this.bottomMarginIn=e,this.notifyPropertyChanged("bottomMargin")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"topMargin",{get:function(){return this.topMarginIn},set:function(e){this.topMarginIn=e,this.notifyPropertyChanged("topMargin")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rightMargin",{get:function(){return this.rightMarginIn},set:function(e){this.rightMarginIn=e,this.notifyPropertyChanged("rightMargin")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"headerDistance",{get:function(){return this.headerDistanceIn},set:function(e){this.headerDistanceIn=e,this.notifyPropertyChanged("headerDistance")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pageStartingNumber",{get:function(){return this.pageStartingNumberIn},set:function(e){this.pageStartingNumberIn=e,this.notifyPropertyChanged("pageStartingNumber")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"restartPageNumbering",{get:function(){return this.restartPageNumberingIn},set:function(e){this.restartPageNumberingIn=e,this.notifyPropertyChanged("restartPageNumbering")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"footerDistance",{get:function(){return this.footerDistanceIn},set:function(e){this.footerDistanceIn=e,this.notifyPropertyChanged("footerDistance")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"differentFirstPage",{get:function(){return this.differentFirstPageIn},set:function(e){this.differentFirstPageIn=e,this.notifyPropertyChanged("differentFirstPage")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"differentOddAndEvenPages",{get:function(){return this.differentOddAndEvenPagesIn},set:function(e){this.differentOddAndEvenPagesIn=e,this.notifyPropertyChanged("differentOddAndEvenPages")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"endnoteNumberFormat",{get:function(){return this.endnoteNumberFormatIn},set:function(e){this.endnoteNumberFormatIn=e,this.notifyPropertyChanged("endnoteNumberFormat")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"footNoteNumberFormat",{get:function(){return this.footNoteNumberFormatIn},set:function(e){this.footNoteNumberFormatIn=e,this.notifyPropertyChanged("footNoteNumberFormat")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"initialFootNoteNumber",{get:function(){return this.initialFootNoteNumberIn},set:function(e){this.initialFootNoteNumberIn=e,this.notifyPropertyChanged("initialFootNoteNumber")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"initialEndNoteNumber",{get:function(){return this.initialEndNoteNumberIn},set:function(e){this.initialEndNoteNumberIn=e,this.notifyPropertyChanged("initialEndNoteNumber")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"restartIndexForFootnotes",{get:function(){return this.restartIndexForFootnotesIn},set:function(e){this.restartIndexForFootnotesIn=e,this.notifyPropertyChanged("restartIndexForFootnotes")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"restartIndexForEndnotes",{get:function(){return this.restartIndexForEndnotesIn},set:function(e){this.restartIndexForEndnotesIn=e,this.notifyPropertyChanged("restartIndexForEndnotes")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"numberOfColumns",{get:function(){return 0==this.columns.length?1:this.columns.length},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"equalWidth",{get:function(){return this.equalWidthIn},set:function(e){this.equalWidthIn=e,this.notifyPropertyChanged("equalWidth")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lineBetweenColumns",{get:function(){return this.lineBetweenColumnsIn},set:function(e){this.lineBetweenColumnsIn=e,this.notifyPropertyChanged("lineBetweenColumns")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"columns",{get:function(){return this.columnsIn},set:function(e){this.columnsIn=e;var t=this.selection;(sf.base.isNullOrUndefined(t)||!(t.isCleared||t.owner.isPastingContent||t.owner.isReadOnlyMode)&&t.owner.isDocumentLoaded||t.isRetrieveFormatting)&&(sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t.start)||t.isRetrieveFormatting||this.selection.owner.editorModule.onApplyColumnFormat("columns",e))},enumerable:!0,configurable:!0}),e.prototype.copyFormat=function(e){this.pageHeight=e.pageHeight,this.pageWidth=e.pageWidth,this.leftMargin=e.leftMargin,this.topMargin=e.topMargin,this.rightMargin=e.rightMargin,this.bottomMargin=e.bottomMargin,this.headerDistance=e.headerDistance,this.footerDistance=e.footerDistance,this.differentFirstPage=e.differentFirstPage,this.differentOddAndEvenPages=e.differentOddAndEvenPages,this.bidi=e.bidi,this.pageStartingNumber=e.pageStartingNumber,this.restartPageNumbering=e.restartPageNumbering,this.endnoteNumberFormat=e.endnoteNumberFormat,this.footNoteNumberFormat=e.footNoteNumberFormat,this.restartIndexForEndnotes=e.restartIndexForEndnotes,this.restartIndexForFootnotes=e.restartIndexForFootnotes,this.initialEndNoteNumber=e.initialEndNoteNumber,this.initialFootNoteNumber=e.initialFootNoteNumber,this.equalWidth=e.equalWidth,this.lineBetweenColumns=e.lineBetweenColumns,this.columns=[];for(var t=0,i=e.columns;t<i.length;t++){var r=i[t],n=new At(this.selection);n.width=x.convertPixelToPoint(r.width),n.space=x.convertPixelToPoint(r.space),this.columns.push(n)}},e.prototype.applyColumnFormat=function(){},e.prototype.notifyPropertyChanged=function(e){var t=this.selection;if((sf.base.isNullOrUndefined(t)||!(t.isCleared||t.owner.isPastingContent||t.owner.isReadOnlyMode)&&t.owner.isDocumentLoaded||t.isRetrieveFormatting)&&!sf.base.isNullOrUndefined(t)&&!sf.base.isNullOrUndefined(t.start)&&!t.isRetrieveFormatting){var i=this.getPropertyvalue(e);sf.base.isNullOrUndefined(i)||t.owner.editorModule.onApplySectionFormat(e,i)}},e.prototype.getPropertyvalue=function(e){switch(e){case"pageHeight":return this.pageHeight>0?this.pageHeight:void 0;case"pageWidth":return this.pageWidth>0?this.pageWidth:void 0;case"leftMargin":return this.leftMargin>=0?this.leftMargin:void 0;case"rightMargin":return this.rightMargin>=0?this.rightMargin:void 0;case"topMargin":return this.topMargin>=0?this.topMargin:void 0;case"bottomMargin":return this.bottomMargin>=0?this.bottomMargin:void 0;case"differentFirstPage":return sf.base.isNullOrUndefined(this.differentFirstPage)?void 0:this.differentFirstPage;case"differentOddAndEvenPages":return sf.base.isNullOrUndefined(this.differentOddAndEvenPages)?void 0:this.differentOddAndEvenPages;case"headerDistance":return this.headerDistanceIn;case"footerDistance":return this.footerDistance;case"pageStartingNumber":return sf.base.isNullOrUndefined(this.pageStartingNumber)?void 0:this.pageStartingNumber;case"restartPageNumbering":return sf.base.isNullOrUndefined(this.restartPageNumbering)?void 0:this.restartPageNumbering;case"endnoteNumberFormat":return this.endnoteNumberFormatIn;case"restartIndexForEndnotes":return this.restartIndexForEndnotesIn;case"restartIndexForFootnotes":return this.restartIndexForFootnotesIn;case"footNoteNumberFormat":return this.footNoteNumberFormatIn;case"initialFootNoteNumber":return this.initialFootNoteNumber;case"initialEndNoteNumber":return this.initialEndNoteNumber;case"equalWidth":return this.equalWidthIn;case"lineBetweenColumns":return this.lineBetweenColumnsIn;case"columns":return this.columnsIn;default:return}},e.prototype.combineFormat=function(e){this.pageHeight>0&&this.pageHeight!==e.pageHeight&&(this.pageHeight=0),this.pageWidth>0&&this.pageWidth!==e.pageWidth&&(this.pageWidth=0),this.leftMargin>-1&&this.leftMargin!==e.leftMargin&&(this.leftMargin=-1),this.topMargin>-1&&this.topMargin!==e.topMargin&&(this.topMargin=-1),this.rightMargin>-1&&this.rightMargin!==e.rightMargin&&(this.rightMargin=-1),this.bottomMargin>-1&&this.bottomMargin!==e.bottomMargin&&(this.bottomMargin=-1),0!==this.headerDistance&&this.headerDistance!==e.headerDistance&&(this.headerDistance=0),0!==this.footerDistance&&this.footerDistance!==e.footerDistance&&(this.footerDistance=0),sf.base.isNullOrUndefined(this.differentFirstPage)||this.differentFirstPage===e.differentFirstPage||(this.differentFirstPage=void 0),sf.base.isNullOrUndefined(this.pageStartingNumber)||this.pageStartingNumber===e.pageStartingNumber||(this.pageStartingNumber=void 0),sf.base.isNullOrUndefined(this.restartPageNumbering)||this.restartPageNumbering===e.restartPageNumbering||(this.restartPageNumbering=void 0),sf.base.isNullOrUndefined(this.differentOddAndEvenPages)||this.differentOddAndEvenPages===e.differentOddAndEvenPages||(this.differentOddAndEvenPages=void 0),sf.base.isNullOrUndefined(this.bidi)||this.bidi===e.bidi||(this.bidi=void 0),sf.base.isNullOrUndefined(this.endnoteNumberFormat)||this.endnoteNumberFormat===e.endnoteNumberFormat||(this.endnoteNumberFormat=void 0),sf.base.isNullOrUndefined(this.restartIndexForEndnotes)||this.restartIndexForEndnotes===e.restartIndexForEndnotes||(this.restartIndexForEndnotes=void 0),sf.base.isNullOrUndefined(this.restartIndexForFootnotes)||this.restartIndexForFootnotes===e.restartIndexForFootnotes||(this.restartIndexForFootnotes=void 0),sf.base.isNullOrUndefined(this.footNoteNumberFormat)||this.footNoteNumberFormat===e.footNoteNumberFormat||(this.footNoteNumberFormat=void 0),sf.base.isNullOrUndefined(this.initialFootNoteNumber)||this.initialFootNoteNumber===e.initialFootNoteNumber||(this.initialFootNoteNumber=void 0),sf.base.isNullOrUndefined(this.initialEndNoteNumber)||this.initialEndNoteNumber===e.initialEndNoteNumber||(this.initialEndNoteNumber=void 0)},e.prototype.clearFormat=function(){this.headerDistance=0,this.footerDistance=0,this.pageHeight=0,this.pageWidth=0,this.leftMargin=-1,this.rightMargin=-1,this.topMargin=-1,this.bottomMargin=-1,this.differentFirstPage=void 0,this.differentOddAndEvenPages=void 0,this.bidi=void 0,this.pageStartingNumber=void 0,this.restartPageNumbering=void 0,this.endnoteNumberFormat=void 0,this.footNoteNumberFormat=void 0,this.restartIndexForFootnotes=void 0,this.restartIndexForEndnotes=void 0,this.initialFootNoteNumber=1,this.initialEndNoteNumber=1},e.prototype.destroy=function(){this.headerDistanceIn=void 0,this.footerDistanceIn=void 0,this.pageHeightIn=void 0,this.pageWidthIn=void 0,this.leftMarginIn=void 0,this.rightMarginIn=void 0,this.topMarginIn=void 0,this.bottomMarginIn=void 0,this.differentFirstPageIn=void 0,this.differentOddAndEvenPagesIn=void 0,this.selection=void 0,this.bidi=void 0,this.pageStartingNumberIn=void 0,this.restartPageNumberingIn=void 0,this.endnoteNumberFormatIn=void 0,this.footNoteNumberFormatIn=void 0,this.restartIndexForFootnotesIn=void 0,this.restartIndexForEndnotesIn=void 0,this.initialEndNoteNumber=void 0,this.initialFootNoteNumber=void 0},e}(),Ct=function(){function e(e){this.leftIndentIn=0,this.backgroundIn=void 0,this.tableAlignmentIn=void 0,this.cellSpacingIn=0,this.leftMarginIn=0,this.rightMarginIn=0,this.topMarginIn=0,this.bottomMarginIn=0,this.preferredWidthIn=0,this.bidiIn=void 0,this.selection=e}return Object.defineProperty(e.prototype,"table",{get:function(){return this.tableIn},set:function(e){this.tableIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"leftIndent",{get:function(){return this.leftIndentIn},set:function(e){e!==this.leftIndentIn&&(this.leftIndentIn=e,this.notifyPropertyChanged("leftIndent"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"topMargin",{get:function(){return this.topMarginIn},set:function(e){e!==this.topMarginIn&&(this.topMarginIn=e,this.notifyPropertyChanged("topMargin"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"background",{get:function(){return this.backgroundIn},set:function(e){e!==this.backgroundIn&&(this.backgroundIn=e,this.notifyPropertyChanged("background"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tableAlignment",{get:function(){return this.tableAlignmentIn},set:function(e){e!==this.tableAlignmentIn&&(this.tableAlignmentIn=e,this.notifyPropertyChanged("tableAlignment"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"leftMargin",{get:function(){return this.leftMarginIn},set:function(e){e!==this.leftMarginIn&&(this.leftMarginIn=e,this.notifyPropertyChanged("leftMargin"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bottomMargin",{get:function(){return this.bottomMarginIn},set:function(e){e!==this.bottomMarginIn&&(this.bottomMarginIn=e,this.notifyPropertyChanged("bottomMargin"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"cellSpacing",{get:function(){return this.cellSpacingIn},set:function(e){e!==this.cellSpacingIn&&(this.cellSpacingIn=e,this.notifyPropertyChanged("cellSpacing"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rightMargin",{get:function(){return this.rightMarginIn},set:function(e){e!==this.rightMarginIn&&(this.rightMarginIn=e,this.notifyPropertyChanged("rightMargin"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"preferredWidth",{get:function(){return this.preferredWidthIn},set:function(e){e!==this.preferredWidthIn&&(this.preferredWidthIn=e,this.notifyPropertyChanged("preferredWidth"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"preferredWidthType",{get:function(){return this.preferredWidthTypeIn},set:function(e){e!==this.preferredWidthTypeIn&&(this.preferredWidthTypeIn=e,this.notifyPropertyChanged("preferredWidthType"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bidi",{get:function(){return this.bidiIn},set:function(e){this.bidiIn=e,this.notifyPropertyChanged("bidi")},enumerable:!0,configurable:!0}),e.prototype.getPropertyValue=function(e){switch(e){case"tableAlignment":return this.tableAlignment;case"leftIndent":return this.leftIndent;case"cellSpacing":return this.cellSpacing;case"leftMargin":return this.leftMargin;case"rightMargin":return this.rightMargin;case"topMargin":return this.topMargin;case"bottomMargin":return this.bottomMargin;case"background":var t=new yt;return t.backgroundColor=this.background,t;case"preferredWidth":return this.preferredWidth;case"preferredWidthType":return this.preferredWidthType;case"bidi":return this.bidi;default:return}},e.prototype.notifyPropertyChanged=function(e){if((sf.base.isNullOrUndefined(this.selection)||!this.selection.isCleared&&this.selection.owner.isDocumentLoaded&&!this.selection.owner.isReadOnlyMode&&!this.selection.owner.isPastingContent||this.selection.isRetrieveFormatting)&&!sf.base.isNullOrUndefined(this.selection)&&!sf.base.isNullOrUndefined(this.selection.start)&&!this.selection.isRetrieveFormatting){var t=this.getPropertyValue(e);"background"===e&&(e="shading"),sf.base.isNullOrUndefined(t)||this.selection.owner.editorModule.onApplyTableFormat(e,t)}},e.prototype.copyFormat=function(e){this.leftIndent=e.leftIndent,this.background=e.shading.backgroundColor,this.tableAlignment=e.tableAlignment,this.leftMargin=e.leftMargin,this.rightMargin=e.rightMargin,this.topMargin=e.topMargin,this.bottomMargin=e.bottomMargin,this.cellSpacing=e.cellSpacing,this.preferredWidth=e.preferredWidth,this.preferredWidthType=e.preferredWidthType,this.bidi=e.bidi},e.prototype.clearFormat=function(){this.table=void 0,this.leftIndent=0,this.background=void 0,this.leftIndent=0,this.leftMargin=0,this.rightMargin=0,this.topMargin=0,this.bottomMargin=0,this.cellSpacing=0,this.tableAlignment=void 0,this.bidi=void 0},e.prototype.destroy=function(){this.leftIndentIn=void 0,this.backgroundIn=void 0,this.leftIndentIn=void 0,this.leftMarginIn=void 0,this.rightMarginIn=void 0,this.topMarginIn=void 0,this.bottomMarginIn=void 0,this.cellSpacingIn=void 0,this.tableAlignmentIn=void 0,this.tableIn=void 0,this.selection=void 0,this.bidi=void 0},e}(),Ot=function(){function e(e){this.verticalAlignmentIn=void 0,this.leftMarginIn=0,this.rightMarginIn=0,this.topMarginIn=0,this.bottomMarginIn=0,this.backgroundIn=void 0,this.preferredWidthTypeIn=void 0,this.selection=e}return Object.defineProperty(e.prototype,"verticalAlignment",{get:function(){return this.verticalAlignmentIn},set:function(e){e!==this.verticalAlignmentIn&&(this.verticalAlignmentIn=e,this.notifyPropertyChanged("verticalAlignment"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"leftMargin",{get:function(){return this.leftMarginIn},set:function(e){e!==this.leftMarginIn&&(this.leftMarginIn=e,this.notifyPropertyChanged("leftMargin"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rightMargin",{get:function(){return this.rightMarginIn},set:function(e){e!==this.rightMarginIn&&(this.rightMarginIn=e,this.notifyPropertyChanged("rightMargin"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"topMargin",{get:function(){return this.topMarginIn},set:function(e){e!==this.topMarginIn&&(this.topMarginIn=e,this.notifyPropertyChanged("topMargin"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bottomMargin",{get:function(){return this.bottomMarginIn},set:function(e){e!==this.bottomMarginIn&&(this.bottomMarginIn=e,this.notifyPropertyChanged("bottomMargin"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"background",{get:function(){return this.backgroundIn},set:function(e){e!==this.backgroundIn&&(this.backgroundIn=e,this.notifyPropertyChanged("background"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"preferredWidthType",{get:function(){return this.preferredWidthTypeIn},set:function(e){e!==this.preferredWidthTypeIn&&(this.preferredWidthTypeIn=e,this.notifyPropertyChanged("preferredWidthType"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"preferredWidth",{get:function(){return this.preferredWidthIn},set:function(e){e!==this.preferredWidthIn&&(this.preferredWidthIn=e,this.notifyPropertyChanged("preferredWidth"))},enumerable:!0,configurable:!0}),e.prototype.notifyPropertyChanged=function(e){var t=this.selection;if(!sf.base.isNullOrUndefined(t)){if((t.isCleared||!t.owner.isDocumentLoaded||t.owner.isReadOnlyMode||t.owner.isPastingContent)&&!t.isRetrieveFormatting)return;if(!sf.base.isNullOrUndefined(this.selection.start)&&!this.selection.isRetrieveFormatting){var i=this.getPropertyValue(e);"background"===e&&(e="shading"),sf.base.isNullOrUndefined(i)||this.selection.owner.editorModule.onApplyTableCellFormat(e,i)}}},e.prototype.getPropertyValue=function(e){switch(e){case"verticalAlignment":return this.verticalAlignment;case"leftMargin":return this.leftMargin;case"rightMargin":return this.rightMargin;case"topMargin":return this.topMargin;case"bottomMargin":return this.bottomMargin;case"preferredWidth":return this.preferredWidth;case"preferredWidthType":return this.preferredWidthType;case"background":var t=new yt;return t.backgroundColor=this.background,t;default:return}},e.prototype.copyFormat=function(e){this.leftMargin=e.leftMargin,this.rightMargin=e.rightMargin,this.topMargin=e.topMargin,this.bottomMargin=e.bottomMargin,this.background=e.shading.backgroundColor,this.verticalAlignment=e.verticalAlignment,this.preferredWidth=e.preferredWidth,this.preferredWidthType=e.preferredWidthType},e.prototype.clearCellFormat=function(){this.leftMargin=void 0,this.rightMargin=void 0,this.topMargin=void 0,this.bottomMargin=void 0,this.background=void 0,this.verticalAlignment=void 0},e.prototype.combineFormat=function(e){sf.base.isNullOrUndefined(this.leftMargin)||this.leftMargin===e.leftMargin||(this.leftMargin=void 0),sf.base.isNullOrUndefined(this.topMargin)||this.topMargin===e.topMargin||(this.topMargin=void 0),sf.base.isNullOrUndefined(this.rightMargin)||this.rightMargin===e.rightMargin||(this.rightMargin=void 0),sf.base.isNullOrUndefined(this.bottomMargin)||this.bottomMargin===e.bottomMargin||(this.bottomMargin=void 0),sf.base.isNullOrUndefined(this.background)||this.background===e.shading.backgroundColor||(this.background=void 0),sf.base.isNullOrUndefined(this.verticalAlignment)||this.verticalAlignment===e.verticalAlignment||(this.verticalAlignment=void 0),sf.base.isNullOrUndefined(this.preferredWidth)||this.preferredWidth===e.preferredWidth||(this.preferredWidth=void 0),sf.base.isNullOrUndefined(this.preferredWidthType)||this.preferredWidthType===e.preferredWidthType||(this.preferredWidthType=void 0)},e.prototype.clearFormat=function(){this.background=void 0,this.bottomMargin=0,this.leftMargin=0,this.rightMargin=0,this.topMargin=0,this.verticalAlignment=void 0},e.prototype.destroy=function(){this.backgroundIn=void 0,this.verticalAlignmentIn=void 0,this.bottomMarginIn=void 0,this.leftMarginIn=void 0,this.rightMarginIn=void 0,this.topMarginIn=void 0,this.selection=void 0},e}(),Tt=function(){function e(e){this.heightIn=void 0,this.heightTypeIn=void 0,this.isHeaderIn=void 0,this.allowRowBreakAcrossPagesIn=void 0,this.selection=e}return Object.defineProperty(e.prototype,"height",{get:function(){return this.heightIn},set:function(e){e!==this.heightIn&&(this.heightIn=e,this.notifyPropertyChanged("height"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"heightType",{get:function(){return this.heightTypeIn},set:function(e){e!==this.heightTypeIn&&(this.heightTypeIn=e,this.notifyPropertyChanged("heightType"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isHeader",{get:function(){return this.isHeaderIn},set:function(e){e!==this.isHeaderIn&&(this.isHeaderIn=e,this.notifyPropertyChanged("isHeader"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"allowBreakAcrossPages",{get:function(){return this.allowRowBreakAcrossPagesIn},set:function(e){e!==this.allowRowBreakAcrossPagesIn&&(this.allowRowBreakAcrossPagesIn=e,this.notifyPropertyChanged("allowBreakAcrossPages"))},enumerable:!0,configurable:!0}),e.prototype.notifyPropertyChanged=function(e){var t=this.selection;if((sf.base.isNullOrUndefined(t)||!t.isCleared&&!t.owner.isReadOnlyMode&&t.owner.isDocumentLoaded&&!t.owner.isPastingContent||t.isRetrieveFormatting)&&!sf.base.isNullOrUndefined(t)&&!sf.base.isNullOrUndefined(t.start)&&!t.isRetrieveFormatting){var i=this.getPropertyValue(e);sf.base.isNullOrUndefined(i)||t.owner.editorModule.onApplyTableRowFormat(e,i)}},e.prototype.getPropertyValue=function(e){switch(e){case"height":return this.height;case"heightType":return this.heightType;case"isHeader":return this.isHeader;case"allowBreakAcrossPages":return this.allowBreakAcrossPages;default:return}},e.prototype.copyFormat=function(e){this.height=e.height,this.heightType=e.heightType,this.allowBreakAcrossPages=e.allowBreakAcrossPages,this.isHeader=e.isHeader},e.prototype.combineFormat=function(e){sf.base.isNullOrUndefined(this.height)||this.height===e.height||(this.height=void 0),sf.base.isNullOrUndefined(this.heightType)||this.heightType===e.heightType||(this.heightType=void 0),sf.base.isNullOrUndefined(this.allowBreakAcrossPages)||this.allowBreakAcrossPages===e.allowBreakAcrossPages||(this.allowBreakAcrossPages=void 0),sf.base.isNullOrUndefined(this.isHeader)||this.isHeader===e.isHeader||(this.isHeader=void 0)},e.prototype.clearRowFormat=function(){this.height=void 0,this.heightType=void 0,this.allowBreakAcrossPages=void 0,this.isHeader=void 0},e.prototype.clearFormat=function(){this.height=0,this.heightType=void 0,this.allowBreakAcrossPages=void 0,this.isHeader=void 0},e.prototype.destroy=function(){this.heightIn=void 0,this.heightTypeIn=void 0,this.allowRowBreakAcrossPagesIn=void 0,this.isHeaderIn=void 0,this.selection=void 0},e}(),Pt=function(){function e(e){this.selection=e}return Object.defineProperty(e.prototype,"width",{get:function(){return this.image?this.image.width:0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this.image?this.image.height:0},enumerable:!0,configurable:!0}),e.prototype.resize=function(e,t){this.updateImageFormat(e,t)},e.prototype.updateImageFormat=function(e,t){this.image&&this.selection.owner.editorModule&&this.selection.owner.editorModule.onImageFormat(this.image,e,t)},e.prototype.copyImageFormat=function(e){this.image=e},e.prototype.clearImageFormat=function(){this.image=void 0},e}(),At=function(){function e(e){this.widthIn=0,this.spaceIn=0,this.selection=e}return e.prototype.copyFormat=function(e){this.width=e.width,this.space=e.space},Object.defineProperty(e.prototype,"width",{get:function(){return this.widthIn},set:function(e){e!==this.widthIn&&(this.widthIn=e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"space",{get:function(){return this.spaceIn},set:function(e){e!==this.spaceIn&&(this.spaceIn=e)},enumerable:!0,configurable:!0}),e.prototype.getPropertyValue=function(e){switch(e){case"space":return this.space;case"width":return this.width;default:return}},e.prototype.notifyPropertyChanged=function(e){var t=this.selection;sf.base.isNullOrUndefined(t)||this.selection.owner.editorModule.onApplyColumnFormat("columns",this.selection.sectionFormat.columns)},e.prototype.clearFormat=function(){this.widthIn=0,this.spaceIn=0},e.prototype.destroy=function(){this.widthIn=void 0,this.spaceIn=void 0},e}(),Lt=function(){function e(){this.document=void 0,this.prevListLevel=void 0,this.isOrdered=void 0,this.fieldCheck=0}return e.prototype.writeHtml=function(e){this.document=e;for(var t="",i=0;i<e.sections.length;i++)t+=this.serializeSection(e.sections[i]);return t},e.prototype.serializeSection=function(e){for(var t="",i=0;i<e.blocks.length;i++){var r=e.blocks[i];r.hasOwnProperty("inlines")?t+=this.serializeParagraph(r):r.hasOwnProperty("blocks")?t+=this.serializeSection(r):(t+=this.closeList(),t+=this.serializeTable(r))}return t+=this.closeList(),this.prevListLevel=void 0,this.isOrdered=void 0,t},e.prototype.serializeParagraph=function(e){var t="",i=!1,r=!1;sf.base.isNullOrUndefined(this.prevListLevel)||(r=!0);var n=[],o=void 0;return sf.base.isNullOrUndefined(e.paragraphFormat.listFormat)||(o=this.getListLevel(e),r||(this.prevListLevel=o),this.prevListLevel!==o&&(r=!1),this.prevListLevel=o),r||(t+=this.closeList()),sf.base.isNullOrUndefined(o)||(i=!0),i&&!r&&(t+=this.getHtmlList(o,e.paragraphFormat.listFormat.listLevelNumber)),n.push('style="'+this.serializeParagraphStyle(e,"",i)+';white-space:pre"'),i?t+=this.createAttributesTag("li",n):(this.prevListLevel=void 0,this.isOrdered=void 0,t+=this.createAttributesTag(this.getStyleName(e.paragraphFormat.styleName),n)),0===e.inlines.length?t+="&nbsp":t=this.serializeInlines(e,t),i?(t+=this.endTag("li")).indexOf("<ul")>-1?this.isOrdered=!1:t.indexOf("<ol")>-1&&(this.isOrdered=!0):t+=this.endTag(this.getStyleName(e.paragraphFormat.styleName)),t},e.prototype.closeList=function(){var e="";return sf.base.isNullOrUndefined(this.isOrdered)||(e=this.isOrdered?this.endTag("ol"):this.endTag("ul"),this.isOrdered=void 0),e},e.prototype.getListLevel=function(e){for(var t=void 0,i=void 0,r=0;r<this.document.lists.length;r++)if(this.document.lists[r].listId===e.paragraphFormat.listFormat.listId){i=this.document.lists[r];break}if(i)for(var n=0;n<this.document.abstractLists.length;n++)if(this.document.abstractLists[n].abstractListId===i.abstractListId){t=this.document.abstractLists[n].levels[e.paragraphFormat.listFormat.listLevelNumber];break}return t},e.prototype.getHtmlList=function(e,t){var i="";if("Bullet"===e.listLevelPattern){switch(i+='<ul type="',t){case 0:i+="disc",e.characterFormat.fontFamily="Symbol";break;case 1:i+="circle",e.characterFormat.fontFamily="Symbol";break;case 2:i+="square",e.characterFormat.fontFamily="Wingdings";break;default:i+="disc",e.characterFormat.fontFamily="Symbol"}i+='">'}else{switch(i+='<ol type="',e.listLevelPattern){case"LowLetter":i+="a";break;case"UpLetter":i+="A";break;case"LowRoman":i+="i";break;case"UpRoman":i+="I";break;default:i+="1"}i+='" start="'+e.startAt.toString()+'">'}return i},e.prototype.serializeInlines=function(e,t){for(var i=void 0,r=0;e.inlines.length>r;)if((i=e.inlines[r]).hasOwnProperty("inlines"))t+=this.serializeContentInlines(i,t),r++;else{if(i.hasOwnProperty("imageString"))t+=this.serializeImageContainer(i);else if(i.hasOwnProperty("fieldType"))if(0===i.fieldType){var n=e.inlines[r+1];if(sf.base.isNullOrUndefined(n.text)&&(n=e.inlines[r+2]),sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.text)||!(n.text.indexOf("TOC")>=0||n.text.indexOf("HYPERLINK")>=0))this.fieldCheck=void 0;else{this.fieldCheck=1;var o=[];o.push('style="'+this.serializeInlineStyle(i.characterFormat)+'"'),t+=this.createAttributesTag("a",o)}}else 2===i.fieldType?sf.base.isNullOrUndefined(this.fieldCheck)?this.fieldCheck=0:this.fieldCheck=2:(sf.base.isNullOrUndefined(this.fieldCheck)||0===this.fieldCheck||(t+=this.endTag("a")),this.fieldCheck=0);else{var s=sf.base.isNullOrUndefined(i.text)?"":i.text;if(i.hasOwnProperty("bookmarkType"))switch(i.bookmarkType){case 0:t+="<a name="+i.name+">";break;case 1:t+="</a>"}if(0===this.fieldCheck&&(t+=this.serializeSpan(s,i.characterFormat)),1===this.fieldCheck)t+=' href= "'+s.replace(/"/g,"").replace("HYPERLINK","").trim(),t+='"',t+=">";2===this.fieldCheck&&(t+=s)}r++}return t},e.prototype.serializeContentInlines=function(e,t){return t+=this.serializeInlines(e,t)},e.prototype.serializeSpan=function(e,t){var i="";if(-1!==e.indexOf("\v"))return(i+="<br>").toString();if(-1!==e.indexOf("\f"))return(i+='<br style = "page-break-after:always;"/>').toString();var r=[];return this.serializeInlineStyle(t),r.push('style="'+this.serializeInlineStyle(t)+'"'),i+=this.createAttributesTag("span",r),i+=this.decodeHtmlNames(e.toString()),(i+=this.endTag("span")).toString()},e.prototype.getStyleName=function(e){switch(e){case"Heading 1":return"h1";case"Heading 2":return"h2";case"Heading 3":return"h3";case"Heading 4":return"h4";case"Heading 5":return"h5";default:return"p"}},e.prototype.serializeImageContainer=function(e){var t="",i=[];this.serializeInlineStyle(e.characterFormat);var r="";sf.base.isNullOrUndefined(e.imageString)||(r=e.imageString);var n=x.convertPointToPixel(e.width),o=x.convertPointToPixel(e.height);return i.push('width="'+n.toString()+'"'),i.push('height="'+o.toString()+'"'),i.push('src="'+r+'"'),t+=this.createAttributesTag("img",i),(t+=this.endTag("img")).toString()},e.prototype.serializeCell=function(e){var t="",i=[],r="";if(i=[],!sf.base.isNullOrUndefined(e.cellFormat)){if(sf.base.isNullOrUndefined(e.cellFormat.shading.backgroundColor)||"empty"===e.cellFormat.shading.backgroundColor||i.push('bgcolor="'+x.getColor(e.cellFormat.shading.backgroundColor)+'"'),!sf.base.isNullOrUndefined(e.cellFormat.columnSpan)&&e.cellFormat.columnSpan>1&&i.push('colspan="'+e.cellFormat.columnSpan.toString()+'"'),!sf.base.isNullOrUndefined(e.cellFormat.rowSpan)&&e.cellFormat.rowSpan>1&&i.push('rowspan="'+e.cellFormat.rowSpan.toString()+'"'),!sf.base.isNullOrUndefined(e.cellFormat.cellWidth)&&0!==e.cellFormat.cellWidth){var n=x.convertPointToPixel(e.cellFormat.cellWidth);i.push('width="'+n.toString()+'"')}var o=sf.base.isNullOrUndefined(e.cellFormat.verticalAlignment)?"top":this.convertVerticalAlignment(e.cellFormat.verticalAlignment);i.push('valign="'+o+'"'),sf.base.isNullOrUndefined(e.cellFormat.leftMargin)||0===e.cellFormat.leftMargin||(r+="padding-left:"+e.cellFormat.leftMargin.toString()+"pt;"),sf.base.isNullOrUndefined(e.cellFormat.rightMargin)||0===e.cellFormat.rightMargin||(r+="padding-right:"+e.cellFormat.rightMargin.toString()+"pt;"),sf.base.isNullOrUndefined(e.cellFormat.topMargin)||0===e.cellFormat.topMargin||(r+="padding-top:"+e.cellFormat.topMargin.toString()+"pt;"),sf.base.isNullOrUndefined(e.cellFormat.bottomMargin)||0===e.cellFormat.bottomMargin||(r+="padding-bottom:"+e.cellFormat.bottomMargin.toString()+"pt;"),sf.base.isNullOrUndefined(e.cellFormat.borders)||(r+=this.serializeCellBordersStyle(e.cellFormat.borders))}0!==r.length&&i.push('style="'+r+'"'),t+=this.createAttributesTag("td",i);for(var s=0;s<e.blocks.length;s++){var a=e.blocks[s];a.hasOwnProperty("rows")?t+=this.serializeTable(a):t+=this.serializeParagraph(a)}return t+=this.endTag("td")},e.prototype.convertVerticalAlignment=function(e){switch(e){case"Center":return"middle";case"Bottom":return"bottom";default:return"top"}},e.prototype.serializeTable=function(e){var t="";t+=this.createTableStartTag(e);for(var i=0;i<e.rows.length;i++)t+=this.serializeRow(e.rows[i]);return t+=this.createTableEndTag()},e.prototype.serializeRow=function(e){var t="";t+=this.createRowStartTag(e);for(var i=0;i<e.cells.length;i++)t+=this.serializeCell(e.cells[i]);return t},e.prototype.serializeParagraphStyle=function(e,t,i){var r="";return e.inlines.length>0&&(r+=this.serializeCharacterFormat(e.characterFormat)),r+=this.serializeParagraphFormat(e.paragraphFormat,i)},e.prototype.serializeInlineStyle=function(e){return this.serializeCharacterFormat(e)},e.prototype.serializeTableBorderStyle=function(e){var t="",i={};return i=e.left,sf.base.isNullOrUndefined(i)||"None"===i.lineStyle||"Cleared"===i.lineStyle?!sf.base.isNullOrUndefined(i)&&i.hasNoneStyle&&(t+="border-left-style:none;"):(i.color=sf.base.isNullOrUndefined(i.color)?"#000000":i.color,i.lineWidth=sf.base.isNullOrUndefined(i.lineWidth)?.5:i.lineWidth,t+=this.serializeBorderStyle(i,"left")),i=e.top,sf.base.isNullOrUndefined(i)||"None"===i.lineStyle||"Cleared"===i.lineStyle?!sf.base.isNullOrUndefined(i)&&i.hasNoneStyle&&(t+="border-top-style:none;"):(i.color=sf.base.isNullOrUndefined(i.color)?"#000000":i.color,i.lineWidth=sf.base.isNullOrUndefined(i.lineWidth)?.5:i.lineWidth,t+=this.serializeBorderStyle(i,"top")),i=e.right,sf.base.isNullOrUndefined(i)||"None"===i.lineStyle||"Cleared"===i.lineStyle?!sf.base.isNullOrUndefined(i)&&i.hasNoneStyle&&(t+="border-right-style:none;"):(i.color=sf.base.isNullOrUndefined(i.color)?"#000000":i.color,i.lineWidth=sf.base.isNullOrUndefined(i.lineWidth)?.5:i.lineWidth,t+=this.serializeBorderStyle(i,"right")),i=e.bottom,sf.base.isNullOrUndefined(i)||"None"===i.lineStyle||"Cleared"===i.lineStyle?!sf.base.isNullOrUndefined(i)&&i.hasNoneStyle&&(t+="border-bottom-style:none;"):(i.color=sf.base.isNullOrUndefined(i.color)?"#000000":i.color,i.lineWidth=sf.base.isNullOrUndefined(i.lineWidth)?.5:i.lineWidth,t+=this.serializeBorderStyle(i,"bottom")),t},e.prototype.serializeCellBordersStyle=function(e){var t="",i={};return i=e.left,sf.base.isNullOrUndefined(i)||"None"===i.lineStyle||"Cleared"===i.lineStyle?!sf.base.isNullOrUndefined(i)&&i.hasNoneStyle&&(t+="border-left-style:none;"):(i.color=sf.base.isNullOrUndefined(i.color)?"#000000":i.color,i.lineWidth=sf.base.isNullOrUndefined(i.lineWidth)?.5:i.lineWidth,t+=this.serializeBorderStyle(i,"left")),i=e.top,sf.base.isNullOrUndefined(i)||"None"===i.lineStyle||"Cleared"===i.lineStyle?!sf.base.isNullOrUndefined(i)&&i.hasNoneStyle&&(t+="border-top-style:none;"):(i.color=sf.base.isNullOrUndefined(i.color)?"#000000":i.color,i.lineWidth=sf.base.isNullOrUndefined(i.lineWidth)?.5:i.lineWidth,t+=this.serializeBorderStyle(i,"top")),i=e.right,sf.base.isNullOrUndefined(i)||"None"===i.lineStyle||"Cleared"===i.lineStyle?!sf.base.isNullOrUndefined(i)&&i.hasNoneStyle&&(t+="border-right-style:none;"):(i.color=sf.base.isNullOrUndefined(i.color)?"#000000":i.color,i.lineWidth=sf.base.isNullOrUndefined(i.lineWidth)?.5:i.lineWidth,t+=this.serializeBorderStyle(i,"right")),i=e.bottom,sf.base.isNullOrUndefined(i)||"None"===i.lineStyle||"Cleared"===i.lineStyle?!sf.base.isNullOrUndefined(i)&&i.hasNoneStyle&&(t+="border-bottom-style:none;"):(i.color=sf.base.isNullOrUndefined(i.color)?"#000000":i.color,i.lineWidth=sf.base.isNullOrUndefined(i.lineWidth)?.5:i.lineWidth,t+=this.serializeBorderStyle(i,"bottom")),t},e.prototype.serializeBorderStyle=function(e,t){var i="";return i+="border-"+t+"-style:"+this.convertBorderLineStyle(e.lineStyle),i+=";",e.lineWidth>0&&(i+="border-"+t+"-width:"+e.lineWidth.toString()+"pt;"),sf.base.isNullOrUndefined(e.color)||(i+="border-"+t+"-color:"+x.getColor(e.color)+";"),i},e.prototype.convertBorderLineStyle=function(e){switch(e){case"None":return"none";case"Single":return"solid";case"Dot":return"dotted";case"DashSmallGap":case"DashLargeGap":case"DashDot":case"DashDotDot":return"dashed";case"Double":case"Triple":case"ThinThickSmallGap":case"ThickThinSmallGap":case"ThinThickThinSmallGap":case"ThinThickMediumGap":case"ThickThinMediumGap":case"ThinThickThinMediumGap":case"ThinThickLargeGap":case"ThickThinLargeGap":case"ThinThickThinLargeGap":return"double";case"SingleWavy":return"solid";case"DoubleWavy":return"double";case"DashDotStroked":return"solid";case"Emboss3D":return"ridge";case"Engrave3D":return"groove";case"Outset":return"outset";case"Inset":return"inset";default:return"solid"}},e.prototype.serializeCharacterFormat=function(e){if(!sf.base.isNullOrUndefined(e.inlineFormat))return this.serializeCharacterFormat(e.inlineFormat);var t,i="";return i+="font-weight",i+=":",i+=e.bold?"bold":"normal",i+=";",i+="font-style",i+=":",e.italic?i+="italic":i+="normal",i+=";",i+=this.serializeTextDecoration(e),"Superscript"!==e.baselineAlignment&&"Subscript"!==e.baselineAlignment||(i+="vertical-align",i+=":",i+="Superscript"===e.baselineAlignment?"super":"sub",i+=";"),sf.base.isNullOrUndefined(e.highlightColor)||"NoColor"===e.highlightColor||(i+="background-color",i+=":",i+=x.getHighlightColorCode(e.highlightColor.toString()),i+=";"),t=e.fontColor,sf.base.isNullOrUndefined(t)||(i+="color",i+=":",i+=x.getColor(t),i+=";"),!sf.base.isNullOrUndefined(e.allCaps)&&e.allCaps&&(i+="text-transform",i+=":",i+="uppercase",i+=";"),t=e.fontSize,sf.base.isNullOrUndefined(t)||(i+="font-size",i+=":",i+=t.toString(),i+="pt",i+=";"),t=e.fontFamily,sf.base.isNullOrUndefined(t)||(i+="font-family",i+=":",i+=t.toString(),i+=";"),i.toString()},e.prototype.serializeTextDecoration=function(e){var t="";return"SingleStrike"!==e.strikethrough&&"DoubleStrike"!==e.strikethrough||(t+="line-through "),sf.base.isNullOrUndefined(e.underline)||"None"===e.underline||(t+="underline"),t.length>1&&(t="text-decoration:"+t+";"),t},e.prototype.serializeParagraphFormat=function(e,t){if(!sf.base.isNullOrUndefined(e.inlineFormat))return this.serializeParagraphFormat(e.inlineFormat,t);var i,r="";return i=e.textAlignment,sf.base.isNullOrUndefined(i)||(r+="text-align:"+i.toLowerCase()+";"),i=e.beforeSpacing,sf.base.isNullOrUndefined(i)||(r+="margin-top:"+i.toString()+"pt; "),i=e.rightIndent,sf.base.isNullOrUndefined(i)||(r+="margin-right:"+i.toString()+"pt; "),i=e.afterSpacing,sf.base.isNullOrUndefined(i)||(r+="margin-bottom:"+i.toString()+"pt; "),i=e.leftIndent,t&&(i=0),sf.base.isNullOrUndefined(i)||(r+="margin-left:"+i.toString()+"pt; "),i=e.firstLineIndent,t&&(i=0),sf.base.isNullOrUndefined(i)||0===i||(r+="text-indent:"+i.toString()+"pt;"),i=e.lineSpacing,sf.base.isNullOrUndefined(i)||(r+="line-height:"+(i="Multiple"===e.lineSpacingType?Math.round(10*i)/10:i.toString()+"pt;")),r.toString()},e.prototype.createAttributesTag=function(e,t){var i="";i+="<",i+=e;for(var r=0;r<t.length;r++)i+=" ",i+=t[r];return"a"!==e&&(i+=">"),i},e.prototype.createTag=function(e){var t="";return t+="<",t+=e,t+=">"},e.prototype.endTag=function(e){var t="";return t+="<",t+="/",t+=e,t+=">"},e.prototype.createTableStartTag=function(e){var t="",i="",r=[];return sf.base.isNullOrUndefined(e.tableFormat)||(sf.base.isNullOrUndefined(e.tableFormat.shading)||sf.base.isNullOrUndefined(e.tableFormat.shading.backgroundColor)||"empty"===e.tableFormat.shading.backgroundColor||r.push('bgcolor="'+x.getColor(e.tableFormat.shading.backgroundColor)+'"'),!sf.base.isNullOrUndefined(e.tableFormat.cellSpacing)&&e.tableFormat.cellSpacing>0?r.push('cellspacing="'+(72*e.tableFormat.cellSpacing/96*2).toString()+'"'):i+="border-collapse:collapse;",r.push('cellpadding="0"'),sf.base.isNullOrUndefined(e.tableFormat.leftIndent)||0===e.tableFormat.leftIndent||"Left"!==e.tableFormat.tableAlignment||(i+="margin-left:"+e.tableFormat.leftIndent.toString()+"pt;"),sf.base.isNullOrUndefined(e.tableFormat)||(i+=this.serializeTableWidth(e.tableFormat)),sf.base.isNullOrUndefined(e.tableFormat.borders)||(i+=this.serializeTableBorderStyle(e.tableFormat.borders))),0!==i.length&&r.push('style="',i.toString()+'"'),t+this.createAttributesTag("table",r)},e.prototype.serializeTableWidth=function(e){var t="";switch(e.preferredWidthType){case"Percent":t+="width: "+e.preferredWidth.toString()+"%;";break;case"Point":t+="width: "+e.preferredWidth.toString()+"pt;";break;case"Auto":t+="width: auto;"}return t},e.prototype.createTableEndTag=function(){var e="";return e+=this.endTag("table")},e.prototype.createRowStartTag=function(e){var t="",i=[];if(e.rowFormat.isHeader&&(t+=this.createTag("thead")),!sf.base.isNullOrUndefined(e.rowFormat.height)&&e.rowFormat.height>0){var r=x.convertPointToPixel(e.rowFormat.height);i.push('height="'+r+'"')}return t+this.createAttributesTag("tr",i)},e.prototype.createRowEndTag=function(e){var t="";return t+=this.endTag("tr"),e.rowFormat.isHeader&&(t+=this.endTag("thead")),t},e.prototype.decodeHtmlNames=function(e){if("\t"===e)return"&emsp;";var t=(e=e.replace(/</g,"&lt;").replace(/>/g,"&gt;")).split(" "),i="";if(t.length>0){i=t[0];for(var r=0;r<t.length-1;r++)i+=" "+t[r+1]}return i},e}(),Ft=function(){function e(e){this.location=new M(0,0),this.isUpdateLocation=!0,this.owner=e,this.documentHelper=this.owner.documentHelper}return Object.defineProperty(e.prototype,"paragraph",{get:function(){return this.currentWidget.paragraph},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isAtParagraphStart",{get:function(){return this.offset===this.owner.selection.getStartOffset(this.paragraph)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isAtParagraphEnd",{get:function(){return this.owner.selection.isParagraphLastLine(this.currentWidget)&&this.offset===this.owner.selection.getLineLength(this.currentWidget)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isCurrentParaBidi",{get:function(){return!sf.base.isNullOrUndefined(this.currentWidget.paragraph)&&this.currentWidget.paragraph.paragraphFormat.bidi},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selection",{get:function(){return this.owner.selection},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hierarchicalPosition",{get:function(){return this.getHierarchicalIndexInternal()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"viewer",{get:function(){return this.owner.viewer},enumerable:!0,configurable:!0}),e.prototype.clone=function(){var t=new e(this.owner);return t.currentWidget=this.currentWidget,t.offset=this.offset,t.location=this.location,t},e.prototype.containsRtlText=function(e){for(var t=0;t<e.children.length;t++)if(e.children[t].isRightToLeft)return!0;return!1},e.prototype.setPositionForSelection=function(e,t,i,r){var n=!1;sf.base.isNullOrUndefined(t)?this.currentWidget=e:(this.currentWidget=t.line,t.nextNode instanceof fe&&i>t.length&&(n=this.selection.isLastRenderedInline(t,t.length))),this.location=r,this.offset=n?this.selection.getParagraphLength(this.currentWidget.paragraph)+1:this.currentWidget.getOffset(t,i)},e.prototype.setPositionFromLine=function(e,t,i){this.currentWidget=e,this.offset=t,i instanceof M&&this.location.copy(i)},e.prototype.setPosition=function(e,t){this.currentWidget=e,this.offset=t?this.selection.getStartOffset(e.paragraph):e.paragraph.lastChild.getEndOffset()+1,this.updatePhysicalPosition(!0)},e.prototype.setPositionInternal=function(e){this.currentWidget=e.currentWidget,this.offset=e.offset,this.location=e.location},e.prototype.setPositionForCurrentIndex=function(e){var t={index:e},i=this.getParagraphWidget(t);this.offset=parseFloat(t.index),this.setPositionParagraph(i,this.offset)},e.prototype.getPage=function(e){var t=e.index.indexOf(";"),i="0";return t>=0&&(i=e.index.substring(0,t),e.index=e.index.substring(t).replace(";","")),t=parseInt(i,10),this.documentHelper.pages[t]},e.prototype.getParagraphWidget=function(e){if(!sf.base.isNullOrUndefined(e.index)){var t=this.getPage(e);return this.getLineWidget(void 0,e,t)}},e.prototype.getLineWidget=function(e,t,i){if(!sf.base.isNullOrUndefined(t.index)){var r=t.index.indexOf(";"),n="0";if(r>=0&&(n=t.index.substring(0,r),t.index=t.index.substring(r).replace(";","")),"H"===n||"F"===n)e="H"===n?i.headerWidget:i.footerWidget;else if("FN"===n||"EN"===n){var o=t.index.indexOf(";"),s=t.index.substring(0,o);t.index=t.index.substring(o).replace(";",""),e="FN"===n?i.footnoteWidget.bodyWidgets[s]:i.endnoteWidget.bodyWidgets[s]}else sf.base.isNullOrUndefined(i)||(e=parseInt(n,10)<i.bodyWidgets.length?i.bodyWidgets[parseInt(n,10)]:i.bodyWidgets[0]);if(r=parseInt(n,10),e instanceof re&&(r=t.index.indexOf(";"),n="0",n=t.index.substring(0,r),t.index=t.index.substring(r).replace(";",""),r=parseInt(n,10)),e instanceof ce&&r>=e.childWidgets.length&&(t.index="0;0",r=e.childWidgets.length-1),r>=0&&r<e.childWidgets.length){var a=e.childWidgets[r];if(a instanceof ue)return t.index.indexOf(";")>0&&(t.index="0"),a;if(a instanceof ie)return t.index.indexOf(";")>0?this.getLineWidget(a,t):a instanceof de?this.getLineWidget(this.documentHelper.getFirstParagraphInFirstCell(a),t):a instanceof ce&&-1===t.index.indexOf(";")?this.documentHelper.getFirstParagraphInFirstCell(a.ownerTable).childWidgets[0]:void 0}else if(e.nextRenderedWidget instanceof ie)return t.index="0",e.nextRenderedWidget instanceof de?this.documentHelper.getFirstParagraphInFirstCell(e.nextRenderedWidget).firstChild:this.getLineWidget(e.nextRenderedWidget,t)}},e.prototype.updatePhysicalPosition=function(e){this.currentWidget&&this.owner.isLayoutEnabled&&this.isUpdateLocation&&(this.location=this.selection.getPhysicalPositionInternal(this.currentWidget,this.offset,e))},e.prototype.isAtSamePosition=function(e){return this.currentWidget===e.currentWidget&&this.offset===e.offset},e.prototype.isInSameParagraphIndex=function(e){if(sf.base.isNullOrUndefined(e))throw new Error("textPosition is undefined.");return this.paragraph.index===e.paragraph.index},e.prototype.isInSameParagraph=function(e){if(sf.base.isNullOrUndefined(e))throw new Error("textPosition is undefined.");return this.paragraph===e.paragraph},e.prototype.isExistBefore=function(e){if(sf.base.isNullOrUndefined(e))throw new Error("textPosition is undefined.");if(this.currentWidget===e.currentWidget)return this.offset<e.offset;var t=this.currentWidget.paragraph,i=e.currentWidget.paragraph;return t===i?t.childWidgets.indexOf(this.currentWidget)<i.childWidgets.indexOf(e.currentWidget):t.containerWidget===i.containerWidget?t.isInsideTable?t.associatedCell.childWidgets.indexOf(t)<i.associatedCell.childWidgets.indexOf(i):t.containerWidget.childWidgets.indexOf(t)<i.containerWidget.childWidgets.indexOf(i):this.owner.selection.isExistBefore(t,i)},e.prototype.isExistAfter=function(e){if(sf.base.isNullOrUndefined(e))throw new Error("textPosition is undefined.");if(this.currentWidget===e.currentWidget)return this.offset>e.offset;if(this.currentWidget.paragraph===e.currentWidget.paragraph)return this.currentWidget.paragraph.childWidgets.indexOf(this.currentWidget)>e.currentWidget.paragraph.childWidgets.indexOf(e.currentWidget);var t=this.currentWidget.paragraph,i=e.currentWidget.paragraph;return!sf.base.isNullOrUndefined(t)&&!sf.base.isNullOrUndefined(i)&&(t.containerWidget instanceof ne&&i.containerWidget instanceof ne&&t.containerWidget===i.containerWidget?t.isInsideTable&&i.isInsideTable?t.associatedCell.childWidgets.indexOf(t)>i.associatedCell.childWidgets.indexOf(i):t.containerWidget.childWidgets.indexOf(t)>i.containerWidget.childWidgets.indexOf(i):this.owner.selection.isExistAfter(t,i))},e.prototype.getHierarchicalIndexInternal=function(){return this.getHierarchicalIndex(this.currentWidget,this.offset.toString())},e.prototype.getHierarchicalIndex=function(e,t){return e?e.getHierarchicalIndex(t):t},e.prototype.setPositionParagraph=function(e,t){this.currentWidget=e,this.offset=t,this.updatePhysicalPosition(!0)},e.prototype.setPositionForLineWidget=function(e,t){var i=this.selection.getLineLength(e),r=e.paragraph.childWidgets.indexOf(e);if(e.isLastLine()&&(sf.base.isNullOrUndefined(e.paragraph.bodyWidget.footNoteReference)?i+=1:i+=e.paragraph.bodyWidget.footNoteReference.text.length),t>i){var n=void 0;if(r>=e.paragraph.childWidgets.length-1){var o=this.selection.getNextRenderedBlock(e.paragraph);o&&o.index===e.paragraph.index&&(n=o.firstChild)}else n=e.paragraph.childWidgets[r+1];this.setPositionForLineWidget(n,t-i)}else if(t<0){var s=e.paragraph.childWidgets[r-1],a=this.selection.getLineLength(s)+t;this.setPositionForLineWidget(s,a)}else this.currentWidget=e,this.offset=t,this.updatePhysicalPosition(!0)},e.prototype.moveNextPosition=function(t){sf.base.isNullOrUndefined(t)&&(t=!0);var i=this.selection.getNextStartInline(this.currentWidget,this.offset);if(i instanceof fe&&0===i.fieldType&&!sf.base.isNullOrUndefined(i.fieldEnd)){if(t)return this.moveNextPositionInternal(i),void this.moveNextPosition();var r=i.fieldEnd.line,n=i.fieldEnd,o=r.getOffset(n,1),s=this.getHierarchicalIndex(r,o.toString());if(e.isForwardSelection(this.selection.end.getHierarchicalIndexInternal(),s))return void this.selection.end.moveToInline(i.fieldEnd,1);this.moveToInline(i.fieldEnd,1)}var a=this.selection.getNextValidOffset(this.currentWidget,this.offset),l=this.paragraph.childWidgets.indexOf(this.currentWidget),h=0;if(a>this.offset){this.offset=a;var d=this.currentWidget.getInline(this.offset,h);if(i=d.element,h=d.index,!sf.base.isNullOrUndefined(i)&&h===i.length&&(i.nextNode instanceof fe||i.nextNode instanceof Ce)){var c=this.selection.getNextValidElement(i.nextNode);(c instanceof fe&&1===c.fieldType||c instanceof Ce&&1===c.bookmarkType)&&(i=c,this.currentWidget=i.line,this.offset=this.currentWidget.getOffset(i,this.documentHelper.isFormFillProtectedMode?0:1))}}else if(l+1<this.paragraph.childWidgets.length){var p=this.paragraph.childWidgets[l+1];p&&(this.currentWidget=p,this.offset=this.selection.getStartLineOffset(this.currentWidget));var u=this.currentWidget.getInline(this.offset,h);i=u.element,h=u.index,i instanceof fe&&0===i.fieldType&&this.offset++}else this.updateOffsetToNextParagraph(h,!1);this.updatePhysicalPosition(!0)},e.prototype.moveToPreviousParagraphInTable=function(e){var t,i=this.currentWidget.paragraph;t=i.isInsideTable?e.getPreviousSelectionCell(i.associatedCell):e.getPreviousParagraphBlock(i),sf.base.isNullOrUndefined(t)||(this.currentWidget=t.childWidgets[t.childWidgets.length-1],this.offset=this.currentWidget.getEndOffset()+1)},e.prototype.updateOffsetToNextParagraph=function(e,t){var i,r=!1,n=void 0,o=this.paragraph.childWidgets.indexOf(this.currentWidget);if(t)if(o+1<this.paragraph.childWidgets.length){var s=this.paragraph.childWidgets[o+1];s&&(this.currentWidget=s,this.offset=1)}else{if(n=this.selection.getNextSelectionBlock(this.paragraph),!sf.base.isNullOrUndefined(n))if(n.containerWidget instanceof pe)if(this.selection.start.paragraph.isInsideTable)r=!this.selection.getContainerCellOf(this.selection.start.paragraph.associatedCell,n.associatedCell).ownerTable.contains(n.associatedCell);else r=!0}else n=this.selection.getNextParagraphBlock(this.paragraph);!sf.base.isNullOrUndefined(n)&&n.childWidgets.length>0&&(r?(this.currentWidget=n.childWidgets[n.childWidgets.length-1],this.offset=this.selection.getLineLength(this.currentWidget)+1):(this.currentWidget=n.firstChild,this.offset=t?1:this.selection.getStartLineOffset(this.currentWidget)));var a=this.currentWidget.getInline(this.offset,e);i=a.element,e=a.index,i instanceof fe&&0===i.fieldType&&this.offset++},e.prototype.updateOffsetToPrevPosition=function(e,t){var i,r,n=this.paragraph.childWidgets.indexOf(this.currentWidget),o=this.selection.getPreviousValidOffset(this.currentWidget.paragraph,this.offset);if(this.offset>o)this.offset=o;else if(n>0){var s=this.paragraph.childWidgets[n-1];if(s){this.currentWidget=s;var a=this.currentWidget.getEndOffset();this.offset=a>0?a-1:a}}else{var l=void 0,h=!1;if(t){if(l=this.selection.getPreviousSelectionBlock(this.paragraph),!sf.base.isNullOrUndefined(l))if(l.containerWidget instanceof pe)if(this.selection.start.paragraph.isInsideTable)h=!this.selection.getContainerCellOf(this.selection.start.paragraph.associatedCell,l.associatedCell).ownerTable.contains(l.associatedCell);else h=!0}else l=this.selection.getPreviousParagraphBlock(this.paragraph);sf.base.isNullOrUndefined(l)||(h?(this.currentWidget=l.firstChild,this.offset=this.selection.getStartLineOffset(this.currentWidget)):(this.currentWidget=l.childWidgets[l.childWidgets.length-1],this.offset=this.currentWidget.isEndsWithPageBreak||this.currentWidget.isEndsWithColumnBreak?this.currentWidget.getEndOffset()-1:this.currentWidget.getEndOffset()))}if(e=0,r=(i=this.currentWidget.getInline(this.offset,e)).element,e=i.index,r instanceof fe&&0===r.fieldType&&this.offset++,r instanceof fe){var d=this.selection.getPreviousValidElement(r);sf.base.isNullOrUndefined(d)||(r=d,this.currentWidget=r.line,this.offset=this.currentWidget.getOffset(r,r.length),r instanceof fe&&0===r.fieldType&&this.offset--)}this.updatePhysicalPosition(!0)},e.prototype.moveToNextParagraphStartInternal=function(){var e=this.currentWidget.paragraph;sf.base.isNullOrUndefined(this.selection.getNextParagraphBlock(e))||(this.currentWidget=this.selection.getNextParagraphBlock(e).firstChild,this.offset=this.selection.getStartOffset(e),this.updatePhysicalPosition(!0))},e.prototype.movePreviousPosition=function(){var e=0,t=this.currentWidget.getInline(this.offset,e),i=t.element;e=t.index;this.paragraph.childWidgets.indexOf(this.currentWidget);(i instanceof fe&&1===i.fieldType&&!sf.base.isNullOrUndefined(i.fieldBegin)||i instanceof Ce&&1===i.bookmarkType)&&this.movePreviousPositionInternal(i),this.updateOffsetToPrevPosition(e,!1)},e.prototype.moveNextPositionInternal=function(e){var t;sf.base.isNullOrUndefined(e.fieldSeparator)?t=e.fieldEnd:(t=e.fieldSeparator,this.currentWidget=t.line,this.currentWidget!==e.fieldEnd.line||this.selection.hasValidInline(this.paragraph,t,e.fieldEnd)||(t=e.fieldEnd)),this.currentWidget=t.line,this.offset=this.currentWidget.getOffset(t,1)},e.prototype.moveBackward=function(){var t=0,i=this.currentWidget.getInline(this.offset,t),r=i.element;if(t=i.index,!this.owner.selection.isEmpty&&!sf.base.isNullOrUndefined(r)){var n=this.selection.getNextRenderedElementBox(r,t);if(n instanceof fe&&0===n.fieldType){var o=this.owner.selection.start.getHierarchicalIndexInternal(),s=n.fieldEnd.line.getOffset(n.fieldEnd,1),a=this.getHierarchicalIndex(n.fieldEnd.line,s.toString());if(!e.isForwardSelection(a,o))return void this.owner.selection.start.setPositionParagraph(n.fieldEnd.line,s)}}if(r instanceof fe&&1===r.fieldType&&!sf.base.isNullOrUndefined(r.fieldBegin)){o=this.owner.selection.start.getHierarchicalIndexInternal(),s=r.line.getOffset(r,1),a=this.getHierarchicalIndex(r.line,s.toString());if(!e.isForwardSelection(o,a)){var l=r.fieldBegin.line.getOffset(r.fieldBegin,0);return this.currentWidget=r.fieldBegin.line,this.offset=l,void this.updatePhysicalPosition(!0)}this.movePreviousPositionInternal(r)}this.updateOffsetToPrevPosition(t,!0)},e.prototype.moveForward=function(){var t=0,i=this.currentWidget.getInline(this.offset,t),r=i.element;if(t=i.index,!sf.base.isNullOrUndefined(r)){if(!this.owner.selection.isEmpty&&t===r.length&&r instanceof fe&&1===r.fieldType){var n=this.owner.selection.start.getHierarchicalIndexInternal(),o=r.fieldBegin.line.getOffset(r.fieldBegin,0),s=this.getHierarchicalIndex(r.fieldBegin.line,o.toString());if(!e.isForwardSelection(n,s))return void this.owner.selection.start.setPositionParagraph(r.fieldBegin.line,o)}r=this.selection.getNextRenderedElementBox(r,t)}if(r instanceof fe&&!sf.base.isNullOrUndefined(r.fieldEnd)){var a=0,l=this.owner.selection.start.paragraph.getInline(this.owner.selection.start.offset,a),h=l.element;if(a=l.index,this.selection.getNextRenderedElementBox(h,a)!==r)return r=r.fieldEnd,this.currentWidget=r.line,this.offset=this.currentWidget.getOffset(r,1),void this.updatePhysicalPosition(!0);this.moveNextPositionInternal(r)}else r instanceof fe&&(0===r.fieldType||1===r.fieldType)&&(this.currentWidget=r.line,this.offset=this.currentWidget.getOffset(r,1));t=0;var d=this.selection.getNextValidOffset(this.currentWidget,this.offset),c=this.selection.getLineLength(this.currentWidget),p=this.selection.isParagraphLastLine(this.currentWidget);if(this.offset<d){this.offset=d;var u=this.currentWidget.getInline(this.offset,t);if(r=u.element,t=u.index,!sf.base.isNullOrUndefined(r)&&t===r.length&&r.nextNode instanceof fe){var g=this.selection.getNextValidElement(r.nextNode);g instanceof fe&&1===g.fieldType&&(r=g,this.offset=this.currentWidget.getOffset(r,1))}}else this.offset===d&&r instanceof fe&&1===r.fieldType&&r.previousNode instanceof Re?this.offset=d:this.offset===d&&this.offset<c+1&&p?this.offset=c+1:this.updateOffsetToNextParagraph(t,!0);this.updatePhysicalPosition(!0)},e.prototype.moveToInline=function(e,t){this.currentWidget=e.line,this.offset=this.currentWidget.getOffset(e,t),this.updatePhysicalPosition(!0)},e.isForwardSelection=function(e,t){if(e===t)return!0;e=e.replace(/C;/g,""),t=t.replace(/C;/g,""),e=e.replace(/H;/g,""),t=t.replace(/H;/g,""),e=e.replace(/F;/g,""),t=t.replace(/F;/g,""),e=e.replace(/FN;/g,""),t=t.replace(/FN;/g,""),e=e.replace(/EN;/g,""),t=t.replace(/EN;/g,"");var i=e.split(";"),r=t.split(";"),n=i.length;n>r.length&&(n=r.length-1);for(var o=0;o<n;o++){var s=parseFloat(i[o]),a=parseFloat(r[o]);if(s!==a)return s<a}return!1},e.prototype.movePreviousPositionInternal=function(e){var t;t=e instanceof fe&&sf.base.isNullOrUndefined(e.fieldSeparator)?this.selection.getPreviousValidElement(e.fieldBegin):this.selection.getPreviousValidElement(e),this.currentWidget=t.line;var i=t instanceof fe||t instanceof Ce&&1===t.bookmarkType?0:t.length;this.offset=this.currentWidget.getOffset(t,i)},e.prototype.moveToWordStartInternal=function(e){var t=this.currentWidget.getEndOffset(),i=this.currentWidget.paragraph,r=this.selection;if(2!==e||this.offset!==t&&this.offset!==t+1){if(this.offset===t+1)this.offset=t;else if(this.offset===r.getStartOffset(i)&&this.currentWidget===i.childWidgets[0]){var n=r.getPreviousParagraphBlock(i);if(sf.base.isNullOrUndefined(n))return;this.currentWidget=n.childWidgets[n.childWidgets.length-1],this.offset=this.currentWidget.getEndOffset()}else{if(this.offset===r.getStartLineOffset(this.currentWidget)){var o=i.childWidgets.indexOf(this.currentWidget);o-1>=0&&(this.currentWidget=i.childWidgets[o-1],this.offset=this.currentWidget.getEndOffset())}var s=0,a=this.currentWidget.getInline(this.offset,s),l=a.element;s=a.index,this.getPreviousWordOffset(l,r,s,e,l instanceof fe&&1===l.fieldType,!1,!1,this)}1===e&&this.calculateOffset(),this.updatePhysicalPosition(!0)}},e.prototype.getNextWordOffset=function(e,t,i,r,n,o,s){e instanceof we?this.getNextWordOffsetSpan(e,t,i,r,n,o,s):e instanceof Re?this.getNextWordOffsetImage(e,t,i,r,n,o,s):e instanceof fe&&0===e.fieldType?this.getNextWordOffsetFieldBegin(e,t,i,r,n,o,s):e instanceof fe&&2===e.fieldType||e instanceof Ce?this.getNextWordOffsetFieldSeparator(e,t,i,r,n,o,s):e instanceof fe&&1===e.fieldType?this.getNextWordOffsetFieldEnd(e,t,i,r,n,o,s):e instanceof nt&&this.getNextWordOffsetComment(e,t,i,r,n,o,s)},e.prototype.getNextWordOffsetFieldBegin=function(e,t,i,r,n,o,s){var a=e.line.getOffset(e,0);e.length;if(sf.base.isNullOrUndefined(e.fieldSeparator))this.getNextWordOffsetFieldEnd(e.fieldEnd,0,i,r,n,o,s);else if(0===i)this.getNextWordOffsetFieldSeparator(e.fieldSeparator,0,i,r,n,o,s);else if(!sf.base.isNullOrUndefined(e.fieldEnd)){var l=e.fieldSeparator;if(l.line.paragraph!==e.fieldEnd.line.paragraph||this.selection.hasValidInline(l.line.paragraph,l,e.fieldEnd)||(l=e.fieldEnd),this.getNextWordOffset(l,0,i,!(o.paragraph===e.line.paragraph&&o.offset===a),n,o,s),n&&!sf.base.isNullOrUndefined(e.fieldSeparator)&&o.paragraph===e.line.paragraph&&o.offset===e.fieldSeparator.line.getOffset(e.fieldSeparator,e.fieldSeparator.length))return void o.setPositionParagraph(e.line,a);n||o.setPositionParagraph(e.fieldEnd.line,e.fieldEnd.line.getOffset(e.fieldEnd,e.fieldEnd.length))}},e.prototype.getNextWordOffsetImage=function(e,t,i,r,n,o,s){if(r)return o.setPositionParagraph(e.line,e.line.getOffset(e,t)),void(n=!1);if(0===t){var a=e.line.getOffset(e,0);n=!0,o.offset===a?sf.base.isNullOrUndefined(e.nextNode)?o.setPositionParagraph(e.line,a+e.length):this.getNextWordOffset(e.nextNode,0,i,r,n,o,s):o.setPositionParagraph(e.line,a)}else sf.base.isNullOrUndefined(e.nextNode)||this.getNextWordOffset(e.nextNode,0,i,r,n,o,s)},e.prototype.getNextWordOffsetSpan=function(e,t,i,r,n,o,s){if("\t"===e.text||"\v"===e.text){if(r)return o.setPositionParagraph(e.line,e.line.getOffset(e,t)),void(n=!1);if(0===t){n=!0;var a=e.line.getOffset(e,0);o.offset===a?o.setPositionParagraph(e.line,a+e.length):o.setPositionParagraph(e.line,a)}else sf.base.isNullOrUndefined(e.nextNode)||this.getNextWordOffset(e.nextNode,0,i,r,n,o,s)}else{var l=0;if(0===t&&n&&-1===x.wordSplitCharacters.indexOf(e.text[0])){if(o.setPositionParagraph(e.line,e.line.getOffset(e,t)),r)return}else if(t<e.length){var h=t>0&&e.text.length-1>=t?e.text.slice(t,e.length):e.text;if(-1===(l=x.indexOfAny(h,x.wordSplitCharacters))&&e.nextNode instanceof nt&&sf.base.isNullOrUndefined(e.nextNode.nextNode)&&(l=e.length),-1!==l){if(r)return void(n=!1);var d=e.line.getOffset(e,l+t),c=[" ","　"];if((s||-1===c.indexOf(h[l]))&&!n&&e.line.paragraph===o.paragraph&&d!==o.offset)return n=!0,void o.setPositionParagraph(e.line,d);var p=!1;for(-1!==c.indexOf(h[l])&&-1===c.indexOf(h[l+1])&&(p=!0,l++);l<h.length&&!p&&-1!==x.wordSplitCharacters.indexOf(h[l]);)if(l++,-1!==c.indexOf(h[l])&&-1===c.indexOf(h[l+1])&&-1!==x.wordSplitCharacters.indexOf(h[l+1])){l++;break}n=!0;var u=void 0;sf.base.isNullOrUndefined(e.nextNode)||(u=e.nextNode.text),l<h.length||-1!==c.indexOf(h[h.length-1])&&!sf.base.isNullOrUndefined(u)&&-1===c.indexOf(u[0])||sf.base.isNullOrUndefined(e.nextNode)?o.setPositionParagraph(e.line,e.line.getOffset(e,l+t)):this.getNextWordOffset(e.nextNode,0,i,r,n,o,s)}else sf.base.isNullOrUndefined(e.nextNode)?o.setPositionParagraph(e.line,e.line.getEndOffset()):this.getNextWordOffset(e.nextNode,0,i,r,n,o,s)}else sf.base.isNullOrUndefined(e.nextNode)||this.getNextWordOffset(e.nextNode,0,i,r,n,o,s)}},e.prototype.getNextWordOffsetFieldSeparator=function(e,t,i,r,n,o,s){sf.base.isNullOrUndefined(e.nextNode)||this.getNextWordOffset(e.nextNode,0,i,r,n,o,s)},e.prototype.getNextWordOffsetComment=function(e,t,i,r,n,o,s){sf.base.isNullOrUndefined(e.nextNode)||this.getNextWordOffset(e.nextNode,0,i,r,n,o,s)},e.prototype.getNextWordOffsetFieldEnd=function(e,t,i,r,n,o,s){var a=e.line.getOffset(e,0),l=a+e.length;o.offset===a&&(o.setPositionParagraph(e.line,l),sf.base.isNullOrUndefined(e.nextNode))||(sf.base.isNullOrUndefined(e.nextNode)?o.setPositionParagraph(e.line,a):(this.getNextWordOffset(e.nextNode,0,i,!1,n,o,s),o.offset===l&&o.setPositionParagraph(e.line,a)),n=!0)},e.prototype.getPreviousWordOffset=function(e,t,i,r,n,o,s,a){e instanceof we?this.getPreviousWordOffsetSpan(e,t,i,r,n,o,s,a):e instanceof Re?this.getPreviousWordOffsetImage(e,t,i,r,n,o,s,a):e instanceof fe&&0===e.fieldType?this.getPreviousWordOffsetFieldBegin(e,t,i,r,n,o,s,a):e instanceof fe&&2===e.fieldType?this.getPreviousWordOffsetFieldSeparator(e,t,i,r,n,o,s,a):e instanceof fe&&1===e.fieldType?this.getPreviousWordOffsetFieldEnd(e,t,i,r,n,o,s,a):e instanceof Ce?this.getPreviousWordOffsetBookMark(e,t,i,r,n,o,s,a):e instanceof je&&e.previousNode?this.getPreviousWordOffsetSpan(e.previousNode,t,i,r,n,o,s,a):e instanceof nt&&this.getPreviousWordOffsetComment(e,t,i,r,n,o,s,a)},e.prototype.getPreviousWordOffsetBookMark=function(e,t,i,r,n,o,s,a){if(e.previousNode){if(e.previousNode instanceof we){var l=e.previousNode;x.lastIndexOfAny(l.text,x.wordSplitCharacters)!==l.text.length-1?this.getPreviousWordOffset(l,t,i,r,n,o,s,a):a.setPositionParagraph(e.line,e.line.getOffset(e,0))}}else a.setPositionParagraph(e.line,t.getStartLineOffset(e.line))},e.prototype.getPreviousWordOffsetFieldEnd=function(e,t,i,r,n,o,s,a){var l=e.line.getOffset(e,0),h=l+e.length;if(sf.base.isNullOrUndefined(e.fieldSeparator))this.getPreviousWordOffsetFieldBegin(e.fieldBegin,t,0,r,n,o,s,a);else if(0!==r||sf.base.isNullOrUndefined(e.previousNode)){if(!sf.base.isNullOrUndefined(e.fieldBegin)&&0!==r){d=e.previousNode;if((sf.base.isNullOrUndefined(d)||d.line.paragraph===e.fieldBegin.line.paragraph&&!t.hasValidInline(d.line.paragraph,d,e.fieldBegin))&&(d=e.fieldBegin),this.getPreviousWordOffset(d,t,d.length,r,!(a.paragraph===e.line.paragraph&&a.offset===h),o,s,a),s&&a.paragraph===e.line.paragraph&&a.offset===l)return void a.setPositionParagraph(e.line,h);s||a.setPositionParagraph(e.fieldBegin.line,e.fieldBegin.line.getOffset(e.fieldBegin,0))}}else{var d=e.previousNode;this.getPreviousWordOffset(d,t,d.length,r,d instanceof fe&&1===d.fieldType,o,s,a)}},e.prototype.getPreviousWordOffsetFieldSeparator=function(e,t,i,r,n,o,s,a){this.getPreviousWordOffsetFieldBegin(e.fieldBegin,t,e.fieldBegin.length,r,n,o,s,a)},e.prototype.getPreviousWordOffsetComment=function(e,t,i,r,n,o,s,a){if(e.previousNode){var l=e.previousNode;e.previousNode instanceof we&&x.lastIndexOfAny(l.text,x.wordSplitCharacters)!==l.text.length-1?this.getPreviousWordOffset(l,t,i,r,n,o,s,a):this.getPreviousWordOffset(e.previousNode,t,e.previousNode.length,r,n,o,s,a)}else a.setPositionParagraph(e.line,t.getStartLineOffset(e.line))},e.prototype.getPreviousWordOffsetFieldBegin=function(e,t,i,r,n,o,s,a){var l=e.line.getOffset(e,0),h=l+e.length;a.offset===h&&a.setPositionParagraph(e.line,l),sf.base.isNullOrUndefined(e.previousNode)?e.fieldSeparator?a.setPositionParagraph(e.line,e.fieldSeparator.line.getOffset(e.fieldSeparator,e.fieldSeparator.length)):a.setPositionParagraph(e.line,t.getStartLineOffset(e.line)):(this.getPreviousWordOffset(e.previousNode,t,e.previousNode.length,r,!1,o,s,a),a.offset===l&&(0===r||sf.base.isNullOrUndefined(e.fieldSeparator)||a.setPositionParagraph(e.line,e.fieldSeparator.line.getOffset(e.fieldSeparator,e.fieldSeparator.length))))},e.prototype.getPreviousWordOffsetImage=function(e,t,i,r,n,o,s,a){if(n)return a.setPositionParagraph(e.line,e.line.getOffset(e,i)),void(s=!1);if(i===e.length){var l=e.line.getOffset(e,e.length);l===a.offset?a.setPositionParagraph(e.line,l-e.length):a.setPositionParagraph(e.line,l)}else sf.base.isNullOrUndefined(e.previousNode)||this.getPreviousWordOffset(e.previousNode,t,e.previousNode.length,r,n,o,s,a)},e.prototype.getPreviousWordOffsetSpan=function(e,t,i,r,n,o,s,a){if("\t"===e.text||"\v"===e.text){if(n)return void(s=!1);if(i===e.length){s=!0;var l=e.line.getOffset(e,e.length);l===a.offset?a.setPositionParagraph(e.line,l-e.length):a.setPositionParagraph(e.line,l)}else sf.base.isNullOrUndefined(e.previousNode)||this.getPreviousWordOffset(e.previousNode,t,e.previousNode.length,r,n,o,s,a)}else{var h=0;if(!o){for(;i>0&&" "===e.text[i-1];)i--;a.setPositionParagraph(e.line,e.line.getOffset(e,i))}if(i>0){if(o=!0,0===i&&s&&-1===x.wordSplitCharacters.indexOf(e.text[0]))return a.setPositionParagraph(e.line,e.line.getOffset(e,i)),void(s=!0);var d=e.text.length>i?e.text.slice(0,i):e.text;if(-1===(h=x.lastIndexOfAny(d,x.wordSplitCharacters))&&e.previousElement instanceof nt&&sf.base.isNullOrUndefined(e.previousNode.previousNode)&&(h=e.length),-1!==h){if(n)return void(s=!1);for(;h>0&&s&&" "!==d[h]&&-1!==x.wordSplitCharacters.indexOf(d[h-1]);)h--;if(" "!==d[h]&&"　"!==d[h]&&s||h++,s=!0,h>0){var c=e.line.getOffset(e,h);e.line.paragraph===a.paragraph&&c===a.offset?this.getPreviousWordOffsetSpan(e,t,i,r,n,o,s,a):a.setPositionParagraph(e.line,c)}else if(e.previousNode instanceof we){var p=e.previousNode.text;if(-1!==x.wordSplitCharacters.indexOf(e.text[0])&&-1===x.wordSplitCharacters.indexOf(p[p.length-1])){c=e.line.getOffset(e,h);return void a.setPositionParagraph(e.line,c)}this.getPreviousWordOffset(e.previousNode,t,e.previousNode.length,r,n,o,s,a)}else a.setPositionParagraph(e.line,e.line.getOffset(e,0))}else this.setPreviousWordOffset(e,t,i,r,n,o,s,a)}else this.setPreviousWordOffset(e,t,i,r,n,o,s,a)}},e.prototype.setPreviousWordOffset=function(e,t,i,r,n,o,s,a){e.previousNode instanceof ge&&e.line===e.previousNode.line?this.getPreviousWordOffset(e.previousNode,t,e.previousNode.length,r,n,o,s,a):a.setPositionParagraph(e.line,t.getStartLineOffset(e.line))},e.prototype.validateForwardFieldSelection=function(t,i){var r=new e(this.owner);r.setPositionForCurrentIndex(t),r.isUpdateLocation=!1;var n=!1;for(this.selection.start.paragraph===this.selection.end.paragraph&&this.selection.start.offset!==this.selection.getStartOffset(this.selection.start.paragraph)||this.selection.end.offset===this.selection.end.currentWidget.getEndOffset()&&this.selection.isParagraphLastLine(this.selection.end.currentWidget)&&this.selection.end.setPositionParagraph(this.selection.end.currentWidget,this.selection.end.offset+1);t!==i&&e.isForwardSelection(t,i);){if(!n)if(r.moveNextPosition(!1),t===r.getHierarchicalIndexInternal())break;var o=0,s=r.currentWidget.getInline(r.offset,o),a=s.element;if(o=s.index,!sf.base.isNullOrUndefined(a)){var l=this.selection.start.getHierarchicalIndexInternal();if(o===a.length&&a instanceof fe&&1===a.fieldType){if(a.line.getOffset(a,0)===this.offset)return;var h=a.fieldBegin.line,d=h.getOffset(a.fieldBegin,0),c=this.getHierarchicalIndex(h,d.toString());e.isForwardSelection(l,c)||this.selection.start.setPositionParagraph(h,d)}var p=this.selection.getNextRenderedElementBox(a,o);!sf.base.isNullOrUndefined(p)&&p instanceof ge&&(a=p)}if(n=a instanceof fe&&0===a.fieldType&&!sf.base.isNullOrUndefined(a.fieldEnd)){if(a.line.getOffset(a,0)===this.offset)return;var u=a.fieldEnd,g=(u.line.paragraph,u.line.getOffset(u,1)),f=this.getHierarchicalIndex(u.line,g.toString());if(!e.isForwardSelection(f,i))return void this.moveToInline(a.fieldEnd,1);r.moveToInline(a.fieldEnd,1)}t=r.getHierarchicalIndexInternal()}},e.prototype.validateBackwardFieldSelection=function(t,i){var r=new e(this.owner);r.setPositionForCurrentIndex(t),r.isUpdateLocation=!1;var n=!1;(this.selection.start.paragraph!==this.selection.end.paragraph&&this.selection.end.offset!==this.selection.getStartOffset(this.selection.start.paragraph)||this.documentHelper.isSelectionChangedOnMouseMoved&&this.selection.isParagraphFirstLine(this.selection.end.currentWidget)&&this.selection.end.offset===this.selection.getStartOffset(this.selection.start.paragraph)||(sf.base.isNullOrUndefined(this.selection.start.paragraph.previousRenderedWidget)&&this.selection.start.paragraph===this.selection.end.paragraph&&this.selection.end.offset===this.selection.getStartOffset(this.selection.end.paragraph)||this.selection.start.paragraph!==this.selection.end.paragraph)&&this.selection.start.offset===this.selection.start.currentWidget.getEndOffset()&&this.selection.start.currentWidget.isLastLine())&&(n=!0),n&&this.selection.start.offset===this.selection.start.currentWidget.getEndOffset()&&this.selection.isParagraphLastLine(this.selection.start.currentWidget)&&this.selection.start.setPositionParagraph(this.selection.start.currentWidget,this.selection.start.offset+1);for(var o=this.selection.start.getHierarchicalIndexInternal();t!==i&&e.isForwardSelection(i,t);){var s=0,a=r.currentWidget.getInline(r.offset,s),l=a.element;if(s=a.index,!sf.base.isNullOrUndefined(l)){var h=this.selection.getNextRenderedElementBox(l,s);if(h instanceof fe&&0===h.fieldType){var d=h.fieldEnd.line,c=d.getOffset(h.fieldEnd,1),p=this.getHierarchicalIndex(d,c.toString());e.isForwardSelection(p,o)||(this.selection.start.setPositionParagraph(d,c),o=p)}}if(l instanceof fe&&1===l.fieldType&&!sf.base.isNullOrUndefined(l.fieldBegin)){var u=l.fieldBegin.line,g=l.fieldBegin,f=u.getOffset(g,0),m=this.getHierarchicalIndex(u,f.toString());if(!e.isForwardSelection(i,m))return void this.moveToInline(l.fieldBegin,0);r.moveToInline(l.fieldBegin,0)}else r.movePreviousPosition();t=r.getHierarchicalIndexInternal()}},e.prototype.paragraphStartInternal=function(e,t){var i=e.getStartLineOffset(this.currentWidget);if(this.offset===i&&t){if(this.moveToNextParagraphInTableCheck())this.moveToPreviousParagraphInTable(e);else if(!sf.base.isNullOrUndefined(e.getPreviousParagraphBlock(this.currentWidget.paragraph))){var r=e.getPreviousParagraphBlock(this.currentWidget.paragraph);this.currentWidget=r.childWidgets[0],this.offset=e.getStartLineOffset(this.currentWidget)}}else this.currentWidget=this.currentWidget.paragraph.getSplitWidgets()[0].childWidgets[0],this.offset=i;this.calculateOffset()},e.prototype.calculateOffset=function(){var e=this.owner.selection.start.getHierarchicalIndexInternal(),t=this.getHierarchicalIndexInternal();e!==t&&this.validateBackwardFieldSelection(e,t),this.updatePhysicalPosition(!0)},e.prototype.moveToParagraphStartInternal=function(e,t){for(var i=this.currentWidget.paragraph;i.previousSplitWidget;)i=i.previousSplitWidget;var r=e.getStartOffset(i);this.offset===r&&t?this.moveToNextParagraphInTableCheck()?this.moveToPreviousParagraphInTable(e):sf.base.isNullOrUndefined(e.getPreviousParagraphBlock(this.paragraph))||(this.currentWidget=e.getPreviousParagraphBlock(this.paragraph).firstChild,this.offset=e.getStartOffset(this.paragraph)):(this.currentWidget=i.firstChild,this.offset=e.getStartLineOffset(this.currentWidget));var n=this.owner.selection.start.getHierarchicalIndexInternal(),o=this.getHierarchicalIndexInternal();n!==o&&this.validateBackwardFieldSelection(n,o),this.updatePhysicalPosition(!1)},e.prototype.moveToParagraphEndInternal=function(e,t){for(var i=this.currentWidget.paragraph;i.nextSplitWidget;)i=i.nextSplitWidget;this.currentWidget=i.childWidgets[i.childWidgets.length-1];var r=this.currentWidget.getEndOffset()+1;if(this.offset===r&&t){if(this.moveToNextParagraphInTableCheck())this.moveToNextParagraphInTable();else if(!sf.base.isNullOrUndefined(e.getNextParagraphBlock(this.currentWidget.paragraph))){var n=e.getNextParagraphBlock(this.currentWidget.paragraph);this.currentWidget=n.childWidgets[n.childWidgets.length-1],this.offset=this.currentWidget.getEndOffset()+1}}else this.offset=r;this.calculateOffset()},e.prototype.moveUp=function(e,t){var i=this.currentWidget.paragraph;this.moveToLineStartInternal(e,!0),this.movePreviousPosition();var r=void 0,n=this.currentWidget.paragraph;if(i.isInsideTable&&i!==n&&i.associatedCell!==n.associatedCell&&!sf.base.isNullOrUndefined(n.associatedCell)&&i.associatedCell.ownerRow===n.associatedCell.ownerRow){var o=n.associatedCell.ownerRow;if(o.previousRenderedWidget instanceof ce){var s=e.getFirstCellInRegion(o.previousRenderedWidget,n.associatedCell,t,!0),a=e.getLastParagraph(s);this.setPosition(a.childWidgets[a.childWidgets.length-1],!1)}else{var l=o.ownerTable.previousRenderedWidget;do{l instanceof de&&(l=e.getLastBlockInLastCell(l))}while(l instanceof de);l instanceof le&&this.setPosition(l.childWidgets[l.childWidgets.length-1],!1)}r=e.getLineWidgetParagraph(this.offset,this.currentWidget)}else{if(!i.isInsideTable&&this.currentWidget.paragraph.isInsideTable){s=e.getFirstCellInRegion(this.currentWidget.paragraph.associatedCell.ownerRow,this.currentWidget.paragraph.associatedCell,this.owner.selection.upDownSelectionLength,!0),a=e.getLastParagraph(s);this.setPosition(a.childWidgets[a.childWidgets.length-1],!1)}else if(i.isInsideTable&&!sf.base.isNullOrUndefined(this.currentWidget.paragraph.associatedCell)&&i.associatedCell.ownerRow.previousRenderedWidget!==i.associatedCell.ownerRow.previousSplitWidget&&i.associatedCell.ownerRow.previousRenderedWidget===this.currentWidget.paragraph.associatedCell.ownerRow){s=e.getLastCellInRegion(this.currentWidget.paragraph.associatedCell.ownerRow,this.currentWidget.paragraph.associatedCell,this.owner.selection.upDownSelectionLength,!0),a=e.getLastParagraph(s);this.setPosition(a.childWidgets[a.childWidgets.length-1],!1)}r=e.getLineWidgetParagraph(this.offset,this.currentWidget)}var h=e.getTop(r);(this.currentWidget.isEndsWithPageBreak||this.currentWidget.isEndsWithColumnBreak)&&this.offset===this.currentWidget.getEndOffset()-1&&(t=this.location.x),e.updateTextPositionWidget(r,new M(t,h),this,!1)},e.prototype.moveDown=function(e,t){var i=this.currentWidget.paragraph,r=this.currentWidget;this.moveToLineEndInternal(e,!0);var n=this.selection.getParagraphLength(this.currentWidget.paragraph);this.offset>n&&(this.offset=n),this.moveNextPosition();var o=void 0;if(i.isInsideTable&&i!==this.currentWidget.paragraph&&i.associatedCell!==this.currentWidget.paragraph.associatedCell&&!sf.base.isNullOrUndefined(this.currentWidget.paragraph.associatedCell)&&i.associatedCell.ownerRow===this.currentWidget.paragraph.associatedCell.ownerRow){var s=this.currentWidget.paragraph.associatedCell.ownerRow;if(i.isInsideTable&&this.currentWidget.paragraph.isInsideTable&&i.associatedCell.cellFormat.rowSpan>1&&i.associatedCell.cellFormat.rowSpan+i.associatedCell.ownerRow.rowIndex===i.associatedCell.ownerTable.childWidgets.length&&(s=this.currentWidget.paragraph.associatedCell.ownerTable.childWidgets[this.currentWidget.paragraph.associatedCell.ownerTable.childWidgets.length-1]),s.nextRenderedWidget instanceof ce){var a=this.selection.getLastCellInRegion(s.nextRenderedWidget,this.currentWidget.paragraph.associatedCell,t,!1);this.setPosition(this.selection.getFirstParagraph(a).childWidgets[0],!0)}else{var l=this.selection.getNextRenderedBlock(s.ownerTable);do{l instanceof de&&(l=this.selection.getFirstBlockInFirstCell(l))}while(l instanceof de);l instanceof le&&this.setPosition(l.childWidgets[0],!0)}o=e.getLineWidgetParagraph(this.offset,this.currentWidget)}else{if(!i.isInsideTable&&this.currentWidget.paragraph.isInsideTable){a=this.selection.getLastCellInRegion(this.currentWidget.paragraph.associatedCell.ownerRow,this.currentWidget.paragraph.associatedCell,this.owner.selection.upDownSelectionLength,!1);this.setPosition(this.selection.getFirstParagraph(a).childWidgets[0],!0)}else if(i.isInsideTable&&!sf.base.isNullOrUndefined(this.currentWidget.paragraph.associatedCell)&&i.associatedCell.ownerRow.nextRenderedWidget!==i.associatedCell.ownerRow.nextSplitWidget&&i.associatedCell.ownerRow.nextRenderedWidget===this.currentWidget.paragraph.associatedCell.ownerRow){a=e.getLastCellInRegion(this.currentWidget.paragraph.associatedCell.ownerRow,this.currentWidget.paragraph.associatedCell,this.owner.selection.upDownSelectionLength,!0);this.setPosition(e.getFirstParagraph(a).childWidgets[0],!1)}o=e.getLineWidgetParagraph(this.offset,this.currentWidget)}var h=this.selection.getTop(o);o!==r&&this.selection.updateTextPositionWidget(o,new M(t,h),this,!1)},e.prototype.moveToLineStartInternal=function(e,t){this.location.x>this.viewer.clientActiveArea.right&&(this.offset=this.offset-1);var i=e.getLineWidgetInternal(this.currentWidget,this.offset,t),r=e.getFirstElementInternal(i);this.documentHelper.moveCaretPosition=1;var n=e.getStartOffset(this.currentWidget.paragraph);if(sf.base.isNullOrUndefined(r)&&this.offset>n){var o=0,s=(l=this.currentWidget.getInline(this.offset,o)).element;o=l.index,s instanceof we&&"\v"!==s.text&&(this.offset=n)}else if(!sf.base.isNullOrUndefined(r)){var a=0;this.currentWidget=r.line,this.offset=this.currentWidget.getOffset(r,a),a=0;var l;s=(l=this.currentWidget.getInline(this.offset,a)).element;if(a=l.index,s instanceof fe){var h=e.getPreviousValidElement(s);sf.base.isNullOrUndefined(h)||(s=h,this.currentWidget=s.line,this.offset=this.currentWidget.getOffset(s,s.length),s instanceof fe&&this.offset--)}}this.updatePhysicalPosition(!0)},e.prototype.moveToNextParagraphInTableCheck=function(){return!(!this.selection.start.paragraph.isInsideTable&&!this.paragraph.isInsideTable||this.selection.start.paragraph.associatedCell===this.paragraph.associatedCell&&!this.selection.isCellSelected(this.selection.start.paragraph.associatedCell,this.selection.start,this))},e.prototype.moveToWordEndInternal=function(e,t){var i=0,r=this.currentWidget.getEndOffset();if(this.selection.isParagraphFirstLine(this.currentWidget)&&(this.currentWidget.children[0]instanceof je&&(i=1),this.currentWidget.children[1]instanceof je&&(i=2)),this.offset+i===r||this.offset===r+1)if(this.offset===r&&0!==e)this.setPositionParagraph(this.currentWidget,r+1);else{var n=this.selection.getNextParagraphBlock(this.currentWidget.paragraph);if(sf.base.isNullOrUndefined(n))return;if(this.currentWidget=n.childWidgets[0],this.offset=this.selection.getStartLineOffset(this.currentWidget),1===e)this.moveToNextParagraphInTableCheck()?this.moveToNextParagraphInTable():this.moveToWordEndInternal(e,t)}else{var o=0,s=this.currentWidget.getInline(this.offset,o),a=s.element;o=s.index,this.getNextWordOffset(a,o,e,!1,!1,this,t)}if(0!==e){var l=this.owner.selection.start.getHierarchicalIndexInternal(),h=this.getHierarchicalIndexInternal();l!==h&&this.validateForwardFieldSelection(l,h)}this.updatePhysicalPosition(!0)},e.prototype.moveToNextParagraphInTable=function(){var e=this.currentWidget.paragraph,t=e.isInsideTable?this.selection.getNextSelectionCell(e.associatedCell):this.selection.getNextParagraphBlock(e);sf.base.isNullOrUndefined(t)||(this.currentWidget=t.childWidgets[t.childWidgets.length-1],this.offset=this.currentWidget.getEndOffset()+1)},e.prototype.moveToPreviousParagraph=function(e){var t=e.getStartOffset(this.currentWidget.paragraph);if(this.offset!==t||sf.base.isNullOrUndefined(e.getPreviousParagraphBlock(this.currentWidget.paragraph)))this.offset=e.getStartOffset(this.currentWidget.paragraph);else{var i=e.getPreviousParagraphBlock(this.currentWidget.paragraph);this.currentWidget=i.childWidgets[0],this.offset=e.getStartOffset(this.currentWidget.paragraph)}this.updatePhysicalPosition(!0)},e.prototype.moveToPreviousLine=function(e,t){var i=this.getHierarchicalIndexInternal(),r=e.getLineWidgetParagraph(this.offset,this.currentWidget);this.moveToLineStartInternal(e,!0),this.currentWidget.paragraph.isInsideTable?this.moveUpInTable(e):this.moveBackward();var n=e.getLineWidgetParagraph(this.offset,this.currentWidget),o=e.getLeft(n);if(e.getWidth(n,!0)+o>=t&&r!==n){var s=e.getTop(n),a=new M(t,s);e.updateTextPositionWidget(n,a,this,!0)}var l=this.getHierarchicalIndexInternal();this.validateBackwardFieldSelection(i,l)},e.prototype.moveToLineEndInternal=function(e,t){this.location.x>this.viewer.clientActiveArea.right&&(this.offset=this.offset-1);var i=e.getLineWidgetParagraph(this.offset,this.currentWidget),r=e.getFirstElementInternal(i),n=this.currentWidget.paragraph.paragraphFormat.bidi;if(this.documentHelper.moveCaretPosition=2,sf.base.isNullOrUndefined(r)&&this.offset===e.getStartLineOffset(this.currentWidget))this.offset=e.getParagraphLength(this.paragraph)+1,this.updatePhysicalPosition(!0);else if(!sf.base.isNullOrUndefined(r)){var o=void 0;if(n&&this.containsRtlText(i)){var s=i.getEndOffset();o=i.getInline(s,0).element}else(o=i.children[i.children.length-1])instanceof je&&i.children.length>2&&(o=i.children[i.children.length-3]);var a=0;if(a+=o instanceof we?o.length:1,this.currentWidget=o.line,a===o.length&&sf.base.isNullOrUndefined(o.nextNode)&&e.isParagraphLastLine(this.currentWidget)){var l=e.getLineLength(this.currentWidget);this.offset=t?l+1:l}else{for(var h=o;!sf.base.isNullOrUndefined(h)&&h.length===a&&h.nextNode instanceof fe;){var d=e.getNextValidElement(h.nextNode);if(h!==d&&(h=d,a=0),h instanceof fe&&0===h.fieldType&&!sf.base.isNullOrUndefined(h.fieldEnd)){var c=h;sf.base.isNullOrUndefined(c.fieldSeparator)?h=c.fieldEnd:(h=c.fieldSeparator,this.currentWidget=h.line,this.currentWidget!==c.fieldEnd.line||e.hasValidInline(this.currentWidget.paragraph,h,c.fieldEnd)||(h=c.fieldEnd)),this.currentWidget=h.line}h instanceof fe&&(a=1)}a===h.length&&sf.base.isNullOrUndefined(h.nextNode)&&a++,!t&&h instanceof ge&&"\v"===h.text&&a--,this.offset=this.currentWidget.getOffset(h,a)}this.updatePhysicalPosition(t)}},e.prototype.moveToNextLine=function(t){var i=this.selection,r=new e(this.owner);r.setPositionInternal(this);var n=this.getHierarchicalIndexInternal();i.getLineWidgetParagraph(this.offset,this.currentWidget);this.moveToLineEndInternal(i,!0);var o=!r.isAtSamePosition(this);(r.setPositionInternal(this),this.currentWidget.paragraph.isInsideTable)?this.moveDownInTable(i):(this.moveNextPosition(),0===this.offset||this.moveForward());var s=i.getLineWidgetParagraph(this.offset,this.currentWidget),a=i.getLeft(s),l=i.getFirstElementInternal(s),h=sf.base.isNullOrUndefined(l)?i.getWidth(s,!0):i.getLeftInternal(s,l,1)-a;if(a<t&&h/2<t-a){var d=i.getTop(s),c=new M(t,d);i.updateTextPositionWidget(s,c,this,!0),i.getWidth(s,!0)<t-a&&this.moveToLineEndInternal(i,!0)}else o&&this.currentWidget.paragraph.isInsideTable&&this.currentWidget===this.owner.selection.start.currentWidget?this.setPositionInternal(r):o||this.moveToLineEndInternal(i,!0);var p=this.getHierarchicalIndexInternal();this.validateForwardFieldSelection(n,p)},e.prototype.moveUpInTable=function(e){var t=!1,i=this.owner.selection.end,r=!this.owner.selection.isEmpty;if(t=i.paragraph.isInsideTable){var n=this.currentWidget.paragraph.associatedCell,o=i.paragraph.associatedCell,s=e.getContainerCellOf(o,n);if(t=s.ownerTable.contains(n)){o=e.getSelectedCell(o,s),n=e.getSelectedCell(n,s);var a=e.containsCell(s,this.currentWidget.paragraph.associatedCell),l=e.isCellSelected(s,this,i);if(l||(l=this.currentWidget.paragraph===e.getFirstParagraph(s)&&this.isAtParagraphStart),(a&&l||!a)&&!sf.base.isNullOrUndefined(n.ownerRow.previousRenderedWidget)){var h=n.ownerRow.previousRenderedWidget,d=e.getFirstCellInRegion(h,s,this.owner.selection.upDownSelectionLength,!0),c=e.getLastParagraph(d);return void this.setPosition(c.childWidgets[0],!0)}if(a&&l&&sf.base.isNullOrUndefined(n.ownerRow.previousRenderedWidget)||!a)if(r){n=n.ownerRow.childWidgets[0];c=e.getFirstParagraph(n);this.setPosition(c.childWidgets[0],!0)}else{n=n.ownerRow.childWidgets[n.ownerRow.childWidgets.length-1];c=e.getLastParagraph(n);this.setPosition(c.childWidgets[0],!1)}}}if(!t){d=e.getContainerCell(this.currentWidget.paragraph.associatedCell);if(r){d=d.ownerRow.childWidgets[0];c=e.getFirstParagraph(d);this.setPosition(c.childWidgets[0],!0)}else{d=d.ownerRow.childWidgets[d.ownerRow.childWidgets.length-1];c=e.getLastParagraph(d);this.setPosition(c.childWidgets[0],!1)}}this.moveBackward()},e.prototype.moveDownInTable=function(e){var t=!1,i=this.owner.selection.isEmpty||this.owner.selection.isForward;if(t=this.owner.selection.start.paragraph.isInsideTable){var r=this.owner.selection.start.paragraph.associatedCell,n=this.currentWidget.paragraph.associatedCell,o=e.getContainerCellOf(r,n);if(t=o.ownerTable.contains(n)){r=e.getSelectedCell(r,o),n=e.getSelectedCell(n,o);var s=e.containsCell(o,this.currentWidget.paragraph.associatedCell),a=e.isCellSelected(o,this.owner.selection.start,this);if((s&&a||!s)&&!sf.base.isNullOrUndefined(n.ownerRow.nextRenderedWidget)){var l=n.ownerRow.nextRenderedWidget,h=e.getLastCellInRegion(l,o,this.owner.selection.upDownSelectionLength,!1),d=e.getLastParagraph(h);return void this.setPosition(d.childWidgets[d.childWidgets.length-1],!1)}if(s&&a&&sf.base.isNullOrUndefined(n.ownerRow.nextRenderedWidget)||!s)if(i){n=n.ownerRow.childWidgets[n.ownerRow.childWidgets.length-1];d=e.getLastParagraph(n);this.setPosition(d.childWidgets[d.childWidgets.length-1],!1)}else{n=n.ownerRow.childWidgets[0];d=e.getFirstParagraph(n);this.setPosition(d.childWidgets[d.childWidgets.length-1],!0)}}}if(!t){h=e.getContainerCell(this.currentWidget.paragraph.associatedCell);if(i){h=h.ownerRow.childWidgets[h.ownerRow.childWidgets.length-1];d=e.getLastParagraph(h);this.setPosition(d.childWidgets[d.childWidgets.length-1],!1)}else if(h.ownerRow.nextRenderedWidget){h=h.ownerRow.nextRenderedWidget.childWidgets[0];d=e.getFirstParagraph(h);this.setPosition(d.childWidgets[d.childWidgets.length-1],!0)}}this.moveForward()},e.prototype.destroy=function(){this.offset=void 0,this.isUpdateLocation=void 0,sf.base.isNullOrUndefined(this.location)||this.location.destroy(),this.location=void 0,this.currentWidget=void 0,this.owner=void 0,this.documentHelper=void 0},e}(),Dt=function(){function e(e,t){this.leftIn=0,this.widthIn=0,this.color="",this.leftIn=e,this.widthIn=t}return Object.defineProperty(e.prototype,"left",{get:function(){return this.leftIn},set:function(e){this.leftIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return this.widthIn},set:function(e){this.widthIn=e},enumerable:!0,configurable:!0}),e.prototype.destroy=function(){this.widthIn=void 0,this.leftIn=void 0,this.floatingItems=[],this.floatingItems=void 0},e}(),Et=function(){function e(e,t){this.linkInternal="",this.localRef="",this.opensNewWindow=!1,this.isCrossRefField=!1,this.screenTipText="";var i=t.getFieldCode(e),r=i.toLowerCase();"hyperlink"===r.substring(0,9)?this.parseFieldValues(i.substring(9).trim(),!0):0===r.indexOf("ref ")&&r.match("\\h")?(this.parseFieldValues(i.substring(4).trim(),!1),this.isCrossRefField=!0):0===r.indexOf("pageref")&&this.parseFieldValues(i.substring(7).trim(),!1)}return Object.defineProperty(e.prototype,"screenTip",{get:function(){return this.screenTipText},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"navigationLink",{get:function(){return this.linkInternal},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"localReference",{get:function(){return this.localRef},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"linkType",{get:function(){return this.typeInternal},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isCrossRef",{get:function(){return this.isCrossRefField},enumerable:!0,configurable:!0}),e.prototype.parseFieldValues=function(e,t){var i=e.split("\\o ");2===i.length&&(this.screenTipText=this.parseFieldValue(i[1],'"'===i[1]?'"':void 0,t),this.screenTipText=this.screenTipText.substring(0,this.screenTipText.length-1),e=i[0],i=void 0),i=e.split(" ");var r=!1;if(t)for(var n=0;n<i.length;n++){var o=i[n];o.length<1||("\\t"===o||"\\l"===o?r=!0:"\\n"===o?this.opensNewWindow=!0:(o=this.parseFieldValue(o,'"'===o[0]?'"':void 0,t),r?(this.localRef=o,r=!1):this.linkInternal=o))}else this.localRef=i[0];this.setLinkType()},e.prototype.parseFieldValue=function(e,t,i){e=i?e.substring(1):e.substring(0);var r=t?e.indexOf(t):-1;return r<0&&(r=e.length),e.substring(0,r).trim()},e.prototype.setLinkType=function(){sf.base.isNullOrUndefined(this.linkInternal)||this.linkInternal.length<1?this.typeInternal="Bookmark":("www."===this.linkInternal.substring(0,4)?this.linkInternal="http://"+this.navigationLink:"@"===this.linkInternal[0]&&(this.linkInternal="mailto:"+this.navigationLink),"http://"===this.linkInternal.substring(0,7)||"https://"===this.linkInternal.substring(0,8)?this.typeInternal="WebPage":"mailto:"===this.linkInternal.substring(0,7)?this.typeInternal="Email":this.typeInternal="File")},e.prototype.destroy=function(){this.linkInternal=void 0,this.localRef=void 0,this.typeInternal=void 0,this.opensNewWindow=void 0,this.screenTipText=void 0},e}(),zt=function(){function e(e){this.width=0,this.height=0,this.width=e.width,this.height=e.height}return e.prototype.destroy=function(){this.width=void 0,this.height=void 0},e}(),kt=function(){function t(e){var t=this;this.upDownSelectionLength=0,this.isSkipLayouting=!1,this.isImageSelected=!1,this.contextTypeInternal=void 0,this.caret=void 0,this.isRetrieveFormatting=!1,this.skipFormatRetrieval=!1,this.isModifyingSelectionInternally=!1,this.isMoveDownOrMoveUp=!1,this.isViewPasteOptions=!1,this.skipEditRangeRetrieval=!1,this.selectedWidgets=void 0,this.isHighlightEditRegionIn=!1,this.isHighlightFormFields=!1,this.isHightlightEditRegionInternal=!1,this.isCurrentUser=!1,this.isHighlightNext=!1,this.isWebLayout=!1,this.editRegionHighlighters=void 0,this.formFieldHighlighters=void 0,this.isSelectList=!1,this.previousSelectedFormField=void 0,this.isFormatUpdated=!1,this.pasteOptions=function(e){"Keep source formatting"===e?t.owner.editor.applyPasteOptions("KeepSourceFormatting"):"Match destination formatting"===e?t.owner.editor.applyPasteOptions("MergeWithExistingFormatting"):t.owner.editor.applyPasteOptions("KeepTextOnly")},this.hideCaret=function(){sf.base.isNullOrUndefined(t.caret)||(t.caret.style.display="none")},this.owner=e,this.documentHelper=this.owner.documentHelper,this.start=new Ft(this.owner),this.end=new Ft(this.owner),this.selectedWidgets=new a,this.characterFormatIn=new xt(this),this.paragraphFormatIn=new It(this,this.documentHelper),this.sectionFormatIn=new St(this),this.rowFormatIn=new Tt(this),this.cellFormatIn=new Ot(this),this.tableFormatIn=new Ct(this),this.imageFormatInternal=new Pt(this),this.editRangeCollection=[],this.editRegionHighlighters=new a,this.formFieldHighlighters=new a}return Object.defineProperty(t.prototype,"isHighlightEditRegion",{get:function(){return this.isHighlightEditRegionIn},set:function(e){this.isHighlightEditRegionIn=e,this.onHighlight()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"htmlWriter",{get:function(){return sf.base.isNullOrUndefined(this.htmlWriterIn)&&(this.htmlWriterIn=new Lt),this.htmlWriterIn},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"start",{get:function(){if(!sf.base.isNullOrUndefined(this.owner)&&!sf.base.isNullOrUndefined(this.viewer))return sf.base.isNullOrUndefined(this.startInternal)&&(this.startInternal=this.owner.documentStart),this.startInternal},set:function(e){this.startInternal=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"characterFormat",{get:function(){return this.characterFormatIn},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"paragraphFormat",{get:function(){return this.paragraphFormatIn},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"sectionFormat",{get:function(){return this.sectionFormatIn},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"tableFormat",{get:function(){return this.tableFormatIn},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"cellFormat",{get:function(){return this.cellFormatIn},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rowFormat",{get:function(){return this.rowFormatIn},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"imageFormat",{get:function(){return this.imageFormatInternal},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"end",{get:function(){return this.endInternal},set:function(e){this.endInternal=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"startPage",{get:function(){return!this.owner.isDocumentLoaded||sf.base.isNullOrUndefined(this.viewer)||this.viewer instanceof Z||sf.base.isNullOrUndefined(this.documentHelper.selectionStartPage)?1:this.documentHelper.pages.indexOf(this.documentHelper.selectionStartPage)+1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"endPage",{get:function(){return!this.owner.isDocumentLoaded||sf.base.isNullOrUndefined(this.viewer)||this.viewer instanceof Z||sf.base.isNullOrUndefined(this.documentHelper.selectionEndPage)?1:this.documentHelper.pages.indexOf(this.documentHelper.selectionEndPage)+1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isForward",{get:function(){return this.start.isExistBefore(this.end)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isinFootnote",{get:function(){var e=this.getContainerWidget(this.start.paragraph);return e instanceof ae&&"Footnote"===e.footNoteType},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isinEndnote",{get:function(){var e=this.getContainerWidget(this.start.paragraph);return e instanceof ae&&"Endnote"===e.footNoteType},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isEmpty",{get:function(){return!!sf.base.isNullOrUndefined(this.start)||this.start.isAtSamePosition(this.end)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"startOffset",{get:function(){return this.getHierarchicalIndexByPosition(this.start)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"endOffset",{get:function(){return this.getHierarchicalIndexByPosition(this.end)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isInShape",{get:function(){var e=this.start.paragraph.containerWidget;do{if(e instanceof ze)return!0;e&&(e=e.containerWidget)}while(e);return!1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"text",{get:function(){return this.getText(!1)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"contextType",{get:function(){return this.contextTypeInternal},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bookmarks",{get:function(){return this.getSelBookmarks(!1)},enumerable:!0,configurable:!0}),t.prototype.getBookmarks=function(e){return this.getSelBookmarks(e)},Object.defineProperty(t.prototype,"isCleared",{get:function(){return sf.base.isNullOrUndefined(this.end)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isInField",{get:function(){return!sf.base.isNullOrUndefined(this.getHyperlinkField(!0))},enumerable:!0,configurable:!0}),t.prototype.getFieldInfo=function(){var e=this.getHyperlinkField(!0);if(!sf.base.isNullOrUndefined(e))return{code:this.getFieldCode(e),result:this.owner.editorModule.getFieldResultText(e)}},t.prototype.getSelBookmarks=function(e){var t,i,r=[],n=this.documentHelper.bookmarks,o=this.start,s=this.end;this.isForward||(o=this.end,s=this.start);for(var a=!1,l=this.getSelectedCells(),h=0;h<n.length;h++)if(e||!e&&0!==n.keys[h].indexOf("_")){if(i=(t=n.get(n.keys[h])).reference,sf.base.isNullOrUndefined(i))continue;var d=this.getElementPosition(t).startPosition,c=this.getElementPosition(i,!0).startPosition;if(d.paragraph.isInsideTable||c.paragraph.isInsideTable)if(l.length>0){if(l.indexOf(d.paragraph.associatedCell)>=0||l.indexOf(c.paragraph.associatedCell)>=0)a=!0;else if(a=!1,l.indexOf(d.paragraph.associatedCell)<0||l.indexOf(c.paragraph.associatedCell)<0){var p=s.paragraph.isInsideTable&&s.paragraph.associatedCell,u=c.paragraph.associatedCell;if(p&&u&&p.ownerTable.equals(u.ownerTable)&&!(p.ownerTable&&l.indexOf(this.getCellInTable(p.ownerTable,u))>=0))continue}}else a=!1;else a=!1;((o.isExistAfter(d)||o.isAtSamePosition(d))&&(s.isExistBefore(c)||s.isAtSamePosition(c))||(d.isExistAfter(o)||d.isAtSamePosition(o))&&(c.isExistBefore(s)||c.isAtSamePosition(s))||d.isExistAfter(o)&&d.isExistBefore(s)&&(s.isExistAfter(c)||s.isExistBefore(c))||c.isExistBefore(s)&&c.isExistAfter(o)&&(o.isExistBefore(d)||o.isExistAfter(d))||a)&&r.push(t.name)}return r},Object.defineProperty(t.prototype,"viewer",{get:function(){return this.owner.viewer},enumerable:!0,configurable:!0}),t.prototype.getModuleName=function(){return"Selection"},t.prototype.checkLayout=function(){"Continuous"===this.owner.layoutType&&(this.isWebLayout=!0,this.documentHelper.isHeaderFooter=!0,this.owner.layoutType="Pages",this.owner.viewer.destroy(),this.owner.viewer=new X(this.owner),this.owner.editor.layoutWholeDocument())},t.prototype.goToHeader=function(){this.checkLayout(),this.owner.enableHeaderAndFooter=!0,this.enableHeadersFootersRegion(this.start.paragraph.bodyWidget.page.headerWidget,this.start.paragraph.bodyWidget.page),this.isWebLayout=!1},t.prototype.goToFooter=function(){this.checkLayout(),this.owner.enableHeaderAndFooter=!0,this.enableHeadersFootersRegion(this.start.paragraph.bodyWidget.page.footerWidget,this.start.paragraph.bodyWidget.page),this.isWebLayout=!1},t.prototype.closeHeaderFooter=function(){this.disableHeaderFooter(),this.documentHelper.isHeaderFooter&&"Pages"===this.owner.layoutType&&(this.owner.layoutType="Continuous",this.documentHelper.isHeaderFooter=!1)},t.prototype.goToPage=function(e){if(this.owner.scrollToPage(e),e>=1&&e<=this.owner.documentHelper.pages.length){var t=this.owner.documentHelper.pages[e-1];this.updateTextPositionForBlockContainer(t.bodyWidgets[0])}},t.prototype.selectTable=function(){this.owner.enableSelection&&this.selectTableInternal()},t.prototype.selectRow=function(){this.owner.enableSelection&&this.selectTableRow()},t.prototype.selectColumn=function(){this.owner.enableSelection&&this.selectColumnInternal()},t.prototype.selectCell=function(){this.owner.enableSelection&&this.selectTableCell()},t.prototype.select=function(e,t){if("string"==typeof e){var i=this.getTextPosBasedOnLogicalIndex(e),r=this.getTextPosBasedOnLogicalIndex(t);this.selectPosition(i,r)}else{var n=new M(e.x,e.y),o=this.viewer.findFocusedPage(n,!0);e.extend?this.moveTextPosition(o,this.end):this.documentHelper.updateTextPositionForSelection(o,1)}},t.prototype.selectByHierarchicalIndex=function(e,t){var i=this.getTextPosBasedOnLogicalIndex(e),r=this.getTextPosBasedOnLogicalIndex(t);this.selectPosition(i,r)},t.prototype.selectField=function(e){!this.isInField&&sf.base.isNullOrUndefined(e)||(sf.base.isNullOrUndefined(e)&&(e=this.getHyperlinkField(!0)),this.selectFieldInternal(e))},t.prototype.selectFieldInternal=function(e,t,i){if(e){var r=this.documentHelper.isFormFillProtectedMode||i,n=e.fieldEnd;r&&(e=e.fieldSeparator);var o=e.line.getOffset(e,r?1:0),s=new Ft(this.owner);s.setPositionParagraph(e.line,o),e.nextNode instanceof Ce&&!r&&(n=e.nextElement.reference);var a=n.line.getOffset(n,r?0:1),l=new Ft(this.owner);l.setPositionParagraph(n.line,a),this.documentHelper.selection.selectRange(s,l),i||this.triggerFormFillEvent(t)}},t.prototype.selectShape=function(e){if(e){var t=e.line.getOffset(e,0),i=new Ft(this.owner);i.setPositionParagraph(e.line,t);var r=e.line.getOffset(e,1),n=new Ft(this.owner);n.setPositionParagraph(e.line,r),this.documentHelper.selection.selectRange(i,n)}},t.prototype.toggleBold=function(){this.owner.editorModule&&this.owner.editorModule.toggleBold()},t.prototype.toggleItalic=function(){this.owner.editorModule&&this.owner.editorModule.toggleItalic()},t.prototype.toggleAllCaps=function(){this.owner.editorModule&&this.owner.editorModule.toggleAllCaps()},t.prototype.toggleUnderline=function(e){this.owner.editor&&this.owner.editor.toggleUnderline(e)},t.prototype.toggleStrikethrough=function(e){this.owner.editor&&this.owner.editor.toggleStrikethrough(e)},t.prototype.toggleHighlightColor=function(e){this.owner.editor&&this.owner.editor.toggleHighlightColor(e)},t.prototype.toggleSubscript=function(){this.owner.editor&&this.owner.editor.toggleSubscript()},t.prototype.toggleSuperscript=function(){this.owner.editor&&this.owner.editor.toggleSuperscript()},t.prototype.toggleTextAlignment=function(e){this.owner.editor&&this.owner.editor.toggleTextAlignment(e)},t.prototype.increaseIndent=function(){this.owner.editor&&this.owner.editor.increaseIndent()},t.prototype.decreaseIndent=function(){this.owner.editor&&this.owner.editor.decreaseIndent()},t.prototype.navigateHyperlink=function(){var e=this.getHyperlinkField();e&&this.fireRequestNavigate(e)},t.prototype.fireRequestNavigate=function(e){var t=this.getFieldCode(e);if(0!==t.toLowerCase().indexOf("ref ")||t.match("\\h")){var i=new Et(e,this),r={isHandled:!1,navigationLink:i.navigationLink,linkType:i.linkType,localReference:i.localReference};this.owner.dotNetRef.invokeMethodAsync("RequestNavigate",r)}},t.prototype.copyHyperlink=function(){var e=this.getHyperlinkField(),t=this.getLinkText(e,!0);this.copyToClipboard(t)},t.prototype.isHideSelection=function(e){var t=e.bodyWidget,i=t.sectionFormat,r=i.pageHeight-i.footerDistance,n=t.page.boundingRectangle.height/100*40;return this.contextType.indexOf("Footer")>=0&&e.y+e.height>x.convertPointToPixel(r)||this.contextType.indexOf("Header")>=0&&e.y+e.height>n},t.prototype.highlightSelection=function(e,t){if(this.owner.enableImageResizerMode&&this.owner.imageResizerModule.hideImageResizer(),this.isEmpty){if(!this.isInShape&&this.isHideSelection(this.start.paragraph))return void this.hideCaret();this.isInShape&&this.showResizerForShape(),this.updateCaretPosition()}else this.isForward?this.highlightSelectedContent(this.start,this.end):this.highlightSelectedContent(this.end,this.start),this.documentHelper.isComposingIME&&this.updateCaretPosition();this.documentHelper.updateTouchMarkPosition(),e&&this.documentHelper.scrollToPosition(this.start,this.end,void 0,t)},t.prototype.createHighlightBorder=function(e,t,i,r,n){t<0&&(t=0);var o=e.paragraph,s=[];if(o.floatingElements.length>0)for(var a=0;a<o.floatingElements.length;a++){var l=o.floatingElements[a];if(l.line===e){var h=this.start,d=this.end;this.isForward||(h=this.end,d=this.start);var c=l.line.getOffset(l,0);(h.currentWidget!==e&&d.currentWidget!==e||h.currentWidget===e&&h.offset<=c&&(d.currentWidget===e&&d.offset>=c+1||d.currentWidget!==e)||h.currentWidget!==e&&d.currentWidget===e&&d.offset>=c)&&s.push(l)}}var p=this.getPage(e.paragraph),u=(e.height,this.selectedWidgets),g=void 0,f=void 0;if(this.isHightlightEditRegionInternal)this.addEditRegionHighlight(e,i,t);else if(this.isHighlightFormFields)this.addFormFieldHighlight(e,i,t);else{if(u.containsKey(e))u.get(e)instanceof Dt?(g=u.get(e),n&&(u.remove(e),f=[],u.add(e,f))):f=u.get(e);else if(n)f=[],u.add(e,f);else{var m=this.getWrapPosition(e,o);if(m.length>0){var y=this.splitSelectionHighlightPosition(i,t,m);if(y.length>0)return y[0].floatingItems=s,u.add(e,y),void this.renderHighlight(p,e,y,r,s);(g=new Dt(i,t)).floatingItems=s,u.add(e,g)}else(g=new Dt(i,t)).floatingItems=s,u.add(e,g)}void 0===g&&((g=new Dt(i,t)).floatingItems=s,u.add(e,g)),this.renderHighlight(p,e,[g],r,s),n&&f.push(g)}},t.prototype.renderHighlight=function(e,t,i,r,n){var o=this.owner.documentHelper,s=this.getPageTop(e),a=e.boundingRectangle.x,l=t.height;if(this.viewer.containerTop<=s||s<this.viewer.containerTop+o.selectionCanvas.height){var h=o.zoomFactor;this.clipSelection(e,s);for(var d=0;d<i.length;d++){var c=i[d],p=c.left,u=c.width;this.documentHelper.isComposingIME?this.renderDashLine(o.selectionContext,e,t,a+p*h-this.viewer.containerLeft,r,u*h,l):(this.documentHelper.selectionContext.fillStyle="gray",o.selectionContext.globalAlpha=.4,o.selectionContext.fillRect(a+p*h-this.viewer.containerLeft,s+r*h-this.viewer.containerTop,u*h,l*h))}if(n.length>0)for(var g=0;g<n.length;g++){p=n[g].x;var f=n[g].y,m=n[g].width,y=n[g].height;o.selectionContext.fillRect(a+p*h-this.viewer.containerLeft,s+f*h-this.viewer.containerTop,m*h,y*h)}o.selectionContext.restore()}},t.prototype.getWrapPosition=function(e,t){var i=t.bodyWidget;if(!sf.base.isNullOrUndefined(i)&&i.floatingElements.length>0&&e.children.length>0){for(var r=this.getLeftInternal(e,e.children[0],0),n=0,o=[],s=!1,a=0;a<e.children.length;a++){var l=e.children[a];if(!(l instanceof De&&"Inline"!==l.textWrappingStyle)){if(l.padding.left>0){1===o.length&&0===o[0].end&&(o[0].end=o[0].start-t.x,o[0].start=t.x,r=t.x);var h={};h.start=r+n,h.end=0,s&&(h.end=r+n+l.padding.left),o.push(h)}n+=l.padding.left+l.width,l instanceof we&&(s=!0)}}return 1===o.length&&0===o[0].end&&(o[0].end=o[0].start-t.x,o[0].start=t.x),o}return[]},t.prototype.splitSelectionHighlightPosition=function(e,t,i){for(var r=[],n=0;n<i.length;n++){var o=i[n];e<o.start&&e+t<o.end||e>o.end||(e<o.start&&e+t>o.end?(r.push(new Dt(e,o.start-e)),t=e+t-o.end,e=o.end):e===o.start&&(e+=o.end,t-=o.end),n===i.length-1&&r.push(new Dt(e,t)))}return r},t.prototype.addEditRegionHighlight=function(e,t,i){var r=void 0,n=this.editRegionHighlighters;n.containsKey(e)?r=n.get(e):(r=[],n.add(e,r));var o=new Dt(t,i);return this.isCurrentUser&&(o.color=""!==this.owner.userColor?this.owner.userColor:"#FFFF00"),r.push(o),o},t.prototype.addFormFieldHighlight=function(e,t,i){var r=void 0,n=this.formFieldHighlighters;n.containsKey(e)?r=n.get(e):(r=[],n.add(e,r));var o=new Dt(t,i);r.push(o)},t.prototype.createHighlightBorderInsideTable=function(e){var t=this.getPage(e),i=void 0,r=e.x-e.margin.left+e.leftBorderWidth,n=e.width+e.margin.left+e.margin.right-e.leftBorderWidth-e.rightBorderWidth,o=e.y,s=e.height,a=this.getPageTop(t),l=t.boundingRectangle.x,h=this.documentHelper.isPageInVisibleBound(t,a),d=this.selectedWidgets;if(this.isHightlightEditRegionInternal||this.isHighlightFormFields||(d.containsKey(e)&&d.get(e)instanceof Dt?(i=d.get(e),h&&this.documentHelper.selectionContext.clearRect(l+i.left*this.documentHelper.zoomFactor-this.viewer.containerLeft,a+o*this.documentHelper.zoomFactor-this.viewer.containerTop,i.width*this.documentHelper.zoomFactor,s*this.documentHelper.zoomFactor)):(i=new Dt(r,n),d.containsKey(e)&&d.remove(d.get(e)),d.add(e,i))),h){this.documentHelper.selectionContext.fillStyle="gray",this.documentHelper.selectionContext.globalAlpha=.4;var c=this.documentHelper.zoomFactor;this.clipSelection(t,a),this.documentHelper.selectionContext.fillRect(l+r*c-this.viewer.containerLeft,a+o*c-this.viewer.containerTop,n*c,s*c),this.documentHelper.selectionContext.restore()}},t.prototype.clipSelection=function(e,t){var i,r,n=this.owner.documentHelper;this.viewer instanceof Z&&this.documentHelper.zoomFactor<1?(i=e.boundingRectangle.width/this.documentHelper.zoomFactor,r=e.boundingRectangle.height/this.documentHelper.zoomFactor):(i=e.boundingRectangle.width*this.documentHelper.zoomFactor,r=e.boundingRectangle.height*this.documentHelper.zoomFactor);var o=e.boundingRectangle.x;n.selectionContext.beginPath(),n.selectionContext.save(),n.selectionContext.rect(o-this.viewer.containerLeft,t-this.viewer.containerTop,i,r),n.selectionContext.clip()},t.prototype.addSelectionHighlight=function(e,t,i,r){if(this.selectedWidgets.containsKey(t)){var n=this.documentHelper.render.getScaledValue(t.height),o=this.selectedWidgets.get(t),s=void 0;if(o instanceof Dt?(s=[]).push(o):s=o,!sf.base.isNullOrUndefined(s))for(var a=0;a<s.length;a++){var l=s[a],h=this.documentHelper.render.getScaledValue(s[a].width),d=this.documentHelper.render.getScaledValue(s[a].left,1);if(sf.base.isNullOrUndefined(r)&&(r=this.owner.selection.getPage(t.paragraph)),this.owner.selection.clipSelection(r,this.owner.selection.getPageTop(r)),this.documentHelper.isComposingIME)this.renderDashLine(e,r,t,d,i,h,n);else if(e.globalAlpha=.4,e.fillStyle="gray",e.fillRect(d,this.documentHelper.render.getScaledValue(i,2),h,n),l.floatingItems&&l.floatingItems.length>0)for(var c=0;c<l.floatingItems.length;c++){var p=l.floatingItems[c];h=this.documentHelper.render.getScaledValue(p.width),d=this.documentHelper.render.getScaledValue(p.x,1);var u=this.documentHelper.render.getScaledValue(p.y,2);e.fillRect(d,u,h,this.documentHelper.render.getScaledValue(p.height))}e.restore()}}},t.prototype.renderDashLine=function(e,t,i,r,n,o,s){var a=this.characterFormat.fontColor,l=a?x.getColor(a):"#000000";e.globalAlpha=1;var h=this.owner.editor.copyInsertFormat(new P,!1),d=this.documentHelper.textHelper.getHeight(h),c=this.getPageTop(t),p=d.Height-d.BaselineOffset;n=this.documentHelper.render.getUnderlineYPosition(i)+n+4-p,this.documentHelper.render.renderDashLine(e,r,c-this.viewer.containerTop+n*this.documentHelper.zoomFactor,o,l,!0)},t.prototype.addSelectionHighlightTable=function(e,t,i){if(this.selectedWidgets.containsKey(t)){var r=this.selectedWidgets.get(t),n=void 0;if(r instanceof Dt?(n=[]).push(r):n=r,!sf.base.isNullOrUndefined(n))for(var o=0;o<n.length;o++){var s=this.documentHelper.render.getScaledValue(n[o].left,1),a=this.documentHelper.render.getScaledValue(t.y,2),l=this.documentHelper.render.getScaledValue(n[o].width),h=this.documentHelper.render.getScaledValue(t.height);e.fillStyle="gray",sf.base.isNullOrUndefined(i)&&(i=this.owner.selection.getPage(t)),this.owner.selection.clipSelection(i,this.owner.selection.getPageTop(i)),e.fillRect(s,a,l,h),e.restore()}}},t.prototype.removeSelectionHighlight=function(e){var t=0,i=0,r=0,n=0,o=void 0;if(e instanceof ue){var s=e,a=s.paragraph;if(o=sf.base.isNullOrUndefined(a)?void 0:this.getPage(s.paragraph),sf.base.isNullOrUndefined(o))return;i=this.getTop(s),n=s.height}else if(e instanceof pe){if(o=sf.base.isNullOrUndefined(e)?void 0:this.getPage(e),sf.base.isNullOrUndefined(o))return;i=e.y,n=e.height}if(!sf.base.isNullOrUndefined(o)){var l=this.selectedWidgets.get(e),h=void 0;if(l instanceof Dt?(h=[]).push(l):h=l,!sf.base.isNullOrUndefined(h))for(var d=0;d<h.length;d++){r=h[d].width,t=h[d].left;var c=o.boundingRectangle,p=this.documentHelper.pages.indexOf(o),u=this.viewer.pageGap,g=(c.y-u*(p+1))*this.documentHelper.zoomFactor+u*(p+1),f=c.x,m=this.documentHelper.zoomFactor;(this.viewer.containerTop<=g||g<this.viewer.containerTop+this.documentHelper.selectionCanvas.height)&&this.documentHelper.selectionContext.clearRect(f+t*m-this.viewer.containerLeft-.5,g+i*m-this.viewer.containerTop-.5,r*m+.5,n*m+.5)}}},t.prototype.selectCurrentWord=function(e){var t=this.start.clone(),i=this.end.clone();this.selectCurrentWordRange(t,i,e||!1),this.selectRange(t,i)},t.prototype.selectParagraph=function(){sf.base.isNullOrUndefined(this.start)||(this.start.paragraphStartInternal(this,!1),this.end.moveToParagraphEndInternal(this,!1),this.upDownSelectionLength=this.end.location.x,this.fireSelectionChanged(!0))},t.prototype.selectLine=function(){sf.base.isNullOrUndefined(this.start)||(this.moveToLineStart(),this.handleShiftEndKey())},t.prototype.moveToDocumentStart=function(){this.handleControlHomeKey()},t.prototype.moveToDocumentEnd=function(){this.handleControlEndKey()},t.prototype.moveToParagraphStart=function(){this.isForward?(this.start.paragraphStartInternal(this,!1),this.end.setPositionInternal(this.start),this.upDownSelectionLength=this.end.location.x):(this.end.paragraphStartInternal(this,!1),this.start.setPositionInternal(this.end),this.upDownSelectionLength=this.start.location.x),this.fireSelectionChanged(!0)},t.prototype.moveToParagraphEnd=function(){this.isForward?(this.start.moveToParagraphEndInternal(this,!1),this.end.setPositionInternal(this.start),this.upDownSelectionLength=this.end.location.x):(this.end.moveToParagraphEndInternal(this,!1),this.start.setPositionInternal(this.end),this.upDownSelectionLength=this.start.location.x),this.fireSelectionChanged(!0)},t.prototype.moveToNextLine=function(){this.moveDown()},t.prototype.moveToPreviousLine=function(){this.moveUp()},t.prototype.moveToNextCharacter=function(){this.handleRightKey()},t.prototype.moveToPreviousCharacter=function(){this.handleLeftKey()},t.prototype.selectCurrentWordRange=function(e,t,i){if(!sf.base.isNullOrUndefined(e)){if(e.offset>0){var r=e.clone(),n=0,o=e.currentWidget.getInline(e.offset,n),s=o.element;n=o.index,!sf.base.isNullOrUndefined(s)&&s instanceof fe&&1===s.fieldType?e.offset>2&&(!sf.base.isNullOrUndefined(s.fieldSeparator)||sf.base.isNullOrUndefined(s.fieldBegin))?(r.setPositionParagraph(r.currentWidget,e.offset-2),r.moveToWordEndInternal(0,!1),r.paragraph===e.paragraph&&r.offset===e.offset-1||e.moveToWordStartInternal(2)):e.offset>3&&sf.base.isNullOrUndefined(s.fieldSeparator)&&(r.setPositionParagraph(r.currentWidget,e.offset-3),r.moveToWordEndInternal(0,!1),r.paragraph===e.paragraph&&r.offset===e.offset||e.moveToWordStartInternal(2)):(r.setPositionParagraph(r.currentWidget,e.offset-1),r.moveToWordEndInternal(0,!1),r.paragraph===e.paragraph&&r.offset===e.offset||e.moveToWordStartInternal(2))}t.moveToWordEndInternal(2,i)}},t.prototype.extendToParagraphStart=function(){sf.base.isNullOrUndefined(this.start)||(this.end.paragraphStartInternal(this,!0),this.upDownSelectionLength=this.end.location.x,this.fireSelectionChanged(!0))},t.prototype.extendToParagraphEnd=function(){sf.base.isNullOrUndefined(this.start)||(this.end.moveToParagraphEndInternal(this,!0),this.upDownSelectionLength=this.end.location.x,this.fireSelectionChanged(!0))},t.prototype.moveNextPosition=function(){if(!sf.base.isNullOrUndefined(this.start)&&(this.isEmpty&&(this.start.moveNextPosition(),this.end.setPositionInternal(this.start)),this.updateForwardSelection(),this.upDownSelectionLength=this.start.location.x,this.fireSelectionChanged(!0),this.documentHelper.isFormFillProtectedMode)){var e=this.getCurrentFormField();e||(e=this.getFormFieldInFormFillMode(),this.selectPrevNextFormField(!0,e))}},t.prototype.moveToNextParagraph=function(){sf.base.isNullOrUndefined(this.start)||(this.end.moveToNextParagraphStartInternal(),this.start.setPositionInternal(this.end),this.upDownSelectionLength=this.end.location.x,this.fireSelectionChanged(!0))},t.prototype.nextFootnote=function(){if(this.isinFootnote){var e=this.start.paragraph.bodyWidget.footNoteReference,t=(this.documentHelper.footnoteCollection.length,this.documentHelper.footnoteCollection.indexOf(e)),i=this.documentHelper.footnoteCollection[t+1];sf.base.isNullOrUndefined(i)&&(i=e);for(var r=this.start.clone(),n=this.end.clone(),o=0;o<this.documentHelper.pages.length;o++)for(var s=this.documentHelper.pages[o].footnoteWidget,a=1;a<s.bodyWidgets.length;a++){s.bodyWidgets[a].footNoteReference===i&&(r.setPositionParagraph(s.bodyWidgets[a].childWidgets[0].childWidgets[0],0),n.setPositionInternal(r),this.selectRange(r,n))}}},t.prototype.previousFootnote=function(){if(this.isinFootnote){var e=this.start.paragraph.bodyWidget.footNoteReference,t=(this.documentHelper.footnoteCollection.length,this.documentHelper.footnoteCollection.indexOf(e)),i=this.documentHelper.footnoteCollection[t-1];sf.base.isNullOrUndefined(i)&&(i=e);for(var r=this.start.clone(),n=this.end.clone(),o=0;o<this.documentHelper.pages.length;o++)for(var s=this.documentHelper.pages[o].footnoteWidget,a=1;a<s.bodyWidgets.length;a++){s.bodyWidgets[a].footNoteReference===i&&(r.setPositionParagraph(s.bodyWidgets[a].childWidgets[0].childWidgets[0],0),n.setPositionInternal(r),this.selectRange(r,n))}}},t.prototype.nextEndnote=function(){if(this.isinEndnote){var e=this.start.paragraph.bodyWidget.footNoteReference,t=(this.documentHelper.endnoteCollection.length,this.documentHelper.endnoteCollection.indexOf(e)),i=this.documentHelper.endnoteCollection[t+1];sf.base.isNullOrUndefined(i)&&(i=e);for(var r=this.start.clone(),n=this.end.clone(),o=this.documentHelper.pages[this.endPage-1].endnoteWidget,s=0;s<o.childWidgets.length;s++){o.bodyWidgets[s].footNoteReference===i&&(r.setPositionParagraph(o.bodyWidgets[s].childWidgets[0].childWidgets[0],0),n.setPositionInternal(r),this.selectRange(r,n))}}},t.prototype.previousEndnote=function(){if(this.isinEndnote){var e=this.start.paragraph.bodyWidget.footNoteReference,t=(this.documentHelper.endnoteCollection.length,this.documentHelper.endnoteCollection.indexOf(e)),i=this.documentHelper.endnoteCollection[t-1];sf.base.isNullOrUndefined(i)&&(i=e);for(var r=this.start.clone(),n=this.end.clone(),o=this.documentHelper.pages[this.endPage-1].endnoteWidget,s=0;s<o.childWidgets.length;s++){o.bodyWidgets[s].footNoteReference===i&&(r.setPositionParagraph(o.bodyWidgets[s].childWidgets[0].childWidgets[0],0),n.setPositionInternal(r),this.selectRange(r,n))}}},t.prototype.movePreviousPosition=function(){if(!sf.base.isNullOrUndefined(this.start)&&(this.isEmpty&&(this.start.movePreviousPosition(),this.end.setPositionInternal(this.start)),this.updateBackwardSelection(),this.upDownSelectionLength=this.start.location.x,this.fireSelectionChanged(!0),this.documentHelper.isFormFillProtectedMode)){var e=this.getCurrentFormField();e||(e=this.getFormFieldInFormFillMode(),this.selectPrevNextFormField(!1,e))}},t.prototype.moveToPreviousParagraph=function(){sf.base.isNullOrUndefined(this.start)||(this.end.moveToPreviousParagraph(this),this.start.setPositionInternal(this.end),this.upDownSelectionLength=this.end.location.x,this.fireSelectionChanged(!0))},t.prototype.extendToPreviousLine=function(){sf.base.isNullOrUndefined(this.start)||(this.end.moveToPreviousLine(this,this.upDownSelectionLength),this.fireSelectionChanged(!0))},t.prototype.extendToLineEnd=function(){sf.base.isNullOrUndefined(this.start)||(this.end.moveToLineEndInternal(this,!0),this.upDownSelectionLength=this.end.location.x,this.fireSelectionChanged(!0))},t.prototype.extendToLineStart=function(){sf.base.isNullOrUndefined(this.start)||(this.end.moveToLineStartInternal(this,!0),this.upDownSelectionLength=this.end.location.x,this.start.paragraph===this.end.paragraph&&this.start.offset===this.start.currentWidget.getEndOffset()&&this.isParagraphLastLine(this.start.currentWidget)&&this.isParagraphFirstLine(this.end.currentWidget)&&this.start.setPositionParagraph(this.start.currentWidget,this.start.offset+1),this.fireSelectionChanged(!0))},t.prototype.moveUp=function(){if(this.documentHelper.isFormFillProtectedMode)this.selectPrevNextFormField(!1);else if(!sf.base.isNullOrUndefined(this.start)){this.isEmpty||(this.isForward?this.end.setPositionInternal(this.start):this.start.setPositionInternal(this.end),this.upDownSelectionLength=this.start.location.x),this.upDownSelectionLength=this.start.location.x;var e=this.start.currentWidget.paragraph.bodyWidget.indexInOwner;if(this.start.moveUp(this,this.upDownSelectionLength),e===this.start.currentWidget.paragraph.bodyWidget.indexInOwner||e!==this.start.currentWidget.paragraph.bodyWidget.index)this.end.setPositionInternal(this.start);else{do{this.start.moveUp(this,this.upDownSelectionLength)}while(e!==this.start.currentWidget.paragraph.bodyWidget.indexInOwner);this.end.setPositionInternal(this.start)}this.fireSelectionChanged(!0)}},t.prototype.moveDown=function(){if(this.documentHelper.isFormFillProtectedMode)this.selectPrevNextFormField(!0);else if(!sf.base.isNullOrUndefined(this.start)){this.isEmpty||(this.isForward?this.start.setPositionInternal(this.end):this.end.setPositionInternal(this.start),this.upDownSelectionLength=this.start.location.x),this.upDownSelectionLength=this.start.location.x;var e=this.start.currentWidget.paragraph.bodyWidget.indexInOwner;if(this.start.moveDown(this,this.upDownSelectionLength),e===this.start.currentWidget.paragraph.bodyWidget.indexInOwner||e!==this.start.currentWidget.paragraph.bodyWidget.index)this.end.setPositionInternal(this.start);else{do{this.start.moveDown(this,this.upDownSelectionLength)}while(e!==this.start.currentWidget.paragraph.bodyWidget.indexInOwner);this.end.setPositionInternal(this.start)}this.fireSelectionChanged(!0)}},t.prototype.updateForwardSelection=function(){this.isEmpty||(this.isForward?this.start.setPositionInternal(this.end):this.end.setPositionInternal(this.start))},t.prototype.updateBackwardSelection=function(){this.isEmpty||(this.isForward?this.end.setPositionInternal(this.start):this.start.setPositionInternal(this.end))},t.prototype.getFirstBlockInFirstCell=function(e){if(e.childWidgets.length>0){var t=e.childWidgets[0];if(t.childWidgets.length>0){var i=t.childWidgets[0];if(0===i.childWidgets.length)return;return i.childWidgets[0]}}},t.prototype.getFirstCellInRegion=function(e,t,i,r){var n=this.getCellLeft(e,t),o=n+t.cellFormat.cellWidth,s=!0;if(n<=i&&i<o)for(var a=0;a<e.childWidgets.length;a++){var l=this.getCellLeft(e,e.childWidgets[a]);if(x.round(n,2)<=x.round(l,2)&&x.round(l,2)<x.round(o,2))return s=!1,e.childWidgets[a]}else for(var h=0;h<e.childWidgets.length;h++){var d=this.getCellLeft(e,e.childWidgets[h]);if(d<=i&&d+e.childWidgets[h].cellFormat.cellWidth>i)return s=!1,e.childWidgets[h]}if(s){if(!sf.base.isNullOrUndefined(e.previousRenderedWidget)&&r){var c=e.previousRenderedWidget;return this.getFirstCellInRegion(c,t,i,r)}if(!sf.base.isNullOrUndefined(e.nextRenderedWidget)&&!r)return this.getFirstCellInRegion(e.nextRenderedWidget,t,i,r)}return e.childWidgets[0]},t.prototype.getFirstParagraph=function(e){for(;e.previousSplitWidget;)e=e.previousSplitWidget;var t=e.firstChild;return this.documentHelper.getFirstParagraphBlock(t)},t.prototype.getLastBlockInLastCell=function(e){if(e.childWidgets.length>0){for(var t=e.childWidgets[e.childWidgets.length-1],i=t.childWidgets[t.childWidgets.length-1];0===i.childWidgets.length&&!sf.base.isNullOrUndefined(i.previousSplitWidget);)i=i.previousSplitWidget;return i.childWidgets[i.childWidgets.length-1]}},t.prototype.moveToLineStart=function(){sf.base.isNullOrUndefined(this.start)||(this.updateBackwardSelection(),this.start.moveToLineStartInternal(this,!1),this.end.setPositionInternal(this.start),this.upDownSelectionLength=this.start.location.x,this.fireSelectionChanged(!0))},t.prototype.moveToLineEnd=function(){sf.base.isNullOrUndefined(this.start)||(this.updateForwardSelection(),this.start.moveToLineEndInternal(this,!1),this.end.setPositionInternal(this.start),this.upDownSelectionLength=this.start.location.x,this.fireSelectionChanged(!0))},t.prototype.getPageTop=function(e){return(e.boundingRectangle.y-this.viewer.pageGap*(this.documentHelper.pages.indexOf(e)+1))*this.documentHelper.zoomFactor+this.viewer.pageGap*(this.documentHelper.pages.indexOf(e)+1)},t.prototype.moveTextPosition=function(e,t,i){if(!sf.base.isNullOrUndefined(this.start)){var r=this.documentHelper.getLineWidgetInternal(e,!0);sf.base.isNullOrUndefined(r)||this.updateTextPositionWidget(r,e,t,!0),this.upDownSelectionLength=t.location.x;var n=this.start.getHierarchicalIndexInternal(),o=this.end.getHierarchicalIndexInternal();n===o||i||(Ft.isForwardSelection(n,o)?t.validateForwardFieldSelection(n,o):t.validateBackwardFieldSelection(n,o)),this.fireSelectionChanged(!0)}},t.prototype.getDocumentStart=function(){var e=this.documentHelper.pages[0].bodyWidgets[0].childWidgets[0];return this.setPositionForBlock(e,!0)},t.prototype.getDocumentEnd=function(){var e=void 0,t=this.owner.documentStart,i=this.documentHelper.pages[this.documentHelper.pages.length-1];if(!sf.base.isNullOrUndefined(t)&&i.bodyWidgets[i.bodyWidgets.length-1].childWidgets.length>0){var r=void 0,n=i.bodyWidgets[i.bodyWidgets.length-1].childWidgets,o=n[n.length-1];o instanceof se&&(r=o),e=this.setPositionForBlock(r,!1)}return e},t.prototype.handleControlEndKey=function(){var e=void 0;sf.base.isNullOrUndefined(this.owner.documentEnd)||(e=this.owner.documentEnd),sf.base.isNullOrUndefined(e)||this.owner.selection.selectContent(e,!0),this.checkForCursorVisibility()},t.prototype.handleControlHomeKey=function(){var e=void 0;sf.base.isNullOrUndefined(this.owner.documentStart)||(e=this.owner.documentStart),sf.base.isNullOrUndefined(e)||this.owner.selection.selectContent(e,!0),this.checkForCursorVisibility()},t.prototype.handleControlLeftKey=function(){this.extendToWordStartInternal(!0),this.checkForCursorVisibility()},t.prototype.handleControlRightKey=function(){this.extendToWordEndInternal(!0),this.checkForCursorVisibility()},t.prototype.handleControlDownKey=function(){this.moveToNextParagraph(),this.checkForCursorVisibility()},t.prototype.handleControlUpKey=function(){this.moveToPreviousParagraph(),this.checkForCursorVisibility()},t.prototype.handleShiftLeftKey=function(){this.extendBackward(),this.checkForCursorVisibility()},t.prototype.handleShiftUpKey=function(){this.extendToPreviousLine(),this.checkForCursorVisibility()},t.prototype.handleShiftRightKey=function(){this.extendForward(),this.checkForCursorVisibility()},t.prototype.handleShiftDownKey=function(){this.extendToNextLine(),this.checkForCursorVisibility()},t.prototype.handleControlShiftLeftKey=function(){(this.isForward?this.start.isCurrentParaBidi:this.end.isCurrentParaBidi)?this.extendToWordEndInternal(!1):this.extendToWordStartInternal(!1),this.checkForCursorVisibility()},t.prototype.handleControlShiftUpKey=function(){this.extendToParagraphStart(),this.checkForCursorVisibility()},t.prototype.handleControlShiftRightKey=function(){(this.isForward?this.start.isCurrentParaBidi:this.end.isCurrentParaBidi)?this.extendToWordStartInternal(!1):this.extendToWordEndInternal(!1),this.checkForCursorVisibility()},t.prototype.handleControlShiftDownKey=function(){this.extendToParagraphEnd(),this.checkForCursorVisibility()},t.prototype.handleLeftKey=function(){this.end.isCurrentParaBidi?this.moveNextPosition():this.movePreviousPosition(),this.checkForCursorVisibility()},t.prototype.handleUpKey=function(){this.isMoveDownOrMoveUp=!0,this.moveUp(),this.isMoveDownOrMoveUp=!1,this.checkForCursorVisibility()},t.prototype.handleRightKey=function(){this.end.isCurrentParaBidi?this.movePreviousPosition():this.moveNextPosition(),this.checkForCursorVisibility()},t.prototype.handleEndKey=function(){this.moveToLineEnd(),this.checkForCursorVisibility()},t.prototype.handleHomeKey=function(){this.moveToLineStart(),this.checkForCursorVisibility()},t.prototype.handleDownKey=function(){this.isMoveDownOrMoveUp=!0,this.moveDown(),this.isMoveDownOrMoveUp=!1,this.checkForCursorVisibility()},t.prototype.handleShiftEndKey=function(){this.extendToLineEnd(),this.checkForCursorVisibility()},t.prototype.handleShiftHomeKey=function(){this.extendToLineStart(),this.checkForCursorVisibility()},t.prototype.handleControlShiftEndKey=function(){var e=void 0;sf.base.isNullOrUndefined(this.owner.documentEnd)||(e=this.owner.documentEnd),sf.base.isNullOrUndefined(e)||(this.end.setPosition(e.currentWidget,!1),this.fireSelectionChanged(!0)),this.checkForCursorVisibility()},t.prototype.handleControlShiftHomeKey=function(){var e=void 0;sf.base.isNullOrUndefined(this.owner.documentStart)||(e=this.owner.documentStart),sf.base.isNullOrUndefined(e)||(this.end.setPositionInternal(e),this.fireSelectionChanged(!0)),this.checkForCursorVisibility()},t.prototype.handleSpaceBarKey=function(){this.owner.documentHelper.isDocumentProtected&&"FormFieldsOnly"===this.owner.documentHelper.protectionType&&"CheckBox"===this.getFormFieldType()&&this.owner.editor.toggleCheckBoxFormField(this.getCurrentFormField())},t.prototype.handleTabKey=function(e,t){var i=this.start,r=!1,n=!1;if(!sf.base.isNullOrUndefined(i)){if(0===i.offset&&-1==i.paragraph.paragraphFormat.listFormat.listId&&(i.currentWidget.isFirstLine()&&(r=!0),n=!0),i.paragraph.isInsideTable&&this.end.paragraph.isInsideTable&&(e||t))this.owner.documentHelper.isDocumentProtected||"FormFieldsOnly"===this.documentHelper.protectionType||(t?this.selectPreviousCell():this.selectNextCell());else if(!e&&!t||sf.base.isNullOrUndefined(i)||i.offset!==this.getStartOffset(i.paragraph)||sf.base.isNullOrUndefined(i.paragraph.paragraphFormat)||sf.base.isNullOrUndefined(i.paragraph.paragraphFormat.listFormat)||-1===i.paragraph.paragraphFormat.listFormat.listId||this.owner.isReadOnlyMode)this.owner.isReadOnlyMode||this.documentHelper.isFormFillProtectedMode||(r&&i.paragraph.paragraphFormat.firstLineIndent<this.documentHelper.defaultTabWidth?this.documentHelper.owner.editorModule.onApplyParagraphFormat("firstLineIndent",this.documentHelper.defaultTabWidth,!0,!1):n?t?this.owner.editorModule.decreaseIndent():this.owner.editorModule.increaseIndent():this.owner.editorModule.handleTextInput("\t"));else{var o=this.documentHelper.selection,s=i.paragraph;o.isForward||(s=o.end.paragraph),this.owner.editorModule.isFirstParaForList(o,s)?t?this.owner.editorModule.updateListLevelIndent(-this.documentHelper.defaultTabWidth,s):this.owner.editorModule.updateListLevelIndent(this.documentHelper.defaultTabWidth,s):this.owner.editorModule.updateListLevel(!t)}"FormFieldsOnly"===this.documentHelper.protectionType&&this.documentHelper.formFields.length>0&&this.selectPrevNextFormField(!t),this.checkForCursorVisibility()}},t.prototype.handlePageUpPageDownKey=function(e,t){var i=this,r=this.end.location.x,n=this.end.location.y,o=this.end.paragraph.bodyWidget.page,s=this.getPageTop(o),a=this.documentHelper.viewerContainer.scrollTop;n=n*this.documentHelper.zoomFactor+(s-a),r=r*this.documentHelper.zoomFactor+o.boundingRectangle.x,e?this.documentHelper.viewerContainer.scrollTop+=this.documentHelper.visibleBounds.height:this.documentHelper.viewerContainer.scrollTop-=this.documentHelper.visibleBounds.height;var l=!1;a===this.documentHelper.viewerContainer.scrollTop&&(l=!0),t&&(this.documentHelper.skipScrollToPosition=!0),setTimeout((function(){if(l)if(t){var o=void 0;o=e?i.getDocumentEnd():i.getDocumentStart(),i.end.setPositionForLineWidget(o.currentWidget,o.offset),i.fireSelectionChanged(!0)}else e?i.moveToDocumentEnd():i.moveToDocumentStart();else i.select({x:r,y:n,extend:t})}),0)},t.prototype.getFormFieldInFormFillMode=function(){for(var e,t=this.owner.selection.start,i=this.documentHelper.formFields.length-1;i>=0;i--)if(this.documentHelper.formFields[i].formFieldData.enabled){if(this.getElementPosition(this.documentHelper.formFields[i]).startPosition.isExistBefore(t)){e=this.documentHelper.formFields[i];break}0===i&&(e=this.documentHelper.formFields[this.documentHelper.formFields.length-1])}return e},t.prototype.selectPrevNextFormField=function(e,t){if(this.documentHelper.isFormFillProtectedMode){t||(t=this.getCurrentFormField());var i=this.documentHelper.formFields.indexOf(t);if(e)for(var r=i;;r++){if(r===this.documentHelper.formFields.length-1?r=0:r+=1,this.documentHelper.formFields[r].formFieldData.enabled){this.selectFieldInternal(this.documentHelper.formFields[r],!0);break}r-=1}else for(r=i;;r--){if(0===r?r=this.documentHelper.formFields.length-1:r-=1,this.documentHelper.formFields[r].formFieldData.enabled){this.selectFieldInternal(this.documentHelper.formFields[r],!0);break}r+=1}}},t.prototype.navigateToNextFormField=function(){for(var e,t=this.owner.selection.end,i=0;i<this.documentHelper.formFields.length;i++)if(e=this.documentHelper.formFields[i],this.documentHelper.formFields[i].formFieldData.enabled){if(this.getElementPosition(this.documentHelper.formFields[i]).startPosition.isExistAfter(t)){e.formFieldData instanceof ye&&"Text"===e.formFieldData.type&&this.documentHelper.isInlineFormFillProtectedMode?this.selectTextElementStartOfField(this.documentHelper.formFields[i]):this.selectFieldInternal(this.documentHelper.formFields[i]);break}i===this.documentHelper.formFields.length-1&&((e=this.documentHelper.formFields[0]).formFieldData instanceof ye&&"Text"===e.formFieldData.type&&this.documentHelper.isInlineFormFillProtectedMode?this.selectTextElementStartOfField(this.documentHelper.formFields[0]):this.selectFieldInternal(this.documentHelper.formFields[0]))}},t.prototype.selectTextElementStartOfField=function(e){var t=e.fieldSeparator.nextElement;if(t){for(;!(t instanceof we);)t=t.nextElement;var i=e.line.getOffset(t,0),r=this.getPhysicalPositionInternal(e.line,i,!1);this.selectInternal(e.line,t,0,r)}},t.prototype.triggerFormFillEvent=function(e){var t,i=this.previousSelectedFormField,r=this.getCurrentFormField();r!==i&&i&&i.formFieldData instanceof ye&&"Text"===i.formFieldData.type&&(""===i.formFieldData.format||this.isFormatUpdated||this.owner.editor.applyFormTextFormat(i),i.formFieldData.name,this.owner.editorModule.getFieldResultText(i)),r!==i&&r&&r.formFieldData instanceof ye&&"Text"===r.formFieldData.type&&sf.base.isNullOrUndefined(e)&&(t={fieldName:r.formFieldData.name,value:this.owner.editorModule.getFieldResultText(r)},this.owner.fireBeforeFormFieldFill(t)),r!==i&&r&&(r.formFieldData instanceof ye&&"Inline"===this.owner.documentEditorSettings.formFieldSettings.formFillingMode||r.formFieldData instanceof ve)&&e&&(t={fieldName:r.formFieldData.name,value:this.owner.editorModule.getFieldResultText(r)},this.owner.fireBeforeFormFieldFill(t))},t.prototype.selectPreviousCell=function(){var e=this.start.paragraph.associatedCell,t=e.ownerRow;t.ownerTable;if(sf.base.isNullOrUndefined(e.previousWidget)){if(!sf.base.isNullOrUndefined(t.previousRenderedWidget)){var i=void 0;t.previousRenderedWidget instanceof ce&&(i=t.previousRenderedWidget),this.selectTableCellInternal(i.childWidgets[i.childWidgets.length-1],!0)}}else{var r=void 0;e.previousWidget instanceof pe&&(r=e.previousWidget),this.selectTableCellInternal(r,!0)}},t.prototype.selectNextCell=function(){var e=this.start.paragraph.associatedCell,t=e.ownerRow;t.ownerTable;if(sf.base.isNullOrUndefined(e.nextWidget))if(sf.base.isNullOrUndefined(t.nextRenderedWidget)&&!this.owner.isReadOnlyMode)this.owner.editorModule.insertRow(!1);else{var i=void 0;t.nextRenderedWidget instanceof ce&&(i=t.nextRenderedWidget),this.selectTableCellInternal(i.childWidgets[0],!0)}else{var r=void 0;e.nextRenderedWidget instanceof pe&&(r=e.nextRenderedWidget),this.selectTableCellInternal(r,!0)}},t.prototype.selectTableCellInternal=function(e,t){var i=this.getFirstParagraph(e),r=this.getLastParagraph(e);if(i===r&&r.isEmpty())this.selectParagraphInternal(r,!0);else{var n=r.childWidgets[0];this.start.setPosition(i.childWidgets[0],!0),this.end.setPositionParagraph(n,n.getEndOffset()),this.fireSelectionChanged(!0)}},t.prototype.selectTableInternal=function(){var e=this.start,t=this.end;if(this.isForward||(e=this.end,t=this.start),!sf.base.isNullOrUndefined(e)&&!sf.base.isNullOrUndefined(t)&&!sf.base.isNullOrUndefined(this.getTable(e,t))){var i=this.getContainerCellOf(e.paragraph.associatedCell,t.paragraph.associatedCell).ownerTable,r=this.documentHelper.getFirstParagraphBlock(i),n=this.documentHelper.getLastParagraphBlock(i),o=n.lastChild.getEndOffset();this.start.setPosition(r.childWidgets[0],!0),this.end.setPositionParagraph(n.lastChild,o+1)}this.selectPosition(this.start,this.end)},t.prototype.selectColumnInternal=function(){var e=this.start,t=this.end;if(this.isForward||(e=this.end,t=this.start),!sf.base.isNullOrUndefined(e)&&!sf.base.isNullOrUndefined(t)&&!sf.base.isNullOrUndefined(this.getTable(e,t))){var i=this.getContainerCellOf(e.paragraph.associatedCell,t.paragraph.associatedCell);if(i.ownerTable.contains(t.paragraph.associatedCell)){var r=this.getSelectedCell(e.paragraph.associatedCell,i),n=this.getSelectedCell(t.paragraph.associatedCell,i);if(this.containsCell(i,t.paragraph.associatedCell)){r.ownerRow;var o=i.ownerTable.getColumnCellsForSelection(i,i);if(o.length>0){var s=this.getFirstParagraph(o[0]),a=this.getLastParagraph(o[o.length-1]);this.start.setPosition(s.firstChild,!0);var l=a.lastChild;this.end.setPositionParagraph(l,l.getEndOffset()+1)}}else{var h=i.ownerTable.getColumnCellsForSelection(r,r),d=i.ownerTable.getColumnCellsForSelection(n,n);if(h.length>0&&d.length>0){s=this.getFirstParagraph(h[0]),a=this.getLastParagraph(d[d.length-1]);this.start.setPosition(s.firstChild,!0);l=a.lastChild;this.end.setPositionParagraph(l,l.getEndOffset()+1)}}}}this.selectPosition(this.start,this.end)},t.prototype.selectTableRow=function(){var e=this.start,t=this.end;if(this.isForward||(e=this.end,t=this.start),!sf.base.isNullOrUndefined(e)&&!sf.base.isNullOrUndefined(t)&&!sf.base.isNullOrUndefined(this.getTable(e,t))){var i=void 0;if((i=this.getContainerCellOf(e.paragraph.associatedCell,t.paragraph.associatedCell)).ownerTable.contains(t.paragraph.associatedCell)){var r=this.getSelectedCell(e.paragraph.associatedCell,i),n=this.getSelectedCell(t.paragraph.associatedCell,i);if(this.containsCell(i,t.paragraph.associatedCell)){var o=r.ownerRow,s=this.getFirstParagraph(o.childWidgets[0]),a=this.getLastParagraph(o.childWidgets[o.childWidgets.length-1]);this.start.setPosition(s.firstChild,!0),this.end.setPositionParagraph(a.lastChild,a.lastChild.getEndOffset()+1)}else{s=this.getFirstParagraph(r.ownerRow.childWidgets[0]),a=void 0;a=this.getLastParagraph(n.ownerRow.childWidgets[n.ownerRow.childWidgets.length-1]),this.start.setPosition(s.firstChild,!0),this.end.setPositionParagraph(a.lastChild,a.lastChild.getEndOffset()+1)}}}this.selectPosition(this.start,this.end)},t.prototype.selectTableCell=function(){var e=this.start,t=this.end;if(this.isForward||(e=this.end,t=this.start),!sf.base.isNullOrUndefined(this.getTable(e,t))){if(this.isEmpty){if(e.paragraph.isInsideTable&&!sf.base.isNullOrUndefined(e.paragraph.associatedCell))(r=this.getFirstParagraph(e.paragraph.associatedCell))===(n=this.getLastParagraph(t.paragraph.associatedCell))?(this.start.setPosition(n.firstChild,!0),this.end.setPositionParagraph(n.lastChild,n.lastChild.getEndOffset()+1)):(this.start.setPosition(r.firstChild,!0),this.end.setPositionParagraph(n.lastChild,n.lastChild.getEndOffset()+1))}else{var i=this.getContainerCell(e.paragraph.associatedCell);if(this.containsCell(i,e.paragraph.associatedCell)&&this.containsCell(i,t.paragraph.associatedCell)){var r=this.getFirstParagraph(i),n=this.getLastParagraph(i);sf.base.isNullOrUndefined(r)||sf.base.isNullOrUndefined(n)||(this.start.setPosition(r.firstChild,!0),this.end.setPositionParagraph(n.lastChild,n.lastChild.getEndOffset()+1))}}this.selectPosition(this.start,this.end)}},t.prototype.selectAll=function(){var e,t;this.documentHelper.skipScrollToPosition=!0;var i=this.getContainerWidget(this.start.paragraph);if(this.owner.enableHeaderAndFooter){var r=this.getContainerWidget(this.start.paragraph);e=this.setPositionForBlock(r.firstChild,!0),t=this.setPositionForBlock(r.lastChild,!1)}else if(this.isInShape){var n=this.getCurrentTextFrame();e=this.setPositionForBlock(n.firstChild,!0),t=this.setPositionForBlock(n.lastChild,!1)}else if(i instanceof ae&&"Footnote"===i.footNoteType){var o=void 0,s=void 0,a=this.documentHelper.pages.length;for(o=0;o<=a-1;o++)if(!sf.base.isNullOrUndefined(this.documentHelper.pages[o].footnoteWidget)){e=this.setPositionForBlock(this.documentHelper.pages[o].footnoteWidget.bodyWidgets[0].firstChild,!0);break}for(s=a-1;s>=0;s--)if(!sf.base.isNullOrUndefined(this.documentHelper.pages[s].footnoteWidget)){var l=this.documentHelper.pages[s].footnoteWidget.bodyWidgets.length,h=this.documentHelper.pages[s].footnoteWidget.bodyWidgets[l-1].childWidgets.length;t=this.setPositionForBlock(this.documentHelper.pages[s].footnoteWidget.bodyWidgets[l-1].childWidgets[h-1],!1);break}}else if(i instanceof ae&&"Endnote"===i.footNoteType){var d=this.getContainerWidget(this.start.paragraph);e=this.setPositionForBlock(d.bodyWidgets[0].firstChild,!0),t=this.setPositionForBlock(d.bodyWidgets[d.bodyWidgets.length-1].lastChild,!1)}else e=this.owner.documentStart,t=this.owner.documentEnd;sf.base.isNullOrUndefined(e)||(this.start.setPositionInternal(e),this.end.setPositionParagraph(t.currentWidget,t.offset+1),this.upDownSelectionLength=this.end.location.x,this.fireSelectionChanged(!0))},t.prototype.extendBackward=function(){sf.base.isNullOrUndefined(this.start)||((this.isForward?this.start.isCurrentParaBidi:this.end.isCurrentParaBidi)?this.end.moveForward():this.end.moveBackward(),this.upDownSelectionLength=this.end.location.x,this.fireSelectionChanged(!0))},t.prototype.extendForward=function(){sf.base.isNullOrUndefined(this.start)||((this.isForward?this.start.isCurrentParaBidi:this.end.isCurrentParaBidi)?this.end.moveBackward():this.end.moveForward(),this.upDownSelectionLength=this.end.location.x,this.fireSelectionChanged(!0))},t.prototype.extendToWordStartEnd=function(){return!(!this.start.paragraph.isInsideTable&&!this.end.paragraph.isInsideTable||this.start.paragraph.associatedCell===this.end.paragraph.associatedCell&&!this.isCellSelected(this.start.paragraph.associatedCell,this.start,this.end))},t.prototype.extendToWordStart=function(){this.extendToWordStartInternal(!1)},Object.defineProperty(t.prototype,"sfdt",{get:function(){return this.owner.editorModule&&this.start.offset!==this.end.offset?JSON.stringify(this.writeSfdt()):null},enumerable:!0,configurable:!0}),t.prototype.extendToWordEnd=function(){this.extendToWordEndInternal(!1)},t.prototype.extendToWordStartInternal=function(e){sf.base.isNullOrUndefined(this.start)||(this.extendToWordStartEnd()?this.end.moveToPreviousParagraphInTable(this):e&&this.end.isCurrentParaBidi?this.end.moveToWordEndInternal(e?0:1,!1):this.end.moveToWordStartInternal(e?0:1),e&&this.start.setPositionInternal(this.end),this.upDownSelectionLength=this.end.location.x,this.fireSelectionChanged(!0))},t.prototype.extendToWordEndInternal=function(e){sf.base.isNullOrUndefined(this.start)||(this.extendToWordStartEnd()?this.end.moveToNextParagraphInTable():e&&this.end.isCurrentParaBidi?this.end.moveToWordStartInternal(e?0:1):this.end.moveToWordEndInternal(e?0:1,!1),e&&this.start.setPositionInternal(this.end),this.upDownSelectionLength=this.end.location.x,this.fireSelectionChanged(!0))},t.prototype.extendToNextLine=function(){sf.base.isNullOrUndefined(this.start)||(this.end.moveToNextLine(this.upDownSelectionLength),this.fireSelectionChanged(!0))},t.prototype.getTextPosition=function(e){var t=new Ft(this.owner);return t.setPositionForCurrentIndex(e),t},t.prototype.getText=function(e){if(!(sf.base.isNullOrUndefined(this.start)||sf.base.isNullOrUndefined(this.end)||sf.base.isNullOrUndefined(this.start.paragraph)||sf.base.isNullOrUndefined(this.end.paragraph))){var t=this.start,i=this.end;return t.isAtSamePosition(i)?"":this.getTextInternal(t,i,e)}},t.prototype.getTextInternal=function(e,t,i){if(e.isExistAfter(t)){var r=t;t=e,e=r}var n=e,o=t;if(!(sf.base.isNullOrUndefined(e)||sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(e.paragraph)||sf.base.isNullOrUndefined(t.paragraph))){var s=0,a=0,l=e.offset,h=t.offset,d=e.currentWidget.getInline(l,s);s=d.index;var c=d.element;if(c instanceof fe&&!sf.base.isNullOrUndefined(c.fieldEnd)){var p=this.getRenderedInline(c,s);c=p.element,s=p.index}var u=t.currentWidget.getInline(h,a),g=u.element;a=u.index;var f="";if(c instanceof Re&&i&&0===s?f=ge.objectCharacter:c instanceof we&&(f=sf.base.isNullOrUndefined(c.text)||""===c.text||c.text.length<s?f:c.text.substring(s)),n.paragraph===o.paragraph)c instanceof ge&&(c===g&&c instanceof we?f=f.length<a-s?f:f.substring(0,a-s):c.nextNode instanceof ge&&(f+=this.getTextInline(c.nextNode,o.paragraph,g,a,i)));else if(c instanceof ge&&c.nextNode instanceof ge)f+=this.getTextInline(c.nextNode,o.paragraph,void 0,0,i);else{var m=this.documentHelper.selection.getNextParagraphBlock(n.paragraph);for(f+="\r";!sf.base.isNullOrUndefined(m)&&m.isEmpty();){if(f+="\r",m===o.paragraph)return f;m=this.documentHelper.selection.getNextParagraphBlock(m)}sf.base.isNullOrUndefined(m)||m.isEmpty()||(f+=this.getTextInline(m.childWidgets[0].children[0],o.paragraph,g,a,i))}return h===o.currentWidget.getEndOffset()+1&&(f+="\r"),f}},t.prototype.getHierarchicalIndex=function(e,t){var i;if(e){if(e instanceof oe){var r=-1!==e.headerFooterType.indexOf("Header")?"H":"F",n=e.page.index.toString();i=e.page.sectionIndex+";"+r+";"+n+";"+t}else{if(e instanceof ne&&!sf.base.isNullOrUndefined(e.containerWidget)&&e.containerWidget instanceof ae)i=e.containerWidget.bodyWidgets.indexOf(e)+";"+t;else i=e.index+";"+t}if(e instanceof ze)return i="S;"+e.containerShape.line.getOffset(e.containerShape,1)+";"+t,this.getHierarchicalIndex(e.containerShape.paragraph,i);if(e instanceof ae){r="Footnote"===e.footNoteType?"FN":"EN",n=e.page.index.toString();i=e.page.sectionIndex+";"+r+";"+n+";"+t}if(e.containerWidget)return e instanceof pe&&e.rowIndex!==e.containerWidget.index&&(i=e.rowIndex+";"+i,e=e.containerWidget),this.getHierarchicalIndex(e.containerWidget,i)}return i},t.prototype.getHierarchicalIndexByPosition=function(e){var t=this.getParagraphInfo(e);return this.getHierarchicalIndex(t.paragraph,t.offset.toString())},t.prototype.getTextPosBasedOnLogicalIndex=function(e){var t=new Ft(this.owner),i=this.getParagraph({index:e}),r=this.getLineInfoBasedOnParagraph(i.paragraph,i.offset);return t.setPositionForLineWidget(r.line,r.offset),t},t.prototype.getLineInfoBasedOnParagraph=function(e,t){var i=this.getParagraphLength(e),r=e.nextSplitWidget;for(t>i+1&&sf.base.isNullOrUndefined(r)&&(t=i);t>i&&r instanceof le;)t-=i,e=r,i=this.getParagraphLength(e),r=e.nextSplitWidget;return this.getLineInfo(e,t)},t.prototype.getParagraph=function(e){return{paragraph:this.getParagraphInternal(this.getBodyWidget(e),e),offset:parseInt(e.index,10)}},t.prototype.getBodyWidget=function(e){var t=e.index.indexOf(";"),i=e.index.substring(0,t);e.index=e.index.substring(t).replace(";","");var r=parseInt(i,10);return t=parseInt(i,10),t=e.index.indexOf(";"),"H"===(i=e.index.substring(0,t))||"F"===i?this.getHeaderFooterWidget(e):"FN"===i||"EN"===i?this.getFootNoteWidget(e):(t=parseInt(i,10),this.getBodyWidgetInternal(r,t))},t.prototype.getFootNoteWidget=function(e){var t=e.index.indexOf(";"),i=e.index.substring(0,t);e.index=e.index.substring(t).replace(";","");var r="FN"===i;t=e.index.indexOf(";"),i=e.index.substring(0,t),e.index=e.index.substring(t).replace(";",""),t=parseInt(i,10);var n=this.documentHelper.pages[t];return t=e.index.indexOf(";"),i=e.index.substring(0,t),e.index=e.index.substring(t).replace(";",""),t=parseInt(i,10),r?n.footnoteWidget.bodyWidgets[t]:n.endnoteWidget.bodyWidgets[t]},t.prototype.getHeaderFooterWidget=function(e){var t=e.index.indexOf(";"),i=e.index.substring(0,t);e.index=e.index.substring(t).replace(";","");var r="H"===i;t=e.index.indexOf(";"),i=e.index.substring(0,t),e.index=e.index.substring(t).replace(";",""),t=parseInt(i,10);var n,o=this.documentHelper.pages[t];return n=r?o.headerWidget:o.footerWidget,sf.base.isNullOrUndefined(n)||(n.page=o),n},t.prototype.getBodyWidgetInternal=function(e,t){for(var i=0;i<this.documentHelper.pages.length;i++)for(var r=0;r<this.documentHelper.pages[i].bodyWidgets.length;r++){var n=this.documentHelper.pages[i].bodyWidgets[r];if(n.index===e&&n.childWidgets.length>0&&n.firstChild.index<=t&&n.lastChild.index>=t)return n;if(n.index>e)break}},t.prototype.getParagraphInternal=function(e,t){if(!sf.base.isNullOrUndefined(t.index)){var i=t.index.indexOf(";"),r="0";i>=0&&(r=t.index.substring(0,i),t.index=t.index.substring(i).replace(";","")),i=parseInt(r,10),e instanceof ce&&i>=e.childWidgets.length&&(t.index="0;0",i=e.childWidgets.length-1);var n=this.getBlockByIndex(e,i);if(n){if("S"===(r=t.index.substring(0,1))){t.index=t.index.substring(1).replace(";","");var o=t.index.substring(0,t.index.indexOf(";"));t.index=t.index.substring(t.index.indexOf(";")).replace(";","");var s=t.index.substring(0,t.index.indexOf(";"));t.index=t.index.substring(t.index.indexOf(";")).replace(";","");var a=n.getInline(parseInt(o),0).element;n=a.textFrame.childWidgets[s]}var l=n;if(l instanceof le)return t.index.indexOf(";")>0&&(t.index="0"),l;if(l instanceof ie)return t.index.indexOf(";")>0?this.getParagraphInternal(l,t):l instanceof de?this.documentHelper.getFirstParagraphInFirstCell(l):void 0}else if(e){var h=e.getSplitWidgets().pop().nextRenderedWidget;if(h instanceof ie)return t.index="0",h instanceof de?this.documentHelper.getFirstParagraphInFirstCell(h):h}}},t.prototype.getBlockByIndex=function(e,t){var i;if(e){for(var r=0;r<e.childWidgets.length;r++)if(e.childWidgets[r].index===t){i=e.childWidgets[r];break}if(!(i||e instanceof oe))return this.getBlockByIndex(e.nextSplitWidget,t)}return i},t.prototype.getParagraphInfo=function(e){return this.getParagraphInfoInternal(e.currentWidget,e.offset)},t.prototype.getParagraphInfoInternal=function(e,t){for(var i=e.paragraph,r=this.getParagraphLength(i,e)+t,n=i.previousSplitWidget;n instanceof le;)i=n,r+=this.documentHelper.selection.getParagraphLength(i),n=i.previousSplitWidget;return{paragraph:i,offset:r}},t.prototype.getListTextElementBox=function(e){if(!sf.base.isNullOrUndefined(e)){var t;if(!e.isEmpty()){var i=e.childWidgets[0];i.children.length>1&&i.children[0]instanceof je&&(t=i.children[0])}return t}},t.prototype.getListLevel=function(e){var t=void 0,i=0;if(sf.base.isNullOrUndefined(e.paragraphFormat)||sf.base.isNullOrUndefined(e.paragraphFormat.listFormat)||(t=this.documentHelper.getListById(e.paragraphFormat.listFormat.listId),i=e.paragraphFormat.listFormat.listLevelNumber),!sf.base.isNullOrUndefined(t)&&!sf.base.isNullOrUndefined(this.documentHelper.getAbstractListById(t.abstractListId))&&!sf.base.isNullOrUndefined(this.documentHelper.getAbstractListById(t.abstractListId).levels))return this.documentHelper.layout.getListLevel(t,i)},t.prototype.getTextInline=function(e,t,i,r,n){var o="";do{if(e===i){if(e instanceof we){var s=e;sf.base.isNullOrUndefined(s.text)||""===s.text||(s.text.length<r?o+=s.text:o+=s.text.substring(0,r))}else e instanceof Re&&n&&r===e.length&&(o+=ge.objectCharacter);return o}if(e instanceof we?o+=e.text:e instanceof Re&&n?o+=ge.objectCharacter:e instanceof fe&&!sf.base.isNullOrUndefined(e.fieldEnd)&&(e=sf.base.isNullOrUndefined(e.fieldSeparator)?e.fieldEnd:e.fieldSeparator),sf.base.isNullOrUndefined(e.nextNode))break;e=e.nextNode}while(!sf.base.isNullOrUndefined(e));if(t===e.line.paragraph)return o;for(var a=this.documentHelper.selection.getNextParagraphBlock(e.line.paragraph);!sf.base.isNullOrUndefined(a)&&a.isEmpty();){if(o+="\r",a===t)return o;a=this.documentHelper.selection.getNextParagraphBlock(a)}if(!sf.base.isNullOrUndefined(a)&&!a.isEmpty()){var l=a.childWidgets[0];o=o+"\r"+this.getTextInline(l.children[0],t,i,r,n)}return o},t.prototype.getFieldCode=function(e){var t="";if(!(e.fieldEnd instanceof fe))return t;var i=e.paragraph,r=e.fieldEnd.paragraph;e.fieldSeparator instanceof fe&&(r=e.fieldSeparator.paragraph);var n=e.line.indexInOwner,o=e.indexInOwner;do{if(t+=this.getFieldCodeInternal(i,n,o),i===r)break;i=this.getNextParagraphBlock(i),n=0,o=0}while(i instanceof le);return t.trim()},t.prototype.getFieldCodeInternal=function(e,t,i){for(var r="",n=t;n<e.childWidgets.length;n++){for(var o=e.childWidgets[n],s=i;s<o.children.length;s++){var a=o.children[s];if(a instanceof we&&(r+=a.text),a instanceof fe&&(2===a.fieldType||1===a.fieldType))return r}i=0}return r},t.prototype.getTocFieldInternal=function(){var e=this.start.paragraph;for(this.isEmpty||this.isForward||(e=this.end.paragraph);e instanceof le&&e.childWidgets.length>0;){var t=e.firstChild;if(t.children.length>0){var i=t.children[0],r=i.nextNode;if(i instanceof fe&&0===i.fieldType&&r instanceof we&&0===r.text.trim().toLowerCase().indexOf("toc"))return i}e=e.previousRenderedWidget}},t.prototype.getNextParagraph=function(e){if(e.nextRenderedWidget instanceof ne){var t=e.nextRenderedWidget.childWidgets[0];return this.documentHelper.getFirstParagraphBlock(t)}},t.prototype.getPreviousParagraph=function(e){if(e.previousRenderedWidget instanceof ne){var t=e.previousRenderedWidget,i=t.childWidgets[t.childWidgets.length-1];return this.documentHelper.getLastParagraphBlock(i)}},t.prototype.getNextStartInline=function(e,t){var i=0,r=e.getInline(t,i),n=r.element;if(i=r.index,!sf.base.isNullOrUndefined(n)&&i===n.length&&n.nextNode instanceof fe||n instanceof Ee){var o=this.getNextValidElement(n.nextNode);o instanceof fe&&0===o.fieldType&&(n=o)}return n},t.prototype.getPreviousTextInline=function(e){return e.previousNode instanceof we?e.previousNode:e.previousNode instanceof fe&&x.isLinkedFieldCharacter(e.previousNode)?0===e.previousNode.fieldType||1===e.previousNode.fieldType?e.previousNode:e.previousNode.fieldBegin:sf.base.isNullOrUndefined(e.previousNode)?void 0:this.getPreviousTextInline(e.previousNode)},t.prototype.getNextTextInline=function(e){return e.nextNode instanceof we?e.nextNode:e.nextNode instanceof fe&&x.isLinkedFieldCharacter(e.nextNode)?1===e.nextNode.fieldType||0===e.nextNode.fieldType?e.nextNode:e.nextNode.fieldEnd:sf.base.isNullOrUndefined(e.nextNode)?void 0:this.getNextTextInline(e.nextNode)},t.prototype.getContainerTable=function(e){if(e.isInsideTable&&(e=e.associatedCell.ownerTable.isInsideTable?this.getContainerTable(e.associatedCell.ownerTable):e.associatedCell.ownerTable),e instanceof de)return e},t.prototype.isElementInSelection=function(e,t){var i=e.line.getOffset(e,t?0:1),r=new Ft(this.owner);r.setPositionParagraph(e.line,i);var n=this.start,o=this.end;return this.isForward||(n=this.end,o=this.start),(r.isExistAfter(n)||r.isAtSamePosition(n))&&(r.isExistBefore(o)||r.isAtSamePosition(o))},t.prototype.isSelectionInsideElement=function(e){if(this.isEmpty){var t=e.line.getOffset(e,0),i=new Ft(this.owner);i.setPositionParagraph(e.line,t);var r=e.line.getOffset(e,e.length),n=new Ft(this.owner);return n.setPositionParagraph(e.line,r),(this.start.isExistAfter(i)||this.start.isAtSamePosition(i))&&(this.start.isExistBefore(n)||this.start.isAtSamePosition(n))}return!1},t.prototype.isExistBefore=function(e,t){if(e.isInsideTable){var i=e.associatedCell;if(t.isInsideTable){var r=t.associatedCell;if(i===r)return i.childWidgets.indexOf(e)<i.childWidgets.indexOf(t);if(i.ownerRow===r.ownerRow)return i.cellIndex<r.cellIndex;if(i.ownerTable===r.ownerTable)return i.ownerRow.rowIndex<r.ownerRow.rowIndex;var n=this.getContainerCellOf(i,r);return n.ownerTable.contains(r)?(i=this.getSelectedCell(i,n),r=this.getSelectedCell(r,n),i===n?this.isExistBefore(e,r.ownerTable):r===n?this.isExistBefore(i.ownerTable,t):n.ownerRow===r.ownerRow?n.cellIndex<r.cellIndex:n.ownerTable===r.ownerTable?n.ownerRow.rowIndex<r.ownerRow.rowIndex:this.isExistBefore(i.ownerTable,r.ownerTable)):this.isExistBefore(n.ownerTable,this.getContainerTable(r.ownerTable))}var o=this.getContainerTable(e);return this.isExistBefore(o,t)}if(t.isInsideTable){o=this.getContainerTable(t);return this.isExistBefore(e,o)}if(e.containerWidget===t.containerWidget)return e.index<t.index;if(e.containerWidget instanceof ne&&t.containerWidget instanceof ne){var s=this.documentHelper.pages.indexOf(e.containerWidget.page),a=this.documentHelper.pages.indexOf(t.containerWidget.page);return s===a?e.containerWidget.indexInOwner<t.containerWidget.indexInOwner:s===a&&e.containerWidget.containerWidget instanceof ae&&t.containerWidget.containerWidget instanceof ae?this.documentHelper.pages[s].footnoteWidget.bodyWidgets.indexOf(e.containerWidget)<this.documentHelper.pages[a].footnoteWidget.bodyWidgets.indexOf(t.containerWidget):s===a&&e.containerWidget.index!==t.containerWidget.index?this.documentHelper.pages[s].bodyWidgets.indexOf(e.containerWidget)<this.documentHelper.pages[a].bodyWidgets.indexOf(t.containerWidget):s<a}return!1},t.prototype.isExistAfter=function(e,t){if(e.isInsideTable){var i=e.associatedCell;if(t.isInsideTable){var r=t.associatedCell;if(i===r)return i.childWidgets.indexOf(e)>i.childWidgets.indexOf(t);if(i.ownerRow===r.ownerRow)return i.cellIndex>r.cellIndex;if(i.ownerTable===r.ownerTable)return i.ownerRow.rowIndex>r.ownerRow.rowIndex;var n=this.getContainerCellOf(i,r);return n.ownerTable.contains(r)?(i=this.getSelectedCell(i,n),r=this.getSelectedCell(r,n),i===n?this.isExistAfter(e,r.ownerTable):r===n?this.isExistAfter(i.ownerTable,t):n.ownerRow===r.ownerRow?n.cellIndex>r.cellIndex:n.ownerTable===r.ownerTable?n.ownerRow.rowIndex>r.ownerRow.rowIndex:this.isExistAfter(i.ownerTable,r.ownerTable)):this.isExistAfter(n.ownerTable,this.getContainerTable(r.ownerTable))}var o=this.getContainerTable(e);return this.isExistAfter(o,t)}if(t.isInsideTable){o=this.getContainerTable(t);return this.isExistAfter(e,o)}return e.containerWidget===t.containerWidget?e.index>t.index:(e.containerWidget instanceof ne&&t.containerWidget instanceof ne||e.containerWidget instanceof ae&&t.containerWidget instanceof ae)&&this.documentHelper.pages.indexOf(e.containerWidget.page)>this.documentHelper.pages.indexOf(t.containerWidget.page)},t.prototype.isExistBeforeInline=function(e,t){if(e.line===t.line)return e.line.children.indexOf(e)<=t.line.children.indexOf(t);if(e.line.paragraph===t.line.paragraph)return e.line.paragraph.childWidgets.indexOf(e.line)<t.line.paragraph.childWidgets.indexOf(t.line);var i=e.line.paragraph,r=t.line.paragraph;if(i.containerWidget===r.containerWidget){if(i.isInsideTable)return i.associatedCell.childWidgets.indexOf(i)<r.associatedCell.childWidgets.indexOf(r);if(!(i.containerWidget instanceof oe))return i.containerWidget.childWidgets.indexOf(i)<r.containerWidget.childWidgets.indexOf(r)}return this.isExistBefore(i,r)},t.prototype.isExistAfterInline=function(e,t,i){if(e.line===t.line){var r=this.documentHelper.selection;return i?e.line.children.indexOf(e)>=t.line.children.indexOf(t):e===t&&r.start.offset!==r.end.offset?e.line.children.indexOf(e)===t.line.children.indexOf(t):e.line.children.indexOf(e)>t.line.children.indexOf(t)}if(e.line.paragraph===t.line.paragraph)return e.line.paragraph.childWidgets.indexOf(e.line)>t.line.paragraph.childWidgets.indexOf(t.line);var n=e.line.paragraph,o=t.line.paragraph;if(n.containerWidget===o.containerWidget){if(n.isInsideTable)return n.associatedCell.childWidgets.indexOf(n)>o.associatedCell.childWidgets.indexOf(o);if(!(n.containerWidget instanceof oe))return n.containerWidget.childWidgets.indexOf(n)>o.containerWidget.childWidgets.indexOf(o)}return this.isExistAfter(n,o)},t.prototype.getNextRenderedBlock=function(e){return sf.base.isNullOrUndefined(e.nextWidget)?e.nextRenderedWidget:e.nextWidget},t.prototype.getPreviousRenderedBlock=function(e){return sf.base.isNullOrUndefined(e.previousWidget)?e.previousRenderedWidget:e.previousWidget},t.prototype.getNextParagraphBlock=function(e){if(e.nextRenderedWidget instanceof le)return e.nextRenderedWidget;if(e.nextRenderedWidget instanceof de)return this.documentHelper.getFirstParagraphInFirstCell(e.nextRenderedWidget);if(e.containerWidget instanceof pe)return this.getNextParagraphCell(e.containerWidget);if(e.containerWidget instanceof ne){e.containerWidget;return this.getNextParagraph(e.containerWidget)}return e.containerWidget instanceof oe&&this.isMoveDownOrMoveUp?this.getFirstBlockInNextHeaderFooter(e):void 0},t.prototype.getFirstBlockInNextHeaderFooter=function(e){var t,i=e.containerWidget;if(-1!==i.headerFooterType.indexOf("Header"))t=i.page.footerWidget.firstChild;else{if(!i.page.nextPage)return;var r=i.page.nextPage,n=r.headerWidget;n.page=r,r.footerWidget&&(r.footerWidget.page=r),t=n.firstChild}return t instanceof le?t:this.getFirstBlockInFirstCell(t)},t.prototype.getLastBlockInPreviousHeaderFooter=function(e){var t,i=e.containerWidget;if(-1!==i.headerFooterType.indexOf("Footer"))t=i.page.headerWidget.lastChild;else{if(!i.page.previousPage)return;var r=i.page.previousPage,n=r.footerWidget;n.page=r,r.headerWidget&&(r.headerWidget.page=r),t=n.lastChild}return t instanceof le?t:this.getFirstBlockInFirstCell(t)},t.prototype.getPreviousParagraphBlock=function(e){return e.previousRenderedWidget instanceof le?e.previousRenderedWidget:e.previousRenderedWidget instanceof de?this.documentHelper.getLastParagraphInLastCell(e.previousRenderedWidget):e.containerWidget instanceof pe?this.getPreviousParagraphCell(e.containerWidget):e.containerWidget instanceof ne?this.getPreviousParagraph(e.containerWidget):e.containerWidget instanceof oe&&this.isMoveDownOrMoveUp?this.getLastBlockInPreviousHeaderFooter(e):void 0},t.prototype.hasValidInline=function(e,t,i){for(var r=e.childWidgets.indexOf(t.line);r<e.childWidgets.length;r++)for(var n=0;n<e.childWidgets[r].children.length;n++){var o=e.childWidgets[r].children[n];if(0!==o.length){if(o===i)return!1;if(o instanceof we||o instanceof Re||o instanceof fe&&x.isLinkedFieldCharacter(o))return!0}}return!1},t.prototype.getParagraphLength=function(e,t,i){for(var r=0,n=0;n<e.childWidgets.length;n++){var o=e.childWidgets[n];if(t instanceof ue&&t===o){i&&(r+=this.getLineLength(o,i));break}r+=this.getLineLength(o)}return r},t.prototype.getLineLength=function(e,t){for(var i=0,r=e.paragraph.bidi,n=r?e.children.length-1:0;r?n>-1:n<e.children.length;r?n--:n++){var o=e.children[n];if(!(o instanceof je)){if(t&&t.element instanceof ge&&t.element===o){i+=t.index;break}i+=o.length}}return i},t.prototype.getLineInfo=function(e,t){for(var i=void 0,r=0,n=e.childWidgets.length,o=0;o<n&&(i=e.childWidgets[o],!(t<=(r=this.getLineLength(i))||o===n-1));o++)t-=r;return{line:i,offset:t}},t.prototype.getElementInfo=function(e,t){for(var i=void 0,r=0;r<e.children.length;r++)if(!((i=e.children[r])instanceof je)){if(!(t>i.length)||t===i.length+1&&sf.base.isNullOrUndefined(i.nextNode))break;t-=i.length}return{element:i,index:t}},t.prototype.getStartOffset=function(e){if(e.childWidgets.length>0){var t=e.childWidgets[0];return this.getStartLineOffset(t)}return 0},t.prototype.getStartLineOffset=function(e){for(var t=0,i=0;i<e.children.length;i++){var r=e.children[i];if(0!==r.length){if(r instanceof we||r instanceof Re||r instanceof Ce||r instanceof Ee||r instanceof He||r instanceof Ue||r instanceof nt||r instanceof fe&&x.isLinkedFieldCharacter(r)||r instanceof Oe)return t;r instanceof je||(t+=r.length)}}return t},t.prototype.getPreviousSelectionCell=function(e){if(!sf.base.isNullOrUndefined(e.previousRenderedWidget)){if(this.isForward){var t=e.previousRenderedWidget.childWidgets;return(i=t[t.length-1])instanceof le?i:this.getPreviousParagraphSelection(i.childWidgets[i.childWidgets.length-1])}var i;return(i=e.previousRenderedWidget.childWidgets[0])instanceof le?i:this.documentHelper.getFirstParagraphInLastRow(i)}return this.getPreviousSelectionRow(e.ownerRow)},t.prototype.getPreviousSelectionRow=function(e){if(!sf.base.isNullOrUndefined(e.previousRenderedWidget)){if(this.isForward)return this.getPreviousParagraphSelection(e.previousRenderedWidget);var t=e.previousRenderedWidget.childWidgets[0].childWidgets[0];return this.documentHelper.getFirstParagraphBlock(t)}return this.getPreviousSelectionBlock(e.ownerTable)},t.prototype.getNextSelectionBlock=function(e){return e.nextRenderedWidget instanceof le?e.nextRenderedWidget:e.nextRenderedWidget instanceof de?this.isEmpty||this.isForward?this.documentHelper.getLastParagraphInFirstRow(e.nextRenderedWidget):this.getNextParagraphSelection(e.nextRenderedWidget.childWidgets[0]):e.containerWidget instanceof pe?this.getNextSelectionCell(e.containerWidget):e.containerWidget instanceof ne?this.getNextSelection(e.containerWidget):void 0},t.prototype.getNextSelectionCell=function(e){if(!sf.base.isNullOrUndefined(e.nextRenderedWidget)){if(this.isEmpty||this.isForward){var t=e.nextRenderedWidget.childWidgets[e.nextRenderedWidget.childWidgets.length-1];return this.documentHelper.getLastParagraphBlock(t)}return(t=e.nextRenderedWidget.childWidgets[0])instanceof le?t:this.getNextParagraphSelection(t.childWidgets[0])}return this.getNextSelectionRow(e.ownerRow)},t.prototype.getNextSelectionRow=function(e){if(!sf.base.isNullOrUndefined(e.nextRenderedWidget)){if(this.isEmpty||this.isForward){var t=e.nextRenderedWidget.childWidgets[e.nextRenderedWidget.childWidgets.length-1],i=t.childWidgets[t.childWidgets.length-1];return this.documentHelper.getLastParagraphBlock(i)}return this.getNextParagraphSelection(e.nextRenderedWidget)}return this.getNextSelectionBlock(e.ownerTable)},t.prototype.getNextSelection=function(e){if(e.nextRenderedWidget instanceof ne){var t=e.nextRenderedWidget.childWidgets[0];return t instanceof le?t:this.isEmpty||this.isForward?this.documentHelper.getLastParagraphInFirstRow(t):this.getNextParagraphSelection(t.childWidgets[0])}},t.prototype.getNextParagraphSelection=function(e){var t=e.childWidgets[0];if(this.start.paragraph.isInsideTable&&e.ownerTable.contains(this.start.paragraph.associatedCell)){var i=this.getCellInTable(e.ownerTable,this.start.paragraph.associatedCell);t=this.getFirstCellInRegion(e,i,this.upDownSelectionLength,!1)}var r=t.childWidgets[0];return this.documentHelper.getFirstParagraphBlock(r)},t.prototype.getPreviousSelectionBlock=function(e){return e.previousRenderedWidget instanceof le?e.previousRenderedWidget:e.previousRenderedWidget instanceof de?this.isForward?this.getPreviousParagraphSelection(e.previousRenderedWidget.childWidgets[e.previousRenderedWidget.childWidgets.length-1]):this.documentHelper.getFirstParagraphInLastRow(e.previousRenderedWidget):e.containerWidget instanceof pe?this.getPreviousSelectionCell(e.containerWidget):e.containerWidget instanceof ne?this.getPreviousSelection(e.containerWidget):void 0},t.prototype.getPreviousSelection=function(e){if(e.previousRenderedWidget instanceof ne){var t=e.previousRenderedWidget,i=t.childWidgets[t.childWidgets.length-1];if(i instanceof le)return i;if(this.isForward){var r=i;return this.getPreviousParagraphSelection(r.childWidgets[r.childWidgets.length-1])}return this.documentHelper.getFirstParagraphInLastRow(i)}},t.prototype.getPreviousParagraphSelection=function(e){var t=e.childWidgets[e.childWidgets.length-1];if(this.start.paragraph.isInsideTable&&e.ownerTable.contains(this.start.paragraph.associatedCell)){var i=this.getCellInTable(e.ownerTable,this.start.paragraph.associatedCell);t=this.getLastCellInRegion(e,i,this.upDownSelectionLength,!0)}var r=t.childWidgets[t.childWidgets.length-1];return this.documentHelper.getLastParagraphBlock(r)},t.prototype.getLastCellInRegion=function(e,t,i,r){var n=this.getCellLeft(e,t),o=n+t.cellFormat.cellWidth,s=!0;if(n<=i&&i<o)for(var a=e.childWidgets.length-1;a>=0;a--){var l=this.getCellLeft(e,e.childWidgets[a]);if(x.round(n,2)<=x.round(l,2)&&x.round(l,2)<x.round(o,2))return s=!1,e.childWidgets[a]}else for(a=e.childWidgets.length-1;a>=0;a--){if((l=this.getCellLeft(e,e.childWidgets[a]))<=i&&l+e.childWidgets[a].cellFormat.cellWidth>i)return s=!1,e.childWidgets[a]}if(s){if(!sf.base.isNullOrUndefined(e.previousRenderedWidget)&&r)return this.getLastCellInRegion(e.previousRenderedWidget,t,i,r);if(!sf.base.isNullOrUndefined(e.nextRenderedWidget)&&!r)return this.getLastCellInRegion(e.nextRenderedWidget,t,i,r)}return e.childWidgets[e.childWidgets.length-1]},t.prototype.getCellInTable=function(e,t){for(;t.ownerTable.isInsideTable;){if(e.equals(t.ownerTable))return t;t=t.ownerTable.associatedCell}return t},t.prototype.getPreviousValidOffset=function(e,t){if(0===t)return 0;for(var i=0,r=0,n=(e.paragraphFormat.bidi,0);n<e.childWidgets.length;n++)for(var o=e.childWidgets[n],s=0;s<o.children.length;s++){var a=o.children[s];if(!(0===a.length||a instanceof je)){if(t<=r+a.length)return t-1===r?i:t-1;(a instanceof we||a instanceof Re||a instanceof Ce||a instanceof fe&&x.isLinkedFieldCharacter(a))&&(i=r+a.length),r+=a.length}}return t-1===r?i:t-1},t.prototype.getNextValidOffset=function(e,t){for(var i=0,r=0;r<e.children.length;r++){var n=e.children[r];if(!(0===n.length||n instanceof je)){if(t<i+n.length&&(n instanceof we||n instanceof Re||n instanceof fe&&x.isLinkedFieldCharacter(n)))return(t>i?t:i)+1;if(t===i+n.length&&n instanceof fe&&1===n.fieldType&&n.previousNode instanceof Re)return t;i+=n.length}}return t},t.prototype.getParagraphMarkSize=function(e,t,i){var r=this.documentHelper.textHelper.getParagraphMarkSize(e.characterFormat),n=r.BaselineOffset,o=r.Height,s=n;if(e instanceof le){if(e.childWidgets.length>0)e.childWidgets[0];var a=this.documentHelper.layout.getLineSpacing(e,o),l=this.documentHelper.layout.getBeforeSpacing(e);t=s-n,i=o-s-(r.Height-n);var h=e.paragraphFormat.lineSpacingType;"Multiple"===h?a>o?i+=a-o:t+=a-o:("Exactly"===h||a>t+r.Height+i)&&(t+=a-(t+r.Height+i)),t+=l,i+=this.documentHelper.layout.getAfterSpacing(e)}return{width:r.Width,height:r.Height,topMargin:t,bottomMargin:i}},t.prototype.getPhysicalPositionInternal=function(e,t,i){if(e.paragraph.isEmpty()){var r=e.paragraph,n=r.x;if(r.childWidgets.length>0){var o=r.childWidgets[0];n=this.getLeft(o)}var s=this.getParagraphMarkSize(e.paragraph,0,0);return t>0&&(n+=s.width),new M(n,r.y+0)}var a=0,l=e.getInline(t,a,e.paragraph.bidi),h=l.element;return a=l.index,this.getPhysicalPositionInline(h,a,i)},t.prototype.highlightSelectedContent=function(e,t){if(!e.paragraph.isInsideTable||t.paragraph.isInsideTable&&e.paragraph.associatedCell.equals(t.paragraph.associatedCell)&&(this.documentHelper.isSelectionChangedOnMouseMoved||!this.isCellSelected(e.paragraph.associatedCell,e,t))){var i=void 0,r=0;if(!this.owner.isReadOnlyMode&&e.paragraph===t.paragraph)if(e.offset+1===t.offset){var n=t.currentWidget.getInline(t.offset,r);if(i=n.element,r=n.index,i instanceof Re||i instanceof Ee)e.currentWidget.getOffset(i,0)!==e.offset&&(i=void 0)}else{var o=0,s=e.currentWidget.getInline(e.offset,o),a=s.element;(o=s.index)===a.length&&(a=this.getNextRenderedElementBox(a,o));var l=t.currentWidget.getInline(t.offset,o),h=l.element;if(o=l.index,a instanceof fe&&h instanceof fe&&!sf.base.isNullOrUndefined(a.fieldSeparator)){var d=a.fieldSeparator.nextNode;d instanceof Re&&d.nextNode===h&&(i=d)}}if(!this.owner.isReadOnlyMode&&this.owner.isDocumentLoaded&&(i instanceof Re||i instanceof Ee)){var c=this.getElementBoxInternal(i,r),p=c.element;r=c.index,this.owner.enableImageResizerMode&&(this.owner.imageResizerModule.positionImageResizer(p),this.owner.imageResizerModule.showImageResizer()),this.documentHelper.isTouchInput&&(this.documentHelper.touchStart.style.display="none",this.documentHelper.touchEnd.style.display="none")}else this.highlight(e.paragraph,e,t),this.isHighlightNext&&(this.highlightNextBlock(this.hightLightNextParagraph,e,t),this.isHighlightNext=!1,this.hightLightNextParagraph=void 0);this.isInShape&&this.showResizerForShape()}else this.highlightCell(e.paragraph.associatedCell,this,e,t)},t.prototype.showResizerForShape=function(){var e=this.getCurrentTextFrame().containerShape;this.owner.imageResizerModule.positionImageResizer(e),this.owner.imageResizerModule.showImageResizer()},t.prototype.highlight=function(e,t,i){var r=0,n=0,o=void 0,s=void 0,a=void 0,l=void 0,h=this.getStartLineWidget(e,t,o,r);o=h.element,a=sf.base.isNullOrUndefined(o)?e.childWidgets[0]:o.line,r=h.index;var d=this.getEndLineWidget(i,s,n);l=(s=d.element)?s.line:i.paragraph.childWidgets[i.paragraph.childWidgets.length-1],n=d.index;var c=0,p=0;if(sf.base.isNullOrUndefined(a)||(c=this.getTop(a),p=this.getLeftInternal(a,o,r)),sf.base.isNullOrUndefined(a)||a!==l){if(!sf.base.isNullOrUndefined(a)){a.paragraph.x;e!==a.paragraph&&(e=a.paragraph);m=this.getWidth(a,!0)-(p-a.paragraph.x);if(e.bidi||o instanceof we&&o.isRightToLeft){f=0;var u=this.getElementsForward(a,o,s,e.bidi);if(u){for(x=!1,b=0;b<u.length;b++){x=!1,p=(w=u[b])===o?this.getLeftInternal(a,w,r):this.getLeftInternal(a,w,0);M=w instanceof we?w.length:1;f=this.getLeftInternal(a,w,M),w instanceof we&&(x=w.isRightToLeft),m=Math.abs(f-p),this.createHighlightBorder(a,m,x?f:p,c,!0)}if(a.isLastLine()){N=u[u.length-1].line.paragraph.characterFormat,I=this.documentHelper.textHelper.getParagraphMarkSize(N).Width;p=e.bidi?this.getLineStartLeft(a)-I:x?a.paragraph.x+this.getWidth(a,!1):f,this.createHighlightBorder(a,I,p,c,!0)}}else this.createHighlightBorder(a,m,p,c,!1)}else this.createHighlightBorder(a,m,p,c,!1);var g=a.paragraph.childWidgets.indexOf(a);if(this.highlightParagraph(e,g+1,l,s,n),-1!==e.childWidgets.indexOf(i.currentWidget))return}if(this.isHideSelection(e))return void(this.isHighlightNext=!1);this.isHighlightNext=!0,this.hightLightNextParagraph=e}else{var f=this.getLeftInternal(l,s,n),m=0,y=!1;if(s instanceof we&&(y=s.isRightToLeft),!y&&o instanceof we&&(y=o.isRightToLeft),m=Math.abs(f-p),y||e.bidi){var v=this.getElementsForward(a,o,s,e.bidi);if(v&&v.length>1)for(var b=0;b<v.length;b++){var w,x=!1,M=(w=v[b])instanceof we?w.length:1;if(w===o?(p=this.getLeftInternal(a,w,r),f=this.getLeftInternal(a,w,M)):w===s?(p=this.getLeftInternal(a,w,0),f=this.getLeftInternal(a,w,n)):(p=this.getLeftInternal(a,w,0),f=this.getLeftInternal(a,w,M)),w instanceof we&&(x=w.isRightToLeft),m=Math.abs(f-p),w===s&&w instanceof we&&n>w.length){var N=w.line.paragraph.characterFormat,I=this.documentHelper.textHelper.getParagraphMarkSize(N).Width;if(e.bidi&&!x){m-=I,this.createHighlightBorder(a,m,p,c,!0),p=this.getLineStartLeft(a)-I,this.createHighlightBorder(a,I,p,c,!0);continue}}this.createHighlightBorder(a,m,x?f:p,c,!0)}else if(s instanceof we&&n>s.length){var N=s.line.paragraph.characterFormat,I=this.documentHelper.textHelper.getParagraphMarkSize(N).Width;!e.bidi&&y?(f+=I,m-=I,this.createHighlightBorder(a,m,f,c,!0),f+=s.width,this.createHighlightBorder(a,I,f,c,!0)):e.bidi&&!y?(m-=I,this.createHighlightBorder(a,m,p,c,!0),p=this.getLineStartLeft(a)-I,this.createHighlightBorder(a,I,p,c,!0)):this.createHighlightBorder(a,m,y?f:p,c,!1)}else this.createHighlightBorder(a,m,y?f:p,c,!1)}else this.createHighlightBorder(a,m,e.bidi?f:p,c,!1)}},t.prototype.highlightNextBlock=function(e,t,i){var r=e.nextRenderedWidget;sf.base.isNullOrUndefined(r)||(r instanceof le?(this.isHighlightNext=!1,this.highlight(r,t,i),this.isHighlightNext&&(this.highlightNextBlock(this.hightLightNextParagraph,t,i),this.isHighlightNext=!1,this.hightLightNextParagraph=void 0)):this.highlightTable(r,t,i))},t.prototype.getStartLineWidget=function(e,t,i,r){var n=e===t.paragraph?t.offset:this.getStartOffset(e),o=void 0;if(i=(o=e===t.paragraph?t.currentWidget.getInline(n,r):e.firstChild.getInline(n,r)).element,r=o.index,i instanceof fe){var s=this.getRenderedInline(i,r);i=s.element,r=s.index}return n===this.getParagraphLength(t.paragraph)+1&&r++,{index:r,element:i}},t.prototype.getEndLineWidget=function(e,t,i){var r=e.currentWidget.getInline(e.offset,i);if(t=r.element,i=r.index,t instanceof fe){var n=this.getRenderedInline(t,i);t=n.element,i=n.index}return e.paragraph.childWidgets.indexOf(e.currentWidget)===e.paragraph.childWidgets.length-1&&e.offset===this.getLineLength(e.currentWidget)+1&&(i=t?t.length+1:1),{index:i,element:t}},t.prototype.getLineWidgetInternal=function(e,t,i){var r=void 0;if(0===e.children.length&&e instanceof ue)r=e;else{var n=0,o=e.getInline(t,n),s=o.element;n=o.index,r=s instanceof ge?s.line:this.getLineWidgetInternalInline(s,n,i)}return r},t.prototype.getLineWidgetParagraph=function(e,t){var i=void 0;if(0===t.children.length)i=t;else{var r=0,n=t.getInline(e,r),o=n.element;r=n.index,i=this.getLineWidget(o,r)}return i},t.prototype.highlightCells=function(e,t,i){var r=this.getCellLeft(t.ownerRow,t),n=r+t.cellFormat.cellWidth,o=this.getCellLeft(i.ownerRow,i),s=o+i.cellFormat.cellWidth;r>o&&(r=o),n<s&&(n=s),r>this.upDownSelectionLength&&(r=this.upDownSelectionLength),n<this.upDownSelectionLength&&(n=this.upDownSelectionLength);var a=e.getSplitWidgets(),l=a.indexOf(t.ownerRow.ownerTable),h=a.indexOf(i.ownerRow.ownerTable);if(l===h)for(var d=e.childWidgets.indexOf(i.ownerRow),c=e.childWidgets.indexOf(t.ownerRow);c<=d;c++)this.highlightRow(e.childWidgets[c],r,n);else{var p=0,u=0;for(c=l;c<=h;c++){e=a[c],p=c===l?e.childWidgets.indexOf(t.ownerRow):0,u=c===h?e.childWidgets.indexOf(i.ownerRow):e.childWidgets.length-1;for(var g=p;g<=u;g++)this.highlightRow(e.childWidgets[g],r,n)}}},t.prototype.highlightTable=function(e,t,i){this.highlightInternal(e.childWidgets[0],t,i),i.paragraph.isInsideTable&&e.contains(i.paragraph.associatedCell)||this.highlightNextBlock(e,t,i)},t.prototype.getCellLeft=function(e,t){var i=0;return i+=t.x-t.margin.left},t.prototype.getNextParagraphRow=function(e){if(!sf.base.isNullOrUndefined(e.nextRenderedWidget)){var t=e.nextRenderedWidget.childWidgets[0].childWidgets[0];return this.documentHelper.getFirstParagraphBlock(t)}return this.getNextParagraphBlock(e.ownerTable)},t.prototype.getPreviousParagraphRow=function(e){if(!sf.base.isNullOrUndefined(e.previousRenderedWidget)){var t=e.previousRenderedWidget.lastChild,i=t.lastChild?t.lastChild:t.previousSplitWidget.lastChild;return this.documentHelper.getLastParagraphBlock(i)}return this.getPreviousParagraphBlock(e.ownerTable)},t.prototype.containsRow=function(e,t){if(-1!==e.childWidgets.indexOf(t))return!0;for(;t.ownerTable.isInsideTable;){if(-1!==e.childWidgets.indexOf(t))return!0;t=t.ownerTable.associatedCell}return-1!==e.childWidgets.indexOf(t)},t.prototype.highlightRow=function(e,t,i){for(var r=0;r<e.childWidgets.length;r++){var n=this.getCellLeft(e,e.childWidgets[r]);x.round(t,2)<=x.round(n,2)&&x.round(n,2)<x.round(i,2)&&this.highlightCellWidget(e.childWidgets[r])}},t.prototype.highlightInternal=function(e,t,i){for(var r=0;r<e.childWidgets.length;r++)this.highlightCellWidget(e.childWidgets[r]);i.paragraph.isInsideTable&&this.containsRow(e,i.paragraph.associatedCell)||e.nextRenderedWidget instanceof ce&&this.highlightInternal(e.nextRenderedWidget,t,i)},t.prototype.getLastParagraph=function(e){for(;e.nextSplitWidget&&e.nextSplitWidget.childWidgets.length>0;)e=e.nextSplitWidget;var t;return t=e.childWidgets.length>0?e.lastChild:e.previousSplitWidget.lastChild,this.documentHelper.getLastParagraphBlock(t)},t.prototype.containsCell=function(e,t){if(e.equals(t))return!0;for(;t.ownerTable.isInsideTable;){if(e.equals(t.ownerTable.associatedCell))return!0;t=t.ownerTable.associatedCell}return!1},t.prototype.isCellSelected=function(e,t,i){var r=this.getLastParagraph(e);return r===i.paragraph&&i.offset===this.getParagraphLength(r)+1||!this.containsCell(e,t.paragraph.associatedCell)||!this.containsCell(e,i.paragraph.associatedCell)},t.prototype.getContainerCellOf=function(e,t){for(;e.ownerTable.isInsideTable;){if(e.ownerTable.contains(t))return e;e=e.ownerTable.associatedCell}return e},t.prototype.getSelectedCell=function(e,t){if(e.ownerTable.equals(t.ownerTable))return e;for(;e.ownerTable.isInsideTable;){if(e.ownerTable.associatedCell.equals(t))return e;e=e.ownerTable.associatedCell}return e},t.prototype.getSelectedCells=function(){for(var e=[],t=0;t<this.selectedWidgets.keys.length;t++){var i=this.selectedWidgets.keys[t];i instanceof pe&&e.push(i)}return e},t.prototype.getNextParagraphCell=function(e){if(e.nextRenderedWidget&&e.nextRenderedWidget instanceof pe){(e=e.nextRenderedWidget).getSplitWidgets()[0]instanceof pe&&(e=e.getSplitWidgets()[0]);var t=e.firstChild;return t?this.documentHelper.getFirstParagraphBlock(t):this.getNextParagraphCell(e)}return e.nextSplitWidget&&0===e.nextSplitWidget.childWidgets.length&&(e=e.getSplitWidgets().pop()),this.getNextParagraphRow(e.containerWidget)},t.prototype.getPreviousParagraphCell=function(e){if(!sf.base.isNullOrUndefined(e.previousRenderedWidget)&&e.previousRenderedWidget instanceof pe){var t=(e=e.previousRenderedWidget).lastChild;return this.documentHelper.getLastParagraphBlock(t)}return this.getPreviousParagraphRow(e.ownerRow)},t.prototype.getContainerCell=function(e){for(;!sf.base.isNullOrUndefined(e.ownerTable)&&e.ownerTable.isInsideTable;)e=e.ownerTable.associatedCell;return e},t.prototype.highlightCell=function(e,t,i,r){if(r.paragraph.isInsideTable){var n=this.getContainerCellOf(e,r.paragraph.associatedCell);if(n.ownerTable.contains(r.paragraph.associatedCell)){var o=this.getSelectedCell(e,n),s=this.getSelectedCell(r.paragraph.associatedCell,n);if(this.containsCell(n,r.paragraph.associatedCell))this.isCellSelected(n,i,r)?this.highlightCellWidget(n):o===n?(this.highlight(i.paragraph,i,r),this.isHighlightNext&&(this.highlightNextBlock(this.hightLightNextParagraph,i,r),this.isHighlightNext=!1,this.hightLightNextParagraph=void 0)):this.highlightContainer(o,i,r);else if(this.highlightCellWidget(n),n.ownerRow.equals(s.ownerRow))for(o=n;!sf.base.isNullOrUndefined(o.nextRenderedWidget)&&(o=o.nextRenderedWidget,this.highlightCellWidget(o),o!==s););else this.highlightCells(n.ownerTable,n,s)}else this.highlightContainer(n,i,r)}else{var a=this.getContainerCell(e);this.highlightContainer(a,i,r)}},t.prototype.highlightContainer=function(e,t,i){this.highlightInternal(e.containerWidget,t,i),this.highlightNextBlock(e.ownerTable.getSplitWidgets().pop(),t,i)},t.prototype.getPreviousValidElement=function(e){var t=void 0;if(this.documentHelper.isFormFillProtectedMode&&2===e.fieldType)return e;for(;e instanceof fe;)x.isLinkedFieldCharacter(e)&&(e instanceof fe&&0===e.fieldType?t=e:e instanceof fe&&1===e.fieldType?(t=e,sf.base.isNullOrUndefined(e.fieldSeparator)&&(t=e=e.fieldBegin)):t=e=e.fieldBegin),e=e.previousNode;return sf.base.isNullOrUndefined(t)?e:t},t.prototype.getNextValidElement=function(e){var t=void 0;if(e instanceof Ce&&1===e.bookmarkType)return e;for(;e instanceof fe;){if(0===e.fieldType&&!sf.base.isNullOrUndefined(e.fieldEnd))return sf.base.isNullOrUndefined(t)?e:t;1!==e.fieldType||sf.base.isNullOrUndefined(e.fieldBegin)||(t=e),e=e.nextNode}return sf.base.isNullOrUndefined(t)?e:t},t.prototype.validateTextPosition=function(e,t){if(e.length===t&&(e.nextNode instanceof fe||!(e instanceof Re)&&e.nextNode instanceof Ce)){var i=this.getNextValidElement(e.nextNode);(i instanceof fe&&1===i.fieldType||i instanceof Ce&&1===i.bookmarkType)&&(e=i,t=this.documentHelper.isFormFillProtectedMode?0:1)}else if(0===t&&e.previousNode instanceof fe){t=(e=this.getPreviousValidElement(e.previousNode))instanceof fe?0:e.length,e instanceof fe&&1===e.fieldType&&t++}return{element:e,index:t}},t.prototype.getPhysicalPositionInline=function(e,t,i){var r=void 0;r=this.getElementBox(e,t,i).element;var n=void 0;if(sf.base.isNullOrUndefined(r)||sf.base.isNullOrUndefined(r.line)){if(!(e instanceof fe&&1===e.fieldType))return e instanceof fe||e instanceof Ce||e instanceof nt?this.getFieldCharacterPosition(e):new M(0,0);r=e}var o,s=r.margin,a=0;if(r instanceof we&&"\v"===r.text&&sf.base.isNullOrUndefined(e.nextNode)?(n=this.getNextLineWidget(r.line.paragraph,r),t=0):n=r.line,a=this.getTop(n),r instanceof Re&&"Inline"===r.textWrappingStyle){var l=r.line.paragraph.characterFormat,h=this.getPreviousTextElement(e);if(sf.base.isNullOrUndefined(h)){var d=this.getNextTextElement(e);sf.base.isNullOrUndefined(d)||(l=d.characterFormat)}else l=h.characterFormat;var c=this.documentHelper.textHelper.getHeight(l);r.margin.top+r.height-c.BaselineOffset>0&&(a+=r.margin.top+r.height-c.BaselineOffset)}else r instanceof fe||(a+=s.top>0?s.top:0);return o=sf.base.isNullOrUndefined(r)||sf.base.isNullOrUndefined(n)?0:this.getLeftInternal(n,r,t),new M(o,a)},t.prototype.getFieldCharacterPosition=function(e){var t=this.getNextValidElementForField(e);if(sf.base.isNullOrUndefined(t)){var i=e.line.paragraph;return this.getEndPosition(i)}return this.getPhysicalPositionInline(t,0,!0)},t.prototype.getNextValidElementForField=function(e){if(e instanceof fe&&0===e.fieldType&&x.isLinkedFieldCharacter(e)){var t=e;e=sf.base.isNullOrUndefined(t.fieldSeparator)?t.fieldEnd:t.fieldSeparator}var i=void 0;return sf.base.isNullOrUndefined(e.nextNode)||(i=this.getNextValidElement(e.nextNode)),i},t.prototype.getEndPosition=function(e){var t=e.x,i=e.y,r=void 0;e.childWidgets.length>0&&(r=e.childWidgets[e.childWidgets.length-1],t+=this.getWidth(r,!1)),sf.base.isNullOrUndefined(r)||(i=this.getTop(r));var n=this.getParagraphMarkSize(e,0,0);return new M(t,i+n.topMargin)},t.prototype.getElementBox=function(e,t,i){var r=void 0;return e instanceof fe||e instanceof Ce||e instanceof nt||(r=e),{element:r,index:t}},t.prototype.getPreviousTextElement=function(e){return e.previousNode instanceof we?e.previousNode:sf.base.isNullOrUndefined(e.previousNode)?void 0:this.getPreviousTextElement(e.previousNode)},t.prototype.getNextTextElement=function(e){return e.nextNode instanceof we?e.nextNode:sf.base.isNullOrUndefined(e.nextNode)?void 0:this.getNextTextElement(e.nextNode)},t.prototype.getNextRenderedElementBox=function(e,t){if(e instanceof fe){if(0===(r=e).fieldType&&r===(e=this.getRenderedField(r)))return r;t=1}for(;!sf.base.isNullOrUndefined(e)&&t===e.length&&e.nextNode instanceof fe;){var i=this.getNextValidElement(e.nextNode);if(i instanceof fe&&0===i.fieldType){var r=i;if(e=this.getRenderedField(r),!sf.base.isNullOrUndefined(e)&&r===e)return r;t=1}else e=i}return e},t.prototype.getElementBoxInternal=function(e,t){return{element:e,index:t}},t.prototype.getLineWidget=function(e,t){return this.getLineWidgetInternalInline(e,t,!0)},t.prototype.getLineWidgetInternalInline=function(e,t,i){var r=this.getElementBox(e,t,i),n=r.element;if(t=r.index,!sf.base.isNullOrUndefined(n))return i&&n instanceof we&&"\v"===n.text&&1===t?this.getNextLineWidget(n.line.paragraph,n):n.line;var o=e,s=this.getNextValidElementForField(o);if(sf.base.isNullOrUndefined(s)){var a=void 0,l=o.line.paragraph;return l.childWidgets.length>0&&(a=l.childWidgets[l.childWidgets.length-1]),a}return this.getLineWidget(s,0)},t.prototype.getNextLineWidget=function(e,t){var i=void 0,r=e;if(r.childWidgets.length>0){var n=r.childWidgets.indexOf(t.line);n===r.childWidgets.length-1?(r=e,n=-1):n>r.childWidgets.length-1?(r=this.getNextParagraphBlock(e),n=-1):n<0&&(n=(r=e).childWidgets.indexOf(t.line)),i=r.childWidgets[n+1]}return i},t.prototype.getCaretHeight=function(e,t,i,r,n,o){var s=this.getElementBox(e,t,!1).element,a=e;if(sf.base.isNullOrUndefined(s))return a instanceof fe?this.getFieldCharacterHeight(a,i,r,n,o):{height:this.documentHelper.textHelper.getHeight(i).Height,topMargin:n,isItalic:o};var l=s.margin,h=s.height,d=0;if(s instanceof Re){var c=this.getPreviousTextElement(e),p=this.getNextTextElement(e);if(sf.base.isNullOrUndefined(c)&&sf.base.isNullOrUndefined(p)){var u=0,g=0,f=e.line.paragraph,m=this.getParagraphMarkSize(f,u,g);u=m.topMargin,g=m.bottomMargin,d=m.height,o=f.characterFormat.italic,r||(d+=this.documentHelper.layout.getAfterSpacing(f))}else{if(sf.base.isNullOrUndefined(c))return o=p.characterFormat.italic,this.getCaretHeight(p,0,p.characterFormat,r,n,o);if(sf.base.isNullOrUndefined(p)||!(s instanceof Re))return o=c.characterFormat.italic,this.getCaretHeight(c,c.length,c.characterFormat,r,n,o);var y=this.documentHelper.textHelper.getHeight(s.characterFormat),v=y.Height,b=y.BaselineOffset;d=s.margin.top<0&&b>s.margin.top+s.height?s.margin.top+s.height+v-b:v,r||(d+=s.margin.bottom)}}else{var w=i.baselineAlignment,x=h;"Normal"!==w&&r&&(x/=1.5,"Subscript"===w&&(n=h-x)),d=(l.top<0?l.top:0)+x,r||(d+=l.bottom)}if(!r)return{height:d,topMargin:n,isItalic:o};var M=this.documentHelper.textHelper.getHeight(i).Height;return M>d&&(M=d),{height:M,topMargin:n,isItalic:o}},t.prototype.getFieldCharacterHeight=function(e,t,i,r,n){var o=this.getNextValidElementForField(e);if(sf.base.isNullOrUndefined(o)){var s=e.line.paragraph,a=this.documentHelper.textHelper.getParagraphMarkSize(t).Height,l=0,h=0,d=this.getParagraphMarkSize(s,l,h),c=d.height;return l=d.topMargin,h=d.bottomMargin,i?(a>c&&(a=c),{height:a,topMargin:r,isItalic:n}):{height:c+=h,topMargin:r,isItalic:n}}return this.getCaretHeight(o,0,t,i,r,n)},t.prototype.getRenderedInline=function(e,t){if(this.documentHelper.isFormFillProtectedMode&&2===e.fieldType)return{element:e,index:t};for(var i=this.getPreviousValidElement(e);i instanceof fe;)(i=this.getPreviousTextElement(i))instanceof fe&&(i=i.previousNode);if(!sf.base.isNullOrUndefined(i))return{element:i,index:t=i.length};t=0;var r=this.getNextRenderedElementBox(e,0);if(r instanceof fe&&0===r.fieldType)for(r=(r=r.fieldSeparator).nextNode;r instanceof fe;)r instanceof fe&&0===r.fieldType&&x.isLinkedFieldCharacter(r)&&(r=sf.base.isNullOrUndefined(r.fieldSeparator)?r.fieldEnd:r.fieldSeparator),r=r.nextNode;return{element:r,index:t}},t.prototype.getRenderedField=function(e){var t=e;if(sf.base.isNullOrUndefined(e.fieldSeparator))t=e.fieldEnd;else{var i=(t=e.fieldSeparator).line.paragraph;if(i!==e.fieldEnd.line.paragraph||this.hasValidInline(i,t,e.fieldEnd))return t;t=e.fieldEnd}return t},t.prototype.isLastRenderedInline=function(e,t){for(;t===e.length&&e.nextNode instanceof fe;){var i=this.getNextValidElement(e.nextNode);if(t=0,i instanceof fe&&0===i.fieldType&&(e=i),e instanceof fe&&0===e.fieldType&&!sf.base.isNullOrUndefined(e.fieldEnd)){var r=e;if(sf.base.isNullOrUndefined(r.fieldSeparator))e=r.fieldEnd,t=1;else{var n=(e=r.fieldSeparator).line.paragraph;if(t=1,n!==r.fieldEnd.line.paragraph||this.hasValidInline(n,e,r.fieldEnd))break;e=r.fieldEnd}}}return t===e.length&&sf.base.isNullOrUndefined(e.nextNode)},t.prototype.getPage=function(e){var t=void 0;if(e.containerWidget instanceof ze){var i=e.containerWidget.containerShape;i.line&&(t=this.getPage(i.line.paragraph))}else if(e.containerWidget instanceof re){e.containerWidget;t=e.containerWidget.page}else sf.base.isNullOrUndefined(e.containerWidget)||(t=this.getPage(e.containerWidget));return t},t.prototype.clearSelectionHighlightInSelectedWidgets=function(){for(var e=!1,t=this.selectedWidgets.keys,i=0;i<t.length;i++)this.removeSelectionHighlight(t[i]),e=!0;return this.selectedWidgets.clear(),e},t.prototype.clearChildSelectionHighlight=function(e){for(var t=0;t<e.childWidgets.length;t++)e.childWidgets[t]instanceof ue?this.clearSelectionHighlightLineWidget(e.childWidgets[t]):e.childWidgets[t]instanceof pe?this.clearSelectionHighlight(e.childWidgets[t]):e.childWidgets[t]instanceof ie&&this.clearChildSelectionHighlight(e.childWidgets[t])},t.prototype.getLineWidgetBodyWidget=function(e,t,i){i=!!sf.base.isNullOrUndefined(i)||i;var r=e;if(r instanceof re)for(var n=0;n<r.floatingElements.length;n++){var o=r.floatingElements[n];if(o instanceof de){var s=o.getTableCellWidth();if(t.x<=o.x+s&&t.x>=o.x&&t.y<=o.y+o.height&&t.y>=o.y)return this.getLineWidgetTableWidget(o,t)}}if(e instanceof ae)for(var a=0;a<e.bodyWidgets.length;a++)for(var l=0;l<e.bodyWidgets[a].childWidgets.length;l++){if((d=e.bodyWidgets[a].childWidgets[l])instanceof ie&&d.y<=t.y&&d.y+d.height>=t.y)return d instanceof le?this.getLineWidgetParaWidget(d,t):this.getLineWidgetTableWidget(d,t)}for(var h=0;h<e.childWidgets.length;h++){if((g=e.childWidgets[h])instanceof ae)for(a=0;a<g.bodyWidgets.length;a++){var d;if((d=g.bodyWidgets[a].childWidgets[0])instanceof ie&&d.y<=t.y&&d.y+d.height>=t.y)return d instanceof le?this.getLineWidgetParaWidget(d,t):this.getLineWidgetTableWidget(d,t)}else if(g instanceof ie&&g.y<=t.y&&g.y+g.height>=t.y){if(g instanceof le)return this.getLineWidgetParaWidget(g,t);var c=g;if(c.wrapTextAround)continue;return this.getLineWidgetTableWidget(c,t)}}var p=void 0;if(i&&e.childWidgets.length>0){var u=e.childWidgets[0];if(u instanceof ie&&u.y<=t.y)if(e.childWidgets[e.childWidgets.length-1]instanceof le)for(h=0;h<e.childWidgets.length;h++)p=this.getLineWidgetParaWidget(e.childWidgets[h],t);else for(h=0;h<e.childWidgets.length;h++)p=this.getLineWidgetTableWidget(e.childWidgets[h],t);else{var g=void 0;u instanceof ie&&(g=u),sf.base.isNullOrUndefined(g)||(p=g instanceof le?this.getLineWidgetParaWidget(u,t):this.getLineWidgetTableWidget(u,t))}}return p},t.prototype.getLineWidgetParaWidget=function(e,t){for(var i=e.childWidgets,r=e.y,n=0;n<i.length;n++){var o=i[n];r+=o.marginTop;var s=o.height;if(o.nextLine&&o.nextLine.marginTop>0&&(s+=o.nextLine.marginTop),r<=t.y&&r+s>=t.y)return o;r+=o.height}var a=void 0;if(e.bodyWidget.page.bodyWidgets.length>1&&e.bodyWidget.sectionFormat.columns.length>1){for(var l=void 0,h=void 0,d=0;d<e.childWidgets.length;d++)l=e.childWidgets[d];var c=l.paragraph.nextRenderedWidget;if(l.isLastLine()&&sf.base.isNullOrUndefined(c)&&e.y<t.y){var p=e.bodyWidget.previousRenderedWidget;if(!sf.base.isNullOrUndefined(p)){for(n=0;n<p.childWidgets.length;n++)if((h=p.childWidgets[n]).y<=t.y&&h.y>e.y)for(var u=0;u<h.childWidgets.length;u++){var g=h.childWidgets[u];t.x=p.x+g.paragraph.width,a=this.viewer.documentHelper.getLineWidget(t)}sf.base.isNullOrUndefined(a)&&p.index>0&&(a=this.viewer.documentHelper.getLineWidget(t))}}else a=e.y==t.y?this.viewer.documentHelper.getLineWidget(t):i[0]}else i.length>0&&(a=e.y<=t.y?i[i.length-1]:i[0]);return a},t.prototype.highlightParagraph=function(e,t,i,r,n){var o=0,s=0,a=!1;e.paragraphFormat.bidi&&i.children.indexOf(r)>0&&(r=i.children[0]);for(var l=t;l<e.childWidgets.length;l++){var h=e.childWidgets[l];l===t?o=this.getTop(h):o+=h.marginTop,r instanceof we&&(a=r.isRightToLeft);var d=this.getLeft(h);if(h===i){var c=0;if(a||e.bidi){for(var p=this.getElementsBackward(h,r,r,e.bidi),u=0;u<p.length;u++){var g=p[u],f=!1;if(g===r)c=this.getLeftInternal(h,g,n);else{var m=g instanceof we?g.length:1;c=this.getLeftInternal(h,g,m)}if(d=this.getLeftInternal(h,g,0),g instanceof we&&(f=g.isRightToLeft),s=Math.abs(c-d),g===r&&g instanceof we&&n>g.length){var y=this.documentHelper.textHelper.getParagraphMarkSize(g.line.paragraph.characterFormat).Width;if(!e.bidi&&f)c+=y;else if(e.bidi&&!f){s-=y,this.createHighlightBorder(h,s,d,o,!0),d=this.getLineStartLeft(h)-y,this.createHighlightBorder(h,y,d,o,!0);continue}}this.createHighlightBorder(h,s,f?c:d,o,!0)}return}return c=this.getLeftInternal(i,r,n),s=Math.abs(c-d),void this.createHighlightBorder(h,s,a?c:d,o,!1)}s=this.getWidth(h,!0)-(d-e.x),e.bidi&&h.isLastLine()&&(d-=this.documentHelper.textHelper.getParagraphMarkSize(e.characterFormat).Width),this.createHighlightBorder(h,s,d,o,!1),o+=h.height}},t.prototype.getLineWidgetTableWidget=function(e,t){for(var i=void 0,r=0;r<e.childWidgets.length;r++){var n=e.childWidgets[r];if(n instanceof ce&&n.y<=t.y){if("Exactly"===n.rowFormat.heightType&&n.y+x.convertPointToPixel(n.rowFormat.height)<t.y)continue;i=this.getLineWidgetRowWidget(n,t);var o=void 0;!sf.base.isNullOrUndefined(i)&&i.paragraph.containerWidget instanceof pe&&(o=i.paragraph.containerWidget);var s=0,a=0;if(!sf.base.isNullOrUndefined(o)){var l=o.ownerRow.containerWidget;s=x.convertPointToPixel(l.tableFormat.cellSpacing),a=o.cellFormat.rowSpan}var h=0,d=0,c=0,p=0;if(s>0){h=0===o.cellIndex?s:s/2,d=o.cellIndex===o.ownerRow.childWidgets.length-1?s:s/2;var u=void 0;o.containerWidget instanceof ce&&(u=o.containerWidget);l=void 0;o.containerWidget.containerWidget instanceof de&&(l=o.containerWidget.containerWidget),sf.base.isNullOrUndefined(u)||sf.base.isNullOrUndefined(l)||(c=0===o.ownerRow.rowIndex?s:s/2,p=o.ownerRow.rowIndex+a===o.ownerTable.childWidgets.length?s:s/2)}if(!sf.base.isNullOrUndefined(i)&&i.paragraph.x<=t.x&&i.paragraph.x+i.width>=t.x&&i.paragraph.y<=t.y&&this.getTop(i)+i.height>=t.y||!sf.base.isNullOrUndefined(o)&&o.x-o.margin.left-h<=t.x&&o.x+o.width+o.margin.right+d>=t.x&&o.y-o.margin.top-c<=t.y&&o.y+o.height+o.margin.bottom+p>=t.y)break}}return i},t.prototype.getLineWidgetRowWidget=function(e,t){for(var i=0;i<e.childWidgets.length;i++){var r,n=0,o=0;if((r=x.convertPointToPixel(e.ownerTable.tableFormat.cellSpacing))>0&&(n=0===e.childWidgets[i].columnIndex?r:r/2,o=e.childWidgets[i].cellIndex===e.childWidgets[i].ownerRow.childWidgets.length-1?r:r/2),e.childWidgets[i].x-e.childWidgets[i].margin.left-n<=t.x&&e.childWidgets[i].x+e.childWidgets[i].width+e.childWidgets[i].margin.right+o>=t.x)return this.getLineWidgetCellWidget(e.childWidgets[i],t)}var s=void 0;return e.childWidgets.length>0&&(s=e.childWidgets[0].x<=t.x?this.getLineWidgetCellWidget(e.childWidgets[e.childWidgets.length-1],t):this.getLineWidgetCellWidget(e.childWidgets[0],t)),s},t.prototype.getFirstBlock=function(e){if(e.childWidgets.length>0)return e.childWidgets[0]},t.prototype.highlightCellWidget=function(e){var t=[];e.previousSplitWidget||e.nextSplitWidget?t=e.getSplitWidgets():t.push(e);for(var i=0;i<t.length;i++)e=t[i],this.clearChildSelectionHighlight(e),this.createHighlightBorderInsideTable(e)},t.prototype.clearSelectionHighlight=function(e){this.selectedWidgets.containsKey(e)&&(this.removeSelectionHighlight(e),this.selectedWidgets.remove(e))},t.prototype.getLineWidgetCellWidget=function(e,t){for(var i=0;i<e.childWidgets.length;i++)if(e.childWidgets[i].y<=t.y&&e.childWidgets[i].y+e.childWidgets[i].height>=t.y)return e.childWidgets[i]instanceof le?this.getLineWidgetParaWidget(e.childWidgets[i],t):this.getLineWidgetTableWidget(e.childWidgets[i],t);var r=void 0;return e.childWidgets.length>0&&e.childWidgets[0].y<=t.y&&(r=e.childWidgets[e.childWidgets.length-1]instanceof le?this.getLineWidgetParaWidget(e.childWidgets[e.childWidgets.length-1],t):this.getLineWidgetTableWidget(e.childWidgets[0],t)),r},t.prototype.updateTextPosition=function(e,t){var i=t,r=void 0,n=0,o=!1,s=this.updateTextPositionIn(e,r,n,t,!1);sf.base.isNullOrUndefined(s)||(r=s.element,n=s.index,i=s.caretPosition,o=s.isImageSelected,this.isImageSelected=o),o?(this.selectInternal(e,r,n,i),0===n?this.extendForward():this.extendBackward()):this.selectInternal(e,r,n,i)},t.prototype.updateTextPositionIn=function(e,t,i,r,n){var o=!1,s=this.getTop(e),a=e.paragraph.x,l=this.getFirstElement(e,a),h=l.element,d=!1,c=!1;a=l.left;var p=e.renderedElements;if(sf.base.isNullOrUndefined(h)){var u=0,g=0,f=this.getParagraphMarkSize(e.paragraph,u,g);u=f.topMargin,g=f.bottomMargin,(!(this.documentHelper.mouseDownOffset.y>=s&&this.documentHelper.mouseDownOffset.y<s+e.height)||this.documentHelper.mouseDownOffset.x<a+f.width)&&n&&r.x>a+f.width/2&&(a+=f.width,p.length>0&&(i=(t=p[p.length-1]).length),i++),r=new M(a,u>0?s+u:s)}else if(!sf.base.isNullOrUndefined(h)){if(r.x>a+h.margin.left||h instanceof De&&"Inline"!==h.textWrappingStyle){var m=!1;e.paragraph.floatingElements.length>0&&(m=this.documentHelper.checkPointIsInLine(e,r));for(var y=p.indexOf(h);y<p.length;y++)if((h=p[y])instanceof De&&"Inline"!==h.textWrappingStyle){if(this.documentHelper.isInShapeBorder(h,r)&&!this.documentHelper.isSelectionChangedOnMouseMoved&&!m){a=h.x,s=h.y;break}}else{var v=!1;if((h instanceof je||h instanceof we)&&(v=h.line.paragraph.paragraphFormat.bidi),r.x<a+h.margin.left+h.width+h.padding.left||y===p.length-1||p[y+1]instanceof je&&v)break;a+=h.margin.left+h.width+h.padding.left}if(h instanceof we&&(d=h.isRightToLeft,c=h.line.paragraph.paragraphFormat.bidi),r.x>a+h.margin.left+h.width+h.padding.left)i=h instanceof we?h.length:1,d&&c&&(i=0),(h instanceof we&&"\v"!==h.text&&"\f"!==h.text&&h.text!==String.fromCharCode(14)||n)&&(a+=h.margin.left+h.width+h.padding.left);else if(h instanceof we){h instanceof we&&d&&(a+=h.width+h.padding.left);var b=0;b=d?a+h.margin.left-r.x:r.x-a-h.margin.left-h.padding.left,a+=h.margin.left+h.padding.left;var w=0,x=0;for(y=1;y<=h.length;y++){var N=0;if(y===h.length?N=h.width+h.padding.left:(N=this.documentHelper.textHelper.getWidth(h.text.substr(0,y),h.characterFormat,h.scriptType),h.trimEndWidth=N),b<N||y===h.length){if(b-w>(N-w)/2)d?a-=N:a+=N,x=y;else if(d?a-=w:a+=w,x=y-1,1===y&&h!==p[0]&&!(p[0]instanceof De&&"Inline"!==p[0].textWrappingStyle)){var I=p.indexOf(h);p[I-1]instanceof je||d||(x=(h=p[I-1])instanceof we?h.length:1)}break}w=N}i=x}else if(o=h instanceof Re||h instanceof Ee,r.x-a-h.margin.left>h.width/2)i=1,a+=h.margin.left+h.width+h.padding.left;else if(h!==p[0]&&!o){I=p.indexOf(h);p[I-1]instanceof je||(i=(h=p[I-1])instanceof we?h.length:1)}h instanceof we&&("\v"===h.text||"\f"===h.text||h.text===String.fromCharCode(14))&&(i=0)}else d=h.isRightToLeft,c=h.line.paragraph.paragraphFormat.bidi,i=h instanceof we&&(c||d)&&r.x<a+h.margin.left+h.width+h.padding.left?this.getTextLength(h.line,h)+h.length:this.getTextLength(h.line,h),a+=h.margin.left;if(h instanceof we)s+=h.margin.top>0?h.margin.top:0;else{var S=this.documentHelper.textHelper.getHeight(h.characterFormat),C=h.height;h instanceof Ce&&!this.documentHelper.layout.hasValidElement(h.line.paragraph)&&(C=S.Height),s+=h.margin.top+C-S.BaselineOffset}(t=h)instanceof fe&&2===t.fieldType&&!sf.base.isNullOrUndefined(t.fieldBegin)&&(t=t.fieldBegin,i=0),t instanceof Ue&&(i=0);var O=this.validateTextPosition(t,i);t=O.element,i=O.index;var T=sf.base.isNullOrUndefined(t.nextNode)&&i===t.length,P=t.line.isEndsWithLineBreak&&t instanceof we&&"\v"===t.text;if(n&&t.nextNode instanceof fe&&i===t.length&&(T=this.isLastRenderedInline(t,i)),n&&T||P){N=0;if(T)N=this.documentHelper.textHelper.getParagraphMarkWidth(e.paragraph.characterFormat),(!(this.documentHelper.mouseDownOffset.y>=s&&this.documentHelper.mouseDownOffset.y<s+e.height)||this.documentHelper.mouseDownOffset.x<a+N)&&r.x>a+N/2&&(a+=N,i=t.length+1);else P&&(a+=N=h.width+h.padding.left)}r=new M(a,s)}return{element:t,index:i,caretPosition:r,isImageSelected:o}},t.prototype.checkAllFloatingElements=function(e,t){var i,r,n=!1,o=!1;if(!sf.base.isNullOrUndefined(e)){i=e.paragraph.bodyWidget,n=!1,o=!1;for(var s=0;s<i.floatingElements.length;s++)if(!(i.floatingElements[s]instanceof de)&&(r=i.floatingElements[s],t.x<r.x+r.margin.left+r.width&&t.x>r.x&&t.y<r.y+r.margin.top+r.height&&t.y>r.y)){n=!0,this.documentHelper.isInShapeBorder(r,t)&&(o=!0);break}}return{element:r,caretPosition:t,isShapeSelected:n,isInShapeBorder:o}},t.prototype.getTextLength=function(e,t){var i=0,r=e.renderedElements,n=r.indexOf(t);r.length>0&&r[0]instanceof je&&(r[1]instanceof je?n-=2:n-=1);for(var o=1;o<n;o++)i+=r[o].length;return i},t.prototype.getLeft=function(e){var t=e.paragraph.x,i=e.paragraph.paragraphFormat;this.isParagraphFirstLine(e)&&!i.bidi&&"Right"!==i.textAlignment&&(t+=x.convertPointToPixel(i.firstLineIndent));for(var r=e.renderedElements,n=0;n<r.length;n++){var o=r[n];if(!(o instanceof je)||i.bidi){t+=o.margin.left;break}t+=0===n?o.margin.left+o.width:o.width}return t},t.prototype.getTop=function(e){for(var t=e.paragraph.y,i=e.paragraph.childWidgets.indexOf(e),r=0;r<i;r++){var n=e.paragraph.childWidgets[r];t=t+n.height+n.marginTop}return t+=e.marginTop},t.prototype.getFirstElement=function(e,t){var i=0;this.isParagraphFirstLine(e)&&!e.paragraph.paragraphFormat.bidi&&(i=x.convertPointToPixel(e.paragraph.paragraphFormat.firstLineIndent)),t+=i;for(var r=void 0,n=e.renderedElements,o=0;o<n.length&&((r=n[o])instanceof je||r instanceof nt);o++){if(e.paragraph.paragraphFormat.bidi){t+=r.margin.left,r=void 0;break}t+=r.margin.left+r.width,r=void 0}return{element:r,left:t}},t.prototype.getIndexInInline=function(e){var t=0;if(e instanceof we)for(var i=e.line.children.indexOf(e),r=0;r<i;r++){var n=e.line.children[r];n instanceof fe||n instanceof je||(t+=n.length)}return t},t.prototype.isParagraphFirstLine=function(e){return!(!sf.base.isNullOrUndefined(e.paragraph.previousSplitWidget)||e!==e.paragraph.firstChild)},t.prototype.isParagraphLastLine=function(e){return!(!sf.base.isNullOrUndefined(e.paragraph.nextSplitWidget)||e!==e.paragraph.lastChild)},t.prototype.getWidth=function(e,t){var i=0,r=e.paragraph.paragraphFormat;this.isParagraphFirstLine(e)&&!r.bidi&&(i+=x.convertPointToPixel(r.firstLineIndent));for(var n=0;n<e.children.length;n++){var o=e.children[n];o instanceof De&&"Inline"!==o.textWrappingStyle||(i+=o.margin.left+o.width+o.padding.left)}return t&&e.paragraph.childWidgets.indexOf(e)===e.paragraph.childWidgets.length-1&&sf.base.isNullOrUndefined(e.paragraph.nextSplitWidget)&&(i+=this.documentHelper.textHelper.getParagraphMarkWidth(e.paragraph.characterFormat)),i},t.prototype.getLeftInternal=function(t,i,r){var n=t.paragraph.x,o=t.paragraph.paragraphFormat;this.isParagraphFirstLine(t)&&!o.bidi&&(n+=x.convertPointToPixel(t.paragraph.paragraphFormat.firstLineIndent));var s=t.renderedElements,a=s.indexOf(i);(1===s.length&&s[0]instanceof je||2===s.length&&s[0]instanceof je&&s[1]instanceof je)&&(a=s.length);for(var l=!1,h=0;h<a;h++){var d=s[h];d instanceof fe&&2===d.fieldType&&(l=!1),l||(d instanceof De&&"Inline"!==d.textWrappingStyle||(n+=1===h&&d instanceof je?d.width:d instanceof Se&&i===d?d.margin.left:d.margin.left+d.width+d.padding.left,d instanceof fe&&0===d.fieldType&&(l=!0)))}var c=!1,p=t.paragraph.bidi;sf.base.isNullOrUndefined(i)||(c=(i.characterRange&e.RightToLeft)===e.RightToLeft,p=i.line.paragraph.paragraphFormat.bidi,n+=i.margin.left+i.padding.left,i instanceof De&&!sf.base.isNullOrUndefined(i.nextElement)&&(n+=i.nextElement.margin.left+i.nextElement.padding.left),(c||1===this.documentHelper.moveCaretPosition&&!c&&p)&&(n+=i.width));var u=0;if(i instanceof we){if(0!==this.documentHelper.moveCaretPosition&&(p||c))return(c&&p&&2===this.documentHelper.moveCaretPosition||c&&!p&&1===this.documentHelper.moveCaretPosition)&&(n-=i.width),this.documentHelper.moveCaretPosition=0,n;r!==i.length||c?r>i.length?(u=this.documentHelper.textHelper.getParagraphMarkWidth(i.line.paragraph.characterFormat),c?n-=i.width+u:n+=i.width+u):(u=this.documentHelper.textHelper.getWidth(i.text.substr(0,r),i.characterFormat,i.scriptType),i.trimEndWidth=u,c?n-=u:n+=u):n+=i.width,this.documentHelper.moveCaretPosition=0}else if(r>0)if(sf.base.isNullOrUndefined(i)||i instanceof je)n+=this.documentHelper.textHelper.getParagraphMarkWidth(t.paragraph.characterFormat);else if(i instanceof De&&"Inline"!==i.textWrappingStyle||(n+=i.width),2===r){var g=i.line.paragraph;n+=this.documentHelper.textHelper.getParagraphMarkWidth(g.characterFormat)}return n},t.prototype.getLineStartLeft=function(e){var t=e.paragraph.x,i=e.paragraph.paragraphFormat;return this.isParagraphFirstLine(e)&&!i.bidi&&(t+=x.convertPointToPixel(i.firstLineIndent)),e.children.length>0&&(t+=e.children[0].margin.left),t},t.prototype.updateTextPositionWidget=function(e,t,i,r){var n,o=t,s=void 0,a=0;s=(n=this.updateTextPositionIn(e,s,a,o,r)).element,a=n.index,o=n.caretPosition,i.setPositionForSelection(e,s,a,o)},t.prototype.clearSelectionHighlightLineWidget=function(e){!sf.base.isNullOrUndefined(this.owner)&&this.selectedWidgets.length>0&&this.clearSelectionHighlight(this)},t.prototype.getFirstElementInternal=function(e){for(var t=void 0,i=e.children.length,r=0;r<i&&(t=e.children[r])instanceof je;r++)t=void 0;return t},t.prototype.selectRange=function(e,t,i){this.start.setPositionInternal(e),this.end.setPositionInternal(t),this.upDownSelectionLength=this.end.location.x,this.fireSelectionChanged(!0,!0,i)},t.prototype.selectParagraphInternal=function(e,t){var i;if(!sf.base.isNullOrUndefined(e)&&!sf.base.isNullOrUndefined(e.firstChild))if(i=e.firstChild,t)this.start.setPosition(i,t);else{var r=i.getEndOffset();this.start.setPositionParagraph(i,r)}this.end.setPositionInternal(this.start),this.upDownSelectionLength=this.start.location.x,this.fireSelectionChanged(!0)},t.prototype.setPositionForBlock=function(e,t){var i;if(e instanceof de&&(e=t?this.documentHelper.getFirstParagraphInFirstCell(e):this.documentHelper.getLastParagraphInLastCell(e)),e instanceof le)if(i=new Ft(this.owner),t)i.setPosition(e.firstChild,!0);else{var r=e.lastChild;i.setPositionParagraph(r,r.getEndOffset())}return i},t.prototype.selectContent=function(e,t){if(sf.base.isNullOrUndefined(e))throw new Error("textPosition is undefined.");this.start.setPositionInternal(e),this.end.setPositionInternal(e),this.upDownSelectionLength=this.end.location.x,this.fireSelectionChanged(!0)},t.prototype.selectInternal=function(e,t,i,r){this.start.setPositionForSelection(e,t,i,r),this.end.setPositionInternal(this.start),this.upDownSelectionLength=r.x,this.fireSelectionChanged(!0)},t.prototype.selects=function(e,t,i){this.documentHelper.clearSelectionHighlight(),this.start.setPositionForLineWidget(e,t),this.end.setPositionInternal(this.start),i||this.fireSelectionChanged(!0)},t.prototype.selectPosition=function(e,t){if(sf.base.isNullOrUndefined(e)||sf.base.isNullOrUndefined(t))throw new Error("TextPosition cannot be undefined");if(sf.base.isNullOrUndefined(e.paragraph)||e.offset>this.getParagraphLength(e.paragraph)+1)throw new Error("Start TextPosition is not valid.");if(sf.base.isNullOrUndefined(t.paragraph)||t.offset>this.getParagraphLength(t.paragraph)+1)throw new Error("End TextPosition is not valid.");e.isAtSamePosition(t)?this.selectRange(e,e):(e.isExistBefore(t)?t.validateForwardFieldSelection(e.getHierarchicalIndexInternal(),t.getHierarchicalIndexInternal()):e.validateForwardFieldSelection(t.getHierarchicalIndexInternal(),e.getHierarchicalIndexInternal()),this.selectRange(e,t))},t.prototype.fireSelectionChanged=function(e,t,i){this.isEmpty||(this.isForward?(this.start.updatePhysicalPosition(!0),this.end.updatePhysicalPosition(!1)):(this.start.updatePhysicalPosition(!1),this.end.updatePhysicalPosition(!0))),this.isModifyingSelectionInternally||(this.skipFormatRetrieval||this.retrieveCurrentFormatProperties(),this.documentHelper.clearSelectionHighlight(),this.hideToolTip(),this.owner.isLayoutEnabled&&!this.owner.isShiftingEnabled&&this.highlightSelection(!0,i),e&&(this.start.paragraph.isInHeaderFooter&&!this.owner.enableHeaderAndFooter?this.owner.enableHeaderAndFooter=!0:!this.start.paragraph.isInHeaderFooter&&this.owner.enableHeaderAndFooter&&(this.owner.enableHeaderAndFooter=!1),this.owner.fireSelectionChange()),this.documentHelper.updateFocus(),this.documentHelper.isInlineFormFillProtectedMode&&e&&(this.triggerFormFillEvent(t),this.previousSelectedFormField=this.getCurrentFormField()))},t.prototype.retrieveCurrentFormatProperties=function(){this.isRetrieveFormatting=!0;var e=this.start,t=this.end;this.isForward||(e=this.end,t=this.start),this.retrieveImageFormat(e,t),this.retrieveCharacterFormat(e,t),this.retrieveParagraphFormat(e,t),this.retrieveSectionFormat(e,t),this.retrieveTableFormat(e,t),this.isRetrieveFormatting=!1,this.setCurrentContextType()},t.prototype.retrieveImageFormat=function(e,t){var i;if(e.currentWidget===t.currentWidget&&e.offset+1===t.offset){var r=t.currentWidget.getInline(t.offset,0);i=r.element;r.index;if(i instanceof Re)e.currentWidget.getOffset(i,0)!==e.offset&&(i=void 0)}i instanceof Re?this.imageFormat.copyImageFormat(i):this.imageFormat.clearImageFormat()},t.prototype.getPreviousContextType=function(e){var t=this.start;if(t.offset>0){var i=t.currentWidget.getInline(t.offset,0).element;return i=e?i.previousElement:t.currentWidget.getInline(t.offset-1,0).element,this.getContextElement(i)}},t.prototype.getNextContextType=function(e){var t=this.start,i=t.currentWidget.getInline(t.offset,0).element;return i=e&&i.nextElement?i.nextElement:t.currentWidget.getInline(t.offset+1,0).element,this.getContextElement(i)},t.prototype.getContextElement=function(e){return e instanceof we?"Text":e instanceof fe||e instanceof Ie?"Field":e instanceof Ce?"Bookmark":e instanceof Re?"Image":e instanceof Ee?"Shape":e instanceof ot||e instanceof nt?"Comment":e instanceof je?"List":e instanceof He||e instanceof Ue?"EditRange":void 0},t.prototype.setCurrentContextType=function(){var e=!!this.imageFormat.image,t=!sf.base.isNullOrUndefined(this.tableFormat)&&!sf.base.isNullOrUndefined(this.tableFormat.table),i=this.start.paragraph.paragraphFormat.baseStyle;if(i instanceof gt&&0===i.name.toLowerCase().indexOf("toc")){var r=this.getTocFieldInternal();if(!sf.base.isNullOrUndefined(r))return void(this.contextTypeInternal="TableOfContents")}var n=this.getCurrentRevision();if(n?(this.owner.showRevisions=!0,this.owner.dotNetRef.invokeMethodAsync("ShowRevisions",!0),this.owner.trackChangesPane.currentSelectedRevision=n[0]):sf.base.isNullOrUndefined(this.owner.trackChangesPane.currentSelectedRevision)||(this.owner.trackChangesPane.currentSelectedRevision=void 0),this.start.paragraph.isInHeaderFooter){var o=-1!==this.start.paragraph.bodyWidget.headerFooterType.indexOf("Header");this.contextTypeInternal=t?e?o?"HeaderTableImage":"FooterTableImage":o?"HeaderTableText":"FooterTableText":e?o?"HeaderImage":"FooterImage":o?"HeaderText":"FooterText"}else this.contextTypeInternal=t?e?"TableImage":"TableText":e?"Image":"Text"},t.prototype.addItemRevisions=function(e,t){for(var i=0;i<e.revisions.length;i++){var r=e.revisions[i];this.selectRevision(r),t?r.accept():r.reject()}},t.prototype.hasRevisions=function(){return!!this.getCurrentRevision()},t.prototype.getCurrentRevision=function(){var e=this.start,t=this.end;this.isForward||(e=this.end,t=this.start);var i,r=e.currentWidget.getInline(e.offset,0).element,n=e.paragraph,o=e.currentWidget.getInline(e.offset+1,0).element;if(r&&r===o){var s=r.line.getOffset(r,r.length);if((i=new Ft(this.owner)).setPositionParagraph(r.line,s),t.offset===i.offset&&!sf.base.isNullOrUndefined(r.nextElement))return}if(!sf.base.isNullOrUndefined(r)&&r.revisions.length>0)return r.revisions;if(n.isInsideTable){var a=n.associatedCell;if(!sf.base.isNullOrUndefined(a.ownerRow)&&a.ownerRow.rowFormat.revisions.length>0)return a.ownerRow.rowFormat.revisions}return t.offset>t.paragraph.getLength()&&t.paragraph.characterFormat.revisions.length>0?t.paragraph.characterFormat.revisions:void 0},t.prototype.processLineRevisions=function(e,t){for(var i=0;i<e.children.length;i++){var r=e.children[i];r.revisions.length>0&&this.addItemRevisions(r,t)}},t.prototype.handleAcceptReject=function(e){if(this.isEmpty){var t=this.start.currentWidget.getInline(this.start.offset+1,0).element,i=this.start.paragraph;if(!sf.base.isNullOrUndefined(t)&&t.revisions.length>0&&this.addItemRevisions(t,e),i.isInsideTable){var r=i.associatedCell;if(sf.base.isNullOrUndefined(r)){if(!i.isEmpty())for(var n=0;n<r.childWidgets.length;n++)for(var o=r.childWidgets[n],s=void 0;s<o.childWidgets.length;s++){var a=o.childWidgets[s];this.processLineRevisions(a,e)}}else r.ownerRow.rowFormat.revisions.length>0&&this.addItemRevisions(r.ownerRow.rowFormat,e)}}else{var l=this.getselectedRevisionElements();for(n=0;n<l.length;n++)this.acceptReject(l[n],e)}},t.prototype.acceptReject=function(e,t){this.selectRevision(e),t?e.accept():e.reject()},t.prototype.getselectedRevisionElements=function(){var e=[],t=this.start,i=this.end;this.isForward||(t=this.end,i=this.start);for(var r=0;r<this.selectedWidgets.length;r++){var n=this.selectedWidgets.keys[r];if(n instanceof ue)e=this.getSelectedLineRevisions(n,t,i,e);else if(n instanceof pe){n.ownerRow.rowFormat.revisions.length>0&&(e=this.addRevisionsCollec(n.ownerRow.rowFormat.revisions,e));for(var o=0;o<n.childWidgets.length;o++)for(var s=n.childWidgets[o],a=0;a<s.childWidgets.length;a++){var l=s.childWidgets[a];e=this.getSelectedLineRevisions(l,t,i,e)}}}return e},t.prototype.getSelectedLineRevisions=function(e,t,i,r){e.paragraph.characterFormat.revisions.length>0&&(r=this.addRevisionsCollec(e.paragraph.characterFormat.revisions,r));for(var n=0;n<e.children.length;n++){var o=e.children[n],s=o.line.getOffset(o,0),a=new Ft(this.owner);a.setPositionParagraph(o.line,s),s=o.line.getOffset(o,o.length);var l=new Ft(this.owner);l.setPositionParagraph(o.line,s),(l.isExistAfter(t)&&l.isExistBefore(i)||a.isExistAfter(t)&&a.isExistBefore(i)||a.isAtSamePosition(t)||t.isExistAfter(a)&&i.isExistBefore(l))&&o.revisions.length>0&&(r=this.addRevisionsCollec(o.revisions,r))}return r},t.prototype.addRevisionsCollec=function(e,t){for(var i=0;i<e.length;i++)-1===t.indexOf(e[i])&&t.push(e[i]);return t},t.prototype.retrieveTableFormat=function(e,t){var i=this.getTable(e,t);sf.base.isNullOrUndefined(i)?this.tableFormat.clearFormat():(this.tableFormat.copyFormat(i.tableFormat),this.tableFormat.table=i,this.retrieveCellFormat(e,t),this.retrieveRowFormat(e,t))},t.prototype.retrieveCellFormat=function(e,t){e.paragraph.isInsideTable&&t.paragraph.isInsideTable?(this.cellFormat.copyFormat(e.paragraph.associatedCell.cellFormat),this.getCellFormat(e.paragraph.associatedCell.ownerTable,e,t)):this.cellFormat.clearCellFormat()},t.prototype.retrieveRowFormat=function(e,t){e.paragraph.isInsideTable&&t.paragraph.isInsideTable?(this.rowFormat.copyFormat(e.paragraph.associatedCell.ownerRow.rowFormat),this.getRowFormat(e.paragraph.associatedCell.ownerTable,e,t)):this.rowFormat.clearRowFormat()},t.prototype.getCellFormat=function(e,t,i){if(!t.paragraph.associatedCell.equals(i.paragraph.associatedCell))for(var r=!1,n=0;n<e.childWidgets.length;n++){var o=e.childWidgets[n];if(o===t.paragraph.associatedCell.ownerRow&&(r=!0),r)for(var s=0;s<o.childWidgets.length;s++){var a=o.childWidgets[s];if(this.isCellSelected(a,t,i)&&this.cellFormat.combineFormat(a.cellFormat),a===i.paragraph.associatedCell)return void this.cellFormat.combineFormat(a.cellFormat)}}},t.prototype.getRowFormat=function(e,t,i){var r=t.paragraph.associatedCell.ownerRow;if(r!==i.paragraph.associatedCell.ownerRow)for(var n=e.childWidgets.indexOf(r)+1;n<e.childWidgets.length;n++){var o=e.childWidgets[n];if(this.rowFormat.combineFormat(o.rowFormat),o===i.paragraph.associatedCell.ownerRow)return}},t.prototype.getTable=function(e,t){if(!sf.base.isNullOrUndefined(e.paragraph.associatedCell)&&!sf.base.isNullOrUndefined(t.paragraph.associatedCell)){var i=e.paragraph.associatedCell.ownerTable,r=e.paragraph.associatedCell.ownerTable;if(i===r)return i;if(i.contains(e.paragraph.associatedCell))return i;if(r.contains(e.paragraph.associatedCell))return r;if(!i.isInsideTable||!r.isInsideTable)return;do{if((i=i.associatedCell.ownerTable)===r||i.contains(r.associatedCell))return i;if(r.contains(i.associatedCell))return r}while(!sf.base.isNullOrUndefined(i.associatedCell))}},t.prototype.getContainerWidget=function(e){var t;if(e.containerWidget instanceof ze)t=e.containerWidget.containerShape.line.paragraph.bodyWidget;else if(e.containerWidget instanceof re)t=!sf.base.isNullOrUndefined(e.containerWidget.containerWidget)&&e.containerWidget.containerWidget instanceof ae?e.containerWidget.containerWidget:e.containerWidget;else for(t=e.containerWidget;!(t instanceof re);)t instanceof ze&&(t=t.containerShape.line.paragraph),t=t.containerWidget;return t},t.prototype.retrieveSectionFormat=function(e,t){var i=this.getContainerWidget(e.paragraph),r=this.getContainerWidget(t.paragraph);if(!sf.base.isNullOrUndefined(i)){this.sectionFormat.copyFormat(i.sectionFormat);for(var n=this.documentHelper.pages.indexOf(i.page),o=this.documentHelper.pages.indexOf(r.page),s=n+1;s<=o;s++)this.sectionFormat.combineFormat(this.documentHelper.pages[s].bodyWidgets[0].sectionFormat)}},t.prototype.retrieveParagraphFormat=function(e,t){this.getParagraphFormatForSelection(e.paragraph,this,e,t)},t.prototype.getParagraphFormatForSelection=function(e,t,i,r){if(!i.paragraph.isInsideTable||r.paragraph.isInsideTable&&i.paragraph.associatedCell===r.paragraph.associatedCell&&!this.isCellSelected(i.paragraph.associatedCell,i,r)){if(this.getParagraphFormatInternalInParagraph(e,i,r),r.paragraph===e)return;var n=this.getNextRenderedBlock(e);sf.base.isNullOrUndefined(n)||this.getParagraphFormatInternalInBlock(n,i,r)}else this.getParagraphFormatInternalInCell(i.paragraph.associatedCell,i,r)},t.prototype.getParagraphFormatInternalInParagraph=function(e,t,i){t.paragraph===e?this.paragraphFormat.copyFormat(e.paragraphFormat):this.paragraphFormat.combineFormat(e.paragraphFormat)},t.prototype.getParagraphFormatInternalInBlock=function(e,t,i){if(e instanceof le){if(this.getParagraphFormatInternalInParagraph(e,t,i),i.paragraph===e)return;var r=this.getNextRenderedBlock(e);sf.base.isNullOrUndefined(r)||this.getParagraphFormatInternalInBlock(r,t,i)}else this.getParagraphFormatInternalInTable(e,t,i)},t.prototype.getParagraphFormatInternalInTable=function(e,t,i){for(var r=0;r<e.childWidgets.length;r++){for(var n=e.childWidgets[r],o=0;o<n.childWidgets.length;o++)this.getParagraphFormatInCell(n.childWidgets[o]);if(i.paragraph.isInsideTable&&this.containsRow(n,i.paragraph.associatedCell))return}var s=this.getNextRenderedBlock(e);this.getParagraphFormatInternalInBlock(s,t,i)},t.prototype.getParagraphFormatInCell=function(e){for(var t=0;t<e.childWidgets.length;t++)this.getParagraphFormatInBlock(e.childWidgets[t])},t.prototype.getParagraphFormatInBlock=function(e){e instanceof le?this.getParagraphFormatInParagraph(e):this.getParagraphFormatInTable(e)},t.prototype.getParagraphFormatInTable=function(e){for(var t=0;t<e.childWidgets.length;t++)for(var i=e.childWidgets[t],r=0;r<i.childWidgets.length;r++)this.getParagraphFormatInCell(i.childWidgets[r])},t.prototype.getParagraphFormatInParagraph=function(e){this.start.paragraph===e?this.paragraphFormat.copyFormat(e.paragraphFormat):this.paragraphFormat.combineFormat(e.paragraphFormat)},t.prototype.getParagraphFormatInternalInCell=function(e,t,i){if(i.paragraph.isInsideTable){var r=this.getContainerCellOf(e,i.paragraph.associatedCell);if(r.ownerTable.contains(i.paragraph.associatedCell)){var n=this.getSelectedCell(e,r),o=this.getSelectedCell(i.paragraph.associatedCell,r);if(this.containsCell(r,i.paragraph.associatedCell))if(this.isCellSelected(r,t,i))this.getParagraphFormatInCell(r);else if(n===r){if(this.getParagraphFormatInternalInParagraph(t.paragraph,t,i),i.paragraph===t.paragraph)return;var s=this.getNextRenderedBlock(t.paragraph);sf.base.isNullOrUndefined(s)||this.getParagraphFormatInternalInBlock(s,t,i)}else this.getParagraphFormatInRow(n.ownerRow,t,i);else this.getParaFormatForCell(r.ownerTable,r,o)}else this.getParagraphFormatInRow(r.ownerRow,t,i)}else{var a=this.getContainerCell(e);this.getParagraphFormatInRow(a.ownerRow,t,i)}},t.prototype.getParaFormatForCell=function(e,t,i){var r=this.getCellLeft(t.ownerRow,t),n=r+t.cellFormat.cellWidth,o=this.getCellLeft(i.ownerRow,i),s=o+i.cellFormat.cellWidth;r>o&&(r=o),n<s&&(n=s),r>this.upDownSelectionLength&&(r=this.upDownSelectionLength),r<this.upDownSelectionLength&&(r=this.upDownSelectionLength);for(var a=e.childWidgets.indexOf(i.ownerRow),l=e.childWidgets.indexOf(t.ownerRow);l<=a;l++)for(var h=e.childWidgets[l],d=0;d<h.childWidgets.length;d++){var c=h.childWidgets[d],p=this.getCellLeft(h,c);x.round(r,2)<=x.round(p,2)&&x.round(p,2)<x.round(n,2)&&this.getParagraphFormatInCell(c)}},t.prototype.getParagraphFormatInRow=function(e,t,i){for(var r=e.rowIndex;r<e.ownerTable.childWidgets.length;r++){for(var n=e.ownerTable.childWidgets[r],o=0;o<n.childWidgets.length;o++)this.getParagraphFormatInCell(n.childWidgets[o]);if(i.paragraph.isInsideTable&&this.containsRow(n,i.paragraph.associatedCell))return}var s=this.getNextRenderedBlock(e.ownerTable);this.getParagraphFormatInternalInBlock(s,t,i)},t.prototype.retrieveCharacterFormat=function(e,t){if(this.characterFormat.copyFormat(e.paragraph.characterFormat),e.paragraph!==t.paragraph||!e.currentWidget.isLastLine()||e.offset!==this.getLineLength(e.currentWidget)||e.offset+1!==t.offset){var i=e.paragraph;if(e.paragraph===t.paragraph&&this.isSelectList){var r=this.getListLevel(e.paragraph);r&&r.characterFormat.uniqueCharacterFormat&&this.characterFormat.copyFormat(r.characterFormat)}else{for(e.offset!==this.getParagraphLength(i)||this.isEmpty||(i=this.getNextParagraphBlock(i));!sf.base.isNullOrUndefined(i)&&i!==t.paragraph&&i.isEmpty();)i=this.getNextParagraphBlock(i);var n=i===e.paragraph?e.offset:0;if(!sf.base.isNullOrUndefined(i)&&!i.isEmpty()){var o=new Ft(this.owner),s=e.currentWidget.getInline(n,0),a=this.getPhysicalPositionInternal(e.currentWidget,n,!0);o.setPositionForSelection(e.currentWidget,s.element,s.index,a),this.getCharacterFormatForSelection(i,this,o,t)}}}},t.prototype.getCharacterFormatForSelection=function(e,t,i,r){i.paragraph instanceof le&&i.paragraph.isInsideTable&&(!r.paragraph.isInsideTable||i.paragraph.associatedCell!==r.paragraph.associatedCell||this.isCellSelected(i.paragraph.associatedCell,i,r))?this.getCharacterFormatInTableCell(i.paragraph.associatedCell,t,i,r):this.getCharacterFormat(e,i,r)},t.prototype.getCharacterFormatForTableRow=function(e,t,i){for(var r=e.rowIndex;r<e.ownerTable.childWidgets.length;r++){for(var n=e.ownerTable.childWidgets[r],o=0;o<n.childWidgets.length;o++)this.getCharacterFormatForSelectionCell(n.childWidgets[o],t,i);if(i.paragraph.isInsideTable&&this.containsRow(n,i.paragraph.associatedCell))return}var s=this.getNextRenderedBlock(e.ownerTable);this.getCharacterFormatForBlock(s,t,i)},t.prototype.getCharacterFormatInTableCell=function(e,t,i,r){if(r.paragraph.isInsideTable){var n=this.getContainerCellOf(e,r.paragraph.associatedCell);if(n.ownerTable.contains(r.paragraph.associatedCell)){var o=this.getSelectedCell(e,n),s=this.getSelectedCell(r.paragraph.associatedCell,n);this.containsCell(n,r.paragraph.associatedCell)?this.isCellSelected(n,i,r)?this.getCharacterFormatForSelectionCell(n,i,r):o===n?this.getCharacterFormat(i.paragraph,i,r):this.getCharacterFormatForTableRow(o.ownerRow,i,r):this.getCharacterFormatInternalInTable(n.ownerTable,n,s,i,r)}else this.getCharacterFormatForTableRow(n.ownerRow,i,r)}else{var a=this.getContainerCell(e);this.getCharacterFormatForTableRow(a.ownerRow,i,r)}},t.prototype.getCharacterFormatInternalInTable=function(e,t,i,r,n){var o=this.getCellLeft(t.ownerRow,t),s=o+t.cellFormat.cellWidth,a=this.getCellLeft(i.ownerRow,i),l=a+i.cellFormat.cellWidth;o>a&&(o=a),s<l&&(s=l),o>this.upDownSelectionLength&&(o=this.upDownSelectionLength),s<this.upDownSelectionLength&&(s=this.upDownSelectionLength);for(var h=e.childWidgets.indexOf(i.ownerRow),d=e.childWidgets.indexOf(t.ownerRow);d<=h;d++)for(var c=e.childWidgets[d],p=0;p<c.childWidgets.length;p++){var u=c.childWidgets[p],g=this.getCellLeft(c,u);x.round(o,2)<=x.round(g,2)&&x.round(g,2)<x.round(s,2)&&this.getCharacterFormatForSelectionCell(u,r,n)}},t.prototype.getCharacterFormat=function(e,t,i){if((e===t.paragraph||e===i.paragraph||e.isEmpty()||(this.getCharacterFormatInternal(e,this),this.characterFormat.canRetrieveNextCharacterFormat()))&&(i.paragraph!==e||t.paragraph===e||0!==i.offset)){var r=0,n=this.getParagraphLength(e);if(e===t.paragraph)if(r=t.offset,this.setCharacterFormat(e,t,i,n))return;var o=-1!==e.childWidgets.indexOf(t.currentWidget)?e.childWidgets.indexOf(t.currentWidget):0,s=-1!==e.childWidgets.indexOf(i.currentWidget)?e.childWidgets.indexOf(i.currentWidget):e.childWidgets.length-1,a=i.offset;e!==i.paragraph&&(a=n);for(var l=o;l<=s;l++){var h=e.childWidgets[l];l!==o&&(r=this.getStartLineOffset(h)),a=h===i.currentWidget?i.offset:this.getLineLength(h);for(var d=0,c=0;c<h.children.length;c++){var p=h.children[c];if(!(p instanceof je))if(r>=d+p.length)d+=p.length;else if(p instanceof fe&&0===p.fieldType&&x.isLinkedFieldCharacter(p)){var u=sf.base.isNullOrUndefined(p.fieldEnd)?p.fieldBegin:p.fieldEnd;c--;do{this.characterFormat.combineFormat(p.characterFormat),d+=p.length,p=p.nextNode,l++,c++}while(!sf.base.isNullOrUndefined(p)&&p!==u)}else{if((p instanceof we||p instanceof fe)&&this.characterFormat.combineFormat(p.characterFormat,this.documentHelper.textHelper.getFontNameToRender(p.scriptType,p.characterFormat)),sf.base.isNullOrUndefined(p)||a<=d+p.length)break;d+=p.length}}}if(i.paragraph!==e){var g=this.getNextRenderedBlock(e);sf.base.isNullOrUndefined(g)||this.getCharacterFormatForBlock(g,t,i)}}},t.prototype.setCharacterFormat=function(e,t,i,r){var n=0,o=t.offset,s=t.currentWidget.getInline(o,n);n=s.index;var a=s.element;if(sf.base.isNullOrUndefined(a)){t.paragraph.childWidgets.indexOf(t.currentWidget);if(t.currentWidget.previousLine)return a=t.currentWidget.previousLine.children[t.currentWidget.previousLine.children.length-1],this.characterFormat.copyFormat(a.characterFormat,this.documentHelper.textHelper.getFontNameToRender(a.scriptType,a.characterFormat)),!0}if(o<r){if(this.isEmpty){if(a instanceof we||a instanceof fe&&(0===a.fieldType||1===a.fieldType)){var l=this.getPreviousTextElement(a);0===o&&l&&(a=l),this.characterFormat.copyFormat(a.characterFormat,this.documentHelper.textHelper.getFontNameToRender(a.scriptType,a.characterFormat))}else if(sf.base.isNullOrUndefined(this.getPreviousTextElement(a)))if(sf.base.isNullOrUndefined(this.getNextTextElement(a)))this.characterFormat.copyFormat(e.characterFormat);else{h=this.getNextTextElement(a);this.characterFormat.copyFormat(h.characterFormat,this.documentHelper.textHelper.getFontNameToRender(h.scriptType,a.characterFormat))}else{var h=this.getPreviousTextElement(a);this.characterFormat.copyFormat(h.characterFormat,this.documentHelper.textHelper.getFontNameToRender(h.scriptType,a.characterFormat))}return!0}n!==a.length||sf.base.isNullOrUndefined(a.nextNode)?a instanceof we?this.characterFormat.copyFormat(a.characterFormat,this.documentHelper.textHelper.getFontNameToRender(a.scriptType,a.characterFormat)):a instanceof fe&&this.characterFormat.copyFormat(this.getNextValidCharacterFormatOfField(a)):this.characterFormat.copyFormat(this.getNextValidCharacterFormat(a),this.documentHelper.textHelper.getFontNameToRender(a.scriptType,a.characterFormat))}else if(r===i.offset)return a instanceof we||a instanceof fe?this.characterFormat.copyFormat(a.characterFormat,this.documentHelper.textHelper.getFontNameToRender(a.scriptType,a.characterFormat)):sf.base.isNullOrUndefined(a)?this.characterFormat.copyFormat(e.characterFormat):(a=this.getPreviousTextElement(a),sf.base.isNullOrUndefined(a)||this.characterFormat.copyFormat(a.characterFormat,this.documentHelper.textHelper.getFontNameToRender(a.scriptType,a.characterFormat))),!0;return!1},t.prototype.getCharacterFormatForBlock=function(e,t,i){e instanceof le?this.getCharacterFormat(e,t,i):this.getCharacterFormatInTable(e,t,i)},t.prototype.getCharacterFormatInTable=function(e,t,i){for(var r=0;r<e.childWidgets.length;r++){for(var n=e.childWidgets[r],o=0;o<n.childWidgets.length;o++)this.getCharacterFormatForSelectionCell(n.childWidgets[o],t,i);if(i.paragraph.isInsideTable&&this.containsRow(n,i.paragraph.associatedCell))return}var s=this.getNextRenderedBlock(e);this.getCharacterFormatForBlock(s,t,i)},t.prototype.getCharacterFormatForSelectionCell=function(e,t,i){for(var r=0;r<e.childWidgets.length;r++)this.getCharacterFormatForBlock(e.childWidgets[r],t,i)},t.prototype.getCharacterFormatInternal=function(e,t){for(var i=0;i<e.childWidgets.length;i++)for(var r=e.childWidgets[i],n=0;n<r.children.length;n++){var o=r.children[n];o instanceof Re||o instanceof fe||o instanceof je||t.characterFormat.combineFormat(o.characterFormat)}},t.prototype.getNextValidCharacterFormat=function(e){var t=this.getNextTextElement(e);if(sf.base.isNullOrUndefined(t))return e.characterFormat;var i=void 0;return t instanceof fe&&0===i.fieldType&&(i=t),sf.base.isNullOrUndefined(i)?t.characterFormat:this.getNextValidCharacterFormatOfField(i)},t.prototype.getNextValidCharacterFormatOfField=function(e){var t=e;x.isLinkedFieldCharacter(e)&&(t=sf.base.isNullOrUndefined(e.fieldSeparator)?e.fieldEnd:e.fieldSeparator);var i=void 0;return sf.base.isNullOrUndefined(t.nextNode)||(i=this.getNextValidElement(t.nextNode)),sf.base.isNullOrUndefined(i)?t.characterFormat:i.characterFormat},t.prototype.checkCursorIsInSelection=function(e,t){if(sf.base.isNullOrUndefined(this.start)||this.isEmpty||sf.base.isNullOrUndefined(e))return!1;var i=!1;do{if(this.selectedWidgets.containsKey(e)){var r=void 0;e instanceof ue?(r=this.owner.selection.getTop(e),this.owner.selection.getLeft(e)):(r=e.y,e.x);var n=this.selectedWidgets.get(e);if(n instanceof Dt)i=n.left<=t.x&&r<=t.y&&r+e.height>=t.y&&n.left+n.width>=t.x;else for(var o=n,s=0;s<o.length&&!(o[s]instanceof Dt&&(i=o[s].left<=t.x&&r<=t.y&&r+e.height>=t.y&&o[s].left+o[s].width>=t.x));s++);}e=e instanceof ue?e.paragraph:e.containerWidget}while(!sf.base.isNullOrUndefined(e)&&!i);return i},t.prototype.copySelectionParagraphFormat=function(){var e=new ct;return this.paragraphFormat.copyToFormat(e),e},t.prototype.getHyperlinkDisplayText=function(e,t,i,r,n){var o=e;if(o!==i.line.paragraph)return{displayText:"<<Selection in Document>>",isNestedField:r=!0,format:n};for(var s="",a=o.childWidgets.indexOf(t.line),l=o.childWidgets[a].children.indexOf(t),h=a;h<o.childWidgets.length;h++){var d=o.childWidgets[h];h!==a&&(l=-1);for(var c=l+1;c<d.children.length;c++){var p=d.children[c];if(p===i)return{displayText:s,isNestedField:r,format:n};if(p instanceof we)s+=p.text,n=p.characterFormat;else{if(!(p instanceof fe))return{displayText:"<<Selection in Document>>",isNestedField:r=!0,format:n};p instanceof fe&&0===p.fieldType&&!sf.base.isNullOrUndefined(p.fieldEnd)&&(l=sf.base.isNullOrUndefined(p.fieldSeparator)?d.children.indexOf(p.fieldEnd):d.children.indexOf(p.fieldSeparator))}}}return{displayText:s,isNestedField:r,format:n}},t.prototype.navigateHyperLinkOnEvent=function(e,t){var i=this,r=this.documentHelper.getLineWidget(e);if(!sf.base.isNullOrUndefined(r)){var n=this.getHyperLinkFieldInCurrentSelection(r,e);sf.base.isNullOrUndefined(n)||(this.documentHelper.updateTextPositionForSelection(e,1),this.fireRequestNavigate(n),setTimeout((function(){i.viewer&&(i.documentHelper.isTouchInput=t,i.documentHelper.updateFocus(),i.documentHelper.isTouchInput=!1)})))}},t.prototype.getLinkText=function(e,t){var i=new Et(e,this),r=i.navigationLink,n=i.screenTip;return t?(i.localReference.length>0&&("_"!==i.localReference[0]||!sf.base.isNullOrUndefined(r)&&0!==r.length?i.isCrossRef?r+=i.localReference:r+="#"+i.localReference:r="Current Document"),i.destroy(),r):(i.destroy(),n)},t.prototype.setHyperlinkContentToToolTip=function(e,t,i,r){if(e){this.toolTipElement||(this.toolTipElement=sf.base.createElement("div",{className:"e-de-tooltip e-lib e-popup e-control"}),this.documentHelper.viewerContainer.appendChild(this.toolTipElement)),this.toolTipElement.style.display="block";var n=this.owner.defaultLocale["Click to follow link"]?this.owner.defaultLocale["Click to follow link"]:"Click to follow link";this.owner.useCtrlClickToFollowHyperlink&&(n=this.documentHelper.isIosDevice?"Command+"+n:"Ctrl+"+n);var o=this.getScreenTipText(e);if(r){var s=e.formFieldData.helpText;if(sf.base.isNullOrUndefined(s)||""===s)return;this.toolTipElement.innerHTML=s}else this.toolTipElement.innerHTML=o+"</br><b>"+n+"</b>";var a=this.getTooltipPosition(e.line,i,this.toolTipElement.clientWidth,this.toolTipElement.offsetHeight,!1);this.showToolTip(a.x,a.y),(sf.base.isNullOrUndefined(this.toolTipField)||!sf.base.isNullOrUndefined(this.toolTipField)&&e!==this.toolTipField)&&(this.toolTipElement.style.left=a.x+"px",this.toolTipElement.style.top=a.y+"px",this.toolTipElement.style.zIndex="2000"),this.toolTipElement.style.position="absolute",this.toolTipElement.style.display="block",this.toolTipField=e}else this.hideToolTip()},t.prototype.getScreenTipText=function(e){var t=new Et(e,this);return t.screenTip||t.localReference?t.screenTip?t.screenTip:t.localReference:t.navigationLink},t.prototype.setFootnoteContentToToolTip=function(e,t,i){if(e){this.toolTipElement||(this.toolTipElement=sf.base.createElement("div",{className:"e-de-tooltip"}),this.documentHelper.viewerContainer.appendChild(this.toolTipElement)),this.toolTipElement.style.display="block";var r=void 0;"Endnote"===e.footnoteType?r="Click to View/Edit Endnote":"Footnote"===e.footnoteType&&(r="Click to View/Edit Footnote"),this.toolTipElement.innerHTML="<b>"+r+"</b>";var n=this.getTooltipPosition(e.line,i,this.toolTipElement.clientWidth,this.toolTipElement.offsetHeight,!1);this.showToolTip(n.x,n.y),sf.base.isNullOrUndefined(this.toolTipField)||(this.toolTipElement.style.left=n.x+"px",this.toolTipElement.style.top=n.y+"px",this.toolTipElement.style.zIndex="2000"),this.toolTipElement.style.position="absolute",this.toolTipElement.style.display="block"}else this.hideToolTip()},t.prototype.setLockInfoTooptip=function(e,t,i){},t.prototype.getTooltipPosition=function(e,t,i,r,n){var o=this.getTop(e)*this.documentHelper.zoomFactor,s=this.getPage(e.paragraph),a=this.documentHelper.viewerContainer.getBoundingClientRect().width+this.documentHelper.viewerContainer.scrollLeft,l=s.boundingRectangle.x+t*this.documentHelper.zoomFactor;l+i+10>a&&(l-=i-(a-l)+15);var h=n?0:r,d=this.getPageTop(s)+(o-h);return d=d>this.documentHelper.viewerContainer.scrollTop?d:d+e.height+h,new M(l,d)},t.prototype.createPasteElement=function(e,t){if(!this.pasteElement){var i=this.documentHelper.viewerContainer.getElementsByClassName("e-de-paste")[0];this.pasteElement=i.parentElement.parentElement}this.pasteElement.style.display="block",this.pasteElement.style.position="absolute",this.pasteElement.style.left=t,this.pasteElement.style.top=e,this.pasteElement.style.zIndex="2000"},t.prototype.showToolTip=function(e,t){},t.prototype.hideToolTip=function(){this.toolTipField=void 0,this.toolTipElement&&(this.toolTipElement.style.display="none")},t.prototype.getHyperLinkFieldInCurrentSelection=function(e,t,i){var r=void 0,n=this.getTop(e),o=x.convertPointToPixel(e.paragraph.paragraphFormat.leftIndent),s=x.convertPointToPixel(e.paragraph.paragraphFormat.rightIndent),a=this.getLineStartLeft(e);if(!(t.y<n||t.y>n+e.height||t.x<a||t.x>a+e.paragraph.width+o+s)){var l=e.paragraph.x,h=this.getFirstElement(e,l);l=h.left;var d=h.element;if(sf.base.isNullOrUndefined(d)){var c=this.documentHelper.textHelper.getParagraphMarkWidth(e.paragraph.characterFormat);if(t.x<=a+c||t.x>=a+c){var p=[],u=this.getHyperLinkFields(e.paragraph,p,!1,i);return p=[],p=void 0,u}}else{var g=e.renderedElements;if(t.x>l+d.margin.left)for(var f=g.indexOf(d);f<g.length&&(d=g[f],!(t.x<l+d.margin.left+d.width||f===g.length-1));f++)l+=d.margin.left+d.width;r=d;c=d.margin.left+d.width;if(sf.base.isNullOrUndefined(r.nextNode)&&(c+=this.documentHelper.textHelper.getParagraphMarkWidth(r.line.paragraph.characterFormat)),t.x<=l+c){p=[],u=this.getHyperLinkFieldInternal(r.line.paragraph,r,p,!1,i);return p=[],p=void 0,u}}}},t.prototype.getFootNoteElementInCurrentSelection=function(e,t){var i=void 0,r=this.getTop(e),n=this.getLineStartLeft(e);if(!(t.y<r||t.y>r+e.height||t.x<n||t.x>n+e.paragraph.width)){var o=e.paragraph.x,s=this.getFirstElement(e,o);o=s.left;var a=s.element;if(sf.base.isNullOrUndefined(a)){var l=this.documentHelper.textHelper.getParagraphMarkWidth(e.paragraph.characterFormat);if(t.x<=n+l||t.x>=n+l){var h=this.documentHelper.selection.start.currentWidget.getInline(this.documentHelper.selection.start.offset,0).element;return h instanceof Me?h:void 0}}else{if(t.x>o+a.margin.left)for(var d=e.children.indexOf(a);d<e.children.length&&(a=e.children[d],!(t.x<o+a.margin.left+a.width||d===e.children.length-1));d++)o+=a.margin.left+a.width;a instanceof Me&&(i=a);l=a.margin.left+a.width;if(sf.base.isNullOrUndefined(a.nextNode)&&(l+=this.documentHelper.textHelper.getParagraphMarkWidth(a.line.paragraph.characterFormat)),t.x<=o+l)return i}}},t.prototype.getHyperlinkField=function(e){if(!sf.base.isNullOrUndefined(this.end)){var t=0,i=this.documentHelper.selection,r=(i.start,i.end);i.isForward||(i.end,r=i.start);var n=this.end.currentWidget.getInline(r.offset,t);t=n.index;var o=n.element,s=[],a=void 0;if(sf.base.isNullOrUndefined(o))a=this.getHyperLinkFields(this.end.paragraph,s,e);else if(this.documentHelper.isFormFillProtectedMode&&o instanceof Ce&&o.previousNode instanceof fe&&1===o.previousNode.fieldType)a=void 0;else{var l=o.line.paragraph;a=this.getHyperLinkFieldInternal(l,o,s,e,!1)}return s=[],a}},t.prototype.getHyperLinkFields=function(e,t,i,r){for(var n=0;n<this.documentHelper.fields.length;n++)if(-1===t.indexOf(this.documentHelper.fields[n])&&!sf.base.isNullOrUndefined(this.documentHelper.fields[n].fieldSeparator)){t.push(this.documentHelper.fields[n]);var o=this.getFieldCode(this.documentHelper.fields[n]);o=o.trim().toLowerCase();var s=this.paragraphIsInFieldResult(this.documentHelper.fields[n],e);if((i||!i&&o.match("hyperlink "))&&s)return this.documentHelper.fields[n];if(s&&r&&this.documentHelper.fields[n].formFieldData)return this.documentHelper.fields[n];if((i||!i&&o.match("ref "))&&s)return this.documentHelper.fields[n]}},t.prototype.getHyperLinkFieldInternal=function(e,t,i,r,n){for(var o=0;o<this.documentHelper.fields.length;o++)if(-1===i.indexOf(this.documentHelper.fields[o])&&!sf.base.isNullOrUndefined(this.documentHelper.fields[o].fieldSeparator)){i.push(this.documentHelper.fields[o]);var s=this.getFieldCode(this.documentHelper.fields[o]);s=s.trim().toLowerCase();var a=this.documentHelper.fields[o],l=a.fieldEnd;r&&a.nextNode instanceof Ce&&(l=a.nextNode.reference);var h=this.inlineIsInFieldResult(a,l,a.fieldSeparator,t,r)||this.isImageField();if((r||!r&&s.match("hyperlink "))&&h)return this.documentHelper.fields[o];if(h&&n&&this.documentHelper.fields[o].formFieldData)return this.documentHelper.fields[o];if((r||!r&&s.match("ref "))&&h)return this.documentHelper.fields[o]}if(e.containerWidget instanceof ne&&!(e instanceof oe))return this.getHyperLinkFieldInternal(e.containerWidget,t,i,r,n)},t.prototype.getBlock=function(e){if(""!==e&&!sf.base.isNullOrUndefined(e)){var t={index:e},i=this.start.getPage(t),r=t.index.indexOf(";"),n=t.index.substring(0,r);t.index=t.index.substring(r).replace(";","");var o=i.bodyWidgets[parseInt(n,10)];return this.getBlockInternal(o,t.index)}},t.prototype.getBlockInternal=function(e,t){if(""!==t&&!sf.base.isNullOrUndefined(t)){var i=t.indexOf(";"),r=t.substring(0,i);t=t.substring(i).replace(";","");var n=e;if(!((i=parseInt(r,10))>=0&&i<e.childWidgets.length))return n;var o=e.childWidgets[i];return t.indexOf(";")>=0?o instanceof le?(t.indexOf(";")>=0&&(t="0"),o):o instanceof se?this.getBlockInternal(o,t):n:o}},t.prototype.inlineIsInFieldResult=function(e,t,i,r,n){return!(sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(i)||!this.isExistBeforeInline(i,r))&&this.isExistAfterInline(t,r,n)},t.prototype.paragraphIsInFieldResult=function(e,t){if(!sf.base.isNullOrUndefined(e.fieldEnd)&&!sf.base.isNullOrUndefined(e.fieldSeparator)){var i=e.fieldSeparator.line.paragraph;if(e.fieldSeparator.line.paragraph===t||this.isExistBefore(i,t))return e.fieldEnd.line.paragraph!==t&&this.isExistAfter(i,t)}return!1},t.prototype.isImageField=function(){if(this.start.paragraph.isEmpty()||this.end.paragraph.isEmpty())return!1;var e=this.start,t=this.end;this.isForward||(e=this.end,t=this.start);var i=0,r=e.paragraph.getInline(e.offset,i),n=r.element;(i=r.index)===n.length&&(n=this.getNextRenderedElementBox(n,i));var o=(r=t.paragraph.getInline(t.offset,i)).element;if(i=r.index,n instanceof fe&&0===n.fieldType&&o instanceof fe&&1===o.fieldType&&n.fieldSeparator){var s=n.fieldSeparator.nextNode;if(s instanceof Re&&s.nextNode===o)return!0}return!1},t.prototype.isFormField=function(){var e=this.getCurrentFormField();return!!(e instanceof fe&&e.formFieldData)},t.prototype.isReferenceField=function(e){if(sf.base.isNullOrUndefined(e)&&(e=this.getHyperlinkField(!0)),e){var t=this.getFieldCode(e);if(t=t.toLowerCase(),e instanceof fe&&t.match("ref "))return!0}return!1},t.prototype.isInlineFormFillMode=function(e){return!!(this.documentHelper.isInlineFormFillProtectedMode&&(sf.base.isNullOrUndefined(e)&&(e=this.getCurrentFormField()),e&&e.formFieldData instanceof ye&&"Text"===e.formFieldData.type))},t.prototype.getFormFieldType=function(e){if(sf.base.isNullOrUndefined(e)&&(e=this.getCurrentFormField()),e instanceof fe){if(e.formFieldData instanceof ye)return"Text";if(e.formFieldData instanceof ve)return"CheckBox";if(e.formFieldData instanceof be)return"DropDown"}},t.prototype.getCurrentFormField=function(e){var t;if(e||this.documentHelper.isFormFillProtectedMode&&this.owner.documentEditorSettings.formFieldSettings&&"Inline"===this.owner.documentEditorSettings.formFieldSettings.formFillingMode)for(var i=0;i<this.documentHelper.formFields.length;i++){var r=this.documentHelper.formFields[i],n=this.start,o=this.end;if(this.isForward||(n=this.end,o=this.start),x.isLinkedFieldCharacter(r)){var s=r.fieldSeparator.line.getOffset(r.fieldSeparator,1),a=new Ft(this.owner);a.setPositionParagraph(r.fieldSeparator.line,s);var l=r.fieldEnd;s=l.line.getOffset(l,0);var h=new Ft(this.owner);if(h.setPositionParagraph(l.line,s),(n.isExistAfter(a)||n.isAtSamePosition(a))&&(o.isExistBefore(h)||o.isAtSamePosition(h))){t=r;break}}}else t=this.getHyperlinkField(!0);if(t instanceof fe&&0===t.fieldType&&!sf.base.isNullOrUndefined(t.formFieldData))return t},t.prototype.getCurrentTextFrame=function(){var e=this.start.paragraph.containerWidget;do{if(e instanceof ze)return e;e&&(e=e.containerWidget)}while(e);return null},t.prototype.isTableSelected=function(){var e=this.start,t=this.end;if(this.isForward||(e=this.end,t=this.start),sf.base.isNullOrUndefined(e.paragraph.associatedCell)||sf.base.isNullOrUndefined(t.paragraph.associatedCell))return!1;var i=e.paragraph.associatedCell.ownerTable.getSplitWidgets(),r=this.getFirstBlockInFirstCell(i[0]),n=this.getLastBlockInLastCell(i[i.length-1]);return e.paragraph.associatedCell.equals(r.associatedCell)&&t.paragraph.associatedCell.equals(n.associatedCell)&&(!r.associatedCell.equals(n.associatedCell)||0===e.offset&&t.offset===this.getLineLength(n.lastChild)+1)},t.prototype.selectListText=function(){var e=this.documentHelper.selectionLineWidget.getHierarchicalIndex("0"),t=this.getTextPosition(e),i=this.getTextPosition(e);this.isSelectList=!0,this.selectRange(t,i),this.isSelectList=!1,this.highlightListText(this.documentHelper.selectionLineWidget),this.contextTypeInternal="List"},t.prototype.highlightListText=function(e){var t=e.children[0].width,i=this.documentHelper.getLeftValue(e),r=e.paragraph.y;this.createHighlightBorder(e,t,i,r,!1),this.documentHelper.isListTextSelected=!0},t.prototype.updateImageSize=function(e){this.owner.isShiftingEnabled=!0;var t=this.start,i=this.end;this.isForward||(t=this.end,i=this.start);var r=null,n=0,o=t.paragraph;if(o===i.paragraph&&t.offset+1===i.offset){var s=o.getInline(i.offset,n);r=s.element,n=s.index}if(r instanceof Re||r instanceof Ee){var a=r.width,l=r.height;if(r.width=e.width,r.height=e.height,e.width=a,e.height=l,null!==o&&null!==o.containerWidget&&this.owner.editorModule){var h=o.childWidgets.indexOf(r.line),d=r.line.children.indexOf(r);this.documentHelper.layout.reLayoutParagraph(o,h,d),this.highlightSelection(!1)}}},t.prototype.getSelectedCellsInTable=function(e,t,i){for(var r=t.columnIndex,n=i.columnIndex+i.cellFormat.columnSpan-1,o=t.ownerRow.index,s=i.ownerRow.index,a=[],l=0;l<e.childWidgets.length;l++){var h=e.childWidgets[l];if(h.index>=o&&h.index<=s)for(var d=0;d<h.childWidgets.length;d++){var c=h.childWidgets[d];c.columnIndex>=r&&c.columnIndex<=n&&a.push(c)}if(h.index>s)break}return a},t.prototype.copy=function(){this.isEmpty||this.copySelectedContent(!1)},t.prototype.copySelectedContent=function(e){sf.base.isNullOrUndefined(this.owner.sfdtExportModule)||(this.copyToClipboard(this.getHtmlContent()),e&&this.owner.editorModule&&this.owner.editorModule.handleCut(this),this.documentHelper.updateFocus())},t.prototype.writeSfdt=function(){var e=this.start,t=this.end;return this.isForward||(e=this.end,t=this.start),this.owner.sfdtExportModule.write(e.currentWidget,e.offset,t.currentWidget,t.offset,!0)},t.prototype.getHtmlContent=function(){var e=this.writeSfdt();return this.owner.editorModule&&(this.owner.editorModule.copiedData=JSON.stringify(e)),this.htmlWriter.writeHtml(e)},t.prototype.copyToClipboard=function(e){window.getSelection().removeAllRanges();var t=document.createElement("div");t.style.left="-10000px",t.style.top="-10000px",t.style.position="relative",t.innerHTML=e,document.body.appendChild(t),void 0!==navigator&&-1!==navigator.userAgent.indexOf("Firefox")&&(t.contentEditable="true");var i=document.createRange();i.selectNodeContents(t),window.getSelection().addRange(i);var r=!1;try{r=document.execCommand("copy")}catch(e){}finally{window.getSelection().removeAllRanges(),t.parentNode.removeChild(t)}return r},t.prototype.showCaret=function(){var e=sf.base.isNullOrUndefined(this.documentHelper.currentPage)?this.documentHelper.currentRenderingPage:this.documentHelper.currentPage;if(!(sf.base.isNullOrUndefined(e)||this.documentHelper.isRowOrCellResizing||this.owner.enableImageResizerMode&&this.owner.imageResizerModule.isImageResizerVisible&&!this.owner.imageResizerModule.isShapeResize)){var t,i=e.boundingRectangle.x;if(t=this.viewer instanceof X?e.boundingRectangle.width*this.documentHelper.zoomFactor+i:e.boundingRectangle.width-this.owner.viewer.padding.right-this.documentHelper.scrollbarWidth,!this.owner.enableImageResizerMode||!this.owner.imageResizerModule.isImageResizerVisible||this.owner.imageResizerModule.isShapeResize)if(this.isHideSelection(this.start.paragraph))this.caret.style.display="none";else if(this.isEmpty&&(!this.owner.isReadOnly||this.owner.enableCursorOnReadOnly||this.isInlineFormFillMode())){var r=parseInt(this.caret.style.left.replace("px",""),10);this.caret.style.display=r<i||r>t?"none":"block"}else this.isImageSelected&&!this.owner.enableImageResizerMode?this.caret.style.display="block":("block"===this.caret.style.display||sf.base.isNullOrUndefined(this))&&(this.documentHelper.isComposingIME||(this.caret.style.display="none"));if(sf.base.isNullOrUndefined(this)||!this.documentHelper.isTouchInput||this.owner.isReadOnlyMode)this.documentHelper.touchStart.style.display="none",this.documentHelper.touchEnd.style.display="none";else{var n=parseInt(this.documentHelper.touchStart.style.left.replace("px",""),10)+14,o=parseInt(this.documentHelper.touchEnd.style.left.replace("px",""),10)+14,s=this.getSelectionPage(this.start);s&&(this.documentHelper.touchEnd.style.display=o<i||o>t?"none":"block",this.isEmpty||(i=s.boundingRectangle.x,t=s.boundingRectangle.width*this.documentHelper.zoomFactor+i),this.documentHelper.touchStart.style.display=n<i||n>t?"none":"block")}}},t.prototype.setEditableDivCaretPosition=function(e){this.documentHelper.editableDiv.focus();var t=this.documentHelper.editableDiv.childNodes[this.documentHelper.editableDiv.childNodes.length-1];if(t){var i=document.createRange();i.setStart(t,e),i.collapse(!0),window.getSelection().removeAllRanges(),window.getSelection().addRange(i)}},t.prototype.initCaret=function(){this.caret=sf.base.createElement("div",{styles:"position:absolute",className:"e-de-blink-cursor e-de-cursor-animation"}),this.owner.documentHelper.viewerContainer.appendChild(this.caret)},t.prototype.updateCaretPosition=function(){var e=this.end.location,t=this.getSelectionPage(this.end);if(t&&!sf.base.isNullOrUndefined(this.caret)){this.caret.style.left=t.boundingRectangle.x+Math.round(e.x)*this.documentHelper.zoomFactor+"px";var i=this.updateCaretSize(this.owner.selection.end),r=i.topMargin,n=this.viewer,o=(t.boundingRectangle.y-n.pageGap*(this.documentHelper.pages.indexOf(t)+1))*this.documentHelper.zoomFactor+n.pageGap*(this.documentHelper.pages.indexOf(t)+1);this.caret.style.top=o+Math.round(e.y+r)*this.documentHelper.zoomFactor+"px","Subscript"===this.owner.selection.characterFormat.baselineAlignment&&(this.caret.style.top=parseFloat(this.caret.style.top)+parseFloat(this.caret.style.height)/2+"px"),(this.documentHelper.isTouchInput||"none"!==this.documentHelper.touchStart.style.display)&&(this.documentHelper.touchStart.style.left=t.boundingRectangle.x+(Math.round(e.x)*this.documentHelper.zoomFactor-14)+"px",this.documentHelper.touchStart.style.top=o+(e.y+i.height)*this.documentHelper.zoomFactor+"px",this.documentHelper.touchEnd.style.left=t.boundingRectangle.x+(Math.round(e.x)*this.documentHelper.zoomFactor-14)+"px",this.documentHelper.touchEnd.style.top=o+(e.y+i.height)*this.documentHelper.zoomFactor+"px")}this.showHidePasteOptions(this.caret.style.top,this.caret.style.left)},t.prototype.showHidePasteOptions=function(e,t){if(!sf.base.Browser.isIE)if(this.isViewPasteOptions){if(this.pasteElement&&"block"===this.pasteElement.style.display)return;this.createPasteElement(e,t)}else this.pasteElement&&(this.pasteElement.style.display="none",sf.base.isNullOrUndefined(this.owner.editor)||(this.owner.editor.isHtmlPaste=!1))},t.prototype.getRect=function(e){var t=e.location,i=this.getSelectionPage(e);if(i){var r=this.owner.documentHelper,n=i.boundingRectangle.x+Math.round(t.x)*r.zoomFactor,o=this.viewer.pageGap,s=(i.boundingRectangle.y-o*(i.index+1))*r.zoomFactor+o*(i.index+1)+Math.round(t.y)*r.zoomFactor;return new M(n,s)}return new M(0,0)},t.prototype.getSelectionPage=function(e){var t=this.getLineWidgetInternal(e.currentWidget,e.offset,!0);if(t)return this.getPage(t.paragraph)},t.prototype.updateCaretSize=function(e,t){var i,r=0,n=!1,o=0,s=0;if(this.characterFormat.italic&&(n=this.characterFormat.italic),e.paragraph.isEmpty()){var a=e.paragraph,l=0,h=this.getParagraphMarkSize(a,r,l);r=h.topMargin,l=h.bottomMargin;var d=h.height;s=r<0?r+d:d,t||(this.caret.style.height=s*this.documentHelper.zoomFactor+"px"),r=0}else{var c=e.currentWidget.getInline(e.offset,o);o=c.index;var p=c.element;sf.base.isNullOrUndefined(p)||(s=(i=this.getCaretHeight(p,o,p.characterFormat,!0,r,n)).height,t||(this.caret.style.height=i.height*this.documentHelper.zoomFactor+"px"))}return t||(this.caret.style.transform=n?"rotate(13deg)":""),{topMargin:r,height:s}},t.prototype.updateCaretToPage=function(e,t){if(!sf.base.isNullOrUndefined(t))if(this.documentHelper.selectionEndPage=t,this.owner.selection.isEmpty)this.documentHelper.selectionStartPage=t;else{var i=this.getLineWidgetParagraph(e.offset,e.paragraph.childWidgets[0]),r=this.getPage(i.paragraph);sf.base.isNullOrUndefined(r)||(this.documentHelper.selectionStartPage=r)}this.checkForCursorVisibility()},t.prototype.getCaretBottom=function(e,t){var i=e.location.y;if(e.paragraph.isEmpty()){var r=e.paragraph,n=0,o=0,s=this.getParagraphMarkSize(r,n,o);n=s.topMargin,o=s.bottomMargin,i+=s.height,i+=n,t||(i+=o)}else{var a=0,l=e.paragraph.getInline(e.offset,a),h=l.element;a=l.index;n=0;var d=!1,c=this.getCaretHeight(h,a,h.characterFormat,!1,n,d);n=c.topMargin,d=c.isItalic,i+=c.height,t&&(i-=x.convertPointToPixel(this.documentHelper.layout.getAfterSpacing(e.paragraph)))}return i},t.prototype.checkForCursorVisibility=function(){this.showCaret()},t.prototype.onKeyDownInternal=function(e,t,i,r){var n=e.which||e.keyCode;if(!t||i||r)if(!i||t||r)if(i&&t&&!r)switch(n){case 32:this.owner.editor.insertText(String.fromCharCode(160));break;case 35:this.handleControlShiftEndKey();break;case 36:this.handleControlShiftHomeKey();break;case 37:this.handleControlShiftLeftKey();break;case 38:this.handleControlShiftUpKey();break;case 39:this.handleControlShiftRightKey();break;case 40:this.handleControlShiftDownKey();break;case 56:this.owner.documentEditorSettings.showHiddenMarks=!this.owner.documentEditorSettings.showHiddenMarks,this.owner.setShowHiddenMarks(this.owner.documentEditorSettings.showHiddenMarks)}else switch(n){case 33:e.preventDefault(),this.handlePageUpPageDownKey(!1,i);break;case 34:e.preventDefault(),this.handlePageUpPageDownKey(!0,i);break;case 35:this.handleEndKey(),e.preventDefault();break;case 36:this.handleHomeKey(),e.preventDefault();break;case 37:this.handleLeftKey(),e.preventDefault();break;case 38:this.handleUpKey(),e.preventDefault();break;case 39:this.handleRightKey(),e.preventDefault();break;case 40:this.handleDownKey(),e.preventDefault()}else switch(n){case 33:e.preventDefault(),this.handlePageUpPageDownKey(!1,i);break;case 34:e.preventDefault(),this.handlePageUpPageDownKey(!0,i);break;case 35:this.handleShiftEndKey(),e.preventDefault();break;case 36:this.handleShiftHomeKey(),e.preventDefault();break;case 37:this.handleShiftLeftKey(),e.preventDefault();break;case 38:this.handleShiftUpKey(),e.preventDefault();break;case 39:this.handleShiftRightKey(),e.preventDefault();break;case 40:this.handleShiftDownKey(),e.preventDefault()}else switch(this.documentHelper.isControlPressed=!0,n){case 35:this.handleControlEndKey();break;case 36:this.handleControlHomeKey();break;case 37:this.handleControlLeftKey();break;case 38:this.handleControlUpKey();break;case 39:this.handleControlRightKey();break;case 40:this.handleControlDownKey();break;case 65:this.owner.selection.selectAll();break;case 67:e.preventDefault(),this.copy();break;case 70:e.preventDefault(),this.owner.showDialog("FindPane")}if(this.isFormField()&&!this.documentHelper.isDocumentProtected){var o=this.getCurrentFormField(!0);if(o&&o.formFieldData instanceof be){o=37===e.keyCode||38===e.keyCode||40===e.keyCode?o:o.nextElement instanceof Ce?o.nextElement.reference:o.fieldEnd;var s=39===e.keyCode?1:0,a=o.line.getOffset(o,s),l=this.getPhysicalPositionInternal(o.line,a,!1);this.selectInternal(o.line,o,s,l)}}!this.owner.isReadOnlyMode||this.documentHelper.isCommentOnlyMode||this.isInlineFormFillMode()?this.owner.editorModule.onKeyDownInternal(e,t,i,r):this.documentHelper.isDocumentProtected&&"FormFieldsOnly"===this.documentHelper.protectionType&&(9!==e.keyCode&&32!==e.keyCode||this.owner.editorModule.onKeyDownInternal(e,t,i,r)),this.owner.searchModule&&!sf.base.isNullOrUndefined(this.owner.searchModule.searchHighlighters)&&this.owner.searchModule.searchHighlighters.length>0&&this.owner.searchModule.searchResults.clear(),27!==e.keyCode&&27!==e.which||(sf.base.isNullOrUndefined(this.owner.optionsPaneModule),this.owner.enableHeaderAndFooter&&this.disableHeaderFooter())},t.prototype.checkAndEnableHeaderFooter=function(e,t){var i=this.documentHelper.currentPage;if(this.isCursorInsidePageRect(e,i)){if(this.isCursorInHeaderRegion(e,i))return!this.owner.enableHeaderAndFooter&&this.enableHeadersFootersRegion(i.headerWidget,i);if(this.isCursorInFooterRegion(e,i))return!this.owner.enableHeaderAndFooter&&this.enableHeadersFootersRegion(i.footerWidget,i)}return!!this.owner.enableHeaderAndFooter&&(this.owner.enableHeaderAndFooter=!1,this.documentHelper.updateTextPositionForSelection(t,1),!0)},t.prototype.isCursorInsidePageRect=function(e,t){return this.viewer.containerLeft+e.x>=t.boundingRectangle.x&&this.viewer.containerLeft+e.x<=t.boundingRectangle.x+t.boundingRectangle.width*this.documentHelper.zoomFactor&&this.viewer instanceof X||this.viewer.containerLeft+e.x>=t.boundingRectangle.x&&this.viewer.containerLeft+e.x<=t.boundingRectangle.x+t.boundingRectangle.width},t.prototype.isCursorInHeaderRegion=function(e,t){if(this.viewer instanceof X){var i=this.getPageTop(t),r=0,n=t.headerWidget;n&&(r=n.y+n.height);var o=n.isEmpty&&!this.owner.enableHeaderAndFooter,s=x.convertPointToPixel(t.bodyWidgets[0].sectionFormat.topMargin),a=x.convertPointToPixel(t.bodyWidgets[0].sectionFormat.pageHeight),l=o?s:Math.min(Math.max(r,s),a/100*40);if(l*=this.documentHelper.zoomFactor,this.viewer.containerTop+e.y>=i&&this.viewer.containerTop+e.y<=i+l)return!0}return!1},t.prototype.isCursorInFooterRegion=function(e,t){if(this.viewer instanceof X){var i=t.boundingRectangle,r=this.getPageTop(t),n=r+i.height*this.documentHelper.zoomFactor,o=x.convertPointToPixel(t.bodyWidgets[0].sectionFormat.footerDistance),s=0;t.footerWidget&&(s=t.footerWidget.height);var a=x.convertPointToPixel(t.bodyWidgets[0].sectionFormat.bottomMargin),l=t.footerWidget.isEmpty&&!this.owner.enableHeaderAndFooter,h=i.height;if(h=l?(h-a)*this.documentHelper.zoomFactor:(h-Math.min(i.height/100*40,Math.max(s+o,a)))*this.documentHelper.zoomFactor,this.viewer.containerTop+e.y<=n&&this.viewer.containerTop+e.y>=r+h)return!0}return!1},t.prototype.enableHeadersFootersRegion=function(e,t){return this.viewer instanceof X&&(this.owner.enableHeaderAndFooter=!0,e.page=t,this.updateTextPositionForBlockContainer(e),this.shiftBlockOnHeaderFooterEnableDisable(),!0)},t.prototype.shiftBlockOnHeaderFooterEnableDisable=function(){for(var e=0;e<this.documentHelper.headersFooters.length;e++)for(var t=this.documentHelper.headersFooters[e],i=this.getBodyWidgetInternal(e,0).sectionFormat,r=0,n=Object.keys(t);r<n.length;r++){var o=t[n[r]];o.isEmpty&&this.owner.editor.shiftPageContent(o.headerFooterType,i)}},t.prototype.updateTextPositionForBlockContainer=function(e){var t=e.firstChild;t instanceof de&&(t=this.getFirstBlockInFirstCell(t))instanceof de&&(t=this.getFirstBlockInFirstCell(t)),this.selectParagraphInternal(t,!0)},t.prototype.disableHeaderFooter=function(){var e=this.getPage(this.start.paragraph);this.updateTextPositionForBlockContainer(e.bodyWidgets[0]),this.owner.enableHeaderAndFooter=!1,this.shiftBlockOnHeaderFooterEnableDisable()},t.prototype.destroy=function(){sf.base.isNullOrUndefined(this.contextTypeInternal)||(this.contextTypeInternal=void 0),this.caret=void 0,this.contextTypeInternal=void 0,this.upDownSelectionLength=void 0,this.owner=void 0},t.prototype.navigateBookmark=function(e,t){var i=this.documentHelper.bookmarks;if(i.containsKey(e)){var r=i.get(e),n=r.line.getOffset(r,0),o=new Ft(this.owner);if(o.setPositionParagraph(r.line,n),t)this.documentHelper.selection.selectRange(o,o,!0);else{var s=r.reference,a=s.line.getOffset(s,1),l=new Ft(this.owner);l.setPositionParagraph(s.line,a),this.documentHelper.selection.selectRange(o,l,!0)}}},t.prototype.selectBookmark=function(e){this.navigateBookmark(e)},t.prototype.getTocField=function(){for(var e=this.start.paragraph,t=void 0;void 0!==e&&this.isTocStyle(e);)t=e,e=e.previousRenderedWidget;if(void 0!==t){var i=t.childWidgets[0];if(void 0!==i)return i.children[0]}},t.prototype.isTocStyle=function(e){var t=e.paragraphFormat.baseStyle;return void 0!==t&&-1!==t.name.toLowerCase().indexOf("toc")},t.prototype.isTOC=function(){for(var e=this.getParagraphInfo(this.start).paragraph,t=0;t<e.childWidgets[0].children.length;t++){var i=e.childWidgets[0].children[t];if(i instanceof fe){var r=this.owner.selection.getFieldCode(i);if(r.match("TOC ")||r.match("Toc"))return!0}}return!1},t.prototype.getElementsForward=function(e,t,i,r){if(!sf.base.isNullOrUndefined(t)){for(var n=[],o=e.children.indexOf(t);o>=0;){for(var s=o;s<e.children.length;s++){var a=e.children[s];if(a.line!==e){o=-1;break}if(a===i){n.push(a),o=-1;break}n.push(a)}o=-1}return 0===n.length?void 0:n}},t.prototype.getElementsBackward=function(e,t,i,r){for(var n=[];r&&t&&t.previousElement&&(!t.isRightToLeft||t instanceof we&&this.documentHelper.textHelper.isRTLText(t.text));)t=t.previousElement;for(var o=e.children.indexOf(t);o>=0;){for(var s=o;s>-1&&s<e.children.length;r?s++:s--){var a=e.children[s];if(a.line!==e){o=-1;break}n.push(a)}o=-1}return n},t.prototype.navigatePreviousComment=function(){this.commentNavigateInternal(!1)},t.prototype.navigateNextComment=function(){this.commentNavigateInternal(!0)},t.prototype.commentNavigateInternal=function(e){if(!this.documentHelper.currentSelectedComment){if(0===this.documentHelper.comments.length)return;this.documentHelper.currentSelectedComment=this.documentHelper.comments[0]}if(this.documentHelper.currentSelectedComment){var t=this.documentHelper.comments,i=this.documentHelper.currentSelectedComment,r=t.indexOf(i);i=e?r===t.length-1?t[0]:t[r+1]:0===r?t[t.length-1]:t[r-1],this.documentHelper.currentSelectedComment=i,this.selectComment(i)}},t.prototype.navigatePreviousRevision=function(){this.revisionNavigateInternal(!1)},t.prototype.navigateNextRevision=function(){this.revisionNavigateInternal(!0)},t.prototype.revisionNavigateInternal=function(e){if(!this.documentHelper.currentSelectedRevisionInternal){if(0===this.documentHelper.owner.revisions.length)return;this.documentHelper.currentSelectedRevision=this.documentHelper.owner.revisions.get(0)}if(this.documentHelper.currentSelectedRevision){var t=this.documentHelper.owner.revisions.changes,i=this.documentHelper.currentSelectedRevision,r=t.indexOf(i);i=e?r===t.length-1?t[0]:t[r+1]:0===r?t[t.length-1]:t[r-1],this.documentHelper.currentSelectedRevision=i,this.selectRevision(i)}this.owner.trackChangesPane.currentSelectedRevision=this.documentHelper.currentSelectedRevision},t.prototype.selectComment=function(e){if(!sf.base.isNullOrUndefined(e)){var t=this.getElementPosition(e.commentStart).startPosition,i=this.getElementPosition(e.commentEnd).startPosition;this.selectPosition(t,i),this.documentHelper.currentSelectedComment=e,this.updatePreviousCommentMark(e),this.hightlightCommentSelectionMark(),this.owner.dotNetRef.invokeMethodAsync("SetSelectedComment",e.commentId)}},t.prototype.hightlightCommentSelectionMark=function(){if(this.documentHelper.currentSelectedComment){var e=this.getCommentStart(this.documentHelper.currentSelectedComment);e&&!e.commentMark&&e.renderCommentMark(),sf.base.classList(e.commentMark,["e-de-cmt-mark-selected"],[])}},t.prototype.updatePreviousCommentMark=function(e){if(this.documentHelper.currentSelectedComment){var t=this.getCommentStart(this.documentHelper.currentSelectedComment).commentMark;t&&(sf.base.classList(t,[],["e-de-cmt-mark-selected"]),this.removeSelectionMark("e-de-cmt-mark-selected"))}},t.prototype.removeSelectionMark=function(e){if(this.documentHelper.pageContainer)for(var t=this.documentHelper.pageContainer.getElementsByClassName(e),i=0;i<t.length;i++)sf.base.classList(t[i],[],[e])},t.prototype.getCommentStart=function(e){var t=void 0;return e&&e.commentStart&&(t=e.commentStart),void 0!==t.commentMark&&(t.commentMark.title="Click to see this comment"),this.getFirstCommentInLine(t)},t.prototype.getFirstCommentInLine=function(e){for(var t=0;t<e.line.children.length;t++){var i=e.line.children[t];if(i instanceof nt&&0===i.commentType)return i}return e},t.prototype.selectRevision=function(e){if(!sf.base.isNullOrUndefined(e)&&e.range.length>0){var t=e.range[0],i=e.range[e.range.length-1];if(t instanceof C){var r=t.ownerBase,n=r.childWidgets[0],o=r.childWidgets[r.childWidgets.length-1],s=this.getFirstParagraph(n),a=this.getLastParagraph(o);this.start.setPosition(s.firstChild,!0),this.end.setPositionParagraph(a.lastChild,a.lastChild.getEndOffset()+1),this.selectPosition(this.start,this.end)}else if(t&&i){var l=new Ft(this.owner),h=0;if(t instanceof P)h=(d=t.ownerBase).getLength(),l.setPositionParagraph(d.lastChild,h);else h=t.line.getOffset(t,0),l.setPositionForLineWidget(t.line,h);var d,c=new Ft(this.owner);if(i instanceof P)(d=i.ownerBase).isEndsWithPageBreak||d.isEndsWithColumnBreak?(this.owner.trackChangesPane.isTrackingPageBreak=!0,c.setPositionParagraph(d.nextRenderedWidget.childWidgets[0],0)):(h=d.getLength(),c.setPositionParagraph(d.lastChild,h+1));else h=i.line.getOffset(i,0)+i.length,this.isTOC()&&(h+=1),c.setPositionForLineWidget(i.line,h);var p=l.clone();l.isExistBefore(c)||(l=c,c=p),this.selectPosition(l,c)}}},t.prototype.selectTableRevision=function(e){if(!sf.base.isNullOrUndefined(e)&&e[0].range.length>0){var t=e[0].range[0],i=e[e.length-1].range[0];if(t instanceof C){var r=t.ownerBase.childWidgets[0],n=i.ownerBase,o=n.childWidgets[n.childWidgets.length-1],s=this.getFirstParagraph(r),a=this.getLastParagraph(o);this.start.setPosition(s.firstChild,!0),this.end.setPositionParagraph(a.lastChild,a.lastChild.getEndOffset()+1),this.selectPosition(this.start,this.end)}}},t.prototype.updateEditRangeCollection=function(){var e,t;if(this.editRangeCollection.length>0&&(this.editRangeCollection=[]),this.documentHelper.isDocumentProtected){if(this.documentHelper.editRanges.containsKey(this.owner.currentUser)){e=this.documentHelper.editRanges.get(this.owner.currentUser);for(n=0;n<e.length;n++)this.editRangeCollection.push(e[n])}if(this.documentHelper.editRanges.containsKey("Everyone")){r="Everyone";t=this.documentHelper.editRanges.get(r);for(n=0;n<t.length;n++)this.editRangeCollection.push(t[n])}}else for(var i=0;i<this.documentHelper.editRanges.length;i++){var r=this.documentHelper.editRanges.keys[i];e=this.documentHelper.editRanges.get(r);for(var n=0;n<e.length;n++)this.editRangeCollection.push(e[n])}},t.prototype.onHighlight=function(){this.isHighlightEditRegion?this.highlightEditRegion():this.unHighlightEditRegion(),this.viewer.renderVisiblePages()},t.prototype.highlightEditRegion=function(){if(this.updateEditRangeCollection(),this.isHighlightEditRegion){this.isHightlightEditRegionInternal=!0,sf.base.isNullOrUndefined(this.editRegionHighlighters)&&(this.editRegionHighlighters=new a),this.editRegionHighlighters.clear();for(var e=0;e<this.editRangeCollection.length;e++)this.highlightEditRegionInternal(this.editRangeCollection[e]);this.isHightlightEditRegionInternal=!1,this.viewer.updateScrollBars()}else this.unHighlightEditRegion()},t.prototype.highlightFormFields=function(){sf.base.isNullOrUndefined(this.formFieldHighlighters)&&(this.formFieldHighlighters=new a),this.formFieldHighlighters.clear();var e=this.documentHelper.formFields;if(!sf.base.isNullOrUndefined(e)&&e.length>0){for(var t=0;t<e.length;t++){var i=e[t];if(x.isLinkedFieldCharacter(i)){var r=i.line.getOffset(i,0),n=new Ft(this.owner);n.setPositionParagraph(i.line,r);var o=i.fieldEnd;r=o.line.getOffset(o,1);var s=new Ft(this.owner);s.setPositionParagraph(o.line,r),this.isHighlightFormFields=!0,this.highlight(n.paragraph,n,s),this.isHighlightNext&&(this.highlightNextBlock(this.hightLightNextParagraph,n,s),this.isHighlightNext=!1,this.hightLightNextParagraph=void 0)}}this.isHighlightFormFields=!1,this.viewer.updateScrollBars()}},t.prototype.unHighlightEditRegion=function(){sf.base.isNullOrUndefined(this.editRegionHighlighters)||(this.editRegionHighlighters.clear(),this.editRegionHighlighters=void 0),this.isHightlightEditRegionInternal=!1},t.prototype.highlightEditRegionInternal=function(e){var t=this.getPosition(e),i=t.startPosition,r=t.endPosition;this.isCurrentUser=!0,this.highlightEditRegions(e,i,r),this.isCurrentUser=!1},t.prototype.showAllEditingRegion=function(){0===this.editRangeCollection.length&&this.updateEditRangeCollection(),this.documentHelper.clearSelectionHighlight();for(var e=0;e<this.editRangeCollection.length;e++){var t=this.editRangeCollection[e],i=this.getPosition(t),r=i.startPosition,n=i.endPosition;this.highlightEditRegions(t,r,n)}},t.prototype.highlightEditRegions=function(e,t,i){if(!e.line.paragraph.isInsideTable||e.line.paragraph.isInsideTable&&!e.editRangeEnd.line.paragraph.isInsideTable||-1===e.columnFirst)this.highlight(e.line.paragraph,t,i),this.isHighlightNext&&(this.highlightNextBlock(this.hightLightNextParagraph,t,i),this.isHighlightNext=!1,this.hightLightNextParagraph=void 0);else{var r=e.line.paragraph.associatedCell.ownerRow.childWidgets[e.columnFirst];if(r)for(var n=0;n<r.childWidgets.length;n++)r.childWidgets[n]instanceof le&&(this.highlight(r.childWidgets[n],t,i),this.isHighlightNext&&(this.highlightNextBlock(this.hightLightNextParagraph,t,i),this.isHighlightNext=!1,this.hightLightNextParagraph=void 0))}},t.prototype.navigateToNextEditingRegion=function(){var e=this.getEditRangeStartElement();if(this.editRangeCollection.length>0){this.sortEditRangeCollection();var t=this.editRangeCollection.length,i=t;sf.base.isNullOrUndefined(e)||(i=this.editRangeCollection.indexOf(e));var r=i<t-1?this.editRangeCollection[i+1]:this.editRangeCollection[0],n=this.getPosition(r),o=n.startPosition,s=n.endPosition;this.selectRange(o,s)}},t.prototype.sortEditRangeCollection=function(){for(var e=this.editRangeCollection.length-1;e>=0;e--)for(var t=1;t<=e;t++){var i=this.getPosition(this.editRangeCollection[t-1]).startPosition,r=this.getPosition(this.editRangeCollection[t]).startPosition;if(i.isExistAfter(r)){var n=this.editRangeCollection[t-1];this.editRangeCollection[t-1]=this.editRangeCollection[t],this.editRangeCollection[t]=n}}},t.prototype.toggleEditingRegionHighlight=function(){this.isHighlightEditRegion=!this.isHighlightEditRegion},t.prototype.getEditRangeStartElement=function(){for(var e=0;e<this.editRangeCollection.length;e++){var t=this.editRangeCollection[e],i=this.getPosition(t),r=i.startPosition,n=i.endPosition;if((this.start.isExistAfter(r)||this.start.isAtSamePosition(r))&&(this.end.isExistBefore(n)||this.end.isAtSamePosition(n)))return t}},t.prototype.isSelectionInEditRegion=function(){return!!this.documentHelper.isDocumentProtected&&this.checkSelectionIsAtEditRegion()},t.prototype.checkSelectionIsAtEditRegion=function(e,t){sf.base.isNullOrUndefined(e)&&sf.base.isNullOrUndefined(t)&&(e=this.start,t=this.end,this.isForward||(e=this.end,t=this.start));for(var i=0;i<this.editRangeCollection.length;i++){var r=this.editRangeCollection[i];if(!r.line.paragraph.isInsideTable||r.line.paragraph.isInsideTable&&!r.editRangeEnd.line.paragraph.isInsideTable||-1===r.columnFirst){if(this.isSelectionInsideEditRange(r,e,t))return!0}else if(r.paragraph.isInsideTable&&r.editRangeEnd&&r.editRangeEnd.line.paragraph.isInsideTable){var n=r.paragraph.associatedCell.ownerRow,o=e.paragraph.associatedCell,s=t.paragraph.associatedCell;if(!sf.base.isNullOrUndefined(o)&&!sf.base.isNullOrUndefined(s)&&n.equals(o.ownerRow)&&n.equals(s.ownerRow)&&o.index>=r.columnFirst&&o.index<=r.columnLast)if(this.isEmpty&&o.index===r.line.paragraph.associatedCell.index){if(this.isSelectionInsideEditRange(r,e,t))return!0}else if(!this.isCellSelected(o,e,t))return!0}}return!1},t.prototype.isSelectionInsideEditRange=function(e,t,i){var r=this.getPosition(e),n=r.startPosition,o=r.endPosition;return!(!t.isExistAfter(n)&&!t.isAtSamePosition(n)||!i.isExistBefore(o)&&!i.isAtSamePosition(o))},t.prototype.getPosition=function(e){var t,i=e.line.getOffset(e,1),r=new Ft(this.owner);r.setPositionParagraph(e.line,i),e instanceof He?t=e.editRangeEnd:e instanceof Oe||e instanceof Ce?t=e.reference:e instanceof nt&&(t=e.comment.commentEnd),i=t.line.getOffset(t,1);var n=new Ft(this.owner);return n.setPositionParagraph(t.line,i),{startPosition:r,endPosition:n}},t.prototype.checkContentControlLocked=function(e){this.owner.editorModule.isXmlMapped=!1;for(var t=0;t<this.documentHelper.contentControlCollection.length;t++){var i=this.documentHelper.contentControlCollection[t],r=this.getPosition(i),n=r.startPosition,o=r.endPosition,s=this.start,a=this.end;if(this.isForward||(s=this.end,a=this.start),sf.base.isNullOrUndefined(e)){var l=(n.isExistAfter(s)||n.isAtSamePosition(s))&&(n.isExistBefore(a)||n.isAtSamePosition(a)),h=(o.isExistAfter(s)||o.isAtSamePosition(s))&&(o.isExistBefore(a)||o.isAtSamePosition(a));if(l&&h)return!!i.contentControlProperties.lockContentControl;if((l||h)&&!n.isAtSamePosition(s)&&!o.isAtSamePosition(s)&&(i.contentControlProperties.lockContentControl||i.contentControlProperties.lockContents))return!0}if((s.isExistAfter(n)||s.isAtSamePosition(n))&&(a.isExistBefore(o)||a.isAtSamePosition(o))){if(i.contentControlProperties.xmlMapping&&i.contentControlProperties.xmlMapping.isMapped&&(this.owner.editorModule.isXmlMapped=!0),i.contentControlProperties.lockContents)return!0;if(sf.base.isNullOrUndefined(e)&&("CheckBox"===i.contentControlProperties.type||"ComboBox"===i.contentControlProperties.type||"DropDownList"===i.contentControlProperties.type||"Date"===i.contentControlProperties.type))return!0}}return!1},t.prototype.getElementPosition=function(e,t){var i=e.line.getOffset(e,t?0:1),r=new Ft(this.owner);return r.setPositionParagraph(e.line,i),{startPosition:r,endPosition:void 0}},t.prototype.updateRefField=function(e){if(sf.base.isNullOrUndefined(e)&&(e=this.getHyperlinkField(!0)),!sf.base.isNullOrUndefined(e)){if(!this.isReferenceField(e))return;var t=this.getFieldCode(e).replace(/\s+/g," ");if(0===(t=t.trim()).toLowerCase().indexOf("ref")){var i=t.split(" ");if(i.length>1){var r=i[1];if(this.documentHelper.bookmarks.containsKey(r)){var n=this.start,o=this.end;this.isForward||(n=this.end,o=this.start);var s=this.documentHelper.bookmarks.get(r),a=s.reference,l=s.previousNode;!sf.base.isNullOrUndefined(l)&&l instanceof fe||!(a.previousNode instanceof fe)||1!==a.previousNode.fieldType||sf.base.isNullOrUndefined(a.previousNode.fieldBegin)||sf.base.isNullOrUndefined(a.previousNode.fieldBegin.formFieldData)?l instanceof fe&&0===l.fieldType&&!sf.base.isNullOrUndefined(l.formFieldData)&&(s=l.fieldSeparator,a=l.fieldEnd):(s=a.previousNode.fieldBegin.fieldSeparator,a=a.previousNode.fieldBegin.fieldEnd);var h=s.line.getOffset(s,1);n.setPositionParagraph(s.line,h),o.setPositionParagraph(a.line,a.line.getOffset(a,0));var d=this.owner.sfdtExportModule.write(n.currentWidget,n.offset,o.currentWidget,o.offset,!1,!0),c=e.fieldSeparator,p=e.fieldEnd;n.setPositionParagraph(c.line,c.line.getOffset(c,1)),o.setPositionParagraph(p.line,p.line.getOffset(p,0)),this.owner.editor.pasteContents(d)}}}}},t.prototype.footnoteReferenceElement=function(e,t,i){var r=0;if(this.getContainerWidget(e.paragraph)instanceof ae)for(var n=this.start.paragraph.bodyWidget.footNoteReference,o=0;o<this.documentHelper.pages.length;o++){r=0;for(var s=this.documentHelper.pages[o],a=0;a<s.bodyWidgets.length;a++)for(var l=s.bodyWidgets[a],h=0;h<l.childWidgets.length;h++){var d=l.childWidgets[h];if(d instanceof de)for(var c=0;c<d.childWidgets.length;c++)for(var p=d.childWidgets[c],u=0;u<p.childWidgets.length;u++)for(var g=p.childWidgets[u],f=0;f<g.childWidgets.length;f++)for(var m=g.childWidgets[f],y=0;y<m.childWidgets.length;y++){var v=m.childWidgets[y];if(r=0,!sf.base.isNullOrUndefined(v.children))for(var b=0;b<v.children.length;b++){r+=(x=v.children[b]).length,x instanceof Me&&x===n&&(e.setPositionParagraph(v,r-1),t.setPositionParagraph(v,r),this.selectRange(e,t))}}else for(var w=0;w<d.childWidgets.length;w++){v=d.childWidgets[w];if(r=0,!sf.base.isNullOrUndefined(v.children))for(b=0;b<v.children.length;b++){var x;r+=(x=v.children[b]).length,x instanceof Me&&x===n&&(e.setPositionParagraph(v,r-1),t.setPositionParagraph(v,r),this.selectRange(e,t))}}}}},t}(),Wt=function(){function e(e){this.wordBefore="\\b",this.wordAfter="\\b",this.owner=e,this.documentHelper=this.owner.documentHelper}return e.prototype.find=function(e,t){return this.findNext(e,t,"0;0;0")},e.prototype.findNext=function(e,t,i){"string"==typeof e&&(e=this.stringToRegex(e,t)),void 0===i&&(i="0;0;0"),this.owner.searchModule.textSearchResults.clearResults();var r=this.owner.searchModule.textSearchResults;return this.findDocument(r,e,!0,t,i),r.length,r.currentSearchResult},e.prototype.stringToRegex=function(e,t){if(e.indexOf("\\")>-1&&(e=e.split("\\").join("\\\\")),e.indexOf("(")>-1||e.indexOf(")")>-1||e.indexOf(".")>-1||e.indexOf("[")>-1||e.indexOf("]")>-1||e.indexOf("$")>-1||e.indexOf("{")>-1||e.indexOf("}")>-1||e.indexOf("*")>-1||e.indexOf("|")>-1||e.indexOf("^")>-1||e.indexOf("?")>-1){for(var i="",r=0;r<e.length;r++)"("===e[parseInt(r.toString(),10)]||")"===e[parseInt(r.toString(),10)]||"."===e[parseInt(r.toString(),10)]||"["===e[parseInt(r.toString(),10)]||"]"===e[parseInt(r.toString(),10)]||"$"===e[parseInt(r.toString(),10)]||"{"===e[parseInt(r.toString(),10)]||"}"===e[parseInt(r.toString(),10)]||"*"===e[parseInt(r.toString(),10)]||"|"===e[parseInt(r.toString(),10)]||"^"===e[parseInt(r.toString(),10)]||"?"===e[parseInt(r.toString(),10)]?i+="\\"+e[parseInt(r.toString(),10)]:i+=e[parseInt(r.toString(),10)];e=i}return"WholeWord"!==t&&"CaseSensitiveWholeWord"!==t||(e=this.wordBefore+e+this.wordAfter),RegExp(e,"CaseSensitive"===t||"CaseSensitiveWholeWord"===t?"g":"ig")},e.prototype.isPatternEmpty=function(e){var t=this.wordBefore+this.wordAfter,i=e.toString();return 0===i.length||i===t},e.prototype.findAll=function(e,t,i){"string"==typeof e&&(e=this.stringToRegex(e,t)),void 0===i&&(i="0;0;0"),this.owner.searchModule.textSearchResults.clearResults();var r=this.owner.searchModule.textSearchResults;if(this.findDocument(r,e,!1,t,i),r.length>0&&r.currentIndex<0&&(r.currentIndex=0),!sf.base.isNullOrUndefined(r.currentSearchResult)){this.documentHelper.owner;return this.owner.dotNetRef.invokeMethodAsync("SearchResultsChange"),r}},e.prototype.getElementInfo=function(e,t,i){for(var r=e,n="",o=new a;;){if(e instanceof we&&!sf.base.isNullOrUndefined(e.text)&&""!==e.text)o.add(e,n.length),n+=e===r?e.text.substring(t):e.text;else if(e instanceof fe){var s=e;sf.base.isNullOrUndefined(s.fieldEnd)||(e=sf.base.isNullOrUndefined(s.fieldSeparator)?s.fieldEnd:s.fieldSeparator)}if(!sf.base.isNullOrUndefined(e)&&sf.base.isNullOrUndefined(e.nextNode))break;if(!sf.base.isNullOrUndefined(e))if(sf.base.isNullOrUndefined(i)||i)e=e.nextNode;else{var l=e.line.children,h=e.line.children.length;if(!(l.indexOf(e)<h-1)){e=void 0;break}e=e.nextNode}}return{elementsWithOffset:o,fullText:n.toString()}},e.prototype.updateMatchedTextLocation=function(e,t,i,r,n,o,s,a){for(var l=0;l<e.length;l++){var h=e[parseInt(l.toString(),10)],d=void 0;if(sf.base.isNullOrUndefined(a)||!(h.index<a)){for(var c=t.addResult(),p=i.keys,u=0;u<p.length;u++){var g=p[parseInt(u.toString(),10)],f=i.get(g),m=g.length;if(g===n&&(m-=r),sf.base.isNullOrUndefined(c.start)&&h.index<f+m){var y=h.index-f;g===n&&(y+=r);var v=g.line.getOffset(g,y);c.start=this.getTextPosition(g.line,v.toString()),c.start.location=this.owner.selection.getPhysicalPositionInternal(g.line,v,!0),c.start.setPositionParagraph(g.line,v)}if(h.index+h[0].length<=f+m){y=h.index+h[0].length-f;g===n&&(y+=r);v=g.line.getOffset(g,y);c.end=this.getTextPosition(g.line,v.toString()),c.end.location=this.owner.selection.getPhysicalPositionInternal(g.line,v,!0),c.end.setPositionParagraph(g.line,v),d=!0;break}}if(o){t.currentIndex=0;break}if(t.currentIndex<0&&!sf.base.isNullOrUndefined(s)&&(s.isExistBefore(c.start)||s.isAtSamePosition(c.start))&&(t.currentIndex=t.indexOf(c)),!sf.base.isNullOrUndefined(a)&&d)break}}},e.prototype.findDocument=function(e,t,i,r,n){if(!this.isPatternEmpty(t)){void 0===r&&(r="None");var o,s=void 0,a=void 0;if(void 0!==n&&(a=this.owner.selection.end),void 0!==n&&i&&void 0!==a&&void 0!==a.paragraph&&a.paragraph instanceof le){var l=0,h=a.currentWidget.getInline(this.owner.selection.start.offset,l);if(s=h.element,l=h.index,!sf.base.isNullOrUndefined(s)){var d=void 0;for(d=this.findInline(s,t,r,l,i,e,a);0===e.length&&!sf.base.isNullOrUndefined(d);){for(;!sf.base.isNullOrUndefined(d)&&0===d.childWidgets.length;)d=this.owner.selection.getNextParagraph(d.containerWidget);if(sf.base.isNullOrUndefined(d))break;var c=d.childWidgets[0];if(s=c.children[0]instanceof je?c.children[2]instanceof we?c.children[2]:void 0:c.children[0],sf.base.isNullOrUndefined(s))break;d=this.findInline(s,t,r,0,i,e,a)}if(e.length>0)return}}for(o=this.documentHelper.pages[0].bodyWidgets[0];!sf.base.isNullOrUndefined(o)&&0===o.childWidgets.length;)o=o.nextWidget;if(!sf.base.isNullOrUndefined(o)&&0!==o.childWidgets.length){this.findInlineText(o,t,r,i,e,a);for(var p=this.documentHelper.headersFooters,u=0;u<p.length;u++){var g=p[parseInt(u.toString(),10)];if(g)for(var f in g){var m=g[parseInt(f.toString(),10)];sf.base.isNullOrUndefined(m)||sf.base.isNullOrUndefined(m.page)||this.findInlineText(m,t,r,i,e,a)}}i&&!sf.base.isNullOrUndefined(e)&&e.length}}},e.prototype.findInlineText=function(e,t,i,r,n,o){for(var s=this.owner.documentHelper.getFirstParagraphBlock(e.childWidgets[0]);!sf.base.isNullOrUndefined(s)&&1===s.childWidgets.length&&0===s.childWidgets[0].children.length;)s=this.owner.selection.getNextParagraphBlock(s);for(;!sf.base.isNullOrUndefined(s)&&s.childWidgets.length>0;){var a=s.childWidgets[0].children[0];if(sf.base.isNullOrUndefined(a))break;for(this.findInline(a,t,i,0,r,n,o),s=this.owner.selection.getNextParagraphBlock(s);!sf.base.isNullOrUndefined(s)&&1===s.childWidgets.length&&0===s.childWidgets[0].children.length;)s=this.owner.selection.getNextParagraphBlock(s)}r&&!sf.base.isNullOrUndefined(n)&&n.length},e.prototype.findInline=function(e,t,i,r,n,o,s){for(var a,l=e,h=this.getElementInfo(e,r),d=h.fullText,c=[],p=h.elementsWithOffset;!sf.base.isNullOrUndefined(a=t.exec(d));)c.push(a);if(this.updateMatchedTextLocation(c,o,p,r,l,n,s),!n)return this.owner.selection.getNextParagraphBlock(e.line.paragraph)},e.prototype.getTextPosition=function(e,t){var i=new Ft(this.owner),r=i.getHierarchicalIndex(e,t);return i.setPositionForCurrentIndex(r),i},e}(),Rt=function(){function e(e,t){this.leftInternal=0,this.widthInternal=0,this.leftInternal=e,this.widthInternal=t}return Object.defineProperty(e.prototype,"left",{get:function(){return this.leftInternal},set:function(e){this.leftInternal=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return this.widthInternal},set:function(e){this.widthInternal=e},enumerable:!0,configurable:!0}),e}(),jt=function(){function e(e){this.startIn=void 0,this.endIn=void 0,this.owner=e,this.documentHelper=this.owner.documentHelper}return Object.defineProperty(e.prototype,"start",{get:function(){return this.startIn},set:function(e){this.startIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"end",{get:function(){return this.endIn},set:function(e){this.endIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"text",{get:function(){return this.documentHelper.selection.getTextInternal(this.start,this.end,!1)},enumerable:!0,configurable:!0}),e.prototype.destroy=function(){this.start=void 0,this.end=void 0},e}(),Ut=function(){function e(e){this.currentIndex=-1,this.owner=e}return Object.defineProperty(e.prototype,"length",{get:function(){return void 0===this.innerList?0:this.innerList.length},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentSearchResult",{get:function(){if(!(void 0===this.innerList||this.currentIndex<0||this.currentIndex>=this.length))return this.innerList[this.currentIndex]},enumerable:!0,configurable:!0}),e.prototype.addResult=function(){var e=new jt(this.owner);return sf.base.isNullOrUndefined(this.innerList)&&(this.innerList=[]),this.innerList.push(e),e},e.prototype.clearResults=function(){if(this.currentIndex=-1,!sf.base.isNullOrUndefined(this.innerList))for(var e=this.innerList.length-1;e>=0;e--)this.innerList[parseInt(e.toString(),10)].destroy(),this.innerList.splice(e,1)},e.prototype.indexOf=function(e){return sf.base.isNullOrUndefined(this.innerList)?-1:this.innerList.indexOf(e)},e.prototype.destroy=function(){sf.base.isNullOrUndefined(this.innerList)||this.clearResults(),this.innerList=void 0},e}(),Ht=function(){function e(e){this.searchModule=e}return Object.defineProperty(e.prototype,"length",{get:function(){return this.searchModule.textSearchResults.length},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"index",{get:function(){return this.searchModule.textSearchResults.currentIndex},set:function(e){0===this.length||e<0||e>this.searchModule.textSearchResults.length-1||(this.searchModule.textSearchResults.currentIndex=e,this.navigate())},enumerable:!0,configurable:!0}),e.prototype.getTextSearchResultsOffset=function(){for(var e,t=[],i=0;i<this.searchModule.textSearchResults.innerList.length;i++)e=this.getOffset(this.searchModule.textSearchResults.innerList[parseInt(i.toString(),10)]),t.push(e);return t},e.prototype.getOffset=function(e){var t=e.start,i=e.end,r=this.searchModule.documentHelper.owner.selection.getParagraphInfo(t),n=this.searchModule.documentHelper.owner.selection.getHierarchicalIndex(r.paragraph,r.offset.toString());return r=this.searchModule.documentHelper.owner.selection.getParagraphInfo(i),{startOffset:n,endOffset:this.searchModule.documentHelper.owner.selection.getHierarchicalIndex(r.paragraph,r.offset.toString())}},e.prototype.getModuleName=function(){return"SearchResults"},e.prototype.replace=function(e){-1!==this.index&&this.searchModule.replaceInternal(e)},e.prototype.replaceAll=function(e){-1!==this.index&&this.searchModule.replaceAllInternal(e)},e.prototype.navigate=function(){this.searchModule.navigate(this.searchModule.textSearchResults.currentSearchResult),this.searchModule.highlight(this.searchModule.textSearchResults)},e.prototype.clear=function(){this.searchModule.textSearchResults.clearResults(),this.searchModule.clearSearchHighlight(),this.searchModule.viewer.renderVisiblePages()},e}(),Bt=function(){function e(e){this.searchHighlighters=void 0,this.owner=e,this.searchHighlighters=new a,this.textSearch=new Wt(this.owner),this.textSearchResults=new Ut(this.owner),this.searchResultsInternal=new Ht(this)}return Object.defineProperty(e.prototype,"viewer",{get:function(){return this.owner.viewer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"searchResults",{get:function(){return this.searchResultsInternal},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"documentHelper",{get:function(){return this.owner.documentHelper},enumerable:!0,configurable:!0}),e.prototype.getModuleName=function(){return"Search"},e.prototype.find=function(e,t){sf.base.isNullOrUndefined(t)&&(t="None");var i=this.textSearch.find(e,t);sf.base.isNullOrUndefined(i)||this.navigate(i)},e.prototype.findAll=function(e,t){if(!sf.base.isNullOrUndefined(e||""===e)){sf.base.isNullOrUndefined(t)&&(t="None");var i=this.textSearch.findAll(e,t);!sf.base.isNullOrUndefined(i)&&i.length>0&&(this.navigate(i.innerList[i.currentIndex]),this.highlight(i))}},e.prototype.replace=function(e,t,i){if(sf.base.isNullOrUndefined(this.viewer.owner)||this.viewer.owner.isReadOnlyMode||sf.base.isNullOrUndefined(i))return 0;sf.base.isNullOrUndefined(this.viewer)||this.clearSearchHighlight(),this.navigate(t);var r=this.documentHelper.selection.start;if(this.owner.enableTrackChanges&&this.documentHelper.selection.start.currentWidget){this.documentHelper.selection.end.currentWidget.getInline(this.owner.selection.start.offset,0).element.revisions.length>0&&(this.isRepalceTracking=!0)}if(i.indexOf(t)<0)return 0;this.owner.editorModule.insertTextInternal(e,!0);var n=t.end,o=new Ft(this.viewer.owner);if(0===n.currentWidget.children.length){var s=n.currentWidget.paragraph.childWidgets[0];o.setPositionParagraph(s,r.offset-e.length)}else o.setPositionParagraph(n.currentWidget,r.offset-e.length);this.documentHelper.selection.selectRange(r,o);this.viewer.owner;return this.owner.dotNetRef.invokeMethodAsync("SearchResultsChange"),1},e.prototype.replaceInternal=function(e,t){if(""!==e&&!sf.base.isNullOrUndefined(e)){sf.base.isNullOrUndefined(t)&&(t="None");var i=this.textSearchResults.currentSearchResult.text,r=this.viewer.owner.searchModule.textSearch.stringToRegex(i,t),n=this.owner.selection.end.getHierarchicalIndexInternal(),o=this.viewer.owner.searchModule.textSearch.findNext(r,t,n);sf.base.isNullOrUndefined(o)||(this.navigate(o),this.textSearchResults.addResult(),this.textSearchResults.innerList[0]=o,this.replace(e,o,this.textSearchResults),n=this.owner.selection.end.getHierarchicalIndexInternal(),(o=this.textSearch.findNext(i,t,n))&&(this.textSearchResults.addResult(),this.textSearchResults.innerList[0]=o,this.navigate(o)))}},e.prototype.replaceAll=function(e,t){if(sf.base.isNullOrUndefined(this.viewer.owner)||this.viewer.owner.isReadOnlyMode||sf.base.isNullOrUndefined(t))return 0;this.owner.editorHistory&&this.owner.editorHistory.initComplexHistory(this.owner.selection,"ReplaceAll");var i=t.length;this.viewer.owner.isLayoutEnabled=!1;for(var r=t.innerList[0].text,n=i-1;n>=0;n--){var o=t.innerList[parseInt(n.toString(),10)];if(0===o.start.currentWidget.children.length)n=(t=this.textSearch.findAll(r)).length;else{this.navigate(o);var s=!0;if(n>0)t.innerList[n-1].start.paragraph.equals(o.start.paragraph)&&(s=!1);this.owner.editorModule.insertTextInternal(e,!0,void 0,s),o.destroy()}}return this.owner.editorHistory&&!sf.base.isNullOrUndefined(this.owner.editorHistory.currentHistoryInfo)?this.owner.editorHistory.updateComplexHistory():this.owner.editorModule.updateComplexWithoutHistory(2),this.searchResults.clear(),i},e.prototype.replaceAllInternal=function(e,t){sf.base.isNullOrUndefined(e)||(sf.base.isNullOrUndefined(t)&&(t="None"),this.textSearchResults.length>0&&(this.navigate(this.textSearchResults.innerList[this.textSearchResults.currentIndex]),this.highlight(this.textSearchResults),this.replaceAll(e,this.textSearchResults)))},e.prototype.navigate=function(e){if(e){var t=e.start,i=e.end;sf.base.isNullOrUndefined(this.owner)||sf.base.isNullOrUndefined(this.owner.selection)||sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(t.paragraph)||sf.base.isNullOrUndefined(i.paragraph)||this.owner.selection.selectRange(t,i)}},e.prototype.highlight=function(e){this.searchHighlighters=new a;for(var t=0;t<e.innerList.length;t++){var i=e.innerList[parseInt(t.toString(),10)];this.highlightResult(i)}this.viewer.renderVisiblePages()},e.prototype.highlightResult=function(e){this.highlightSearchResult(e.start.paragraph,e.start,e.end)},e.prototype.highlightSearchResult=function(e,t,i){var r=0,n=0,o=null,s=null,a=this.documentHelper.selection.getStartLineWidget(e,t,o,r);r=a.index;var l=(o=a.element)?o.line:e.childWidgets[0],h=this.documentHelper.selection.getEndLineWidget(i,s,n);n=h.index;var d=(s=h.element)?s.line:i.paragraph.childWidgets[i.paragraph.childWidgets.length-1],c=this.documentHelper.selection.getTop(l),p=this.documentHelper.selection.getLeftInternal(l,o,r);if(sf.base.isNullOrUndefined(l)||l!==d){if(!sf.base.isNullOrUndefined(l)){e!==l.paragraph&&(e=l.paragraph);y=this.documentHelper.selection.getWidth(l,!0)-(p-l.paragraph.x);if(e.bidi||o instanceof we&&o.isRightToLeft){f=0;var u=this.documentHelper.selection.getElementsForward(l,o,s,e.bidi);if(u)for(x=!1,b=0;b<u.length;b++){M=(w=u[b])instanceof we?w.length:1;f=this.documentHelper.selection.getLeftInternal(l,w,M),x=!1,p=w===o?this.documentHelper.selection.getLeftInternal(l,w,r):this.documentHelper.selection.getLeftInternal(l,w,0),w instanceof we&&(x=w.isRightToLeft),y=Math.abs(f-p),this.createHighlightBorder(l,y,x?f:p,c)}}else this.createHighlightBorder(l,y,p,c);var g=l.paragraph.childWidgets.indexOf(l);for(b=0;b<e.childWidgets.length;b++){if(e===l.paragraph&&(g+=1),this.highlightSearchResultParaWidget(e,g,d,s,n),e===d.paragraph)return;g=0}}}else{var f=this.documentHelper.selection.getLeftInternal(d,s,n),m=!1;s instanceof we&&(m=s.isRightToLeft);var y=0;if(y=Math.abs(f-p),!m&&o instanceof we&&(m=o.isRightToLeft),m||e.bidi){var v=this.documentHelper.selection.getElementsForward(l,o,s,e.bidi);if(v&&v.length>1)for(var b=0;b<v.length;b++){var w,x=!1,M=(w=v[b])instanceof we?w.length:1;w===o?(p=this.documentHelper.selection.getLeftInternal(l,w,r),f=this.documentHelper.selection.getLeftInternal(l,w,M)):w===s?(p=this.documentHelper.selection.getLeftInternal(l,w,0),f=this.documentHelper.selection.getLeftInternal(l,w,n)):(p=this.documentHelper.selection.getLeftInternal(l,w,0),f=this.documentHelper.selection.getLeftInternal(l,w,M)),w instanceof we&&(x=w.isRightToLeft),y=Math.abs(f-p),this.createHighlightBorder(l,y,x?f:p,c)}else this.createHighlightBorder(l,y,m?f:p,c)}else this.createHighlightBorder(l,y,p,c)}},e.prototype.createHighlightBorder=function(e,t,i,r){var n=this.addSearchHighlightBorder(e),o=this.viewer.owner.selection.getPage(e.paragraph);o.boundingRectangle.y,o.boundingRectangle.x;n.left=Math.ceil(i),r=Math.ceil(r),n.width=Math.floor(t);Math.floor(e.height),this.documentHelper.containerContext},e.prototype.addSearchHighlightBorder=function(e){var t=void 0,i=this.searchHighlighters;i.containsKey(e)?t=i.get(e):(t=[],i.add(e,t));var r=new Rt(0,0);return t.push(r),r},e.prototype.highlightSearchResultParaWidget=function(e,t,i,r,n){for(var o=0,s=0,a=!1,l=t;l<e.childWidgets.length;l++){var h=e.childWidgets[l];l===t&&(o=this.documentHelper.selection.getTop(h));var d=this.documentHelper.selection.getLeft(h);if(r instanceof we&&(a=r.isRightToLeft),h===i){var c=0;if(a||e.bidi){for(var p=this.documentHelper.selection.getElementsBackward(h,r,r,e.bidi),u=0;u<p.length;u++){var g=p[u],f=!1;if(d=this.documentHelper.selection.getLeftInternal(h,g,0),g===r)c=this.documentHelper.selection.getLeftInternal(h,g,n);else{var m=g instanceof we?g.length:1;c=this.documentHelper.selection.getLeftInternal(h,g,m)}g instanceof we&&(f=g.isRightToLeft),s=Math.abs(c-d),this.createHighlightBorder(h,s,f?c:d,o)}return}return c=this.documentHelper.selection.getLeftInternal(i,r,n),s=Math.abs(c-d),void this.createHighlightBorder(h,s,a?c:d,o)}s=this.documentHelper.selection.getWidth(h,!0)-(d-e.x),this.createHighlightBorder(h,s,d,o),o+=h.height}},e.prototype.addSearchResultItems=function(e){sf.base.isNullOrUndefined(e)||""===e||(sf.base.isNullOrUndefined(this.owner.findResultsList)&&(this.owner.findResultsList=[]),this.owner.findResultsList.push(e))},e.prototype.addFindResultView=function(e){for(var t=0;t<e.innerList.length;t++){var i=e.innerList[t];this.addFindResultViewForSearch(i)}},e.prototype.addFindResultViewForSearch=function(e){if(null!=e.start&&null!=e.end&&null!=e.start.paragraph&&null!=e.end.paragraph){var t=void 0,i=0,r=e.start.currentWidget.getInline(e.start.offset,i),n=r.element;i=r.index;var o="",s=0;if(n instanceof fe){var a=this.owner.selection.getRenderedInline(n,i);a.element.nextNode instanceof we?(n=a.element.nextNode,i=a.index):(n=a.element,i=a.index)}var l=this.owner.selection.getElementBoxInternal(n,i),h=l.element;if(i=l.index,null!=h){h instanceof we&&i>0&&(o=h.text.substring(0,i));var d=h.line.children.indexOf(h);for(s=o.lastIndexOf(" ");s<0&&d>0&&h.line.children[d-1]instanceof we;)o=h.line.children[d-1].text+o,d--,s=o.lastIndexOf(" ")}var c=o.lastIndexOf("\v");c>0?o=o.substring(0,c):(s=o.lastIndexOf(" "))<0?o:o.substring(s+1),e.text;var p=0,u=e.end.currentWidget.getInline(e.end.offset,p),g=u.element;if(p=u.index,t="",null!=l&&(h=(l=this.owner.selection.getElementBoxInternal(g,p)).element,p=l.index),null!=h){h instanceof we&&p<h.length&&(t=h.text.substring(p));for(d=h.line.children.indexOf(h);d+1<h.line.children.length&&h.line.children[d+1]instanceof we||h.line.children[d+1]instanceof fe;)h.line.children[d+1]instanceof fe?d+=2:(t+=h.line.children[d+1].text,d+=1)}s=t.lastIndexOf(" "),t="\v"===t?t="":t;var f="",m="",y=e.start.paragraph.containerWidget,v=y instanceof oe?y.headerFooterType:"";-1!=v.indexOf("Header")?f='<span class="e-de-header-footer-list">Header: </span>':-1!=v.indexOf("Footer")&&(m='<li tabindex=0 class="e-de-search-result-item e-de-op-search-txt">'+f+o+'<span class="e-de-op-search-word" style="pointer-events:none">'+e.text+"</span>"+t+"</li>",f='<span class="e-de-header-footer-list">Footer: </span>'),m='<li tabindex=0 class="e-de-search-result-item e-de-op-search-txt">'+f+o+'<span class="e-de-op-search-word" style="pointer-events:none">'+e.text+"</span>"+t+"</li>",this.addSearchResultItems(m)}},e.prototype.clearSearchHighlight=function(){sf.base.isNullOrUndefined(this.searchHighlighters)||(this.searchHighlighters.clear(),this.searchHighlighters=void 0);this.viewer.owner;this.owner.dotNetRef.invokeMethodAsync("SearchResultsChange")},e.prototype.destroy=function(){this.textSearchResults&&this.textSearchResults.destroy()},e}(),_t=function(){},Vt=function(){function e(e,t){this.ownerListLevelIn=void 0,this.modifiedListLevelIn=void 0,this.ownerListLevel=e,this.modifiedListLevel=t}return Object.defineProperty(e.prototype,"ownerListLevel",{get:function(){return this.ownerListLevelIn},set:function(e){this.ownerListLevelIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"modifiedListLevel",{get:function(){return this.modifiedListLevelIn},set:function(e){this.modifiedListLevelIn=e},enumerable:!0,configurable:!0}),e.prototype.destroy=function(){this.ownerListLevel=void 0,this.modifiedListLevel=void 0},e}(),Yt=function(){function e(e,t){this.ownerFormatIn=void 0,this.modifiedFormatIn=void 0,this.ownerFormat=e,this.modifiedFormat=t}return Object.defineProperty(e.prototype,"ownerFormat",{get:function(){return this.ownerFormatIn},set:function(e){this.ownerFormatIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"modifiedFormat",{get:function(){return this.modifiedFormatIn},set:function(e){this.modifiedFormatIn=e},enumerable:!0,configurable:!0}),e.prototype.destroy=function(){this.ownerFormat=void 0,this.modifiedFormat.destroy(),this.modifiedFormat=void 0},e}(),Qt=function(){function e(e,t){this.startingPoint=e,this.rowFormat=t,this.rowHeightType=t.heightType}return e.prototype.revertChanges=function(e,t){var i=this.rowFormat.heightType;t.editorModule.tableResize.updateRowHeight(this.rowFormat.ownerBase,e?this.displacement:-this.displacement),t.documentHelper.layout.reLayoutTable(this.rowFormat.ownerBase.ownerTable),this.rowFormat.heightType!==this.rowHeightType&&(this.rowFormat.heightType=this.rowHeightType),this.rowHeightType=i},e}(),qt=function(){function e(e,t){this.tableHolder=new at,this.tableFormat=new Gt,this.rows=[],this.owner=t,this.copyProperties(e)}return e.prototype.copyProperties=function(e){e.tableHolder&&(this.tableHolder=e.tableHolder.clone()),e.tableFormat&&(this.tableFormat.leftIndent=e.tableFormat.leftIndent,this.tableFormat.preferredWidth=e.tableFormat.preferredWidth,this.tableFormat.preferredWidthType=e.tableFormat.preferredWidthType,this.tableFormat.allowAutoFit=e.tableFormat.allowAutoFit);for(var t=0;t<e.childWidgets.length;t++){var i=e.childWidgets[parseInt(t.toString(),10)],r=new Xt;r.gridBefore=i.rowFormat.gridBefore,r.gridBeforeWidth=i.rowFormat.gridBeforeWidth,r.gridBeforeWidthType=i.rowFormat.gridBeforeWidthType,r.gridAfter=i.rowFormat.gridAfter,r.gridAfterWidth=i.rowFormat.gridAfterWidth,r.gridAfterWidthType=i.rowFormat.gridAfterWidthType;for(var n=0;n<i.childWidgets.length;n++){var o=i.childWidgets[parseInt(n.toString(),10)],s=new Zt;s.columnIndex=o.columnIndex,s.columnSpan=o.cellFormat.columnSpan,s.preferredWidth=o.cellFormat.preferredWidth,s.preferredWidthType=o.cellFormat.preferredWidthType,r.cells.push(s)}this.rows.push(r)}this.tableHierarchicalIndex=this.owner.selection.getHierarchicalIndex(e,"0")},e.prototype.destroy=function(){this.tableHierarchicalIndex=void 0,this.tableHolder&&(this.tableHolder.destroy(),this.tableHolder=void 0),this.tableFormat&&(this.tableFormat=null),this.rows&&(this.rows=[],this.rows=void 0)},e}(),Gt=function(){},Xt=function(){this.cells=[]},Zt=function(){},Kt=function(){function e(e){this.ownerIn=e,this.documentHelper=e.documentHelper,this.modifiedPropertiesIn=[],this.modifiedNodeLength=[],this.removedNodesIn=[]}return Object.defineProperty(e.prototype,"owner",{get:function(){return this.ownerIn},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"editorHistory",{get:function(){return this.owner.editorHistory},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"action",{get:function(){return this.actionIn},set:function(e){this.actionIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"modifiedProperties",{get:function(){return this.modifiedPropertiesIn},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"removedNodes",{get:function(){return this.removedNodesIn},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selectionStart",{get:function(){return this.selectionStartIn},set:function(e){this.selectionStartIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selectionEnd",{get:function(){return this.selectionEndIn},set:function(e){this.selectionEndIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"insertPosition",{get:function(){return this.insertPositionIn},set:function(e){this.insertPositionIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"endPosition",{get:function(){return this.endPositionIn},set:function(e){this.endPositionIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"viewer",{get:function(){return this.ownerIn.viewer},enumerable:!0,configurable:!0}),e.prototype.updateSelection=function(){var e=this.owner.selection.getParagraphInfo(this.owner.selection.start);this.selectionStart=this.owner.selection.getHierarchicalIndex(e.paragraph,e.offset.toString()),e=this.owner.selection.getParagraphInfo(this.owner.selection.end),this.selectionEnd=this.owner.selection.getHierarchicalIndex(e.paragraph,e.offset.toString())},e.prototype.setBookmarkInfo=function(e){this.removedNodes.push({bookmark:e,startIndex:e.indexInOwner,endIndex:e.reference.indexInOwner})},e.prototype.setFormFieldInfo=function(e,t){this.removedNodes.push({formField:e,value:t})},e.prototype.setEditRangeInfo=function(e){this.removedNodes.push({editStart:e,startIndex:e.indexInOwner,endIndex:e.editRangeEnd.indexInOwner})},e.prototype.revertFormTextFormat=function(){var e=this.removedNodes[0],t=e.value,i=e.formField;this.editorHistory.isUndoing?(this.owner.editorModule.applyTextFormatInternal(i,t),this.editorHistory.recordChanges(this)):(t=x.formatText(i.formFieldData.format,t),this.owner.editorModule.applyTextFormatInternal(i,t),this.editorHistory.undoStack.push(this))},e.prototype.revertFormField=function(){var e=this.removedNodes[0],t=e.formField;t.formFieldData instanceof ve?this.owner.editorModule.toggleCheckBoxFormField(t,!0,e.value):this.owner.editorModule.updateFormField(t,e.value)},e.prototype.revertBookmark=function(){var e=this.removedNodes[0],t=e.bookmark;if(this.editorHistory.isUndoing){this.documentHelper.bookmarks.add(t.name,t),t.line.children.splice(e.startIndex,0,t);var i=t.previousNode;i instanceof fe&&!sf.base.isNullOrUndefined(i.formFieldData)&&(i.formFieldData.name=t.name),t.reference.line.children.splice(e.endIndex,0,t.reference),this.editorHistory.recordChanges(this)}else this.owner.editorModule.deleteBookmarkInternal(t),this.editorHistory.undoStack.push(this)},e.prototype.revertComment=function(){var e=this.insertPosition,t=this.removedNodes[0],i=!1;if("InsertCommentWidget"===this.action?i=this.editorHistory.isRedoing:"DeleteCommentWidget"===this.action&&(i=this.editorHistory.isUndoing),i)t&&(t.isReply?this.owner.editor.addReplyComment(t,this.insertPosition):this.owner.editor.addCommentWidget(t,!1,!0,!0));else{var r=this.owner.editor.getCommentElementBox(e);this.owner.editor.deleteCommentWidget(r)}},e.prototype.revertEditRangeRegion=function(){var e=this.removedNodes[0],t=e.editStart;if(this.editorHistory.isUndoing){var i=""===t.user?t.group:t.user;this.owner.editor.updateRangeCollection(t,i),t.line.children.splice(e.startIndex,0,t),t.editRangeEnd.line.children.splice(e.endIndex,0,t.editRangeEnd),this.editorHistory.recordChanges(this)}else this.owner.editorModule.removeUserRestrictionsInternal(t),this.editorHistory.undoStack.push(this);this.owner.editor.fireContentChange()},e.prototype.revert=function(){if("FormTextFormat"!==this.action)if("UpdateFormField"!==this.action)if("DeleteBookmark"!==this.action)if("RemoveEditRange"!==this.action)if("InsertCommentWidget"!==this.action&&"DeleteCommentWidget"!==this.action){if("ListFormat"===this.action&&""!==this.owner.editor.listNumberFormat){var e=this.documentHelper.lists[0].abstractList.levels[this.owner.editor.listLevelNumber],t=e.listLevelPattern,i=e.numberFormat;e.listLevelPattern=this.owner.editor.listLevelPattern,e.numberFormat=this.owner.editor.listNumberFormat,this.owner.editor.listLevelPattern=t,this.owner.editor.listNumberFormat=i}this.owner.isShiftingEnabled=!0;var r=void 0,n=void 0,o=this.selectionStart,s=this.selectionEnd,a=Ft.isForwardSelection(o,s);if(this.modifiedProperties.length>0||"Selection"===this.action||"ClearCharacterFormat"===this.action||"ClearParagraphFormat"===this.action)r=this.owner.selection.getTextPosBasedOnLogicalIndex(o),n=this.owner.selection.getTextPosBasedOnLogicalIndex(s),this.revertModifiedProperties(r,n);else{var l=this.owner.selection,h=this.removedNodes;this.removedNodesIn=[],sf.base.isNullOrUndefined(this.endPosition)&&(this.endPosition=this.insertPosition);var d=Ft.isForwardSelection(this.insertPosition,this.endPosition),c=l.getTextPosBasedOnLogicalIndex(d?this.insertPosition:this.endPosition),p=l.getTextPosBasedOnLogicalIndex(d?this.endPosition:this.insertPosition);if(this.lastElementRevision&&this.editorHistory.isUndoing&&sf.base.isNullOrUndefined(this.endRevisionLogicalIndex)&&this.updateEndRevisionInfo(),"ClearRevisions"===this.action&&(this.undoRevisionForElements(c,p,h[h.length-1]),h=[]),"Uppercase"===this.action){l.selectPosition(c,p),this.editorHistory.currentBaseHistoryInfo=this;var u=this.owner.editorModule;return u.changeSelectedTextCase(l,c,p,this.action.toString(),h),void u.reLayout(l)}if(c.isAtSamePosition(p)?l.selectContent(c,!0):l.selectPosition(c,p),"InsertHyperlink"===this.action&&this.editorHistory.isRedoing){var g=this.owner.selection.getHyperlinkField();if(!sf.base.isNullOrUndefined(g)){var f=g.line.getOffset(g,0);c.setPositionParagraph(g.line,f),this.owner.selection.start.setPositionInternal(c),f=g.fieldEnd.line.getOffset(g.fieldEnd,1),p.setPositionParagraph(g.fieldEnd.line,f)}}this.editorHistory.currentBaseHistoryInfo=this,this.selectionStart=this.insertPosition,this.insertPosition=void 0,this.selectionEnd=this.endPosition,this.endPosition=void 0;var m=!1;if(this.endRevisionLogicalIndex&&h.length>0){if(this.editorHistory.isUndoing||this.editorHistory.isRedoing&&c.isAtSamePosition(p)){var y=l.getTextPosBasedOnLogicalIndex(this.endRevisionLogicalIndex);l.selectPosition(c,y)}this.editorHistory.isUndoing&&this.owner.editor.deleteSelectedContents(l,!0)}if(!c.isAtSamePosition(p)){m="BackSpace"===this.action||"Delete"===this.action||"ClearCells"===this.action||"DeleteCells"===this.action;var v=h.length>0&&"ParaMarkTrack"===this.action||"ClearRevisions"===this.action||"AcceptTOC"===this.action;m||"MergeCells"===this.action||"InsertRowAbove"===this.action||"InsertRowBelow"===this.action||"InsertColumnLeft"===this.action||"InsertColumnRight"===this.action||"Borders"===this.action||"DeleteTable"===this.action||"DeleteColumn"===this.action||"DeleteRow"===this.action||(l.end.setPositionInternal(p),this.owner.selection.isEmpty||v||(this.editorHistory.isRedoing&&"Accept Change"!==this.action&&"ParaMarkTrack"!==this.action&&"ParaMarkReject"!==this.action&&"RemoveRowTrack"!==this.action?this.owner.editorModule.removeSelectedContents(l):this.owner.editorModule.deleteSelectedContents(l,!0),!sf.base.isNullOrUndefined(this.editorHistory.currentHistoryInfo)&&"PageBreak"===this.editorHistory.currentHistoryInfo.action&&this.documentHelper.blockToShift&&this.documentHelper.layout.shiftLayoutedItems(!1)))}var b=this.editorHistory.isRedoing&&!m;m=!this.lastElementRevision&&m,this.revertModifiedNodes(h,b,a?o:s,o===s),m&&this.removeContent(c,p)}var w=!1,x=!1;sf.base.isNullOrUndefined(this.editorHistory.currentHistoryInfo)||"Reject All"!==this.editorHistory.currentHistoryInfo.action&&"Accept All"!==this.editorHistory.currentHistoryInfo.action&&"Paste"!==this.editorHistory.currentHistoryInfo.action||(x=!0),(!this.owner.trackChangesPane.isTrackingPageBreak&&((this.editorHistory.isUndoing||this.endRevisionLogicalIndex||"RemoveRowTrack"===this.action||x)&&sf.base.isNullOrUndefined(this.editorHistory.currentHistoryInfo)||x)||("InsertRowAbove"===this.action||"Borders"===this.action||"InsertRowBelow"===this.action||"InsertColumnLeft"===this.action||"InsertColumnRight"===this.action||"Accept Change"===this.action)&&(this.editorHistory.isRedoing||"Paste"===this.editorHistory.currentHistoryInfo.action))&&("RemoveRowTrack"===this.action&&this.editorHistory.isRedoing?(r=this.owner.selection.getTextPosBasedOnLogicalIndex(this.selectionStart),n=this.owner.selection.getTextPosBasedOnLogicalIndex(this.selectionEnd)):(r=this.owner.selection.getTextPosBasedOnLogicalIndex(o),n=this.owner.selection.getTextPosBasedOnLogicalIndex(s)),this.owner.selection.selectRange(r,n),w=!0),this.owner.trackChangesPane.isTrackingPageBreak=!1,this.insertPosition=o,this.endPosition=s,sf.base.isNullOrUndefined(this.editorHistory.currentHistoryInfo)||"Accept All"!==this.editorHistory.currentHistoryInfo.action&&"Reject All"!==this.editorHistory.currentHistoryInfo.action||this.owner.documentHelper.blockToShift&&this.owner.documentHelper.layout.shiftLayoutedItems(!1),this.owner.editorModule.reLayout(this.owner.selection,this.owner.selection.isEmpty),this.editorHistory.isUndoing&&"SectionBreak"===this.action&&this.owner.editorModule.layoutWholeDocument(),w&&this.documentHelper.scrollToPosition(this.owner.selection.start,this.owner.selection.end),this.highlightListText()}else this.revertComment();else this.revertEditRangeRegion();else this.revertBookmark();else this.revertFormField();else this.revertFormTextFormat()},e.prototype.highlightListText=function(){if(!sf.base.isNullOrUndefined(this.editorHistory.currentHistoryInfo)&&("ListCharacterFormat"===this.action||"ListSelect"===this.editorHistory.currentHistoryInfo.action&&"ListFormat"===this.action)){var e=this.owner.selection.getTextPosBasedOnLogicalIndex(this.selectionStart).currentWidget;this.documentHelper.selection.highlightListText(e)}},e.prototype.removeContent=function(e,t){if(!sf.base.isNullOrUndefined(e.paragraph.containerWidget)&&e.paragraph.containerWidget instanceof ne&&!sf.base.isNullOrUndefined(t.paragraph.containerWidget)&&t.paragraph.containerWidget instanceof ne||!sf.base.isNullOrUndefined(e.paragraph.containerWidget)&&!sf.base.isNullOrUndefined(t.paragraph.containerWidget)&&e.paragraph.containerWidget instanceof pe&&t.paragraph.containerWidget instanceof pe&&!sf.base.isNullOrUndefined(e.paragraph.bodyWidget)||!sf.base.isNullOrUndefined(e.paragraph.containerWidget)&&!sf.base.isNullOrUndefined(t.paragraph.containerWidget)&&e.paragraph.containerWidget instanceof ze&&t.paragraph.containerWidget instanceof ze){this.owner.selection.selectRange(e,t);var i=!1;"BackSpace"!==this.action&&"Uppercase"!==this.action&&"RemoveRowTrack"!==this.action||(i=!0),this.owner.editorModule.deleteSelectedContents(this.owner.selection,i)}},e.prototype.updateEndRevisionInfo=function(){this.lastElementRevision=this.checkAdjacentNodeForMarkedRevision(this.lastElementRevision);var e=this.retrieveEndPosition(this.lastElementRevision),t=this.owner.selection.getParagraphInfo(e);this.endRevisionLogicalIndex=this.owner.selection.getHierarchicalIndex(t.paragraph,t.offset.toString()),this.lastElementRevision.isMarkedForRevision=!1},e.prototype.retrieveEndPosition=function(e){var t=new Ft(this.owner),i=e.line.getOffset(e,0)+e.length;return t.setPositionFromLine(e.line,i),t},e.prototype.checkAdjacentNodeForMarkedRevision=function(e){for(var t,i=e.nextNode;!sf.base.isNullOrUndefined(i)&&i.isMarkedForRevision;)t=i,i=i.nextNode;return sf.base.isNullOrUndefined(t)?e:t},e.prototype.revertModifiedProperties=function(e,t){"CellFormat"!==this.action&&"CellOptions"!==this.action&&"TableOptions"!==this.action||(this.owner.isShiftingEnabled=!1),this.owner.selection.selectRange(e,t),"RowResizing"===this.action||"CellResizing"===this.action?this.revertResizing():"CellOptions"===this.action||"TableOptions"===this.action?this.revertTableDialogProperties(this.action):"Selection"!==this.action&&this.revertProperties()},e.prototype.redoAction=function(){var e=this.owner.editorModule;switch(this.action){case"BackSpace":e.singleBackspace(this.owner.selection,!0);break;case"Delete":e.singleDelete(this.owner.selection,!0);break;case"DeleteTable":e.deleteTable();break;case"DeleteColumn":e.deleteColumn();break;case"DeleteRow":e.deleteRow();break;case"MergeCells":e.mergeSelectedCellsInTable();break;case"InsertRowAbove":e.insertRow(!0);break;case"InsertRowBelow":e.insertRow(!1);break;case"InsertColumnLeft":case"InsertColumnRight":e.insertColumn(!0);break;case"SectionBreak":case"SectionBreakContinuous":e.insertSection(this.owner.selection,!0);break;case"TableAutoFitToContents":e.autoFitTable("FitToContents");break;case"TableAutoFitToWindow":e.autoFitTable("FitToWindow");break;case"TableFixedColumnWidth":e.autoFitTable("FixedColumnWidth");break;case"RemoveRowTrack":this.owner.selection.handleAcceptReject(!0)}},e.prototype.revertModifiedNodes=function(e,t,i,r){if((!t||"BackSpace"!==this.action&&"Delete"!==this.action&&"DeleteTable"!==this.action&&"DeleteColumn"!==this.action&&"DeleteRow"!==this.action&&"InsertRowAbove"!==this.action&&"InsertRowBelow"!==this.action&&"InsertColumnLeft"!==this.action&&"InsertColumnRight"!==this.action&&"MergeCells"!==this.action&&"SectionBreak"!==this.action&&"SectionBreakContinuous"!==this.action&&"TableAutoFitToContents"!==this.action&&"TableAutoFitToWindow"!==this.action&&"TableFixedColumnWidth"!==this.action||(this.redoAction(),"SectionBreak"!==this.action&&"SectionBreakContinuous"!==this.action))&&e.length>0)if(this.editorHistory.isUndoing&&("RemoveRowTrack"===this.action||"DeleteCells"===this.action||"DeleteColumn"===this.action||"DeleteRow"===this.action||"MergeCells"===this.action)||"InsertRowAbove"===this.action||"InsertRowBelow"===this.action||"InsertColumnLeft"===this.action||"ClearCells"===this.action||"InsertColumnRight"===this.action||"Borders"===this.action||"TableAutoFitToContents"===this.action||"TableAutoFitToWindow"===this.action||"TableFixedColumnWidth"===this.action||"RemoveRowTrack"===this.action){var n=this.selectionStart,o=this.owner.editorModule.getBlock({index:n}).node,s=e[e.length-1];(o instanceof de||o.previousRenderedWidget instanceof de||o.isInsideTable)&&s instanceof de?(o instanceof le&&!o.isInsideTable?o=o.previousRenderedWidget:o instanceof le&&o.isInsideTable&&(o=o.associatedCell.ownerTable),o=o.combineWidget(this.viewer),this.owner.editorModule.insertTableInternal(o,s,!1),e.splice(e.indexOf(s),1)):s instanceof de&&this.owner.editorModule.insertBlock(s)}else{var a=i;o=this.owner.editorModule.getBlock({index:a}).node;if(e.length>0&&("BackSpace"===this.action&&r||!(o instanceof de)&&!(o instanceof oe))){if((s=e[0])instanceof ne&&!sf.base.isNullOrUndefined(e[1])&&(s=e[1]),("TrackingPageBreak"===this.action||("SectionBreak"===this.action||"SectionBreakContinuous"===this.action)&&s instanceof ne||!sf.base.isNullOrUndefined(this.editorHistory.currentHistoryInfo)&&"PageBreak"===this.editorHistory.currentHistoryInfo.action)&&(s=e[1]),s instanceof le&&this.owner.selection.start.offset>0&&(this.owner.editorModule.insertNewParagraphWidget(s,!0),s.characterFormat.removedIds.length>0&&this.owner.editor.constructRevisionFromID(s.characterFormat,void 0),e.splice(e.indexOf(s),1),sf.base.isNullOrUndefined(o))){var l=this.documentHelper.selection.getNextParagraphBlock(s.getSplitWidgets().pop());this.owner.selection.getNextRenderedBlock(s);var h=this.owner.selection.start.paragraph;!(l&&h&&h.bodyWidget instanceof ne)||h.isInsideTable||this.owner.selection.isinEndnote||this.owner.selection.isinFootnote||h.bodyWidget.equals(l.bodyWidget)||(l=void 0),sf.base.isNullOrUndefined(l)&&this.owner.selection.selectParagraphInternal(s,!0)}if(s instanceof de&&this.owner.selection.start.offset>0){var d=e[e.length-1];if(d instanceof le&&(this.owner.editorModule.insertNewParagraphWidget(d,!0),e.splice(e.indexOf(d),1),sf.base.isNullOrUndefined(o))){l=this.documentHelper.selection.getNextParagraphBlock(d.getSplitWidgets().pop());sf.base.isNullOrUndefined(l)&&this.owner.selection.selectParagraphInternal(d,!0)}}}if(e.length>0){var c=e[e.length-1];if(o instanceof de&&(o=o.combineWidget(this.viewer),c instanceof de)){this.owner.editorModule.insertTableInternal(o,c,!0),e.splice(e.indexOf(c),1),this.insertPosition=i;var p=c.getSplitWidgets().pop();p.nextRenderedWidget instanceof de?o=p.nextRenderedWidget:(a=i,o=this.owner.editorModule.getBlock({index:a}).node)}if(c instanceof le&&this.owner.selection.start.offset>0&&this.owner.selection.start.offset===this.owner.selection.getLineLength(this.owner.selection.start.paragraph.lastChild)){var u=this.owner.editorModule;u.insertNewParagraphWidget(c,!1),c.characterFormat.removedIds.length>0&&this.owner.editor.constructRevisionFromID(c.characterFormat,void 0),e.splice(e.indexOf(c),1),"Paste"!==this.action&&u.removeBlock(this.owner.selection.start.paragraph);var g=this.documentHelper.selection.getNextParagraphBlock(c.getSplitWidgets().pop());sf.base.isNullOrUndefined(g)||this.owner.selection.selectParagraphInternal(g,!0)}else if(e[0]instanceof de&&1!==e.length){var f=e[1];f instanceof le&&f.isEmpty()&&e.splice(e.indexOf(f),1)}}e.length>0&&(o instanceof de&&(o=o.combineWidget(this.viewer)),this.insertRemovedNodes(e,o))}},e.prototype.insertRemovedNodes=function(e,t){for(var i=e.length-1;i>-1;i--){var r=e[i];if(r instanceof ge)this.owner.editorModule.insertInlineInSelection(this.owner.selection,r);else if(r instanceof se)r instanceof ce?t instanceof de&&(t.childWidgets.splice(0,0,r),this.owner.editorModule.updateNextBlocksIndex(r,!0),0!==i&&e[i-1]instanceof ce||this.documentHelper.layout.layoutBodyWidgetCollection(t.index,t.containerWidget,t,!1)):t instanceof de?this.owner.editorModule.insertBlockTable(this.owner.selection,r,t):this.owner.editorModule.insertBlock(r);else if(r instanceof P){var n=this.selectionStart,o=this.owner.editorModule.getBlock({index:n}).node;o instanceof le&&(r.removedIds.length>0?(o.characterFormat.removedIds=r.removedIds.slice(),this.owner.editor.constructRevisionFromID(o.characterFormat,!0)):o.characterFormat.revisions.length>0&&(o.characterFormat=r.cloneFormat()))}else if(r instanceof ne)sf.base.isNullOrUndefined(r.removedHeaderFooters)||0===r.removedHeaderFooters.length||(this.owner.documentHelper.headersFooters.splice(r.sectionIndex,0,r.removedHeaderFooters[0]),r.removedHeaderFooters=void 0),this.owner.editorModule.insertSection(this.owner.selection,!1,!0);else if("string"==typeof r&&"AcceptTOC"===this.action){n=this.selectionStart;var s=this.owner.editorModule.getBlock({index:n}).node,a=this.owner.editorModule.getBlock({index:this.selectionEnd}).node,l=this.owner.documentHelper.revisionsInternal.get(r);if(this.editorHistory.isUndoing){for(;s instanceof le&&s!==a;)this.owner.editor.insertRevisionForBlock(s,l.revisionType,!0,l),s=this.documentHelper.selection.getNextParagraphBlock(s.getSplitWidgets().pop());this.owner.editor.insertRevisionForBlock(a,l.revisionType,!0,l)}else for(;l.range.length>0;){var h=l.range[0],d=h.revisions.indexOf(l);if(d>=0){h.revisions.splice(d,1);var c=l.range.indexOf(h);l.range.splice(c,1)}0===l.range.length&&this.owner.revisions.remove(l)}this.owner.editor.addRemovedNodes(l.revisionID)}}e=[]},e.prototype.undoRevisionForElements=function(e,t,i){var r=e.paragraph,n=t.paragraph,o=this.documentHelper.revisionsInternal.get(i),s=this.owner.selection.getParagraphInfo(e).offset,a=this.owner.selection.getParagraphInfo(t).offset,l=e.paragraph===t.paragraph;if(this.editorHistory.isUndoing){for(;r!==n;)this.owner.editor.applyRevisionForCurrentPara(r,s,r.getLength(),i,!0),(r=this.documentHelper.selection.getNextParagraphBlock(r.getSplitWidgets().pop()))!==n&&(s=0);r===n&&(l||(s=0),this.owner.editor.applyRevisionForCurrentPara(r,s,a,i,!1))}else for(;o.range.length>0;){var h=o.range[0],d=h.revisions.indexOf(o);if(d>=0){h.revisions.splice(d,1);var c=o.range.indexOf(h);o.range.splice(c,1)}0===o.range.length&&this.owner.revisions.remove(o)}this.removedNodes.push(i)},e.prototype.revertResizing=function(){if(this.editorHistory.currentBaseHistoryInfo=this,"RowResizing"===this.action)this.modifiedProperties[0]instanceof Qt&&this.modifiedProperties[0].revertChanges(this.editorHistory.isRedoing,this.owner);else if(this.modifiedProperties[0]instanceof qt){0===this.owner.selection.selectedWidgets.length&&this.owner.selection.highlightSelection(!0);var e=this.modifiedProperties[0],t=e.tableHierarchicalIndex,i=this.owner.editorModule.getBlock({index:t}).node;if(i instanceof de){var r=this.owner.editorModule.tableResize;if(this.owner.editor.setOffsetValue(this.owner.selection),i=i.combineWidget(this.owner.viewer),r.currentResizingTable=i,this.modifiedProperties.splice(0,1),this.editorHistory.isUndoing||this.editorHistory.isRedoing){var n=new qt(i,this.owner);this.modifiedProperties.splice(0,0,n),this.owner.isLayoutEnabled=!1,r.applyProperties(r.currentResizingTable,e),r.currentResizingTable.isGridUpdated=!0,this.owner.isLayoutEnabled=!0,r.updateGridValue(r.currentResizingTable,!1),e.destroy(),e=void 0}}}},e.prototype.revertTableDialogProperties=function(e){if(this.owner.isShiftingEnabled=!1,this.editorHistory.currentBaseHistoryInfo=this,this.currentPropertyIndex=0,"CellOptions"===e){var t=this.owner.selection,i=this.modifiedProperties[0];this.owner.editorModule.updateCellMargins(t,i)}this.currentPropertyIndex=0,this.owner.isShiftingEnabled=!0},e.prototype.addModifiedPropertiesForSection=function(e,t,i){if(this.editorHistory.isUndoing||this.editorHistory.isRedoing){var r=this.modifiedProperties,n=this.currentPropertyIndex<r.length?r[this.currentPropertyIndex]:r[r.length-1];sf.base.isNullOrUndefined(t)?(i=n,this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]=e.cloneFormat():this.modifiedProperties[this.modifiedProperties.length-1]=e.cloneFormat()):(i=n.getPropertyValue(t),n.copyFormat(e)),this.currentPropertyIndex++}else if(sf.base.isNullOrUndefined(t))this.modifiedProperties.push(e.cloneFormat());else{var o=new d;o.copyFormat(e),this.modifiedProperties.push(o)}return i},e.prototype.addModifiedProperties=function(e,t,i){if(this.editorHistory.isUndoing||this.editorHistory.isRedoing){var r=this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]:this.modifiedProperties[this.modifiedProperties.length-1],n=!1;if(e.ownerBase instanceof ge){var o=this.modifiedNodeLength[this.currentPropertyIndex];if(e.ownerBase.length<o){n=!0,this.modifiedNodeLength[this.currentPropertyIndex]=e.ownerBase.length,this.modifiedNodeLength.splice(this.currentPropertyIndex+1,0,o-e.ownerBase.length);var s=new P(void 0);s.copyFormat(r),this.modifiedProperties.splice(this.currentPropertyIndex+1,0,s)}}"ClearCharacterFormat"===this.action?this.editorHistory.isUndoing?(i=r,n||(this.modifiedProperties.splice(this.currentPropertyIndex,1),this.currentPropertyIndex--)):this.modifiedProperties.push(e.cloneFormat()):(i=r,this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]=e.cloneFormat():this.modifiedProperties[this.modifiedProperties.length-1]=e.cloneFormat()),this.currentPropertyIndex++}else{if(sf.base.isNullOrUndefined(t))this.modifiedProperties.push(e.cloneFormat());else{var a=new P(void 0);a.copyFormat(e),this.modifiedProperties.push(a)}e.ownerBase instanceof ge?this.modifiedNodeLength.push(e.ownerBase.length):this.modifiedNodeLength.push(0)}return i},e.prototype.addModifiedPropertiesForParagraphFormat=function(e,t,i){if(this.editorHistory.isUndoing||this.editorHistory.isRedoing){var r=this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]:this.modifiedProperties[this.modifiedProperties.length-1];if("ClearParagraphFormat"===this.action)return this.editorHistory.isUndoing?(i=r,this.modifiedProperties.splice(this.currentPropertyIndex,1),this.currentPropertyIndex--):this.modifiedProperties.push(e.cloneFormat()),this.currentPropertyIndex++,i;if(sf.base.isNullOrUndefined(t))return i=r,this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]=e.cloneFormat():this.modifiedProperties[this.modifiedProperties.length-1]=e.cloneFormat(),this.currentPropertyIndex++,i;if("listFormat"===t)return(i=new ct(void 0)).copyFormat(r),r.listFormat=new m(r),r.listFormat.copyFormat(e.listFormat),this.currentPropertyIndex++,i;if("styleName"===t)return sf.base.isNullOrUndefined(r.baseStyle)?void(sf.base.isNullOrUndefined(e.baseStyle)||(r.baseStyle=new gt,r.baseStyle.copyStyle(e.baseStyle))):((i=new gt).copyStyle(r.baseStyle),this.currentPropertyIndex++,sf.base.isNullOrUndefined(e.baseStyle)||(r.baseStyle=new gt,r.baseStyle.copyStyle(e.baseStyle)),i);i="borders"===t?r.borders.cloneFormat():this.action.indexOf("Border")>=0?r.borders.getBorder(t.replace("Border","")):r.getPropertyValue(t),r.copyFormat(e),this.currentPropertyIndex++}else if(sf.base.isNullOrUndefined(t))this.modifiedProperties.push(e.cloneFormat());else{var n=new ct(void 0);n.copyFormat(e),this.modifiedProperties.push(n)}return i},e.prototype.addModifiedPropertiesForContinueNumbering=function(e,t){if(this.editorHistory.isUndoing||this.editorHistory.isRedoing)return t=this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]:this.modifiedProperties[this.modifiedProperties.length-1],this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]=e.cloneFormat():this.modifiedProperties[this.modifiedProperties.length-1]=e.cloneFormat(),this.currentPropertyIndex++,t;var i=new ct;return i.copyFormat(e),this.modifiedProperties.push(i),t},e.prototype.addModifiedPropertiesForRestartNumbering=function(e,t){return this.editorHistory.isUndoing||this.editorHistory.isRedoing?(t=this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]:this.modifiedProperties[this.modifiedProperties.length-1],this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]=e.listId:this.modifiedProperties[this.modifiedProperties.length-1]=e.listId,this.currentPropertyIndex++,t):(this.modifiedProperties.push(e.listId),t)},e.prototype.addModifiedPropertiesForList=function(e){var t;if(this.editorHistory.isUndoing||this.editorHistory.isRedoing){var i=this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]:this.modifiedProperties[this.modifiedProperties.length-1];t=i,i=new Vt(e,this.owner.editorModule.cloneListLevel(e)),this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]=i:this.modifiedProperties[this.modifiedProperties.length-1]=i,this.currentPropertyIndex++}else this.modifiedProperties.push(new Vt(e,this.owner.editorModule.cloneListLevel(e))),t=e;return t},e.prototype.revertProperties=function(){this.editorHistory.currentBaseHistoryInfo=this,this.currentPropertyIndex=0;var e=this.getProperty();if(this.viewer.owner.editorModule.setOffsetValue(this.documentHelper.selection),"ClearCharacterFormat"===this.action||this.modifiedProperties[0]instanceof P){if("ListCharacterFormat"===this.action)return void this.owner.editorModule.updateListCharacterFormat(this.documentHelper.selection,e,void 0);this.owner.editorModule.updateSelectionCharacterFormatting(e,void 0,!1)}else if("ClearParagraphFormat"===this.action||this.modifiedProperties[0]instanceof ct){if("ContinueNumbering"===this.action)return void this.owner.editorModule.revertContinueNumbering(this.owner.selection,this.modifiedProperties[0]);if("StyleName"===this.action&&this.modifiedProperties[0]instanceof ct)return void this.owner.editorModule.updateSelectionParagraphFormatting(e,this.modifiedProperties[0].baseStyle,!1);this.owner.editor.setPreviousBlockToLayout(),this.owner.editorModule.updateSelectionParagraphFormatting(e,void 0,!1)}else if(this.modifiedProperties[0]instanceof d)this.owner.editorModule.updateSectionFormat(e,void 0);else{if("RestartNumbering"===this.action)return void this.owner.editorModule.restartListAtInternal(this.owner.selection,this.modifiedProperties[0]);if(this.modifiedProperties[0]instanceof zt)this.owner.selection.updateImageSize(this.modifiedProperties[0]);else if(this.modifiedProperties[0]instanceof Vt){for(var t=new a,i=0;i<this.modifiedProperties.length;i++){var r=this.modifiedProperties[i];t.add(i,r)}this.editorHistory.updateListChanges(t),t.destroy(),t=void 0}else this.modifiedProperties[0]instanceof vt?this.owner.editorModule.updateTableFormat(this.owner.selection,e,void 0):this.modifiedProperties[0]instanceof bt?(this.owner.isShiftingEnabled=!0,this.owner.editorModule.updateCellFormat(this.owner.selection,e,void 0)):this.modifiedProperties[0]instanceof C&&this.owner.editorModule.updateRowFormat(this.owner.selection,e,void 0)}this.currentPropertyIndex=0,"ClearCharacterFormat"!==this.action&&"ClearParagraphFormat"!==this.action||this.owner.editorModule.getOffsetValue(this.documentHelper.selection)},e.prototype.addModifiedCellOptions=function(e,t,i){var r;return r=sf.base.isNullOrUndefined(e.bottomMargin)&&sf.base.isNullOrUndefined(e.topMargin)&&sf.base.isNullOrUndefined(e.rightMargin)&&sf.base.isNullOrUndefined(e.leftMargin)?this.copyCellOptions(i.tableFormat):this.copyCellOptions(e),this.editorHistory.isUndoing||this.editorHistory.isRedoing?(t=this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]:this.modifiedProperties[this.modifiedProperties.length-1],this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]=this.copyCellOptions(e):this.modifiedProperties[this.modifiedProperties.length-1]=this.copyCellOptions(e),this.currentPropertyIndex++,t):(this.modifiedProperties.push(r),t)},e.prototype.copyCellOptions=function(e){var t=new bt;return t.topMargin=e.topMargin,t.rightMargin=e.rightMargin,t.bottomMargin=e.bottomMargin,t.leftMargin=e.leftMargin,t},e.prototype.addModifiedTableOptions=function(e){var t=this.copyTableOptions(e);if(this.editorHistory.isUndoing||this.editorHistory.isRedoing){this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]:this.modifiedProperties[this.modifiedProperties.length-1];this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties.splice(this.currentPropertyIndex,1,t):this.modifiedProperties.splice(this.modifiedProperties.length-1,1,t),this.currentPropertyIndex++}else this.modifiedProperties.push(t)},e.prototype.copyTableOptions=function(e){var t=new vt;return t.topMargin=e.topMargin,t.rightMargin=e.rightMargin,t.bottomMargin=e.bottomMargin,t.leftMargin=e.leftMargin,t.cellSpacing=e.cellSpacing,t},e.prototype.getProperty=function(){switch(this.action){case"Bold":return"bold";case"Italic":return"italic";case"FontColor":return"fontColor";case"FontFamily":return"fontFamily";case"FontSize":return"fontSize";case"HighlightColor":return"highlightColor";case"BaselineAlignment":return"baselineAlignment";case"Strikethrough":return"strikethrough";case"Underline":return"underline";case"AfterSpacing":return"afterSpacing";case"BeforeSpacing":return"beforeSpacing";case"LeftIndent":return"leftIndent";case"RightIndent":return"rightIndent";case"FirstLineIndent":return"firstLineIndent";case"LineSpacingType":return"lineSpacingType";case"LineSpacing":return"lineSpacing";case"TextAlignment":return"textAlignment";case"ListFormat":return"listFormat";case"PageHeight":return"pageHeight";case"PageWidth":return"pageWidth";case"DifferentOddAndEvenPages":return"differentOddAndEvenPages";case"TableAlignment":return"tableAlignment";case"TableLeftIndent":return"leftIndent";case"DefaultCellSpacing":return"cellSpacing";case"LeftMargin":case"CellLeftMargin":case"DefaultCellLeftMargin":return"leftMargin";case"RightMargin":case"CellRightMargin":case"DefaultCellRightMargin":return"rightMargin";case"TopMargin":case"CellTopMargin":case"DefaultCellTopMargin":return"topMargin";case"BottomMargin":case"CellBottomMargin":case"DefaultCellBottomMargin":return"bottomMargin";case"CellContentVerticalAlignment":return"verticalAlignment";case"RowHeight":return"height";case"RowHeightType":return"heightType";case"RowHeader":return"isHeader";case"AllowBreakAcrossPages":return"allowBreakAcrossPages";case"TablePreferredWidth":case"CellPreferredWidth":return"preferredWidth";case"TablePreferredWidthType":case"CellPreferredWidthType":return"preferredWidthType";case"Shading":return"shading";case"StyleName":return"styleName";case"ParagraphBidi":case"TableBidi":return"bidi";case"ContextualSpacing":return"contextualSpacing";case"LeftBorder":case"TopBorder":case"RightBorder":case"BottomBorder":case"HorizontalBorder":case"VerticalBorder":case"Borders":return this.action[0].toLowerCase()+this.action.slice(1)}},e.prototype.getCharacterPropertyValue=function(e,t){var i;return"bold"===e?i=t.bold:"italic"===e?i=t.italic:"fontColor"===e?i=t.fontColor:"fontFamily"===e?i=t.fontFamily:"fontSize"===e?i=t.fontSize:"highlightColor"===e?i=t.highlightColor:"baselineAlignment"===e?i=t.baselineAlignment:"strikethrough"===e?i=t.strikethrough:"underline"===e&&(i=t.underline),i},e.prototype.addModifiedTableProperties=function(e,t,i){if(this.editorHistory.isUndoing||this.editorHistory.isRedoing){var r=this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]:this.modifiedProperties[this.modifiedProperties.length-1];if(sf.base.isNullOrUndefined(t))return i=r,this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]=e.cloneFormat():this.modifiedProperties[this.modifiedProperties.length-1]=e.cloneFormat(),this.currentPropertyIndex++,i;i="shading"===t?r.shading:r.getPropertyValue(t),r.copyFormat(e),this.currentPropertyIndex++}else{var n=new vt;n.copyFormat(e),this.modifiedProperties.push(n)}return i},e.prototype.addModifiedRowProperties=function(e,t,i){if(this.editorHistory.isUndoing||this.editorHistory.isRedoing){var r=this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]:this.modifiedProperties[this.modifiedProperties.length-1];if(sf.base.isNullOrUndefined(t))return i=r,this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]=e.cloneFormat():this.modifiedProperties[this.modifiedProperties.length-1]=e.cloneFormat(),this.currentPropertyIndex++,i;i=r.getPropertyValue(t),r.copyFormat(e),this.currentPropertyIndex++}else{var n=new C;n.copyFormat(e),this.modifiedProperties.push(n)}return i},e.prototype.addModifiedCellProperties=function(e,t,i){if(this.editorHistory.isUndoing||this.editorHistory.isRedoing){var r=this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]:this.modifiedProperties[this.modifiedProperties.length-1];if(sf.base.isNullOrUndefined(t))return i=r,this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]=e.cloneFormat():this.modifiedProperties[this.modifiedProperties.length-1]=e.cloneFormat(),this.currentPropertyIndex++,i;i="shading"===t?r.shading:r.getPropertyValue(t),r.copyFormat(e),this.currentPropertyIndex++}else{var n=new bt;n.copyFormat(e),this.modifiedProperties.push(n)}return i},e.prototype.destroy=function(){if(this.selectionStart=void 0,this.selectionEnd=void 0,this.insertPosition=void 0,this.endPosition=void 0,sf.base.isNullOrUndefined(this.modifiedNodeLength)||(this.modifiedNodeLength=[],this.modifiedNodeLength=void 0),!sf.base.isNullOrUndefined(this.modifiedProperties)){for(var e=0;e<this.modifiedProperties.length;e++){var t=this.modifiedProperties[e];(t instanceof P||t instanceof ct||t instanceof d||t instanceof Vt)&&t.destroy(),this.modifiedProperties.splice(this.modifiedProperties.indexOf(t),1),e--}this.modifiedPropertiesIn=void 0}if(!sf.base.isNullOrUndefined(this.removedNodes)){for(e=0;e<this.removedNodes.length;e++){var i=this.removedNodes[e];i instanceof le?i.destroyInternal(this.viewer):i instanceof ge&&!(i instanceof nt)&&i.destroy(),this.removedNodes.splice(this.removedNodes.indexOf(i),1),e--}this.removedNodesIn=void 0}this.ownerIn=void 0},e}(),Jt=(w=function(e,t){return(w=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}w(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),$t=function(e){function t(t,i){var r=e.call(this,t)||this;return r.isChildHistoryInfo=!1,r.editRangeStart=void 0,r.documentHelper=t.documentHelper,r.isChildHistoryInfo=i,r}return Jt(t,e),Object.defineProperty(t.prototype,"hasAction",{get:function(){return!sf.base.isNullOrUndefined(this.modifiedActions)},enumerable:!0,configurable:!0}),t.prototype.addModifiedAction=function(e){this.editorHistory.isUndoing||this.editorHistory.isRedoing||(sf.base.isNullOrUndefined(this.modifiedActions)&&(this.modifiedActions=[]),this.modifiedActions.push(e))},t.prototype.revert=function(){if(this.editorHistory.currentHistoryInfo=this,"BordersAndShading"===this.action&&(this.owner.editorModule.isBordersAndShadingDialog=!0),!sf.base.isNullOrUndefined(this.modifiedActions))if(this.editorHistory.isUndoing)for(var e=this.modifiedActions.length;e>0;){this.modifiedActions[e-1].revert(),e-=1}else for(e=0;e<this.modifiedActions.length;){this.modifiedActions[parseInt(e.toString(),10)].revert(),e+=1}if("RestrictEditing"===this.action){var t=""!==this.editRangeStart.user?this.editRangeStart.user:this.editRangeStart.group;if(this.editorHistory.isUndoing){var i=this.owner.documentHelper.editRanges.get(t).indexOf(this.editRangeStart);-1!==i&&this.owner.documentHelper.editRanges.get(t).splice(i,1)}else this.owner.editor.updateRangeCollection(this.editRangeStart,t);this.owner.selection.updateEditRangeCollection()}this.isChildHistoryInfo?this.editorHistory.updateComplexHistoryInternal():this.editorHistory.updateComplexHistory()},t.prototype.destroy=function(){if(!sf.base.isNullOrUndefined(this.modifiedActions)){for(;this.modifiedActions.length>0;){var t=this.modifiedActions[this.modifiedActions.length-1];t.destroy(),this.modifiedActions.splice(this.modifiedActions.indexOf(t),1)}this.modifiedActions=void 0}e.prototype.destroy.call(this)},t}(Kt),ei=function(){function e(e){this.undoStackIn=[],this.redoStackIn=[],this.historyInfoStack=[],this.isUndoing=!1,this.isRedoing=!1,this.owner=e,this.documentHelper=e.documentHelper,this.modifiedParaFormats=new a,this.undoLimitIn=500,this.redoLimitIn=500}return Object.defineProperty(e.prototype,"currentHistoryInfo",{get:function(){return this.historyInfoStack&&this.historyInfoStack.length>0?this.historyInfoStack[this.historyInfoStack.length-1]:void 0},set:function(e){e instanceof $t?this.historyInfoStack.push(e):this.historyInfoStack.pop()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"undoStack",{get:function(){return this.undoStackIn},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"redoStack",{get:function(){return this.redoStackIn},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"undoLimit",{get:function(){return sf.base.isNullOrUndefined(this.undoLimitIn)?0:this.undoLimitIn},set:function(e){if(e<0)throw new Error("The limit should be greater than or equal to zero.");this.undoLimitIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"redoLimit",{get:function(){return sf.base.isNullOrUndefined(this.redoLimitIn)?0:this.redoLimitIn},set:function(e){if(e<0)throw new Error("The limit should be greater than or equal to zero.");this.redoLimitIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"viewer",{get:function(){return this.owner.viewer},enumerable:!0,configurable:!0}),e.prototype.getModuleName=function(){return"EditorHistory"},e.prototype.canUndo=function(){return!sf.base.isNullOrUndefined(this.undoStack)&&this.undoStack.length>0},e.prototype.canRedo=function(){return!sf.base.isNullOrUndefined(this.redoStack)&&this.redoStack.length>0},e.prototype.initializeHistory=function(e){sf.base.isNullOrUndefined(this.currentBaseHistoryInfo)||this.currentBaseHistoryInfo.destroy(),this.currentBaseHistoryInfo=new Kt(this.owner),this.currentBaseHistoryInfo.action=e,this.currentBaseHistoryInfo.updateSelection()},e.prototype.initComplexHistory=function(e,t){this.currentHistoryInfo=new $t(e.owner,!sf.base.isNullOrUndefined(this.currentHistoryInfo)),this.currentHistoryInfo.action=t,this.currentHistoryInfo.updateSelection()},e.prototype.initResizingHistory=function(e,t){if(1===t.resizeNode)this.initializeHistory("RowResizing"),sf.base.isNullOrUndefined(this.currentBaseHistoryInfo)||this.currentBaseHistoryInfo.modifiedProperties.push(new Qt(e,t.currentResizingTable.childWidgets[t.resizerPosition].rowFormat));else if(this.initializeHistory("CellResizing"),this.currentBaseHistoryInfo){t.currentResizingTable=t.currentResizingTable.combineWidget(this.viewer);var i=new qt(t.currentResizingTable,this.owner);i.startingPoint=e,this.currentBaseHistoryInfo.modifiedProperties.push(i),this.documentHelper.layout.reLayoutTable(t.currentResizingTable)}},e.prototype.updateResizingHistory=function(e,t){if(1===t.resizeNode){if(!sf.base.isNullOrUndefined(this.currentBaseHistoryInfo)){var i=this.currentBaseHistoryInfo.modifiedProperties[0];i.startingPoint.y===e.y?this.currentBaseHistoryInfo.modifiedProperties.length=0:(i.displacement=x.convertPixelToPoint(e.y-i.startingPoint.y),this.recordChanges(this.currentBaseHistoryInfo),this.currentBaseHistoryInfo=void 0)}}else if(!sf.base.isNullOrUndefined(this.currentBaseHistoryInfo)){var r=this.currentBaseHistoryInfo.modifiedProperties[0];r.startingPoint.x===e.x?this.currentBaseHistoryInfo.modifiedProperties.length=0:(r.displacement=x.convertPixelToPoint(e.x-r.startingPoint.x),r.endIndex=t.getCellReSizerPosition(e),this.owner.editorHistory.recordChanges(this.currentBaseHistoryInfo),this.currentBaseHistoryInfo=void 0)}},e.prototype.recordChanges=function(e){if(this.owner.enableHistoryMode)if(this.isUndoing){if(sf.base.isNullOrUndefined(this.redoStack)&&(this.redoStackIn=[]),this.redoStack.length===this.redoLimit&&this.redoLimit>0){var t=this.undoLimit>20?10:1;this.redoStackIn.splice(0,t)}this.redoStack.length<this.redoLimit&&this.redoStack.push(e)}else{if(this.isRedoing||this.clearRedoStack(),sf.base.isNullOrUndefined(this.undoStack)&&(this.undoStackIn=[]),this.undoStack.length===this.undoLimit&&this.undoLimit>0){t=this.undoLimit>20?10:1;this.undoStackIn.splice(0,t)}this.undoStack.length<this.undoLimit&&this.undoStackIn.push(e)}},e.prototype.updateHistory=function(){this.documentHelper.owner.enableHistoryMode&&!sf.base.isNullOrUndefined(this.currentBaseHistoryInfo)&&(!sf.base.isNullOrUndefined(this.currentBaseHistoryInfo)&&sf.base.isNullOrUndefined(this.currentBaseHistoryInfo.endPosition)&&(this.currentBaseHistoryInfo.endPosition=this.currentBaseHistoryInfo.insertPosition),sf.base.isNullOrUndefined(this.currentHistoryInfo)?this.recordChanges(this.currentBaseHistoryInfo):this.currentHistoryInfo.addModifiedAction(this.currentBaseHistoryInfo),this.currentBaseHistoryInfo=void 0)},e.prototype.isHandledComplexHistory=function(){var e=!1;return this.isUndoing||this.isRedoing||(e=this.owner.editorModule.insertRemoveBookMarkElements()),this.documentHelper.owner.enableHistoryMode&&!sf.base.isNullOrUndefined(this.currentHistoryInfo)?(this.updateHistory(),e=!0):this.owner.editorModule.isHandledComplex&&(e=!0),e},e.prototype.updateComplexHistory=function(){var e=this.documentHelper.selection;if(this.currentHistoryInfo.hasAction){if("AutoFormatHyperlink"===this.currentHistoryInfo.action||"SkipCommentInline"===this.currentHistoryInfo.action){var t=new Ft(e.owner);this.owner.editorModule.setPositionForCurrentIndex(t,this.currentHistoryInfo.insertPosition),e.owner.editorHistory.isUndoing?(this.owner.editorModule.setPositionForCurrentIndex(e.start,this.currentHistoryInfo.selectionStart),this.owner.editorModule.setPositionForCurrentIndex(e.end,this.currentHistoryInfo.selectionEnd)):(this.owner.editorModule.setPositionForCurrentIndex(e.start,this.currentHistoryInfo.endPosition),this.owner.editorModule.setPositionForCurrentIndex(e.end,this.currentHistoryInfo.endPosition))}if("InsertHyperlink"===this.currentHistoryInfo.action){t=new Ft(e.owner);this.owner.editorModule.setPositionForCurrentIndex(t,this.currentHistoryInfo.insertPosition);var i=new Ft(e.owner);this.owner.editorModule.setPositionForCurrentIndex(i,this.currentHistoryInfo.endPosition),this.documentHelper.layout.reLayoutParagraph(t.paragraph,0,0),i.paragraph!==t.paragraph&&this.documentHelper.layout.reLayoutParagraph(i.paragraph,0,0)}"ReplaceAll"===this.currentHistoryInfo.action?(this.documentHelper.contentControlCollection=[],this.owner.editorModule.layoutWholeDocument()):e.owner.isShiftingEnabled&&(this.documentHelper.layout.shiftLayoutedItems(!1),this.owner.enableHeaderAndFooter&&this.owner.editorModule.updateHeaderFooterWidget(),this.documentHelper.removeEmptyPages())}this.owner.showRevisions&&this.owner.trackChangesPane.updateTrackChanges(),e.owner.isShiftingEnabled=!1,e.owner.isLayoutEnabled=!0,"ApplyStyle"===this.currentHistoryInfo.action?this.owner.editor.getOffsetValue(e):(e.start.updatePhysicalPosition(!0),e.isEmpty?e.end.setPositionInternal(e.start):e.end.updatePhysicalPosition(!0)),e.upDownSelectionLength=e.end.location.x,this.documentHelper.isScrollHandler=!0,this.viewer.updateScrollBars(),e.fireSelectionChanged(!0),this.documentHelper.isScrollHandler=!1,this.documentHelper.updateFocus(),this.updateComplexHistoryInternal(),this.owner.editorModule.fireContentChange()},e.prototype.updateComplexHistoryInternal=function(){if(!sf.base.isNullOrUndefined(this.currentHistoryInfo)){if(sf.base.isNullOrUndefined(this.currentHistoryInfo.endPosition)&&(this.currentHistoryInfo.endPosition=this.currentHistoryInfo.insertPosition),this.historyInfoStack.length>1)this.historyInfoStack[this.historyInfoStack.length-2].addModifiedAction(this.currentHistoryInfo);else this.recordChanges(this.currentHistoryInfo);this.currentHistoryInfo=void 0}},e.prototype.updateListChangesInHistory=function(e,t){this.currentBaseHistoryInfo=new Kt(this.documentHelper.owner),this.currentBaseHistoryInfo.action="List",this.currentBaseHistoryInfo.updateSelection();for(var i=new a,r=0;r<e.levels.length;r++){var n=this.documentHelper.getAbstractListById(t.abstractListId).levels[parseInt(r.toString(),10)];this.currentBaseHistoryInfo.addModifiedPropertiesForList(n);var o=new Vt(n,e.levels[parseInt(r.toString(),10)]);sf.base.isNullOrUndefined(n)||this.documentHelper.owner.editorModule.copyListLevel(n,e.levels[parseInt(r.toString(),10)]),i.add(r,o)}return i},e.prototype.applyListChanges=function(e,t){sf.base.isNullOrUndefined(this.modifiedParaFormats)&&(this.modifiedParaFormats=new a);for(var i=[],r=0;r<this.documentHelper.listParagraphs.length;r++){var n=this.documentHelper.listParagraphs[parseInt(r.toString(),10)].paragraphFormat,o=this.documentHelper.getListById(n.listFormat.listId),s=this.documentHelper.layout.getListLevel(o,n.listFormat.listLevelNumber);if(t.containsKey(n.listFormat.listLevelNumber)&&t.get(n.listFormat.listLevelNumber).ownerListLevel===s){var l=new ct(null);l.leftIndent=n.leftIndent,l.firstLineIndent=n.firstLineIndent;var h=new Yt(n,l);i.push(h),this.owner.editorModule.copyFromListLevelParagraphFormat(n,s.paragraphFormat)}}this.modifiedParaFormats.add(this.currentBaseHistoryInfo,i)},e.prototype.updateListChanges=function(e){this.documentHelper.owner.isLayoutEnabled=!1,this.owner.editorModule.updateListParagraphs();for(var t=0;t<e.keys.length;t++){var i=e.keys[parseInt(t.toString(),10)],r=e.get(i);sf.base.isNullOrUndefined(this.currentBaseHistoryInfo)||(r=this.currentBaseHistoryInfo.addModifiedPropertiesForList(r.ownerListLevel)),this.owner.editorModule.copyListLevel(r.ownerListLevel,r.modifiedListLevel)}this.documentHelper.owner.isLayoutEnabled=!0,this.documentHelper.renderedLists.clear(),this.documentHelper.renderedLevelOverrides=[],this.owner.editorModule.layoutWholeDocument();var n=this.documentHelper.selection;n.start.updatePhysicalPosition(!0),n.isEmpty?n.end.setPositionInternal(n.start):n.end.updatePhysicalPosition(!0),n.upDownSelectionLength=n.end.location.x,n.fireSelectionChanged(!1),this.updateHistory()},e.prototype.undo=function(){if((!this.owner.isReadOnlyMode||this.owner.documentHelper.isCommentOnlyMode||"FormFieldsOnly"===this.owner.documentHelper.protectionType)&&this.canUndo()&&this.owner.enableHistoryMode){var e=this.undoStack.pop();this.isUndoing=!0,e.revert(),this.isUndoing=!1,this.owner.selection.checkForCursorVisibility(),this.owner.editorModule.isBordersAndShadingDialog=!1}},e.prototype.redo=function(){if((!this.owner.isReadOnlyMode||this.owner.documentHelper.isCommentOnlyMode||"FormFieldsOnly"===this.owner.documentHelper.protectionType)&&this.canRedo()&&this.owner.enableHistoryMode){var e=this.redoStack.pop();"BordersAndShading"===e.action&&(this.owner.editorModule.isBordersAndShadingDialog=!0),this.isRedoing=!0,e.revert(),this.isRedoing=!1,this.owner.selection.checkForCursorVisibility(),this.owner.editorModule.isBordersAndShadingDialog=!1}},e.prototype.destroy=function(){this.clearHistory(),this.undoStackIn=void 0,this.redoStackIn=void 0},e.prototype.clearHistory=function(){this.clearUndoStack(),this.clearRedoStack()},e.prototype.clearUndoStack=function(){if(this.canUndo())for(;this.undoStack.length>0;){var e=this.undoStack.pop();e.destroy(),e=void 0}},e.prototype.clearRedoStack=function(){if(this.canRedo())for(;this.redoStack.length>0;){var e=this.redoStack.pop();e.destroy(),e=void 0}},e}(),ti=function(){function e(e){this.resizeNode=0,this.resizerPosition=-1,this.currentResizingTable=void 0,this.owner=e,this.documentHelper=this.owner.documentHelper,this.startingPoint=new M(0,0)}return Object.defineProperty(e.prototype,"viewer",{get:function(){return this.owner.viewer},enumerable:!0,configurable:!0}),e.prototype.getModuleName=function(){return"TableResizer"},e.prototype.updateResizingHistory=function(e){this.owner.editorHistory&&this.owner.editorHistory.updateResizingHistory(e,this),this.documentHelper.isRowOrCellResizing=!1,this.resizerPosition=-1},e.prototype.handleResize=function(e){this.owner.documentHelper.isRowOrCellResizing=!0,this.startingPoint.x=e.x,this.startingPoint.y=e.y,this.owner.editorHistory.initResizingHistory(e,this)},e.prototype.isInRowResizerArea=function(e){var t=this.getRowReSizerPosition(void 0,e);return-1!==t&&(this.resizeNode=1,this.resizerPosition=t,!0)},e.prototype.isInCellResizerArea=function(e){var t=this.getCellReSizerPosition(e);return-1!==t&&(this.resizeNode=0,this.resizerPosition=t,!0)},e.prototype.getCellReSizerPosition=function(e){var t=-1,i=this.getTableWidget(e),r=this.getTableCellWidget(e),n=sf.base.isNullOrUndefined(i)?0:i.tableFormat.cellSpacing;if(i&&n>0){if(this.currentResizingTable=i,this.documentHelper.isInsideRect(i.x-x.convertPointToPixel(i.leftBorderWidth)-.25,i.y,x.convertPointToPixel(i.leftBorderWidth)+.5,i.height,e))return 0;for(var o=i.x,s=0;s<i.tableHolder.columns.length;s++){var a=x.convertPointToPixel(i.tableHolder.columns[parseInt(s.toString(),10)].preferredWidth);if(this.documentHelper.isInsideRect(o-1,i.y,i.leftBorderWidth+2,i.height,e))return s>0?s:0;if(s>0&&this.documentHelper.isInsideRect(o+a-1,i.y,2,i.height,e))return s+1;o+=a}}else if(!sf.base.isNullOrUndefined(r)){if(this.currentResizingTable=r.ownerTable,this.documentHelper.isInsideRect(r.x-r.margin.left-1,r.y-r.margin.top,2,r.height+r.margin.top+r.margin.bottom,e))return r.columnIndex;if(sf.base.isNullOrUndefined(r.nextRenderedWidget)&&this.documentHelper.isInsideRect(r.x+r.margin.right+r.width-1,r.y-r.margin.top,2,r.height+r.margin.top+r.margin.bottom,e))return r.columnIndex+r.cellFormat.columnSpan;if(r.childWidgets.length>0)return this.getCellReSizerPositionInternal(r,e)}return t},e.prototype.getCellReSizerPositionInternal=function(e,t){var i=-1,r=this.getTableWidgetFromWidget(t,e),n=void 0;if(!sf.base.isNullOrUndefined(r)&&r.tableFormat.cellSpacing>0){if(this.currentResizingTable=r,this.documentHelper.isInsideRect(r.x-r.leftBorderWidth-.25,r.y,r.leftBorderWidth+.5,r.height,t))return 0;for(var o=r.x,s=0;s<r.tableHolder.columns.length;s++){var a=x.convertPointToPixel(r.tableHolder.columns[parseInt(s.toString(),10)].preferredWidth);if(this.documentHelper.isInsideRect(o-1,r.y,r.leftBorderWidth+2,r.height,t))return s>0?s:0;if(s>0&&this.documentHelper.isInsideRect(o+a-1,r.y,2,r.height,t))return s+1;o+=a}}else if(sf.base.isNullOrUndefined(r)||(n=r.getTableCellWidget(t)),!sf.base.isNullOrUndefined(n)){if(this.currentResizingTable=n.ownerTable,this.documentHelper.isInsideRect(n.x-n.margin.left-1,n.y-n.margin.top,2,n.height,t))return n.columnIndex;if(sf.base.isNullOrUndefined(n.nextRenderedWidget)&&this.documentHelper.isInsideRect(n.x+n.margin.right+n.width-1,n.y-n.margin.top,2,n.height,t))return n.columnIndex+n.cellFormat.columnSpan;if(n.childWidgets.length>0)return this.getCellReSizerPositionInternal(n,t)}return i},e.prototype.getRowReSizerPosition=function(e,t){var i=void 0,r=void 0;sf.base.isNullOrUndefined(e)?(i=this.getTableWidget(t),r=this.getTableCellWidget(t)):i=this.getTableWidgetFromWidget(t,e);var n=sf.base.isNullOrUndefined(i)?0:i.tableFormat.cellSpacing;if(i&&n>0){if(this.currentResizingTable=i,this.owner.documentHelper.isInsideRect(i.x,i.y+i.height-n,this.getActualWidth(i.lastChild),sf.base.isNullOrUndefined(i.nextSplitWidget)?i.bottomBorderWidth+n:0,t))return i.lastChild.rowIndex;for(var o=0;o<i.childWidgets.length;o++){var s=i.childWidgets[parseInt(o.toString(),10)];if(i.childWidgets.indexOf(s)>-1&&this.owner.documentHelper.isInsideRect(s.x,s.y+s.height+n/2,this.getActualWidth(s),n/2,t))return s.rowIndex}}else if(i&&r&&(r=this.getTableCellWidget(t)),r){var a=0;if(a=(s=r.containerWidget).rowIndex===s.ownerTable.childWidgets.length-1?s.bottomBorderWidth+2:s.nextRenderedWidget.topBorderWidth+2,this.owner.documentHelper.isInsideRect(s.x,s.y+s.height-a,s.width,2*a,t))return this.currentResizingTable=s.ownerTable,s.rowIndex;if(r.childWidgets.length>0)return this.getRowReSizerPosition(r,t)}return-1},e.prototype.handleResizing=function(e){this.owner.isShiftingEnabled=!0;var t=0;0===this.resizeNode?(t=e.x-this.startingPoint.x,this.resizeTableCellColumn(t)):(t=e.y-this.startingPoint.y,this.resizeTableRow(t))},e.prototype.resizeTableRow=function(e){var t=this.currentResizingTable;if(!sf.base.isNullOrUndefined(t)&&0!==e&&-1!==this.resizerPosition){var i=this.owner.selection;t.isInsideTable&&(this.owner.isLayoutEnabled=!1);var r=void 0;if(this.resizerPosition>-1&&((r=t.childWidgets[this.resizerPosition])&&this.updateRowHeight(r,e),i.selectPosition(i.start,i.end)),t.isInsideTable){var n=this.owner.documentHelper.layout.getParentTable(t);this.owner.isLayoutEnabled=!0,t=n}this.startingPoint.y+=x.convertPointToPixel(e),this.owner.documentHelper.layout.reLayoutTable(t),this.owner.editorModule.reLayout(this.owner.selection),r&&this.getRowReSizerPosition(void 0,this.startingPoint),!this.currentResizingTable||void 0!==this.currentResizingTable.childWidgets&&void 0!==this.currentResizingTable.childWidgets[this.resizerPosition]||(this.resizerPosition=-1)}},e.prototype.getTableWidget=function(e){var t=void 0,i=this.owner.documentHelper.currentPage;if(!sf.base.isNullOrUndefined(i))for(var r=0;r<i.bodyWidgets.length;r++){var n=i.bodyWidgets[parseInt(r.toString(),10)];if(t=this.getTableWidgetFromWidget(e,n),!sf.base.isNullOrUndefined(t))break;if("Pages"===this.documentHelper.owner.layoutType){var o=i.headerWidget;if(t=this.getTableWidgetFromWidget(e,o),!sf.base.isNullOrUndefined(t))break;var s=i.footerWidget;if(t=this.getTableWidgetFromWidget(e,s),!sf.base.isNullOrUndefined(t))break}}return t},e.prototype.getTableWidgetFromWidget=function(e,t){for(var i=0;i<t.childWidgets.length;i++)if(t.childWidgets[parseInt(i.toString(),10)]instanceof de){var r=t.childWidgets[parseInt(i.toString(),10)],n=0;if(r.wrapTextAround&&(n=r.getTableCellWidth()),!r.wrapTextAround&&r.y<=e.y&&r.y+r.height>=e.y)return r;if(r.wrapTextAround&&r.x<=e.x&&r.x+n>=e.x&&r.y<=e.y&&r.y+r.height>=e.y)return r}},e.prototype.getTableCellWidget=function(e){var t=void 0,i=this.owner.documentHelper.currentPage;if(!sf.base.isNullOrUndefined(i))for(var r=0;r<i.bodyWidgets.length;r++){if(t=i.bodyWidgets[parseInt(r.toString(),10)].getTableCellWidget(e),!sf.base.isNullOrUndefined(t))break;if("Pages"===this.documentHelper.owner.layoutType&&this.viewer.owner.enableHeaderAndFooter){if(t=i.headerWidget.getTableCellWidget(e),!sf.base.isNullOrUndefined(t))break;if(t=i.footerWidget.getTableCellWidget(e),!sf.base.isNullOrUndefined(t))break}}return t},e.prototype.updateRowHeight=function(e,t){var i=e.rowFormat;if("Auto"===i.heightType){i.heightType="AtLeast";var r=i.ownerBase,n=this.owner.documentHelper.layout.getRowHeight(r,[r]);n+t>=2.7&&i.height!==n+t&&(i.height=n+t)}else i.height+t>=2.7&&i.height!==i.height+t&&(i.height=i.height+t)},e.prototype.resizeTableCellColumn=function(e){var t=this.currentResizingTable;if(!(sf.base.isNullOrUndefined(t)||0===e||sf.base.isNullOrUndefined(t.childWidgets)||this.resizerPosition<0)){var i=!0,r=this.owner.selection;this.owner.editor.setOffsetValue(r),t=t.combineWidget(this.viewer),this.owner.isLayoutEnabled=!1,this.setPreferredWidth(t);var n=t.getOwnerWidth(!0),o=t.leftIndent,s=t.tableFormat.tableAlignment;if(r.isEmpty||(i=this.resizeColumnWithSelection(r,t,e)),i){if(0===this.resizerPosition){var a=this.resizerPosition,l=t.tableHolder.columns[parseInt(a.toString(),10)],h=l.preferredWidth;if(e>0){var d=e;do{if((c=x.round(l.preferredWidth-e,1))>=l.minWidth){l.preferredWidth=c,o=(o=t.leftIndent+e)>=-1440?o<=1440?o:1440:-1440;break}d=e,e+=c-l.minWidth}while(e!==d)}else{d=e;do{var c;if((c=x.round(l.preferredWidth-e,1))<=2112){l.preferredWidth=c,o=(o=t.leftIndent+e)>=-1440?o<=1440?o:1440:-1440;break}d=e,e-=c-2112}while(e!==d)}var p=e;"Left"!==s&&t.tableHolder.getTotalWidth(0)>n&&"Auto"===t.tableFormat.preferredWidthType&&(t.tableHolder.isFitColumns(n,t.tableHolder.tableWidth,"Auto"===t.tableFormat.preferredWidthType)?t.tableHolder.fitColumns(n,t.tableHolder.tableWidth,"Auto"===t.tableFormat.preferredWidthType):l.preferredWidth=h,p=0),"Center"===s&&(t.tableHolder.getTotalWidth(0)<n||"Auto"!==t.tableFormat.preferredWidthType)&&(p/=2),t.tableFormat.leftIndent="Left"===s?o:0,t.tableHolder.tableWidth=t.tableHolder.getTotalWidth(0),this.updateCellPreferredWidths(t),"Auto"!==t.tableFormat.preferredWidthType&&t.updateWidth(e),this.updateGridValue(t,!0,p)}else if(null!==t&&this.resizerPosition===t.tableHolder.columns.length)this.resizeColumnAtLastColumnIndex(t,e,n);else{if(-1===this.resizerPosition)return void(this.owner.isLayoutEnabled=!0);this.resizeCellAtMiddle(t,e)}this.owner.isLayoutEnabled=!0,r.selectPosition(r.start,r.end)}else this.updateGridValue(t,!0)}},e.prototype.resizeColumnWithSelection=function(e,t,i){var r=this.getTableCellWidget(this.startingPoint);if(r&&(e.selectedWidgets.containsKey(r)||r.previousWidget&&e.selectedWidgets.containsKey(r.previousWidget))){var n=e.getSelectedCells();if(0===this.resizerPosition)this.resizeColumnAtStart(t,i,n);else if(null!==t&&this.resizerPosition===t.tableHolder.columns.length){for(var o=this.getColumnCells(t,this.resizerPosition,!0),s=0;s<o.length;s++){var a=o[parseInt(s.toString(),10)];-1!==n.indexOf(a)&&this.increaseOrDecreaseWidth(a,i,!0)}this.updateRowsGridAfterWidth(t),t.updateWidth(i),t.tableFormat.allowAutoFit=!1,this.updateGridValue(t,!0,i)}else{if(-1===this.resizerPosition)return!1;var l=this.resizerPosition,h=(o=this.getColumnCells(t,l,!0),this.getColumnCells(t,l,!1)),d=this.isColumnSelected(t,l);if(o.length>0&&!d)for(s=0;s<o.length;s++)-1===n.indexOf(o[parseInt(s.toString(),10)])&&(o.splice(s,1),s--);if(h.length>0&&!d)for(s=0;s<h.length;s++)-1===n.indexOf(h[parseInt(s.toString(),10)])&&(h.splice(s,1),s--);if(0===o.length&&h.length>0)for(s=0;s<h.length;s++){(a=h[parseInt(s.toString(),10)]).previousWidget&&o.push(a.previousWidget)}else if(0===h.length&&o.length>0)for(s=0;s<o.length;s++){(a=o[parseInt(s.toString(),10)]).nextWidget&&h.push(a.nextWidget)}this.changeWidthOfCells(t,o,h,i),t.tableFormat.allowAutoFit&&t.updateWidth(i),t.tableFormat.allowAutoFit=!1,this.updateGridValue(t,!0,i)}e.selectPosition(e.start,e.end)}return!1},e.prototype.resizeColumnAtStart=function(e,t,i){var r=e.leftIndent,n=i[0].ownerRow,o=n.rowFormat;if(o.beforeWidth>0){var s=o.beforeWidth+t;if(s>0)this.updateGridBefore(n,t);else if(s<(l=this.getLeastGridBefore(e,n))&&0!==s){r=e.leftIndent+s,e.tableFormat.leftIndent=r>=-1440?r<=1440?r:1440:-1440;for(var a=0;a<e.childWidgets.length;a++){n!==(h=e.childWidgets[parseInt(a.toString(),10)])&&this.updateGridBefore(h,-s)}}}else if(t<0)r=e.leftIndent+t,e.tableFormat.leftIndent=r>=-1440?r<=1440?r:1440:-1440,this.updateWidthForCells(e,i,t);else{var l=this.getLeastGridBefore(e,n);if(0===e.tableFormat.leftIndent)for(a=0;a<e.childWidgets.length;a++){var h=e.childWidgets[parseInt(a.toString(),10)];-1!==i.indexOf(h.childWidgets[0])&&(this.updateGridBefore(h,t),this.increaseOrDecreaseWidth(h.childWidgets[0],t,!1))}else if(l-t>0)r=e.leftIndent+t,e.tableFormat.leftIndent=r>=-1440?r<=1440?r:1440:-1440,this.updateWidthForCells(e,i,t);else{r=e.leftIndent+l,e.tableFormat.leftIndent=r>=-1440?r<=1440?r:1440:-1440;for(a=0;a<e.childWidgets.length;a++){h=e.childWidgets[parseInt(a.toString(),10)];-1!==i.indexOf(h.childWidgets[0])?(this.increaseOrDecreaseWidth(h.childWidgets[0],t,!1),this.updateGridBefore(h,t-l)):this.updateGridBefore(h,-l)}}}e.tableFormat.allowAutoFit=!1,this.updateGridValue(e,!0,t)},e.prototype.updateWidthForCells=function(e,t,i){for(var r=0;r<e.childWidgets.length;r++){var n=e.childWidgets[parseInt(r.toString(),10)];-1!==t.indexOf(n.childWidgets[0])?this.increaseOrDecreaseWidth(n.childWidgets[0],i,!1):this.updateGridBefore(n,-i)}},e.prototype.resizeColumnAtLastColumnIndex=function(e,t,i){for(var r=e.tableFormat.tableAlignment,n=e.tableFormat.preferredWidth,o=this.resizerPosition,s=e.tableHolder.columns[o-1],a=0;t!==a;){var l=x.round(s.preferredWidth+t,1);l>=s.minWidth?(s.preferredWidth=l,a=t):(a=t,t-=l-s.minWidth)}this.updateCellPreferredWidths(e),(n||e.tableHolder.getTotalWidth(0)>i)&&(e.tableFormat.allowAutoFit=!1,e.updateWidth(t),e.tableHolder.tableWidth=e.tableHolder.getTotalWidth(0));var h=t;"Right"===r?h=0:"Center"===r&&(h/=2),this.updateGridValue(e,!0,h)},e.prototype.resizeCellAtMiddle=function(e,t){var i=this.resizerPosition,r=e.tableHolder.columns[i-1],n=e.tableHolder.columns[parseInt(i.toString(),10)];if(t>0)for(var o=!0;o;){(s=x.round(n.preferredWidth-t,1))>=n.minWidth?(n.preferredWidth=s,r.preferredWidth=r.preferredWidth+t,o=!1):t+=s-n.minWidth}else for(o=!0;o;){var s;(s=x.round(r.preferredWidth+t,1))>=r.minWidth?(r.preferredWidth=s,n.preferredWidth=n.preferredWidth-t,o=!1):t-=s-r.minWidth}this.updateCellPreferredWidths(e),e.tableFormat.allowAutoFit&&e.updateWidth(t),e.tableFormat.allowAutoFit=!1,e.tableHolder.tableWidth=e.tableHolder.getTotalWidth(0),this.updateGridValue(e,!1,t)},e.prototype.updateGridValue=function(e,t,i){if(t&&(e.calculateGrid(),e.isGridUpdated=!1),e.buildTableColumns(),e.isGridUpdated=!0,this.viewer.owner.isLayoutEnabled=!0,e.isInsideTable){var r=this.documentHelper.layout.getParentTable(e);this.documentHelper.layout.reLayoutTable(r)}else this.documentHelper.layout.reLayoutTable(e);this.owner.editor.getOffsetValue(this.documentHelper.selection),this.owner.editorModule.reLayout(this.owner.selection),i&&(this.startingPoint.x+=x.convertPointToPixel(i),this.resizerPosition=this.getCellReSizerPosition(this.startingPoint))},e.prototype.getColumnCells=function(e,t,i){for(var r=[],n=0;n<e.childWidgets.length;n++)for(var o=e.childWidgets[parseInt(n.toString(),10)],s=0;s<o.childWidgets.length;s++){var a=o.childWidgets[parseInt(s.toString(),10)];i?a.columnIndex+a.cellFormat.columnSpan===t&&r.push(a):a.columnIndex===t&&r.push(a)}return r},e.prototype.updateGridBefore=function(e,t){e.rowFormat.beforeWidth+t!==e.rowFormat.beforeWidth&&(e.rowFormat.beforeWidth=e.rowFormat.beforeWidth+t,e.rowFormat.gridBeforeWidth=e.rowFormat.beforeWidth)},e.prototype.getLeastGridBefore=function(e,t){for(var i=0,r=0,n=0;n<e.childWidgets.length;n++){var o=e.childWidgets[parseInt(n.toString(),10)];o!==t&&(0===r&&(i=o.rowFormat.beforeWidth,r++),o.rowFormat.beforeWidth<=i&&(i=o.rowFormat.beforeWidth))}return i},e.prototype.increaseOrDecreaseWidth=function(e,t,i){var r=e.cellFormat.preferredWidth;"Auto"===e.cellFormat.preferredWidthType&&(r=e.cellFormat.cellWidth,e.cellFormat.preferredWidthType="Point");var n=e.ownerColumn.minWidth;"Percent"===e.cellFormat.preferredWidthType&&(n=e.convertPointToPercent(n)),e.cellFormat.preferredWidth=i?r+t>n?r+t:n:r-t>n?r-t:n},e.prototype.changeWidthOfCells=function(e,t,i,r){if(t.length>0){for(var n=!1,o=0;o<t.length;o++){var s=t[parseInt(o.toString(),10)];this.increaseOrDecreaseWidth(s,r,!0),s.cellIndex===s.ownerRow.childWidgets.length-1&&(n=!0)}n&&this.updateRowsGridAfterWidth(e)}if(i.length>0){var a=0;for(o=0;o<i.length;o++){if(0===(s=i[parseInt(o.toString(),10)]).cellIndex){var l=s.ownerRow.rowFormat.beforeWidth+r;l>=0?this.updateGridBefore(s.ownerRow,r):(a!==l&&(a=l),s.ownerRow.rowFormat.gridBeforeWidth=0,s.ownerRow.rowFormat.gridBeforeWidthType="Auto")}this.increaseOrDecreaseWidth(s,r,!1)}if(0!==a){var h=e.leftIndent+a;e.tableFormat.leftIndent=h>=-1440?h<=1440?h:1440:-1440;for(var d=0;d<e.childWidgets.length;d++){var c=e.childWidgets[parseInt(d.toString(),10)];-1===i.indexOf(c.childWidgets[0])&&this.updateGridBefore(c,a>0?a:-a)}}}},e.prototype.updateRowsGridAfterWidth=function(e){for(var t=this.getMaxRowWidth(e,!0),i=0;i<e.childWidgets.length;i++){var r=e.childWidgets[parseInt(i.toString(),10)],n=this.getRowWidth(r,!0);if(t>=n&&r.rowFormat.afterWidth!==t-n){var o=t-n;r.rowFormat.gridAfterWidth=o,r.rowFormat.afterWidth=o}}},e.prototype.getRowWidth=function(e,t){var i=0;t&&(i+=e.rowFormat.beforeWidth);for(var r=0;r<e.childWidgets.length;r++){i+=e.childWidgets[parseInt(r.toString(),10)].cellFormat.cellWidth}return i},e.prototype.getMaxRowWidth=function(e,t){for(var i=0,r=0;r<e.childWidgets.length;r++){var n=e.childWidgets[parseInt(r.toString(),10)],o=0;t&&(o+=n.rowFormat.beforeWidth);for(var s=0;s<n.childWidgets.length;s++){o+=n.childWidgets[parseInt(s.toString(),10)].cellFormat.cellWidth}i<o&&(i=o)}return i},e.prototype.isColumnSelected=function(e,t){for(var i=this.owner.selection.getSelectedCells(),r=this.getColumnCells(e,t,!0),n=this.getColumnCells(e,t,!1),o=!1,s=0;s<r.length;s++){var a=r[parseInt(s.toString(),10)];o=-1!==i.indexOf(a)}if(!o)for(s=0;s<n.length;s++){a=n[parseInt(s.toString(),10)];o=-1!==i.indexOf(a)}return o},e.prototype.applyProperties=function(e,t){if(!sf.base.isNullOrUndefined(t)){t.tableHolder&&(e.tableHolder=t.tableHolder.clone()),null!==t.tableFormat&&(e.tableFormat.leftIndent=t.tableFormat.leftIndent,e.tableFormat.preferredWidth=t.tableFormat.preferredWidth,e.tableFormat.preferredWidthType=t.tableFormat.preferredWidthType,e.tableFormat.allowAutoFit=t.tableFormat.allowAutoFit);for(var i=0;i<e.childWidgets.length;i++){var r=e.childWidgets[parseInt(i.toString(),10)],n=t.rows[parseInt(i.toString(),10)];r.rowFormat.gridBefore=n.gridBefore,r.rowFormat.gridBeforeWidth=n.gridBeforeWidth,r.rowFormat.gridBeforeWidthType=n.gridBeforeWidthType,r.rowFormat.gridAfter=n.gridAfter,r.rowFormat.gridAfterWidth=n.gridAfterWidth,r.rowFormat.gridAfterWidthType=n.gridAfterWidthType;for(var o=0;o<r.childWidgets.length;o++){var s=r.childWidgets[parseInt(o.toString(),10)],a=n.cells[parseInt(o.toString(),10)];s.columnIndex=a.columnIndex,s.cellFormat.columnSpan=a.columnSpan,s.cellFormat.preferredWidth=a.preferredWidth,s.cellFormat.preferredWidthType=a.preferredWidthType}}var l=e.getOwnerWidth(!0),h=e.getTableClientWidth(l);e.setWidthToCells(h,"Auto"===e.tableFormat.preferredWidthType)}},e.prototype.getActualWidth=function(e){var t=0;if(e.childWidgets.length>0)for(var i=0;i<e.childWidgets.length;i++)t+=e.childWidgets[parseInt(i.toString(),10)].cellFormat.cellWidth;return t},e.prototype.setPreferredWidth=function(e){for(var t=0;t<e.childWidgets.length;t++){var i=e.childWidgets[parseInt(t.toString(),10)],r=i.rowFormat;r.gridBefore>0&&(r.gridBeforeWidth=r.beforeWidth,r.gridBeforeWidthType="Point");for(var n=0;n<i.childWidgets.length;n++){var o=i.childWidgets[parseInt(n.toString(),10)];o.cellFormat.preferredWidth=o.cellFormat.cellWidth,o.cellFormat.preferredWidthType="Point"}r.gridAfter>0&&(r.gridAfterWidth=r.afterWidth,r.gridAfterWidthType="Point")}},e.prototype.updateCellPreferredWidths=function(e){for(var t=e.tableHolder.tableWidth,i=0;i<e.childWidgets.length;i++){var r=e.childWidgets[parseInt(i.toString(),10)];if(r.rowFormat.gridBefore>0){var n=e.tableHolder.getCellWidth(0,r.rowFormat.gridBefore,t);this.updateGridBeforeWidth(n,r)}for(var o=0;o<r.childWidgets.length;o++){var s=r.childWidgets[parseInt(o.toString(),10)];s.updateWidth(e.tableHolder.getCellWidth(s.columnIndex,s.cellFormat.columnSpan,t))}r.rowFormat.gridAfter>0&&this.updateGridAfterWidth(e.tableHolder.getCellWidth(r.childWidgets.length,r.rowFormat.gridAfter,t),r)}},e.prototype.updateGridBeforeWidth=function(e,t){var i=t.rowFormat;if(e!==i.beforeWidth)if(i.beforeWidth=e,"Auto"===i.gridBeforeWidthType&&(i.gridBeforeWidthType="Point"),"Point"===i.gridBeforeWidthType)i.gridBeforeWidth=i.beforeWidth;else{var r=t.ownerTable.getTableClientWidth(t.ownerTable.getOwnerWidth(!0)),n=t.ownerTable.convertPointToPercent(i.beforeWidth,r);i.gridBeforeWidth=n}},e.prototype.updateGridAfterWidth=function(e,t){var i=t.rowFormat;if(e!==i.afterWidth&&(i.afterWidth=e),"Auto"===i.gridAfterWidthType&&(i.gridAfterWidthType="Point"),"Point"===i.gridAfterWidthType)i.gridAfterWidth=i.afterWidth;else{var r=t.ownerTable.getTableClientWidth(t.ownerTable.getOwnerWidth(!0)),n=t.ownerTable.convertPointToPercent(i.afterWidth,r);i.gridAfterWidth=n}},e}(),ii=function(){function e(e){var t=this;this.nodes=[],this.editHyperlinkInternal=!1,this.startParagraph=void 0,this.endParagraph=void 0,this.formFieldCounter=1,this.skipFieldDeleteTracking=!1,this.isForHyperlinkFormat=!1,this.isTrackingFormField=!1,this.isCmtDeleteStarted=!1,this.removeCommentCharacters=[],this.isInsertText=!1,this.removeEditRange=!1,this.isRemoveRevision=!1,this.isFootNoteInsert=!1,this.isTableInsert=!1,this.isFootNote=!1,this.isHandledComplex=!1,this.tableResize=void 0,this.tocStyles={},this.chartType=!1,this.removedBookmarkElements=[],this.tocBookmarkId=0,this.triggerPageSpellCheck=!0,this.copiedData=void 0,this.pageRefFields={},this.delBlockContinue=!1,this.delBlock=void 0,this.delSection=void 0,this.isInsertingTOC=!1,this.editStartRangeCollection=[],this.skipReplace=!1,this.skipTableElements=!1,this.listNumberFormat="",this.listLevelNumber=0,this.isXmlMapped=!1,this.combineLastBlock=!1,this.copiedContent="",this.copiedTextContent="",this.previousParaFormat=void 0,this.previousCharFormat=void 0,this.previousSectionFormat=void 0,this.pasteTextPosition=void 0,this.isPaste=!1,this.isPasteListUpdated=!1,this.isHtmlPaste=!1,this.isInsertField=!1,this.isBordersAndShadingDialog=!1,this.onTextInputInternal=function(){if(sf.base.Browser.isDevice){var e=t.documentHelper,i=new RegExp(String.fromCharCode(160),"g"),r=new RegExp(String.fromCharCode(10),"g");e.prefix=e.prefix.replace(i," ").replace(r," ");var n=(o=e.editableDiv.textContent.replace(i," ").replace(r," ")).substring(2);if(e.isCompositionStart&&e.isCompositionUpdated)return e.isCompositionUpdated=!1,void(!e.owner.isReadOnlyMode&&e.owner.isDocumentLoaded&&t.canEditContentControl&&e.prefix.substring(2)!==n&&(t.selection.isEmpty?(t.selection.start.setPositionForLineWidget(e.selection.start.currentWidget,t.selection.start.offset-(e.prefix.length-2)),t.handleTextInput(n),e.prefix="@"+String.fromCharCode(160)+n):(t.handleTextInput(n),e.prefix="@"+String.fromCharCode(160)+n)));if(e.isCompositionStart&&e.isCompositionEnd&&""===e.suffix)return e.prefix.substring(2)!==n?t.selection.isEmpty&&e.isCompositionStart?(e.isCompositionStart=!1,t.selection.start.setPositionForLineWidget(e.selection.start.currentWidget,t.selection.start.offset-e.prefix.substring(2).length),t.selection.retrieveCurrentFormatProperties(),""!==e.suffix&&""!==n||t.handleTextInput(n)):t.selection.isEmpty||(e.isCompositionStart=!1,t.handleTextInput(n)):""===n?(e.isCompositionStart=!1,t.handleBackKey()):e.prefix.substring(2)===n&&""===e.suffix&&(e.isCompositionStart=!1,t.handleTextInput(" ")),void(e.isCompositionEnd=!1);if(e.isCompositionEnd||e.isCompositionStart&&!e.isCompositionUpdated){if(n.length<e.prefix.length&&n===e.prefix.substring(2,e.prefix.length-1)||e.editableDiv.innerText.length<2)return void t.handleBackKey();if(""!==e.suffix&&e.editableDiv.innerText[e.editableDiv.innerText.length-1]!==String.fromCharCode(160))return e.isCompositionStart=!1,t.selection.start.setPositionForLineWidget(e.selection.start.currentWidget,t.selection.start.offset-(e.prefix.length-2)),t.selection.end.setPositionForLineWidget(e.selection.end.currentWidget,t.selection.end.offset+e.suffix.length),t.selection.retrieveCurrentFormatProperties(),void t.handleTextInput(n)}"\r"!==o&&"\b"!==o&&o!==String.fromCharCode(27)&&!e.owner.isReadOnlyMode&&!1===e.isControlPressed&&t.canEditContentControl&&("@"===o||"@"!==o[0]||""===o||o.length<e.prefix.length&&n===e.prefix.substring(2,e.prefix.length-1)?(t.handleBackKey(),e.editableDiv.innerText.length<2&&t.predictText()):0===o.indexOf(e.prefix)&&o.length>e.prefix.length?t.handleTextInput(o.substring(e.prefix.length)):-1===o.indexOf(e.prefix)&&o[o.length-1]!==String.fromCharCode(160)&&" "!==o[o.length-1]?(n.charAt(0).toLowerCase()+n.slice(1)===e.prefix.substring(2)&&t.selection.start.setPositionParagraph(e.selection.start.currentWidget,t.selection.start.offset-(e.prefix.length-2)),t.handleTextInput(n)):2!==o.length&&t.handleTextInput(" "))}else{var o;(o=t.documentHelper.editableDiv.innerText)!==String.fromCharCode(160)?"\r"!==o&&"\b"!==o&&o!==String.fromCharCode(27)&&!t.owner.isReadOnlyMode&&!1===t.documentHelper.isControlPressed&&t.canEditContentControl&&t.handleTextInput(o):t.handleTextInput(" "),t.documentHelper.editableDiv.innerText=""}},this.onPaste=function(e){!t.owner.isReadOnlyMode&&t.canEditContentControl&&t.pasteInternal(e),e.preventDefault()},this.documentHelper=e,this.tableResize=new ti(this.documentHelper.owner),this.base64=new N}return Object.defineProperty(e.prototype,"restrictFormatting",{get:function(){return this.documentHelper.isDocumentProtected&&(this.documentHelper.restrictFormatting||!this.documentHelper.restrictFormatting&&!this.selection.isSelectionInEditRegion())&&"RevisionsOnly"!==this.documentHelper.protectionType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"restrictEditing",{get:function(){return this.documentHelper.isDocumentProtected&&(("ReadOnly"===this.documentHelper.protectionType||this.documentHelper.isCommentOnlyMode)&&!this.selection.isSelectionInEditRegion()||"FormFieldsOnly"===this.documentHelper.protectionType)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"canEditContentControl",{get:function(){return!this.owner.isReadOnlyMode&&!this.selection.checkContentControlLocked()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"viewer",{get:function(){if(!sf.base.isNullOrUndefined(this.owner))return this.owner.viewer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"editorHistory",{get:function(){return this.documentHelper.owner.editorHistory},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selection",{get:function(){if(this.documentHelper)return this.documentHelper.selection},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"owner",{get:function(){return this.documentHelper.owner},enumerable:!0,configurable:!0}),e.prototype.getModuleName=function(){return"Editor"},e.prototype.setFieldInfo=function(e){var t=this.selection.getHyperlinkField(!0);sf.base.isNullOrUndefined(t)||(this.selection.selectField(),this.insertField(e.code,e.result))},e.prototype.insertField=function(e,t){this.isInsertField=!0;var i=e;if("NUMPAGES"===(i=x.trimStart(i)).substring(0,8))this.insertPageCount(t);else if("PAGE"===i.substring(0,4))this.insertPageNumber(t);else{if(sf.base.isNullOrUndefined(t)&&"MERGEFIELD"===i.substring(0,10)){var r=(i=i.substring(10).trim()).indexOf("\\*");t="«"+i.substring(0,r).trim()+"»"}var n=new le,o=new P,s=this.copyInsertFormat(o,!1),a=new ue(n),l=new fe(0);l.characterFormat.mergeFormat(s),a.children.push(l);var h=new we;h.characterFormat.mergeFormat(s),h.text=e,a.children.push(h);var c=new fe(2);c.characterFormat.mergeFormat(s),c.fieldBegin=l,l.fieldSeparator=c,a.children.push(c);var p=new we;p.text=t,p.characterFormat.mergeFormat(s),a.children.push(p);var u=new fe(1);u.characterFormat.mergeFormat(s),u.fieldSeparator=c,u.fieldBegin=l,l.fieldEnd=u,c.fieldEnd=u,a.children.push(u),l.line=a,n.childWidgets.push(a),this.documentHelper.fields.push(l);var g=new ne;g.sectionFormat=new d(g),g.childWidgets.push(n),this.pasteContentsInternal([g],!1)}this.isInsertField=!1},e.prototype.isLinkedStyle=function(e){var t=this.documentHelper.styles.findByName(e);return!sf.base.isNullOrUndefined(t.link)},e.prototype.applyStyle=function(e,t){var i=void 0,r=void 0;if(t=!sf.base.isNullOrUndefined(t)&&t){this.initComplexHistory("ApplyStyle"),this.setOffsetValue(this.selection),i=this.startOffset,r=this.endOffset;var n=this.selection.isEmpty;this.clearFormattingInternal(!this.isLinkedStyle(e)),n&&!this.selection.isEmpty&&this.selection.end.setPositionInternal(this.selection.start)}var o=this.documentHelper.styles.findByName(e);if(void 0!==o)if(o instanceof ft&&"Character"===o.type)if(this.selection.isEmpty){var s=this.selection.start.offset,a=this.selection.start.clone(),l=this.selection.end.clone();this.selection.selectCurrentWord(),s===this.selection.start.offset||s===this.selection.end.offset-1?(this.selection.start=a,this.selection.end=l,this.selection.characterFormat.copyFormat(o.characterFormat)):this.onApplyCharacterFormat("styleName",o,!1,!0)}else this.onApplyCharacterFormat("styleName",o,!1,!0);else this.onApplyParagraphFormat("styleName",o,!1,!0);else this.documentHelper.owner.parser.parseStyle(JSON.parse(this.getCompleteStyles()),JSON.parse(this.documentHelper.preDefinedStyles.get(e)),this.documentHelper.styles),this.applyStyle(e);this.editorHistory&&this.editorHistory.currentHistoryInfo&&"ApplyStyle"===this.editorHistory.currentHistoryInfo.action&&(this.startOffset=i,this.endOffset=r,this.editorHistory.updateComplexHistory()),this.startParagraph=void 0,this.endParagraph=void 0},e.prototype.cut=function(){this.owner.isReadOnlyMode||this.selection.isEmpty||!this.canEditContentControl||(this.selection.copySelectedContent(!0),this.documentHelper.owner.parser.isCutPerformed=!0)},e.prototype.insertEditingRegion=function(e){this.insertEditRangeElement(e&&""!==e?e:"Everyone")},e.prototype.enforceProtection=function(e,t,i){var r,n;"boolean"==typeof t?(r=i?"ReadOnly":this.documentHelper.protectionType,n=t):(n=!0,r=t),this.documentHelper.restrictFormatting=n,this.documentHelper.protectionType=r,this.selection.isHighlightEditRegion=!0,this.addProtection(e,this.documentHelper.protectionType)},e.prototype.getCommentHierarchicalIndex=function(e){for(var t="";e.ownerComment;)t=e.ownerComment.replyComments.indexOf(e)+";"+t,e=e.ownerComment;return t="C;"+this.documentHelper.comments.indexOf(e)+";"+t},e.prototype.alertBox=function(){},e.prototype.insertComment=function(e){sf.base.isNullOrUndefined(this.selection.start)||this.owner.isReadOnlyMode&&!this.documentHelper.isCommentOnlyMode||this.viewer.owner.enableHeaderAndFooter||!this.viewer.owner.enableComment||(sf.base.isNullOrUndefined(e)&&(e=""),this.insertCommentInternal(e))},e.prototype.insertCommentInternal=function(e){if(this.documentHelper.layout.allowLayout=!1,this.selection.isEmpty){if(this.selection.start.isAtSamePosition(this.selection.end)&&this.selection.start.isAtParagraphEnd){var t=this.selection.start.offset;this.selection.start.offset=t-1!=-1?t-1:t}this.selection.selectCurrentWord()}this.selection.isParagraphLastLine(this.selection.end.currentWidget)&&this.selection.end.offset===this.selection.getLineLength(this.selection.end.currentWidget)+1&&(this.selection.end.offset-=1);var i=this.selection.getParagraphInfo(this.selection.start),r=(this.selection.getHierarchicalIndex(i.paragraph,i.offset.toString()),this.selection.getParagraphInfo(this.selection.end)),n=this.selection.getHierarchicalIndex(r.paragraph,r.offset.toString());this.initComplexHistory("InsertComment");var o=this.selection.start,s=this.selection.end,a=new Ft(this.owner);this.selection.isForward||(o=this.selection.end,s=this.selection.start),a.setPositionInternal(s);var l=new nt(0),h=new nt(1),d=o.currentWidget===s.currentWidget;if(s.setPositionInternal(o),this.initInsertInline(l),sf.base.isNullOrUndefined(a.paragraph)||a.currentWidget&&0===a.currentWidget.children.length&&-1===a.currentWidget.indexInOwner){var c=this.selection.getTextPosBasedOnLogicalIndex(n);a.setPositionInternal(c)}d&&a.setPositionParagraph(a.currentWidget,a.offset+l.length),o.setPositionInternal(a),s.setPositionInternal(a),this.initInsertInline(h);var p=new ot(x.getUtcDate());return this.owner.editorHistory&&(this.initHistory("InsertCommentWidget"),this.owner.editorHistory.currentBaseHistoryInfo.removedNodes.push(p)),p.author=this.owner.currentUser?this.owner.currentUser:"Guest user",p.initial=this.constructCommentInitial(p.author),p.text=e,p.commentId=Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15),l.comment=p,l.commentId=p.commentId,h.comment=p,h.commentId=p.commentId,p.commentStart=l,p.commentEnd=h,this.addCommentWidget(p,!0,!0,!0),this.editorHistory&&(this.editorHistory.currentBaseHistoryInfo.insertPosition=this.getCommentHierarchicalIndex(p),this.editorHistory.updateHistory()),this.editorHistory&&this.editorHistory.updateComplexHistory(),this.reLayout(this.selection,!1),this.documentHelper.layout.allowLayout=!0,p},e.prototype.deleteAllComments=function(){if(0!==this.documentHelper.comments.length){var e;for(this.initComplexHistory("DeleteAllComments"),this.owner.isLayoutEnabled=!1,this.editorHistory&&this.editorHistory.currentHistoryInfo&&(e=this.editorHistory.currentHistoryInfo);this.documentHelper.comments.length>0;){var t=this.documentHelper.comments[0];this.initComplexHistory("DeleteComment"),this.deleteCommentInternal(t),this.editorHistory&&this.editorHistory.currentHistoryInfo&&e.addModifiedAction(this.editorHistory.currentHistoryInfo)}this.selection.selectContent(this.owner.documentStart,!0),this.editorHistory&&(this.editorHistory.currentHistoryInfo=e,this.editorHistory.updateComplexHistory())}},e.prototype.deleteComment=function(){this.owner.isReadOnlyMode&&!this.documentHelper.isCommentOnlyMode||sf.base.isNullOrUndefined(this.owner)||sf.base.isNullOrUndefined(this.owner.viewer)||sf.base.isNullOrUndefined(this.owner.documentHelper.currentSelectedComment)||this.owner.enableHeaderAndFooter||!this.viewer.owner.enableComment||this.deleteCommentInternal(this.owner.documentHelper.currentSelectedComment)},e.prototype.deleteCommentInternal=function(e){if(this.initComplexHistory("DeleteComment"),e){var t=e.commentStart,i=e.commentEnd;if(-1!==i.indexInOwner&&this.removeInline(i),-1!==t.indexInOwner&&this.removeInline(t),t.removeCommentMark(),e.replyComments.length>0)for(var r=e.replyComments.length-1;r>=0;r--)this.deleteCommentInternal(e.replyComments[r]);this.owner.editorHistory&&(this.initHistory("DeleteCommentWidget"),this.owner.editorHistory.currentBaseHistoryInfo.insertPosition=this.getCommentHierarchicalIndex(e),this.owner.editorHistory.currentBaseHistoryInfo.removedNodes.push(e)),this.deleteCommentWidget(e),this.editorHistory&&this.editorHistory.updateHistory()}this.editorHistory&&this.editorHistory.updateComplexHistory()},e.prototype.deleteCommentWidget=function(e){var t,i=this.documentHelper.comments.indexOf(e);-1!==i?this.documentHelper.comments.splice(i,1):e.isReply&&e.ownerComment&&(i=e.ownerComment.replyComments.indexOf(e),e.ownerComment.replyComments.splice(i,1));var r={};r.comment=this.getCommentObj(e),t=JSON.stringify(r),this.owner.dotNetRef.invokeMethodAsync("DeleteCommentWidget",t)},e.prototype.resolveComment=function(e){this.owner.isReadOnlyMode&&!this.documentHelper.isCommentOnlyMode||this.resolveOrReopenComment(e,!0)},e.prototype.reopenComment=function(e){this.owner.isReadOnlyMode&&!this.documentHelper.isCommentOnlyMode||this.resolveOrReopenComment(e,!1)},e.prototype.resolveOrReopenComment=function(e,t){e.isResolved=t;for(var i=0;i<e.replyComments.length;i++)e.replyComments[i].isResolved=t},e.prototype.replyComment=function(e,t){if(!this.owner.isReadOnlyMode||this.documentHelper.isCommentOnlyMode){var i=e;if(e){this.initComplexHistory("InsertComment");var r=i.commentStart,n=i.commentEnd,o=r.line.getOffset(r,1),s=new Ft(this.documentHelper.owner);s.setPositionParagraph(r.line,o);var a=n.line.getOffset(n,1),l=new Ft(this.documentHelper.owner);l.setPositionParagraph(n.line,a),this.selection.start.setPositionInternal(s),this.selection.end.setPositionInternal(l),s=this.selection.start,l=this.selection.end;var h=new Ft(this.owner);h.setPositionInternal(l);var d=new nt(0),c=new nt(1),p=s.currentWidget===l.currentWidget;l.setPositionInternal(s),this.initInsertInline(d),p&&h.setPositionParagraph(h.currentWidget,h.offset+d.length),s.setPositionInternal(h),l.setPositionInternal(h),this.initInsertInline(c);var u=new ot(x.getUtcDate());u.author=this.owner.currentUser?this.owner.currentUser:"Guest user",u.text=t||"",u.commentId=Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15),u.isReply=!0,i.replyComments.push(u),u.ownerComment=i,this.owner.editorHistory&&(this.initHistory("InsertCommentWidget"),this.owner.editorHistory.currentBaseHistoryInfo.removedNodes.push(u)),d.comment=u,d.commentId=u.commentId,c.comment=u,c.commentId=u.commentId,u.commentStart=d,u.commentEnd=c,this.editorHistory&&(this.editorHistory.currentBaseHistoryInfo.insertPosition=this.getCommentHierarchicalIndex(u),this.editorHistory.updateHistory()),this.editorHistory&&this.editorHistory.updateComplexHistory(),this.reLayout(this.selection)}}},e.prototype.removeInline=function(e){this.selection.start.setPositionParagraph(e.line,e.line.getOffset(e,0)),this.selection.end.setPositionParagraph(this.selection.start.currentWidget,this.selection.start.offset+e.length),this.initHistory("RemoveInline"),this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&this.updateHistoryPosition(this.selection.start,!0),this.removeSelectedContents(this.documentHelper.selection),this.editorHistory&&this.editorHistory.updateHistory(),this.fireContentChange()},e.prototype.addCommentWidget=function(e,t,i,r){if(-1===this.documentHelper.comments.indexOf(e)){var n=!1;if(this.documentHelper.comments.length>0)for(var o=this.selection.getElementPosition(e.commentStart).startPosition,s=0;s<this.documentHelper.comments.length;s++){var a=this.selection.getElementPosition(this.documentHelper.comments[s].commentStart).startPosition;if(o.isExistBefore(a)){n=!0,this.documentHelper.comments.splice(s,0,e);break}}n||this.documentHelper.comments.push(e);var l,h={};h.comment=this.getCommentObj(e),h.index=this.documentHelper.comments.indexOf(e),h.isNewComment=t,l=JSON.stringify(h),this.owner.dotNetRef.invokeMethodAsync("AddCommentWidget",l)}},e.prototype.addReplyComment=function(e,t){var i,r=t.split(";"),n=this.documentHelper.comments[parseInt(r[1],10)];""!==r[2]&&(n.replyComments.splice(parseInt(r[2],10),0,e),e.ownerComment=n);var o={};o.comment=this.getCommentObj(e),o.index=n.replyComments.indexOf(e),i=JSON.stringify(o),this.owner.dotNetRef.invokeMethodAsync("AddReplyComment",i)},e.prototype.getCommentObj=function(e){var t={};return t.date=e.date,t.text=e.text,t.isReply=e.isReply,t.isResolved=e.isResolved,t.author=e.author,t.initial=e.initial,t.commentId=e.commentId,t.userColor=this.documentHelper.getAuthorColor(e.author),e.ownerComment&&e.ownerComment.commentId&&(t.ownerCommentId=e.ownerComment.commentId),t},e.prototype.addProtection=function(e,t){if(""===e)this.protectDocument(t);else{this.currentProtectionType=t;var i=new W,r={passwordBase64:this.base64.encodeString(e),saltBase64:"",spinCount:1e5},n=this.owner.serviceUrl+this.owner.serverActionSettings.restrictEditing;i.url=n,i.contentType="application/json;charset=UTF-8",i.onSuccess=this.enforceProtectionInternal.bind(this),i.onFailure=this.protectionFailureHandler.bind(this),i.onError=this.protectionFailureHandler.bind(this),i.customHeaders=this.owner.headers,i.send(r)}},e.prototype.toggleTrackChangesProtection=function(e){"RevisionsOnly"===this.currentProtectionType&&(this.viewer.owner.enableTrackChanges=e)},e.prototype.protectionFailureHandler=function(e){},e.prototype.enforceProtectionInternal=function(e,t){var i=JSON.parse(e.data);this.documentHelper.saltValue=i[0],this.documentHelper.hashValue=i[1],t&&(this.currentProtectionType=t),this.protectDocument(this.currentProtectionType)},e.prototype.protectDocument=function(e){this.protect(e),this.toggleTrackChangesProtection(!0),this.owner.trackChangesPane.enableDisableButton(!1)},e.prototype.stopProtection=function(e){if(this.documentHelper.isDocumentProtected){if(!sf.base.isNullOrUndefined(this.documentHelper.saltValue)&&""===this.documentHelper.saltValue&&!sf.base.isNullOrUndefined(this.documentHelper.hashValue)&&""===this.documentHelper.hashValue&&!sf.base.isNullOrUndefined(e)&&""===e)return void this.unProtectDocument();var t=new W,i={passwordBase64:this.base64.encodeString(e),saltBase64:this.documentHelper.saltValue,spinCount:1e5};t.url=this.owner.serviceUrl+this.owner.serverActionSettings.restrictEditing,t.contentType="application/json;charset=UTF-8",t.customHeaders=this.owner.headers,t.onSuccess=this.onUnProtectionSuccess.bind(this),t.onFailure=this.protectionFailureHandler.bind(this),t.onError=this.protectionFailureHandler.bind(this),t.send(i)}},e.prototype.onUnProtectionSuccess=function(e){var t=JSON.parse(e.data);this.validateHashValue(t[1])},e.prototype.validateHashValue=function(e){var t=this.base64.decodeString(e),i=this.documentHelper.hashValue,r=this.base64.decodeString(i),n=!0;if(t.length===r.length){for(var o=0;o<t.length;o++)if(t[o]!==r[o]){n=!1;break}}else n=!1;n&&this.unProtectDocument()},e.prototype.unProtectDocument=function(){var e=this.documentHelper.protectionType;this.documentHelper.isDocumentProtected=!1,this.documentHelper.restrictFormatting=!1,this.documentHelper.protectionType="NoProtection",this.documentHelper.saltValue="",this.documentHelper.hashValue="",this.documentHelper.selection.highlightEditRegion(),"RevisionsOnly"===e&&this.toggleTrackChangesProtection(!1),this.owner.trackChangesPane.enableDisableButton(!0),sf.base.isNullOrUndefined(this.editorHistory)||this.owner.editorHistory.clearHistory()},e.prototype.fireContentChange=function(){this.selection.isHighlightEditRegion&&this.selection.onHighlight(),this.selection.highlightFormFields(),this.isPaste||(this.copiedContent=void 0,this.copiedTextContent="",this.previousSectionFormat=void 0,this.previousParaFormat=void 0,this.previousCharFormat=void 0,this.selection.isViewPasteOptions=!1,this.isPasteListUpdated&&(this.isPasteListUpdated=!1),this.selection.showHidePasteOptions(void 0,void 0)),this.documentHelper.owner.isLayoutEnabled&&!this.documentHelper.owner.isShiftingEnabled&&this.documentHelper.owner.fireContentChange(),sf.base.isNullOrUndefined(this.selection.editPosition)||(this.triggerPageSpellCheck=!1)},e.prototype.updateSelectionTextPosition=function(e){this.getOffsetValue(this.selection),this.selection.start.updatePhysicalPosition(!0),this.selection.isEmpty?this.selection.end.setPositionInternal(this.selection.start):this.selection.end.updatePhysicalPosition(!0),this.selection.upDownSelectionLength=this.selection.end.location.x,this.selection.fireSelectionChanged(e)},e.prototype.predictText=function(){this.documentHelper.suffix="",this.selection.start.paragraph.isEmpty()||0===this.selection.start.offset&&this.selection.start.currentWidget.isFirstLine()||0===this.selection.end.offset&&this.selection.end.currentWidget.isFirstLine()?this.documentHelper.prefix="":this.getPrefixAndSuffix(),this.documentHelper.prefix="@"+String.fromCharCode(160)+this.documentHelper.prefix,this.documentHelper.editableDiv.innerText=this.documentHelper.prefix,this.documentHelper.selection.setEditableDivCaretPosition(this.documentHelper.prefix.length)},e.prototype.getPrefixAndSuffix=function(){var e=this.owner.documentHelper;if(""===this.selection.text){var t=0,i=this.selection.start.currentWidget.getInline(this.selection.start.offset,t),r=i.element;if(t=i.index,void 0!==r){var n=this.selection.getElementBoxInternal(r,t),o=n.element;t=n.index;var s=0;if(!sf.base.isNullOrUndefined(o)){var a=!1;for(o instanceof we&&t>0&&o.line.isFirstLine()&&(e.prefix=""),r instanceof we||(r=this.selection.getPreviousTextElement(r));(s=e.prefix.lastIndexOf(" "))<0&&r instanceof we;)if(r.previousNode instanceof we&&-1===e.prefix.indexOf(" ")){if(a?e.prefix=r.text+e.prefix:(e.prefix=r.text.substring(0,t),a=!0),(r=r.previousNode)instanceof je)break;r instanceof we||(r=this.selection.getPreviousTextElement(r))}else if(!(r.previousNode instanceof we)){a?e.prefix=r.text+e.prefix:(e.prefix=r.text.substring(0,t),a=!0);break}e.prefix.length>1&&" "===e.prefix[e.prefix.length-1]&&"."===e.prefix[e.prefix.length-2]?(s=-1,e.prefix=""):s=e.prefix.lastIndexOf(" "),e.prefix=s<0?e.prefix:e.prefix.substring(s),0===e.prefix.indexOf(" ")&&e.prefix.length>=1&&(e.prefix=e.prefix.substring(1));var l=0,h=this.selection.end.currentWidget.getInline(this.selection.end.offset,l),d=h.element;if(l=h.index,o=(n=this.selection.getElementBoxInternal(d,l)).element,l=n.index,o){var c=!1;for(o instanceof we&&l<o.length&&(e.suffix="");(s=e.suffix.indexOf(" "))<0&&d instanceof we;)if(d.nextNode instanceof we&&-1===e.suffix.indexOf(" "))c?e.suffix=e.suffix+d.text:(e.suffix=o.text.substring(l),c=!0),d=d.nextNode;else if(!(d.nextNode instanceof we)){c?e.suffix=e.suffix+d.text:(e.suffix=o.text.substring(l),c=!0);break}s=e.suffix.indexOf(" "),e.suffix=s<0?e.suffix:e.suffix.substring(0,s)}}}}else e.prefix=""},e.prototype.onKeyDownInternal=function(e,t,i,r){var n=e.which||e.keyCode;if(!t||i||r)if(!i||t||r)if(i&&t&&!r)switch(n){case 13:this.owner.isReadOnlyMode||(e.preventDefault(),this.insertColumnBreak());break;case 68:this.owner.isReadOnlyMode||this.owner.selection.toggleUnderline("Double");break;case 77:this.owner.isReadOnlyMode||this.owner.selection.decreaseIndent(),e.preventDefault();break;case 188:e.preventDefault(),this.owner.isReadOnlyMode||this.onApplyCharacterFormat("fontSize","decrement",!0);break;case 190:e.preventDefault(),this.owner.isReadOnlyMode||this.onApplyCharacterFormat("fontSize","increment",!0);break;case 187:e.preventDefault(),this.owner.isReadOnlyMode||this.toggleBaselineAlignment("Superscript");break;case 69:if(e.preventDefault(),!this.owner.isReadOnlyMode)this.owner.enableTrackChanges}else if(!i&&t&&r)switch(n){case 72:e.preventDefault(),!this.owner.isReadOnlyMode&&this.owner.isDocumentLoaded&&this.toggleHighlightColor();break;case 70:e.preventDefault(),!this.owner.isReadOnlyMode&&this.owner.isDocumentLoaded&&this.insertFootnote();break;case 68:e.preventDefault(),!this.owner.isReadOnlyMode&&this.owner.isDocumentLoaded&&this.insertEndnote()}else switch(n){case 8:e.preventDefault(),this.handleBackKey();break;case 9:e.preventDefault(),this.owner.acceptTab&&this.selection.handleTabKey(!0,!1);break;case 13:e.preventDefault(),this.documentHelper.triggerSpellCheck=!0,this.handleEnterKey(),this.documentHelper.triggerSpellCheck=!1;break;case 27:e.preventDefault(),this.isPaste||(this.copiedContent=void 0,this.copiedTextContent="",this.previousParaFormat=void 0,this.previousCharFormat=void 0,this.previousSectionFormat=void 0,this.selection.isViewPasteOptions=!1,this.isPasteListUpdated&&(this.isPasteListUpdated=!1),this.selection.showHidePasteOptions(void 0,void 0));break;case 46:this.handleDelete(),e.preventDefault();break;case 32:this.selection.handleSpaceBarKey();break;case 120:var o=this.selection.getDocumentEnd();o.offset=this.selection.getDocumentEnd().offset+1,this.selection.start.isAtSamePosition(this.selection.getDocumentStart())&&this.selection.end.isAtSamePosition(o)?this.owner.updateFields():this.selection.updateRefField()}else switch(n){case 9:e.preventDefault(),this.owner.acceptTab&&this.selection.handleTabKey(!1,!0);break;case 13:this.handleShiftEnter(),e.preventDefault()}else switch(this.documentHelper.isControlPressed=!0,n){case 8:e.preventDefault(),this.handleCtrlBackKey();break;case 46:e.preventDefault(),this.handleCtrlDelete();break;case 9:e.preventDefault(),this.owner.acceptTab&&this.selection.handleTabKey(!1,!1);break;case 13:e.preventDefault(),this.insertPageBreak();break;case 48:e.preventDefault();var s=0,a=this.documentHelper.selection.start.paragraph.paragraphFormat.beforeSpacing;a>12?s=12:a>0&&a<=12?s=0:0===a&&(s=12),this.onApplyParagraphFormat("beforeSpacing",s,!0,!1);break;case 49:e.preventDefault(),this.owner.isReadOnlyMode&&!this.selection.isInlineFormFillMode()||this.onApplyParagraphFormat("lineSpacing",1,!1,!1);break;case 50:e.preventDefault(),this.owner.isReadOnlyMode&&!this.selection.isInlineFormFillMode()||this.onApplyParagraphFormat("lineSpacing",2,!1,!1);break;case 53:e.preventDefault(),this.owner.isReadOnlyMode&&!this.selection.isInlineFormFillMode()||this.onApplyParagraphFormat("lineSpacing",1.5,!1,!1);break;case 66:e.preventDefault(),this.owner.isReadOnlyMode&&!this.selection.isInlineFormFillMode()||this.toggleBold();break;case 68:e.preventDefault(),this.owner.showDialog("Font");break;case 69:this.owner.isReadOnlyMode&&!this.selection.isInlineFormFillMode()||this.toggleTextAlignment("Center"),e.preventDefault();break;case 72:e.preventDefault(),this.owner.isReadOnly||this.owner.showDialog("ReplacePane");break;case 73:e.preventDefault(),this.owner.isReadOnlyMode&&!this.selection.isInlineFormFillMode()||this.toggleItalic();break;case 74:this.owner.isReadOnlyMode&&!this.selection.isInlineFormFillMode()||this.toggleTextAlignment("Justify"),e.preventDefault();break;case 75:e.preventDefault(),this.owner.showDialog("Hyperlink");break;case 76:this.owner.isReadOnlyMode&&!this.selection.isInlineFormFillMode()||this.toggleTextAlignment("Left"),e.preventDefault();break;case 77:this.owner.isReadOnlyMode&&!this.selection.isInlineFormFillMode()||this.owner.selection.increaseIndent(),e.preventDefault();break;case 78:e.preventDefault(),this.owner.isReadOnlyMode||this.owner.openBlank();break;case 82:this.owner.isReadOnlyMode&&!this.selection.isInlineFormFillMode()||this.toggleTextAlignment("Right"),e.preventDefault();break;case 85:e.preventDefault(),this.owner.isReadOnlyMode&&!this.selection.isInlineFormFillMode()||this.owner.selection.toggleUnderline("Single");break;case 88:e.preventDefault(),this.owner.isReadOnlyMode||this.owner.editor.cut();break;case 89:this.owner.enableEditorHistory&&(this.editorHistory.redo(),e.preventDefault());break;case 90:this.owner.enableEditorHistory&&(this.editorHistory.undo(),e.preventDefault());break;case 219:e.preventDefault(),this.owner.isReadOnlyMode&&!this.selection.isInlineFormFillMode()||this.onApplyCharacterFormat("fontSize","decrement",!0);break;case 221:e.preventDefault(),this.owner.isReadOnlyMode&&!this.selection.isInlineFormFillMode()||this.onApplyCharacterFormat("fontSize","increment",!0);break;case 187:e.preventDefault(),this.owner.isReadOnlyMode&&!this.selection.isInlineFormFillMode()||this.toggleBaselineAlignment("Subscript")}},e.prototype.handleShiftEnter=function(){this.owner.isReadOnlyMode||this.handleTextInput("\v"),this.selection.checkForCursorVisibility()},e.prototype.handleBackKey=function(){(!this.owner.isReadOnlyMode&&this.canEditContentControl||this.selection.isInlineFormFillMode())&&this.owner.editorModule.onBackSpace(),this.selection.checkForCursorVisibility()},e.prototype.handleDelete=function(){(!this.owner.isReadOnlyMode&&this.canEditContentControl||this.selection.isInlineFormFillMode())&&this.owner.editorModule.delete(),this.selection.checkForCursorVisibility()},e.prototype.handleEnterKey=function(){(!this.owner.isReadOnlyMode&&this.canEditContentControl||this.selection.isInlineFormFillMode())&&(sf.base.Browser.isDevice&&(this.documentHelper.isCompositionStart=!1),this.owner.editorModule.onEnter()),this.selection.checkForCursorVisibility()},e.prototype.handleCtrlBackKey=function(){var e=this.selection.start,t=this.selection.end;if(!this.owner.isReadOnlyMode||this.selection.isInlineFormFillMode())if(this.selection.isForward||(e=t),this.selection.isEmpty)this.selection.handleControlShiftLeftKey(),this.owner.editorModule.onBackSpace();else{if((sf.base.isNullOrUndefined(e.paragraph.previousRenderedWidget)||e.paragraph.previousRenderedWidget instanceof de)&&0===e.offset)return;this.selection.handleLeftKey(),this.selection.handleControlShiftLeftKey(),this.owner.editorModule.onBackSpace()}},e.prototype.handleCtrlDelete=function(){if(!this.owner.isReadOnlyMode&&this.canEditContentControl||this.selection.isInlineFormFillMode())if(this.selection.isEmpty)this.selection.handleControlShiftRightKey(),this.owner.editorModule.delete();else{this.selection.handleLeftKey(),this.selection.handleControlShiftRightKey();var e=this.selection.text;x.endsWith(e)&&this.selection.handleShiftLeftKey(),this.owner.editorModule.delete()}},e.prototype.handleTextInput=function(e){var t=this;(!this.owner.isReadOnlyMode&&this.canEditContentControl||this.selection.isInlineFormFillMode())&&(this.animationTimer&&clearTimeout(this.animationTimer),sf.base.classList(this.selection.caret,[],["e-de-cursor-animation"]),this.owner.editorModule.insertText(e),this.animationTimer=setTimeout((function(){t.animationTimer&&clearTimeout(t.animationTimer),t.selection&&t.selection.caret&&sf.base.classList(t.selection.caret,["e-de-cursor-animation"],[])}),600)),this.selection.checkForCursorVisibility()},e.prototype.copyInsertFormat=function(e,t){var i=new P,r=this.selection.characterFormat;return t&&i.copyFormat(e),sf.base.isNullOrUndefined(r.bidi)||e.bidi===r.bidi||(i.bidi=r.bidi),sf.base.isNullOrUndefined(r.bold)||e.bold===r.bold||(i.bold=r.bold),sf.base.isNullOrUndefined(r.italic)||e.italic===r.italic||(i.italic=r.italic),r.fontSize>0&&e.fontSize!==r.fontSize&&(i.fontSize=r.fontSize),sf.base.isNullOrUndefined(r.fontFamily)||e.fontFamily===r.fontFamily||(i.fontFamily=r.fontFamily),sf.base.isNullOrUndefined(r.highlightColor)||e.highlightColor===r.highlightColor||(i.highlightColor=r.highlightColor),sf.base.isNullOrUndefined(r.baselineAlignment)||e.baselineAlignment===r.baselineAlignment||(i.baselineAlignment=r.baselineAlignment),sf.base.isNullOrUndefined(r.fontColor)||e.fontColor===r.fontColor||(i.fontColor=r.fontColor),sf.base.isNullOrUndefined(r.underline)||e.underline===r.underline||(i.underline=r.underline),sf.base.isNullOrUndefined(r.strikethrough)||e.strikethrough===r.strikethrough||(i.strikethrough=r.strikethrough),i},e.prototype.getResultContentControlText=function(e){for(var t=e.nextNode,i="";!(t instanceof Oe||(t instanceof we&&(i+=t.text),sf.base.isNullOrUndefined(t)));)if(sf.base.isNullOrUndefined(t.nextNode)){if(!t.paragraph.nextRenderedWidget)break;t=t.paragraph.nextRenderedWidget.firstChild.children[0]}else t=t.nextNode;return i},e.prototype.updateXmlMappedContentControl=function(){if(this.isXmlMapped){var e=this.getContentControl();e&&e.contentControlProperties&&this.updateCustomXml(e.contentControlProperties.xmlMapping.storeItemId,e.contentControlProperties.xmlMapping.xPath,this.getResultContentControlText(e))}},e.prototype.updateCustomXml=function(e,t,i){if(this.documentHelper.customXmlData.containsKey(e)){var r=this.documentHelper.customXmlData.get(e),n=(new DOMParser).parseFromString(r,"text/xml"),o=t.substring(t.lastIndexOf("/")+1);o=(o=(o=o.split("[")[0]).substring(o.lastIndexOf(":")+1)).substring(o.lastIndexOf("@")+1);var s=n.getElementsByTagName(o);if(s.length>0)s[0].childNodes[0].nodeValue=i;else{if(!(n.documentElement.attributes.length>0&&null!==n.documentElement.attributes.getNamedItem(o)))return;n.documentElement.attributes.getNamedItem(o).value=i}var a=(new XMLSerializer).serializeToString(n);this.documentHelper.customXmlData.set(e,a)}},e.prototype.insertText=function(e){sf.base.isNullOrUndefined(e)||""===e||this.insertTextInternal(e,!1)},e.prototype.insertTextInternal=function(e,t,i,r){if(e.indexOf("\r")>=0||e.indexOf("\n")>=0)"\r"===e||"\n"===e||"\r\n"===e?this.onEnter():(this.isInsertText=!0,this.pasteContents(e),this.isInsertText=!1);else{if("FormFieldsOnly"===this.documentHelper.protectionType&&this.selection.isInlineFormFillMode()){var n=this.selection.getCurrentFormField(),o=this.getFieldResultText(n),s=new RegExp(this.owner.documentHelper.textHelper.getEnSpaceCharacter(),"gi");o.length>0&&""===o.replace(s,"")&&(o="",this.selection.selectFieldInternal(n));var a=n.formFieldData.maxLength;if(0!==a&&o.length>=a)return}t&&(this.documentHelper.layout.isReplaceAll=!sf.base.isNullOrUndefined(r)&&!r);var l,h=this.documentHelper.selection,d=!0;i=this.owner.enableTrackChanges&&sf.base.isNullOrUndefined(i)?"Insertion":i,this.isListTextSelected(),h.bookmarks.length>0&&this.extendSelectionToBookmarkStart(),(sf.base.isNullOrUndefined(i)||"Insertion"===i)&&this.initHistory("Insert");var c=this.selection.getParagraphInfo(h.start),p=c.paragraph.paragraphFormat;h.editPosition=h.getHierarchicalIndex(c.paragraph,c.offset.toString());var u=h.start.paragraph.paragraphFormat.bidi;if(!h.isEmpty&&!h.isImageSelected||this.documentHelper.isListTextSelected&&"List"===h.contextType){h.isSkipLayouting=!0,h.skipFormatRetrieval=!0;var g=void 0,f=void 0,m=0,y=0;if(this.owner.enableTrackChanges&&(this.selection.start.isExistBefore(this.selection.end)?(f=this.selection.getParagraphInfo(h.end),g=this.selection.end.clone()):(f=this.selection.getParagraphInfo(h.start),g=this.selection.start.clone()),y=f.paragraph.getLength(),m=f.offset,this.skipReplace=!0),d=this.removeSelectedContents(h),this.skipReplace=!1,!sf.base.isNullOrUndefined(g)&&this.owner.search&&this.owner.search.isRepalceTracking)this.owner.search.isRepalceTracking=!1,this.selection.start.setPositionInternal(this.selection.start),this.selection.end.setPositionInternal(g);else if(m>0){var v=f.paragraph.getLength();y!==v&&(m-=y-v),this.setPositionParagraph(f.paragraph,m,!0)}h.skipFormatRetrieval=!1,h.isSkipLayouting=!1}else!h.isEmpty||this.documentHelper.isListTextSelected||t||(this.documentHelper.isTextInput=!0);(c=this.selection.getParagraphInfo(h.start)).paragraph.paragraphFormat.copyFormat(p);var b=this.documentHelper.textHelper.containsSpecialCharAlone(e);if(d){if(h.owner.isShiftingEnabled=!0,this.updateInsertPosition(),(l=h.start).paragraph.isEmpty()){var w=new we,x=this.copyInsertFormat(l.paragraph.characterFormat,!0);w.characterFormat.copyFormat(x),w.text=e;var M=this.documentHelper.textHelper.getRtlLanguage(e).isRtl||this.selection.characterFormat.bidi;if(w.characterFormat.bidi=M,w.isRightToLeft=M,w.line=l.paragraph.childWidgets[0],w.margin=new te(0,0,0,0),w.line.children.push(w),this.owner.enableTrackChanges)if(w.paragraph.characterFormat.revisions.length>0){var N=this.getMatchedRevisionsToCombine(w.paragraph.characterFormat.revisions,i);N.length>0&&this.mapMatchedRevisions(N,w.paragraph.characterFormat,w,!0)}else this.checkToCombineRevisionWithPrevPara(w,i)||this.insertRevision(w,i);"Center"!==l.paragraph.paragraphFormat.textAlignment&&"Right"!==l.paragraph.paragraphFormat.textAlignment||-1!==l.paragraph.paragraphFormat.listFormat.listId||(l.paragraph.x=this.owner.viewer.clientActiveArea.x),this.documentHelper.layout.reLayoutParagraph(l.paragraph,0,0)}else{var I=0,S=l.currentWidget.getInline(l.offset,I,u,!t);n=S.element;I=S.index,n.ischangeDetected=!0,n instanceof we&&" "!==e&&this.documentHelper.owner.isSpellCheck&&(this.owner.spellChecker.removeErrorsFromCollection({element:n,text:n.text}),t||(n.ignoreOnceItems=[])),n.canTrigger&&n.text.length<=1&&(n.canTrigger=!1);x=this.copyInsertFormat(n.characterFormat,!0),M=this.documentHelper.textHelper.getRtlLanguage(e).isRtl||this.selection.characterFormat.bidi,this.documentHelper.textHelper.getRtlLanguage(e).id;var C=0,O=!1,T=!1;if(n instanceof we&&(C=this.documentHelper.textHelper.getRtlLanguage(n.text).id,O=this.documentHelper.textHelper.getRtlLanguage(n.text).isRtl,T=this.documentHelper.textHelper.containsSpecialCharAlone(e)),(!M&&n.characterFormat.bidi&&(0!==C||T&&O)||" "===e&&this.selection.characterFormat.bidi)&&(M=!0),!M&&this.documentHelper.owner.isSpellCheck||(x.bidi=M),(!this.documentHelper.owner.isSpellCheck||" "!==e&&" "!==n.text)&&x.isSameFormat(n.characterFormat)&&this.canInsertRevision(n,i)||""===e.trim()&&!M&&n.characterFormat.bidi||O&&x.isSameFormat(n.characterFormat)&&b)this.insertTextInline(n,h,e,I);else{var P=new we;P.text=e,P.line=n.line,P.isRightToLeft=O,P.characterFormat.copyFormat(x),n instanceof Me&&(P.characterFormat.baselineAlignment="Normal");var A=!1,L=n.indexInOwner,F=P.revisions.length;if(I===n.length){var D;D=L+1,!this.owner.enableTrackChanges||n instanceof Ce||(A=this.checkToMapRevisionWithInlineText(n,I,P,M,i))||P.revisions.length!==F||(A=null!=n.nextNode&&1==n.nextNode.revisions.length?this.checkToMapRevisionWithNextNode(n.nextNode,P,M,i):1==n.paragraph.characterFormat.revisions.length&&"Deletion"==n.paragraph.characterFormat.revisions[0].revisionType?this.checkToMapRevisionWithNextNode(n.nextNode,P,M,i,n.paragraph):this.checkToMapRevisionWithNextNode(n.nextNode,P,M,i)),A||(n.line.children.splice(D,0,P),this.checkToCombineRevisionsinBlocks(P,F===P.revisions.length,!0,i))}else if(0===I)this.owner.enableTrackChanges&&((A=this.checkToMapRevisionWithInlineText(n,I,P,M,i))||0!==P.revisions.length||this.checkToMapRevisionWithPreviousNode(n.previousNode,P,M,i)),A||(n.line.children.splice(L,0,P),this.checkToCombineRevisionsinBlocks(P,F===P.revisions.length,!0,i));else{if(n instanceof we){var E=new we;E.line=n.line,E.characterFormat.copyFormat(n.characterFormat),E.text=n.text.substring(I),this.owner.enableTrackChanges||this.selection.isInField||this.updateRevisionForSpittedTextElement(n,E),n.text=n.text.slice(0,I),this.owner.enableTrackChanges?(A=this.checkToMapRevisionWithInlineText(n,I,P,M,i))||P.revisions.length>F?this.copyElementRevision(n,E,!0):P.revisions.length===F&&(this.updateRevisionForSpittedTextElement(n,E),this.insertRevision(P,i)):this.selection.isInField&&(this.copyElementRevision(n,E,!1),this.updateElementInFieldRevision(n,P,n.revisions,!0)),this.owner.isSpellCheck&&this.owner.spellChecker.updateSplittedElementError(n,E),n.line.children.splice(L+1,0,E)}A||n.line.children.splice(L+1,0,P)}this.documentHelper.layout.reLayoutParagraph(l.paragraph,n.line.indexInOwner,0)}}this.documentHelper.layout.allowLayout=!0,this.setPositionParagraph(c.paragraph,c.offset+e.length,!0),this.updateEndPosition(),sf.base.isNullOrUndefined(this.editorHistory)||sf.base.isNullOrUndefined(this.editorHistory.currentHistoryInfo)||"ListSelect"!==this.editorHistory.currentHistoryInfo.action||!this.documentHelper.isListTextSelected||(this.editorHistory.updateHistory(),this.editorHistory.updateComplexHistory()),(sf.base.isNullOrUndefined(i)||"Insertion"===i)&&this.reLayout(h),this.documentHelper.isTextInput=!1}if(this.updateXmlMappedContentControl(),!t&&d&&(" "===e||"\t"===e||"\v"===e)){var z=!1;if("\v"!==e&&(z=this.checkAndConvertList(h,"\t"===e)),!z){if(!sf.base.isNullOrUndefined(h.getHyperlinkField()))return;this.checkAndConvertToHyperlink(h,!1)}}}},e.prototype.extendSelectionToBookmarkStart=function(){if(this.documentHelper.bookmarks.length>0){var e=this.selection.start;this.selection.end;this.selection.isForward||(e=this.selection.end,this.selection.start);for(var t=void 0,i=this.selection.bookmarks,r=0;r<i.length;r++)if(t=this.documentHelper.bookmarks.get(i[r]),this.selection.isElementInSelection(t.reference,!1)&&!this.selection.isElementInSelection(t,!0)){var n=t.line.paragraph,o=this.selection.getParagraphInfo(e);if(n.equals(o.paragraph)){var s=t.line.getOffset(t,t.bookmarkType);t.line===e.currentWidget&&o.offset===s+1&&e.offset--}}}},e.prototype.updateElementInFieldRevision=function(e,t,i,r){for(var n=0;n<i.length;n++){var o=i[n],s=o.range.indexOf(e);o.range.splice(r?s+1:s,0,t)}},e.prototype.retrieveFieldResultantText=function(e){var t="";if(1===e.fieldType)for(var i=e.previousElement;!sf.base.isNullOrUndefined(i)&&i instanceof we;)t=i.text+t,i=sf.base.isNullOrUndefined(i.previousNode)?void 0:i.previousNode.previousValidNodeForTracking;return t},e.prototype.checkToCombineRevisionsinBlocks=function(e,t,i,r){if(t&&this.owner.enableTrackChanges&&!(e instanceof Ce||e instanceof nt||e instanceof He||e instanceof Ue)){(i?this.combineRevisionWithNextPara(e,r):this.combineRevisionWithPrevPara(e,r))||this.insertRevision(e,r)}},e.prototype.checkToMapRevisionWithNextNode=function(e,t,i,r,n){if(!sf.base.isNullOrUndefined(n)&&1==n.characterFormat.revisions.length){var o=n.characterFormat;return!sf.base.isNullOrUndefined(o)&&this.checkToMapRevisionWithInlineText(void 0,0,t,i,r,o)}if(sf.base.isNullOrUndefined(e))return!1;var s=e.nextValidNodeForTracking;return!sf.base.isNullOrUndefined(s)&&this.checkToMapRevisionWithInlineText(s,0,t,i,r)},e.prototype.checkToMapRevisionWithPreviousNode=function(e,t,i,r){if(sf.base.isNullOrUndefined(e))return!1;var n=e.previousValidNodeForTracking;return!sf.base.isNullOrUndefined(n)&&this.checkToMapRevisionWithInlineText(n,n.length,t,i,r)},e.prototype.checkToMapRevisionWithInlineText=function(e,t,i,r,n,o){if(sf.base.isNullOrUndefined(o)){if(!sf.base.isNullOrUndefined(e))if("Deletion"===n&&this.updateLastElementRevision(i),e.length===t&&null!=e.previousValidNodeForTracking){if(t=(e=e.previousValidNodeForTracking).length,e.revisions.length>0)return this.applyMatchedRevisionInorder(e,i,t,!1,r,n)}else if(0===t&&(e=e.nextValidNodeForTracking,!sf.base.isNullOrUndefined(e)&&e.revisions.length>0))return this.applyMatchedRevisionInorder(e,i,t,!0,r,n)}else if("Deletion"===n&&this.updateLastElementRevision(i),!sf.base.isNullOrUndefined(o)&&o.revisions.length>0)return this.applyMatchedRevisionInorder(void 0,i,t,!0,r,n,o);return!1},e.prototype.combineElementRevisions=function(e,t){if(0!==e.revisions.length&&0!==t.revisions.length)for(var i=0;i<e.revisions.length;i++)for(var r=e.revisions[i],n=0;n<t.revisions.length;n++){var o=t.revisions[i];-1===r.range.indexOf(t)&&o.revisionType===r.revisionType&&o.author===r.author&&(t.revisions.splice(n,1),r.range.push(t),t.revisions.splice(n,0,r))}},e.prototype.applyMatchedRevisionInorder=function(e,t,i,r,n,o,s){var a;return!sf.base.isNullOrUndefined(s)&&sf.base.isNullOrUndefined(e)?((a=this.getMatchedRevisionsToCombine(s.revisions,o)).length>0&&this.mapMatchedRevisions(a,s,t,r),!1):((a=this.getMatchedRevisionsToCombine(e.revisions,o)).length>0&&this.mapMatchedRevisions(a,e,t,r),!1)},e.prototype.copyElementRevision=function(e,t,i){if(!this.isTrackingFormField)for(var r=0;r<e.revisions.length;r++){var n=e.revisions[r],o=n.range.indexOf(e);t.revisions.splice(0,0,n),n.range.splice(o+(i?2:1),0,t)}},e.prototype.mapMatchedRevisions=function(e,t,i,r){for(var n=0;n<e.length;n++){var o=e[n];if(!this.isRevisionAlreadyIn(i,o)||i instanceof P){i.revisions.splice(0,0,o);var s=o.range.indexOf(t);o.range.splice(r?s:s+1,0,i)}}},e.prototype.isRevisionAlreadyIn=function(e,t){if(e.revisions.length>0)for(var i=0;i<e.revisions.length;i++){if(e.revisions[i].revisionID===t.revisionID)return!0}return!1},e.prototype.getMatchedRevisionsToCombine=function(e,t){for(var i=[],r=0;r<e.length;r++)this.isRevisionMatched(e[r],t)&&i.push(e[r]);return i},e.prototype.decideInlineForTrackChanges=function(e,t){var i=!1;if(this.owner.enableTrackChanges&&!this.canInsertRevision(e,t)){var r=e.nextValidNodeForTracking;!sf.base.isNullOrUndefined(r)&&this.canInsertRevision(r,t)&&(e=r,i=!0)}return{element:e,isMatched:i}},e.prototype.insertIMEText=function(e,t){if(this.documentHelper.lastComposedText!==e||!t){var i=this.selection.getParagraphInfo(this.selection.start),r=this.selection.getHierarchicalIndex(i.paragraph,i.offset.toString());this.insertText(e),this.documentHelper.lastComposedText=e;var n=this.selection.start;this.setPositionForCurrentIndex(n,r);var o=new Ft(this.owner);o.setPositionForLineWidget(n.currentWidget,n.offset+e.length),this.selection.selectPosition(t?n:o,o)}},e.prototype.insertSectionBreak=function(e){sf.base.isNullOrUndefined(e)&&(e=o.NewPage);var t=this.documentHelper.selection;sf.base.isNullOrUndefined(t)||this.owner.isReadOnlyMode||t.start.paragraph.isInHeaderFooter||(e===o.Continuous?this.initHistory("SectionBreakContinuous"):this.initHistory("SectionBreak"),t.isEmpty||t.selectContent(t.isForward?t.start:t.end,!0),this.documentHelper.owner.isShiftingEnabled=!0,this.updateInsertPosition(),e===o.Continuous?this.insertSection(t,!0,void 0,!0):this.insertSection(t,!0),this.updateEndPosition(),this.reLayout(t,!0),this.layoutWholeDocument(!0))},e.prototype.combineRevisionWithBlocks=function(e,t){if(this.owner.enableTrackChanges&&!sf.base.isNullOrUndefined(e)){for(;e instanceof Ce||e instanceof nt;)e=e.nextElement;if(!sf.base.isNullOrUndefined(e)){var i=e.paragraph.previousRenderedWidget;if(!(i instanceof de)){if(!sf.base.isNullOrUndefined(i)&&!i.isEmpty()&&i.characterFormat.revisions.length>0){var r=i.lastChild;if(sf.base.isNullOrUndefined(r)||0===r.children.length)return;for(var n=r.children[r.children.length-1];n instanceof Ce||n instanceof nt;)n=n.previousElement;if(n.revisions.length>0&&this.compareElementRevision(i.characterFormat,e)){var o=e.revisions[e.revisions.length-1];if(this.compareElementRevision(n,e))o!==(h=n.revisions[n.revisions.length-1])&&this.clearAndUpdateRevisons(o.range,h,h.range.indexOf(n)+1)}}i=null;var s=e.paragraph.lastChild,a=(e=s.children[s.children.length-1]).paragraph.nextRenderedWidget;if(!(a instanceof de)){if(!sf.base.isNullOrUndefined(a)&&!a.isEmpty()&&e.paragraph.characterFormat.revisions.length>0){for(var l=a.firstChild.children[0];l instanceof Ce||l instanceof nt;)l=l.previousElement;if(sf.base.isNullOrUndefined(l))return;if(l.revisions.length>0){var h,d=l.revisions[l.revisions.length-1];if(this.compareElementRevision(e.paragraph.characterFormat,l))if(this.compareElementRevision(e,l))d!==(h=e.revisions[e.revisions.length-1])&&this.clearAndUpdateRevisons(d.range,h,h.range.indexOf(e)+1)}}0===e.revisions.length&&this.insertRevision(e,t)}}}}},e.prototype.checkToCombineRevisionWithNextPara=function(e,t){var i=e.paragraph.nextRenderedWidget;if(i instanceof de)return!1;if(!sf.base.isNullOrUndefined(i)&&!i.isEmpty()){for(var r=i.firstChild.children[0];r instanceof Ce||r instanceof nt;)r=r.previousElement;if(sf.base.isNullOrUndefined(r))return!1;if(r.revisions.length>0){var n=this.getMatchedRevisionsToCombine(r.revisions,t);if(n.length>0)return this.mapMatchedRevisions(n,r,e,!0),!0}}return!1},e.prototype.checkToCombineRevisionWithPrevPara=function(e,t){var i=e.paragraph.previousRenderedWidget;if(i instanceof de)return!1;if(!sf.base.isNullOrUndefined(i)&&i.characterFormat.revisions.length>0){if(!this.isRevisionMatched(i.characterFormat,t))return!1;var r=this.getMatchedRevisionsToCombine(i.characterFormat.revisions,t);if(r.length>0)return this.mapMatchedRevisions(r,i.characterFormat,e,!1),!0}return!1},e.prototype.combineRevisionWithNextPara=function(e,t){var i=e.line.isLastLine(),r=e.nextNode;return!(!i||!sf.base.isNullOrUndefined(r))&&this.checkToCombineRevisionWithNextPara(e,t)},e.prototype.combineRevisionWithPrevPara=function(e,t){var i=e.line.isFirstLine(),r=e.previousNode;return!(!i||!sf.base.isNullOrUndefined(r))&&this.checkToCombineRevisionWithPrevPara(e,t)},e.prototype.removeRevision=function(e){var t=this.selection.start.currentWidget.getInline(this.selection.start.offset+1,0),i=t.element;if(t.element.revisions.length>0)for(var r=0;r<i.revisions.length;r++)if(i.revisions[r].revisionType===e.revisionType)for(var n=i.revisions[r],o=n.range.indexOf(i),s=o;o<n.range.length;o++)n.range[s].revisions.splice(r,1),n.range.splice(s,1)},e.prototype.clearElementRevision=function(e){if(!sf.base.isNullOrUndefined(e))for(var t=0;t<e.range.length;t++)if(e.range[t]instanceof ge){var i=e.range[t];i.revisions.splice(i.revisions.length-1,1),e.range.splice(t,1)}},e.prototype.insertRevision=function(e,t,i,r,n){i=sf.base.isNullOrUndefined(i)?this.owner.currentUser?this.owner.currentUser:"Guest user":i;var o=sf.base.isNullOrUndefined(r)?x.getUtcDate():r;if(e instanceof ge&&!sf.base.isNullOrUndefined(e.line)&&e.line.paragraph.associatedCell||e instanceof P&&e.ownerBase instanceof le&&e.ownerBase.associatedCell){var s=void 0;if(e instanceof ge?s=e.line.paragraph.associatedCell:e instanceof P&&(s=e.ownerBase.associatedCell),s.ownerRow.rowFormat.revisions.length>0){var a=s.ownerRow.rowFormat,l=this.getMatchedRevisionsToCombine(a.revisions,t);if(l.length>0){for(var h=0;h<l.length;h++)e.revisions.splice(0,0,l[h]),l[h].range.push(e);return}}}var d=new O(this.owner,i,o);d.revisionType=t,d.revisionID=Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15),!sf.base.isNullOrUndefined(n)&&n.length>0&&this.clearAndUpdateRevisons(n,d,n.indexOf(e)),sf.base.isNullOrUndefined(e)||(e.revisions.push(d),d.range.push(e)),this.updateRevisionCollection(d)},e.prototype.clearAndUpdateRevisons=function(e,t,i){for(var r=0;r<e.length;r++)if(e[r]instanceof ge){var n=e[r];n.revisions.splice(n.revisions.length-1,1),n.revisions.push(t),t.range.splice(i+r,0,n)}},e.prototype.splitRevisionByElement=function(e,t){if(e.revisions.length>0){var i=t.range,r=i.indexOf(e);return t.range=i.splice(0,r+1),i}},e.prototype.updateRevisionForSpittedTextElement=function(e,t){for(var i=0;i<e.revisions.length;i++){var r=e.revisions[i],n=this.splitRevisionByElement(e,r);this.insertRevision(t,r.revisionType,r.author,r.date,n)}},e.prototype.isRevisionMatched=function(e,t){var i=this.owner.currentUser?this.owner.currentUser:"Guest user";if(e instanceof O){if((sf.base.isNullOrUndefined(t)||t===e.revisionType)&&e.author===i)return!0}else if(e.revisions.length>0)for(var r=0;r<e.revisions.length;r++){var n=e.revisions[r];if((sf.base.isNullOrUndefined(t)||t===n.revisionType)&&n.author===i)return!0}return!1},e.prototype.compareElementRevision=function(e,t){if(0===e.revisions.length||0===t.revisions.length)return!1;for(var i=0;i<e.revisions.length;i++)for(var r=e.revisions[i],n=0;n<t.revisions.length;n++)if(r.author===t.revisions[i].author&&r.revisionType===t.revisions[i].revisionType)return!0;return!1},e.prototype.canInsertRevision=function(e,t){var i=sf.base.isNullOrUndefined(t)?"Insertion":t;return"Deletion"!==i&&(this.owner.enableTrackChanges?this.isRevisionMatched(e,i):!(e.revisions.length>0))},e.prototype.insertRevisionAtEnd=function(e,t,i){return!(t instanceof Ce||t instanceof nt||t instanceof He||t instanceof Ue)&&(e=e.previousValidNodeForTracking,!sf.base.isNullOrUndefined(e)&&this.insertRevisionAtPosition(e,t,!0,i))},e.prototype.insertRevisionAtPosition=function(e,t,i,r){var n=t.revisions.length,o=this.checkToMapRevisionWithInlineText(e,i?e.length:0,t,!1,r);return i?o||t.revisions.length!==n||(o=this.checkToMapRevisionWithNextNode(e.nextNode,t,!1,r)):o||t.revisions.length!==n||(o=this.checkToMapRevisionWithPreviousNode(e.previousNode,t,!1,r)),o},e.prototype.insertRevisionAtBegining=function(e,t,i){return!(t instanceof Ce||t instanceof nt||t instanceof He||t instanceof Ue)&&(e=e.nextValidNodeForTracking,!sf.base.isNullOrUndefined(e)&&this.insertRevisionAtPosition(e,t,!1,i))},e.prototype.splitRevisionForSpittedElement=function(e,t){for(var i=e.revisions.length-1;i>=0;i--){var r=e.revisions[i],n=this.splitRevisionByElement(e,r);this.insertRevision(t,r.revisionType,r.author,r.date,n)}},e.prototype.combineElementRevision=function(e,t){for(var i=0;i<e.length;i++)for(var r=0;r<t.length;r++){var n=e[i],o=t[i];if(n.author===o.author&&n.revisionType===o.revisionType){for(var s=o.range.length,a=0;a<s;a++){var l=o.range[0];l.revisions.splice(l.revisions.indexOf(o),1),o.range.splice(0,1),n.range.push(l),l.revisions.push(n)}0===o.range.length&&this.owner.revisions.remove(o)}}},e.prototype.combineRevisions=function(e,t,i){if(this.owner.enableTrackChanges){var r=this.selection.getLineInfo(e,t.offset).line.getInline(t.offset,0).element;if(r.revisions.length>0&&this.isRevisionMatched(r,"Insertion")){var n=r.nextElement;if(!sf.base.isNullOrUndefined(n)&&n.revisions.length>0){var o=r.revisions[r.revisions.length-1],s=n.revisions[n.revisions.length-1].range;this.clearAndUpdateRevisons(s,o,o.range.indexOf(r)+1)}}}},e.prototype.insertRevisionForBlock=function(e,t,i,r,n){if(0!==e.childWidgets.length&&this.owner.enableTrackChanges)if("Deletion"===t){var o=this.selection.editPosition,s=this.selection.start.clone(),a=this.selection.end.clone();this.documentHelper.layout.clearListElementBox(e);for(var l=0;l<e.childWidgets.length;l++){var h=e.childWidgets[l];this.removeContent(h,0,this.documentHelper.selection.getLineLength(h))}this.selection.editPosition=o,this.selection.start.setPositionInternal(s),this.selection.end.setPositionInternal(a),this.removeEmptyLine(e),n||this.documentHelper.layout.reLayoutParagraph(e,0,0)}else{var d=!1;if(sf.base.isNullOrUndefined(r)){var c=this.owner.currentUser?this.owner.currentUser:"Guest user";(r=new O(this.owner,c,x.getUtcDate())).revisionID=Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15),r.revisionType=t}for(l=0;l<e.childWidgets.length;l++){var p=e.childWidgets[l].children;if(0===p.length){var u=e.containerWidget.childWidgets.indexOf(e),g=void 0;if(u>0&&(g=e.containerWidget.childWidgets[u-1]),!sf.base.isNullOrUndefined(g)&&g instanceof le&&g.characterFormat.revisions.length>0&&this.isRevisionMatched(g.characterFormat,t)){var f=this.getMatchedRevisionsToCombine(g.characterFormat.revisions,t);f.length>0&&(this.mapMatchedRevisions(f,g.characterFormat,e.characterFormat,!1),d=!0,r=void 0)}}for(var m=0;m<p.length;m++)if(0!==m||i)p[m].revisions.push(r),r.range.push(p[m]);else{var y=p[l].revisions.length;this.checkToCombineRevisionsinBlocks(p[l],!0,!1,"Insertion"),p[l].revisions.length>y?r=p[l].revisions[p[l].revisions.length-1]:(p[m].revisions.push(r),r.range.push(p[m]))}}i||d||(e.characterFormat.revisions.push(r),r.range.push(e.characterFormat)),sf.base.isNullOrUndefined(r)||this.updateRevisionCollection(r)}},e.prototype.updateRevisionCollection=function(e){var t=!1,i=void 0;if(this.owner.revisions.changes.indexOf(e)<0){if(this.documentHelper.revisionsInternal.containsKey(e.revisionID)||this.documentHelper.revisionsInternal.add(e.revisionID,e),this.owner.revisions.changes.length>0)for(var r=this.owner.selection.start,n=0;n<this.owner.revisions.changes.length;n++){var o=this.owner.revisions.changes[n].range[0];if(o instanceof ge&&!sf.base.isNullOrUndefined(o.line)&&o.line.paragraph.bodyWidget)i=this.selection.getElementPosition(this.owner.revisions.changes[n].range[0]).startPosition;else if(o instanceof C){var s=o.ownerBase.childWidgets[0];if(this.selection.getFirstParagraph(s).bodyWidget){var a=this.documentHelper.selection;this.updateEditPosition(s,a),i=this.selection.getTextPosBasedOnLogicalIndex(a.editPosition)}}else if(o instanceof P){var l=o.ownerBase;if(l.lastChild&&l.lastChild.paragraph.bodyWidget){var h=l.getLength(),d=new Ft(this.owner);d.setPositionParagraph(l.lastChild,h),i=d}}if(!sf.base.isNullOrUndefined(i)&&!sf.base.isNullOrUndefined(r)&&r.isExistBefore(i)){t=!0,this.owner.revisions.changes.splice(n,0,e);break}}t||this.owner.revisions.changes.push(e),this.documentHelper.updateAuthorIdentity()}},e.prototype.insertSection=function(e,t,i,r){var n,o,s=this.selection.start.paragraph.bodyWidget.sectionFormat.cloneFormat();if(e.start.paragraph.isInsideTable){var a=this.documentHelper.layout.getParentTable(e.start.paragraph);a=a.combineWidget(this.owner.viewer);var l=!1;0===e.start.paragraph.associatedCell.rowIndex&&(l=!0);var h=new le,d=a.previousRenderedWidget;l?n=a:(n=this.splitTable(a,e.start.paragraph.associatedCell.ownerRow),this.documentHelper.layout.layoutBodyWidgetCollection(n.index,n.containerWidget,n,!1),n=n.getSplitWidgets().pop());var c=0;!sf.base.isNullOrUndefined(d)&&d.bodyWidget.equals(n.bodyWidget)||!l?(c=n.indexInOwner+1,h.index=n.index+1):(c=0,h.index=0),n.containerWidget.childWidgets.splice(c,0,h),h.containerWidget=n.containerWidget,this.updateNextBlocksIndex(h,!0),this.documentHelper.layout.layoutBodyWidgetCollection(h.index,h.containerWidget,h,!1),n=h}else{var p=this.selection.getParagraphInfo(e.start),u=this.selection.getHierarchicalIndex(p.paragraph,p.offset.toString());i||this.splitParagraphInternal(e,e.start.paragraph,e.start.currentWidget,e.start.offset),this.setPositionForCurrentIndex(e.start,u),n=e.start.paragraph.getSplitWidgets().pop(),i&&void 0!==n.previousRenderedWidget&&(n=n.previousRenderedWidget)}return o=this.splitBodyWidget(n.bodyWidget,s,n,r).firstChild,i&&this.layoutWholeDocument(!0),o instanceof de&&o.updateRowIndex(0),this.documentHelper.layout.layoutBodyWidgetCollection(o.index,o.containerWidget,o,!1),o instanceof de&&(o=this.documentHelper.getFirstParagraphInFirstCell(o)),t&&e.selectParagraphInternal(o,!0),o},e.prototype.splitBodyWidget=function(e,t,i,r){var n=this.documentHelper.layout.moveBlocksToNextPage(i,!0,void 0,r);if(void 0===n.page)n.page=e.page,e.page.bodyWidgets.splice(e.index+1,0,n);else if(e.page.bodyWidgets.length>1&&void 0!==n.page&&!this.editorHistory.isUndoing){for(var o=n;!sf.base.isNullOrUndefined(e.nextRenderedWidget)&&n!==e.nextRenderedWidget;){var s=e.nextRenderedWidget.page.bodyWidgets.indexOf(e.nextRenderedWidget);n.page.bodyWidgets.push(e.nextRenderedWidget),e.nextRenderedWidget.page.bodyWidgets.splice(s,1)}for(;!sf.base.isNullOrUndefined(n.nextRenderedWidget);)n.nextRenderedWidget.page=n.page,n=n.nextRenderedWidget;(n=o).sectionFormat.breakCode="NewPage"}return r&&(n.sectionFormat.breakCode="NoBreak"),this.updateSectionIndex(n.sectionFormat,n,!0),this.editorHistory&&!this.editorHistory.isUndoing&&this.insertRemoveHeaderFooter(n.sectionIndex,!0),this.updateBlockIndex(0,n.firstChild),this.owner.viewer.updateClientArea(n,n.page),n},e.prototype.insertRemoveHeaderFooter=function(e,t){this.documentHelper.headersFooters[e]?this.documentHelper.headersFooters.splice(e,0,{}):this.documentHelper.headersFooters[e]={}},e.prototype.updateBlockIndex=function(e,t){var i,r=t.bodyWidget.sectionIndex;do{i=t.getSplitWidgets();for(var n=0;n<i.length;n++)i[n].index=e;e++,t=i.pop().nextRenderedWidget}while(!sf.base.isNullOrUndefined(t)&&t.bodyWidget.sectionIndex===r)},e.prototype.updateSectionIndex=function(e,t,i){var r=t.sectionIndex,n=t;do{n.index===r&&e&&(n.sectionFormat=e),i?n.index++:n.index--,n=n.nextRenderedWidget}while(n)},e.prototype.checkAndConvertList=function(e,t){var i=e.paragraphFormat.getList();if(!sf.base.isNullOrUndefined(i)||e.start.paragraph.containerWidget instanceof ae)return!1;var r=!1,n=!1,o=0,s=e.start.currentWidget.getInline(e.start.offset-1,o),a=s.element;if(o=s.index,!(a instanceof we))return!1;for(var l=a,h=l.text.substring(0,o),d=0,c=0;!sf.base.isNullOrUndefined(l.previousNode);){if(!(l.previousNode instanceof we)||"\t"!==l.previousNode.text&&0!==l.previousNode.text.trim().length)return!1;"\t"===l.previousNode.text?d+=36:c=2.5*l.previousNode.text.length,l=l.previousNode}l=a;var p=0,u=h.lastIndexOf("\t");for(p=u>=0?u+1:h.lastIndexOf(" ")+1;l.previousNode instanceof we&&0===p;){var g=(l=l.previousNode).text;p=(u=g.lastIndexOf("\t"))>=0?u+1:g.lastIndexOf(" ")+1,h=(h=l.text+h).substring(p)}var f=(h=x.trimStart(h)).substring(1,2),m=void 0,y=this.getListLevelPattern(h.substring(0,1));if("None"!==y&&this.checkNumberFormat(f,"Bullet"===y,h)?r=!0:this.checkLeadingZero(h)?(n=!0,r=!0):(m=this.checkNextLevelAutoList(h),sf.base.isNullOrUndefined(m)||(r=!0)),r){this.initComplexHistory("AutoList");var v=a.paragraph;e.start.setPositionParagraph(v.childWidgets[0],v.childWidgets[0].getOffset(a,o+1)),e.end.setPositionParagraph(v.childWidgets[0],0),this.initHistory("Delete"),this.deleteSelectedContents(e,!1),this.reLayout(e,!1);var b=t?"Tab":"Space";f=n?"%1"+h.substring(h.length-1,h.length):"%1"+f;var w=h.substring(h.length-3,h.length-1);y=n?this.getListLevelPattern(w):y;var M=new A(void 0);M.listLevelPattern=y,"Bullet"===y?"*"===h?(M.numberFormat=String.fromCharCode(61623),M.characterFormat.fontFamily="Symbol"):"-"===h&&(M.numberFormat="-"):M.numberFormat=f,M.followCharacter=b;var N=e.paragraphFormat.leftIndent;M.paragraphFormat.leftIndent=0!==d||0!==c?N+18+d+c:o>2?N+2.5*(o-2)+18:N>0?N+18:36,M.paragraphFormat.firstLineIndent=-18,!n&&"0"===h.substring(0,1)||"00"===w?M.startAt=0:M.startAt=1,sf.base.isNullOrUndefined(m)?this.autoConvertList(e,M):e.paragraphFormat.setList(m),this.editorHistory&&!sf.base.isNullOrUndefined(this.editorHistory.currentHistoryInfo)?this.editorHistory.updateComplexHistory():this.reLayout(e)}return r},e.prototype.checkNextLevelAutoList=function(e){for(var t=this.documentHelper.selection,i=void 0,r=!1,n=t.start.paragraph,o=t.getPreviousParagraphBlock(n),s=!1;!sf.base.isNullOrUndefined(o)&&o instanceof le;){if(o.paragraphFormat.listFormat&&-1!==o.paragraphFormat.listFormat.listId){s=!0;break}o=t.getPreviousParagraphBlock(o)}if(s){var a=this.documentHelper.layout.getListNumber(o.paragraphFormat.listFormat,!0),l=a.substring(0,a.length-1),h=e.substring(0,e.length-1),d=void 0;if(a.substring(a.length-1)!==e.substring(e.length-1))r=!1;else if(h.match(/^[0-9]+$/)&&l.match(/^[0-9]+$/))d=parseInt(h,10),parseInt(l,10)!==d&&parseInt(l,10)+1!==d&&parseInt(l,10)+2!==d||(r=!0);else if(h.match(/^[a-zA-Z]+$/)&&l.match(/^[a-zA-Z]+$/))if(l.charCodeAt(0)===e.charCodeAt(0)||l.charCodeAt(0)+1===e.charCodeAt(0)||l.charCodeAt(0)+2===e.charCodeAt(0))r=!0;else if(h.match(/^[MDCLXVImdclxvi]+$/)&&l.match(/^[MDCLXVImdclxvi]+$/)){var c=this.getNumber(l.toUpperCase()),p=this.getNumber(h.toUpperCase());c!==p&&c+1!==p&&c+2!==p||(r=!0)}r&&(i=this.documentHelper.getListById(o.paragraphFormat.listFormat.listId))}return i},e.prototype.getNumber=function(e){for(var t={M:1e3,D:500,C:100,L:50,X:10,V:5,I:1},i=e.split(""),r=0,n=0;n<i.length;n++){var o=t[i[n]];o<t[i[n+1]]?r-=o:r+=o}return r},e.prototype.getListLevelPattern=function(e){switch(e){case"0":case"1":return"Arabic";case"I":return"UpRoman";case"i":return"LowRoman";case"A":return"UpLetter";case"a":return"LowLetter";case"*":case"-":return"Bullet";case"00":case"01":return"LeadingZero";default:return"None"}},e.prototype.autoConvertList=function(e,t){e.start;e.isForward||e.end;var i=new f;this.documentHelper.lists.length>0?i.listId=this.documentHelper.lists[this.documentHelper.lists.length-1].listId+1:i.listId=0;var r=new S,n=this.documentHelper;n.abstractLists.length>0?r.abstractListId=n.abstractLists[n.abstractLists.length-1].abstractListId+1:r.abstractListId=0,i.abstractListId=r.abstractListId,i.abstractList=r,n.abstractLists.push(r),r.levels.push(t),t.ownerBase=r,e.paragraphFormat.setList(i),e.paragraphFormat.listLevelNumber=0},e.prototype.checkNumberFormat=function(e,t,i){if(t)return""===e;var r=i.indexOf(e);return("."===e||")"===e||">"===e||"-"===e)&&""===i.substring(r,i.length-1)},e.prototype.checkLeadingZero=function(e){for(var t,i=!1,r=0;r<=e.length-1;r++){if("0"!==e.charAt(r)){t=r;break}i=!0}var n=void 0;return n="1"===e.charAt(t)?e.charAt(t+1):e.charAt(t),i&&this.checkNumberFormat(n,!1,e)},e.prototype.getPageFromBlockWidget=function(e){var t=void 0;return e.containerWidget instanceof ne||e.containerWidget instanceof oe?t=e.containerWidget.page:e.containerWidget instanceof pe&&(t=e.containerWidget.bodyWidget.page),t},e.prototype.insertTextInline=function(e,t,i,r,n){if(e instanceof we){e.text=x.insert(e.text,r,i);var o=e.line.paragraph,s=o.childWidgets.indexOf(e.line),a=e.line.children.indexOf(e);!sf.base.isNullOrUndefined(n)&&n||this.documentHelper.layout.reLayoutParagraph(o,s,a,e.line.paragraph.bidi)}else e instanceof Re?this.insertImageText(e,t,i,r):e instanceof fe?0===e.fieldType?this.insertFieldBeginText(e,t,i,r):2===e.fieldType?this.insertFieldSeparatorText(e,t,i,r):this.insertFieldEndText(e,t,i,r):(e instanceof Ce||e instanceof He||e instanceof Ue)&&this.insertBookMarkText(e,i)},e.prototype.insertFieldBeginText=function(e,t,i,r){var n=new we;n.text=i;var o=e.line.paragraph.childWidgets.indexOf(e.line),s=e.line.children.indexOf(e);n.characterFormat.copyFormat(e.characterFormat),e.line.children.splice(s,0,n),n.line=e.line,this.documentHelper.layout.reLayoutParagraph(e.line.paragraph,o,s)},e.prototype.insertBookMarkText=function(e,t){var i=new we;i.text=t;var r=e.line.paragraph.childWidgets.indexOf(e.line),n=e.line.children.indexOf(e);i.characterFormat.copyFormat(e.characterFormat),e instanceof Ue||e instanceof Ce?e.line.children.splice(n,0,i):e.line.children.splice(n+1,0,i),i.line=e.line,this.documentHelper.layout.reLayoutParagraph(e.line.paragraph,r,n)},e.prototype.insertFieldSeparatorText=function(e,t,i,r){var n=t.getPreviousTextInline(e),o=t.getNextTextInline(e),s=new we;s.text=i;var a=e.line.children.indexOf(e);r===e.length&&a++,sf.base.isNullOrUndefined(n)&&sf.base.isNullOrUndefined(o)?s.characterFormat.copyFormat(e.line.paragraph.characterFormat):sf.base.isNullOrUndefined(n)?s.characterFormat.copyFormat(o.characterFormat):s.characterFormat.copyFormat(n.characterFormat),e.line.children.splice(a,0,s),s.line=e.line;var l=e.line.paragraph.childWidgets.indexOf(e.line);this.documentHelper.layout.reLayoutParagraph(e.line.paragraph,l,a)},e.prototype.insertFieldEndText=function(e,t,i,r){var n=new we;n.text=i;var o=e.line.children.indexOf(e);n.characterFormat.copyFormat(e.characterFormat),t.isInlineFormFillMode()&&0==r?e.line.children.splice(o,0,n):e.line.children.splice(o+1,0,n),n.line=e.line;var s=e.line.paragraph.childWidgets.indexOf(e.line);if(this.owner.enableTrackChanges){var a=this.documentHelper.textHelper.getRtlLanguage(i).isRtl,l=this.checkToMapRevisionWithInlineText(e,r,n,a,"Insertion");l||0!==n.revisions.length||(l=this.checkToMapRevisionWithNextNode(e.nextNode,n,a,"Insertion"))}this.documentHelper.layout.reLayoutParagraph(e.line.paragraph,s,o)},e.prototype.insertImageText=function(e,t,i,r){var n=t.getPreviousTextInline(e),o=t.getNextTextInline(e),s=e.line,a=new we,l=s.paragraph,h=l.childWidgets.indexOf(s);a.text=i;var d=s.children.indexOf(e);r===e.length&&d++,sf.base.isNullOrUndefined(n)&&sf.base.isNullOrUndefined(o)?a.characterFormat.copyFormat(l.characterFormat):sf.base.isNullOrUndefined(n)?a.characterFormat.copyFormat(o.characterFormat):a.characterFormat.copyFormat(n.characterFormat),s.children.splice(d,0,a),a.line=s,this.documentHelper.layout.reLayoutParagraph(l,h,d)},e.prototype.isListTextSelected=function(){this.documentHelper.isListTextSelected&&(this.initComplexHistory("ListSelect"),this.documentHelper.selection.start.paragraph.paragraphFormat.listFormat&&-1!==this.documentHelper.selection.start.paragraph.paragraphFormat.listFormat.listId&&this.onApplyList(void 0))},e.prototype.checkAndConvertToHyperlink=function(e,t,i){var r,n;if(t)r=(n=i.lastChild.children[i.lastChild.children.length-1]).text;else{var o=0,s=e.start.currentWidget.getInline(e.start.offset-1,o),a=s.element;if(o=s.index,!(a instanceof we))return;r=(n=a).text.substring(0,o)}var l=0,h=r.lastIndexOf("\t");for(l=h>=0?h+1:r.lastIndexOf(" ")+1;n.previousElement instanceof we&&0===l;){var d=(n=n.previousNode).text;l=(h=d.lastIndexOf("\t"))>=0?h+1:d.lastIndexOf(" ")+1,r=n.text+r}var c=(r=r.substring(l)).toLowerCase(),p=!1;if("file:///"===c.substring(0,8)||"http://"===c.substring(0,7)&&c.length>7||"https://"===c.substring(0,8)&&c.length>8||"www."===c.substring(0,4)&&c.length>4||"\\"===c.substring(0,3)&&c.length>3||"mailto:"===c.substring(0,7)&&c.length>7)p=!0,"www."===c.substring(0,4)&&c.length>4&&(r="http://"+r);else{var u=r.indexOf("@"),g=r.indexOf(".");u>0&&u<g&&g<r.length-1&&(p=!0,r="mailto:"+r)}if(p){var f=new Ft(this.documentHelper.owner);f.setPositionParagraph(n.line,n.line.getOffset(n,l));var m=new Ft(this.documentHelper.owner);if(t)m.setPositionParagraph(n.line,n.line.getEndOffset());else if(0===e.end.currentWidget.children.length&&0===e.end.offset){var y=e.end.currentWidget.previousLine;m.setPositionParagraph(y,y.getEndOffset())}else m.setPositionParagraph(e.end.currentWidget,e.end.offset-1);this.autoFormatHyperlink(e,r,f,m)}},e.prototype.autoFormatHyperlink=function(e,t,i,r){this.initComplexHistory("AutoFormatHyperlink");var n=this.selection.getParagraphInfo(i),o=this.selection.getHierarchicalIndex(n.paragraph,n.offset.toString());this.editorHistory&&this.editorHistory.currentHistoryInfo&&(this.editorHistory.currentHistoryInfo.insertPosition=o),e.start.setPositionInternal(i),e.end.setPositionInternal(r);var s=this.getCharacterFormat(e),a=new P;a.copyFormat(s);var l=this.createHyperlinkElement(t,i,r,a);e.start.setPositionParagraph(l.line,l.line.getOffset(l,1)),e.start.moveNextPosition(),e.end.setPositionInternal(e.start),n=this.selection.getParagraphInfo(e.end);var h=this.selection.getHierarchicalIndex(n.paragraph,n.offset.toString());this.editorHistory&&this.editorHistory.currentHistoryInfo?(this.editorHistory.currentHistoryInfo.endPosition=h,this.editorHistory.updateComplexHistory(),this.reLayout(e)):this.updateComplexWithoutHistory(0,o,h)},e.prototype.appylingHyperlinkFormat=function(e){this.initHistory("Underline"),this.updateCharacterFormatWithUpdate(e,"underline","Single",!1),this.editorHistory&&this.editorHistory.updateHistory(),this.reLayout(e,!1),this.initHistory("FontColor"),this.isForHyperlinkFormat=!0,this.updateCharacterFormatWithUpdate(e,"fontColor","#0563c1",!1),this.isForHyperlinkFormat=!1,this.editorHistory&&this.editorHistory.updateHistory(),this.reLayout(e,!1)},e.prototype.createHyperlinkElement=function(e,t,i,r){var n=this.selection;this.documentHelper.layout.allowLayout=!1,this.appylingHyperlinkFormat(n);var o=new fe(1);o.characterFormat.copyFormat(r),o.line=n.end.currentWidget,n.start.setPositionInternal(n.end),this.initInsertInline(o),n.start.setPositionInternal(t),n.end.setPositionInternal(n.start);var s=this.insertHyperlinkfield(n,r,e),a=n.start.paragraph.childWidgets.indexOf(s.line),l=s.line.children.indexOf(s);return o.linkFieldCharacter(this.documentHelper),this.documentHelper.layout.allowLayout=!0,this.documentHelper.layout.reLayoutParagraph(n.start.paragraph,a,l),o},e.prototype.insertHyperlinkfield=function(e,t,i,r){var n=new fe(0);n.characterFormat.copyFormat(t),n.line=e.start.currentWidget,this.initInsertInline(n);var o=new we;o.characterFormat.copyFormat(t),o.text=r?' HYPERLINK \\l "'+i+'" ':' HYPERLINK "'+i+'" ',o.line=e.start.currentWidget,this.initInsertInline(o);var s=new fe(2);return s.characterFormat.copyFormat(t),s.line=e.start.currentWidget,this.initInsertInline(s),n},e.prototype.unlinkRangeFromRevision=function(e,t){for(var i=0;i<e.revisions.length;i++){var r=e.revisions[i],n=r.range.indexOf(e);n>=0&&r.range.splice(n,1),0===r.range.length&&t&&(this.owner.revisions.remove(r),this.isRemoveRevision&&this.documentHelper.revisionsInternal.containsKey(r.revisionID)&&(this.documentHelper.revisionsInternal.remove(r.revisionID),this.owner.trackChangesPane.updateTrackChanges()))}},e.prototype.unlinkWholeRangeInRevision=function(e,t){var i=t;e.revisions.splice(e.revisions.indexOf(e),1);for(var r=i.range.length,n=0;n<r;n++)i.range.splice(0,1);0===i.range.length&&(this.owner.revisions.remove(i),this.isRemoveRevision&&this.documentHelper.revisionsInternal.containsKey(i.revisionID)&&(this.documentHelper.revisionsInternal.remove(i.revisionID),this.owner.trackChangesPane.updateTrackChanges()))},e.prototype.unLinkFieldCharacter=function(e){if(e instanceof fe&&0===e.fieldType&&e.fieldEnd&&(this.documentHelper&&(this.documentHelper.fieldToLayout=e,this.documentHelper.fieldEndParagraph=e.line.paragraph),e.fieldEnd&&(e.fieldEnd.fieldBegin=void 0),e.fieldEnd=void 0),e instanceof fe&&2===e.fieldType)sf.base.isNullOrUndefined(e.fieldEnd)||(this.documentHelper&&(this.documentHelper.fieldToLayout=e.fieldBegin,this.documentHelper.fieldEndParagraph=e.line.paragraph),e.fieldBegin.fieldSeparator=void 0,e.fieldEnd.fieldSeparator=void 0);else if(e instanceof fe&&1===e.fieldType&&e.fieldBegin){sf.base.isNullOrUndefined(this.documentHelper)||(this.documentHelper.fieldToLayout=e.fieldBegin,this.documentHelper.fieldEndParagraph=e.line.paragraph);var t=this.documentHelper.fields.indexOf(e.fieldBegin);-1!==t&&this.documentHelper.fields.splice(t,1);var i=this.documentHelper.formFields.indexOf(e.fieldBegin);-1!==i&&this.documentHelper.formFields.splice(i,1),e.fieldBegin.fieldEnd=void 0,e.fieldBegin=void 0}},e.prototype.getCharacterFormat=function(e){return e.start.paragraph.isEmpty()?e.start.paragraph.characterFormat:e.start.currentWidget.getInline(e.start.offset,0).element.characterFormat},e.prototype.insertHyperlink=function(e,t,i){e=e.replace(/\s/g,""),sf.base.isNullOrUndefined(t)&&(t=e),sf.base.isNullOrUndefined(i)||(e=e+'" \\o "'+i),this.insertHyperlinkInternal(e,t,this.owner.selection.text!==t,!1)},e.prototype.insertHyperlinkInternal=function(e,t,i,r){var n=this.documentHelper.selection;if(n.start.paragraph.associatedCell===n.end.paragraph.associatedCell)if(i)this.insertHyperlinkInternalInternal(n,e,t,r);else{this.documentHelper.layout.allowLayout=!1;var o=n.start,s=n.end;n.isForward||(o=n.end,s=n.start);var a=new Ft(this.documentHelper.owner);a.setPositionInternal(o);var l=this.getCharacterFormat(n),h=new P(void 0);h.copyFormat(l),this.initComplexHistory("InsertHyperlink");var d=this.selection.getParagraphInfo(o),c=this.selection.getHierarchicalIndex(d.paragraph,d.offset.toString());this.editorHistory&&this.editorHistory.currentHistoryInfo&&(this.editorHistory.currentHistoryInfo.insertPosition=this.selection.getHierarchicalIndex(d.paragraph,d.offset.toString())),this.appylingHyperlinkFormat(n),o.setPositionInternal(s);var p=new fe(1);p.characterFormat.copyFormat(h),p.line=n.end.currentWidget,o.setPositionInternal(s),this.initInsertInline(p),o.setPositionInternal(a),s.setPositionInternal(o);var u=this.insertHyperlinkfield(n,h,e,r);p.linkFieldCharacter(this.documentHelper);var g=n.start.paragraph.childWidgets.indexOf(u.line),f=u.line.children.indexOf(u);this.documentHelper.layout.allowLayout=!0,this.documentHelper.layout.reLayoutParagraph(n.start.paragraph,g,f);var m=p.line;n.selects(m,m.getOffset(p,p.length),!0),d=this.selection.getParagraphInfo(s);var y=this.selection.getHierarchicalIndex(d.paragraph,d.offset.toString());this.editorHistory&&this.editorHistory.currentHistoryInfo?(this.editorHistory.currentHistoryInfo.endPosition=this.selection.getHierarchicalIndex(d.paragraph,d.offset.toString()),this.editorHistory.updateComplexHistory()):this.updateComplexWithoutHistory(1,c,y)}},e.prototype.insertHyperlinkInternalInternal=function(e,t,i,r){if(!sf.base.isNullOrUndefined(e.start)&&!this.editHyperlink(e,t,i)){this.initHistory("InsertHyperlink");var n=!0;if(!e.isEmpty){var o=this.owner.enableTrackChanges;this.owner.enableTrackChanges=!1,n=this.removeSelectedContents(e),this.owner.enableTrackChanges=o}if(n){var s=this.getCharacterFormat(e),a=new P;a.copyFormat(s),this.insertHyperlinkByFormat(e,t,i,a,r)}}},e.prototype.insertHyperlinkByFormat=function(e,t,i,r,n){this.updateInsertPosition(),e.owner.isShiftingEnabled=!0;var o=[],s=new fe(0);o.push(s);var a=new we;a.text=n?' HYPERLINK \\l "'+t+'" ':' HYPERLINK "'+t+'" ',o.push(a);var l=new fe(2);o.push(l),sf.base.isNullOrUndefined(i)||""===i||((a=new we).characterFormat.underline="Single",a.characterFormat.fontColor="#0563c1",a.text=i,o.push(a));var h=new fe(1);o.push(h),this.insertElement(o),h.linkFieldCharacter(this.documentHelper),-1===this.documentHelper.fields.indexOf(s)&&this.documentHelper.fields.push(s),e.selects(h.line,h.line.getOffset(h,h.length),!0),this.updateEndPosition(),this.reLayout(e,!0)},e.prototype.initInsertInline=function(e,t,i){var r=this.selection,n=!1;!this.isInsertingTOC&&i&&e instanceof Ce&&(r.start.offset--,r.end.offset--,n=!0),this.initHistory("InsertInline"),this.insertInlineInSelection(r,e),this.editorHistory&&this.editorHistory.updateHistory(),n&&(r.start.offset++,r.end.offset++)},e.prototype.insertElementInCurrentLine=function(e,t){this.checkIsNotRedoing()&&(e.owner.isShiftingEnabled=!0),e.isEmpty||this.removeSelectedContents(e),this.updateInsertPosition(),this.insertElement([t]),this.checkEndPosition(e)&&this.updateHistoryPosition(e.start,!1),this.fireContentChange()},e.prototype.editHyperlink=function(e,t,i,r){var n=e.getHyperlinkField();if(sf.base.isNullOrUndefined(n))return!1;this.initHistory("InsertHyperlink"),this.editHyperlinkInternal=sf.base.isNullOrUndefined(this.editorHistory)||this.editorHistory&&sf.base.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo);var o="",s=!1,a=this.getCharacterFormat(e),l=new P;l.copyFormat(a);var h=void 0;if(!sf.base.isNullOrUndefined(n.fieldSeparator)){h=n.fieldSeparator;var d=e.getHyperlinkDisplayText(n.fieldSeparator.line.paragraph,n.fieldSeparator,n.fieldEnd,s,l);o=d.displayText,s=d.isNestedField,l=d.format}var c=n.line.getOffset(n,0);if(e.start.setPositionParagraph(n.line,c),c=n.fieldEnd.line.getOffset(n.fieldEnd,1),e.end.setPositionParagraph(n.fieldEnd.line,c),this.skipFieldDeleteTracking=!0,this.deleteSelectedContents(e,!1),!s&&o!==i||sf.base.isNullOrUndefined(h))this.insertHyperlinkByFormat(e,t,i,l,r),this.skipFieldDeleteTracking=!1;else{this.updateInsertPosition();var p=new fe(0);p.characterFormat.copyFormat(n.characterFormat),p.line=e.start.currentWidget,this.insertInlineInternal(p);var u=new we;u.characterFormat.copyFormat(n.characterFormat),u.text=r?' HYPERLINK \\l "'+t+'" ':' HYPERLINK "'+t+'" ',u.line=e.start.currentWidget,this.insertInlineInternal(u);var g=this.editorHistory&&this.editorHistory.currentBaseHistoryInfo?this.editorHistory.currentBaseHistoryInfo.removedNodes:this.nodes;this.insertClonedFieldResult(e,g,h),e.end.currentWidget.getInline(e.end.offset,0).element.linkFieldCharacter(this.documentHelper),this.skipFieldDeleteTracking=!1;var f=p.line.paragraph,m=p.line.paragraph.childWidgets.indexOf(p.line),y=p.line.children.indexOf(p);this.documentHelper.layout.reLayoutParagraph(f,m,y),c=p.fieldEnd.line.getOffset(p.fieldEnd,1),e.selects(p.fieldEnd.line,c,!0),this.updateEndPosition(),this.reLayout(e,!0)}return this.editHyperlinkInternal=!1,this.nodes=[],!0},e.prototype.insertClonedFieldResult=function(e,t,i){for(var r=!1,n=t.length-1;n>-1;n--){var o=t[n];if(!r){if(i!==o){if(o instanceof le&&o===i.line.paragraph){r=!0;var s=void 0;if(n===t.length-1){s=e.start.paragraph;var a=i.line.paragraph;this.getClonedFieldResultWithSel(a,e,i)}else s=this.getClonedFieldResult(i.line.paragraph,i),this.insertParagraph(s,!0);e.selectParagraphInternal(e.getNextParagraphBlock(s),!0)}continue}r=!0}o instanceof ge?this.insertInlineInternal(o.clone()):o instanceof se&&this.insertBlock(o.clone())}},e.prototype.getClonedFieldResultWithSel=function(e,t,i){for(var r=e.childWidgets.indexOf(i.line),n=e.childWidgets[r].children.indexOf(i),o=r;o<e.childWidgets.length;o++){var s=e.childWidgets[o];o!==r&&(n=0);for(var a=n;a<s.children.length;a++)this.insertInlineInternal(s.children[a].clone())}},e.prototype.getClonedFieldResult=function(e,t){var i=new le;i.characterFormat.copyFormat(e.characterFormat),i.paragraphFormat.copyFormat(e.paragraphFormat);for(var r=e.childWidgets.indexOf(t.line),n=e.childWidgets[r].children.indexOf(t),o=r;o<e.childWidgets.length;o++){var s=e.childWidgets[o];o!==r&&(n=0);for(var a=n;a<s.children.length;a++)i.childWidgets[0].children.push(s.children[a])}return i},e.prototype.removeHyperlink=function(){if(!this.owner.isReadOnlyMode){var e=this.selection,t=e.getHyperlinkField();if(!sf.base.isNullOrUndefined(t)){var i=t.fieldEnd,r=t.fieldSeparator,n=new Ft(e.owner);n.setPositionParagraph(t.line,t.line.getOffset(t,0));var o=this.selection.getParagraphInfo(n),s=this.selection.getHierarchicalIndex(o.paragraph,o.offset.toString()),a=new Ft(e.owner);a.setPositionParagraph(r.line,r.line.getOffset(r,r.length)),o=this.selection.getParagraphInfo(a);var l=this.selection.getHierarchicalIndex(o.paragraph,o.offset.toString());this.initComplexHistory("RemoveHyperlink"),e.start.setPositionParagraph(i.line,i.line.getOffset(i,0)),o=this.selection.getParagraphInfo(e.start);var h=this.selection.getHierarchicalIndex(o.paragraph,o.offset.toString());e.end.setPositionInternal(e.start),this.delete(),e.start.setPositionInternal(this.selection.getTextPosBasedOnLogicalIndex(l)),this.initHistory("Underline"),this.updateCharacterFormatWithUpdate(e,"underline","None",!1),this.editorHistory&&this.editorHistory.updateHistory(),e.end.setPositionInternal(this.selection.getTextPosBasedOnLogicalIndex(h)),this.initHistory("FontColor"),this.updateCharacterFormatWithUpdate(e,"fontColor",void 0,!1),this.editorHistory&&this.editorHistory.updateHistory(),this.reLayout(e,!1),e.end.setPositionInternal(e.start),e.start.setPositionInternal(this.selection.getTextPosBasedOnLogicalIndex(s)),this.initHistory("Delete"),this.deleteSelectedContents(e,!1),this.reLayout(e,!0),this.editorHistory&&!sf.base.isNullOrUndefined(this.editorHistory.currentHistoryInfo)&&this.editorHistory.updateComplexHistory()}}},e.prototype.pasteInternal=function(e,t){if(this.currentPasteOptions=this.owner.defaultPasteOption,this.isHtmlPaste=!1,this.documentHelper.owner.enableLocalPaste)this.paste();else{this.selection.isViewPasteOptions=!0,this.selection.pasteElement&&(this.selection.pasteElement.style.display="none"),sf.base.isNullOrUndefined(t)&&(t=window);var i,r="",n="",o=t.clipboardData?t.clipboardData:e.clipboardData;if("msie"!==sf.base.Browser.info.name&&(n=o.getData("Text/Rtf"),r=o.getData("Text/Html")),this.copiedTextContent=i=o.getData("Text"),this.previousCharFormat=new P,this.previousCharFormat.copyFormat(this.selection.start.paragraph.characterFormat),this.previousParaFormat=new ct,this.previousParaFormat.copyFormat(this.selection.start.paragraph.paragraphFormat),"FormFieldsOnly"===this.documentHelper.protectionType&&this.documentHelper.selection.isInlineFormFillMode()&&(r="",n=""),""!==n)this.pasteAjax(n,".rtf");else if(""!==r){this.isHtmlPaste=!0;var s=(new DOMParser).parseFromString(r,"text/html"),a=(new XMLSerializer).serializeToString(s);a=(a=(a=a.replace(/<!--StartFragment-->/gi,"")).replace(/<!--EndFragment-->/gi,"")).replace('xmlns="http://www.w3.org/1999/xhtml"',""),this.pasteAjax(a,".html")}else if(null!==i&&""!==i)this.selection.currentPasteAction="TextOnly",this.pasteContents(i),this.applyPasteOptions(this.currentPasteOptions,!0),this.copiedContent=void 0,this.documentHelper.editableDiv.innerHTML="";else if("msie"!==sf.base.Browser.info.name&&void 0!==o.items&&0!==o.items.length)for(var l=0;l<o.items.length;l++){var h=o.items[l];("image/png"===h.type||"image/svg+xml"===h.type&&"string"!==h.kind)&&this.pasteImage(h.getAsFile())}else"msie"===sf.base.Browser.info.name&&void 0!==o.files&&0!==o.files.length&&"image/png"===o.files[0].type&&this.pasteImage(o.files[0])}},e.prototype.pasteImage=function(e){var t=this,i=new FileReader;i.onload=function(){t.onPasteImage(i.result)},i.readAsDataURL(e)},e.prototype.onPasteImage=function(e){var t=document.createElement("img"),i=this;t.addEventListener("load",(function(){i.insertImage(e,this.width,this.height)})),t.src=e},e.prototype.pasteAjax=function(e,t){var i={content:e,type:t,dataId:this.owner.dataId};this.pasteRequestHandler=new W,this.owner.documentHelper.viewerContainer.focus(),this.pasteRequestHandler.url=this.owner.serviceUrl+this.owner.serverActionSettings.systemClipboard,this.pasteRequestHandler.responseType="json",this.pasteRequestHandler.contentType="application/json;charset=UTF-8",this.pasteRequestHandler.customHeaders=this.owner.headers,this.pasteRequestHandler.onSuccess=this.pasteFormattedContent.bind(this),this.pasteRequestHandler.onFailure=this.onPasteFailure.bind(this),this.pasteRequestHandler.onError=this.onPasteFailure.bind(this),this.pasteRequestHandler.send(i)},e.prototype.pasteFormattedContent=function(e){var t=this;this.isPasteListUpdated&&(this.isPasteListUpdated=!1),this.pasteContents(sf.base.isNullOrUndefined(e.data)?this.copiedTextContent:e.data),"KeepSourceFormatting"!==this.currentPasteOptions&&this.applyPasteOptions(this.currentPasteOptions),setTimeout((function(){sf.base.isNullOrUndefined(t.viewer)||t.viewer.updateScrollBars()}),0)},e.prototype.onPasteFailure=function(e){this.owner.fireServiceFailure(e),console.error(e.status,e.statusText),this.documentHelper.updateFocus()},e.prototype.paste=function(e,t){var i=this;if(sf.base.isNullOrUndefined(e)&&(e=this.owner.enableLocalPaste?this.copiedData:void 0),sf.base.isNullOrUndefined(t)||(this.currentPasteOptions=t),e){var r=JSON.parse(e);this.pasteContents(r),this.applyPasteOptions(this.currentPasteOptions),this.chartType&&(setTimeout((function(){sf.base.isNullOrUndefined(i.viewer)||i.viewer.updateScrollBars()}),30),this.chartType=!1)}},e.prototype.getUniqueListOrAbstractListId=function(e){if(e&&this.documentHelper.lists.length){var t=this.documentHelper.lists.slice().sort((function(e,t){return e.listId-t.listId}));return t[t.length-1].listId+1}if(this.documentHelper.abstractLists.length){var i=this.documentHelper.abstractLists.slice().sort((function(e,t){return e.abstractListId-t.abstractListId}));return i[i.length-1].abstractListId+1}return 0},e.prototype.checkSameLevelFormat=function(e,t,i){return t.levels[e].listLevelPattern===i.abstractList.levels[e].listLevelPattern&&t.levels[e].numberFormat===i.abstractList.levels[e].numberFormat&&("Bullet"===t.levels[e].listLevelPattern||t.levels[e].startAt===i.abstractList.levels[e].startAt)},e.prototype.listLevelPatternInCollection=function(e,t){var i=this;return this.documentHelper.lists.filter((function(r){return r.abstractList.levels[e].listLevelPattern===t.listLevelPattern&&r.abstractList.levels[e].numberFormat===t.numberFormat&&("Bullet"===t.listLevelPattern||r.abstractList.levels[e].startAt===t.startAt)&&i.isEqualParagraphFormat(r.abstractList.levels[e].paragraphFormat,t.paragraphFormat)}))[0]},e.prototype.isEqualParagraphFormat=function(e,t){return!(sf.base.isNullOrUndefined(t.leftIndent)&&0!==e.leftIndent||!sf.base.isNullOrUndefined(t.leftIndent)&&Math.round(e.leftIndent)!==Math.round(t.leftIndent))&&(!(sf.base.isNullOrUndefined(t.rightIndent)&&0!==e.rightIndent||!sf.base.isNullOrUndefined(t.rightIndent)&&Math.round(e.rightIndent)!==Math.round(t.rightIndent))&&(!(sf.base.isNullOrUndefined(t.firstLineIndent)&&0!==e.firstLineIndent||!sf.base.isNullOrUndefined(t.firstLineIndent)&&Math.round(e.firstLineIndent)!==Math.round(t.firstLineIndent))&&(!(sf.base.isNullOrUndefined(t.beforeSpacing)&&0!==e.beforeSpacing||!sf.base.isNullOrUndefined(t.beforeSpacing)&&Math.round(e.beforeSpacing)!==Math.round(t.beforeSpacing))&&(!(sf.base.isNullOrUndefined(t.afterSpacing)&&0!==e.afterSpacing||!sf.base.isNullOrUndefined(t.afterSpacing)&&Math.round(e.afterSpacing)!==Math.round(t.afterSpacing))&&(!(sf.base.isNullOrUndefined(t.textAlignment)&&"Left"!==e.textAlignment||!sf.base.isNullOrUndefined(t.textAlignment)&&e.textAlignment!==t.textAlignment)&&(!(sf.base.isNullOrUndefined(t.bidi)&&!1!==e.bidi||!sf.base.isNullOrUndefined(t.bidi)&&e.bidi!==t.bidi)&&(!(sf.base.isNullOrUndefined(t.contextualSpacing)&&!1!==e.contextualSpacing||!sf.base.isNullOrUndefined(t.contextualSpacing)&&e.contextualSpacing!==t.contextualSpacing)&&(!(sf.base.isNullOrUndefined(t.keepWithNext)&&!1!==e.keepWithNext||!sf.base.isNullOrUndefined(t.keepWithNext)&&e.keepWithNext!==t.keepWithNext)&&(!(sf.base.isNullOrUndefined(t.keepLinesTogether)&&!1!==e.keepLinesTogether||!sf.base.isNullOrUndefined(t.keepLinesTogether)&&e.keepLinesTogether!==t.keepLinesTogether)&&(!(sf.base.isNullOrUndefined(t.widowControl)&&!1!==e.widowControl||!sf.base.isNullOrUndefined(t.widowControl)&&e.widowControl!==t.widowControl)&&(!(sf.base.isNullOrUndefined(t.outlineLevel)&&"BodyText"!==e.outlineLevel||!sf.base.isNullOrUndefined(t.outlineLevel)&&e.outlineLevel!==t.outlineLevel)&&(!(sf.base.isNullOrUndefined(t.lineSpacing)&&1!==e.lineSpacing||!sf.base.isNullOrUndefined(t.lineSpacing)&&Math.round(e.lineSpacing)!==Math.round(t.lineSpacing))&&!(sf.base.isNullOrUndefined(t.lineSpacingType)&&"Multiple"!==e.lineSpacingType||!sf.base.isNullOrUndefined(t.lineSpacingType)&&e.lineSpacingType!==t.lineSpacingType)))))))))))))},e.prototype.getBlocksToUpdate=function(e){for(var t=[],i=0;i<e.length;i++){var r=e[i];if(r.paragraphFormat&&r.paragraphFormat.listFormat&&Object.keys(r.paragraphFormat.listFormat).length>0)t.push(r);else if(r.rows)for(var n=0;n<r.rows.length;n++)for(var o=r.rows[n],s=0;s<o.cells.length;s++){var a=o.cells[s];t=t.concat(this.getBlocksToUpdate(a.blocks))}}return t},e.prototype.updateListIdForBlocks=function(e,t,i,r,n){for(var o=!1,s=0;s<e.length;s++){var a=e[s];if(a.paragraphFormat&&a.paragraphFormat.listFormat&&Object.keys(a.paragraphFormat.listFormat).length>0){var l=a.paragraphFormat.listFormat,h=this.listLevelPatternInCollection(l.listLevelNumber,t.levels[l.listLevelNumber]);l.listId===r&&(sf.base.isNullOrUndefined(h)&&(!i||i&&!this.checkSameLevelFormat(l.listLevelNumber,t,i))?(o=!0,l.listId=n):!sf.base.isNullOrUndefined(h)&&this.checkSameLevelFormat(l.listLevelNumber,t,h)&&(l.isUpdated||(l.listId=h.listId,l.isUpdated=!0),o=!1))}else if(a.rows)for(var d=0;d<a.rows.length;d++)for(var c=a.rows[d],p=0;p<c.cells.length;p++){var u=c.cells[p],g=this.updateListIdForBlocks(u.blocks,t,i,r,n);o||(o=g)}}return o},e.prototype.updatePasteContent=function(e,t){var i=this.getUniqueListOrAbstractListId(!0);if(e.lists.filter((function(e){return e.listId===i})).length>0){var r=e.lists.slice().sort((function(e,t){return e.listId-t.listId}));i=r[r.length-1].listId+1}var n=this.getUniqueListOrAbstractListId(!1);if(e.abstractLists.filter((function(e){return e.abstractListId===n})).length>0){var o=e.abstractLists.slice().sort((function(e,t){return e.abstractListId-t.abstractListId}));n=o[o.length-1].abstractListId+1}for(var s,a=function(r){var o=e.lists[r],a=e.abstractLists.filter((function(e){return e.abstractListId===o.abstractListId}))[0],h=l.documentHelper.lists.filter((function(e){return e.listId===o.listId}));sf.base.isNullOrUndefined(a)||(l.updateListIdForBlocks(e.sections[t].blocks,a,h[0],o.listId,i)?(a.abstractListId=n,o.listId=i,o.abstractListId=n,i++,n++):(e.lists.splice(r,1),e.abstractLists.splice(e.abstractLists.indexOf(a),1),r--));s=r},l=this,h=0;h<e.lists.length;h++)a(h),h=s;for(var d=this.getBlocksToUpdate(e.sections[t].blocks),c=0;c<d.length;c++){delete d[c].paragraphFormat.listFormat.isUpdated}},e.prototype.getBlocks=function(e,t,i,r,n){var o=[];if("string"==typeof e){this.selection.currentPasteAction="TextOnly";var s=this.selection.start.paragraph;this.selection.isForward||(s=this.selection.end.paragraph);var l=[],h=e;h=h.replace(/\r\n/g,"\r"),this.isInsertText&&(h=void 0!==navigator&&-1!==navigator.userAgent.indexOf("Firefox")?h.replace(/\r/g,"\n"):h.replace(/\n/g,"\r")),l=void 0!==navigator&&-1!==navigator.userAgent.indexOf("Firefox")?h.split("\n"):h.split("\r");var c=[];(M=new ne).sectionFormat=new d(M),M.childWidgets=c;for(var p=0;p<l.length;p++)if(p!==l.length-1||0!==l[p].length){var u=this.selection.start.currentWidget.getInline(this.selection.start.offset,0),g=this.selection.getPreviousValidElement(u.element);g!==u.element&&(g=this.selection.getNextValidElement(u.element));var f=void 0;s.isEmpty()?f=s.characterFormat:sf.base.isNullOrUndefined(g)?this.copyInsertFormat(s.characterFormat,!1):f=g.characterFormat;var m=this.documentHelper.selection.copySelectionParagraphFormat();sf.base.isNullOrUndefined(this.previousParaFormat)||(m=this.previousParaFormat);var y=new le;y.paragraphFormat.copyFormat(m);var v=new ue(y);if(l[p].length>0)for(var b=l[p].split(/(\s+)/),w=0;w<b.length;w++){var x=new we;x.characterFormat.copyFormat(f),x.text=b[w],v.children.push(x),x.line=v}y.childWidgets.push(v),y.containerWidget=M,c.push(y)}o.push(M)}else{this.selection.currentPasteAction="DefaultPaste",this.viewer.owner.parser.addCustomStyles(e),!t&&e.comments.length>0&&(this.documentHelper.owner.parser.commentsCollection=new a,this.documentHelper.owner.parser.parseComments(e,r));var M=void 0;for(p=0;p<e.sections.length;p++){var N=this.documentHelper.owner.parser;if(N.images=e.images,N.isPaste=t,N.isHtmlPaste=this.isHtmlPaste,this.isPasteListUpdated||sf.base.isNullOrUndefined(e.lists)||(this.documentHelper.lists.length>0&&this.updatePasteContent(e,p),this.isPasteListUpdated=!0,sf.base.isNullOrUndefined(e.abstractLists)||N.parseAbstractList(e,this.documentHelper.abstractLists),sf.base.isNullOrUndefined(e.lists)||N.parseList(e,this.documentHelper.lists)),!sf.base.isNullOrUndefined(e.revisions))if(t){var I=this.viewer.owner.revisionsInternal.changes;sf.base.isNullOrUndefined(N.revisionCollection)||(N.revisionCollection=void 0),N.revisionCollection=new a;var S=N.revisionCollection;if((!this.documentHelper.owner.sfdtExportModule.copyWithTrackChange||!N.isCutPerformed)&&e.revisions.length>=1)for(var C=0;C<e.revisions.length;C++){var O=!0;if(S.containsKey(e.revisions[C].revisionId)){if(I.length>0)for(var T=0;T<I.length;T++)I[T].revisionID===e.revisions[C].revisionId&&(O=!1);if(O){var P=S.get(e.revisions[C].revisionId);I.push(P)}}else N.parseRevisions(e,I)}this.documentHelper.owner.sfdtExportModule.copyWithTrackChange=!1}else N.revisionCollection=this.documentHelper.revisionsInternal,N.parseRevisions(e,n);(M=new ne).sectionFormat=new d(M),t?o.push(M):i.unshift(M),N.parseBody(e.sections[p].blocks,M.childWidgets),e.lastParagraphMarkCopied&&this.selection.start.paragraph.isEmpty()&&1==this.documentHelper.pages.length&&1==this.documentHelper.pages[0].bodyWidgets[0].childWidgets.length&&N.parseSectionFormat(e.sections[p].sectionFormat,M.sectionFormat),N.isPaste=!1,N.isHtmlPaste=!1,N.images=void 0}if(e.lastParagraphMarkCopied){var A=new le;M.childWidgets.push(A)}}return"MergeWithExistingFormatting"===this.currentPasteOptions&&this.applyMergeFormat(o),o},e.prototype.applyMergeFormat=function(e){for(var t=this.selection.start.paragraph,i=this.selection.start.currentWidget.getInline(this.selection.start.offset,0),r=this.selection.getPreviousValidElement(i.element),n=r?r.characterFormat:this.copyInsertFormat(t.characterFormat,!1),o=this.documentHelper.selection.copySelectionParagraphFormat(),s=0;s<e.length;s++)for(var a=e[s].childWidgets,l=0;l<a.length;l++){var h=a[l];if(h instanceof le)h.paragraphFormat.copyFormat(o),this.applyFormatInternal(h,n);else for(var d=0;d<h.childWidgets.length;d++)for(var c=h.childWidgets[d],p=0;p<c.childWidgets.length;p++)for(var u=c.childWidgets[p],g=0;g<u.childWidgets.length;g++)this.applyFormatInternal(u.childWidgets[g],n)}},e.prototype.applyFormatInternal=function(e,t){if(e instanceof le)for(var i=0;i<e.childWidgets.length;i++)for(var r=e.childWidgets[i],n=0;n<r.children.length;n++){var o=r.children[n].characterFormat.cloneFormat();o.bold&&(r.children[n].characterFormat.bold=o.bold),o.italic&&(r.children[n].characterFormat.italic=o.italic),"None"!==o.underline&&(r.children[n].characterFormat.underline=o.underline)}else for(i=0;i<e.childWidgets.length;i++){var s=e.childWidgets[i];for(n=0;n<s.childWidgets.length;n++)for(var a=s.childWidgets[n],l=0;l<a.childWidgets.length;l++)this.applyFormatInternal(a.childWidgets[l],t)}},e.prototype.applyPasteOptions=function(e,t){if(!sf.base.isNullOrUndefined(this.copiedContent)&&""!==this.copiedTextContent&&!t){this.currentPasteOptions=e;var i=(this.selection.isForward?this.selection.start:this.selection.end).paragraph.paragraphFormat,r=this.copiedContent,n=this.copiedTextContent;switch(this.editorHistory&&this.editorHistory.canUndo()&&(this.editorHistory.undo(),this.editorHistory.redoStack.pop()),this.copiedContent=r,this.copiedTextContent=n,this.selection.isViewPasteOptions=!0,e){case"KeepSourceFormatting":this.pasteContents(""!==this.copiedContent?this.copiedContent:this.copiedTextContent);break;case"MergeWithExistingFormatting":this.pasteContents(""!==this.copiedContent?this.copiedContent:this.copiedTextContent,i);break;case"KeepTextOnly":this.pasteContents(this.copiedTextContent)}}},e.prototype.pasteContents=function(e,t){if("string"!=typeof e&&(this.copiedContent=e),"FormFieldsOnly"===this.documentHelper.protectionType&&this.documentHelper.selection.isInlineFormFillMode()){var i=this.selection.getCurrentFormField(),r=this.getFieldResultText(),n=i.formFieldData.maxLength,o=this.documentHelper.selection.text.length;if(n>0)if(0===o){var s=n-r.length;e=e.substring(0,s)}else o>0&&(e=e.substring(0,o))}this.pasteContentsInternal(this.getBlocks(e,!0),!0,t),this.isInsertField=!1},e.prototype.pasteContentsInternal=function(e,t,i){this.isPaste=t;var r=this.documentHelper.selection,n=!0,o=!1;if(this.initComplexHistory("Paste"),this.documentHelper.isListTextSelected){var s=r.start.paragraph;s.paragraphFormat.listFormat&&-1!==s.paragraphFormat.listFormat.listId&&this.onApplyList(void 0)}this.initHistory("Paste"),r.isEmpty&&!this.documentHelper.isListTextSelected||(n=this.removeSelectedContentInternal(r,r.start,r.end)),n?o=this.pasteContent(e,i):this.editorHistory&&(this.editorHistory.currentBaseHistoryInfo=void 0),this.editorHistory&&this.editorHistory.currentHistoryInfo?(this.editorHistory.updateHistory(),this.editorHistory.updateComplexHistory()):this.reLayout(r,r.isEmpty),o&&this.layoutWholeDocument(!0),this.isPaste=!1},e.prototype.pasteContent=function(e,t){this.documentHelper.owner.isShiftingEnabled=!0;var i="";if(this.updateInsertPosition(),this.editorHistory&&this.editorHistory.currentBaseHistoryInfo)i=this.editorHistory.currentBaseHistoryInfo.insertPosition;else{var r=this.selection.start;this.selection.isForward||(r=this.selection.end);var n=this.selection.getParagraphInfo(r);i=this.selection.getHierarchicalIndex(n.paragraph,n.offset.toString())}this.documentHelper.owner.isLayoutEnabled=!0,this.documentHelper.owner.isPastingContent=!0;var o=this.pasteCopiedData(e,t),s="";if(this.updateEndPosition(),this.editorHistory&&this.editorHistory.currentBaseHistoryInfo)s=this.editorHistory.currentBaseHistoryInfo.endPosition;else{n=this.selection.getParagraphInfo(this.selection.start);s=this.selection.getHierarchicalIndex(n.paragraph,n.offset.toString())}var a=new Ft(this.documentHelper.owner);this.setPositionForCurrentIndex(a,i);var l=new Ft(this.documentHelper.owner);return this.setPositionForCurrentIndex(l,s),this.pasteTextPosition={startPosition:a,endPosition:l},this.documentHelper.owner.isPastingContent=!1,this.documentHelper.selection.fireSelectionChanged(!0),o},e.prototype.pasteCopiedData=function(e,t){var i=!1;if(this.documentHelper.layout.isBidiReLayout&&(this.documentHelper.layout.isBidiReLayout=!1),this.isPaste&&this.isSectionEmpty(this.selection)&&!this.selection.start.paragraph.isInHeaderFooter){if(this.previousSectionFormat=new d,this.previousSectionFormat.copyFormat(this.selection.start.paragraph.bodyWidget.sectionFormat),this.selection.start.paragraph.bodyWidget.sectionFormat.copyFormat(e[0].sectionFormat),this.selection.start.paragraph.bodyWidget.sectionFormat.footerDistance=this.previousSectionFormat.footerDistance,this.selection.start.paragraph.bodyWidget.sectionFormat.headerDistance=this.previousSectionFormat.headerDistance,this.owner.viewer instanceof X){var r=this.selection.start.paragraph.bodyWidget.page;this.owner.viewer.updatePageBoundingRectangle(this.selection.start.paragraph.bodyWidget,r,r.boundingRectangle.y),this.owner.viewer.updateClientArea(this.selection.start.paragraph.bodyWidget,r)}i=!0}for(var n=0;n<e.length;n++)for(var o=e[n].childWidgets,s=0;s<o.length;s++){var a=o[s];if(a instanceof le&&0===a.childWidgets.length&&(a.childWidgets[0]=new ue(a)),a instanceof le&&!sf.base.isNullOrUndefined(t)){a.paragraphFormat.copyFormat(t);var l=this.copyInsertFormat(this.selection.start.paragraph.characterFormat,!1);a.characterFormat.mergeFormat(l)}if(s===o.length-1&&a instanceof le){var h=a;if(h.childWidgets.length>0&&h.childWidgets[0].children.length>0){var c=this.selection.start;if("Center"!==c.paragraph.paragraphFormat.textAlignment&&"Right"!==c.paragraph.paragraphFormat.textAlignment||-1!==c.paragraph.paragraphFormat.listFormat.listId||(c.paragraph.x=this.owner.viewer.clientActiveArea.x),"KeepTextOnly"===this.currentPasteOptions){var p=new ct(this.selection.start.paragraph);this.selection.start.paragraph.paragraphFormat=p}this.insertElement(h.childWidgets[0].children,h.paragraphFormat)}}else if(a instanceof se){var u=this.selection.start.paragraph;if(a instanceof de){var g=a;if(this.generateTableRevision(g),u.isInsideTable){var f=u.getContainerWidth();g.fitCellsToClientArea(f)}if(u.isEmpty()&&u.previousWidget instanceof de&&!this.isPaste)return this.insertTableRows(g,u.previousWidget),i}this.insertBlockInternal(a)}}return i},e.prototype.generateTableRevision=function(e){if(this.owner.enableTrackChanges&&!sf.base.isNullOrUndefined(e))for(var t=0;t<e.childWidgets.length;t++){var i=e.childWidgets[t];this.insertRevision(i.rowFormat,"Insertion");for(var r=0;r<i.childWidgets.length;r++)for(var n=i.childWidgets[r],o=0;o<n.childWidgets.length;o++){var s=n.childWidgets[o];sf.base.isNullOrUndefined(s)||this.insertRevisionForBlock(s,"Insertion")}}},e.prototype.isSectionEmpty=function(e){var t=e.start.paragraph;if(t){if(t.isInsideTable||t.isInHeaderFooter||t!==e.end.paragraph)return!1;var i=t.bodyWidget;if(i){var r=i.page;if(r&&(sf.base.isNullOrUndefined(r.previousPage)||r.previousPage.sectionIndex!==r.sectionIndex)&&sf.base.isNullOrUndefined(r.nextPage)&&t.isEmpty()&&1===i.childWidgets.length){var n=!0,o=e.start.paragraph.bodyWidget.sectionIndex,s=this.documentHelper.headersFooters[o];if(s){for(var a in s){var l=s[a];if(sf.base.isNullOrUndefined(l))n=!1;else{var h=l.childWidgets[0];(h instanceof de||h instanceof le&&!h.isEmpty())&&(n=!1)}if(!n)break}return n}}}}return!1},e.prototype.insertTableInternal=function(e,t,i){var r=e.getIndex();if(i)for(var n=0,o=0;n<e.childWidgets.length;n++,o++){var s=e.childWidgets[n];t.childWidgets.splice(o,0,s),s.containerWidget=t,e.childWidgets.splice(n,1),n--}var a=e.containerWidget;this.constructRevisionsForTable(e,!1),this.removeBlock(e,!0),a.childWidgets.splice(r,0,t),t.index=e.index,e.containerWidget=void 0,t.containerWidget=a,this.documentHelper.layout.clearTableWidget(t,!0,!0,!0),t.buildTableColumns(),this.constructRevisionsForTable(t,!0),t.isGridUpdated=!0,this.updateNextBlocksIndex(t,!0),this.documentHelper.layout.linkFieldInTable(t),this.documentHelper.layout.layoutBodyWidgetCollection(t.index,a,t,!1)},e.prototype.canConstructRevision=function(e){return e.revisions.length>0&&0===e.revisions[0].range.length||e.removedIds.length>0},e.prototype.constructRevisionsForTable=function(e,t){for(var i=0;i<e.childWidgets.length;i++){var r=e.childWidgets[i];if(t){this.canConstructRevision(r.rowFormat)&&this.constructRevisionFromID(r.rowFormat,!0);for(var n=0;n<r.childWidgets.length;n++)for(var o=r.childWidgets[n],s=0;s<o.childWidgets.length;s++)o.childWidgets[s]instanceof le&&this.constructRevisionsForBlock(o.childWidgets[s],t)}else this.removeDeletedCellRevision(r)}},e.prototype.constructRevisionsForBlock=function(e,t){for(var i=0;i<e.childWidgets.length;i++)for(var r=e.childWidgets[i],n=0;n<r.children.length;n++)t&&r.children[n]instanceof ge&&this.canConstructRevision(r.children[n])&&this.constructRevisionFromID(r.children[n],!0);this.canConstructRevision(e.characterFormat)&&this.constructRevisionFromID(e.characterFormat,!0)},e.prototype.applyRevisionForCurrentPara=function(e,t,i,r,n){var o=e.getInline(t+1,0).element,s=!1;t===e.getLength()&&(s=!0);var a=e.getInline(i,0).element;if(i>e.getLength()&&(n=!0),sf.base.isNullOrUndefined(o)||sf.base.isNullOrUndefined(a))sf.base.isNullOrUndefined(o)||s?sf.base.isNullOrUndefined(a)||(a.removedIds.push(r),this.constructRevisionFromID(a,!0)):(o.removedIds.push(r),this.constructRevisionFromID(o,!0));else if(s||o!==a){for(;!sf.base.isNullOrUndefined(o)&&o!==a;)s||(o.removedIds.push(r),this.constructRevisionFromID(o,!0)),sf.base.isNullOrUndefined(o.nextNode)||(o=o.nextNode instanceof Ce?o.nextNode:o.nextNode.nextValidNodeForTracking),s=!1;sf.base.isNullOrUndefined(o)||s||(o.removedIds.push(r),this.constructRevisionFromID(o,!0))}else o.removedIds.push(r),this.constructRevisionFromID(o,!0);n&&(e.characterFormat.removedIds.push(r),this.constructRevisionFromID(e.characterFormat,!0))},e.prototype.insertBlockTable=function(e,t,i){var r=e.start.offset;e.start.paragraph.childWidgets.indexOf(e.start.currentWidget);t instanceof le&&r>0&&(this.moveInlines(e.start.paragraph,t,0,0,e.start.paragraph.firstChild,r,e.start.currentWidget),e.selectParagraphInternal(e.start.paragraph,!0),this.checkInsertPosition(e)&&this.updateHistoryPosition(this.selection.getHierarchicalIndex(t,r.toString()),!0)),r>0&&this.checkInsertPosition(e)&&this.updateHistoryPosition(e.start,!0);var n=i.indexInOwner;if(i.containerWidget.childWidgets.splice(n,0,t),t.containerWidget=i.containerWidget,t.index=i.index,this.updateNextBlocksIndex(t,!0),this.documentHelper.layout.layoutBodyWidgetCollection(t.index,t.containerWidget,t,!1),this.checkInsertPosition(e)){var o=void 0;t instanceof le&&(o=t),t instanceof de&&(o=this.documentHelper.getFirstParagraphInFirstCell(t)),this.updateHistoryPosition(this.selection.getHierarchicalIndex(o,"0"),!0)}},e.prototype.handleCut=function(e){var t=e.start,i=e.end;e.isForward||(t=e.end,i=e.start);var r=this.selection.getParagraphInfo(t);if(e.editPosition=this.selection.getHierarchicalIndex(r.paragraph,r.offset.toString()),t.paragraph===i.paragraph&&t.offset+1===i.offset)t.paragraph.getInline(i.offset,0).element;this.initHistory("Cut"),e.owner.isShiftingEnabled=!0,this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&this.checkInsertPosition(e)&&this.updateHistoryPosition(e.editPosition,!0),this.deleteSelectedContent(i.paragraph,e,t,i,3);var n=new Ft(e.owner);this.setPositionForCurrentIndex(n,e.editPosition),e.selectContent(n,!0),this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&this.checkEndPosition(e)&&this.updateHistoryPosition(e.end,!1),this.reLayout(e)},e.prototype.insertInlineInternal=function(e,t){var i=this.selection,r=e.length,n=this.selection.getParagraphInfo(i.start);if(t=sf.base.isNullOrUndefined(t)?"Insertion":t,i.start.paragraph.isEmpty()){var o=i.start.paragraph;"Center"!==o.paragraphFormat.textAlignment&&"Right"!==o.paragraphFormat.textAlignment||-1!==o.paragraphFormat.listFormat.listId||(o.x=this.owner.viewer.clientActiveArea.x);var s=!sf.base.isNullOrUndefined(this.editorHistory)&&(this.editorHistory.isUndoing||this.editorHistory.isRedoing);o.childWidgets[0].children.push(e),e.line=o.childWidgets[0],this.owner.enableTrackChanges&&e.isValidNodeForTracking&&!s&&this.insertRevision(e,t),(e.removedIds.length>0||s)&&this.constructRevisionFromID(e,!0),e.linkFieldCharacter(this.documentHelper),e instanceof Me&&("Footnote"===e.footnoteType&&this.updateFootnoteCollection(e),"Endnote"===e.footnoteType&&this.updateEndnoteCollection(e)),this.documentHelper.layout.reLayoutParagraph(o,0,0,void 0,void 0)}else{var a=0,l=i.start.currentWidget.getInline(i.start.offset,a),h=l.element;a=l.index,this.insertElementInternal(h,e,a,t,!0)}this.setPositionParagraph(n.paragraph,n.offset+r,!0)},e.prototype.insertElement=function(e,t){var i=this.selection,r=0,n=void 0,o=-1,s=void 0,a=0,l=void 0,h=this.selection.getParagraphInfo(i.start),d=this.owner.enableTrackChanges,c=void 0,p=void 0,u=0;if(i.start.paragraph.isEmpty())s=(n=i.start.paragraph).childWidgets[0],o=0;else{var g=i.start.currentWidget.getInline(i.start.offset,u);c=g.element,u=g.index,o=(n=c.line.paragraph).childWidgets.indexOf(c.line),a=c.indexInOwner,s=c.line,u===c.length?(a++,l=!1):0===u?(sf.base.isNullOrUndefined(c.previousNode)&&(a=0),l=!0):(a++,(p=new we).characterFormat.copyFormat(c.characterFormat),p.text=c.text.substring(u),c.text=c.text.slice(0,u),c.revisions.length>0&&!this.owner.enableTrackChanges&&this.splitRevisionForSpittedElement(c,p),s.children.splice(a,0,p),p.line=c.line)}for(var f=0;f<e.length;f++){r+=e[f].length,e[f]instanceof we&&e[f].text.indexOf(" ")>=0&&(this.documentHelper.triggerSpellCheck=!0);var m=e[f].revisions.length;e[f].ischangeDetected=!0,s.children.splice(a,0,e[f]),e[f].line=s,e[f].linkFieldCharacter(this.documentHelper);var y=this.updateRevisionForElement(c,e[f],u,0===f,p,l);d&&!y&&e[f].revisions.length===m&&this.checkToCombineRevisionsinBlocks(e[f],m===e[f].revisions.length,f>0&&f===e.length-1,"Insertion"),c=e[f],a++}t&&(sf.base.isNullOrUndefined(n.paragraphFormat.listFormat.list)||!sf.base.isNullOrUndefined(n.paragraphFormat.listFormat)&&-1===n.paragraphFormat.listFormat.listId)&&n.paragraphFormat.copyFormat(t),this.documentHelper.layout.reLayoutParagraph(n,o,0,this.isInsertField?void 0:n.paragraphFormat.bidi),this.setPositionParagraph(h.paragraph,h.offset+r,!0)},e.prototype.updateRevisionForElement=function(e,t,i,r,n,o){if(!this.owner.enableTrackChanges)return!1;if(sf.base.isNullOrUndefined(e)&&sf.base.isNullOrUndefined(n))return!1;var s=!!sf.base.isNullOrUndefined(o),a=t.revisions.length;return r?s?(this.checkToMapRevisionWithInlineText(e,i,t,!1,"Insertion")||t.revisions.length>a?this.copyElementRevision(e,n,!0):0===t.revisions.length&&(this.splitRevisionForSpittedElement(e,n),this.insertRevision(t,"Insertion")),!1):o?this.insertRevisionAtBegining(e,t,"Insertion"):this.insertRevisionAtEnd(e,t,"Insertion"):this.insertRevisionAtEnd(e,t,"Insertion")},e.prototype.insertElementInternal=function(e,t,i,r,n){var o=e.line,s=o.paragraph,a=o.indexInOwner,l=e.indexInOwner,h=s.paragraphFormat.bidi&&e.isRightToLeft,d=!1;r=sf.base.isNullOrUndefined(r)?"Insertion":r;var c=this.skipTracking(),p=this.owner.enableTrackChanges,u=!1,g=t.revisions.length;if(this.owner.editorHistory&&(this.owner.editorHistory.isUndoing||this.owner.editorHistory.isRedoing)&&t instanceof we&&(d=e.characterFormat.isEqualFormat(t.characterFormat)&&this.documentHelper.textHelper.isRTLText(t.text)),d)e.text=e.text.substring(0,i)+t.text+e.text.substring(i);else if(i===e.length)l++,t.removedIds.length>0||c?this.constructRevisionFromID(t,!0,e):!p||c||this.skipFieldDeleteTracking||(u=this.insertRevisionAtEnd(e,t,r)),o.children.splice(l,0,t);else if(0===i)t.removedIds.length>0?this.constructRevisionFromID(t,!1):!p||c||this.skipFieldDeleteTracking||(u=this.insertRevisionAtBegining(e,t,r)),sf.base.isNullOrUndefined(e.previousNode)?(e.line.children.splice(0,0,t),l=0):e.line.children.splice(l,0,t);else{l++;var f=new we;if(f.characterFormat.copyFormat(e.characterFormat),f.text=e.text.substring(i),e.revisions.length>0&&!p&&!c&&0===t.removedIds.length&&this.splitRevisionForSpittedElement(e,f),e.text=e.text.substr(0,i),o.children.splice(l,0,f),f.line=e.line,u=!0,this.isTrackingFormField=e.previousElement instanceof fe,t.removedIds.length>0&&!this.isTrackingFormField)this.constructRevisionFromID(t,!1),this.copyElementRevision(e,f,!0);else if(this.owner.enableTrackChanges){if(t instanceof Ce||t instanceof nt||t instanceof He||t instanceof Ue)this.copyElementRevision(e,f,!1);else this.checkToMapRevisionWithInlineText(e,i,t,h,r)||t.revisions.length>g?this.copyElementRevision(e,f,!0):t.revisions.length===g&&(this.splitRevisionForSpittedElement(e,f),this.insertRevision(t,r))}o.children.splice(l,0,t),l-=1}if(t.line=e.line,t instanceof Ce){var m=this.documentHelper.bookmarks;t.reference.reference=t,m.containsKey(t.name)||m.add(t.name,t)}!sf.base.isNullOrUndefined(t.line.paragraph.containerWidget)&&!sf.base.isNullOrUndefined(t.line.paragraph.containerWidget.containerWidget)&&t.line.paragraph.containerWidget.containerWidget instanceof ae&&(t.line.paragraph.containerWidget.containerWidget.height+=t.height),t.linkFieldCharacter(this.documentHelper),t instanceof Oe&&0===t.type&&this.documentHelper.contentControlCollection.push(t),(t instanceof Re&&"Inline"!==t.textWrappingStyle||t instanceof Ee)&&(-1===s.floatingElements.indexOf(t)&&s.floatingElements.push(t),-1===s.bodyWidget.floatingElements.indexOf(t)&&"Inline"!==t.textWrappingStyle&&s.bodyWidget.floatingElements.push(t)),!p||u||c||this.skipFieldDeleteTracking||this.checkToCombineRevisionsinBlocks(t,g===t.revisions.length,i===e.length,r),t instanceof Me&&(c&&(t.isLayout=!1),"Footnote"===t.footnoteType&&this.updateFootnoteCollection(t),"Endnote"===t.footnoteType&&this.updateEndnoteCollection(t)),n&&this.documentHelper.layout.reLayoutParagraph(s,a,l,void 0,void 0)},e.prototype.constructRevisionFromID=function(e,t,i){if(e.removedIds.length>0){for(var r=0;r<e.removedIds.length;r++){var n=void 0;if(this.documentHelper.revisionsInternal.containsKey(e.removedIds[r])){if(n=this.documentHelper.revisionsInternal.get(e.removedIds[r]),e.revisions.push(n),(t=!!t||this.skipTracking())&&this.editorHistory.isRedoing&&this.owner.editorHistory.currentBaseHistoryInfo&&"BackSpace"===this.owner.editorHistory.currentBaseHistoryInfo.action&&(t=!1),sf.base.isNullOrUndefined(i))n.range.splice(t?n.range.length:0,0,e);else{var o=n.range.indexOf(i);o>=0?n.range.splice(o+(t?1:0),0,e):n.range.splice(0,0,e)}this.updateRevisionCollection(n)}}e.removedIds=[]}else for(r=0;r<e.revisions.length;r++){var s=e.revisions[r];this.documentHelper.revisionsInternal.containsKey(s.revisionID)&&((s=this.documentHelper.revisionsInternal.get(s.revisionID)).range.splice(t?s.range.length:0,0,e),this.updateRevisionCollection(s))}},e.prototype.insertBlock=function(e){var t=!0,i=this.selection;if(i.isEmpty||(t=this.removeSelectedContents(i)),t||i.selectContent(i.start,!1),this.insertBlockInternal(e),this.addOrRemoveCommentsInBlock(e,!0),this.checkInsertPosition(i)){var r=void 0;r=e instanceof le?e:this.documentHelper.getFirstParagraphInFirstCell(e),this.updateHistoryPosition(this.selection.getHierarchicalIndex(r,"0"),!0)}this.fireContentChange()},e.prototype.insertBlockInternal=function(e){var t=this.selection,i=this.selection.start.paragraph;if(!t.start.isAtParagraphStart){if(e instanceof le){this.isInsertingTOC||!this.owner.enableTrackChanges||this.skipTracking()||this.insertRevisionForBlock(e,"Insertion");var r=t.start.clone();return this.isInsertingTOC||!this.owner.enableTrackChanges||this.skipTracking()||this.insertRevisionForBlock(e,"Insertion"),this.insertNewParagraphWidget(e,!1),void(this.isInsertingTOC||this.combineRevisions(e,r,this.selection.end))}this.updateInsertPosition(),i=i.combineWidget(this.owner.viewer),this.splitParagraph(i,i.firstChild,0,t.start.currentWidget,t.start.offset,!1),t.selectParagraphInternal(this.selection.start.paragraph,!0)}var n=t.start.paragraph.containerWidget,o=t.start.paragraph.index;if(!sf.base.isNullOrUndefined(n)){var s=n.childWidgets.indexOf(t.start.paragraph);n.childWidgets.splice(s,0,e),e.containerWidget=n,e.index=o,e.height=0,e instanceof de&&(e.isGridUpdated=!1,e.buildTableColumns(),e.isGridUpdated=!0),this.updateNextBlocksIndex(e,!0),!this.isInsertingTOC&&this.owner.enableTrackChanges&&!this.skipTracking()&&e instanceof le?this.insertRevisionForBlock(e,"Insertion"):e instanceof le?this.constructRevisionsForBlock(e,!0):e instanceof de&&this.constructRevisionsForTable(e,!0),this.documentHelper.layout.layoutBodyWidgetCollection(o,n,e,!1)}},e.prototype.insertImage=function(e,t,i){this.insertImageInternal(e,!1,t,i)},e.prototype.insertImageInternal=function(e,t,i,r){var n=this;if(!this.owner.isReadOnlyMode&&this.canEditContentControl){if(sf.base.isNullOrUndefined(i)&&sf.base.isNullOrUndefined(r)){var o=document.createElement("img"),s=this;o.addEventListener("load",(function(){s.insertPicture(e,this.width,this.height,!0)})),o.src=e}else this.insertPicture(e,i,r,t);setTimeout((function(){sf.base.isNullOrUndefined(n.viewer)||n.viewer.updateScrollBars()}),30)}},e.prototype.insertTable=function(e,t){var i=this.selection.start;if(!this.owner.isReadOnlyMode&&this.canEditContentControl){e=e||1,t=t||1;var r=this.createTable(e,t),n=i.paragraph.getContainerWidth()-r.tableFormat.leftIndent;r.splitWidthToTableCells(n);var o=i.paragraph.previousWidget;if(i.currentWidget.isFirstLine()&&0===i.offset&&o instanceof de)return this.insertTableRows(r,o),void r.destroy();this.initHistory("InsertTable"),this.documentHelper.owner.isShiftingEnabled=!0,this.insertBlock(r),!sf.base.isNullOrUndefined(r.containerWidget)&&!sf.base.isNullOrUndefined(r.containerWidget.containerWidget)&&r.containerWidget.containerWidget instanceof ae&&(r.containerWidget.containerWidget.height+=r.height,this.isTableInsert=!0);var s=this.documentHelper.getFirstParagraphInFirstCell(r).childWidgets[0];i.setPosition(s,!0),this.selection.end.setPositionInternal(i);var a=this.documentHelper.getLastParagraphInLastCell(r.getSplitWidgets().pop()),l=a.getLength()+1;this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&(this.editorHistory.currentBaseHistoryInfo.endPosition=this.selection.getHierarchicalIndex(a,l.toString())),this.reLayout(this.selection),this.isTableInsert=!1}},e.prototype.insertRow=function(e,t){var i=e?"Above":"Below";if(!this.owner.isReadOnlyMode&&this.canEditContentControl){var r=this.selection.isForward?this.selection.start:this.selection.end;this.selection.isForward?this.selection.end:this.selection.start;if(r.paragraph.isInsideTable){this.checkIsNotRedoing()&&this.initHistory("Above"===i?"InsertRowAbove":"InsertRowBelow"),this.documentHelper.owner.isShiftingEnabled=!0;var n=this.getOwnerCell(this.selection.isForward).getSplitWidgets()[0],o=this.getOwnerCell(!this.selection.isForward).getSplitWidgets()[0],s=n.ownerTable.combineWidget(this.owner.viewer),a="Below"===i?o.ownerRow:n.ownerRow;if(this.editorHistory)this.cloneTableToHistoryInfo(s);var l=t||this.getRowCountToInsert(),h=[],d=a.rowIndex;if("Below"===i){d++;var c=sf.base.isNullOrUndefined(o.previousWidget)||o.columnIndex===o.previousWidget.columnIndex+1;o.cellIndex!==o.columnIndex&&c&&a.rowIndex+n.cellFormat.rowSpan-1===o.ownerRow.rowIndex||o.cellFormat.rowSpan>1&&!sf.base.isNullOrUndefined(a.nextWidget)&&a.nextWidget instanceof ce&&(o.cellFormat.rowSpan+=l,a=a.nextWidget),a.bottomBorderWidth=0}for(var p=0;p<l;p++){var u=this.updateRowspan(a,"Below"===i?o:n,i),g=this.createRowAndColumn(u.count,p,d,s);g.rowFormat.copyFormat(a.rowFormat),this.owner.enableTrackChanges&&this.insertRevision(g.rowFormat,"Insertion"),this.updateCellFormatForInsertedRow(g,u.cellFormats),h.push(g)}s.insertTableRowsInternal(h,d,!0);var f=void 0,m=void 0;if(s.childWidgets[d]instanceof ce)f=s.childWidgets[d].firstChild,m=this.selection.getFirstParagraph(f);else{for(var y=void 0;!(y instanceof de);)y=s.nextRenderedWidget;m=this.documentHelper.getFirstParagraphInFirstCell(y)}this.documentHelper.layout.reLayoutTable(s),this.selection.selectParagraphInternal(m,!0)}this.reLayout(this.selection,!0)}},e.prototype.autoFitTable=function(e){if(!this.documentHelper.owner.isReadOnlyMode&&this.canEditContentControl){var t=this.selection.start,i=this.selection.end;this.selection.isForward||(t=this.selection.end,i=this.selection.start);var r=this.selection.getTable(t,i);r=r.getSplitWidgets()[0];var n=this.documentHelper.layout.getParentTable(r);sf.base.isNullOrUndefined(n)||(this.setOffsetValue(this.selection),n=n.combineWidget(this.owner.viewer),this.initHistory("FitToContents"===e?"TableAutoFitToContents":"FitToWindow"===e?"TableAutoFitToWindow":"TableFixedColumnWidth"),this.documentHelper.owner.editorHistoryModule&&this.cloneTableToHistoryInfo(n),n.updateProperties(!0,r,e),this.documentHelper.owner.isShiftingEnabled=!0,this.documentHelper.layout.reLayoutTable(r),this.reLayout(this.selection,!0))}},e.prototype.updateCellFormatForInsertedRow=function(e,t){for(var i=0;i<e.childWidgets.length;i++)e.childWidgets[i].cellFormat.copyFormat(t[i]),e.childWidgets[i].cellFormat.rowSpan=1},e.prototype.updateRowspan=function(e,t,i){for(var r=e.getPreviousRowSpannedCells(!0),n=0,o=[],s=0;s<e.childWidgets.length;s++){for(var a=e.childWidgets[s],l=!1,h=sf.base.isNullOrUndefined(a.previousWidget)||a.columnIndex!==a.previousWidget.columnIndex+1,d=0;d<r.length;d++)if(h){var c=r[d],p=c.ownerRow.rowIndex+c.cellFormat.rowSpan-1;if(a.columnIndex<c.columnIndex&&a.cellIndex!==a.columnIndex&&(l=!0,n++,o.push(a.cellFormat)),1===t.cellFormat.rowSpan)if(p>a.ownerRow.rowIndex){if("Above"===i&&c.ownerRow===t.ownerRow)continue;c.cellFormat.rowSpan+=1,r.splice(d,1),d--}else a.cellIndex!==a.columnIndex&&h&&p===a.ownerRow.rowIndex&&("Above"===i?(c.cellFormat.rowSpan+=1,r.splice(d,1),d--):(n++,o.push(c.cellFormat),r.splice(d,1),d--));else if(c!==t){if("Above"===i&&(c.ownerRow===t.ownerRow||c.columnIndex===t.columnIndex))continue;c.columnIndex!==t.columnIndex&&c.ownerRow.rowIndex!==a.ownerRow.rowIndex&&(p>t.ownerRow.rowIndex||"Above"===i&&p===t.ownerRow.rowIndex)&&(c.cellFormat.rowSpan+=1,r.splice(d,1),d--)}}-1===r.indexOf(a)&&a.cellFormat.rowSpan>1&&(l=!0),l||(n++,o.push(a.cellFormat))}return{count:n,cellFormats:o}},e.prototype.insertTableRows=function(e,t){this.initHistory("InsertTableBelow"),e.containerWidget=t.containerWidget;var i=(t=t.combineWidget(this.owner.viewer)).childWidgets[t.childWidgets.length-1];t.insertTableRowsInternal(e.childWidgets,t.childWidgets.length,!0);var r=this.selection.getFirstParagraph(i.nextWidget.childWidgets[0]);this.checkInsertPosition(this.selection)&&this.updateHistoryPosition(this.selection.getHierarchicalIndex(r,"0"),!0),t.isDefaultFormatUpdated=!1,this.documentHelper.layout.reLayoutTable(t),this.selection.start.setPosition(r.firstChild,!0),this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&this.updateHistoryPosition(this.selection.end,!1),this.selection.end.setPosition(r.firstChild,!0),this.reLayout(this.selection)},e.prototype.insertColumn=function(e,t){if(!this.owner.isReadOnlyMode&&this.canEditContentControl){var i=e?"Left":"Right";if(this.selection.start.paragraph.isInsideTable){this.checkIsNotRedoing()&&this.initHistory("Left"===i?"InsertColumnLeft":"InsertColumnRight"),this.selection.owner.isShiftingEnabled=!0;var r=this.getOwnerCell(this.selection.isForward),n=this.getOwnerCell(!this.selection.isForward),o=r.ownerRow.ownerTable.combineWidget(this.owner.viewer);this.editorHistory&&this.cloneTableToHistoryInfo(o),this.selection.owner.isLayoutEnabled=!1;var s=r.columnIndex;"Right"===i&&(s=n.columnIndex+n.cellFormat.columnSpan);for(var a=void 0,l=void 0,h=t||this.getColumnCountToInsert(),d=[],c=0;c<h;c++)for(var p=0;p<o.childWidgets.length;p++){var u=o.childWidgets[p];(l=this.createColumn(this.selection.getLastParagraph(r))).index=p,l.rowIndex=u.rowIndex,l.containerWidget=u,l.cellFormat.copyFormat(r.cellFormat),l.cellFormat.rowSpan=1,sf.base.isNullOrUndefined(a)&&(a=this.selection.getFirstParagraph(l)),0===s?u.childWidgets.splice(s,0,l):this.insertSpannedCells(u,d,l,s),this.copyCellFormats(u,s)}this.tableReLayout(o,a,l)}}},e.prototype.copyCellFormats=function(e,t){var i=e.childWidgets[t];if(!sf.base.isNullOrUndefined(i)){var r=i.childWidgets[0];t==e.childWidgets.length-1?--t:++t;var n=e.childWidgets[t].childWidgets[0],o=void 0,s=void 0;n.childWidgets.length>0&&(o=n.childWidgets[0]).children.length>0&&(s=o.children[0]),r.paragraphFormat.copyFormat(n.paragraphFormat),sf.base.isNullOrUndefined(s)?r.characterFormat.copyFormat(n.characterFormat):r.characterFormat.copyFormat(s.characterFormat)}},e.prototype.tableReLayout=function(e,t,i){e.updateRowIndex(0);var r=this.documentHelper.layout.getParentTable(e);r?r.fitChildToClientArea():e.fitChildToClientArea(),this.selection.owner.isLayoutEnabled=!0,e.isGridUpdated=!1,e.buildTableColumns(),e.isGridUpdated=!0,this.documentHelper.skipScrollToPosition=!0,this.documentHelper.layout.reLayoutTable(e),this.selection.start.setPosition(t.firstChild,!0),this.selection.end.setPosition(this.selection.getLastParagraph(i).firstChild,!1),(this.checkIsNotRedoing()||sf.base.isNullOrUndefined(this.editorHistory))&&this.reLayout(this.selection)},e.prototype.insertSpannedCells=function(e,t,i,r){for(var n=!1,o=0;o<e.childWidgets.length;o++){var s=e.childWidgets[o];if(s.cellFormat.rowSpan>1&&t.push(s),(s.columnIndex+s.cellFormat.columnSpan===r||r>s.columnIndex&&s.columnIndex+s.cellFormat.columnSpan>r&&r<s.columnIndex+s.cellFormat.columnSpan)&&(e.childWidgets.splice(s.cellIndex+1,0,i),n=!0),n)break}if(!n&&t.length>0)for(var a=0;a<t.length;a++){var l=t[a];if(l.ownerRow!==e&&e.rowIndex<=l.ownerRow.rowIndex+l.cellFormat.rowSpan-1&&(l.columnIndex+l.cellFormat.columnSpan===r?(l.cellIndex>e.childWidgets.length?e.childWidgets.push(i):e.childWidgets.splice(l.cellIndex,0,i),n=!0):r>l.columnIndex&&l.columnIndex+l.cellFormat.columnSpan>r&&r<l.columnIndex+l.cellFormat.columnSpan&&(e.childWidgets.splice(l.columnIndex,0,i),n=!0)),n)break}},e.prototype.createTable=function(e,t){this.selection.start.paragraph;var i=new de;i.tableFormat.preferredWidthType="Auto",i.tableFormat.leftIndent=this.selection.start.paragraph.leftIndent,i.tableFormat.initializeTableBorders();for(var r=0;r<e;){var n=this.createRowAndColumn(t,r);n.rowFormat.heightType="Auto",this.owner.enableTrackChanges&&this.insertRevision(n.rowFormat,"Insertion"),n.containerWidget=i,i.childWidgets.push(n),r++}return i},e.prototype.createRowAndColumn=function(e,t,i,r){var n=r,o=this.selection.start.paragraph,s=new ce;s.rowFormat=new C(s),s.index=t;for(var a=0;a<e;a++){sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(n)||(i&&i>0&&n.childWidgets[i-1]&&n.childWidgets[i-1].childWidgets[a]?o=n.childWidgets[i-1].childWidgets[a].childWidgets[0]:0==i&&(o=n.childWidgets[i].childWidgets[a].childWidgets[0]));var l=this.createColumn(o,!0);l.index=a,l.rowIndex=t,l.containerWidget=s,s.childWidgets.push(l)}return s},e.prototype.createColumn=function(e,t){var i=new pe,r=new le;if(t){r.paragraphFormat.copyFormat(e.paragraphFormat),r.paragraphFormat.leftIndent=0,r.paragraphFormat.firstLineIndent=0;var n=e.childWidgets[0].children[0];sf.base.isNullOrUndefined(n)?r.characterFormat.copyFormat(e.characterFormat):r.characterFormat.copyFormat(n.characterFormat)}return r.containerWidget=i,i.childWidgets.push(r),i.cellFormat=new bt(i),i},e.prototype.getColumnCountToInsert=function(){var e=1,t=this.selection.start,i=this.selection.end;if(this.selection.isForward||(t=this.selection.end,i=this.selection.start),t&&i&&this.selection.getTable(t,i)){if(t.paragraph.associatedCell===i.paragraph.associatedCell)return 1;if(t.paragraph.associatedCell.ownerRow===i.paragraph.associatedCell.ownerRow)return e+i.paragraph.associatedCell.cellIndex-t.paragraph.associatedCell.cellIndex;e=0;for(var r=t.paragraph.associatedCell.ownerTable.getColumnCellsForSelection(t.paragraph.associatedCell,i.paragraph.associatedCell),n=0;n<r.length;n++)t.paragraph.associatedCell.ownerRow===r[n].ownerRow&&e++}return 0===e?1:e},e.prototype.getRowCountToInsert=function(){var e=1,t=this.selection.start,i=this.selection.end;return this.selection.isForward||(t=this.selection.end,i=this.selection.start),sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(this.selection.getTable(t,i))?0===e?1:e:t.paragraph.associatedCell===i.paragraph.associatedCell||t.paragraph.associatedCell.ownerRow===i.paragraph.associatedCell.ownerRow?1:e+this.getOwnerRow(!this.selection.isForward).rowIndex-this.getOwnerRow(this.selection.isForward).rowIndex},e.prototype.getOwnerCell=function(e){for(var t=void 0,i=e?this.selection.start.paragraph.associatedCell:this.selection.end.paragraph.associatedCell,r=e?this.selection.end.paragraph.associatedCell:this.selection.start.paragraph.associatedCell,n=(t=i).ownerTable;!sf.base.isNullOrUndefined(n)&&n.containerWidget instanceof pe&&n!==r.ownerTable;)n=(t=n.containerWidget).ownerTable;return t},e.prototype.getOwnerRow=function(e){for(var t,i=e?this.selection.start.paragraph.associatedCell.ownerRow:this.selection.end.paragraph.associatedCell.ownerRow,r=e?this.selection.end.paragraph.associatedCell.ownerRow:this.selection.start.paragraph.associatedCell.ownerRow,n=(t=i).ownerTable;!sf.base.isNullOrUndefined(n)&&n.containerWidget instanceof pe&&n!==r.ownerTable;)n=(t=n.containerWidget.ownerRow).ownerTable;return t},e.prototype.getOwnerTable=function(e){var t=void 0,i=this.selection.start.paragraph.associatedCell.ownerTable,r=this.selection.end.paragraph.associatedCell.ownerTable;for(t=e?i:r;t.containerWidget instanceof pe&&t!==(e?r:i);)t=t.containerWidget.ownerTable;return t},e.prototype.mergeSelectedCellsInTable=function(){this.canMergeCells()&&(this.owner.enableTrackChanges||this.confirmCellMerge())},e.prototype.confirmCellMerge=function(){this.checkIsNotRedoing()&&this.initHistory("MergeCells"),this.selection.owner.isShiftingEnabled=!0;var e=this.selection.start,t=this.selection.end;this.selection.isForward||(e=this.selection.end,t=this.selection.start);var i=this.getOwnerCell(this.selection.isForward),r=this.getOwnerCell(!this.selection.isForward),n=this.selection.getContainerCellOf(i,r);if(n.ownerTable.contains(r)&&!this.selection.containsCell(n,r)){var o=i.ownerTable.combineWidget(this.owner.viewer);i=this.selection.getSelectedCell(i,n),r=this.selection.getSelectedCell(r,n);var s=this.mergeSelectedCells(o,i,r),a=this.selection.getFirstParagraph(s);e.setPosition(a.firstChild,!0);var l=this.selection.getLastParagraph(s);t.setPosition(l.lastChild,!1),this.selection.fireSelectionChanged(!1)}(this.checkIsNotRedoing()||sf.base.isNullOrUndefined(this.editorHistory))&&this.reLayout(this.selection,!1)},e.prototype.mergeSelectedCells=function(e,t,i){this.cloneTableToHistoryInfo(e);this.selection.owner.isLayoutEnabled=!1;var r=this.selection.getCellLeft(t.ownerRow,t),n=r+t.cellFormat.cellWidth,o=this.selection.getCellLeft(i.ownerRow,i),s=o+i.cellFormat.cellWidth,a=this.updateSelectedCellsInTable(r,n,o,s);r=a.start,n=a.end;for(var l,h=e.childWidgets.indexOf(i.ownerRow),d=e.childWidgets.indexOf(t.ownerRow),c=void 0,p=d;p<=h;p++){for(var u=e.childWidgets[p],g=0;g<u.childWidgets.length;g++){var f=u.childWidgets[g],m=this.selection.getCellLeft(u,f);if(x.round(r,2)<=x.round(m,2)&&x.round(m,2)<x.round(n,2)){var y=f.lastChild;if(y instanceof le&&y.isEmpty()&&f.childWidgets.pop(),sf.base.isNullOrUndefined(c))c=f,l=y;else{p===d&&(c.cellFormat.preferredWidth+=f.cellFormat.preferredWidth,c.cellFormat.columnSpan+=f.cellFormat.columnSpan,this.mergeBorders(c,f));for(var v=0;v<f.childWidgets.length;v++){(b=f.childWidgets[v].clone()).containerWidget=c,c.childWidgets.push(b)}u.childWidgets.splice(g,1),f.destroy(),g--}}}if((0===c.childWidgets.length||1===c.childWidgets.length&&c.childWidgets[0]instanceof de)&&l){var b=l.clone();c.childWidgets.push(b),b.containerWidget=c}if(0===u.childWidgets.length){var w=e.childWidgets.indexOf(u);u.updateRowBySpannedCells(),e.childWidgets.splice(w,1),u.destroy(),h--,p--}}return!sf.base.isNullOrUndefined(c)&&d<h&&(c.cellFormat.rowSpan=h-d+1),this.updateBlockIndexAfterMerge(c),e.updateRowIndex(0),e.calculateGrid(),e.isGridUpdated=!1,e.buildTableColumns(),e.isGridUpdated=!0,this.documentHelper.layout.reLayoutTable(e),this.selection.owner.isLayoutEnabled=!0,c},e.prototype.mergeBorders=function(e,t){var i=void 0,r=null;if(sf.base.isNullOrUndefined(e.cellFormat.borders)||(i=e.cellFormat.borders),sf.base.isNullOrUndefined(t.cellFormat.borders)||(r=t.cellFormat.borders),!sf.base.isNullOrUndefined(i)||!sf.base.isNullOrUndefined(r))if(sf.base.isNullOrUndefined(i))(i=new u(e.cellFormat)).copyFormat(r);else{if(sf.base.isNullOrUndefined(r))return;e.ownerRow.rowIndex===t.ownerRow.rowIndex&&(i.top=e.getBorderBasedOnPriority(i.top,r.bottom),i.bottom=e.getBorderBasedOnPriority(i.bottom,r.bottom))}},e.prototype.updateBlockIndexAfterMerge=function(e){for(var t=0;t<e.childWidgets.length;t++)e.childWidgets[t].index=t},e.prototype.canMergeCells=function(){if(this.selection.isEmpty||!this.selection.start.paragraph.isInsideTable||!this.selection.end.paragraph.isInsideTable)return!1;this.selection.start,this.selection.end;this.selection.isForward||(this.selection.end,this.selection.start);var e=this.getOwnerCell(this.selection.isForward),t=this.getOwnerCell(!this.selection.isForward),i=this.selection.getContainerCellOf(e,t);if(i.ownerTable.contains(t)&&!this.selection.containsCell(i,t)){e=this.selection.getSelectedCell(e,i),t=this.selection.getSelectedCell(t,i);var r=1;if(e.ownerRow===t.ownerRow){for(var n=e.ownerRow.childWidgets.indexOf(e),o=n;o<=e.ownerRow.childWidgets.indexOf(t);o++){var s=e.ownerRow.childWidgets[o],a=s.previousWidget;if(o!==n){if(s.cellFormat.rowSpan!==r)return!1;if(!sf.base.isNullOrUndefined(a)&&s.columnIndex!==a.cellFormat.columnSpan+a.columnIndex)return!1}r=s.cellFormat.rowSpan}return!0}return this.canMergeSelectedCellsInTable(e.ownerTable,e,t)}return!1},e.prototype.canMergeSelectedCellsInTable=function(e,t,i){var r=e.childWidgets.indexOf(i.ownerRow),n=e.childWidgets.indexOf(t.ownerRow),o=this.selection.getCellLeft(t.ownerRow,t),s=o+t.cellFormat.cellWidth,a=this.selection.getCellLeft(i.ownerRow,i),l=a+i.cellFormat.cellWidth,h=this.updateSelectedCellsInTable(o,s,a,l);o=h.start,s=h.end;for(var d=0,c=0,p=!1,u=!1,g=[],f=n;f<=r;f++){for(var m=e.childWidgets[f],y=0,v=0,b=!1,w=0;w<m.childWidgets.length;w++){var M=m.childWidgets[w],N=this.selection.getCellLeft(m,M);if(this.checkCellWithInSelection(o,s,N)){p=!1,u=!1,M.cellFormat.rowSpan>1&&g.push(M),b||(y=N,v=N,b=!0);var I=M.previousWidget;0!==v&&x.round(v,0)!==x.round(N,0)&&(v=N),v+=x.convertPointToPixel(M.cellFormat.cellWidth);var S=this.checkPrevOrNextCellIsWithinSel(o,s,M,!0),C=this.checkPrevOrNextCellIsWithinSel(o,s,M,!1),O=0===g.length||1===g.length&&g[0]===M,T=this.checkCurrentCell(g,M,S,C);if(f===r&&!sf.base.isNullOrUndefined(I)&&M.cellFormat.rowSpan>I.cellFormat.rowSpan&&!T)return!1;if(f!==n)for(var P=0;P<g.length;P++){var A=g[P].ownerRow.rowIndex+g[P].cellFormat.rowSpan-1;if(A>=m.rowIndex){if(g[P].columnIndex>M.columnIndex?u=!0:p=!0,f===r&&g[P]!==M&&A>M.ownerRow.rowIndex+M.cellFormat.rowSpan-1)return!1;A!==m.rowIndex||this.checkPrevOrNextCellIsWithinSel(o,s,M,!1)||g.splice(g.indexOf(g[P]),1)}}if(S&&!sf.base.isNullOrUndefined(I)&&O&&M.columnIndex!==I.columnIndex+1&&this.checkCellWidth(M))return!1}}if(f===n)d=y,c=v;else{if(v>0&&y>0&&(!p&&Math.round(d)!==Math.round(y)||!u&&Math.round(c)!==Math.round(v)))return!1;if(f===r)return!0}}return!1},e.prototype.checkCellWidth=function(e){var t=e.previousWidget,i=this.documentHelper.selection.getCellLeft(e.ownerRow,e),r=this.documentHelper.selection.getCellLeft(e.ownerRow,t)+x.convertPointToPixel(t.cellFormat.cellWidth);return x.round(r,2)!==x.round(i,2)},e.prototype.checkCellWithInSelection=function(e,t,i){return x.round(e,2)<=x.round(i,2)&&x.round(i,2)<x.round(t,2)},e.prototype.checkPrevOrNextCellIsWithinSel=function(e,t,i,r){var n,o=r?i.previousWidget:i.nextWidget;return!sf.base.isNullOrUndefined(o)&&(n=this.documentHelper.selection.getCellLeft(o.ownerRow,o),this.checkCellWithInSelection(e,t,n))},e.prototype.checkCurrentCell=function(e,t,i,r){var n=t.ownerRow;if(e.length>0)for(var o=0;o<e.length;o++){var s=e[o].ownerRow,a=s.rowIndex+e[o].cellFormat.rowSpan-1;if(e[o]===t&&(1===e.length||this.checkRowSpannedCells(e,t))&&!r&&!i)return!0;if(e[o]!==t&&s.rowIndex<n.rowIndex&&a===n.rowIndex+t.cellFormat.rowSpan-1)return!0}return!1},e.prototype.checkRowSpannedCells=function(e,t){for(var i=0;i<e.length;i++)if(e[i]!==t&&e[i].columnIndex===t.columnIndex)return!0;return!1},e.prototype.insertNewParagraphWidget=function(e,t){if(this.updateInsertPosition(),this.insertParagraph(e,t),!t){var i=void 0,r=e;do{r=i=this.selection.getNextParagraphBlock(r)}while(i&&i.equals(e));sf.base.isNullOrUndefined(i)?this.selection.selectParagraphInternal(e,!0):this.selection.selectParagraphInternal(i,!0)}this.fireContentChange()},e.prototype.insertParagraph=function(e,t){var i=this.selection.start.currentWidget,r=this.selection.start.offset;this.editorHistory&&this.editorHistory.isUndoing&&"InsertTextParaReplace"===this.editorHistory.currentBaseHistoryInfo.action&&(r=0);var n=this.selection.start.paragraph;if(n=n.combineWidget(this.owner.viewer),t){var o=this.selection.getLineLength(n.lastChild),s=e.firstChild?e.firstChild.children.length:0;this.moveInlines(n,e,s,r,i,o,n.lastChild)}else r>0&&this.moveInlines(n,e,0,0,n.firstChild,r,i);var a=n.getSplitWidgets(),l=(n=t?a[a.length-1]:a[0]).containerWidget.childWidgets.indexOf(n);t&&l++;var h=n.containerWidget;e.index=n.index,e.containerWidget=h,h.childWidgets.splice(l,0,e),this.constructRevisionsForBlock(e,!0),this.updateNextBlocksIndex(t?n:e,!0),e.height=0,this.documentHelper.layout.layoutBodyWidgetCollection(e.index,h,e,!1)},e.prototype.moveInlines=function(e,t,i,r,n,o,s){if(0===t.childWidgets.length){var a=new ue(t);t.childWidgets.push(a)}var l=!1;this.documentHelper.layout.clearListElementBox(e),this.documentHelper.layout.clearListElementBox(t);for(var h=0;h<e.childWidgets.length;h++){var d=e.childWidgets[h];if(n===d&&s===d){i=this.moveContent(d,r,o,i,t);break}if(s===d){i=this.moveContent(d,0,o,i,t);break}n===d?(l=!0,i=this.moveContent(d,r,this.documentHelper.selection.getLineLength(d),i,t)):l&&(i=this.moveContent(d,0,this.documentHelper.selection.getLineLength(d),i,t))}this.removeEmptyLine(e),e.isInsideTable||(this.viewer.updateClientArea(e.bodyWidget,e.bodyWidget.page),this.documentHelper.layout.reLayoutParagraph(e,0,0))},e.prototype.moveContent=function(e,t,i,r,n){for(var o=0,s=0;s<e.children.length;s++){var a=e.children[s];if(t>=o+a.length||a instanceof je)a instanceof je||(o+=a.length);else{var l=0;t>o&&(l=t-o);var h=i-o;if(h>a.length&&(h=a.length),l>0&&(o+=l),0===l&&h===a.length){if(a instanceof Ee){var d=e.paragraph.floatingElements.indexOf(a);-1!==d&&e.paragraph.floatingElements.splice(d,1)}n.firstChild.children.splice(r,0,a),a.line=n.firstChild,r++,e.children.splice(s,1),s--}else if(a instanceof we){var c=new we;c.characterFormat.copyFormat(a.characterFormat),c.text=a.text.substr(l,h-l),a.ischangeDetected=!0,c.ischangeDetected=!0,n.firstChild.children.splice(r,0,c),c.line=n.firstChild,r++,this.updateRevisionForMovedContent(a,c),a.text=a.text.slice(0,l)+a.text.slice(h),a.ischangeDetected=!0}if(i<=o+h-l)break;o+=h-l}}return r},e.prototype.updateRevisionForMovedContent=function(e,t){for(var i=0;i<e.revisions.length;i++){var r=e.revisions[i],n=r.range.indexOf(e);t.revisions.splice(0,0,r),r.range.splice(n,0,t)}},e.prototype.updateComplexWithoutHistory=function(e,t,i){var r=this.documentHelper.selection;if(0===e){var n=new Ft(r.owner);this.setPositionForCurrentIndex(n,t),this.documentHelper.layout.reLayoutParagraph(n.paragraph,0,0),this.setPositionForCurrentIndex(r.start,i),this.setPositionForCurrentIndex(r.end,i)}if(1===e){n=new Ft(r.owner);this.setPositionForCurrentIndex(n,t);var o=new Ft(r.owner);this.setPositionForCurrentIndex(o,i),this.documentHelper.layout.reLayoutParagraph(n.paragraph,0,0),o.paragraph!==n.paragraph&&this.documentHelper.layout.reLayoutParagraph(o.paragraph,0,0)}r.owner.isShiftingEnabled&&(this.documentHelper.layout.shiftLayoutedItems(!1),this.documentHelper.owner.enableHeaderAndFooter&&this.updateHeaderFooterWidget()),r.owner.isShiftingEnabled=!1,r.start.updatePhysicalPosition(!0),r.isEmpty?r.end.setPositionInternal(r.start):r.end.updatePhysicalPosition(!0),r.upDownSelectionLength=r.end.location.x,r.fireSelectionChanged(!0),this.documentHelper.updateFocus(),this.owner.viewer.updateScrollBars(),this.fireContentChange(),this.isHandledComplex=!0},e.prototype.reLayout=function(e,t,i){if(!sf.base.isNullOrUndefined(this.previousBlockToLayout)){var r=this.previousBlockToLayout;this.documentHelper.layout.layoutBodyWidgetCollection(r.index,r.bodyWidget,r,!1,!1),this.previousBlockToLayout=void 0}if(!this.documentHelper.isComposingIME&&this.editorHistory&&this.editorHistory.isHandledComplexHistory())return this.editorHistory.currentHistoryInfo&&"ClearFormat"!==this.editorHistory.currentHistoryInfo.action&&"ApplyStyle"!==this.editorHistory.currentHistoryInfo.action&&(this.startParagraph=void 0,this.endParagraph=void 0),void(this.isHandledComplex=!1);sf.base.isNullOrUndefined(e.editRegionHighlighters)||e.editRegionHighlighters.clear(),sf.base.isNullOrUndefined(this.documentHelper.blockToShift)&&(this.documentHelper.removeEmptyPages(),this.documentHelper.layout.updateFieldElements(),this.owner.viewer.updateScrollBars(),e.owner.isShiftingEnabled||(e.fireSelectionChanged(!0),this.startParagraph=void 0,this.endParagraph=void 0)),sf.base.isNullOrUndefined(t)&&(t=e.isEmpty),this.owner.showRevisions&&this.owner.trackChangesPane.isUpdateTrackChanges(this.owner.revisions.length)&&this.owner.trackChangesPane.updateTrackChanges(),e.owner.isShiftingEnabled?(e.owner.isShiftingEnabled=!1,e.owner.isLayoutEnabled=!0,this.documentHelper.layout.shiftLayoutedItems(!0),this.documentHelper.owner.enableHeaderAndFooter&&this.updateHeaderFooterWidget(),this.documentHelper.isRowOrCellResizing||(sf.base.isNullOrUndefined(e.start.paragraph)||!sf.base.isNullOrUndefined(e.start.paragraph.bodyWidget.containerWidget)&&e.start.paragraph.bodyWidget.containerWidget instanceof ae&&("Footnote"===e.start.paragraph.bodyWidget.containerWidget.footNoteType?(this.documentHelper.layout.isRelayoutFootnote=!0,this.shiftFootnotePageContent(e.start.paragraph.bodyWidget.containerWidget)):(this.documentHelper.layout.isRelayoutFootnote=!1,this.shiftFootnotePageContent())),this.getOffsetValue(e),e.upDownSelectionLength=e.end.location.x,e.fireSelectionChanged(!0),this.documentHelper.updateFocus(),this.startParagraph=void 0,this.endParagraph=void 0)):this.documentHelper.owner.enableHeaderAndFooter&&this.updateHeaderFooterWidget(),this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&("RowResizing"!==this.editorHistory.currentBaseHistoryInfo.action&&"CellResizing"!==this.editorHistory.currentBaseHistoryInfo.action||this.editorHistory.isUndoing||this.editorHistory.isRedoing)&&(this.editorHistory.currentBaseHistoryInfo.modifiedProperties.length>0&&this.editorHistory.currentBaseHistoryInfo.updateSelection(),this.editorHistory.undoStack&&this.editorHistory.undoStack.length>0&&this.editorHistory.undoStack[this.editorHistory.undoStack.length-1]instanceof $t&&this.editorHistory.undoStack[this.editorHistory.undoStack.length-1].modifiedActions&&this.editorHistory.undoStack[this.editorHistory.undoStack.length-1].modifiedActions[this.editorHistory.undoStack[this.editorHistory.undoStack.length-1].modifiedActions.length-1]===this.editorHistory.currentBaseHistoryInfo?this.editorHistory.currentBaseHistoryInfo=void 0:this.editorHistory.updateHistory()),i||(this.fireContentChange(),this.owner.documentHelper.layout.isRelayout=!1)},e.prototype.updateHeaderFooterWidget=function(e){sf.base.isNullOrUndefined(e)&&(e=this.selection.start.paragraph.bodyWidget),this.updateHeaderFooterWidgetToPage(e),this.shiftPageContent(e.headerFooterType,e.sectionFormat)},e.prototype.updateHeaderFooterWidgetToPage=function(e){e.page;for(var t="EvenHeader"===e.headerFooterType||"EvenFooter"===e.headerFooterType,i=0;i<this.documentHelper.pages.length;i++){var r=this.documentHelper.pages[i];if(i+1===1&&r.bodyWidgets[0].sectionFormat.differentFirstPage&&-1!==e.headerFooterType.indexOf("FirstPage"))return void this.updateHeaderFooterWidgetToPageInternal(r,e,-1!==e.headerFooterType.indexOf("Header"));0===r.index&&r.bodyWidgets[0].sectionFormat.differentFirstPage&&-1===e.headerFooterType.indexOf("FirstPage")||(r.bodyWidgets[0].sectionFormat.differentOddAndEvenPages?t&&(i+1)%2==0?this.updateHeaderFooterWidgetToPageInternal(r,e,-1!==e.headerFooterType.indexOf("Header")):t||(i+1)%2==0||(i>0||!r.bodyWidgets[0].sectionFormat.differentFirstPage)&&this.updateHeaderFooterWidgetToPageInternal(r,e,-1!==e.headerFooterType.indexOf("Header")):this.updateHeaderFooterWidgetToPageInternal(r,e,-1!==e.headerFooterType.indexOf("Header")))}},e.prototype.updateHeaderFooterWidgetToPageInternal=function(e,t,i){if(i?t!=e.headerWidgetIn:t!=e.footerWidgetIn){var r=t.clone();this.documentHelper.layout.clearBlockWidget(r.childWidgets,!0,!0,!0),r.page=e,r.parentHeaderFooter=t,this.owner.viewer.updateHFClientArea(r.sectionFormat,i),r=this.documentHelper.layout.layoutHeaderFooterItems(this.owner.viewer,r);var n=void 0;i?(n=e.headerWidgetIn,e.headerWidget=r):(n=e.footerWidgetIn,e.footerWidget=r),this.removeFieldInWidget(n),this.removeFieldInWidget(n,void 0,!0),n.destroy()}},e.prototype.removeFieldInWidget=function(e,t,i){sf.base.isNullOrUndefined(t)&&(t=!1);for(var r=0;r<e.childWidgets.length;r++)this.removeFieldInBlock(e.childWidgets[r],t,i)},e.prototype.removeFieldInBlock=function(e,t,i){if(e instanceof de){if(e.wrapTextAround&&!sf.base.isNullOrUndefined(e.bodyWidget)){var r=e.bodyWidget.floatingElements.indexOf(e);-1!==r&&e.bodyWidget.floatingElements.splice(r,1)}this.removeFieldTable(e,t,i)}else if(e instanceof ce)for(var n=0;n<e.childWidgets.length;n++)this.removeFieldInWidget(e.childWidgets[n],t,i);else this.removeField(e,t,i)},e.prototype.removeFieldTable=function(e,t,i){for(var r=0;r<e.childWidgets.length;r++)for(var n=e.childWidgets[r],o=0;o<n.childWidgets.length;o++)this.removeFieldInWidget(n.childWidgets[o],t,i)},e.prototype.shiftFootnotePageContent=function(e){var t=this.documentHelper.pages[0].bodyWidgets[0];if(!sf.base.isNullOrUndefined(e)){var i=this.documentHelper.pages.indexOf(e.page);t=this.documentHelper.pages[i].bodyWidgets[0]}sf.base.isNullOrUndefined(t.page.footnoteWidget)||this.checkAndShiftFromBottom(t.page,t.page.footnoteWidget),sf.base.isNullOrUndefined(t.page.endnoteWidget),this.documentHelper.blockToShift&&(this.documentHelper.renderedLists.clear(),this.documentHelper.renderedLevelOverrides=[],this.documentHelper.layout.shiftLayoutedItems(!1))},e.prototype.shiftPageContent=function(e,t){var i;if(-1!==e.indexOf("First"))i=0;else if(t.differentOddAndEvenPages){var r=-1!==e.indexOf("Even");i=t.differentFirstPage?r?1:2:r?1:0}else 1===(i=t.differentFirstPage?1:0)&&1===this.documentHelper.pages.length&&(i=0);var n=this.documentHelper.pages[i].bodyWidgets[0];do{if(-1!==e.indexOf("Header")){var o=n.page.headerWidget,s=!o.isEmpty||o.isEmpty&&this.owner.enableHeaderAndFooter,a=n.firstChild,l=x.convertPointToPixel(t.topMargin),h=x.convertPointToPixel(t.headerDistance);if(s&&(l=Math.max(h+n.page.headerWidget.height,l)),a.y!==l){this.owner.viewer.updateClientArea(n,n.page);var d=(a=a.combineWidget(this.owner.viewer)).previousRenderedWidget;d&&(!a.containerWidget.equals(d.containerWidget)||d.containerWidget.lastChild instanceof le&&(d.containerWidget.lastChild.isEndsWithPageBreak||d.containerWidget.lastChild.isEndsWithColumnBreak)||(this.owner.viewer.cutFromTop(d.y+d.height),this.documentHelper.layout.updateContainerWidget(a,d.containerWidget,d.indexInOwner+1,!1))),this.documentHelper.blockToShift=a}}else this.checkAndShiftFromBottom(n.page,n.page.footerWidget);for(this.documentHelper.blockToShift&&(this.documentHelper.renderedLists.clear(),this.documentHelper.renderedLevelOverrides=[],this.documentHelper.layout.shiftLayoutedItems(!1));n;){var c=n.getSplitWidgets();if(n=c[c.length-1].nextRenderedWidget){if(0===i)break;if(n.page.index+1===0&&1===i||n.page.index+1!==0&&2===i)break;var p=n.page.nextPage;if(!sf.base.isNullOrUndefined(p)&&p.bodyWidgets[0].equals(n)){n=p.bodyWidgets[0];break}}}}while(n)},e.prototype.checkAndShiftFromBottom=function(e,t){var i,r=e.bodyWidgets[0];if(r.childWidgets.length>1){for(var n=0;n<r.childWidgets.length;n++){var o=r.childWidgets[n];if(o.y+o.height>t.y){i=o;break}if(!(t instanceof ae)&&r.childWidgets.length-1===n&&o.y+o.height<t.y){i=o;break}}sf.base.isNullOrUndefined(i)||(this.owner.viewer.updateClientArea(r,e,!0),this.owner.viewer.cutFromTop(i.y),this.documentHelper.blockToShift=i)}},e.prototype.allowFormattingInFormFields=function(e){if("FormFieldsOnly"===this.documentHelper.protectionType&&this.selection.isInlineFormFillMode()&&!sf.base.isNullOrUndefined(this.owner.documentEditorSettings.formFieldSettings.formattingExceptions))for(var t=0;t<this.owner.documentEditorSettings.formFieldSettings.formattingExceptions.length;t++)if(e.toLowerCase()===this.owner.documentEditorSettings.formFieldSettings.formattingExceptions[t].toLowerCase())return!0;return!1},e.prototype.getContentControl=function(){for(var e=0;e<this.documentHelper.contentControlCollection.length;e++){var t=this.documentHelper.contentControlCollection[e],i=this.selection.getPosition(t),r=i.startPosition,n=i.endPosition,o=this.selection.start,s=this.selection.end;if(this.selection.isForward||(o=this.selection.end,s=this.selection.start),(o.isExistAfter(r)||o.isAtSamePosition(r))&&(s.isExistBefore(n)||s.isAtSamePosition(n)))return t}},e.prototype.checkPlainTextContentControl=function(){var e=this.selection.start,t=this.selection.end;this.selection.isForward||(t=this.selection.start,e=this.selection.end);var i=0,r=0,n=e.currentWidget.getInline(e.offset,i),o=t.currentWidget.getInline(t.offset,r);i=n.index,r=o.index;var s,a,l=n.element,h=o.element;if(l&&l.contentControlProperties&&"Text"===l.contentControlProperties.type||h&&h.contentControlProperties&&"Text"===h.contentControlProperties.type){if((l=this.getContentControl()).contentControlProperties&&!sf.base.isNullOrUndefined(l)){var d=l.line.getOffset(l,1);(s=new Ft(this.owner)).setPositionParagraph(l.line,d)}else s=e;if(h.contentControlProperties&&l.reference){var c=(h=l.reference).line.getOffset(h,h.length);(a=new Ft(this.owner)).setPositionParagraph(h.line,c)}else a=t;this.selection.selectRange(s,a)}else e.paragraph.contentControlProperties&&"Text"===e.paragraph.contentControlProperties.type&&this.selection.selectParagraph()},e.prototype.onApplyCharacterFormat=function(e,t,i,r){var n=this.documentHelper.isFormFillProtectedMode&&this.documentHelper.selection.isInlineFormFillMode()&&this.allowFormattingInFormFields(e);if(!(this.restrictFormatting&&!n||this.selection.checkContentControlLocked(!0))){this.documentHelper.layout.isBidiReLayout=!0;var o=this.documentHelper.selection;if((!o.owner.isReadOnlyMode||n)&&o.owner.isDocumentLoaded){i=!sf.base.isNullOrUndefined(i)&&i,r=!sf.base.isNullOrUndefined(r)&&r;var s=e[0].toUpperCase()+e.slice(1),a=o.start.paragraph;a.childWidgets[a.childWidgets.length-1];if(this.checkPlainTextContentControl(),o.isEmpty&&"List"!==o.contextType&&!r)return o.skipFormatRetrieval=!0,o.end.isAtParagraphEnd?(this.initHistory(s),this.documentHelper.owner.isShiftingEnabled=!0,this.applyCharFormatValue(a.characterFormat,e,t,i),this.reLayout(this.documentHelper.selection),this.documentHelper.updateFocus()):o.fireSelectionChanged(!0),void(o.skipFormatRetrieval=!1);if("highlightColor"===e&&o.start.isInSameParagraph(o.end)){var l=o.start,h=o.end;if(this.selection.isForward||(h=o.start,l=o.end),h.offset===o.getLineLength(h.currentWidget)+1&&h.offset-1===l.offset)return}this.setOffsetValue(o),this.initHistory(s),"List"===o.contextType?this.applyCharacterFormatForListText(o,e,t,i):this.updateSelectionCharacterFormatting(e,t,i),this.documentHelper.layout.isBidiReLayout=!1}}},e.prototype.applyCharacterFormatForListText=function(e,t,i,r){var n=e.getListLevel(e.start.paragraph);if(!sf.base.isNullOrUndefined(n)){var o=n.characterFormat;switch(t){case"bold":this.applyListCharacterFormatByValue(e,o,"bold",!o.bold);break;case"italic":this.applyListCharacterFormatByValue(e,o,"italic",!o.italic);break;case"fontColor":this.applyListCharacterFormatByValue(e,o,"fontColor",i);break;case"fontFamily":this.applyListCharacterFormatByValue(e,o,"fontFamily",i);break;case"fontSize":this.applyListCharacterFormatByValue(e,o,"fontSize",i);break;case"highlightColor":this.applyListCharacterFormatByValue(e,o,"highlightColor",i);break;case"baselineAlignment":o.baselineAlignment===i&&(i="Normal"),this.applyListCharacterFormatByValue(e,o,"baselineAlignment",i);break;case"strikethrough":o.strikethrough===i&&(i="None"),this.applyListCharacterFormatByValue(e,o,"strikethrough",i);break;case"underline":o.underline===i&&(i="None"),this.applyListCharacterFormatByValue(e,o,"underline",i);break;case"characterFormat":this.applyListCharacterFormatByValue(e,o,void 0,i)}}},e.prototype.applyListCharacterFormatByValue=function(e,t,i,r){this.initHistory("ListCharacterFormat"),this.applyCharFormatValue(t,i,r,!1),this.editorHistory.updateHistory(),this.reLayout(e),this.fireContentChange()},e.prototype.updateListCharacterFormat=function(e,t,i){this.updateListTextSelRange(e,t,i,!1)},e.prototype.updateListTextSelRange=function(e,t,i,r){this.documentHelper.owner.isShiftingEnabled=!0;var n=e.start,o=e.end;e.isForward||(n=e.end,o=e.start),this.initHistoryPosition(e,n);var s=e.getListLevel(e.start.paragraph);this.applyCharFormatValue(s.characterFormat,t,i,r),this.startSelectionReLayouting(n.paragraph,e,n,o)},e.prototype.updateInsertPosition=function(){var e=this.documentHelper.selection,t=e.start;e.isForward||(t=e.end),!this.editorHistory||sf.base.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)||sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo.insertPosition)&&this.updateHistoryPosition(t,!0)},e.prototype.setOffsetValue=function(e){var t=this.selection.getParagraphInfo(e.start);this.startParagraph=t.paragraph,this.startOffset=t.offset,t=this.selection.getParagraphInfo(e.end),this.endParagraph=t.paragraph,this.endOffset=t.offset},e.prototype.toggleHighlightColor=function(e){var t=this.documentHelper.selection;(sf.base.isNullOrUndefined(e)||"NoColor"===e)&&(e="Yellow"),t.characterFormat.highlightColor===e&&(e="NoColor"),this.selection.characterFormat.highlightColor=e},e.prototype.toggleSubscript=function(){if(!this.owner.isReadOnlyMode&&!this.restrictFormatting){var e="Subscript"===this.selection.characterFormat.baselineAlignment?"Normal":"Subscript";this.selection.characterFormat.baselineAlignment=e}},e.prototype.toggleSuperscript=function(){if(!this.owner.isReadOnlyMode&&!this.restrictFormatting){var e="Superscript"===this.selection.characterFormat.baselineAlignment?"Normal":"Superscript";this.selection.characterFormat.baselineAlignment=e}},e.prototype.increaseIndent=function(){this.owner.isReadOnlyMode&&!this.selection.isInlineFormFillMode()||this.onApplyParagraphFormat("leftIndent",this.documentHelper.defaultTabWidth,!0,!1)},e.prototype.decreaseIndent=function(){this.owner.isReadOnlyMode&&!this.selection.isInlineFormFillMode()||this.onApplyParagraphFormat("leftIndent",-this.documentHelper.defaultTabWidth,!0,!1)},e.prototype.clearList=function(){this.selection.owner.editorModule.onApplyList(void 0)},e.prototype.applyBullet=function(e,t){this.owner.isReadOnlyMode&&!this.selection.isInlineFormFillMode()||this.applyBulletOrNumbering(e,"Bullet",t)},e.prototype.applyNumbering=function(e,t){this.owner.isReadOnlyMode&&!this.selection.isInlineFormFillMode()||this.applyBulletOrNumbering(e,t,"Verdana")},e.prototype.toggleBaselineAlignment=function(e){this.updateProperty(2,e)},e.prototype.clearFormattingInternal=function(e){var t=this.documentHelper.selection;this.setPreviousBlockToLayout(),this.initComplexHistory("ClearFormat"),(t.isEmpty||!sf.base.isNullOrUndefined(e)&&e)&&(t.start.moveToParagraphStartInternal(t,!1),t.end.moveToParagraphEndInternal(t,!1)),this.setOffsetValue(t),this.editorHistory&&this.editorHistory.initializeHistory("ClearCharacterFormat"),this.updateSelectionCharacterFormatting("ClearCharacterFormat",void 0,!1),this.getOffsetValue(t),this.editorHistory&&this.editorHistory.updateHistory(),this.setOffsetValue(t),this.editorHistory&&this.editorHistory.initializeHistory("ClearParagraphFormat"),this.updateParagraphFormatInternal("ClearParagraphFormat",void 0,!1),this.editorHistory&&this.editorHistory.updateHistory(),this.getOffsetValue(t),this.editorHistory&&!sf.base.isNullOrUndefined(this.editorHistory.currentHistoryInfo)&&this.editorHistory.updateComplexHistory(),this.startParagraph=void 0,this.endParagraph=void 0},e.prototype.clearFormatting=function(){this.clearFormattingInternal()},e.prototype.updateProperty=function(e,t){var i=this.selection;if((!this.owner.isReadOnlyMode&&!this.restrictFormatting||this.selection.isInlineFormFillMode())&&i.owner.isDocumentLoaded){var r=i.start;i.end;i.isForward||(r=i.end,i.start);var n=0,o=r.currentWidget.getInline(r.offset,n),s=o.element;n=o.index;var a=r.paragraph;if(sf.base.isNullOrUndefined(s)||s.length!==n||this.selection.isEmpty||(s=s.nextNode),1===e){var l="None";sf.base.isNullOrUndefined(s)?sf.base.isNullOrUndefined(a)||(l=a.characterFormat.underline):l=s.characterFormat.underline,this.selection.characterFormat.underline=t===l?"None":t}else{var h="Normal";sf.base.isNullOrUndefined(s)?sf.base.isNullOrUndefined(a)||(h=a.characterFormat.baselineAlignment):h=s.characterFormat.baselineAlignment,h===t&&(t="Normal"),this.selection.characterFormat.baselineAlignment=t}}},e.prototype.getCompleteStyles=function(){for(var e='{"styles":[',t=0,i=this.documentHelper.preDefinedStyles.keys;t<i.length;t++){var r=i[t];e+=this.documentHelper.preDefinedStyles.get(r)+","}return e.slice(0,-1)+"]}"},e.prototype.intializeDefaultStyles=function(){for(var e=this.owner.getStyleNames("Paragraph"),t=0,i=["Normal","Heading 1","Heading 2","Heading 3","Heading 4","Heading 5","Heading 6"].filter((function(t){return-1===e.indexOf(t)}));t<i.length;t++){var r=i[t];this.createStyle(this.documentHelper.preDefinedStyles.get(r))}},e.prototype.createStyle=function(e){this.createStyleIn(e)},e.prototype.createStyleIn=function(e){var t=JSON.parse(e);return void 0!==this.documentHelper.styles.findByName(t.name)&&(t.name=this.getUniqueStyleName(t.name)),this.documentHelper.owner.parser.parseStyle(JSON.parse(this.getCompleteStyles()),t,this.documentHelper.styles),this.documentHelper.styles.findByName(t.name)},e.prototype.getUniqueStyleName=function(e){for(var t=this.getUniqueName(e),i=this.documentHelper.styles.findByName(t);!sf.base.isNullOrUndefined(i);)t=this.getUniqueStyleName(i.name),i=this.documentHelper.styles.findByName(t);return t},e.prototype.getUniqueName=function(e){var t=e.match(/\d+$/);return!sf.base.isNullOrUndefined(t)&&t.length>0?e.replace(t[0],(parseInt(t[0],10)+1).toString()):e+"_1"},e.prototype.updateSelectionCharacterFormatting=function(e,t,i){switch(sf.base.isNullOrUndefined(e)&&(e="CharacterFormat"),e){case"bold":this.updateCharacterFormat("bold",t);break;case"italic":this.updateCharacterFormat("italic",t);break;case"fontColor":this.updateCharacterFormat("fontColor",t);break;case"fontFamily":this.updateCharacterFormat("fontFamily",t);break;case"fontSize":this.documentHelper.layout.isBidiReLayout=!1,this.updateCharacterFormatWithUpdate(this.documentHelper.selection,"fontSize",t,i);break;case"highlightColor":this.updateCharacterFormat("highlightColor",t);break;case"baselineAlignment":this.updateCharacterFormat("baselineAlignment",t);break;case"strikethrough":this.updateCharacterFormat("strikethrough",t);break;case"underline":this.updateCharacterFormat("underline",t);break;case"styleName":this.updateCharacterFormatWithUpdate(this.documentHelper.selection,"styleName",t,!0,!0);break;case"CharacterFormat":case"ClearCharacterFormat":this.updateCharacterFormat(void 0,t);break;case"allCaps":this.updateCharacterFormat("allCaps",t)}this.reLayout(this.documentHelper.selection)},e.prototype.updateCharacterFormat=function(e,t){this.updateCharacterFormatWithUpdate(this.documentHelper.selection,e,t,!1)},e.prototype.updateCharacterFormatWithUpdate=function(e,t,i,r,n){n=!sf.base.isNullOrUndefined(n)&&n,this.documentHelper.owner.isShiftingEnabled=!0;var o=e.start,s=e.end;if(e.isEmpty||e.isForward||(o=e.end,s=e.start),e.isEmpty&&n){var a=o.offset,l=o.clone(),h=s.clone();this.selection.selectCurrentWord(),a!==this.selection.start.offset&&a!==this.selection.end.offset-1||(this.selection.start=l,this.selection.end=h)}this.applyCharFormatSelectedContent(o.paragraph,e,o,s,t,i,r)},e.prototype.applyCharFormatSelectedContent=function(e,t,i,r,n,o,s){if(!i.paragraph.isInsideTable||r.paragraph.isInsideTable&&i.paragraph.associatedCell===r.paragraph.associatedCell&&!t.isCellSelected(i.paragraph.associatedCell,i,r))this.applyCharFormat(e,t,i,r,n,o,s);else{var a;i.paragraph.associatedCell.ownerTable.combineWidget(this.owner.viewer),this.checkInsertPosition(t)&&this.updateHistoryPosition(i,!0),a=i.paragraph.associatedCell,this.applyCharFormatCell(a,t,i,r,n,o,s);var l=a.ownerTable;this.documentHelper.layout.layoutBodyWidgetCollection(l.index,l.containerWidget,l,!1)}},e.prototype.applyCharFormatForSelectedPara=function(e,t,i,r,n){for(var o=0;o<e.childWidgets.length;o++)for(var s=e.childWidgets[o],a=0;a<s.children.length;a++){var l=s.children[a];this.applyCharFormatValue(l.characterFormat,i,r,n)}this.applyCharFormatValue(e.characterFormat,i,r,n)},e.prototype.splittedLastParagraph=function(e){var t=e.getSplitWidgets();return t[t.length-1]},e.prototype.getNextParagraphForCharacterFormatting=function(e,t,i,r,n,o){var s=e.getSplitWidgets();e=s[s.length-1],e=this.documentHelper.selection.getNextRenderedBlock(e),sf.base.isNullOrUndefined(e)||(e instanceof le?this.applyCharFormat(e,this.documentHelper.selection,t,i,r,n,o):this.applyCharFormatForTable(0,e,this.documentHelper.selection,t,i,r,n,o))},e.prototype.applyCharFormat=function(e,t,i,r,n,o,s){e=e.combineWidget(this.owner.viewer);var a=0,l=t.getParagraphLength(e),h=-1!==e.childWidgets.indexOf(i.currentWidget)?e.childWidgets.indexOf(i.currentWidget):0,d=r.offset,c=-1!==e.childWidgets.indexOf(r.currentWidget)?e.childWidgets.indexOf(r.currentWidget):e.childWidgets.length-1;if(sf.base.isNullOrUndefined(t)||e===i.paragraph&&(a=i.offset),e.equals(r.paragraph)){p=e.childWidgets[e.childWidgets.length-1];t.isParagraphLastLine(p)&&r.currentWidget===p&&(d===t.getLineLength(p)+1||t.isEmpty&&t.end.isAtParagraphEnd)&&this.applyCharFormatValue(e.characterFormat,n,o,s)}else{var p=e.childWidgets[e.childWidgets.length-1];"highlightColor"===n&&t.isParagraphLastLine(p)&&i.currentWidget===p&&i.offset===t.getLineLength(p)||this.applyCharFormatValue(e.characterFormat,n,o,s),d=l}for(var u=h;u<=c;u++){var g=e.childWidgets[u];u!==h&&(a=t.getStartLineOffset(g)),d=g===r.currentWidget?r.offset:t.getLineLength(g);for(var f=0,m=void 0,y=-1,v=!0,b=0;b<g.children.length;v?b++:b--){var w=g.children[b];if(!(w instanceof je))if(m===w&&(m=void 0,b=y,y=-1,v=!0),a>=f+w.length)f+=w.length;else{var x=0;a>f&&(x=a-f);var M=d-f,N=w.length;if(M>N&&(M=N),b+=this.applyCharFormatInline(w,t,x,M,n,o,s),d<=f+N)break;f+=N}}}var I=r.paragraph;this.documentHelper.layout.reLayoutParagraph(e,h,0),e.equals(I)||this.getNextParagraphForCharacterFormatting(e,i,r,n,o,s)},e.prototype.toggleBold=function(){if(!this.owner.isReadOnlyMode&&!this.restrictFormatting||this.selection.isInlineFormFillMode()){var e=this.getCurrentSelectionValue("bold");this.selection.characterFormat.bold=e}},e.prototype.toggleItalic=function(){if(!this.owner.isReadOnlyMode&&!this.restrictFormatting||this.selection.isInlineFormFillMode()){var e=this.getCurrentSelectionValue("italic");this.selection.characterFormat.italic=e}},e.prototype.changeCase=function(e){if(!this.selection.isEmpty&&(!this.owner.isReadOnlyMode&&!this.restrictFormatting||this.selection.isInlineFormFillMode())){this.initHistory("Uppercase"),this.documentHelper.owner.isShiftingEnabled=!0;var t=this.selection,i=t.start,r=t.end;t.isForward||(i=t.end,r=t.start),this.changeSelectedTextCase(t,i,r,e),this.reLayout(t)}},e.prototype.changeSelectedTextCase=function(e,t,i,r,n){var o=this.selection.getParagraphInfo(t);e.editPosition=this.selection.getHierarchicalIndex(o.paragraph,o.offset.toString()),this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&this.checkInsertPosition(e)&&this.updateHistoryPosition(t,!0);var s=this.editorHistory.isUndoing;s&&!sf.base.isNullOrUndefined(n)&&n.length>0&&(this.removedTextNodes=n);var a=i.selection.endOffset;this.changeTextCase(t.paragraph,e,t,i,r,s),this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&(i.selection.endOffset!==a&&(i=e.getTextPosBasedOnLogicalIndex(a)),this.checkEndPosition(e)&&this.updateHistoryPosition(i,!1),e.selectPosition(t,i))},e.prototype.changeTextCase=function(e,t,i,r,n,o){if(!i.paragraph.isInsideTable||r.paragraph.isInsideTable&&i.paragraph.associatedCell===r.paragraph.associatedCell&&!t.isCellSelected(i.paragraph.associatedCell,i,r))this.changeCaseParagraph(e,t,i,r,n,o);else{var s;i.paragraph.associatedCell.ownerTable.combineWidget(this.owner.viewer),this.checkInsertPosition(t)&&this.updateHistoryPosition(i,!0),s=i.paragraph.associatedCell,this.changeCaseParaFormatInCell(s,i,r,n,o);var a=s.ownerTable;this.documentHelper.layout.layoutBodyWidgetCollection(a.index,a.containerWidget,a,!1)}},e.prototype.changeCaseParagraph=function(e,t,i,r,n,o){e=e.combineWidget(this.owner.viewer);var s=0,a=t.getParagraphLength(e),l=-1!==e.childWidgets.indexOf(i.currentWidget)?e.childWidgets.indexOf(i.currentWidget):0,h=r.offset,d=-1!==e.childWidgets.indexOf(r.currentWidget)?e.childWidgets.indexOf(r.currentWidget):e.childWidgets.length-1;sf.base.isNullOrUndefined(t)||e===i.paragraph&&(s=i.offset),e.equals(r.paragraph)||(h=a);for(var c=l;c<=d;c++){var p=e.childWidgets[c];c!==l&&(s=t.getStartLineOffset(p)),h=p===r.currentWidget?r.offset:t.getLineLength(p);for(var u=0,g=void 0,f=-1,m=!0,y=0;y<p.children.length;m?y++:y--){var v=p.children[y];if(!(v instanceof je))if(g===v&&(g=void 0,y=f,f=-1,m=!0),s>=u+v.length)u+=v.length;else{var b=0;s>u&&(b=s-u);var w=h-u,x=v.length;if(w>x&&(w=x),y+=this.changeCaseInline(v,t,b,w,n,o),h<=u+x)break;u+=x}}}var M=r.paragraph;this.documentHelper.layout.reLayoutParagraph(e,l,0),e.equals(M)||this.changeCaseNextBlock(e,i,r,n,o)},e.prototype.changeCaseInline=function(e,t,i,r,n,o){if(e instanceof we){if(0!==i||r!==e.length)return this.changeCaseInlineInternal(e,t,i,r,n,o);this.changeCaseInlineInternal(e,t,i,r,n,o)}return 0},e.prototype.addRemovedTextNodes=function(e,t){if(e instanceof we&&!sf.base.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)){var i=this.editorHistory.currentBaseHistoryInfo.removedNodes[0];sf.base.isNullOrUndefined(i)&&((i=new we).text="",this.editorHistory.currentBaseHistoryInfo.removedNodes.push(i)),i.text+=t}},e.prototype.changeCaseInlineInternal=function(e,t,i,r,n,o){var s,a=0,l=e.line.children.indexOf(e);e.paragraph.childWidgets.indexOf(e.line);if(i>0){var h=e.text.substr(i,r-i);this.addRemovedTextNodes(e,h),(s=new we).characterFormat.copyFormat(e.characterFormat),s.line=e.line,s.text=this.getChangeCaseText(h,n,o),s.isRightToLeft=e.isRightToLeft,l++,e.line.children.splice(l,0,s),a++}r<e.length&&((s=new we).characterFormat.copyFormat(e.characterFormat),s.text=e.text.substring(r),s.line=e.line,s.isRightToLeft=e.isRightToLeft,l++,e.line.children.splice(l,0,s),a++);var d=e;if(0===i){var c=d.text.substr(0,r);this.addRemovedTextNodes(e,c),d.text=this.getChangeCaseText(c,n,o)}else{var p=d.text.substr(0,i);d.text=p}return a},e.prototype.changeCaseNextBlock=function(e,t,i,r,n){e=this.getNextBlockForChangeCase(e,t,i,r,n),sf.base.isNullOrUndefined(e)||(e instanceof le?this.changeCaseParagraph(e,this.documentHelper.selection,t,i,r,n):this.changeCaseForTable(0,e,this.documentHelper.selection,t,i,r,n))},e.prototype.getNextBlockForChangeCase=function(e,t,i,r,n){var o=e.getSplitWidgets();return e=o[o.length-1],e=this.documentHelper.selection.getNextRenderedBlock(e)},e.prototype.getChangeCaseText=function(e,t,i){if(i){if(!sf.base.isNullOrUndefined(this.removedTextNodes)&&this.removedTextNodes.length>0){var r=this.removedTextNodes[0],n=r.text.substr(0,e.length);r.text=r.text.substr(n.length,r.length-n.length),e=n,""===r.text&&this.removedTextNodes.splice(0,1)}}else switch(t){case"Uppercase":e=e.toUpperCase()}return e},e.prototype.changeCaseForTable=function(e,t,i,r,n,o,s){t=t.combineWidget(this.owner.viewer);for(var a=e;a<t.childWidgets.length;a++){for(var l=t.childWidgets[a],h=0;h<l.childWidgets.length;h++)this.changeCaseForSelectedCell(l.childWidgets[h],i,o,s);if(n.paragraph.isInsideTable&&i.containsRow(l,n.paragraph.associatedCell))return void this.documentHelper.layout.layoutBodyWidgetCollection(t.index,t.containerWidget,t,!1)}this.documentHelper.layout.layoutBodyWidgetCollection(t.index,t.containerWidget,t,!1),this.changeCaseNextBlock(t,r,n,o,s)},e.prototype.changeCaseForSelectedCell=function(e,t,i,r){for(var n=0;n<e.childWidgets.length;n++){var o=e.childWidgets[n];o instanceof le?this.changeCaseForSelectedPara(o,t,i,r):this.changeCaseForSelTable(o,t,i,r)}},e.prototype.changeCaseForSelectedPara=function(e,t,i,r){for(var n=0;n<e.childWidgets.length;n++)for(var o=e.childWidgets[n],s=0;s<o.children.length;s++){var a=o.children[s];!sf.base.isNullOrUndefined(a)&&a instanceof we&&(this.addRemovedTextNodes(a,a.text),a.text=this.getChangeCaseText(a.text,i,r))}},e.prototype.changeCaseForSelTable=function(e,t,i,r){for(var n=0;n<e.childWidgets.length;n++)for(var o=e.childWidgets[n],s=0;s<o.childWidgets.length;s++)this.changeCaseForSelectedCell(o.childWidgets[s],t,i,r)},e.prototype.changeCaseParaFormatInCell=function(e,t,i,r,n){var o=this.documentHelper.selection;if(i.paragraph.isInsideTable){var s=o.getContainerCellOf(e,i.paragraph.associatedCell);if(s.ownerTable.contains(i.paragraph.associatedCell)){var a=o.getSelectedCell(e,s),l=o.getSelectedCell(i.paragraph.associatedCell,s);o.containsCell(s,i.paragraph.associatedCell)?o.isCellSelected(s,t,i)?this.changeCaseParaForCellInternal(s,o,r,n):a===s?this.changeCaseParagraph(t.paragraph,o,t,i,r,n):this.changeCaseParaForRow(a.ownerRow,o,t,i,r,n):this.changeCaseParaForTableCell(s.ownerTable,s,l,r,n)}else this.changeCaseParaForRow(s.ownerRow,o,t,i,r,n)}else{var h=o.getContainerCell(e);this.changeCaseParaForRow(h.ownerRow,o,t,i,r,n)}},e.prototype.changeCaseParaForTableCell=function(e,t,i,r,n){var o=this.documentHelper.selection,s=o.getCellLeft(t.ownerRow,t),a=s+t.cellFormat.cellWidth,l=o.getCellLeft(i.ownerRow,i),h=l+i.cellFormat.cellWidth,d=this.updateSelectedCellsInTable(s,a,l,h);s=d.start,a=d.end;for(var c=e.childWidgets.indexOf(i.ownerRow),p=e.childWidgets.indexOf(t.ownerRow);p<=c;p++)for(var u=e.childWidgets[p],g=0;g<u.childWidgets.length;g++){var f=o.getCellLeft(u,u.childWidgets[g]);Math.round(s)<=Math.round(f)&&Math.round(f)<Math.round(a)&&this.changeCaseParaForCellInternal(u.childWidgets[g],o,r,n)}},e.prototype.changeCaseParaForCellInternal=function(e,t,i,r){for(var n=0;n<e.childWidgets.length;n++){var o=e.childWidgets[n];o instanceof le?this.changeCaseForSelectedPara(o,t,i,r):this.changeCaseParaFormatTableInternal(o,t,i,r)}},e.prototype.changeCaseParaFormatTableInternal=function(e,t,i,r){for(var n=0;n<e.childWidgets.length;n++)for(var o=e.childWidgets[n],s=0;s<o.childWidgets.length;s++)this.changeCaseParaForCellInternal(o.childWidgets[s],t,i,r)},e.prototype.changeCaseParaForRow=function(e,t,i,r,n,o){for(var s=e.rowIndex;s<e.ownerTable.childWidgets.length;s++){for(var a=e.ownerTable.childWidgets[s],l=0;l<a.childWidgets.length;l++)this.changeCaseParaForCellInternal(a.childWidgets[l],t,n,o);if(r.paragraph.isInsideTable&&this.documentHelper.selection.containsRow(a,r.paragraph.associatedCell))return}this.changeCaseNextBlock(e.ownerTable,i,r,n,o)},e.prototype.toggleAllCaps=function(){if(!this.documentHelper.owner.isReadOnlyMode||this.selection.isInlineFormFillMode()){var e=this.getCurrentSelectionValue("allCaps");this.selection.characterFormat.allCaps=e}},e.prototype.getCurrentSelectionValue=function(e){var t=!1;if("bold"===e||"italic"===e){var i=this.getSelectedCharacterFormat();"bold"===e&&(t=!i.bold),"italic"===e&&(t=!i.italic)}return t},e.prototype.getSelectedCharacterFormat=function(){var e=0,t=this.selection.start;this.selection.isForward||(t=this.selection.end);var i=t.currentWidget,r=i.getInline(t.offset,e),n=r.element;e=r.index;var o=i.paragraph.characterFormat;if(!sf.base.isNullOrUndefined(n))if(this.selection.isEmpty&&"List"===this.selection.contextType){var s=this.selection.getListLevel(this.selection.start.paragraph);s.characterFormat.uniqueCharacterFormat&&(o=s.characterFormat)}else o=this.selection.isEmpty||e!==n.length?n.characterFormat:sf.base.isNullOrUndefined(n.nextNode)?i.paragraph.characterFormat:n.nextNode.characterFormat;return o},e.prototype.toggleUnderline=function(e){(!this.owner.isReadOnlyMode&&!this.restrictFormatting||this.selection.isInlineFormFillMode())&&this.updateProperty(1,e)},e.prototype.toggleStrikethrough=function(e){if(!this.owner.isReadOnlyMode||this.selection.isInlineFormFillMode()){var t=void 0;t=sf.base.isNullOrUndefined(e)?"SingleStrike"===this.selection.characterFormat.strikethrough?"None":"SingleStrike":e,this.selection.characterFormat.strikethrough=t}},e.prototype.updateFontSize=function(e,t){if("number"==typeof t&&!(t<0&&1===e.fontSize))return e.fontSize+t;var i=[8,9,10,11,12,14,16,18,20,24,26,28,36,48,72];if("string"==typeof t&&"increment"===t){if(e.fontSize<8)return e.fontSize+1;if(e.fontSize>=72&&e.fontSize<80)return 80;if(e.fontSize>=80)return e.fontSize+10;for(var r=0;r<i.length;r++)if(e.fontSize<i[r])return i[r]}else if("string"==typeof t&&"decrement"===t&&e.fontSize>1){if(e.fontSize<=8)return e.fontSize-1;if(e.fontSize>72&&e.fontSize<=80)return 72;if(e.fontSize>80)return e.fontSize-10;for(r=0;r<i.length;r++)if(e.fontSize<=i[r])return i[r-1]}return e.fontSize},e.prototype.applyCharFormatInline=function(e,t,i,r,n,o,s){return 0===i&&r===e.length?(this.applyCharFormatValue(e.characterFormat,n,o,s),0):e instanceof we?this.formatInline(e,t,i,r,n,o,s):0},e.prototype.formatInline=function(e,t,i,r,n,o,s){var a,l=0,h=e,d=e.line.children.indexOf(h),c=(e.paragraph,0);return i>0&&(c+=1,(a=new we).characterFormat.copyFormat(e.characterFormat),a.line=e.line,a.text=e.text.substr(i,r-i),a.isRightToLeft=e.isRightToLeft,this.applyCharFormatValue(a.characterFormat,n,o,s),d++,h.line.children.splice(d,0,a),l++,this.updateRevisionForFormattedContent(e,a,c)),r<h.length&&(c+=1,(a=new we).characterFormat.copyFormat(e.characterFormat),a.text=h.text.substring(r),a.line=e.line,a.isRightToLeft=e.isRightToLeft,d++,h.line.children.splice(d,0,a),l++,this.updateRevisionForFormattedContent(e,a,c)),0===i?(e.text=e.text.substr(0,r),this.applyCharFormatValue(e.characterFormat,n,o,s)):e.text=e.text.substr(0,i),l},e.prototype.updateRevisionForFormattedContent=function(e,t,i){for(var r=0;r<e.revisions.length;r++){var n=e.revisions[r],o=n.range.indexOf(e)+i;t.revisions.splice(0,0,n),n.range.splice(o,0,t)}},e.prototype.applyCharFormatCell=function(e,t,i,r,n,o,s){if(r.paragraph.isInsideTable){var a=t.getContainerCellOf(e,r.paragraph.associatedCell);if(a.ownerTable.contains(r.paragraph.associatedCell)){var l=t.getSelectedCell(e,a),h=t.getSelectedCell(r.paragraph.associatedCell,a);t.containsCell(a,r.paragraph.associatedCell)?t.isCellSelected(a,i,r)?(o=this.getCharacterFormatValueOfCell(e,t,o,n),this.applyCharFormatForSelectedCell(a,t,n,o,s)):l===a?this.applyCharFormat(i.paragraph,t,i,r,n,o,s):this.applyCharFormatRow(l.ownerRow,t,i,r,n,o,s):this.applyCharFormatForTableCell(a.ownerTable,t,a,h,n,o,s)}else this.applyCharFormatRow(a.ownerRow,t,i,r,n,o,s)}else{var d=t.getContainerCell(e);this.applyCharFormatRow(d.ownerRow,t,i,r,n,o,s)}},e.prototype.applyCharFormatForSelectedCell=function(e,t,i,r,n){for(var o=0;o<e.childWidgets.length;o++){var s=e.childWidgets[o];s instanceof le?this.applyCharFormatForSelectedPara(s,t,i,r,n):this.applyCharFormatForSelTable(s,t,i,r,n)}},e.prototype.applyCharFormatRow=function(e,t,i,r,n,o,s){o=this.getCharacterFormatValueOfCell(e.childWidgets[0],t,o,n),this.applyCharFormatForTable(e.rowIndex,e.ownerTable,t,i,r,n,o,s)},e.prototype.applyCharFormatForTable=function(e,t,i,r,n,o,s,a){t=t.combineWidget(this.owner.viewer);for(var l=e;l<t.childWidgets.length;l++){for(var h=t.childWidgets[l],d=0;d<h.childWidgets.length;d++)this.applyCharFormatForSelectedCell(h.childWidgets[d],i,o,s,a);if(n.paragraph.isInsideTable&&i.containsRow(h,n.paragraph.associatedCell))return void this.documentHelper.layout.layoutBodyWidgetCollection(t.index,t.containerWidget,t,!1)}this.documentHelper.layout.layoutBodyWidgetCollection(t.index,t.containerWidget,t,!1),this.getNextParagraphForCharacterFormatting(t,r,n,o,s,a)},e.prototype.applyCharFormatForSelTable=function(e,t,i,r,n){for(var o=0;o<e.childWidgets.length;o++)for(var s=e.childWidgets[o],a=0;a<s.childWidgets.length;a++)this.applyCharFormatForSelectedCell(s.childWidgets[a],t,i,r,n)},e.prototype.applyCharFormatForTableCell=function(e,t,i,r,n,o,s){var a=t.getCellLeft(i.ownerRow,i),l=a+i.cellFormat.cellWidth,h=t.getCellLeft(r.ownerRow,r),d=h+r.cellFormat.cellWidth,c=this.updateSelectedCellsInTable(a,l,h,d);a=c.start,l=c.end;for(var p=e.childWidgets.indexOf(r.ownerRow),u=!1,g=e.childWidgets.indexOf(i.ownerRow);g<=p;g++)for(var f=e.childWidgets[g],m=0;m<f.childWidgets.length;m++){var y=t.getCellLeft(f,f.childWidgets[m]);x.round(a,2)<=x.round(y,2)&&x.round(y,2)<x.round(l,2)&&(u||(o=this.getCharacterFormatValueOfCell(f.childWidgets[m],t,o,n),u=!0),this.applyCharFormatForSelectedCell(f.childWidgets[m],t,n,o,s))}},e.prototype.updateSelectedCellsInTable=function(e,t,i,r){var n=this.documentHelper.selection;return e>i&&(e=i),t<r&&(t=r),e>n.upDownSelectionLength&&(e=n.upDownSelectionLength),t<n.upDownSelectionLength&&(t=n.upDownSelectionLength),{start:e,end:t}},e.prototype.getCharacterFormatValueOfCell=function(e,t,i,r){if("boolean"==typeof i||void 0===i&&("bold"===r||"italic"===r)){var n=t.getFirstParagraph(e),o=n.characterFormat;n.childWidgets.length>0&&n.childWidgets[0].children.length>0&&(o=n.childWidgets[0].children[0].characterFormat),i=!o.getPropertyValue(r)}return i},e.prototype.applyCharFormatValueInternal=function(e,t,i,r){this.applyCharFormatValue(t,i,r,!1)},e.prototype.copyInlineCharacterFormat=function(e,t){t.uniqueCharacterFormat=e.uniqueCharacterFormat,t.baseCharStyle=e.baseCharStyle},e.prototype.applyCharFormatValue=function(e,t,i,r){if(r&&"fontSize"===t&&(i=this.updateFontSize(e,i)),this.editorHistory&&!sf.base.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)&&(i=this.editorHistory.currentBaseHistoryInfo.addModifiedProperties(e,t,i)),i instanceof P)this.editorHistory&&(this.editorHistory.isUndoing||this.editorHistory.isRedoing)?this.copyInlineCharacterFormat(i,e):e.copyFormat(i);else{if(this.isForHyperlinkFormat&&this.owner.enableTrackChanges&&e.ownerBase instanceof ge){var n=e.ownerBase,o=n.previousNode;if(sf.base.isNullOrUndefined(o)){var s=n.paragraph.previousWidget;if(!sf.base.isNullOrUndefined(s)&&!s.isEmpty()){var a=s.lastChild;o=a.children[a.children.length-1]}}for(;!(sf.base.isNullOrUndefined(o)||o instanceof we);)o=o.previousNode;if(!sf.base.isNullOrUndefined(o)&&o.revisions.length>0){var l=o.revisions[o.revisions.length-1];this.isRevisionAlreadyIn(n,l)||(n.revisions.push(l),l.range.push(n))}else this.insertRevision(n,"Insertion")}sf.base.isNullOrUndefined(i)?e.clearFormat():"bold"===t?e.bold=i:"italic"===t?e.italic=i:"fontColor"===t?e.fontColor=i:"fontFamily"===t?e.fontFamily=i:"fontSize"===t?e.fontSize=i:"highlightColor"===t?e.highlightColor=i:"baselineAlignment"===t?e.baselineAlignment=i:"strikethrough"===t?e.strikethrough=i:"underline"===t?e.underline=i:"styleName"===t?e.baseCharStyle=i:"allCaps"===t&&(e.allCaps=i)}},e.prototype.onImageFormat=function(e,t,i){var r=new zt(e);this.editorHistory&&(this.editorHistory.initializeHistory("ImageResizing"),this.editorHistory.currentBaseHistoryInfo.modifiedProperties.push(r)),this.setOffsetValue(this.selection),e.width=t,e.height=i,this.documentHelper.layout.reLayoutParagraph(e.line.paragraph,e.line.indexInOwner,0),this.reLayout(this.selection,!1),this.documentHelper.owner.imageResizerModule&&this.documentHelper.owner.imageResizerModule.positionImageResizer(e)},e.prototype.toggleTextAlignment=function(e){this.documentHelper.owner.isReadOnlyMode&&!this.selection.isInlineFormFillMode()||!this.documentHelper.owner.isDocumentLoaded||(sf.base.isNullOrUndefined(this.documentHelper.selection.paragraphFormat.textAlignment)||this.documentHelper.selection.paragraphFormat.textAlignment!==e?this.onApplyParagraphFormat("textAlignment",e,!1,!0):"Left"===e?this.onApplyParagraphFormat("textAlignment","Justify",!1,!0):this.onApplyParagraphFormat("textAlignment","Left",!1,!0))},e.prototype.setPreviousBlockToLayout=function(){var e=this.documentHelper.selection.start;this.documentHelper.selection.isForward||(e=this.documentHelper.selection.end);var t=e.paragraph;if(t.paragraphFormat.keepWithNext){var i=t.bodyWidget;if(!sf.base.isNullOrUndefined(i)&&i instanceof ne&&i.page){var r=i.page.previousPage;r&&(this.previousBlockToLayout=r.bodyWidgets[0].lastChild)}}},e.prototype.applyParagraphBorders=function(e,t,i){var r=new p;switch(e){case"color":r.color=i;break;case"lineWidth":r.lineWidth=i;break;case"lineStyle":r.lineStyle=i;break;case"shadow":r.shadow=i;break;case"space":r.space=i}this.onApplyParagraphFormat(t,r,!1,!1)},e.prototype.onApplyParagraphFormat=function(e,t,i,r){var n=this.documentHelper.isFormFillProtectedMode&&this.documentHelper.selection.isInlineFormFillMode()&&this.allowFormattingInFormFields(e);if(!this.restrictFormatting||n){this.setPreviousBlockToLayout();var o="bidi"===e?"ParagraphBidi":e[0].toUpperCase()+e.slice(1);this.documentHelper.owner.isShiftingEnabled=!0;var s=this.documentHelper.selection,a=s.start.paragraph,l=!1;if(s.isForward||(a=s.end.paragraph),"leftIndent"==e&&(l=this.isFirstParaForList(s,a)),t<=0&&"leftIndent"==e){var h=x.convertPointToPixel(t);if(a.x+h<this.viewer.clientArea.x)return}if(this.initHistory(o),(!this.owner.isReadOnlyMode||n)&&this.owner.isDocumentLoaded)if("leftIndent"!==e||sf.base.isNullOrUndefined(s.paragraphFormat.listId)||-1===s.paragraphFormat.listId||!i){if(!(t instanceof ft&&"styleName"==e&&s.isEmpty)&&s.isEmpty){this.setOffsetValue(s),i&&"leftIndent"===e&&(t=this.getIndentIncrementValue(s.start.paragraph,t));var d=s.start.paragraph;this.documentHelper.layout;d=d.combineWidget(this.owner.viewer),this.applyParaFormatProperty(d,e,t,i),this.layoutItemBlock(d,!1)}else"ParagraphBidi"!==o&&this.setOffsetValue(s),this.updateSelectionParagraphFormatting(e,t,i);this.reLayout(s)}else l?this.updateListLevelIndent(t,a):this.updateListLevel(t>0)}},e.prototype.updateListLevelIndent=function(e,t){var i=this.documentHelper.getListById(t.paragraphFormat.listFormat.listId),r=this.documentHelper.getAbstractListById(i.abstractListId);if(this.initHistory("List"),e<0&&r.levels[0].paragraphFormat.leftIndent+e<=0&&(e=18-r.levels[0].paragraphFormat.leftIndent),0!=e){for(var n=0;n<r.levels.length;n++)this.editorHistory&&!sf.base.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)&&this.editorHistory.currentBaseHistoryInfo.addModifiedPropertiesForList(r.levels[n]),r.levels[n].paragraphFormat.leftIndent+=e;this.documentHelper.owner.isShiftingEnabled=!0,this.layoutWholeDocument(),this.documentHelper.owner.isShiftingEnabled=!1}},e.prototype.isFirstParaForList=function(e,t){var i=!1;if(!sf.base.isNullOrUndefined(e.paragraphFormat.listId)&&-1!==e.paragraphFormat.listId&&0===t.paragraphFormat.listFormat.listLevelNumber){var r=this.updateWholeListItems(t,!0,e.paragraphFormat.listId);sf.base.isNullOrUndefined(r)&&(i=!0)}return i},e.prototype.updateListLevel=function(e){var t,i=this.documentHelper,r=(this.documentHelper.selection.start.paragraph.paragraphFormat.listFormat,this.documentHelper.selection.start.paragraph.paragraphFormat),n=i.getListById(r.listFormat.listId);i.layout.getListLevel(n,r.listFormat.listLevelNumber);t=e?r.listFormat.listLevelNumber+1:r.listFormat.listLevelNumber-1;var o=i.layout.getListLevel(n,t);sf.base.isNullOrUndefined(o)||(this.onApplyListInternal(n,t),i.selection.start.updatePhysicalPosition(!0),i.selection.end.updatePhysicalPosition(!0),i.selection.updateCaretPosition())},e.prototype.onApplyListInternal=function(e,t){var i=new m;!sf.base.isNullOrUndefined(e)&&t>=0&&t<9&&(i.listId=e.listId,i.listLevelNumber=t),this.onApplyParagraphFormat("listFormat",i,!1,!1)},e.prototype.updateSelectionParagraphFormatting=function(e,t,i){var r=this.documentHelper.selection;"leftIndent"===e&&i&&(t=!sf.base.isNullOrUndefined(r.start)&&r.start.isExistBefore(r.end)?this.getIndentIncrementValue(r.start.paragraph,t):this.getIndentIncrementValue(r.end.paragraph,t)),this.updateParagraphFormatInternal(e,t,i)},e.prototype.getIndentIncrementValue=function(e,t){var i=e.paragraphFormat.leftIndent;if(i<0){if(t<0||i+t>=0)return-i;var r=-this.getIndentIncrementValueInternal(-i,-t);return r%t==0?r:r+t}return this.getIndentIncrementValueInternal(i,t)},e.prototype.getIndentIncrementValueInternal=function(e,t){var i=Math.abs(t);if(0===e||0===i)return t>0?i:0;var r=100*Math.round(e)%(100*Math.round(i))/100,n=(Math.round(e)-r)/Math.round(i)*i;return t>0&&(n+=i),n-e==0?t:n-e},e.prototype.updateParagraphFormatInternal=function(e,t,i){switch(sf.base.isNullOrUndefined(e)&&(e="ParagraphFormat"),e){case"afterSpacing":this.updateParagraphFormat("afterSpacing",t,!1);break;case"beforeSpacing":this.updateParagraphFormat("beforeSpacing",t,!1);break;case"spaceAfterAuto":this.updateParagraphFormat("spaceAfterAuto",t,!1);break;case"spaceBeforeAuto":this.updateParagraphFormat("spaceBeforeAuto",t,!1);break;case"rightIndent":this.updateParagraphFormat("rightIndent",t,!1);break;case"leftIndent":this.updateParagraphFormat("leftIndent",t,i);break;case"firstLineIndent":this.updateParagraphFormat("firstLineIndent",t,!1);break;case"lineSpacing":this.updateParagraphFormat("lineSpacing",t,!1);break;case"lineSpacingType":this.updateParagraphFormat("lineSpacingType",t,!1);break;case"textAlignment":this.updateParagraphFormat("textAlignment",t,!1);break;case"borders":case"topBorder":case"bottomBorder":case"leftBorder":case"rightBorder":case"horizontalBorder":case"verticalBorder":this.updateParagraphFormat(e,t,!1);break;case"listFormat":this.updateParagraphFormat("listFormat",t,!1);break;case"ParagraphFormat":this.updateParagraphFormat(void 0,t,!1);break;case"styleName":this.updateParagraphFormat("styleName",t,!1);break;case"ClearParagraphFormat":this.updateParagraphFormat(void 0,t,!1);break;case"bidi":var r=-1!==this.selection.paragraphFormat.listId;r||(this.documentHelper.layout.isBidiReLayout=!0),this.updateParagraphFormat("bidi",t,!1),r||(this.documentHelper.layout.isBidiReLayout=!1);break;case"contextualSpacing":this.updateParagraphFormat("contextualSpacing",t,!1)}},e.prototype.updateParagraphFormat=function(e,t,i){var r=this.documentHelper.selection,n=r.start,o=r.end;r.isForward||(n=r.end,o=r.start),this.applyParaFormatSelectedContent(n,o,e,t,i)},e.prototype.applyParaFormatSelectedContent=function(e,t,i,r,n){var o=this.documentHelper.selection;if(!e.paragraph.isInsideTable||t.paragraph.isInsideTable&&e.paragraph.associatedCell===t.paragraph.associatedCell&&!o.isCellSelected(e.paragraph.associatedCell,e,t)){if(!sf.base.isNullOrUndefined(r)&&!this.selection.isEmpty&&"styleName"===i&&this.applyCharacterStyle(e.paragraph,e,t,i,r,n))return;this.applyParaFormat(e.paragraph,e,t,i,r,n)}else{var s;e.paragraph.associatedCell.ownerTable.combineWidget(this.owner.viewer),this.checkInsertPosition(o)&&this.updateHistoryPosition(e,!0),s=e.paragraph.associatedCell,this.applyParaFormatInCell(s,e,t,i,r,n);var a=s.ownerTable;this.documentHelper.layout.layoutBodyWidgetCollection(a.index,a.containerWidget,a,!1)}},e.prototype.applyParaFormatProperty=function(e,t,i,r){var n=e.paragraphFormat;if(r&&"leftIndent"===t&&(i=n.leftIndent+i),"listFormat"===t&&i instanceof m){var o=i;o.hasValue("listLevelNumber")||(o.listLevelNumber=n.listFormat.listLevelNumber)}if(this.editorHistory&&!sf.base.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)&&(i=this.editorHistory.currentBaseHistoryInfo.addModifiedPropertiesForParagraphFormat(n,t,i)),i instanceof ct&&(sf.base.isNullOrUndefined(t)?this.editorHistory&&(this.editorHistory.isUndoing||this.editorHistory.isRedoing)?this.copyParagraphFormat(i,n):n.copyFormat(i):"listFormat"===t&&(n.listFormat=i.listFormat,n.listFormat.ownerBase=n)),sf.base.isNullOrUndefined(i))return n.clearFormat(),void this.documentHelper.layout.reLayoutParagraph(n.ownerBase,0,0);if("afterSpacing"===t)n.afterSpacing=i;else if("beforeSpacing"===t)n.beforeSpacing=i;else if("leftIndent"===t)n.leftIndent=i;else if("lineSpacingType"===t)n.lineSpacingType=i;else if("lineSpacing"===t)n.lineSpacing=i;else if("rightIndent"===t)n.rightIndent=i;else if("firstLineIndent"===t)n.firstLineIndent=i;else if("textAlignment"===t){var s=i;!n.bidi||this.editorHistory.isUndoing||this.editorHistory.isRedoing||("Left"===s?s="Right":"Right"===s&&(s="Left")),n.textAlignment=s}else if("topBorder"===t)this.applyBorder(n.borders.top,i);else if("bottomBorder"===t)this.applyBorder(n.borders.bottom,i);else if("leftBorder"===t)this.applyBorder(n.borders.left,i);else if("rightBorder"===t)this.applyBorder(n.borders.right,i);else if("horizontalBorder"===t)this.applyBorder(n.borders.horizontal,i);else if("verticalBorder"===t)this.applyBorder(n.borders.vertical,i);else if("borders"===t)n.borders.copyFormat(i);else if("styleName"===t)"string"==typeof i&&(i=this.documentHelper.styles.findByName(i)),n.applyStyle(i);else{if("listFormat"===t)return i instanceof ct&&(i=i.listFormat),n.listFormat.copyFormat(i),this.documentHelper.layout.clearListElementBox(n.ownerBase),n.listFormat.listId>=0&&n.clearIndent(),void this.layoutItemBlock(n.ownerBase,!1);"bidi"===t?n.bidi=i:"keepWithNext"===t?n.keepWithNext=i:"keepLinesTogether"===t?n.keepLinesTogether=i:"widowControl"===t?n.widowControl=i:"contextualSpacing"===t?n.contextualSpacing=i:"spaceAfterAuto"===t?n.spaceAfterAuto=i:"spaceBeforeAuto"===t&&(n.spaceBeforeAuto=i)}},e.prototype.copyParagraphFormat=function(e,t){t.uniqueParagraphFormat=e.uniqueParagraphFormat,t.listFormat=e.listFormat,t.listFormat.ownerBase=t,t.baseStyle=e.baseStyle},e.prototype.copyFromListLevelParagraphFormat=function(e,t){sf.base.isNullOrUndefined(t.leftIndent)||(e.leftIndent=t.leftIndent),sf.base.isNullOrUndefined(t.firstLineIndent)||(e.firstLineIndent=t.firstLineIndent)},e.prototype.applyContinueNumbering=function(){var e=this.selection;this.editorHistory&&this.editorHistory.initializeHistory("ContinueNumbering"),this.applyContinueNumberingInternal(e)},e.prototype.applyContinueNumberingInternal=function(e){var t=e.start.paragraph,i=this.getContinueNumberingInfo(t),r=this.getParagraphFormat(t,i.listLevelNumber,i.listPattern);this.changeListId(i.currentList,t,r,i.listLevelNumber,i.listPattern),this.reLayout(e,!1),this.documentHelper.updateFocus()},e.prototype.getContinueNumberingInfo=function(e){var t=void 0,i=0,r="None";sf.base.isNullOrUndefined(e.paragraphFormat)||sf.base.isNullOrUndefined(e.paragraphFormat.listFormat)||(t=this.documentHelper.getListById(e.paragraphFormat.listFormat.listId),i=e.paragraphFormat.listFormat.listLevelNumber);var n=this.documentHelper;if(0!==i&&!sf.base.isNullOrUndefined(t)&&!sf.base.isNullOrUndefined(n.getAbstractListById(t.abstractListId))&&!sf.base.isNullOrUndefined(n.getAbstractListById(t.abstractListId).levels[i])){var o=this.documentHelper.layout.getListLevel(t,i);sf.base.isNullOrUndefined(o)||(r=o.listLevelPattern)}return{currentList:t,listLevelNumber:i,listPattern:r}},e.prototype.revertContinueNumbering=function(e,t){var i=e.start.paragraph,r=this.getContinueNumberingInfo(i);this.changeListId(r.currentList,i,t,r.listLevelNumber,r.listPattern),this.reLayout(e,!1),this.editorHistory&&!sf.base.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)&&this.editorHistory.updateHistory()},e.prototype.changeListId=function(e,t,i,r,n){if(!sf.base.isNullOrUndefined(t)){if(t instanceof le&&e.listId===t.paragraphFormat.listFormat.listId&&r===t.paragraphFormat.listFormat.listLevelNumber){if(this.editorHistory){var o=this.editorHistory.currentBaseHistoryInfo;sf.base.isNullOrUndefined(o)||(i=o.addModifiedPropertiesForContinueNumbering(t.paragraphFormat,i))}t.paragraphFormat.copyFormat(i),this.documentHelper.layout.reLayoutParagraph(t,0,0)}return this.changeListId(e,t.nextRenderedWidget,i,r,n)}},e.prototype.getParagraphFormat=function(e,t,i){if(!sf.base.isNullOrUndefined(e.previousRenderedWidget)&&e.previousRenderedWidget instanceof le){if(sf.base.isNullOrUndefined(e.previousRenderedWidget.paragraphFormat.listFormat)||-1===e.previousRenderedWidget.paragraphFormat.listFormat.listId)return this.getParagraphFormat(e.previousRenderedWidget,t,i);var r=this.selection.getListLevel(e.previousRenderedWidget);return 0===t||i===r.listLevelPattern||this.checkNumberArabic(i,r.listLevelPattern)?e.previousRenderedWidget.paragraphFormat:this.getParagraphFormat(e.previousRenderedWidget,t,i)}},e.prototype.checkNumberArabic=function(e,t){return"Number"===e&&"Arabic"===t||"Number"===t&&"Arabic"===e},e.prototype.applyRestartNumbering=function(e){this.editorHistory&&this.editorHistory.initializeHistory("RestartNumbering"),this.restartListAt(e)},e.prototype.restartListAt=function(e){var t=e.paragraphFormat.getList(),i=t.clone();i.listId=this.documentHelper.lists[this.documentHelper.lists.length-1].listId+1,this.documentHelper.lists.push(i);var r=t.abstractList.clone();r.abstractListId=this.documentHelper.abstractLists[this.documentHelper.abstractLists.length-1].abstractListId+1,i.abstractListId=r.abstractListId,i.abstractList=r,this.documentHelper.abstractLists.push(r),this.restartListAtInternal(e,i.listId)},e.prototype.restartListAtInternal=function(e,t){var i=this.getContinueNumberingInfo(e.start.paragraph);this.changeRestartNumbering(i.currentList,e.start.paragraph,t),this.reLayout(e,!1),this.documentHelper.updateFocus()},e.prototype.changeRestartNumbering=function(e,t,i){if(!sf.base.isNullOrUndefined(t)){if(t instanceof le&&e.listId===t.paragraphFormat.listFormat.listId){if(this.editorHistory){var r=this.editorHistory.currentBaseHistoryInfo;sf.base.isNullOrUndefined(r)||(i=r.addModifiedPropertiesForRestartNumbering(t.paragraphFormat.listFormat,i))}t.paragraphFormat.listFormat.listId=i,this.documentHelper.layout.reLayoutParagraph(t,0,0)}return this.changeRestartNumbering(e,t.nextRenderedWidget,i)}},e.prototype.applyParaFormat=function(e,t,i,r,n,o){this.setOffsetValue(this.selection),e=e.combineWidget(this.owner.viewer),this.applyParaFormatProperty(e,r,n,o),this.layoutItemBlock(e,!1),this.getOffsetValue(this.selection),e.equals(i.paragraph)||this.getNextParagraphForFormatting(e,t,i,r,n,o)},e.prototype.applyCharacterStyle=function(e,t,i,r,n,o){var s=e.getSplitWidgets(),a=i.owner.selection,l=i.currentWidget;if(!(0===t.offset&&(a.isParagraphLastLine(l)&&i.currentWidget===l&&i.offset===a.getLineLength(l)+1||i.isAtParagraphEnd))&&(i.paragraph===e||-1!==s.indexOf(i.paragraph))&&("Paragraph"===n.type&&n.link instanceof ft||"Character"===n.type)){var h="Character"===n.type?n:n.link;return this.updateSelectionCharacterFormatting(r,h,o),!0}return!1},e.prototype.applyParaFormatInCell=function(e,t,i,r,n,o){var s=this.documentHelper.selection;if(i.paragraph.isInsideTable){var a=s.getContainerCellOf(e,i.paragraph.associatedCell);if(a.ownerTable.contains(i.paragraph.associatedCell)){var l=s.getSelectedCell(e,a),h=s.getSelectedCell(i.paragraph.associatedCell,a);s.containsCell(a,i.paragraph.associatedCell)?s.isCellSelected(a,t,i)?(n=this.getParaFormatValueInCell(a,r,n),this.applyParaFormatCellInternal(a,r,n,o)):l===a?this.applyParaFormat(t.paragraph,t,i,r,n,o):this.applyParagraphFormatRow(l.ownerRow,t,i,r,n,o):this.applyParaFormatTableCell(a.ownerTable,a,h,r,n,o)}else this.applyParagraphFormatRow(a.ownerRow,t,i,r,n,o)}else{var d=s.getContainerCell(e);this.applyParagraphFormatRow(d.ownerRow,t,i,r,n,o)}},e.prototype.applyParaFormatCellInternal=function(e,t,i,r){for(var n=0;n<e.childWidgets.length;n++){var o=e.childWidgets[n];o instanceof le?this.applyParaFormatProperty(o,t,i,r):this.applyParagraphFormatTableInternal(o,t,i,r)}},e.prototype.getParaFormatValueInCell=function(e,t,i){"boolean"==typeof i&&(i=!this.documentHelper.selection.getFirstParagraph(e).paragraphFormat.getPropertyValue(t));return i},e.prototype.applyParagraphFormatRow=function(e,t,i,r,n,o){n=this.getParaFormatValueInCell(e.childWidgets[0],r,n);for(var s=e.rowIndex;s<e.ownerTable.childWidgets.length;s++){for(var a=e.ownerTable.childWidgets[s],l=0;l<a.childWidgets.length;l++)this.applyParaFormatCellInternal(a.childWidgets[l],r,n,o);if(i.paragraph.isInsideTable&&this.documentHelper.selection.containsRow(a,i.paragraph.associatedCell))return}this.getNextParagraphForFormatting(e.ownerTable,t,i,r,n,o)},e.prototype.applyParaFormatTableCell=function(e,t,i,r,n,o){var s=this.documentHelper.selection,a=s.getCellLeft(t.ownerRow,t),l=a+t.cellFormat.cellWidth,h=s.getCellLeft(i.ownerRow,i),d=h+i.cellFormat.cellWidth,c=this.updateSelectedCellsInTable(a,l,h,d);a=c.start,l=c.end;for(var p=e.childWidgets.indexOf(i.ownerRow),u=!1,g=e.childWidgets.indexOf(t.ownerRow);g<=p;g++)for(var f=e.childWidgets[g],m=0;m<f.childWidgets.length;m++){var y=s.getCellLeft(f,f.childWidgets[m]);Math.round(a)<=Math.round(y)&&Math.round(y)<Math.round(l)&&(u||(n=this.getParaFormatValueInCell(f.childWidgets[m],r,n),u=!0),this.applyParaFormatCellInternal(f.childWidgets[m],r,n,o))}},e.prototype.applyParaFormatTable=function(e,t,i,r,n,o){e=e.combineWidget(this.owner.viewer);for(var s=this.documentHelper.selection,a=0;a<e.childWidgets.length;a++){for(var l=e.childWidgets[a],h=0;h<l.childWidgets.length;h++)this.applyParaFormatCellInternal(l.childWidgets[h],r,n,o);if(i.paragraph.isInsideTable&&s.containsRow(l,i.paragraph.associatedCell))return void this.documentHelper.layout.layoutBodyWidgetCollection(e.index,e.containerWidget,e,!1)}this.documentHelper.layout.layoutBodyWidgetCollection(e.index,e.containerWidget,e,!1),this.getNextParagraphForFormatting(e,t,i,r,n,o)},e.prototype.getNextParagraphForFormatting=function(e,t,i,r,n,o){var s=e.getSplitWidgets();e=s[s.length-1],e=this.documentHelper.selection.getNextRenderedBlock(e),sf.base.isNullOrUndefined(e)||(e instanceof le?this.applyParaFormat(e,t,i,r,n,o):this.applyParaFormatTable(e,t,i,r,n,o))},e.prototype.applyParagraphFormatTableInternal=function(e,t,i,r){for(var n=0;n<e.childWidgets.length;n++)for(var o=e.childWidgets[n],s=0;s<o.childWidgets.length;s++)this.applyParaFormatCellInternal(o.childWidgets[s],t,i,r)},e.prototype.onApplyColumnFormat=function(e,t){if(!this.restrictFormatting){this.initHistory("SectionFormat");var i=this.documentHelper.selection;i.owner.isShiftingEnabled=!0;var r,n,o=i.start,s=i.end;i.isForward||(o=i.end,s=i.start),this.documentHelper.clearContent();for(var a=o.paragraph.bodyWidget.sectionIndex,l=s.paragraph.bodyWidget.sectionIndex,h=!1,d=0;d<this.documentHelper.pages.length;d++)this.documentHelper.pages[d].bodyWidgets[0].index===a?r=d:h=!0;for(d=r;d<this.documentHelper.pages.length;d++){var c=this.documentHelper.pages[d].bodyWidgets[0];if(n=d,c.index!==a&&!(c.index>=a&&c.index<=l)){n=d-1;break}}h&&"differentOddAndEvenPages"==e&&o.paragraph.isInHeaderFooter&&(r=0,n=this.documentHelper.pages.length-1);var p=!0,u=0;for(d=r;d<=n;d++)u===this.documentHelper.pages[d].bodyWidgets[0].index||p||(p=!0),this.applyPropertyValueForSection(this.documentHelper.pages[d].bodyWidgets[0].sectionFormat,e,t,p),u=this.documentHelper.pages[d].bodyWidgets[0].index,p=!1;this.layoutWholeDocument(),this.fireContentChange()}},e.prototype.onApplySectionFormat=function(e,t){if(!this.restrictFormatting){if(sf.base.isNullOrUndefined(e))this.initHistory("SectionFormat");else{var i=e[0].toUpperCase()+e.slice(1);this.initHistory(i)}this.updateSectionFormat(e,t)}},e.prototype.updateSectionFormat=function(e,t){var i=this.documentHelper.selection;i.owner.isShiftingEnabled=!0;var r,n,o=i.start,s=i.end;i.isForward||(o=i.end,s=i.start),this.documentHelper.clearContent();for(var a=o.paragraph.bodyWidget.sectionIndex,l=s.paragraph.bodyWidget.sectionIndex,h=!1,d=0;d<this.documentHelper.pages.length;d++)this.documentHelper.pages[d].bodyWidgets[0].index===a?r=d:h=!0;for(d=r;d<this.documentHelper.pages.length;d++){var c=this.documentHelper.pages[d].bodyWidgets[0];if(n=d,c.index!==a&&!(c.index>=a&&c.index<=l)){n=d-1;break}}h&&"differentOddAndEvenPages"==e&&o.paragraph.isInHeaderFooter&&(r=0,n=this.documentHelper.pages.length-1);var p=!0,u=0;for(d=r;d<=n;d++)u===this.documentHelper.pages[d].bodyWidgets[0].index||p||(p=!0),this.applyPropertyValueForSection(this.documentHelper.pages[d].bodyWidgets[0].sectionFormat,e,t,p),u=this.documentHelper.pages[d].bodyWidgets[0].index,p=!1;this.layoutWholeDocument(),this.fireContentChange()},e.prototype.onApplyTableFormat=function(e,t){if(!this.restrictFormatting){var i=this.getTableFormatAction(e);this.viewer.owner.isShiftingEnabled=!0;var r=this.documentHelper.selection,n=r.start.paragraph.associatedCell.ownerTable;n=n.combineWidget(this.owner.viewer),r.isEmpty?(this.initHistory(i),this.applyTablePropertyValue(r,e,t,n)):this.updateSelectionTableFormat(this.selection,i,t),n.calculateGrid(),this.selection.owner.isLayoutEnabled=!0,this.documentHelper.layout.reLayoutTable(n),this.reLayout(r,!1)}},e.prototype.getTableFormatAction=function(e){switch(e){case"tableAlignment":return"TableAlignment";case"leftIndent":return"TableLeftIndent";case"leftMargin":return"DefaultCellLeftMargin";case"rightMargin":return"DefaultCellRightMargin";case"bottomMargin":return"DefaultCellBottomMargin";case"topMargin":return"DefaultCellTopMargin";case"preferredWidth":return"TablePreferredWidth";case"preferredWidthType":return"TablePreferredWidthType";case"shading":return"Shading";case"bidi":return"TableBidi";default:return"DefaultCellSpacing"}},e.prototype.onApplyTableRowFormat=function(e,t){if(!this.restrictFormatting){var i=this.getRowAction(e);this.documentHelper.owner.isShiftingEnabled=!0;var r=this.documentHelper.selection;if(r.isEmpty){this.initHistory(i);r.start.paragraph.associatedCell.ownerRow.ownerTable;this.applyRowPropertyValue(r,e,t,r.start.paragraph.associatedCell.ownerRow)}else this.updateSelectionTableFormat(this.selection,i,t);this.reLayout(r,!1)}},e.prototype.getRowAction=function(e){switch(e){case"height":return"RowHeight";case"heightType":return"RowHeightType";case"isHeader":return"RowHeader";default:return"AllowBreakAcrossPages"}},e.prototype.onApplyTableCellFormat=function(e,t){if(!this.restrictFormatting){var i=this.getTableCellAction(e);this.documentHelper.owner.isShiftingEnabled=!0;var r=this.documentHelper.selection,n=r.start.paragraph.associatedCell.ownerTable;n=n.combineWidget(this.owner.viewer),r.isEmpty?(this.initHistory(i),this.applyCellPropertyValue(r,e,t,r.start.paragraph.associatedCell.cellFormat),n.calculateGrid(),this.selection.owner.isLayoutEnabled=!0,this.documentHelper.layout.reLayoutTable(n)):this.updateSelectionTableFormat(this.selection,i,t),this.reLayout(r,!1)}},e.prototype.getTableCellAction=function(e){switch(e){case"verticalAlignment":return"CellContentVerticalAlignment";case"leftMargin":return"CellLeftMargin";case"rightMargin":return"CellRightMargin";case"bottomMargin":return"CellBottomMargin";case"topMargin":return"CellTopMargin";case"preferredWidth":return"CellPreferredWidth";case"shading":return"Shading";default:return"CellPreferredWidthType"}},e.prototype.applyPropertyValueForSection=function(e,t,i,r){r&&this.editorHistory&&!sf.base.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)&&("columns"===t&&(e.numberOfColumns=i.length),i=this.editorHistory.currentBaseHistoryInfo.addModifiedPropertiesForSection(e,t,i)),sf.base.isNullOrUndefined(i)||(i instanceof d?sf.base.isNullOrUndefined(t)&&e.copyFormat(i,this.editorHistory):"pageHeight"===t?e.pageHeight=i:"pageWidth"===t?e.pageWidth=i:"leftMargin"===t?e.leftMargin=i:"rightMargin"===t?e.rightMargin=i:"topMargin"===t?e.topMargin=i:"bottomMargin"===t?e.bottomMargin=i:"differentFirstPage"===t?e.differentFirstPage=i:"differentOddAndEvenPages"===t?e.differentOddAndEvenPages=i:"headerDistance"===t?e.headerDistance=i:"footerDistance"===t?e.footerDistance=i:"pageStartingNumber"===t?e.pageStartingNumber=i:"restartPageNumbering"===t?e.restartPageNumbering=i:"endnoteNumberFormat"===t?e.endnoteNumberFormat=i:"footNoteNumberFormat"===t?e.footNoteNumberFormat=i:"restartIndexForEndnotes"===t?e.restartIndexForEndnotes=i:"restartIndexForFootnotes"===t?e.restartIndexForFootnotes=i:"initialFootNoteNumber"===t?e.initialFootNoteNumber=i:"initialEndNoteNumber"===t?e.initialEndNoteNumber=i:"numberOfColumns"==t?e.numberOfColumns=i:"equalWidth"==t?e.equalWidth=i:"lineBetweenColumns"==t?e.lineBetweenColumns=i:"columns"==t&&(e.columns=i))},e.prototype.layoutWholeDocument=function(e){this.documentHelper.layout.isLayoutWhole=!0;var t=this.documentHelper.selection.start,i=this.documentHelper.selection.end;t.isExistAfter(i)&&(t=this.documentHelper.selection.end,i=this.documentHelper.selection.start),(this.documentHelper.selection.isinEndnote||this.documentHelper.selection.isinFootnote)&&(this.documentHelper.selection.footnoteReferenceElement(t,i),t=i);var r=this.selection.getParagraphInfo(t),n=this.selection.getParagraphInfo(i),o=this.selection.getHierarchicalIndex(r.paragraph,r.offset.toString()),s=this.selection.getHierarchicalIndex(n.paragraph,n.offset.toString());this.documentHelper.renderedLists.clear(),this.documentHelper.renderedLevelOverrides=[];var a=this.combineSection();this.documentHelper.clearContent(),this.documentHelper.layout.layoutItems(a,!0),this.documentHelper.owner.isShiftingEnabled=!1,this.setPositionForCurrentIndex(t,o),this.setPositionForCurrentIndex(i,s),this.documentHelper.selection.selectPosition(t,i),this.reLayout(this.documentHelper.selection,void 0,e),this.documentHelper.layout.isLayoutWhole=!1},e.prototype.combineSection=function(){var e=[],t=this.documentHelper.pages[0].bodyWidgets[0];do{t=this.combineSectionChild(t,e,!1)}while(t);for(var i=0;i<this.documentHelper.pages.length;i++)this.documentHelper.pages[i].destroy(),i--;return e},e.prototype.combineSectionChild=function(e,t,i){var r=e,n=new ne,o=!1;n.sectionFormat=e.sectionFormat,n.index=r.index;do{o=!1,r=e,e.lastChild&&e.lastChild.combineWidget(this.owner.viewer),e=e.nextRenderedWidget;for(var s=0;s<r.childWidgets.length;s++){var a=r.childWidgets[s];a instanceof de?this.documentHelper.layout.clearTableWidget(a,!0,!0,!0):(a.x=0,a.y=0,a.width=0,a.height=0),n.childWidgets.push(a),r.childWidgets.splice(s,1),s--,a.containerWidget=n}for(var l=0;l<r.page.bodyWidgets.length;l++){if(0!==r.page.bodyWidgets[l].childWidgets.length){o=!1;break}o=!0}o&&i&&r.page.destroy()}while(e&&r.index===e.index);return t.push(n),e},e.prototype.updateSelectionTableFormat=function(e,t,i){switch(t){case"TableAlignment":this.editorHistory.initializeHistory("TableAlignment"),this.updateTableFormat(e,"tableAlignment",i);break;case"TableLeftIndent":this.editorHistory.initializeHistory("TableLeftIndent"),this.updateTableFormat(e,"leftIndent",i);break;case"DefaultCellSpacing":this.editorHistory.initializeHistory("DefaultCellSpacing"),this.updateTableFormat(e,"cellSpacing",i);break;case"DefaultCellLeftMargin":this.editorHistory.initializeHistory("DefaultCellLeftMargin"),this.updateTableFormat(e,"leftMargin",i);break;case"DefaultCellRightMargin":this.editorHistory.initializeHistory("DefaultCellRightMargin"),this.updateTableFormat(e,"rightMargin",i);break;case"DefaultCellTopMargin":this.editorHistory.initializeHistory("DefaultCellTopMargin"),this.updateTableFormat(e,"topMargin",i);break;case"TablePreferredWidth":this.editorHistory.initializeHistory("TablePreferredWidth"),this.updateTableFormat(e,"preferredWidth",i);break;case"TablePreferredWidthType":this.editorHistory.initializeHistory("TablePreferredWidthType"),this.updateTableFormat(e,"preferredWidthType",i);break;case"DefaultCellBottomMargin":this.editorHistory.initializeHistory("DefaultCellBottomMargin"),this.updateTableFormat(e,"bottomMargin",i);break;case"CellContentVerticalAlignment":this.editorHistory.initializeHistory("CellContentVerticalAlignment"),this.updateCellFormat(e,"verticalAlignment",i);break;case"CellLeftMargin":this.editorHistory.initializeHistory("CellLeftMargin"),this.updateCellFormat(e,"leftMargin",i);break;case"CellRightMargin":this.editorHistory.initializeHistory("CellRightMargin"),this.updateCellFormat(e,"rightMargin",i);break;case"CellTopMargin":this.editorHistory.initializeHistory("CellTopMargin"),this.updateCellFormat(e,"topMargin",i);break;case"CellBottomMargin":this.editorHistory.initializeHistory("CellBottomMargin"),this.updateCellFormat(e,"bottomMargin",i);break;case"CellPreferredWidth":this.editorHistory.initializeHistory("CellPreferredWidth"),this.updateCellFormat(e,"preferredWidth",i);break;case"CellPreferredWidthType":this.editorHistory.initializeHistory("CellPreferredWidthType"),this.updateCellFormat(e,"preferredWidthType",i);break;case"Shading":this.editorHistory.initializeHistory("Shading"),this.updateCellFormat(e,"shading",i);break;case"RowHeight":this.editorHistory.initializeHistory("RowHeight"),this.updateRowFormat(e,"height",i);break;case"RowHeightType":this.editorHistory.initializeHistory("RowHeightType"),this.updateRowFormat(e,"heightType",i);break;case"RowHeader":this.editorHistory.initializeHistory("RowHeader"),this.updateRowFormat(e,"isHeader",i);break;case"AllowBreakAcrossPages":this.editorHistory.initializeHistory("AllowBreakAcrossPages"),this.updateRowFormat(e,"allowBreakAcrossPages",i);break;case"TableBidi":this.editorHistory.initializeHistory(t),this.updateTableFormat(e,"bidi",i)}},e.prototype.updateTableFormat=function(e,t,i){var r=e.start;e.end;e.isForward||(r=e.end,e.start),this.initHistoryPosition(e,r),this.applyTablePropertyValue(e,t,i,r.paragraph.associatedCell.ownerTable),this.editorHistory&&(this.editorHistory.isUndoing||this.editorHistory.isRedoing)&&this.documentHelper.layout.reLayoutTable(r.paragraph.associatedCell.ownerTable)},e.prototype.updateCellFormat=function(e,t,i){e.owner.isShiftingEnabled=!0;var r=e.start;e.end;e.isForward||(r=e.end,e.start),this.initHistoryPosition(e,r),this.updateFormatForCell(e,t,i)},e.prototype.updateRowFormat=function(e,t,i){var r=e.start,n=e.end;e.isForward||(r=e.end,n=e.start),this.initHistoryPosition(e,r),this.applyRowFormat(r.paragraph.associatedCell.ownerRow,r,n,t,i)},e.prototype.initHistoryPosition=function(e,t){this.documentHelper.owner.editorHistoryModule&&!sf.base.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)&&(sf.base.isNullOrUndefined(t)?sf.base.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo.insertPosition)&&(this.editorHistory.currentBaseHistoryInfo.insertPosition=e.start.getHierarchicalIndexInternal()):sf.base.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo.insertPosition)&&(this.editorHistory.currentBaseHistoryInfo.insertPosition=t.getHierarchicalIndexInternal()))},e.prototype.startSelectionReLayouting=function(e,t,i,r){if(t.owner.isLayoutEnabled=!0,i.paragraph.isInsideTable){for(var n=i.paragraph.associatedCell.ownerTable;n.isInsideTable;)n=n.associatedCell.ownerTable;this.reLayoutSelectionOfTable(n,t,i,r)}else this.reLayoutSelection(e,t,i,r)},e.prototype.reLayoutSelectionOfTable=function(e,t,i,r){var n=!1;if(this.documentHelper.layout.layoutBodyWidgetCollection(e.index,e.containerWidget,e,!1),!sf.base.isNullOrUndefined(r.paragraph.associatedCell)&&e.contains(r.paragraph.associatedCell))return!0;var o=t.getNextRenderedBlock(e);return sf.base.isNullOrUndefined(o)||(n=this.reLayoutSelectionOfBlock(o,t,i,r)),n},e.prototype.reLayoutSelection=function(e,t,i,r){if(i.paragraph===e){i.offset,t.getParagraphLength(e);var n=0,o=0,s=e.getInline(i.offset,n),a=s.element;n=s.index,sf.base.isNullOrUndefined(a)||(n!==a.length||sf.base.isNullOrUndefined(a.nextNode)||(a=a.nextNode),o=a.line.children.indexOf(a));var l=0;i.currentWidget.paragraph===e&&(l=e.childWidgets.indexOf(i.currentWidget),o=i.currentWidget.children.indexOf(a)),a instanceof we&&!a.line&&o>0?this.documentHelper.layout.reLayoutParagraph(e,l,o-1):this.documentHelper.layout.reLayoutParagraph(e,l,o)}else this.documentHelper.layout.reLayoutParagraph(e,0,0);if(r.paragraph===e)return!0;var h=t.getNextRenderedBlock(e);return!sf.base.isNullOrUndefined(h)&&this.reLayoutSelectionOfBlock(h,t,i,r)},e.prototype.reLayoutSelectionOfBlock=function(e,t,i,r){return e instanceof le?this.reLayoutSelection(e,t,i,r):void 0},e.prototype.layoutItemBlock=function(e,t){var i=void 0;if(e.containerWidget instanceof re)!sf.base.isNullOrUndefined(this.documentHelper.owner)&&this.documentHelper.owner.isLayoutEnabled&&(i=(e=e.combineWidget(this.viewer)).containerWidget,this.documentHelper.layout.layoutBodyWidgetCollection(e.index,i,e,!1));else if(e.containerWidget instanceof pe){var r=e.containerWidget;r=this.documentHelper.selection.getContainerCell(r),!sf.base.isNullOrUndefined(this.documentHelper.owner)&&this.documentHelper.owner.isLayoutEnabled&&this.documentHelper.layout.reLayoutTable(e)}},e.prototype.removeSelectedContents=function(e){return this.removeSelectedContentInternal(e,e.start,e.end)},e.prototype.removeSelectedContentInternal=function(e,t,i){var r=t,n=i;if(t.isExistBefore(i)||(r=i,n=t),r.paragraph===n.paragraph&&r.paragraph.childWidgets.indexOf(r.currentWidget)===r.paragraph.childWidgets.length-1&&r.offset===e.getParagraphLength(r.paragraph)&&r.offset+1===n.offset)return e.owner.isShiftingEnabled=!0,e.selectContent(r,!0),!0;var o=this.selection.getParagraphInfo(r);e.editPosition=this.selection.getHierarchicalIndex(o.paragraph,o.offset.toString());var s=r.clone(),a=s.paragraph.containerWidget,l=s.currentWidget.isFirstLine(),h=this.checkMultipleSectionSelected(s,n),d=this.removeSelectedContent(n.paragraph,e,r,n),c=new Ft(e.owner);if(h&&"DefaultPaste"==this.selection.currentPasteAction&&l&&s.offset<1){var p=s.paragraph,u=new le,g=new ue(u);g.paragraph=u,u.containerWidget=a,u.childWidgets.push(g),a.childWidgets.push(u),u.index=p.index,u.x=s.location.x,u.y=s.location.y}return this.setPositionForCurrentIndex(c,e.editPosition),e.selectContent(c,!0),d},e.prototype.checkMultipleSectionSelected=function(e,t){return this.getBodyWidgetIndex(e)!=this.getBodyWidgetIndex(t)},e.prototype.getBodyWidgetIndex=function(e){var t=e.hierarchicalPosition,i=t.indexOf(";"),r=t.substring(0,i);return i=(t=t.substring(i).replace(";","")).indexOf(";"),r=t.substring(0,i),parseInt(r,10)},e.prototype.removeSelectedContent=function(e,t,i,r){return!(r.paragraph.isInsideTable&&r.paragraph!==this.documentHelper.getLastParagraphInLastCell(r.paragraph.associatedCell.ownerTable)&&(!i.paragraph.isInsideTable||i.paragraph.associatedCell.ownerTable.index!==r.paragraph.associatedCell.ownerTable.index))&&(t.owner.isShiftingEnabled=!0,this.deleteSelectedContent(e,t,i,r,2),!0)},e.prototype.deleteSelectedContent=function(e,t,i,r,n){var o=0,s=i.currentWidget.getInline(i.offset,o);s.element;if(o=s.index,o=0,(s=r.currentWidget.getInline(r.offset,o)).element,o=s.index,r.paragraph===e){if(!r.paragraph.isInsideTable||i.paragraph.isInsideTable&&i.paragraph.associatedCell===r.paragraph.associatedCell&&!t.isCellSelected(r.paragraph.associatedCell,i,r)){if(this.deletePara(e,i,r,n),this.delBlockContinue&&this.delBlock){if(this.delSection){var a=e.bodyWidget instanceof ne?e.bodyWidget:void 0;this.deleteSection(t,this.delSection,a,n),this.delSection=void 0}this.deleteBlock(this.delBlock,t,i,r,n),this.delBlockContinue=!1,this.delBlock=void 0}}else r.paragraph.associatedCell.ownerTable.combineWidget(this.owner.viewer),this.deleteTableCell(r.paragraph.associatedCell,t,i,r,n);if(this.removeCommentCharacters.length>0&&!this.isCmtDeleteStarted){for(var l=0;l<this.removeCommentCharacters.length;l++){var h=this.editorHistory.currentBaseHistoryInfo,d=this.removeCommentCharacters[l];this.isCmtDeleteStarted=!0,d.commentMark&&d.removeCommentMark(),d.line&&d.line.paragraph&&d.line.paragraph.bodyWidget&&h&&(this.removeInline(d),this.selection.editPosition=h.insertPosition,this.isCmtDeleteStarted=!1,this.editorHistory.currentHistoryInfo&&(this.editorHistory.currentHistoryInfo.insertPosition=h.insertPosition,this.editorHistory.currentHistoryInfo.endPosition=h.insertPosition,this.editorHistory.currentHistoryInfo.selectionStart=h.selectionStart,this.editorHistory.currentHistoryInfo.selectionEnd=h.selectionEnd,h.endPosition=h.insertPosition,this.editorHistory.updateComplexHistory(),this.editorHistory.currentBaseHistoryInfo=void 0))}this.isCmtDeleteStarted=!1,this.removeCommentCharacters=[],this.editorHistory.currentHistoryInfo&&(this.editorHistory.updateComplexHistory(),this.editorHistory.currentBaseHistoryInfo=void 0),this.selection.owner.isShiftingEnabled=!1}}else this.deleteSelectedContent(r.paragraph,t,i,r,n)},e.prototype.mergeCells=function(){!this.owner.isReadOnlyMode&&this.canEditContentControl&&this.owner.isDocumentLoaded&&(sf.base.isNullOrUndefined(this.documentHelper)||this.selection.isEmpty||this.mergeSelectedCellsInTable())},e.prototype.deleteTable=function(){if(!this.owner.isReadOnlyMode&&this.canEditContentControl){var e=this.selection.isForward?this.selection.start:this.selection.end;if(e.paragraph.isInsideTable){var t=this.getOwnerTable(this.selection.isForward).combineWidget(this.owner.viewer);this.selection.owner.isShiftingEnabled=!0,this.checkIsNotRedoing()&&(this.initHistory("DeleteTable"),this.updateHistoryPosition(e,!0));var i=!0;if(!this.skipTracking()){for(var r=0,n=0;n<t.childWidgets.length;n++){var o=t.childWidgets[n];1===o.rowFormat.revisions.length&&"Insertion"===o.rowFormat.revisions[0].revisionType&&o.rowFormat.revisions[0].author===(""===this.owner.currentUser?"Guest user":this.owner.currentUser)&&(this.isRemoveRevision=!0,this.unlinkRangeFromRevision(o.rowFormat,!0),this.isRemoveRevision=!1,0===o.rowFormat.revisions[0].range.length&&o.rowFormat.revisions.splice(0,1),r++)}r===t.childWidgets.length&&(i=!1)}var s=this.getParagraphForSelection(t);if(this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&this.editorHistory.currentBaseHistoryInfo.removedNodes.push(t.clone()),this.owner.enableTrackChanges&&i)for(n=0;n<t.childWidgets.length;n++){if(0===n){var a=t.childWidgets[0];s=this.selection.getFirstParagraph(a)}this.trackRowDeletion(t.childWidgets[n])}else this.removeBlock(t);this.selection.selectParagraphInternal(s,!0),(this.checkIsNotRedoing()||sf.base.isNullOrUndefined(this.editorHistory))&&this.reLayout(this.selection)}}},e.prototype.deleteColumn=function(){!this.owner.isReadOnlyMode&&this.canEditContentControl&&(this.owner.enableTrackChanges||this.onDeleteColumnConfirmed())},e.prototype.onDeleteColumnConfirmed=function(){var e=this.selection.isForward?this.selection.start:this.selection.end;this.selection.isForward?this.selection.end:this.selection.start;if(e.paragraph.isInsideTable){this.selection.owner.isShiftingEnabled=!0,this.checkIsNotRedoing()&&this.initHistory("DeleteColumn");var t=this.getOwnerCell(this.selection.isForward),i=this.getOwnerCell(!this.selection.isForward),r=t.ownerTable.combineWidget(this.owner.viewer);this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&this.cloneTableToHistoryInfo(r);var n=void 0;if(i.nextWidget){var o=i.nextWidget;n=this.selection.getFirstParagraph(o)}else if(t.previousWidget){var s=t.previousWidget;n=this.selection.getFirstParagraph(s)}sf.base.isNullOrUndefined(n)&&(n=this.getParagraphForSelection(r));for(var a=r.getColumnCellsForSelection(t,i),l=0;l<r.childWidgets.length;l++){var h=r.childWidgets[l];if(1===h.childWidgets.length)a.indexOf(h.childWidgets[0])>=0&&(r.childWidgets.splice(r.childWidgets.indexOf(h),1),h.destroy(),l--);else{for(var d=0;d<h.childWidgets.length;d++){var c=h.childWidgets[d];a.indexOf(c)>=0&&(h.childWidgets.splice(d,1),c.destroy(),d--)}0===h.childWidgets.length&&(r.childWidgets.splice(r.childWidgets.indexOf(h),1),h.destroy(),l--)}}0===r.childWidgets.length?(n=this.getParagraphForSelection(r),this.removeBlock(r),this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&(this.editorHistory.currentBaseHistoryInfo.action="DeleteTable"),r.destroy()):this.updateTable(r),this.selection.selectParagraphInternal(n,!0),(sf.base.isNullOrUndefined(this.editorHistory)||this.checkIsNotRedoing())&&this.reLayout(this.selection,!0)}},e.prototype.deleteRow=function(){if(!this.owner.isReadOnlyMode&&this.canEditContentControl){var e=this.selection.isForward?this.selection.start:this.selection.end,t=(this.selection.isForward?this.selection.end:this.selection.start,this.selection.getParagraphInfo(e)),i=this.selection.getHierarchicalIndex(t.paragraph,t.offset.toString());if(e.paragraph.isInsideTable){var r=this.getOwnerCell(this.selection.isForward),n=this.getOwnerCell(!this.selection.isForward);this.checkIsNotRedoing()&&this.initHistory("DeleteRow"),this.selection.owner.isShiftingEnabled=!0;var o=r.ownerTable.combineWidget(this.owner.viewer),s=this.getOwnerRow(!0);this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&this.cloneTableToHistoryInfo(o);var a=void 0;if(s.nextWidget){var l=s.nextWidget.childWidgets[0];a=this.selection.getFirstParagraph(l)}if(sf.base.isNullOrUndefined(a)&&(a=this.getParagraphForSelection(o)),e=e.clone(),this.selection.isEmpty)this.owner.enableTrackChanges?this.trackRowDeletion(s,!0,!1):this.removeRow(s);else{var h=this.selection.getContainerCellOf(r,n);if(h.ownerTable.contains(n))if(r=this.selection.getSelectedCell(r,h),n=this.selection.getSelectedCell(n,h),this.selection.containsCell(h,n))s=r.ownerRow,this.removeRow(s);else{s=r.ownerRow;var d=n.ownerRow;if(a=void 0,d.nextWidget){l=d.nextWidget.childWidgets[0];a=this.selection.getFirstParagraph(l)}sf.base.isNullOrUndefined(a)&&(a=this.getParagraphForSelection(o));for(var c=0;c<o.childWidgets.length;c++){var p=o.childWidgets[c];p.rowIndex>=s.rowIndex&&p.rowIndex<=d.rowIndex&&(this.owner.enableTrackChanges&&this.checkIsNotRedoing()?this.trackRowDeletion(p,!0,!1):(o.childWidgets.splice(c,1),p.destroy(),c--))}0===o.childWidgets.length?(this.removeBlock(o),this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&(this.editorHistory.currentBaseHistoryInfo.action="DeleteTable"),o.destroy()):this.updateTable(o)}}if(!this.owner.enableTrackChanges||sf.base.isNullOrUndefined(o.childWidgets))this.selection.selectParagraphInternal(a,!0);else{var u=this.selection.getTextPosBasedOnLogicalIndex(i);this.selection.selectContent(u,!0)}(sf.base.isNullOrUndefined(this.editorHistory)||this.checkIsNotRedoing())&&this.reLayout(this.selection,!0)}}},e.prototype.trackRowDeletion=function(e,t,i){var r=e.rowFormat;if(!sf.base.isNullOrUndefined(r)){if(r.revisions.length>0){var n=this.retrieveRevisionInOder(r);if("Insertion"===n.revisionType){if(this.isRevisionMatched(r,void 0))return sf.base.isNullOrUndefined(t)||t?this.removeRow(e):this.removeRevisionsInRow(e),!0}else"Deletion"===n.revisionType&&this.unlinkWholeRangeInRevision(r,n)}(sf.base.isNullOrUndefined(i)||i)&&this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&(this.editorHistory.currentBaseHistoryInfo.action="RemoveRowTrack"),this.insertRevision(r,"Deletion");for(var o=0;o<e.childWidgets.length;o++)for(var s=e.childWidgets[o],a=0;a<s.childWidgets.length;a++)if(s.childWidgets[a]instanceof de)this.trackInnerTable(s.childWidgets[o],t,i);else{var l=s.childWidgets[a];this.skipTableElements=!0,this.insertRevisionForBlock(l,"Deletion",void 0,void 0,!0),this.skipTableElements=!1}}return!1},e.prototype.trackInnerTable=function(e,t,i){for(var r=0;r<e.childWidgets.length;r++)this.trackRowDeletion(e.childWidgets[r],t,i)},e.prototype.returnDeleteRevision=function(e){for(var t=0;t<e.length;t++)if("Deletion"===e[t].revisionType)return e[t]},e.prototype.removeRow=function(e){var t=e.ownerTable;e.rowFormat.revisions.length>0&&this.removeRevisionsInRow(e),1===t.childWidgets.length?(this.removeBlock(t),this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&(this.editorHistory.currentBaseHistoryInfo.action="Delete"),t.destroy()):(t.childWidgets.splice(t.childWidgets.indexOf(e),1),e.destroy(),this.updateTable(t))},e.prototype.updateTable=function(e){(e=e.combineWidget(this.viewer)).updateRowIndex(0),e.isGridUpdated=!1,e.buildTableColumns(),e.isGridUpdated=!0,this.documentHelper.layout.reLayoutTable(e)},e.prototype.getParagraphForSelection=function(e){var t=void 0,i=e.nextWidget?e.nextWidget:e.nextRenderedWidget,r=e.previousWidget?e.previousWidget:e.previousRenderedWidget;return i?t=i instanceof le?i:this.documentHelper.getFirstParagraphInFirstCell(i):r&&(t=r instanceof le?r:this.documentHelper.getLastParagraphInLastCell(r)),t},e.prototype.deletePara=function(e,t,i,r){e=e.combineWidget(this.owner.viewer);var n=this.documentHelper.selection,o=n.getStartOffset(e),s=n.getStartOffset(i.paragraph),a=o,l=0,h=!1,d=this.selection.getLineLength(e.lastChild),c=e,p=e.bodyWidget instanceof ne?e.bodyWidget:void 0,u=void 0,g=void 0,f=this.combineLastBlock;e===t.paragraph?(a=t.offset,u=t.currentWidget,i.paragraph.isInsideTable&&(h=this.isEndInAdjacentTable(e,i.paragraph)),h||(h=this.combineLastBlock),this.combineLastBlock=!1):u=e.firstChild,e!==t.paragraph&&n.isSkipLayouting&&(n.isSkipLayouting=!1),e===i.paragraph?(g=i.currentWidget,l=i.offset):(g=e.lastChild,l=this.documentHelper.selection.getLineLength(e.lastChild));var m=sf.base.isNullOrUndefined(e.previousRenderedWidget)||t.paragraph===e?void 0:e.previousRenderedWidget.combineWidget(this.documentHelper.viewer);(a>o&&t.currentWidget===e.lastChild&&a===d&&(e===i.paragraph&&i.offset===a+1||e.nextRenderedWidget===i.paragraph&&i.offset===s)||this.editorHistory&&this.editorHistory.isUndoing&&this.editorHistory.currentHistoryInfo&&"PageBreak"===this.editorHistory.currentHistoryInfo.action&&m&&m.isPageBreak()&&(0===a&&!t.currentWidget.isFirstLine||a>0)||t.paragraph!==i.paragraph&&2===r&&t.paragraph===e&&t.paragraph.nextWidget===i.paragraph)&&(h=!0);var y=i.clone();y.offset=y.offset-1;var v=t.paragraph===e&&t.isAtParagraphStart&&y.isAtParagraphEnd&&this.editorHistory&&!sf.base.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)&&"Insert"===this.editorHistory.currentBaseHistoryInfo.action;v&&(this.editorHistory.currentBaseHistoryInfo.action="InsertTextParaReplace");var b=t.paragraph===e;if(i.paragraph===e&&i.currentWidget!==e.lastChild||i.currentWidget===e.lastChild&&i.offset<=n.getLineLength(e.lastChild)||v){if((i.currentWidget.isFirstLine()&&i.offset>o||!i.currentWidget.isFirstLine()||v)&&this.removeInlines(e,u,a,g,l,r),sf.base.isNullOrUndefined(m)||b||v)this.delBlockContinue=!1,this.delBlock=void 0;else this.delBlockContinue=!0,this.delBlock=m,(C=m.bodyWidget instanceof ne?m.bodyWidget:void 0)&&!p.equals(C)&&p.index!==C.index?this.delSection=C:this.delSection=void 0}else{if(t.paragraph===e&&(t.currentWidget!==e.firstChild||t.currentWidget===e.firstChild&&a>o))return this.delBlockContinue=!1,this.delBlock=void 0,4===r?void 0:void(this.skipTracking()&&"ParaMarkTrack"===this.editorHistory.currentBaseHistoryInfo.action?(this.addRemovedNodes(e.characterFormat.cloneFormat()),e.characterFormat.revisions.length>0&&this.unlinkRangeFromRevision(e.characterFormat,!0),e.characterFormat.revisions=[]):this.owner.enableTrackChanges&&!this.skipTracking()&&"TOC"!==this.editorHistory.currentBaseHistoryInfo.action&&"Reject Change"!==this.editorHistory.currentBaseHistoryInfo.action?h?(c=this.splitParagraph(e,e.firstChild,0,u,a,!0),this.deleteParagraphMark(c,n,r,!0),this.addRemovedNodes(e)):this.removeInlines(e,u,a,g,l,r):(c=this.splitParagraph(e,e.firstChild,0,u,a,!0),this.insertParagraphPaste(e,c,t,i,h,r,f),this.removeRevisionForBlock(e,void 0,!1,!0),this.addRemovedNodes(e)));i.paragraph===e&&i.paragraph.isInsideTable&&(t.currentWidget.isFirstLine()&&t.offset>n.getStartOffset(t.paragraph)||!t.currentWidget.isFirstLine())&&i.offset>=n.getLineLength(i.paragraph.lastChild)&&i.paragraph.nextRenderedWidget&&(this.combineLastBlock=!0);var w=void 0,x=e.previousWidget,M=x instanceof le?x:void 0,N=e.nextRenderedWidget;if(r<4){if(this.owner.enableTrackChanges&&!this.skipTracking()&&this.editorHistory.currentBaseHistoryInfo&&"TOC"!==this.editorHistory.currentBaseHistoryInfo.action){var I=-1;if(this.editorHistory.currentBaseHistoryInfo&&(I=this.editorHistory.currentBaseHistoryInfo.removedNodes.length),this.insertRevisionForBlock(e,"Deletion"),!e.isEmpty()||i.paragraph.previousRenderedWidget instanceof de?this.combineRevisionWithBlocks(e.firstChild.children[0]):(w=this.checkAndInsertBlock(e,t,i,r,M),this.removeBlock(e),-1===I?this.addRemovedNodes(e):this.editorHistory.currentBaseHistoryInfo.removedNodes.splice(I,0,e),this.removeRevisionForBlock(e,void 0,!1,!0)),e===i.paragraph&&"Delete"===this.editorHistory.currentBaseHistoryInfo.action&&!this.isInsertingTOC){var S=this.selection.getParagraphInfo(i);this.selection.editPosition=this.selection.getHierarchicalIndex(S.paragraph,S.offset.toString())}if(t.paragraph!==e&&!sf.base.isNullOrUndefined(m))return this.delBlockContinue=!0,void(this.delBlock=m)}else{var C;if(w=this.checkAndInsertBlock(e,t,i,r,M),this.removeRevisionForBlock(e,void 0,!1,!0),this.addRemovedNodes(e),!sf.base.isNullOrUndefined(m)&&!b&&!v)if(this.delBlock=m,(C=m.bodyWidget instanceof ne?m.bodyWidget:void 0)&&p.index!==C.index){var O=e.bodyWidget instanceof ne?e.bodyWidget:void 0;this.deleteSection(n,C,O,r)}this.removeBlock(e)}if(this.documentHelper.blockToShift===e&&(this.documentHelper.blockToShift=void 0),sf.base.isNullOrUndefined(w)){if(e===t.paragraph&&(sf.base.isNullOrUndefined(N)||!sf.base.isNullOrUndefined(N)&&!sf.base.isNullOrUndefined(p)&&p.index!==N.bodyWidget.index)&&!sf.base.isNullOrUndefined(M)){T=this.selection.getParagraphLength(M);n.editPosition=this.selection.getHierarchicalIndex(M,T.toString()),this.editorHistory&&!sf.base.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)&&(this.updateHistoryPosition(n.editPosition,!0),this.editorHistory.currentBaseHistoryInfo.endPosition=n.editPosition)}}else{n.editPosition=this.selection.getHierarchicalIndex(w,"0");var T=n.getParagraphLength(w)+1;this.editorHistory&&!sf.base.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)&&(this.editorHistory.currentBaseHistoryInfo.endPosition=this.selection.getHierarchicalIndex(w,T.toString()))}}t.paragraph===e||sf.base.isNullOrUndefined(m)?(this.delBlockContinue=!1,this.delBlock=void 0):(this.delBlockContinue=!0,this.delBlock=m)}this.insertParagraphPaste(e,c,t,i,h,r,f)},e.prototype.deleteSection=function(e,t,i,r){r<4&&this.combineSectionInternal(e,t,i),r>2&&t.sectionFormat.copyFormat(i.sectionFormat)},e.prototype.combineSectionInternal=function(e,t,i){var r=t.getSplitWidgets()[0],n=[];this.combineSectionChild(r,n,!0);var o=(r=n[0]).lastChild.index;this.updateBlockIndex(o+1,i.firstChild);for(var s=0,a=i,l=0;l<r.childWidgets.length;l++){var h=r.childWidgets.splice(l,1)[0];a.childWidgets.splice(s,0,h),h.containerWidget=a,this.documentHelper.layout.layoutBodyWidgetCollection(h.index,h.bodyWidget,h,!1),a=(h=h.getSplitWidgets().pop()).containerWidget,s=h.indexInOwner+1,l--}if(this.documentHelper.headersFooters[r.sectionIndex]){r.removedHeaderFooters=[];var d=this.documentHelper.headersFooters.splice(r.sectionIndex,1)[0],c=Object.keys(d);for(l=0;l<c.length;l++){var p=d[c[l]];this.removeFieldInWidget(p),this.removeFieldInWidget(p,!1,!0),p.page=void 0}r.removedHeaderFooters.push(d)}this.updateSectionIndex(void 0,i,!1),this.addRemovedNodes(r),this.documentHelper.removeEmptyPages(),this.editorHistory&&this.editorHistory.isUndoing&&(i.sectionFormat=t.sectionFormat)},e.prototype.checkAndInsertBlock=function(e,t,i,r,n){if(e instanceof le&&e===t.paragraph||e instanceof de){var o=void 0;if(sf.base.isNullOrUndefined(e.nextWidget)&&(sf.base.isNullOrUndefined(n)||n.nextRenderedWidget instanceof de)){if(o=new le,1===r&&e instanceof le&&!sf.base.isNullOrUndefined(e.paragraphFormat.baseStyle)&&"Normal"===e.paragraphFormat.baseStyle.name&&(o.characterFormat.copyFormat(e.characterFormat),o.paragraphFormat.copyFormat(e.paragraphFormat)),o.index=e.index+1,o.containerWidget=e.containerWidget,e instanceof le){o.paragraphFormat.lineSpacing=e.paragraphFormat.lineSpacing,o.paragraphFormat.lineSpacingType=e.paragraphFormat.lineSpacingType;var s=this.documentHelper.styles.findByName("Normal");sf.base.isNullOrUndefined(s)||(o.paragraphFormat.baseStyle=new gt,o.paragraphFormat.baseStyle.copyStyle(s))}this.documentHelper.layout.layoutBodyWidgetCollection(o.index,o.bodyWidget,o,!1),e.containerWidget instanceof ie&&e.containerWidget.childWidgets.push(o)}return o}},e.prototype.splitParagraph=function(e,t,i,r,n,o){var s=new le;s.paragraphFormat=new ct(s),s.characterFormat=new P(s),s.paragraphFormat.copyFormat(e.paragraphFormat),s.characterFormat.copyFormat(e.characterFormat);var a=new ue(s);s.childWidgets.push(a);var l=e.index,h=e.indexInOwner;if(this.moveInlines(e,s,0,i,t,n,r),e.containerWidget.childWidgets[h])for(var d=e.containerWidget.childWidgets[h],c=0;c<d.childWidgets.length;c++)for(var p=d.childWidgets[c],u=0;u<p.children.length;u++){var g=p.children[u];g instanceof Me&&this.removeFootnote(g)}return e.containerWidget.childWidgets.splice(h,0,s),s.index=l,s.containerWidget=e.containerWidget,this.updateNextBlocksIndex(s,!0),o&&this.removeBlock(e),this.documentHelper.layout.layoutBodyWidgetCollection(l,s.containerWidget,s,!1),s},e.prototype.addOrRemoveCommentsInBlock=function(e,t){if(e instanceof de)for(var i=0;i<e.childWidgets.length;i++)for(var r=e.childWidgets[i],n=0;n<r.childWidgets.length;n++)for(var o=r.childWidgets[n],s=0;s<o.childWidgets.length;s++){var a=o.childWidgets[s];this.addOrRemoveCommentsInBlock(a,t)}else this.addOrRemoveCommentInPara(e,t)},e.prototype.addOrRemoveCommentInPara=function(e,t){for(var i=0;i<e.childWidgets.length;i++)for(var r=e.childWidgets[i],n=0;n<r.children.length;n++)this.addOrRemoveCommentsInline(r.children[n],t)},e.prototype.addOrRemoveCommentsInline=function(e,t){if(e instanceof nt&&0===e.commentType&&!sf.base.isNullOrUndefined(e.comment)){var i=e.comment.ownerComment?e.comment.ownerComment:e.comment;t?this.addCommentWidget(i,!1,!1,!1):(e.commentMark&&e.removeCommentMark(),this.deleteCommentWidget(i))}},e.prototype.removeBlock=function(e,t,i){var r,n;if(i||(this.removeFieldInBlock(e),this.removeFieldInBlock(e,!0),this.removeFieldInBlock(e,void 0,!0)),this.addOrRemoveCommentsInBlock(e),e.isInsideTable)n=e.associatedCell,r=e.associatedCell.childWidgets.indexOf(e),e.associatedCell.childWidgets,this.updateNextBlocksIndex(e,!1),e.associatedCell.childWidgets.splice(r,1),e.containerWidget=void 0,this.documentHelper.layout.layoutBodyWidgetCollection(e.index,n,e,!1);else{n=e.containerWidget;for(var o=0;o<e.childWidgets.length;o++){var s=void 0;if(this.isPasteRevertAction()||(s=this.skipTracking()),e.childWidgets[o]instanceof ce&&!s){var a=e.childWidgets[o];this.removeDeletedCellRevision(a)}if(e.childWidgets[o]instanceof ue)for(var l=e.childWidgets[o],h=0;h<l.children.length;h++){var d=l.children[h];d instanceof Me&&!this.selection.isEmpty&&this.removeFootnote(d)}}r=n.childWidgets.indexOf(e),n.childWidgets,this.updateNextBlocksIndex(e,!1),n.childWidgets.splice(r,1),e.containerWidget=void 0,n.height-=e.height,!sf.base.isNullOrUndefined(n.containerWidget)&&n.containerWidget instanceof ae&&(n.containerWidget.height-=e.height),this.documentHelper.layout.layoutBodyWidgetCollection(e.index,n,e,!1,t)}},e.prototype.removePrevParaMarkRevision=function(e,t){if(t=!sf.base.isNullOrUndefined(t)&&t,this.owner.enableTrackChanges||0!=e.characterFormat.revisions.length){var i=-1,r=void 0,n=e;if(t||sf.base.isNullOrUndefined(n.previousRenderedWidget)||(n=n.previousRenderedWidget),n.characterFormat.revisions.length>0&&(i=(r=n.characterFormat.revisions[n.characterFormat.revisions.length-1]).range.indexOf(n.characterFormat)),i>=0&&!sf.base.isNullOrUndefined(r))r.range[i]instanceof P&&(r.range.splice(i,1),n.characterFormat&&n.characterFormat.revisions.indexOf(r)>-1&&n.characterFormat.revisions.splice(n.characterFormat.revisions.indexOf(r),1),0==r.range.length&&this.owner.revisionsInternal.remove(r))}},e.prototype.isPasteRevertAction=function(){return!(sf.base.isNullOrUndefined(this.editorHistory)||!this.editorHistory.currentBaseHistoryInfo||"Paste"!==this.editorHistory.currentBaseHistoryInfo.action)},e.prototype.toCheckForTrack=function(e){if(this.owner.enableTrackChanges&&!this.skipTracking()&&e instanceof de&&e.childWidgets.length>0){var t=e.childWidgets[0].rowFormat;if(t.revisions.length>0&&"Insertion"!==t.revisions[0].revisionType&&t.revisions[0].author===(""===this.owner.currentUser?"Guest user":this.owner.currentUser)||0===t.revisions.length)return!0}return!1},e.prototype.removeFootnote=function(e,t){if(e.paragraph.bodyWidget.page.footnoteWidget){for(var i=e.paragraph.bodyWidget.page.footnoteWidget,r=0;r<i.bodyWidgets.length;r++)e===i.bodyWidgets[r].footNoteReference&&(i.height-=i.bodyWidgets[r].childWidgets[0].height,i.bodyWidgets.splice(r,1),r--);0===i.bodyWidgets.length&&(e.paragraph.bodyWidget.page.footnoteWidget=void 0)}this.documentHelper.footnoteCollection.splice(this.documentHelper.footnoteCollection.indexOf(e),1)},e.prototype.removeEndnote=function(e,t){if(e.paragraph.bodyWidget.page.endnoteWidget){for(var i=e.paragraph.bodyWidget.page.endnoteWidget,r=0;r<i.bodyWidgets.length;r++)e===i.bodyWidgets[r].footNoteReference&&(i.height-=i.bodyWidgets[r].childWidgets[0].height,i.bodyWidgets.splice(r,1),r--);0===i.bodyWidgets.length&&(e.paragraph.bodyWidget.page.endnoteWidget=void 0)}this.documentHelper.endnoteCollection.splice(this.documentHelper.endnoteCollection.indexOf(e),1)},e.prototype.removeAutoShape=function(e){var t=e.line.paragraph.floatingElements.indexOf(e),i=e.line.paragraph.bodyWidget.floatingElements.indexOf(e);i>-1&&e.line.paragraph.bodyWidget.floatingElements.splice(i,1),e.line.paragraph.floatingElements.splice(t,1)},e.prototype.removeField=function(e,t,i){var r=this.documentHelper.fields;if(t?r=this.documentHelper.bookmarks.keys:i&&(r=this.documentHelper.contentControlCollection),e.floatingElements.length>0)for(var n=0;n<e.floatingElements.length;n++){var o=e.floatingElements[n];this.removeAutoShape(o)}for(var s=0;s<r.length;s++){(h=t?this.documentHelper.bookmarks.get(r[s]):r[s]).line.paragraph===e&&(t?this.documentHelper.bookmarks.remove(r[s]):i?this.documentHelper.contentControlCollection.splice(s,1):(this.documentHelper.fields.splice(s,1),-1!==this.documentHelper.formFields.indexOf(h)&&this.documentHelper.formFields.splice(this.documentHelper.formFields.indexOf(h),1)),s--)}if(this.documentHelper.footnoteCollection.length>0)for(s=0;s<this.documentHelper.footnoteCollection.length;s++){if((h=this.documentHelper.footnoteCollection[s]).line.paragraph===e){if(h.paragraph.bodyWidget.page.footnoteWidget){for(var a=h.paragraph.bodyWidget.page.footnoteWidget,l=0;l<a.bodyWidgets.length;l++)h===a.bodyWidgets[l].footNoteReference&&(a.height-=a.bodyWidgets[l].height,a.bodyWidgets.splice(l,1),l--);0===a.bodyWidgets.length&&(h.paragraph.bodyWidget.page.footnoteWidget=void 0)}this.documentHelper.footnoteCollection.splice(s,1),s--}}if(this.documentHelper.endnoteCollection.length>0)for(s=0;s<this.documentHelper.endnoteCollection.length;s++){var h;if((h=this.documentHelper.endnoteCollection[s]).line.paragraph===e){if(h.paragraph.bodyWidget.page.endnoteWidget){var d=h.paragraph.bodyWidget.page.endnoteWidget;for(l=0;l<d.bodyWidgets.length;l++)h===d.bodyWidgets[l].footNoteReference&&(d.height-=d.bodyWidgets[l].height,d.bodyWidgets.splice(l,1),l--);0===d.bodyWidgets.length&&(h.paragraph.bodyWidget.page.endnoteWidget=void 0)}this.documentHelper.endnoteCollection.splice(s,1),s--}}},e.prototype.addRemovedNodes=function(e,t){e instanceof nt&&0===e.commentType&&e.commentMark&&e.removeCommentMark(),e instanceof Oe&&0===e.type&&this.documentHelper.contentControlCollection.splice(this.documentHelper.contentControlCollection.indexOf(e),1),e instanceof fe&&0===e.fieldType&&(-1!==this.documentHelper.fields.indexOf(e)&&this.documentHelper.fields.splice(this.documentHelper.fields.indexOf(e),1),-1!==this.documentHelper.formFields.indexOf(e)&&this.documentHelper.formFields.splice(this.documentHelper.formFields.indexOf(e),1)),this.editorHistory&&!sf.base.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)?t?this.editorHistory.currentBaseHistoryInfo.removedNodes.splice(0,0,e):this.editorHistory.currentBaseHistoryInfo.removedNodes.push(e):this.editHyperlinkInternal&&this.nodes.push(e)},e.prototype.deleteBlock=function(e,t,i,r,n){if(e instanceof le){if(this.deletePara(e,i,r,n),this.delBlockContinue&&this.delBlock){if(this.delSection){var o=e.bodyWidget instanceof ne?e.bodyWidget:void 0;this.deleteSection(t,this.delSection,o,n),this.delSection=void 0}-1!==this.delBlock.indexInOwner&&this.deleteBlock(this.delBlock,t,i,r,n),this.delBlockContinue=!1,this.delBlock=void 0}}else this.deleteTableBlock(e,t,i,r,n)},e.prototype.deleteTableCell=function(e,t,i,r,n){var o=!(i.paragraph.isInsideTable&&e.ownerTable.contains(i.paragraph.associatedCell)),s=e.ownerTable.previousRenderedWidget;if(i.paragraph.isInsideTable){var a=t.getContainerCellOf(e,i.paragraph.associatedCell);if(a.ownerTable.contains(i.paragraph.associatedCell)){var l=t.getSelectedCell(e,a);t.getSelectedCell(i.paragraph.associatedCell,a);if(t.containsCell(a,i.paragraph.associatedCell))if(t.isCellSelected(a,i,r))if(this.updateEditPosition(a,t),1===n)this.deleteCellsInTable(e.ownerRow.ownerTable,t,i,r,n);else{var h=this.deleteCell(a,t,n,!0);!h&&2!==n&&this.editorHistory?this.editorHistory.currentBaseHistoryInfo=void 0:h&&this.documentHelper.layout.reLayoutTable(a.ownerRow.ownerTable)}else if(l===a){if(this.deletePara(r.paragraph,i,r,n),this.delBlockContinue&&this.delBlock){if(this.delSection){var d=r.paragraph,c=d.bodyWidget instanceof ne?d.bodyWidget:void 0;this.deleteSection(t,this.delSection,c,n),this.delSection=void 0}this.deleteBlock(this.delBlock,t,i,r,n),this.delBlockContinue=!1,this.delBlock=void 0}}else this.deleteContainer(l,t,i,r,n);else 2===n?this.deleteCell(e,t,2,!1):this.deleteCellsInTable(a.ownerTable,t,i,r,n)}else this.deleteContainer(a,t,i,r,n)}else{var p=t.getContainerCell(e);this.deleteContainer(p,t,i,r,n)}if(o){s.bodyWidget instanceof ne&&s.bodyWidget;sf.base.isNullOrUndefined(s)||this.deleteBlock(s,t,i,r,n)}},e.prototype.deleteCellsInTable=function(e,t,i,r,n,o){var s="Delete",a=!1,l=i.paragraph.associatedCell,h=r.paragraph.associatedCell;if(sf.base.isNullOrUndefined(o)||(h=o),this.editorHistory&&!sf.base.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)){if(s=this.editorHistory.currentBaseHistoryInfo.action,a="BackSpace"===this.editorHistory.currentBaseHistoryInfo.action||"DeleteCells"===this.editorHistory.currentBaseHistoryInfo.action||"InsertTable"===this.editorHistory.currentBaseHistoryInfo.action||"RemoveRowTrack"===this.editorHistory.currentBaseHistoryInfo.action||sf.base.isNullOrUndefined(l.ownerRow.previousWidget)&&sf.base.isNullOrUndefined(h.ownerRow.nextWidget)&&"Cut"===this.editorHistory.currentBaseHistoryInfo.action,this.cloneTableToHistoryInfo(e),"RemoveRowTrack"===this.editorHistory.currentBaseHistoryInfo.action)return;this.editorHistory.currentBaseHistoryInfo.action=a?"DeleteCells":"ClearCells",t.owner.isLayoutEnabled=!1}var d=l.columnIndex,c=h.columnIndex+h.cellFormat.columnSpan-1,p=l.rowIndex,u=h.rowIndex,g=this.isWholeRowSelected(l.ownerRow,d,c);this.owner.enableTrackChanges&&!this.skipTracking()?g&&this.onConfirmedTableCellsDeletion(e,t,p,u,d,c,a,n,g,s):this.onConfirmedTableCellsDeletion(e,t,p,u,d,c,a,n,g,s)},e.prototype.removeDeletedCellRevision=function(e){e.rowFormat.revisions.length>0&&this.unlinkRangeFromRevision(e.rowFormat,!0);for(var t=0;t<e.childWidgets.length;t++)for(var i=e.childWidgets[t],r=0;r<i.childWidgets.length;r++){var n=i.childWidgets[r];if(!sf.base.isNullOrUndefined(n)&&n instanceof le){for(var o=0;o<n.childWidgets.length;o++){var s=n.childWidgets[o];if(!sf.base.isNullOrUndefined(s.children))for(var a=0;a<s.children.length;a++){var l=s.children[a];l.revisions.length>0&&this.unlinkRangeFromRevision(l,!0)}}this.unlinkRangeFromRevision(n.characterFormat,!0)}}},e.prototype.onConfirmedTableCellsDeletion=function(e,t,i,r,n,o,s,a,l,h){for(var d=0;d<e.childWidgets.length;d++){var c=e.childWidgets[d],p=!1;if(c.index>=i&&c.index<=r&&(this.owner.enableTrackChanges&&!this.skipTracking()&&l?(p=this.trackRowDeletion(c,!1))&&this.onConfirmedCellDeletion(c,t,i,r,n,o,s,a):this.onConfirmedCellDeletion(c,t,i,r,n,o,s,a)),!p&&0===c.childWidgets.length){for(var u=e.childWidgets[d],g=u.previousRenderedWidget;!sf.base.isNullOrUndefined(g);){for(var f=0;f<g.childWidgets.length;f++){var m=g.childWidgets[f];u.rowIndex<m.ownerRow.rowIndex+m.cellFormat.rowSpan&&m.cellFormat.rowSpan--}g=g.previousRenderedWidget}this.updateNextBlocksIndex(u,!1),e.childWidgets.splice(d,1),d--,r--}}t.owner.isLayoutEnabled=!0,0===e.childWidgets.length?(t.editPosition=this.selection.getHierarchicalIndex(e,"0"),this.setActionInternal(t,h),this.removeBlock(e)):(e.isGridUpdated=!1,e.buildTableColumns(),e.isGridUpdated=!0,this.documentHelper.layout.reLayoutTable(e))},e.prototype.onConfirmedCellDeletion=function(e,t,i,r,n,o,s,a){var l=!1;this.removeDeletedCellRevision(e);for(var h=0;h<e.childWidgets.length;h++){var d=e.childWidgets[h];if(d.columnIndex>=n&&d.columnIndex<=o)if(l||(this.updateEditPosition(d,t),l=!0),s){var c=e.childWidgets[h];this.updateNextBlocksIndex(c,!1);for(var p=0;p<c.childWidgets.length;p++)for(var u=c.childWidgets[p],g=0;g<u.childWidgets.length;g++){var f=u.childWidgets[g];if(f instanceof ue)for(var m=f,y=0;y<m.children.length;y++){var v=m.children[y];v instanceof Me&&this.removeFootnote(v)}}e.childWidgets.splice(h,1),h--}else a<4&&this.deleteCell(d,t,a,!1)}},e.prototype.removeRevisionForRow=function(e){e.rowFormat.revisions.length>0&&this.skipTracking()&&(this.unlinkRangeFromRevision(e.rowFormat,!0),this.addRemovedRevisionInfo(e.rowFormat,void 0))},e.prototype.removeRevisionsInRow=function(e){if(e.rowFormat.revisions.length>0)for(var t=0;t<e.rowFormat.revisions.length;t++){var i=e.rowFormat.revisions[t];this.unlinkWholeRangeInRevision(e.rowFormat,i)}},e.prototype.removeRevisionForCell=function(e,t){for(var i=0;i<e.childWidgets.length;i++)if(e.childWidgets[i]instanceof le)for(var r=e.childWidgets[i],n=0;n<r.childWidgets.length;n++)for(var o=r.childWidgets[n],s=0;s<o.children.length;s++){var a=o.children[s];!sf.base.isNullOrUndefined(a)&&a.revisions.length>0&&(this.unlinkRangeFromRevision(a,t),this.addRemovedRevisionInfo(a,void 0))}else e.childWidgets[i]instanceof de&&this.removeRevisionForInnerTable(e.childWidgets[i])},e.prototype.removeRevisionForInnerTable=function(e){if(e.childWidgets.length>0)for(var t=0;t<e.childWidgets.length;t++){var i=e.childWidgets[t];sf.base.isNullOrUndefined(i)||this.removeRevisionForRow(i)}},e.prototype.removeRevisionForBlock=function(e,t,i,r){if(e.characterFormat.revisions.length>0&&!i&&(r&&this.addRemovedRevisionInfo(e.characterFormat,void 0,!1),sf.base.isNullOrUndefined(t)?this.unlinkRangeFromRevision(e.characterFormat,!0):this.unlinkRangeByRevision(e.characterFormat,t),e.characterFormat.revisions=[]),!sf.base.isNullOrUndefined(e))for(var n=0;n<e.childWidgets.length;n++)for(var o=e.childWidgets[n],s=0;s<o.children.length;s++){var a=o.children[s];!sf.base.isNullOrUndefined(a)&&a.revisions.length>0&&(r&&this.addRemovedRevisionInfo(a,void 0,!1),sf.base.isNullOrUndefined(t)?this.unlinkRangeFromRevision(a,!0):this.unlinkRangeByRevision(a,t),a.revisions=[])}},e.prototype.unlinkRangeByRevision=function(e,t){for(var i=0;i<e.revisions.length;i++){var r=e.revisions[i];if(r.author===t.author&&r.revisionType===t.revisionType){e.revisions.splice(e.revisions.indexOf(t),1);var n=t.range.indexOf(e);t.range.splice(n,1)}}},e.prototype.isWholeRowSelected=function(e,t,i){var r=t+i;return 0===t&&e.childWidgets.length-1===r},e.prototype.deleteCell=function(e,t,i,r){var n=e.childWidgets[0];if(1===e.childWidgets.length&&n instanceof le&&n.isEmpty())return!1;for(var o=e.childWidgets.length-1,s=e.childWidgets.length-1;s>-1;s--)if(n=e.childWidgets[s],i<4){if(n instanceof le&&s===o){var a=n;if(this.checkClearCells(t))a.isEmpty()||this.removeInlines(a,a.firstChild,0,a.lastChild,a.lastChild.getEndOffset(),i);else for(var l=a.childWidgets.length-1;l>=0;l--){for(var h=a.childWidgets[l],d=h.children.length-1;d>=0;d--){var c=h.children[d];c instanceof Me?this.removeFootnote(c):c instanceof Ce&&0===c.bookmarkType&&this.documentHelper.bookmarks.containsKey(c.name)&&this.documentHelper.bookmarks.remove(c.name),this.unLinkFieldCharacter(c),h.children.splice(d,1)}a.childWidgets.length>1&&a.childWidgets.splice(l,1)}continue}this.removeBlock(n),this.checkClearCells(t)&&(this.addRemovedNodes(n),1===e.childWidgets.length&&(t.editPosition=this.selection.getHierarchicalIndex(e.childWidgets[0],"0"),this.updateHistoryPosition(t.editPosition,!0)))}return!0},e.prototype.paragrapghBookmarkCollection=function(e,t){for(var i=this.documentHelper.bookmarks,r=0;r<i.length;r++){var n=this.documentHelper.bookmarks.get(i.keys[r]);n.paragraph===e&&t.push(n)}return t},e.prototype.deleteContainer=function(e,t,i,r,n){var o=e.ownerTable;if(t.containsRow(o.lastChild,r.paragraph.associatedCell))this.deleteContent(o,t,n);else if(this.toCheckForTrack(o))for(var s=0;s<o.childWidgets.length;s++){var a=o.childWidgets[s];if(this.trackRowDeletion(a),r.paragraph.isInsideTable&&t.containsRow(a,r.paragraph.associatedCell))return void this.documentHelper.layout.reLayoutTable(o)}else for(s=0;s<o.childWidgets.length;s++){var l=o.childWidgets[s];if(n<4&&(this.updateNextBlocksIndex(l,!1),o.childWidgets.splice(s,1),this.addRemovedNodes(l),s--),r.paragraph.isInsideTable&&t.containsRow(l,r.paragraph.associatedCell))return void this.documentHelper.layout.reLayoutTable(o)}},e.prototype.deleteTableBlock=function(e,t,i,r,n){if(e=e.combineWidget(this.owner.viewer),i.paragraph.isInsideTable&&e.contains(i.paragraph.associatedCell)){var o=e.previousRenderedWidget,s=this.checkAndInsertBlock(e,i,r,n,o instanceof le?o:void 0);if(t.containsRow(e.firstChild,i.paragraph.associatedCell))this.deleteContent(e,t,n);else if(this.owner.enableTrackChanges){if(sf.base.isNullOrUndefined(r.paragraph.associatedCell)&&!r.paragraph.isInsideTable){var a=r.paragraph.previousRenderedWidget.lastChild.lastChild;this.deleteCellsInTable(e,t,i,r,n,a)}}else{var l=this.splitTable(e,i.paragraph.associatedCell.ownerRow);this.deleteContent(e,t,n),this.documentHelper.layout.layoutBodyWidgetCollection(l.index,l.containerWidget,l,!1)}sf.base.isNullOrUndefined(s)||(t.editPosition=this.selection.getHierarchicalIndex(s,"0"),this.editorHistory&&!sf.base.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)&&(this.editorHistory.currentBaseHistoryInfo.endPosition=t.editPosition))}else{var h=e.previousRenderedWidget;e.bodyWidget instanceof ne&&e.bodyWidget;if(this.owner.enableTrackChanges)for(var d=0;d<e.childWidgets.length;d++)this.trackRowDeletion(e.childWidgets[d]);else this.deleteContent(e,t,n);sf.base.isNullOrUndefined(h)||this.deleteBlock(h,t,i,r,n)}},e.prototype.splitTable=function(e,t){var i=new de;i.tableFormat.copyFormat(e.tableFormat),i.index=e.index;for(var r=0;r<e.childWidgets.length;r++){var n=e.childWidgets[r];if(n===t)break;i.childWidgets.push(n),n.containerWidget=i,e.childWidgets.splice(r,1),r--}var o=e.getIndex();return e.containerWidget.childWidgets.splice(o,0,i),i.containerWidget=e.containerWidget,this.updateNextBlocksIndex(i,!0),i},e.prototype.updateEditPosition=function(e,t){var i=this.documentHelper.getFirstParagraphInCell(e);t.editPosition=this.selection.getHierarchicalIndex(i,"0")},e.prototype.deleteContent=function(e,t,i){i<4&&(this.removeBlock(e),this.addRemovedNodes(e))},e.prototype.setActionInternal=function(e,t){this.documentHelper.owner.enableHistoryMode&&!sf.base.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)&&(this.editorHistory.currentBaseHistoryInfo.action=t)},e.prototype.checkClearCells=function(e){return this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&"ClearCells"!==this.editorHistory.currentBaseHistoryInfo.action},e.prototype.isEndInAdjacentTable=function(e,t){var i=this.selection.getHierarchicalIndex(e,""),r=this.selection.getHierarchicalIndex(t,""),n=i.split(";"),o=r.split(";");return n.length<o.length},e.prototype.cloneTableToHistoryInfo=function(e){if(this.editorHistory&&!sf.base.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)){var t=e.clone();return this.editorHistory.currentBaseHistoryInfo.removedNodes.push(t),this.documentHelper.selection.start.paragraph.isInsideTable&&this.documentHelper.selection.start.paragraph.associatedCell.ownerTable===e&&this.updateHistoryPosition(this.selection.getHierarchicalIndex(e,"0"),!0),t}},e.prototype.insertParagraphPaste=function(e,t,i,r,n,o,s){if(this.editorHistory&&(this.editorHistory.isUndoing||this.editorHistory.isRedoing)&&!sf.base.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)&&"Paste"===this.editorHistory.currentBaseHistoryInfo.action){var a=this.selection.getNextParagraphBlock(t);if(a&&i.offset>0&&a===r.paragraph&&e===i.paragraph&&"Paste"===this.editorHistory.currentBaseHistoryInfo.action){var l=0;this.removeBlock(t),this.documentHelper.layout.clearListElementBox(a),this.documentHelper.layout.clearListElementBox(t);for(var h=0;h<t.childWidgets.length;h++){var d=t.childWidgets[h];a.childWidgets.splice(l,0,d),t.childWidgets.splice(h,1),h--,l++,d.paragraph=a}this.documentHelper.layout.reLayoutParagraph(a,0,0),n=!1;var c=this.selection.editPosition.substring(this.selection.editPosition.lastIndexOf(";")+1);this.selection.editPosition=this.selection.getHierarchicalIndex(a,c)}}n&&this.deleteParagraphMark(t,this.selection,o,!1,s)},e.prototype.removeInlines=function(e,t,i,r,n,o){var s=!1;this.documentHelper.layout.clearListElementBox(e);e.childWidgets.indexOf(t);for(var a=this.selection.start.clone(),l=this.selection.end.clone(),h=this.selection.editPosition,d=e.childWidgets.length-1;d>=0;d--){var c=e.childWidgets[d];if(t===c&&r===c){this.removeContent(c,i,n,o),s=!0;break}if(r===c)s=!0,this.removeContent(c,0,n,o);else{if(t===c){this.removeContent(c,i,this.documentHelper.selection.getLineLength(c),o);break}s&&this.removeContent(c,0,this.documentHelper.selection.getLineLength(c),o)}}this.owner.enableTrackChanges&&!this.skipTracking()&&(this.selection.start.setPositionInternal(a),this.selection.end.setPositionInternal(l),this.skipReplace&&(this.editorHistory.currentBaseHistoryInfo.insertPosition=void 0,this.updateInsertPosition()),this.selection.editPosition=h),s&&(this.removeEmptyLine(e),this.documentHelper.layout.reLayoutParagraph(e,0,0))},e.prototype.skipTracking=function(){return!(sf.base.isNullOrUndefined(this.editorHistory)||!this.editorHistory.isUndoing&&!this.editorHistory.isRedoing)||!(sf.base.isNullOrUndefined(this.editorHistory)||!this.editorHistory.currentBaseHistoryInfo||"Reject Change"!==this.editorHistory.currentBaseHistoryInfo.action&&"Accept Change"!==this.editorHistory.currentBaseHistoryInfo.action)},e.prototype.canHandleDeletion=function(){return!(sf.base.isNullOrUndefined(this.editorHistory)||!this.editorHistory.currentBaseHistoryInfo||"DeleteRow"!==this.editorHistory.currentBaseHistoryInfo.action)},e.prototype.removeContent=function(e,t,i,r){for(var n=this.selection.getLineLength(e),o=(e.paragraph.paragraphFormat.bidi,void 0),s=0,a=void 0,l=e.children.length-1;l>=0;l--){var h=e.children[l];if(sf.base.isNullOrUndefined(r)||2!==r)for(var d=0;d<e.children.length;d++){var c=e.children[d];if(c instanceof we){var p=c.text;p.length+s>t&&!(s>t)&&(o=p[t-s-1],sf.base.isNullOrUndefined(o)&&t-s==0&&(o=a)),p.length+s>i&&(" "===p[i-s]&&0===t||" "===o&&" "===p[i-s])&&(i+=1),a=p[p.length-1]}s+=c.length}if(i<=n-h.length)n-=h.length;else{var u=h.length;n>i&&n-u<i&&(u=i-(n-h.length));var g=0;if(n-h.length<t&&(g=t-(n-h.length)),n>i&&(n-=h.length-u),0===g&&u===h.length){if((!this.owner.enableTrackChanges||this.owner.enableTrackChanges&&this.skipTracking())&&(this.editorHistory&&(this.editorHistory.isUndoing||this.editorHistory.isRedoing)||h instanceof Ce&&this.removedBookmarkElements.push(h),h instanceof Ce&&this.documentHelper.bookmarks.containsKey(h.name)&&this.documentHelper.bookmarks.remove(h.name)),h instanceof nt&&0===h.commentType&&(h.comment.ownerComment?this.deleteCommentWidget(h.comment.ownerComment):this.deleteCommentWidget(h.comment)),(h instanceof Re&&"Inline"!==h.textWrappingStyle||h instanceof Ee)&&this.removeAutoShape(h),this.skipFieldDeleteTracking&&h.revisions.length>0){var f=h;f instanceof fe&&(1!==f.fieldType&&2!==f.fieldType||(f=f.fieldBegin),this.clearFieldElementRevisions(f,h.revisions))}this.canHandleDeletion()||this.owner.enableTrackChanges&&!this.skipTracking()&&!this.skipFieldDeleteTracking&&!this.isInsertingTOC?(this.skipTableElements||this.addRemovedNodes(h.clone()),this.handleDeleteTracking(h,t,i,l)):(h instanceof Me&&(h.isLayout=!1),this.unLinkFieldCharacter(h),this.unlinkRangeFromRevision(h,!0),this.addRemovedRevisionInfo(h,void 0),this.addRemovedNodes(h),e.children.splice(l,1))}else if(h instanceof we){var m=this.handleDeleteTracking(h,g,u);sf.base.isNullOrUndefined(m)||this.skipTableElements||(h.revisions.length>0&&this.addRemovedRevisionInfo(h,m),this.addRemovedNodes(m))}if(h instanceof Me&&("Footnote"===h.footnoteType?this.removeFootnote(h):this.removeEndnote(h)),t>=n-(u-g))break;n-=u-g,this.documentHelper.layout.clearListElementBox(e.paragraph)}}},e.prototype.skipCommentCharacter=function(e){var t=this.editorHistory.currentBaseHistoryInfo,i=t.insertPosition,r=t.selectionStart,n=t.selectionEnd;if(!this.editorHistory.currentBaseHistoryInfo||this.editorHistory.currentHistoryInfo||this.editorHistory.isUndoing||this.editorHistory.isRedoing||(this.initComplexHistory("SkipCommentInline"),this.editorHistory.updateHistory(),this.initHistory(t.action)),this.editorHistory.currentHistoryInfo&&"DeleteComment"!==this.editorHistory.currentHistoryInfo.action&&!this.editorHistory.isUndoing&&!this.editorHistory.isRedoing){var o=e.line.getOffset(e,1),s=new Ft(this.owner);s.setPositionParagraph(e.line,o);var a=this.selection.getHierarchicalIndexByPosition(s);this.selection.isForward?(this.editorHistory.currentBaseHistoryInfo.selectionEnd=a,t.selectionStart=a,this.editorHistory.currentHistoryInfo.selectionEnd=t.selectionEnd):(this.editorHistory.currentBaseHistoryInfo.selectionStart=a,t.selectionEnd=a,this.editorHistory.currentHistoryInfo.selectionStart=t.selectionStart),t.insertPosition=this.selection.isForward?t.selectionStart:t.selectionEnd,t.endPosition=t.insertPosition,this.editorHistory.currentHistoryInfo.insertPosition=t.insertPosition;var l=this.editorHistory.currentBaseHistoryInfo;l.insertPosition=this.selection.isForward?l.selectionStart:l.selectionEnd,l.endPosition=l.insertPosition,this.editorHistory.currentHistoryInfo.addModifiedAction(l),this.editorHistory.currentBaseHistoryInfo.insertPosition=i,this.editorHistory.currentBaseHistoryInfo.selectionStart=r,this.editorHistory.currentBaseHistoryInfo.selectionEnd=n}},e.prototype.clearFieldElementRevisions=function(e,t){for(var i=t,r=0;r<i.length;r++)for(var n=i[r],o=0;o<n.range.length;o++)if(n.range[o]===e)for(var s=o;s<n.range.length;s){if(n.range[o]instanceof fe&&1===n.range[o].fieldType&&n.range[o].fieldBegin===e){n.removeRangeRevisionForItem(n.range[o]),0===n.range.length&&this.owner.revisions.remove(n);break}n.removeRangeRevisionForItem(n.range[o])}},e.prototype.addRemovedRevisionInfo=function(e,t,i){for(var r=0;r<e.revisions.length;r++){var n=e.revisions[r].revisionID;sf.base.isNullOrUndefined(t)?e.removedIds.push(n):t.removedIds.push(n)}sf.base.isNullOrUndefined(t)&&(sf.base.isNullOrUndefined(i)||i)&&(e.revisions=[])},e.prototype.removeEmptyLine=function(e){if(e.childWidgets.length>1)for(var t=0;t<e.childWidgets.length;t++){0===e.childWidgets[t].children.length&&e.childWidgets.length>1&&(e.childWidgets.splice(t,1),t--)}},e.prototype.cloneListLevel=function(e){var t=new A(void 0);return this.copyListLevel(t,e),t},e.prototype.copyListLevel=function(e,t){sf.base.isNullOrUndefined(t.paragraphFormat)||(e.paragraphFormat=new ct(e),e.paragraphFormat.copyFormat(t.paragraphFormat)),sf.base.isNullOrUndefined(t.characterFormat)||(e.characterFormat=new P(e),e.characterFormat.copyFormat(t.characterFormat)),sf.base.isNullOrUndefined(t.followCharacter)||(e.followCharacter=t.followCharacter),sf.base.isNullOrUndefined(t.listLevelPattern)||(e.listLevelPattern=t.listLevelPattern),sf.base.isNullOrUndefined(t.numberFormat)||(e.numberFormat=t.numberFormat),sf.base.isNullOrUndefined(t.restartLevel)||(e.restartLevel=t.restartLevel),sf.base.isNullOrUndefined(t.startAt)||(e.startAt=t.startAt)},e.prototype.cloneLevelOverride=function(e){var t=new g;return sf.base.isNullOrUndefined(e.startAt)||(t.startAt=e.startAt),sf.base.isNullOrUndefined(e.overrideListLevel)||(t.overrideListLevel=e.overrideListLevel),sf.base.isNullOrUndefined(e.levelNumber)||(t.levelNumber=e.levelNumber),t},e.prototype.updateListParagraphs=function(){this.documentHelper.listParagraphs=[];for(var e=0;e<this.documentHelper.pages.length;e++)for(var t=this.documentHelper.pages[e].bodyWidgets[0],i=0;i<t.childWidgets.length;i++)this.updateListParagraphsInBlock(t.childWidgets[i])},e.prototype.updateListParagraphsInBlock=function(e){if(e instanceof le)sf.base.isNullOrUndefined(e.paragraphFormat)||sf.base.isNullOrUndefined(e.paragraphFormat.listFormat)||sf.base.isNullOrUndefined(e.paragraphFormat.listFormat.listId)||(e.paragraphFormat.listFormat.listId>=0&&e.paragraphFormat.clearIndent(),sf.base.isNullOrUndefined(this.documentHelper.listParagraphs)&&(this.documentHelper.listParagraphs=[]),this.documentHelper.listParagraphs.push(e));else if(e instanceof de)for(var t=0;t<e.childWidgets.length;t++)for(var i=0;i<e.childWidgets[t].childWidgets.length;i++)for(var r=e.childWidgets[t].childWidgets[i],n=0;n<r.childWidgets.length;n++)this.updateListParagraphsInBlock(r.childWidgets[n])},e.prototype.onApplyList=function(e){var t=this.documentHelper.selection;this.setOffsetValue(this.documentHelper.selection),this.initHistory("ListFormat");var i=new m;sf.base.isNullOrUndefined(e)||(i.listId=e.listId),this.documentHelper.owner.isShiftingEnabled=!0,t.isEmpty?(this.applyParaFormatProperty(t.start.paragraph,"listFormat",i,!1),this.layoutItemBlock(t.start.paragraph,!1)):this.updateSelectionParagraphFormatting("listFormat",i,!1),this.reLayout(t)},e.prototype.applyBulletOrNumbering=function(e,t,i){var r=this.documentHelper.selection,n=r.paragraphFormat.getList(),o=!1,s=r.start;r.isForward||(s=r.end);var a=s.paragraph;if(sf.base.isNullOrUndefined(n)){for(;!sf.base.isNullOrUndefined(a.previousWidget)&&a.previousWidget instanceof le&&a.previousWidget.isEmpty()&&-1===a.previousWidget.paragraphFormat.listFormat.listId;)a=a.previousWidget;if(a.previousWidget&&a.previousWidget instanceof le&&-1!==a.previousWidget.paragraphFormat.listFormat.listId&&(a=a.previousWidget,n=this.documentHelper.getListById(a.paragraphFormat.listFormat.listId),o=!0),!o){for(;!sf.base.isNullOrUndefined(a.nextWidget)&&a.nextWidget instanceof le&&a.nextWidget.isEmpty()&&-1===a.nextWidget.paragraphFormat.listFormat.listId;)a=a.nextWidget;a.nextWidget&&a.nextWidget instanceof le&&-1!==a.nextWidget.paragraphFormat.listFormat.listId&&(a=a.nextWidget,n=this.documentHelper.getListById(a.paragraphFormat.listFormat.listId),o=!0)}}var l=void 0,h=-1,d=void 0,c=!1;if(-1===a.paragraphFormat.listFormat.listId||sf.base.isNullOrUndefined(a.paragraphFormat.listFormat.listLevel)||(this.listNumberFormat=a.paragraphFormat.listFormat.listLevel.numberFormat,this.listLevelPattern=a.paragraphFormat.listFormat.listLevel.listLevelPattern,this.listLevelNumber=a.paragraphFormat.listFormat.listLevelNumber),!sf.base.isNullOrUndefined(n)){h=a.paragraphFormat.listFormat.listLevelNumber;var p=this.documentHelper.getListById(a.paragraphFormat.listFormat.listId);if(l=this.documentHelper.layout.getListLevel(p,h),h>0&&(d=this.documentHelper.layout.getListLevel(p,0),c=!sf.base.isNullOrUndefined(d)&&h>0&&r.start.isInSameParagraph(r.end)),(u=p.abstractList)||(u=this.documentHelper.getAbstractListById(n.abstractListId)),0===u.levels.length&&(l=this.documentHelper.layout.getListLevel(p,a.paragraphFormat.listFormat.listLevelNumber)),o){if("Bullet"!==t&&l.listLevelPattern===t&&(l.numberFormat===e||-1!==l.numberFormat.indexOf(e)))return r.paragraphFormat.listId=n.listId,r.paragraphFormat.listLevelNumber=h,void r.paragraphFormat.setList(n);l=u.levels[0]}}if(sf.base.isNullOrUndefined(n)||!sf.base.isNullOrUndefined(n)&&0===h&&(l.listLevelPattern!==t||l.numberFormat!==e||l.characterFormat.fontFamily!==i&&"Bullet"===l.listLevelPattern)){o=!1,n=new f,this.documentHelper.lists.length>0?n.listId=this.documentHelper.lists[this.documentHelper.lists.length-1].listId+1:n.listId=0;var u=new S;if(this.documentHelper.abstractLists.length>0?u.abstractListId=this.documentHelper.abstractLists[this.documentHelper.abstractLists.length-1].abstractListId+1:u.abstractListId=0,n.abstractListId=u.abstractListId,n.abstractList=u,this.documentHelper.abstractLists.push(u),"bullet"===e||"multiLevel"===e||"numbering"===e)this.addListLevels(u,e,r);else(g=new A(u)).listLevelPattern=t,g.numberFormat=e,"Bullet"!==t?g.startAt=1:g.characterFormat.fontFamily=i,g.paragraphFormat.leftIndent=36,g.paragraphFormat.firstLineIndent=-18,u.levels.push(g),r.paragraphFormat.listLevelNumber=0;r.paragraphFormat.setList(n)}else if(c&&!sf.base.isNullOrUndefined(n)){p=this.documentHelper.getListById(a.paragraphFormat.listFormat.listId);var g=this.documentHelper.layout.getListLevel(p,h);if("Bullet"===t)g.numberFormat=e,g.characterFormat.fontFamily=i;else{g.listLevelPattern=t,g.characterFormat.fontFamily=i;var m=g.numberFormat.substring(g.numberFormat.length-1);g.numberFormat.length!==e.length&&h>0?g.numberFormat=e:e.substring(e.length-1)!==g.numberFormat.substring(g.numberFormat.length-1)&&(g.numberFormat=g.numberFormat.replace(m,e.substring(e.length-1)))}r.paragraphFormat.setList(p)}else!sf.base.isNullOrUndefined(n)&&o?r.paragraphFormat.setList(n):r.paragraphFormat.setList(void 0)},e.prototype.addListLevels=function(e,t,i){for(var r=[String.fromCharCode(61558),String.fromCharCode(61656),String.fromCharCode(61607),String.fromCharCode(61623),String.fromCharCode(61608)],n=e.levels.length;n<9;n++){var o=new A(e);if(t.match("bullet"))o.listLevelPattern="Bullet",o.numberFormat=r[n<5?n%5:n%5+1],o.characterFormat.fontFamily=n<3||5===n?"Wingdings":"Symbol";else{if(t.match("multiLevel")){for(var s=0;s<n+1;s++)o.numberFormat+="%"+(s+1).toString()+".";o.listLevelPattern="Number"}else o.numberFormat="%"+(n+1).toString()+")",o.listLevelPattern=n%3==0?"Number":n%3==1?"LowLetter":"LowRoman";o.startAt=1,o.restartLevel=n}o.paragraphFormat.leftIndent=0===n?36:36*n,o.paragraphFormat.firstLineIndent=-18,e.levels.push(o),i.paragraphFormat.listLevelNumber=n}},e.prototype.insertPageBreak=function(){if(!this.owner.isReadOnlyMode){if(this.documentHelper.selection.start.paragraph.isInsideTable||this.documentHelper.selection.start.paragraph.isInHeaderFooter)return;this.initComplexHistory("PageBreak"),this.onEnter("PageBreak"),this.editorHistory&&!sf.base.isNullOrUndefined(this.editorHistory.currentHistoryInfo)&&this.editorHistory.updateComplexHistory(),this.selection.checkForCursorVisibility()}},e.prototype.insertColumnBreak=function(){if(!this.owner.isReadOnlyMode){if(this.documentHelper.selection.start.paragraph.isInsideTable||this.documentHelper.selection.start.paragraph.isInHeaderFooter)return;this.initComplexHistory("ColumnBreak"),this.onEnter("ColumnBreak"),this.editorHistory&&!sf.base.isNullOrUndefined(this.editorHistory.currentHistoryInfo)&&this.editorHistory.updateComplexHistory(),this.selection.checkForCursorVisibility()}},e.prototype.onEnter=function(e){var t,i=this.documentHelper.selection;(sf.base.isNullOrUndefined(i.start.paragraph.paragraphFormat.baseStyle)||"Normal"===i.start.paragraph.paragraphFormat.baseStyle.name)&&((t=new xt(void 0)).cloneFormat(this.selection.characterFormat),i.start.paragraph.lastChild.children[i.start.paragraph.lastChild.children.length-1]instanceof Me&&(t.baselineAlignment="Normal"));if(!this.isXmlMapped){if(i.isEmpty){var r=i.getHyperlinkField();if(!sf.base.isNullOrUndefined(r))return void i.fireRequestNavigate(r);if((f=i.start.paragraph).isEmpty()&&-1!==f.paragraphFormat.listFormat.listId)return void this.onApplyListInternal(this.documentHelper.getListById(f.paragraphFormat.listFormat.listId),f.paragraphFormat.listFormat.listLevelNumber-1)}this.initHistory("Enter");var n=!0;if(i.isEmpty||(n=this.removeSelectedContents(i)),n){i.owner.isShiftingEnabled=!0,this.updateInsertPosition();var o=this.selection.getParagraphInfo(i.start),s=this.selection.getHierarchicalIndex(o.paragraph,o.offset.toString());if(this.splitParagraphInternal(i,i.start.paragraph,i.start.currentWidget,i.start.offset),this.setPositionForCurrentIndex(i.start,s),!sf.base.isNullOrUndefined(e)&&("PageBreak"===e||"ColumnBreak"===e)){var a=i.start.paragraph,l=new le;l.characterFormat.copyFormat(a.characterFormat),l.paragraphFormat.copyFormat(a.paragraphFormat);var h=new we;switch(e){case"PageBreak":h.text="\f";break;case"ColumnBreak":h.text=String.fromCharCode(14)}var d=new ue(l);if(d.children.push(h),h.line=d,l.childWidgets.push(d),this.owner.enableTrackChanges&&a.characterFormat.revisions.length>0){var c=this.retrieveRevisionInOder(a.characterFormat);c.range.push(l.characterFormat),l.characterFormat.revisions.push(c),l.characterFormat.removedIds=[]}this.insertParagraph(l,!0),i.selectParagraphInternal(l,!0)}var p=i.start.paragraph.nextWidget;sf.base.isNullOrUndefined(p)&&(p=i.getNextRenderedBlock(i.start.paragraph)),i.selectParagraphInternal(p,!0),this.updateEndPosition(),!sf.base.isNullOrUndefined(e)&&this.editorHistory&&this.owner.editorHistory.updateHistory(),this.reLayout(i);var u=this.selection.start.paragraph.containerWidget.firstChild;if(!sf.base.isNullOrUndefined(u)){u.isChangeDetected=!1;for(var g=u.nextRenderedWidget;this.owner.isSpellCheck&&!sf.base.isNullOrUndefined(g);)(u=g).isChangeDetected=!1,g=u.nextRenderedWidget}var f=i.start.paragraph.previousWidget;!sf.base.isNullOrUndefined(f)&&!f.isEmpty()&&f.lastChild.children[f.lastChild.children.length-1]instanceof we&&this.checkAndConvertToHyperlink(i,!0,f)}sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(i.start.paragraph)||!i.start.paragraph.isEmpty()||(this.selection.isRetrieveFormatting=!0,this.selection.characterFormat.cloneFormat(t),this.selection.isRetrieveFormatting=!1),this.documentHelper.layout.islayoutFootnote=!1}},e.prototype.splitParagraphInternal=function(e,t,i,r){var n=0,o=t.index,s=t;for(s.isChangeDetected=0===r;this.owner.isSpellCheck&&!sf.base.isNullOrUndefined(s.nextRenderedWidget);)(s=s.nextRenderedWidget).isChangeDetected=!0;var a=new le,l=new ue(a);if(a.childWidgets.push(l),a.paragraphFormat.ownerBase=a,i===t.lastChild&&r===e.getLineLength(i)){if(t.paragraphFormat.baseStyle&&"Normal"!==t.paragraphFormat.baseStyle.name&&t.paragraphFormat.baseStyle.next instanceof gt?(t.paragraphFormat.baseStyle.name===t.paragraphFormat.baseStyle.next.name?(a.paragraphFormat.copyFormat(t.paragraphFormat),a.characterFormat.copyFormat(t.characterFormat)):a.paragraphFormat.baseStyle=t.paragraphFormat.baseStyle.next,this.selection.skipFormatRetrieval=!1):(a.paragraphFormat.copyFormat(t.paragraphFormat),a.characterFormat.copyFormat(t.characterFormat)),t.lastChild.children.length>0&&t.characterFormat.copyFormat(t.lastChild.children[t.lastChild.children.length-1].characterFormat),this.owner.enableTrackChanges){var h=t.lastChild;if(!sf.base.isNullOrUndefined(h)&&h.children.length>0){var d=h.children[h.children.length-1].previousValidNodeForTracking;sf.base.isNullOrUndefined(d)||this.checkParaMarkMatchedWithElement(d,t.characterFormat,!1,"Insertion")||this.insertParaRevision(t)}}n++,o++}else{if(a.paragraphFormat.copyFormat(t.paragraphFormat),a.characterFormat.copyFormat(t.characterFormat),r>0||!i.isFirstLine())t=t.combineWidget(this.owner.viewer),this.moveInlines(t,a,0,0,t.firstChild,r,i),this.owner.enableTrackChanges&&this.insertParaRevision(a,t.firstChild);else{var c=t.previousRenderedWidget,p=!1;if(!sf.base.isNullOrUndefined(c)&&c instanceof le&&(p=c.characterFormat.revisions.length>0),this.owner.enableTrackChanges)if(p)this.checkToMatchEmptyParaMark(t,a)||this.insertParaRevision(t);else{var u=t.firstChild.children[0].previousValidNodeForTracking;sf.base.isNullOrUndefined(u)||this.checkParaMarkMatchedWithElement(u,a.characterFormat,!0,"Insertion")?sf.base.isNullOrUndefined(u)&&(n++,o++):this.insertParaRevision(a)}}t=t.getSplitWidgets()[0]}n+=t.getIndex();var g=t.containerWidget;if(g.childWidgets.splice(n,0,a),a.containerWidget=g,a.index=o,this.updateNextBlocksIndex(a,!0),!sf.base.isNullOrUndefined(g.containerWidget)&&g.containerWidget instanceof ae||g instanceof pe&&!sf.base.isNullOrUndefined(g.bodyWidget)&&g.bodyWidget.containerWidget instanceof ae){var f=this.documentHelper.textHelper.getParagraphMarkSize(a.characterFormat).Height;g instanceof pe?(g.bodyWidget.height+=f,g.bodyWidget.containerWidget.height+=f):(g.containerWidget.height+=f,g.height+=f)}this.owner.enableTrackChanges&&0===a.characterFormat.revisions.length&&0===t.characterFormat.revisions.length&&(this.checkToMatchEmptyParaMark(t)||this.insertParaRevision(t)),this.documentHelper.layout.layoutBodyWidgetCollection(o,g,a,!1)},e.prototype.insertParaRevision=function(e,t){if(this.owner.enableTrackChanges&&sf.base.isNullOrUndefined(t)&&!this.isRevisionMatched(e.characterFormat,"Insertion")&&(e.characterFormat.revisions=[],this.insertRevision(e.characterFormat,"Insertion")),!sf.base.isNullOrUndefined(t)){if(t.paragraph.isInsideTable)return void this.insertRevision(e.characterFormat,"Insertion");this.applyRevisionForParaMark(e,t,"Insertion",!0)}},e.prototype.applyRevisionForParaMark=function(e,t,i,r){var n=t.children[0];if(!sf.base.isNullOrUndefined(n)){n=n.nextValidNodeForTracking;var o=e.lastChild,s=0===o.children.length?void 0:o.children[o.children.length-1].previousValidNodeForTracking,a=!1,l=e.characterFormat.revisions.length;if(sf.base.isNullOrUndefined(s)||(a=this.checkParaMarkMatchedWithElement(s,e.characterFormat,!1,i)),!sf.base.isNullOrUndefined(n))if(e.characterFormat.revisions.length>l){if(this.isRevisionMatched(n,i))for(var h=e.characterFormat.revisions[0],d=this.getMatchedRevisionsToCombine(n.revisions,i),c=0;c<d.length;c++)d[c]!==h&&(a=!0,this.clearAndUpdateRevisons(d[c].range,h,h.range.indexOf(e.characterFormat)+1))}else a=this.checkParaMarkMatchedWithElement(n,e.characterFormat,!0,i);!a&&(this.owner.enableTrackChanges||t.paragraph.characterFormat.revisions.length>0)&&(this.insertRevision(e.characterFormat,i),r&&s.revisions.length>0&&n.revisions.length>0&&this.updateRevisionForSpittedTextElement(s,n))}},e.prototype.checkParaMarkMatchedWithElement=function(e,t,i,r){var n=this.getMatchedRevisionsToCombine(e.revisions,r);return n.length>0&&(this.mapMatchedRevisions(n,e,t,i),!0)},e.prototype.checkToMatchEmptyParaMark=function(e,t){var i=e.previousRenderedWidget;if(!sf.base.isNullOrUndefined(i)&&i instanceof le&&i.characterFormat.revisions.length>0){var r=this.getMatchedRevisionsToCombine(i.characterFormat.revisions,"Insertion");if(r.length>0)return sf.base.isNullOrUndefined(t)?this.mapMatchedRevisions(r,i.characterFormat,e.characterFormat,!1):this.mapMatchedRevisions(r,i.characterFormat,t.characterFormat,!1),!0}return!1},e.prototype.checkToMatchEmptyParaMarkBack=function(e){var t=e.nextRenderedWidget,i=t.childWidgets[0],r=i.children[0];if(!sf.base.isNullOrUndefined(t)&&t instanceof le&&t.characterFormat.revisions.length>0){if((n=this.getMatchedRevisionsToCombine(t.characterFormat.revisions,"Deletion")).length>0)return null!=t&&null!=i&&null!=r&&1==r.revisions.length?(this.mapMatchedRevisions(n,r,e.characterFormat,!0),!0):(this.mapMatchedRevisions(n,t.characterFormat,e.characterFormat,!0),!0)}else if(null!=r&&1==r.revisions.length){var n;if((n=this.getMatchedRevisionsToCombine(r.revisions,"Deletion")).length>0)return this.mapMatchedRevisions(n,r,e.characterFormat,!0),!0}return!1},e.prototype.updateNextBlocksIndex=function(e,t){if(!(sf.base.isNullOrUndefined(e.nextRenderedWidget)||e.nextRenderedWidget instanceof le&&e.bodyWidget.index!==e.nextRenderedWidget.bodyWidget.index)){var i=e.containerWidget.childWidgets.indexOf(e)+1;if(e.containerWidget instanceof ne)if(e.containerWidget.page.bodyWidgets.length>1)for(var r=e.containerWidget.indexInOwner,n=this.documentHelper.pages.indexOf(e.containerWidget.page);n<this.documentHelper.pages.length;n++){for(var o=this.documentHelper.pages[n],s=0;s<o.bodyWidgets.length;s++)if(o.bodyWidgets[s].indexInOwner===r){for(var a=i;a<o.bodyWidgets[s].childWidgets.length;a++){var l=o.bodyWidgets[s].childWidgets[a];this.updateIndex(l,t)}i=0,sf.base.isNullOrUndefined(o.bodyWidgets[s].nextRenderedWidget)||"NoBreak"===o.bodyWidgets[s].nextRenderedWidget.sectionFormat.breakCode||r++}r!==e.containerWidget.indexInOwner&&!sf.base.isNullOrUndefined(o.bodyWidgets[o.bodyWidgets.length-1].nextRenderedWidget)&&o.bodyWidgets[o.bodyWidgets.length-1].nextRenderedWidget.sectionFormat.columns.length>1&&(r=0)}else{var h=e.containerWidget.index;for(s=this.documentHelper.pages.indexOf(e.containerWidget.page);s<this.documentHelper.pages.length;s++){if((o=this.documentHelper.pages[s]).bodyWidgets[0].index!==h)return;for(a=i;a<o.bodyWidgets[0].childWidgets.length;a++){l=o.bodyWidgets[0].childWidgets[a];this.updateIndex(l,t)}i=0}}else if(e.containerWidget instanceof pe)for(var d=e.containerWidget.getSplitWidgets(),c=d.indexOf(e.containerWidget),p=c;p<d.length;p++){for(var u=d[p].childWidgets,g=i;g<u.length;g++)this.updateIndex(u[g],t);c=0,i=0}else if(e.containerWidget instanceof ce)for(n=i;n<e.containerWidget.childWidgets.length;n++){var f=e.containerWidget.childWidgets[n];f.rowIndex===e.containerWidget.index&&this.updateIndex(f,t)}else if(e.containerWidget instanceof de)for(n=i;n<e.containerWidget.childWidgets.length;n++){var m=e.containerWidget.childWidgets[n];this.updateIndex(m,t);for(s=0;s<m.childWidgets.length;s++)m.childWidgets[s].rowIndex=m.index}else if(e.containerWidget instanceof oe||e.containerWidget instanceof ze||e.containerWidget instanceof ae)for(n=i;n<e.containerWidget.childWidgets.length;n++){var y=e.containerWidget.childWidgets[n];this.updateIndex(y,t)}}},e.prototype.updateIndex=function(e,t){t?e.index++:e.index--},e.prototype.updateEndPosition=function(){var e=this.documentHelper.selection;this.editorHistory&&!sf.base.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)&&this.updateHistoryPosition(e.start,!1)},e.prototype.onBackSpace=function(){this.removeEditRange=!0;var e=this.documentHelper.selection;if(this.documentHelper.triggerSpellCheck=!0,e.bookmarks.length>0&&this.extendSelectionToBookmarkStart(),e.isEmpty)this.singleBackspace(e,!1);else{this.initHistory("BackSpace");var t=this.deleteSelectedContents(e,!0);this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&(t?this.editorHistory.currentBaseHistoryInfo=void 0:(this.checkEndPosition(e)&&this.updateHistoryPosition(e.end,!1),this.reLayout(e),this.insertSpaceInFormField())),this.documentHelper.triggerSpellCheck=!1}this.documentHelper.layout.islayoutFootnote=!1,this.removeEditRange=!1,this.updateXmlMappedContentControl()},e.prototype.insertRemoveBookMarkElements=function(){for(var e=!1,t=0;t<this.removedBookmarkElements.length;t++){var i=this.removedBookmarkElements[t];if(0===i.bookmarkType){this.documentHelper.bookmarks.containsKey(i.name)||this.documentHelper.bookmarks.add(i.name,i);var r=i;if(r&&r.reference&&-1!==this.removedBookmarkElements.indexOf(r.reference)){var n=this.removedBookmarkElements.indexOf(r.reference),o=this.removedBookmarkElements.indexOf(r);this.removedBookmarkElements.splice(n,1),this.removedBookmarkElements.splice(o,1),t--}else this.editorHistory.currentBaseHistoryInfo&&(this.initComplexHistory(this.editorHistory.currentBaseHistoryInfo.action),this.editorHistory.updateHistory()),this.initInsertInline(r.clone(),void 0,!0),this.editorHistory.currentHistoryInfo&&(this.editorHistory.updateComplexHistory(),e=!0)}else{var s=i;if(s&&s.reference&&-1!==this.removedBookmarkElements.indexOf(s.reference)){n=this.removedBookmarkElements.indexOf(s.reference),o=this.removedBookmarkElements.indexOf(s);this.removedBookmarkElements.splice(n,1),this.removedBookmarkElements.splice(o,1),t--}else this.editorHistory.currentBaseHistoryInfo&&(this.initComplexHistory(this.editorHistory.currentBaseHistoryInfo.action),this.editorHistory.updateHistory()),this.initInsertInline(s.clone(),void 0,!0),this.editorHistory.currentHistoryInfo&&(this.editorHistory.updateComplexHistory(),e=!0)}}return this.removedBookmarkElements=[],e},e.prototype.deleteSelectedContents=function(e,t){var i=this.deleteSelectedContentInternal(e,t,e.start,e.end),r=e.getTextPosBasedOnLogicalIndex(e.editPosition);return e.selectContent(r,!0),i},e.prototype.removeWholeElement=function(e){this.initHistory("BackSpace"),this.deleteSelectedContents(e,!0),this.checkEndPosition(e)&&this.updateHistoryPosition(e.end,!1),this.reLayout(e)},e.prototype.singleBackspace=function(e,t){var i=this.editorHistory;if(i&&!t&&!i.canRedo()&&i.canUndo()){var r=i.undoStack[i.undoStack.length-1],n=this.selection.getParagraphInfo(e.start),o=this.selection.getParagraphInfo(e.end);if("AutoFormatHyperlink"===r.action&&r.insertPosition===this.selection.getHierarchicalIndex(n.paragraph,n.offset.toString())&&r.endPosition===this.selection.getHierarchicalIndex(o.paragraph,o.offset.toString()))return void i.undo()}var s=!1,a=e.start.paragraph,l=e.start.currentWidget,h=e.start.offset,d=0,c=l.getInline(h,d),p=c.element;if(this.selection.isInlineFormFillMode()){if(p instanceof fe&&2===p.fieldType)return;if(1===this.getFieldResultText().length)return this.selection.selectFieldInternal(this.selection.getCurrentFormField()),this.insertTextInternal(this.documentHelper.textHelper.repeatChar(this.documentHelper.textHelper.getEnSpaceCharacter(),5),!0),void this.selection.selectTextElementStartOfField(this.selection.getCurrentFormField())}if(d=c.index,p instanceof we&&(p.ignoreOnceItems=[]),p instanceof we&&(p.ignoreOnceItems=[]),p instanceof fe&&2===p.fieldType&&x.isLinkedFieldCharacter(p)){var u=p.fieldBegin,g=p.fieldEnd;return u.nextNode instanceof Ce&&(g=u.nextNode.reference),e.start.setPositionParagraph(u.line,u.line.getOffset(u,0)),e.end.setPositionParagraph(g.line,g.line.getOffset(g,0)+1),void e.fireSelectionChanged(!0)}if(p instanceof Me&&("Footnote"===p.footnoteType?this.removeFootnote(p):this.removeEndnote(p)),p&&(p instanceof Oe||p.previousNode instanceof Oe)&&(p instanceof Oe&&p.previousNode&&!(p.previousElement instanceof je)&&(a=(p=p.previousNode).line.paragraph,h=p.line.getOffset(p,p.length)),p&&1===p.length&&p.nextNode instanceof Oe&&p.previousNode instanceof Oe)){var f=p.previousNode;g=p.nextNode;if(!f.contentControlProperties.lockContentControl)return e.start.setPositionParagraph(f.line,f.line.getOffset(f,0)),e.end.setPositionParagraph(g.line,g.line.getOffset(g,0)+1),void this.removeWholeElement(e)}if(p&&(p instanceof Ce||p.previousNode instanceof Ce)){if(p instanceof Ce&&1===p.bookmarkType){if(p.previousNode)a=(p=p.previousNode).line.paragraph,h=p.line.getOffset(p,p.length);else if(a.previousRenderedWidget instanceof le){var m=a.previousRenderedWidget.lastChild;return e.start.setPositionParagraph(p.line,p.line.getOffset(p,0)),e.end.setPositionParagraph(m,m.getEndOffset()),void this.removeWholeElement(e)}}else if(p.nextNode instanceof Ce&&p instanceof Ce&&0===p.bookmarkType&&p.reference===p.nextNode)return void this.deleteBookmark(p.name);if(1===p.length&&p.nextNode instanceof Ce&&p.previousNode instanceof Ce){u=p.previousNode,g=p.nextNode;return e.start.setPositionParagraph(u.line,u.line.getOffset(u,0)),e.end.setPositionParagraph(g.line,g.line.getOffset(g,0)+1),void this.removeWholeElement(e)}}if(p instanceof nt&&1===p.commentType){var y=p.comment;for(y.isReply&&(y=y.ownerComment);p instanceof nt;)p=p.previousNode;this.deleteCommentInternal(y),a=p.line.paragraph,h=p.line.getOffset(p,p.length),e.start.setPositionParagraph(p.line,h),e.end.setPositionParagraph(p.line,h),s=!0}if(p instanceof fe&&1===p.fieldType&&!this.selection.isInlineFormFillMode()){var v=e.getPreviousValidElement(p);if(v instanceof fe){if(a=(p=v.fieldBegin).line.paragraph,h=p.line.getOffset(p,0),p.nextNode instanceof Ce){f=p.nextNode.reference;e.start.setPositionParagraph(f.line,f.line.getOffset(f,0))}return e.end.setPositionParagraph(p.line,h),void e.fireSelectionChanged(!0)}v!==p&&(a=(p=v).line.paragraph,h=p.line.getOffset(p,p.length))}if(p instanceof He||p instanceof Ue){if(p.nextNode instanceof Ue&&p.editRangeEnd===p.nextNode||p.previousNode instanceof He&&p.editRangeStart===p.previousNode)return;if(p instanceof He&&!(p.previousNode instanceof Ue))return;if(p instanceof Ue&&(sf.base.isNullOrUndefined(p.previousNode)||(a=(p=p.previousNode).line.paragraph,h=p.line.getOffset(p,p.length))),1===p.length&&p.nextNode instanceof Ue&&p.previousNode instanceof He){f=p.previousNode,g=p.nextNode;return e.start.setPositionParagraph(f.line,f.line.getOffset(f,0)),e.end.setPositionParagraph(g.line,g.line.getOffset(g,0)+1),void this.removeWholeElement(e)}}if(t||this.initHistory("BackSpace"),h===e.getStartOffset(a)&&e.start.currentWidget.isFirstLine()){if(a.paragraphFormat.listFormat&&-1!==a.paragraphFormat.listFormat.listId)return void this.onApplyList(void 0);if(0!==a.paragraphFormat.firstLineIndent)return void this.onApplyParagraphFormat("firstLineIndent",0,!1,!1);if(0!==a.paragraphFormat.leftIndent)return void this.onApplyParagraphFormat("leftIndent",0,!1,!1);if(!a.paragraphFormat.bidi&&"Left"!==a.paragraphFormat.textAlignment)return void this.onApplyParagraphFormat("textAlignment","Left",!1,!0);if(a.previousRenderedWidget instanceof le){e.owner.isShiftingEnabled=!0;var b=a.previousRenderedWidget;if(this.owner.enableTrackChanges&&null!=a.previousRenderedWidget&&0==a.previousRenderedWidget.characterFormat.revisions.length)if(this.checkToMatchEmptyParaMarkBack(b)){w=this.documentHelper.selection.getLineLength(b.lastChild),M=b.childWidgets.length-1;this.documentHelper.layout.reLayoutParagraph(b,M,0),e.selects(b.childWidgets[M],w,!0),this.addRemovedNodes(a)}else{this.insertRevision(b.characterFormat,"Deletion");var w=this.documentHelper.selection.getLineLength(b.lastChild),M=b.childWidgets.length-1;this.documentHelper.layout.reLayoutParagraph(b,M,0),e.selects(b.childWidgets[M],w,!0),this.addRemovedNodes(a)}else if(b.isEmpty()&&!this.owner.enableTrackChanges)if(this.removePrevParaMarkRevision(a),a!==a.bodyWidget.lastChild||b.bodyWidget.index===a.bodyWidget.index)this.removeBlock(b),this.addRemovedNodes(b);else{w=this.documentHelper.selection.getLineLength(b.lastChild),M=b.childWidgets.length-1;e.selects(b.childWidgets[M],w,!0)}else if(this.owner.enableTrackChanges&&null!=b.characterFormat.revisions&&"Deletion"==b.characterFormat.revisions[0].revisionType){w=this.documentHelper.selection.getLineLength(b.lastChild),M=b.childWidgets.length-1;this.documentHelper.layout.reLayoutParagraph(b,M,0),e.selects(b.childWidgets[M],w,!0),this.addRemovedNodes(a)}else{this.removePrevParaMarkRevision(a);var N=!1;a===a.bodyWidget.lastChild&&b.bodyWidget.index!==a.bodyWidget.index||(this.removeBlock(a,!1,!0),N=!0);w=this.documentHelper.selection.getLineLength(b.lastChild),M=b.childWidgets.length-1;var I=void 0;if(!a.isEmpty()&&N)for(var S=0;S<a.childWidgets.length;S++){I=a.childWidgets[S],b.childWidgets.push(I);for(var C=0;C<I.children.length;C++){if(I.children[C]instanceof Me)if(-1===this.documentHelper.footnoteCollection.indexOf(I.children[C])){I.children[C].isLayout=!1;var O=parseInt(I.children[C].text);this.documentHelper.footnoteCollection.splice(O-1,0,I.children[C])}}a.childWidgets.splice(S,1),S--,I.paragraph=b}this.documentHelper.layout.reLayoutParagraph(b,M,0),e.selects(b.childWidgets[M],w,!0),N&&this.addRemovedNodes(a)}if(this.setPositionForHistory(),this.documentHelper.layout.getFootNoteWidgetsOf(a).length>0){var T=this.documentHelper.layout,P=a.bodyWidget;T.layoutfootNote(P.page.footnoteWidget)}this.reLayout(e)}else this.editorHistory&&(this.editorHistory.currentBaseHistoryInfo=void 0)}else{t||(e.owner.isShiftingEnabled=!0);var A=this.selection.getParagraphInfo(e.start),L=e.getLineInfoBasedOnParagraph(a,A.offset),F=h-1;F<0&&(L.line=L.line.previousLine,F=this.documentHelper.selection.getLineLength(L.line)+F),this.removeAtOffset(L.line,e,F),this.setPositionParagraph(A.paragraph,A.offset-1,!1),this.setPositionForHistory(),t?this.fireContentChange():(this.reLayout(e),s&&(this.owner.editorHistory.undoStack[this.owner.editorHistory.undoStack.length-2].modifiedActions.push(this.owner.editorHistory.undoStack[this.owner.editorHistory.undoStack.length-1]),this.owner.editorHistory.undoStack.splice(this.owner.editorHistory.undoStack.length-1,1),s=!1))}},e.prototype.setPositionForHistory=function(e){var t=this.documentHelper.selection;this.editorHistory&&!sf.base.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)&&(sf.base.isNullOrUndefined(e)?(this.updateHistoryPosition(t.start,!0),this.editorHistory.currentBaseHistoryInfo.endPosition=this.editorHistory.currentBaseHistoryInfo.insertPosition):(this.editorHistory.currentBaseHistoryInfo.insertPosition=e,this.editorHistory.currentBaseHistoryInfo.endPosition=e))},e.prototype.removeAtOffset=function(e,t,i){for(var r=0,n=e.paragraph.childWidgets.indexOf(e),o=e.children.length,s=0;s<o;s++){var a=e.children[s];if(!(a instanceof je)){if(this.removeCharacter(a,i,r,e,n,s))break;r+=a.length}}},e.prototype.removeCharacter=function(e,t,i,r,n,o,s){var a=!1;if(e instanceof Ce&&e.line!==e.reference.line&&!(r.children[o]instanceof Ce))return sf.base.isNullOrUndefined(e.line.previousLine)?sf.base.isNullOrUndefined(e.line.paragraph.previousRenderedWidget)?sf.base.isNullOrUndefined(e.line.paragraph.nextRenderedWidget)||(e.line.paragraph.nextRenderedWidget.firstChild.children.splice(e.line.paragraph.nextRenderedWidget.firstChild.children.length,0,e),e.line=e.line.paragraph.nextRenderedWidget.firstChild):(e.line.paragraph.previousRenderedWidget.lastChild.children.splice(e.line.paragraph.previousRenderedWidget.lastChild.children.length,0,e),e.line=e.line.paragraph.previousRenderedWidget.lastChild):(e.line.previousLine.children.splice(e.line.previousLine.children.length,0,e),e.line=e.line.previousLine),r.children.splice(o,1),!0;if(t<i+e.length){var l=t-i;if(e.ischangeDetected=!0,this.owner.isSpellCheck&&this.owner.spellChecker.removeErrorsFromCollection({element:e,text:e.text}),e.canTrigger||(this.documentHelper.triggerSpellCheck=!1),t===i&&1===e.length)this.owner.enableTrackChanges&&!this.skipTracking()?(this.addRemovedNodes(e.clone()),this.handleDeleteTracking(e,l,1,o)):(this.unLinkFieldCharacter(e),this.unlinkRangeFromRevision(e,!0),this.addRemovedRevisionInfo(e,void 0),this.addRemovedNodes(e),r.children.splice(o,1)),this.documentHelper.layout.reLayoutParagraph(r.paragraph,n,o,void 0,s);else{var h=this.handleDeleteTracking(e,l,1);this.documentHelper.layout.reLayoutParagraph(r.paragraph,n,o,void 0,s),sf.base.isNullOrUndefined(h)||(e.revisions.length>0&&this.addRemovedRevisionInfo(e,h),this.addRemovedNodes(h))}a=!0}return a},e.prototype.removeCharacterInLine=function(e,t,i){var r=new we;if(e instanceof we){r.characterFormat.copyFormat(e.characterFormat);var n=1===i?1:i-t;r.text=e.text.substr(t,n);var o=e.text;e.text=o.substring(0,t)+o.substring(t+n,o.length),e.contentControlProperties&&(r.contentControlProperties=e.contentControlProperties.clone())}return r},e.prototype.removeRevisionsInformation=function(e,t,i,r){var n=e.previousElement;"Insertion"===this.retrieveRevisionInOder(n).revisionType&&this.isRevisionMatched(n,void 0)&&e.line.children.splice(r,1)},e.prototype.handleDeleteTracking=function(e,t,i,r,n,o){var s=this.owner.enableTrackChanges,a=(!sf.base.isNullOrUndefined(this.editorHistory)&&(this.editorHistory.isUndoing||this.editorHistory.isRedoing),void 0);if(this.canHandleDeletion()||s&&!this.skipTracking()){if(e instanceof Ce||e instanceof nt||e instanceof He||e instanceof Ue)return void(e instanceof Ce&&e.previousElement instanceof fe&&e.previousElement.formFieldData?e.previousElement.revisions.length>0&&this.removeRevisionsInformation(e,t,i,r):s&&e instanceof Ce?(this.checkToCombineRevisionsInSides(e,"Deletion")||this.insertRevision(e,"Deletion"),this.updateLastElementRevision(e)):e.line.children.splice(e.indexInOwner,1));var l=!1;if(this.owner.editorHistory&&(l=!sf.base.isNullOrUndefined(this.owner.editorHistory.currentBaseHistoryInfo)&&"Delete"===this.owner.editorHistory.currentBaseHistoryInfo.action),this.skipTableElements||this.updateEndRevisionIndex(),e.revisions.length>0){var h=this.retrieveRevisionInOder(e),d=this.owner.revisions.changes.indexOf(h);if("Insertion"===h.revisionType)if(this.isRevisionMatched(e,void 0))if(sf.base.isNullOrUndefined(r))a=this.removeCharacterInLine(e,t,i);else{var c=h.range.indexOf(e);h.range.splice(c,1),0===h.range.length&&this.owner.revisionsInternal.remove(h),this.unLinkFieldCharacter(e),e.line.children.splice(r,1)}else if(sf.base.isNullOrUndefined(r)){var p=this.removeCharacterInLine(e,t,i);if(0===t){var u=e.previousElement;this.handleDeletionForInsertRevision(u,e,p,i,t,!0)}else if(e.length!==t)for(var g=e.revisions.length-1;g>=0;g--){var f=e.revisions[g],m=f.range.indexOf(e),y=new we;y.characterFormat.copyFormat(e.characterFormat),y.line=e.line,y.text=e.text.substr(t),y.revisions.splice(0,0,f),f.range.splice(m+1,0,y),p.revisions.splice(0,0,f),p.line=e.line,f.range.splice(m+1,0,p),e.text=e.text.substr(0,t);var v=e.indexInOwner;e.line.children.splice(v+1,0,y),e.line.children.splice(v+1,0,p),this.addRemovedNodes(p.clone()),this.insertRevision(p,"Deletion"),this.updateLastElementRevision(p)}else if(e.length===t){var b=e.nextElement;this.handleDeletionForInsertRevision(b,e,p,i,t,!1)}else 1===i?l||(this.selection.start.movePreviousPosition(),this.selection.end.setPositionInternal(this.selection.start)):this.updateCursorForInsertRevision(e,t,i),this.addRemovedNodes(p.clone()),this.insertInlineInternal(p,"Deletion")}else this.checkToCombineRevisionsInSides(e,"Deletion")||this.insertRevision(e,"Deletion"),this.updateLastElementRevision(e);else if("Deletion"===h.revisionType){if(-1!==d&&h.author!==this.owner.currentUser){var w=h.range,x=w[0].line.getOffset(w[0],0),M=w[w.length-1],N=M.line.getOffset(M,M.length);x===t&&N===i&&(e.revisions.splice(e.revisions.indexOf(h),1),this.checkToCombineRevisionsInSides(e,"Deletion")?this.combineElementRevision(e.revisions,e.revisions):(this.insertRevision(e,"Deletion"),this.updateLastElementRevision(e)),e.line.getOffset(e,0)===x&&this.owner.revisions.changes.splice(d,1))}if(1===i)l?(this.selection.start.moveNextPosition(),this.selection.end.setPositionInternal(this.selection.start)):(this.selection.start.movePreviousPosition(),this.selection.end.setPositionInternal(this.selection.start));else if(this.isRevisionMatched(e,"Deletion"))this.updateCursorForInsertRevision(e,t,i);else{var I=h.range.indexOf(e);(N=e.line.getOffset(e,e.length))>=i&&h.range.length>I+1?(this.updateRevisionForSpittedTextElement(e,h.range[I+1]),h.range.splice(h.range.indexOf(e),1),this.toCombineOrInsertRevision(e,"Deletion")):1===h.range.length||0===t?(this.handleDeleteBySplitting(e,t,i),-1!==I&&1!==h.range.length&&(this.updateRevisionForSpittedTextElement(h.range[I-1],h.range[I]),h.range.splice(h.range.indexOf(e),1))):(h.range.splice(h.range.indexOf(e),1),this.toCombineOrInsertRevision(e,"Deletion"))}this.updateLastElementRevision(e)}}else sf.base.isNullOrUndefined(r)?this.handleDeleteBySplitting(e,t,i):(this.checkToCombineRevisionsInSides(e,"Deletion")||this.insertRevision(e,"Deletion"),this.updateLastElementRevision(e))}else a=this.removeCharacterInLine(e,t,i);return a},e.prototype.toCombineOrInsertRevision=function(e,t){this.checkToCombineRevisionsInSides(e,t)?this.combineElementRevision(e.revisions,e.revisions):(this.insertRevision(e,t),this.updateLastElementRevision(e))},e.prototype.updateLastElementRevision=function(e){this.skipTableElements||!this.editorHistory||!this.editorHistory.currentBaseHistoryInfo||this.skipReplace||!sf.base.isNullOrUndefined(this.owner.search)&&this.owner.search.isRepalceTracking||sf.base.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo.lastElementRevision)&&(this.editorHistory.currentBaseHistoryInfo.lastElementRevision=e,e.isMarkedForRevision=!0)},e.prototype.updateEndRevisionIndex=function(){if(!sf.base.isNullOrUndefined(this.editorHistory.undoStack)&&this.editorHistory.undoStack.length>0){var e=this.editorHistory.undoStack[this.editorHistory.undoStack.length-1];e.lastElementRevision&&sf.base.isNullOrUndefined(e.endRevisionLogicalIndex)&&e.updateEndRevisionInfo()}},e.prototype.retrieveRevisionInOder=function(e){if(1===e.revisions.length)return e.revisions[0];for(var t=0;t<e.revisions.length;t++)if("Deletion"===e.revisions[t].revisionType)return e.revisions[t];return e.revisions[e.revisions.length-1]},e.prototype.handleDeletionForInsertRevision=function(e,t,i,r,n,o){if(!sf.base.isNullOrUndefined(e)&&0===t.revisions.length&&this.isRevisionMatched(e,"Deletion"))this.addRemovedNodes(i.clone()),this.insertTextInline(e,this.selection,i.text,0);else{var s=t.revisions[t.revisions.length-1],a=s.range.indexOf(t);s.range.splice(o?a:a+1,0,i),i.revisions.splice(0,0,s);var l=!1;this.owner.editorHistory&&(l=!sf.base.isNullOrUndefined(this.owner.editorHistory.currentBaseHistoryInfo)&&"Delete"===this.owner.editorHistory.currentBaseHistoryInfo.action),1!==r||l?this.updateCursorForInsertRevision(t,n,r):(this.selection.start.movePreviousPosition(),this.selection.end.setPositionInternal(this.selection.start)),this.addRemovedNodes(i.clone()),this.insertInlineInternal(i,"Deletion")}},e.prototype.handleDeleteBySplitting=function(e,t,i){var r=!1;if(this.owner.editorHistory&&(r=!sf.base.isNullOrUndefined(this.owner.editorHistory.currentBaseHistoryInfo)&&"Delete"===this.owner.editorHistory.currentBaseHistoryInfo.action),1===i){var n=e.line.getOffset(e,0);if(n>0){var o=new Ft(this.owner);o.setPositionForLineWidget(e.line,n+t),this.selection.start.setPositionInternal(o),this.selection.end.setPositionInternal(this.selection.start)}else r||(this.selection.start.movePreviousPosition(),this.selection.end.setPositionInternal(this.selection.start))}else this.updateCursorForInsertRevision(e,t,i);var s=this.removeCharacterInLine(e,t,i);this.addRemovedNodes(s.clone()),this.insertTextInternal(s.text,!1,"Deletion")},e.prototype.updateCursorForInsertRevision=function(e,t,i){var r=e.line.getOffset(e,0);r>0&&(t=r+t,i=r+i);var n=new Ft(this.owner);n.setPositionFromLine(e.line,t);var o=new Ft(this.owner);o.setPositionFromLine(e.line,i),n.isExistBefore(o)?(this.selection.end.setPositionInternal(n),this.selection.start.setPositionInternal(n)):(this.selection.start.setPositionInternal(o),this.selection.end.setPositionInternal(o))},e.prototype.checkToCombineRevisionsInSides=function(e,t){var i,r=e.previousNode,n=e.nextNode,o=!1;sf.base.isNullOrUndefined(r)||(r instanceof Ce||(r=r.previousValidNodeForTracking),sf.base.isNullOrUndefined(r)||(i=this.getMatchedRevisionsToCombine(r.revisions,t)).length>0&&(this.mapMatchedRevisions(i,r,e,!1),o=!0));sf.base.isNullOrUndefined(n)||(n instanceof Ce||(n=n.nextValidNodeForTracking),sf.base.isNullOrUndefined(n)||(i=this.getMatchedRevisionsToCombine(n.revisions,t)).length>0&&(o?this.combineElementRevision(e.revisions,n.revisions):this.mapMatchedRevisions(i,n,e,!0),o=!0));return o},e.prototype.delete=function(){this.removeEditRange=!0;var e=this.documentHelper.selection;if(e.bookmarks.length>0&&this.extendSelectionToBookmarkStart(),e.isEmpty)this.singleDelete(e,!1);else{this.initHistory("Delete"),this.deleteSelectedContentInternal(e,!1,e.start,e.end);var t=new Ft(e.owner);this.setPositionForCurrentIndex(t,e.editPosition),e.selectContent(t,!0),this.reLayout(e),this.insertSpaceInFormField()}this.documentHelper.layout.islayoutFootnote=!1,this.removeEditRange=!1,this.updateXmlMappedContentControl()},e.prototype.deleteEditElement=function(e){this.initHistory("Delete"),this.deleteSelectedContentInternal(e,!1,e.start,e.end);var t=new Ft(e.owner);this.setPositionForCurrentIndex(t,e.editPosition),e.selectContent(t,!0),this.reLayout(e)},e.prototype.removeContentControlMark=function(e,t){return!e.contentControlProperties.lockContentControl&&(this.selection.start.setPositionParagraph(e.line,e.line.getOffset(e,0)),this.selection.end.setPositionParagraph(t.line,t.line.getOffset(t,0)+1),this.deleteEditElement(this.selection),!0)},e.prototype.singleDelete=function(e,t){var i=e.start.currentWidget,r=e.start.paragraph,n=e.start.offset,o=0,s=i.getInline(e.start.offset,o),a=s.element;if(this.selection.isInlineFormFillMode()){if(a instanceof fe&&1===a.fieldType)return;var l=this.getFieldResultText();if(a instanceof we||(a=a.nextElement),1===l.length&&a instanceof we)return this.selection.selectFieldInternal(this.selection.getCurrentFormField()),this.insertTextInternal(this.documentHelper.textHelper.repeatChar(this.documentHelper.textHelper.getEnSpaceCharacter(),5),!0),void this.selection.selectTextElementStartOfField(this.selection.getCurrentFormField());if(a instanceof fe&&1===a.fieldType)return}if(o=s.index,r.paragraphFormat.listFormat&&-1!==r.paragraphFormat.listFormat.listId&&this.documentHelper.isListTextSelected&&"List"===e.contextType)this.onApplyList(void 0);else{if(!sf.base.isNullOrUndefined(a)&&o===a.length&&!sf.base.isNullOrUndefined(a.nextNode)){if((a=a.nextNode)instanceof fe&&1===a.fieldType&&!sf.base.isNullOrUndefined(a.fieldBegin.formFieldData))return;if(a instanceof Me)return;o=0}for(var h=a instanceof nt;a instanceof nt;){if(!a.nextNode){o=1;break}a=a.nextNode,o=0}if(h&&(r=a.line.paragraph,n=a.line.getOffset(a,o),e.start.setPositionParagraph(a.line,n),e.end.setPositionParagraph(a.line,n)),a instanceof Me&&("Footnote"===a.footnoteType?this.removeFootnote(a):this.removeEndnote(a)),!sf.base.isNullOrUndefined(a)){var d=void 0,c=e.getNextValidElement(a);if(c instanceof ge&&(d=c),!sf.base.isNullOrUndefined(d)&&d instanceof fe&&0===d.fieldType)return r=(a=d.fieldEnd).line.paragraph,n=a.line.getOffset(a,1),e.end.setPositionParagraph(a.line,n),void e.fireSelectionChanged(!0);a!==d&&(r=(a=d).line.paragraph,n=a.line.getOffset(a,0),a instanceof fe&&1===a.fieldType&&n++)}if(a instanceof He||a instanceof Ue){if(a.nextNode instanceof Ue&&a.editRangeEnd===a.nextNode||a.previousNode instanceof He&&a.editRangeStart===a.previousNode)return;if(this.documentHelper.isDocumentProtected&&"ReadOnly"===this.documentHelper.protectionType){if(a instanceof He||a instanceof Ue)return}else a instanceof He?(n=(a=a.nextNode).line.getOffset(a,0),r=a.line.paragraph):a instanceof Ue&&n++;if(1===a.length&&a.nextNode instanceof Ue&&a.previousNode instanceof He){var p=a.previousNode,u=a.nextNode;return e.start.setPositionParagraph(p.line,p.line.getOffset(p,0)),e.end.setPositionParagraph(u.line,u.line.getOffset(u,0)+1),void this.deleteEditElement(e)}}if(a&&(a instanceof Oe||a.nextNode instanceof Oe)){if(a instanceof Oe&&a.nextNode)return r=(a=a.nextNode).line.paragraph,n=a.line.getOffset(a,0),e.start.setPositionParagraph(a.line,n),void e.end.setPositionParagraph(a.line,n);if(a&&1===a.length&&a.nextNode instanceof Oe&&a.previousNode instanceof Oe&&this.removeContentControlMark(a.previousNode,a.nextNode))return;if(a instanceof Oe&&a.previousNode instanceof Oe&&a.previousNode.reference===a&&this.removeContentControlMark(a.previousNode,a))return}if(a&&(a instanceof Ce&&0===a.bookmarkType||a.nextNode instanceof Ce)){if(a.nextNode&&a instanceof Ce&&(r=(a=a.nextNode).line.paragraph,n=a.line.getOffset(a,0),e.start.setPositionParagraph(a.line,n),e.end.setPositionParagraph(a.line,n)),1===a.length&&a.nextNode instanceof Ce&&a.previousNode instanceof Ce){var g=a.previousNode,f=a.nextNode;return e.start.setPositionParagraph(g.line,g.line.getOffset(g,0)),e.end.setPositionParagraph(f.line,f.line.getOffset(f,0)+1),void this.deleteEditElement(e)}a instanceof Ce&&(n=a.line.getOffset(a,1))}if(e.start.currentWidget.isLastLine()&&n===this.documentHelper.selection.getLineLength(e.start.currentWidget)){if(r.isInsideTable&&sf.base.isNullOrUndefined(r.nextWidget))return;var m=void 0,y=e.getNextParagraphBlock(r);if(sf.base.isNullOrUndefined(y)){if(n>0)return;if(r.previousWidget instanceof le&&(m=r.previousWidget),r.previousWidget instanceof ae)return;if(r.previousWidget instanceof de)return;if(sf.base.isNullOrUndefined(m))return}if(t||this.initHistory("Delete"),r.isEndsWithPageBreak||r.isEndsWithColumnBreak){var v=r.lastChild,b=v.children[v.children.length-1];this.selection.start.setPositionForSelection(v,b,0,this.selection.start.location)}var w=this.selection.getParagraphInfo(e.start);if(e.editPosition=this.selection.getHierarchicalIndex(w.paragraph,w.offset.toString()),this.checkInsertPosition(e)&&this.setPositionForHistory(e.editPosition),e.owner.isShiftingEnabled=!0,r.isEmpty())if(this.removePrevParaMarkRevision(r,!0),this.removeBlock(r,!1,!0),this.addRemovedNodes(r),sf.base.isNullOrUndefined(y))if(sf.base.isNullOrUndefined(m)){var x=e.getParagraphLength(void 0)+1;this.editorHistory&&!sf.base.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)&&(this.updateHistoryPosition(e.start,!0),this.editorHistory.currentBaseHistoryInfo.endPosition=this.selection.getHierarchicalIndex(void 0,x.toString()))}else e.selectParagraphInternal(m,!1),this.setPositionForHistory();else e.selectParagraphInternal(y,!0);else if(this.owner.enableTrackChanges&&r.nextRenderedWidget instanceof le){var M=r.nextRenderedWidget,N=M.childWidgets.length-1;r=r.combineWidget(this.owner.viewer);var I=this.splitParagraph(r,r.firstChild,0,e.start.currentWidget,e.start.offset,!0);null!=r&&0!=r.characterFormat.revisions.length&&"Insertion"==r.characterFormat.revisions[0].revisionType?(this.removePrevParaMarkRevision(r,!0),this.deleteParagraphMark(I,e,0),this.addRemovedNodes(r),this.setPositionForCurrentIndex(e.start,e.editPosition),e.selectContent(e.start,!0)):(this.removePrevParaMarkRevision(r,!0),this.deleteParagraphMark(I,e,0,!0),this.addRemovedNodes(r),this.setPositionForCurrentIndex(e.start,e.editPosition),e.selects(M.childWidgets[N],0,!0))}else{r=r.combineWidget(this.owner.viewer);I=this.splitParagraph(r,r.firstChild,0,e.start.currentWidget,e.start.offset,!0);this.removePrevParaMarkRevision(r,!0),this.deleteParagraphMark(I,e,0),this.addRemovedNodes(r),this.setPositionForCurrentIndex(e.start,e.editPosition),e.selectContent(e.start,!0)}this.reLayout(e)}else this.singleDeleteInternal(e,t,r);e.start.currentWidget.getInline(e.start.offset+1,0).element instanceof Ce&&(e.start.offset++,e.end.offset++)}},e.prototype.singleDeleteInternal=function(e,t,i){t||(e.owner.isShiftingEnabled=!0,this.initHistory("Delete")),this.checkInsertPosition(e)&&(this.updateHistoryPosition(e.start,!0),this.editorHistory.currentBaseHistoryInfo.endPosition=this.editorHistory.currentBaseHistoryInfo.insertPosition);var r=this.selection.getParagraphInfo(e.start),n=e.start.currentWidget,o=e.start.offset,s=e.getLineLength(e.start.currentWidget);o>=s&&(n=n.nextLine,o-=s),this.removeAtOffset(n,e,o),this.owner.enableTrackChanges&&!sf.base.isNullOrUndefined(this.editorHistory)&&this.editorHistory.currentBaseHistoryInfo&&"Delete"===this.editorHistory.currentBaseHistoryInfo.action&&s!==e.getLineLength(e.start.currentWidget)?this.setPositionParagraph(r.paragraph,r.offset,!1):this.owner.enableTrackChanges&&!this.skipTracking()?this.setPositionParagraph(r.paragraph,r.offset+1,!1):this.setPositionParagraph(r.paragraph,r.offset,!1),t?this.fireContentChange():this.reLayout(e)},e.prototype.deleteParagraphMark=function(e,t,i,r,n){if(!sf.base.isNullOrUndefined(e.containerWidget)){e=e.combineWidget(this.owner.viewer);var o=t.getNextParagraphBlock(e);if(!(e.isInsideTable&&sf.base.isNullOrUndefined(e.nextWidget)||sf.base.isNullOrUndefined(o))){e.containerWidget instanceof ne&&e.containerWidget;var s=void 0;if(s=t.getNextRenderedBlock(e)instanceof de?t.getNextRenderedBlock(e):void 0,o.isInsideTable&&!sf.base.isNullOrUndefined(s)&&s.contains(o.associatedCell)){if(i<4){var a=0;this.removeBlock(e),this.documentHelper.layout.clearListElementBox(o),this.documentHelper.layout.clearListElementBox(e);for(var l=e.childWidgets.length-1;l>=0;l--)for(var h=e.childWidgets[l],d=h.children.length-1;d>=0;d--){var c=h.children[d];a+=c.length,o.firstChild.children.unshift(c),c.line=o.firstChild}this.documentHelper.layout.reLayoutParagraph(o,0,0),a>0&&(t.editPosition=this.selection.getHierarchicalIndex(o,a.toString()))}}else if(i<4){e.childWidgets.length;var p=o.getSplitWidgets();if(o=o.combineWidget(this.owner.viewer),this.documentHelper.layout.clearListElementBox(o),this.documentHelper.layout.clearListElementBox(e),this.updateEditPositionOnMerge(e,o),!(!sf.base.isNullOrUndefined(r)&&r)||this.handleDeleteParaMark(e,p[0])){var u=e.childWidgets.length-1;for(e.childWidgets[u].children.length,l=0;l<o.childWidgets.length;l++){var g=o.childWidgets[l];if(o.characterFormat.revisions.length>0)for(var f=0;f<o.characterFormat.revisions.length;f++){for(d=0;d<o.characterFormat.revisions[f].range.length;d++)o.characterFormat.revisions[f].range[d].ownerBase=e;e.characterFormat.revisions.push(o.characterFormat.revisions[f])}o.childWidgets.splice(l,1),e.childWidgets.push(g),g.paragraph=e,l--}o.bodyWidget.index!==e.bodyWidget.index&&this.deleteSection(t,e.bodyWidget,o.bodyWidget,i),0===o.childWidgets.length&&o.childWidgets.push(new ue(o)),this.documentHelper.layout.reLayoutParagraph(e,0,0),this.removeBlock(o),"Insert"!==this.editorHistory.currentBaseHistoryInfo.action&&this.addRemovedNodes(o,n)}}}}},e.prototype.handleDeleteParaMark=function(e,t){if(!this.owner.enableTrackChanges&&e.characterFormat.revisions.length>0)for(var i=0;i<e.characterFormat.revisions.length;i++){var r=e.characterFormat.revisions[i],n=r.range.indexOf(e.characterFormat);return r.range.splice(n,1),0===r.range.length&&this.owner.revisions.remove(r),!0}if(this.owner.enableTrackChanges){var o=!1;if(e.characterFormat.revisions.length>0){var s=this.retrieveRevisionByType(e.characterFormat,"Deletion");if(!sf.base.isNullOrUndefined(s)&&this.isRevisionMatched(s,"Deletion")){var a=e.characterFormat.revisions.indexOf(s);e.characterFormat.revisions.splice(a,1),s.range.splice(s.range.indexOf(e.characterFormat),1),0===s.range.length&&this.owner.revisions.remove(s),o=!0}var l=this.retrieveRevisionByType(e.characterFormat,"Insertion");if(!sf.base.isNullOrUndefined(l)&&this.isRevisionMatched(e.characterFormat,"Insertion")){n=l.range.indexOf(e.characterFormat);l.range.splice(n,1),0===l.range.length&&this.owner.revisions.remove(l),o=!0}return!!o||(this.applyRevisionForParaMark(e,t.firstChild,"Deletion",!1),!1)}return this.applyRevisionForParaMark(e,t.firstChild,"Deletion",!1),!1}return!0},e.prototype.insertDeleteParaMarkRevision=function(e,t){var i=e.lastChild,r=i.children.length>0?i.children[i.children.length-1].previousValidNodeForTracking:void 0;if(!sf.base.isNullOrUndefined(r)){var n=this.getMatchedRevisionsToCombine(r.revisions,"Deletion");n.length>0&&this.mapMatchedRevisions(n,r,e.characterFormat,!1)}t.firstChild.children[0].nextValidNodeForTracking},e.prototype.retrieveRevisionByType=function(e,t){for(var i=0;i<e.revisions.length;i++)if(e.revisions[i].revisionType===t)return e.revisions[i]},e.prototype.combineRevisionOnDeleteParaMark=function(e,t,i){var r=e.childWidgets[t].children[i],n=r.nextNode;n=n.nextValidNodeForTracking,r=r.nextValidNodeForTracking,n.revisions.length>0&&r.revisions.length>0&&this.combineElementRevisions(r,n)},e.prototype.updateEditPositionOnMerge=function(e,t){this.documentHelper.selection.editPosition===this.selection.getHierarchicalIndex(t,"0")&&void 0===t.nextRenderedWidget&&(this.documentHelper.selection.editPosition=this.selection.getHierarchicalIndex(e,this.documentHelper.selection.getLineLength(e.lastChild).toString()))},e.prototype.checkEndPosition=function(e){return this.editorHistory&&!sf.base.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)&&sf.base.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo.endPosition)},e.prototype.checkInsertPosition=function(e){return this.editorHistory&&!sf.base.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)&&sf.base.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo.insertPosition)},e.prototype.checkIsNotRedoing=function(){return this.documentHelper.owner.enableHistoryMode&&!this.editorHistory.isRedoing},e.prototype.deleteSelectedContentInternal=function(e,t,i,r){var n=i,o=r;i.isExistBefore(r)||(n=r,o=i);var s=this.selection.getParagraphInfo(n);e.editPosition=this.selection.getHierarchicalIndex(s.paragraph,s.offset.toString());var a=!1;if(t&&n.isInSameParagraph(o)){if(n.offset<o.offset&&n.offset===e.getParagraphLength(o.paragraph))a=e.getNextRenderedBlock(n.paragraph)instanceof de;!(1===o.offset&&o.offset>e.getParagraphLength(o.paragraph))||o.paragraph.isInsideTable&&sf.base.isNullOrUndefined(o.paragraph.nextWidget)||(t=!1)}if(!a){e.owner.isShiftingEnabled=!0,this.checkInsertPosition(e)&&(this.editorHistory.currentBaseHistoryInfo.insertPosition=e.editPosition);var l=t?1:0;this.deleteSelectedContent(o.paragraph,e,n,o,l)}return a},e.prototype.initHistory=function(e){this.documentHelper.owner.enableHistoryMode&&this.editorHistory.initializeHistory(e)},e.prototype.initComplexHistory=function(e){this.documentHelper.owner.enableHistoryMode&&this.editorHistory.initComplexHistory(this.documentHelper.selection,e)},e.prototype.insertPicture=function(e,t,i,r){var n=new Re(!0);".svg"===x.formatClippedString(e).extension?(n.metaFileImageString=e,n.isMetaFile=!0,this.generateFallBackImage(e,t,i,n)):(n.imageString=e,n.element.crossOrigin="Anonymous"),n.width=t,n.height=i,n.textWrappingStyle="Inline",this.insertPictureInternal(n,r)},e.prototype.generateFallBackImage=function(e,t,i,r){var n=new Image;n.onload=function(){var e=Math.max(1,window.devicePixelRatio||1),o=document.createElement("canvas");o.width=t*e,o.height=i*e;var s=o.getContext("2d");s.scale(e,e),s.drawImage(n,0,0,t,i),r.imageString=o.toDataURL("image/png",1)},n.src=e},e.prototype.insertPictureInternal=function(e,t){var i=this.documentHelper.selection;this.initHistory("InsertInline"),t&&this.fitImageToPage(i,e),this.insertInlineInSelection(i,e),this.reLayout(i)},e.prototype.fitImageToPage=function(e,t){var i=e.start.paragraph.bodyWidget,r=i.sectionFormat.pageHeight-i.sectionFormat.topMargin-i.sectionFormat.topMargin,n=0;if(i instanceof ne&&i.sectionFormat.columns.length>1){var o=i.page.bodyWidgets.indexOf(i);n=i.sectionFormat.columns[o].width}else n=x.convertPointToPixel(i.sectionFormat.pageWidth-i.sectionFormat.leftMargin-i.sectionFormat.rightMargin);t.width>n&&(t.height=t.height*n/t.width,t.width=n),t.height>r&&(t.width=t.width*r/t.height,t.height=r)},e.prototype.insertInlineInSelection=function(e,t){this.checkIsNotRedoing()&&(e.owner.isShiftingEnabled=!0),e.isEmpty||this.removeSelectedContents(e),this.updateInsertPosition(),this.insertInlineInternal(t),this.addOrRemoveCommentsInline(t,!0),this.checkEndPosition(e)&&this.updateHistoryPosition(e.start,!1),this.fireContentChange()},e.prototype.onPortrait=function(){var e=new d,t=this.documentHelper.selection.sectionFormat.pageWidth,i=this.documentHelper.selection.sectionFormat.pageHeight;t>i&&(e.pageWidth=i,e.pageHeight=t),this.onApplySectionFormat(void 0,e)},e.prototype.onLandscape=function(){var e=new d,t=this.documentHelper.selection.sectionFormat.pageWidth,i=this.documentHelper.selection.sectionFormat.pageHeight;t<i&&(e.pageWidth=i,e.pageHeight=t),this.onApplySectionFormat(void 0,e)},e.prototype.copyValues=function(){var e=new d;return e.bottomMargin=this.documentHelper.selection.sectionFormat.bottomMargin,e.topMargin=this.documentHelper.selection.sectionFormat.topMargin,e.leftMargin=this.documentHelper.selection.sectionFormat.leftMargin,e.rightMargin=this.documentHelper.selection.sectionFormat.rightMargin,e.pageHeight=this.documentHelper.selection.sectionFormat.pageHeight,e.pageWidth=this.documentHelper.selection.sectionFormat.pageWidth,e.footerDistance=this.documentHelper.selection.sectionFormat.footerDistance,e.headerDistance=this.documentHelper.selection.sectionFormat.headerDistance,e},e.prototype.changeMarginValue=function(e){var t=this.copyValues();"lastCustomSetting"===e||"normal"===e?(t.topMargin=72,t.bottomMargin=72,t.leftMargin=72,t.rightMargin=72):"narrow"===e?(t.topMargin=36,t.bottomMargin=36,t.leftMargin=36,t.rightMargin=36):"moderate"===e?(t.topMargin=72,t.bottomMargin=72,t.leftMargin=54,t.rightMargin=54):"wide"===e?(t.topMargin=72,t.bottomMargin=72,t.leftMargin=144,t.rightMargin=144):"mirrored"===e?(t.topMargin=72,t.bottomMargin=72,t.leftMargin=90,t.rightMargin=72):"office2003Default"===e&&(t.topMargin=72,t.bottomMargin=72,t.leftMargin=90,t.rightMargin=90),this.onApplySectionFormat(void 0,t)},e.prototype.onPaperSize=function(e){var t=this.copyValues(),i=this.documentHelper.selection.sectionFormat.pageWidth,r=this.documentHelper.selection.sectionFormat.pageHeight;"letter"===e?i<r?(t.pageWidth=612,t.pageHeight=792):(t.pageWidth=792,t.pageHeight=612):"tabloid"===e?i<r?(t.pageWidth=792,t.pageHeight=1224):(t.pageWidth=1224,t.pageHeight=792):"legal"===e?i<r?(t.pageWidth=612,t.pageHeight=1008):(t.pageWidth=1008,t.pageHeight=612):"statement"===e?i<r?(t.pageWidth=396,t.pageHeight=612):(t.pageWidth=612,t.pageHeight=396):"executive"===e?i<r?(t.pageWidth=522,t.pageHeight=756):(t.pageWidth=756,t.pageHeight=522):"a3"===e?i<r?(t.pageWidth=841.9,t.pageHeight=1190.55):(t.pageWidth=1190.55,t.pageHeight=841.9):"a4"===e?i<r?(t.pageWidth=595.3,t.pageHeight=841.9):(t.pageWidth=841.9,t.pageHeight=595.3):"a5"===e?i<r?(t.pageWidth=419.55,t.pageHeight=595.3):(t.pageWidth=595.3,t.pageHeight=419.55):"b4"===e?i<r?(t.pageWidth=728.5,t.pageHeight=1031.8):(t.pageWidth=1031.8,t.pageHeight=728.5):"b5"===e&&(i<r?(t.pageWidth=515.9,t.pageHeight=728.5):(t.pageWidth=728.5,t.pageHeight=515.9)),this.onApplySectionFormat(void 0,t)},e.prototype.updateListItemsTillEnd=function(e,t){for(var i=t?this.documentHelper.selection.getNextRenderedBlock(e):e;!sf.base.isNullOrUndefined(i)&&!this.documentHelper.isTextInput;)this.updateRenderedListItems(i),i=i.getSplitWidgets().pop().nextRenderedWidget},e.prototype.updateWholeListItems=function(e,t,i){this.documentHelper.renderedLists.clear(),this.documentHelper.renderedLevelOverrides=[];for(var r,n=e.bodyWidget.index,o=0;o<this.documentHelper.pages.length;o++){for(var s=this.documentHelper.pages[o],a=0;a<s.bodyWidgets.length&&(s.bodyWidgets[a].index!==n||(r=this.getNextBlockForList(s.bodyWidgets[a].firstChild),sf.base.isNullOrUndefined(r)));a++);if(!sf.base.isNullOrUndefined(r))break}do{var l=null;if(t&&(l={paragraph:null,listId:i}),this.updateListItems(r,e,l)){if(!sf.base.isNullOrUndefined(l))return l.paragraph==e?null:l.paragraph;break}r=r.getSplitWidgets().pop().nextRenderedWidget,sf.base.isNullOrUndefined(r)||(r=this.getNextBlockForList(r))}while(r);return null},e.prototype.getNextBlockForList=function(e){if(e instanceof le&&this.documentHelper.layout.isFirstElementWithPageBreak(e)){var t=e.nextRenderedWidget;if(!sf.base.isNullOrUndefined(t)&&t.equals(e))return t}return e},e.prototype.updateListItems=function(e,t,i){return e instanceof le?this.updateListItemsForPara(e,t,i):this.updateListItemsForTable(e,t,i)},e.prototype.updateListItemsForTable=function(e,t,i){if(sf.base.isNullOrUndefined(i)&&t instanceof de&&e.equals(t))return!0;var r=e.firstChild;do{if(this.updateListItemsForRow(r,t,i))return!0;r=r.getSplitWidgets().pop().nextRenderedWidget}while(r);return!1},e.prototype.updateListItemsForRow=function(e,t,i){if(sf.base.isNullOrUndefined(i)&&t.isInsideTable&&-1!==e.childWidgets.indexOf(this.documentHelper.selection.getContainerCell(t.associatedCell)))return!0;var r=e.firstChild;do{if(this.updateListItemsForCell(r,t,i),!sf.base.isNullOrUndefined(i)&&!sf.base.isNullOrUndefined(i.paragraph))return!0;r=r.nextRenderedWidget}while(r);return!1},e.prototype.updateListItemsForCell=function(e,t,i){if(0!==e.childWidgets.length){var r=e.firstChild;do{if(this.updateListItems(r,t,i),!sf.base.isNullOrUndefined(i)&&!sf.base.isNullOrUndefined(i.paragraph))break;r=r.getSplitWidgets().pop().nextRenderedWidget}while(r)}},e.prototype.updateRenderedListItems=function(e){e instanceof le?this.updateRenderedListItemsForPara(e):this.updateRenderedListItemsForTable(e)},e.prototype.updateRenderedListItemsForTable=function(e){var t=e.firstChild;do{this.updateRenderedListItemsForRow(t),t=t.getSplitWidgets().pop().nextRenderedWidget}while(t)},e.prototype.updateRenderedListItemsForRow=function(e){var t=e.firstChild;do{this.updateRenderedListItemsForCell(t),t=t.nextRenderedWidget}while(t)},e.prototype.updateRenderedListItemsForCell=function(e){if(0!==e.childWidgets.length){var t=e.firstChild;do{this.updateRenderedListItems(t),t=t.getSplitWidgets().pop().nextRenderedWidget}while(t)}},e.prototype.updateListItemsForPara=function(e,t,i){if(e.equals(t))return sf.base.isNullOrUndefined(i)||(i.paragraph=e),!0;var r=void 0,n=0;if(!sf.base.isNullOrUndefined(e.paragraphFormat)&&!sf.base.isNullOrUndefined(e.paragraphFormat.listFormat)){if(!sf.base.isNullOrUndefined(i)&&e.paragraphFormat.listFormat.listId===i.listId)return i.paragraph=e,!0;r=this.documentHelper.getListById(e.paragraphFormat.listFormat.listId),n=e.paragraphFormat.listFormat.listLevelNumber}if(!sf.base.isNullOrUndefined(r)&&!sf.base.isNullOrUndefined(this.documentHelper.getAbstractListById(r.abstractListId))&&!sf.base.isNullOrUndefined(this.documentHelper.getAbstractListById(r.abstractListId).levels[n])){var o=this.documentHelper.layout.getListLevel(r,n);this.updateListNumber(o,e,!1)}return!1},e.prototype.updateRenderedListItemsForPara=function(e){if(!sf.base.isNullOrUndefined(this.documentHelper.getListById(e.paragraphFormat.listFormat.listId))){var t=this.documentHelper.getListById(e.paragraphFormat.listFormat.listId),i=e.paragraphFormat.listFormat.listLevelNumber;if(!sf.base.isNullOrUndefined(t)&&!sf.base.isNullOrUndefined(this.documentHelper.getAbstractListById(t.abstractListId))&&!sf.base.isNullOrUndefined(this.documentHelper.getAbstractListById(t.abstractListId).levels[e.paragraphFormat.listFormat.listLevelNumber])){var r=this.documentHelper.layout.getListLevel(t,i);this.updateListNumber(r,e,!0)}}},e.prototype.updateListNumber=function(e,t,i){if("Bullet"!==e.listLevelPattern){var r=void 0;if(t.childWidgets.length>0){var n=t.childWidgets[0];n.children.length>0&&(r=n.children[0])}var o=void 0;if(!sf.base.isNullOrUndefined(r)&&r.nextElement instanceof je&&(o=r.width+r.nextElement.width),!sf.base.isNullOrUndefined(r)&&r instanceof je){var s=this.documentHelper.layout.getListNumber(t.paragraphFormat.listFormat);if(i){var a=r.width;r.text=s;var l=this.documentHelper.textHelper.getTextSize(r,r.characterFormat);l>a&&(r.width=l),!sf.base.isNullOrUndefined(o)&&r.width<o&&(r.nextElement.width=o-r.width)}}}},e.prototype.getOffsetValue=function(e){if(this.startParagraph){var t=e.getLineInfoBasedOnParagraph(this.startParagraph,this.startOffset);e.start.setPositionFromLine(t.line,t.offset)}if(e.start.updatePhysicalPosition(!0),e.isEmpty)e.end.setPositionInternal(e.start);else{if(this.endParagraph){t=e.getLineInfoBasedOnParagraph(this.endParagraph,this.endOffset);e.end.setPositionFromLine(t.line,t.offset)}e.end.updatePhysicalPosition(!0)}},e.prototype.setPositionParagraph=function(e,t,i){var r=this.documentHelper.selection,n=r.getLineInfoBasedOnParagraph(e,t);r.start.setPositionFromLine(n.line,n.offset),r.end.setPositionInternal(r.start),i||r.fireSelectionChanged(!0)},e.prototype.setPositionForCurrentIndex=function(e,t){var i=this.selection.getParagraph({index:t}),r=this.selection.getLineInfoBasedOnParagraph(i.paragraph,i.offset);e.setPositionForLineWidget(r.line,r.offset)},e.prototype.insertPageNumber=function(e){var t="PAGE "+(e=sf.base.isNullOrUndefined(e)?"":" \\*"+e)+" \\* MERGEFORMAT";this.createFields(t)},e.prototype.insertPageCount=function(e){var t="NUMPAGES "+(e=sf.base.isNullOrUndefined(e)?"":" *"+e)+" * MERGEFORMAT";this.createFields(t)},e.prototype.createFields=function(e){var t=new le,i=new ue(t),r=new fe(0);i.children.push(r);var n=new Ie;n.fieldBegin=r,n.text="1";var o=new we;o.text=e,i.children.push(o);var s=new fe(2);s.fieldBegin=r,r.fieldSeparator=s,i.children.push(s),i.children.push(n);var a=new fe(1);a.fieldBegin=r,a.fieldSeparator=s,s.fieldEnd=a,r.fieldEnd=a,i.children.push(a),r.line=i,t.childWidgets.push(i),this.documentHelper.fields.push(r);var l=new ne;l.sectionFormat=new d(l),l.childWidgets.push(t),this.pasteContentsInternal([l],!1)},e.prototype.insertBookmark=function(e){if(this.documentHelper.bookmarks.containsKey(e)){var t=this.documentHelper.bookmarks.get(e);t.line.children.splice(t.line.children.indexOf(t),1),t.reference.line.children.splice(t.reference.line.children.indexOf(t.reference),1),this.documentHelper.bookmarks.remove(e)}var i=new Ce(0);i.name=e;var r=new Ce(1);r.name=e,i.reference=r,r.reference=i,this.initComplexHistory("InsertBookmark"),this.insertElements([r],[i]),this.editorHistory&&this.editorHistory.updateComplexHistoryInternal(),this.documentHelper.owner.enableHeaderAndFooter&&this.updateHeaderFooterWidget(),this.documentHelper.bookmarks.add(e,i),this.selection.start.setPositionForSelection(i.line,i,1,this.selection.start.location),this.selection.end.setPositionForSelection(r.line,r,0,this.selection.end.location),this.selection.fireSelectionChanged(!0),this.fireContentChange()},e.prototype.deleteBookmark=function(e){var t=this.documentHelper.bookmarks.get(e);if(t instanceof Ce){t.reference;this.initHistory("DeleteBookmark"),this.editorHistory&&(this.editorHistory.currentBaseHistoryInfo.setBookmarkInfo(t),this.editorHistory.updateHistory()),this.deleteBookmarkInternal(t)}this.fireContentChange()},e.prototype.deleteBookmarkInternal=function(e){var t=e.previousNode;t instanceof fe&&0===t.fieldType&&!sf.base.isNullOrUndefined(t.formFieldData)&&(t.formFieldData.name=""),this.documentHelper.bookmarks.remove(e.name),e.line.children.splice(e.indexInOwner,1),sf.base.isNullOrUndefined(e.reference)||e.reference.line.children.splice(e.reference.indexInOwner,1);var i=e.line.paragraph;if(e.line.paragraph.isInHeaderFooter){var r=void 0;i.containerWidget instanceof pe?r=i.containerWidget.getContainerTable().containerWidget:i.containerWidget instanceof oe&&(r=i.containerWidget),this.updateHeaderFooterWidget(r)}},e.prototype.getSelectionInfo=function(){var e=this.selection.start,t=this.selection.end;this.selection.isForward||(e=this.selection.end,t=this.selection.start),t.offset===this.selection.getLineLength(t.currentWidget)+1&&this.selection.isParagraphLastLine(t.currentWidget)||(t.offset+=1);var i=this.selection.getParagraphInfo(e),r=this.selection.getHierarchicalIndex(i.paragraph,i.offset.toString());return i=this.selection.getParagraphInfo(t),{start:r,end:this.selection.getHierarchicalIndex(i.paragraph,i.offset.toString())}},e.prototype.insertElements=function(e,t){var i=this.getSelectionInfo();sf.base.isNullOrUndefined(t)||this.insertElementsInternal(this.selection.getTextPosBasedOnLogicalIndex(i.start),t),sf.base.isNullOrUndefined(e)||this.insertElementsInternal(this.selection.getTextPosBasedOnLogicalIndex(i.end),e)},e.prototype.insertElementsInternal=function(e,t,i){this.selection.selectPosition(e,e),this.initHistory("InsertElements"),this.updateInsertPosition();var r=0,n=this.selection.getParagraphInfo(this.selection.start);if(this.selection.start.paragraph.isEmpty()){var o=this.selection.start.paragraph;o.childWidgets[0].children.push(t[0]),t[0].line=o.childWidgets[0],t[0].linkFieldCharacter(this.documentHelper),this.documentHelper.layout.reLayoutParagraph(o,0,0),this.setPositionParagraph(n.paragraph,n.offset+length,!0),e.setPositionForSelection(t[0].line,t[0],t[0].length,this.selection.start.location),this.selection.selectPosition(e,e)}else{var s=this.selection.start.currentWidget.getInline(this.documentHelper.selection.start.offset,r),a=s.element;r=s.index;var l=t[0];this.insertElementInternal(a,l,r,void 0,!0);for(var h=l.indexInOwner,d=l,c=1;c<t.length;c++)d=t[c],l.line.children.splice(h+c,0,d);e.setPositionForSelection(d.line,d,d.length,this.selection.start.location),this.selection.selectPosition(e,e)}this.editorHistory&&(this.checkEndPosition()&&this.updateHistoryPosition(this.selection.start,!1),this.editorHistory.updateHistory())},e.prototype.getCommentElementBox=function(e){var t=e.split(";"),i=this.documentHelper.comments[parseInt(t[1],10)];return t.length>2&&""!==t[2]?i.replyComments[parseInt(t[2],10)]:i},e.prototype.getBlock=function(e){var t=this.selection.getBodyWidget(e);return this.getBlockInternal(t,e)},e.prototype.getBlockInternal=function(e,t){if(""!==t.index&&!sf.base.isNullOrUndefined(t)){var i=t.index.indexOf(";"),r=t.index.substring(0,i);t.index=t.index.substring(i).replace(";","");var n=e;i=parseInt(r,10);var o=this.selection.getBlockByIndex(e,i);if(!o)return{node:n,position:t};var s=o;if(!(t.index.indexOf(";")>=0))return{node:s,position:t};if(s instanceof le)return t.index.indexOf(";")>=0&&(t.index="0"),{node:s,position:t};if(s instanceof ie){var a=this.getBlockInternal(s,t);return{node:sf.base.isNullOrUndefined(a)?void 0:a.node,position:sf.base.isNullOrUndefined(a)?void 0:a.position}}return{node:n,position:t}}},e.prototype.updateHistoryPosition=function(e,t){if(this.editorHistory&&!sf.base.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)){var i=void 0;if(e instanceof Ft){var r=this.selection.getParagraphInfo(e);i=this.selection.getHierarchicalIndex(r.paragraph,r.offset.toString())}else i=e;t?this.editorHistory.currentBaseHistoryInfo.insertPosition=i:this.editorHistory.currentBaseHistoryInfo.endPosition=i}},e.prototype.applyBorders=function(e){this.initHistory("Borders");var t=this.selection.isForward?this.selection.start:this.selection.end,i=this.selection.isForward?this.selection.end:this.selection.start,r=t.paragraph.associatedCell.ownerTable;if(r=r.combineWidget(this.owner.viewer),this.editorHistory)this.cloneTableToHistoryInfo(r);t.paragraph.associatedCell;var n,o=i.paragraph.associatedCell,s=this.getBorder(e.borderColor,e.lineWidth,e.borderStyle);if(this.selection.isEmpty)"OutsideBorders"!==e.type&&"AllBorders"!==e.type&&"LeftBorder"!==e.type||o.cellFormat.borders.left.copyFormat(s),"OutsideBorders"!==e.type&&"AllBorders"!==e.type&&"TopBorder"!==e.type||o.cellFormat.borders.top.copyFormat(s),"OutsideBorders"!==e.type&&"AllBorders"!==e.type&&"RightBorder"!==e.type||o.cellFormat.borders.right.copyFormat(s),"OutsideBorders"!==e.type&&"AllBorders"!==e.type&&"BottomBorder"!==e.type||o.cellFormat.borders.bottom.copyFormat(s),"AllBorders"!==e.type&&"InsideBorders"!==e.type&&"InsideVerticalBorder"!==e.type||o.cellFormat.borders.vertical.copyFormat(s),"AllBorders"!==e.type&&"InsideBorders"!==e.type&&"InsideHorizontalBorder"!==e.type||o.cellFormat.borders.horizontal.copyFormat(s),"NoBorder"===e.type&&this.clearAllBorderValues(o.cellFormat.borders);else{if("OutsideBorders"===e.type||"TopBorder"===e.type)for(var a=this.getTopBorderCellsOnSelection(),l=0;l<a.length;l++)a[l].cellFormat.borders.top.copyFormat(s);if("OutsideBorders"===e.type||"LeftBorder"===e.type)for(a=this.getLeftBorderCellsOnSelection(),l=0;l<a.length;l++)a[l].cellFormat.borders.left.copyFormat(s);if("OutsideBorders"===e.type||"RightBorder"===e.type)for(a=this.getRightBorderCellsOnSelection(),l=0;l<a.length;l++)a[l].cellFormat.borders.right.copyFormat(s);if("OutsideBorders"===e.type||"BottomBorder"===e.type)for(a=this.getBottomBorderCellsOnSelection(),l=0;l<a.length;l++)a[l].cellFormat.borders.bottom.copyFormat(s)}if("BottomBorder"===e.type||"AllBorders"===e.type||"OutsideBorders"===e.type||"NoBorder"===e.type){n=this.getAdjacentCellToApplyBottomBorder();for(l=0;l<n.length;l++){var h=n[l];"NoBorder"===e.type?h.cellFormat.borders.top.copyFormat(this.clearBorder()):h.cellFormat.borders.top.copyFormat(s)}}if("AllBorders"===e.type||"OutsideBorders"===e.type||"RightBorder"===e.type||"NoBorder"===e.type){n=this.getAdjacentCellToApplyRightBorder();for(l=0;l<n.length;l++){h=n[l];"NoBorder"===e.type?h.cellFormat.borders.left.copyFormat(this.clearBorder()):h.cellFormat.borders.left.copyFormat(s)}}"AllBorders"!==e.type&&"NoBorder"!==e.type||this.applyAllBorders(s,e.type),"InsideBorders"!==e.type&&"InsideVerticalBorder"!==e.type&&"InsideHorizontalBorder"!==e.type&&"NoBorder"!==e.type||this.applyInsideBorders(s,e.type,r),this.updateGridForTableDialog(r,!1),this.reLayout(this.selection,!1),this.editorHistory.updateHistory()},e.prototype.applyAllBorders=function(e,t){for(var i=this.selection.getSelectedCells(),r=0;r<i.length;r++)"NoBorder"===t?(i[r].cellFormat.borders.left.copyFormat(this.clearBorder()),i[r].cellFormat.borders.right.copyFormat(this.clearBorder()),i[r].cellFormat.borders.top.copyFormat(this.clearBorder()),i[r].cellFormat.borders.bottom.copyFormat(this.clearBorder())):(i[r].cellFormat.borders.left.copyFormat(e),i[r].cellFormat.borders.right.copyFormat(e),i[r].cellFormat.borders.top.copyFormat(e),i[r].cellFormat.borders.bottom.copyFormat(e))},e.prototype.applyInsideBorders=function(e,t,i){for(var r=this.selection.getSelectedCells(),n=0;n<r.length;n++){var o=r[n],s=o.ownerRow===r[r.length-1].ownerRow,a=o.columnIndex+o.cellFormat.columnSpan-1===r[r.length-1].columnIndex;if("NoBorder"===t?(o.cellFormat.borders.right.copyFormat(this.clearBorder()),o.cellFormat.borders.bottom.copyFormat(this.clearBorder())):(a||"InsideHorizontalBorder"===t||o.cellFormat.borders.right.copyFormat(e),s||"InsideVerticalBorder"===t||o.cellFormat.borders.bottom.copyFormat(e)),!s&&"InsideVerticalBorder"!==t){var l=o.ownerRow.rowIndex+o.cellFormat.rowSpan,h=i.childWidgets[l];if(h)for(var d=this.getAdjacentBottomBorderOnEmptyCells(h,o,!0),c=0;c<d.length;c++)"NoBorder"===t?d[c].cellFormat.borders.top.copyFormat(this.clearBorder()):d[c].cellFormat.borders.top.copyFormat(e)}if(!a&&"InsideHorizontalBorder"!==t)for(var p=this.getSelectedCellsNextWidgets(o,i),u=0;u<p.length;u++)"NoBorder"===t?p[u].cellFormat.borders.left.copyFormat(this.clearBorder()):p[u].cellFormat.borders.left.copyFormat(e)}},e.prototype.getTopBorderCellsOnSelection=function(){for(var e=(this.selection.isForward?this.selection.start:this.selection.end).paragraph.associatedCell,t=[],i=this.selection.getSelectedCells(),r=0;r<i.length;r++)i[r].ownerRow===e.ownerRow&&t.push(i[r]);return t},e.prototype.getLeftBorderCellsOnSelection=function(){for(var e=(this.selection.isForward?this.selection.start:this.selection.end).paragraph.associatedCell,t=this.selection.getSelectedCells(),i=[],r=0;r<t.length;r++)t[r].columnIndex===e.columnIndex&&i.push(t[r]);return i},e.prototype.getRightBorderCellsOnSelection=function(){for(var e=this.selection.getSelectedCells(),t=[],i=0;i<e.length;i++)e[i].columnIndex+e[i].cellFormat.columnSpan-1===e[e.length-1].columnIndex&&t.push(e[i]);return t},e.prototype.getBottomBorderCellsOnSelection=function(){for(var e=(this.selection.isForward?this.selection.end:this.selection.start).paragraph.associatedCell,t=this.selection.getSelectedCells(),i=[],r=0;r<t.length;r++)t[r].ownerRow===e.ownerRow&&i.push(t[r]);return i},e.prototype.clearAllBorderValues=function(e){var t=this.clearBorder();e.bottom.copyFormat(t),e.left.copyFormat(t),e.right.copyFormat(t),e.top.copyFormat(t),e.vertical.copyFormat(t),e.horizontal.copyFormat(t)},e.prototype.clearBorder=function(){var e=new p;return e.lineStyle="Cleared",e},e.prototype.getAdjacentCellToApplyBottomBorder=function(){var e=[],t=this.selection.start,i=this.selection.end;this.selection.isForward||(t=this.selection.end,i=this.selection.start);var r=t.paragraph.associatedCell.ownerTable;r=r.combineWidget(this.owner.viewer);var n=t.paragraph.associatedCell,o=i.paragraph.associatedCell,s=o.ownerRow.rowIndex+o.cellFormat.rowSpan,a=r.childWidgets[s];if(a)if(o.cellFormat.columnSpan>1)for(var l=o.columnIndex;l<o.columnIndex+o.cellFormat.columnSpan;l++)e.push(a.childWidgets[l]);else if(e=this.getAdjacentBottomBorderOnEmptyCells(a,o),!this.selection.isEmpty)for(l=0;l<a.childWidgets.length;l++){var h=a.childWidgets[l].columnIndex;h>=n.columnIndex&&h<=o.columnIndex&&e.push(a.childWidgets[l])}return e},e.prototype.getAdjacentBottomBorderOnEmptyCells=function(e,t,i){var r=[];if(t.cellFormat.columnSpan>1)for(var n=t.columnIndex;n<t.columnIndex+t.cellFormat.columnSpan;n++)r.push(e.childWidgets[n]);else if(this.selection.isEmpty||i)for(n=0;n<e.childWidgets.length;n++)e.childWidgets[n].columnIndex===t.columnIndex&&r.push(e.childWidgets[n]);return r},e.prototype.getAdjacentCellToApplyRightBorder=function(){var e=[],t=this.selection.start,i=this.selection.end;this.selection.isForward||(t=this.selection.end,i=this.selection.start);var r=t.paragraph.associatedCell.ownerTable;r=r.combineWidget(this.owner.viewer);t.paragraph.associatedCell,i.paragraph.associatedCell;if(this.selection.isEmpty){var n=t.paragraph.associatedCell;e=this.getSelectedCellsNextWidgets(n,r)}else for(var o=this.getRightBorderCellsOnSelection(),s=0;s<o.length;s++){var a=o[s];e=e.concat(this.getSelectedCellsNextWidgets(a,r))}return e},e.prototype.getSelectedCellsNextWidgets=function(e,t){var i=[];if(!sf.base.isNullOrUndefined(e.nextWidget)&&(i.push(e.nextWidget),e.cellFormat.rowSpan>1))for(var r=e.ownerRow.rowIndex+e.cellFormat.rowSpan,n=e.ownerRow.rowIndex+1;n<r;n++){var o=t.childWidgets[n];if(o)for(var s=0;s<o.childWidgets.length;s++)o.childWidgets[s].columnIndex===e.nextWidget.columnIndex&&i.push(o.childWidgets[s])}return i},e.prototype.getBorder=function(e,t,i){var r=new p;return r.color=e||"#000000",r.lineWidth=t||1,r.lineStyle=i||"Single",r},e.prototype.applyBordersInternal=function(e,t){sf.base.isNullOrUndefined(e)||sf.base.isNullOrUndefined(e)||(sf.base.isNullOrUndefined(e.top)||this.applyBorder(e.top,t.top),sf.base.isNullOrUndefined(e.bottom)||this.applyBorder(e.bottom,t.bottom),sf.base.isNullOrUndefined(e.left)||this.applyBorder(e.left,t.left),sf.base.isNullOrUndefined(e.right)||this.applyBorder(e.right,t.right),sf.base.isNullOrUndefined(e.horizontal)||this.applyBorder(e.horizontal,t.horizontal),sf.base.isNullOrUndefined(e.vertical)||this.applyBorder(e.vertical,t.vertical),sf.base.isNullOrUndefined(e.diagonalUp)||this.applyBorder(e.diagonalUp,t.diagonalUp),sf.base.isNullOrUndefined(e.diagonalDown)||this.applyBorder(e.diagonalDown,t.diagonalDown))},e.prototype.applyShading=function(e,t){sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(e)||(sf.base.isNullOrUndefined(t.backgroundColor)||e.backgroundColor===t.backgroundColor||(e.backgroundColor=t.backgroundColor),sf.base.isNullOrUndefined(t.foregroundColor)||e.foregroundColor===t.foregroundColor||(e.foregroundColor=t.foregroundColor),sf.base.isNullOrUndefined(t.textureStyle)||e.textureStyle===t.textureStyle||(e.textureStyle=t.textureStyle))},e.prototype.applyBorder=function(e,t){sf.base.isNullOrUndefined(e)||sf.base.isNullOrUndefined(t)||(sf.base.isNullOrUndefined(t.color)||e.color===t.color||(e.color=t.color),sf.base.isNullOrUndefined(t.lineStyle)||e.lineStyle===t.lineStyle||(e.lineStyle=t.lineStyle),sf.base.isNullOrUndefined(t.lineWidth)||e.lineWidth===t.lineWidth||(e.lineWidth=t.lineWidth),sf.base.isNullOrUndefined(t.shadow)||e.shadow===t.shadow||(e.shadow=t.shadow),sf.base.isNullOrUndefined(t.space)||e.space===t.space||(e.space=t.space))},e.prototype.onTableFormat=function(e,t){if(!sf.base.isNullOrUndefined(this.selection.tableFormat)){sf.base.isNullOrUndefined(t)&&(t=!1),this.documentHelper.owner.isShiftingEnabled=!0,this.editorHistory.initializeHistory("TableFormat");var i=this.selection.start.paragraph.associatedCell.ownerTable.combineWidget(this.owner.viewer);if(t)for(var r=0;r<i.childWidgets.length;r++)for(var n=i.childWidgets[r],o=0;o<n.childWidgets.length;o++){n.childWidgets[o].cellFormat.shading.copyFormat(e.shading)}if(!sf.base.isNullOrUndefined(t))for(r=0;r<i.childWidgets.length;r++){(n=i.childWidgets[r]).rowFormat.borders.copyFormat(e.borders);for(o=0;o<n.childWidgets.length;o++){n.childWidgets[o].cellFormat.borders.copyFormat(e.borders)}}this.applyTableFormat(i,void 0,e),this.reLayout(this.selection,!1)}},e.prototype.applyTableFormat=function(e,t,i){this.applyTablePropertyValue(this.documentHelper.selection,void 0,i,e)},e.prototype.applyTablePropertyValue=function(e,t,i,r){var n=r.tableFormat;sf.base.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)||(i=this.editorHistory.currentBaseHistoryInfo.addModifiedTableProperties(n,t,i)),i instanceof vt?sf.base.isNullOrUndefined(t)&&this.handleTableFormat(n,i):("preferredWidth"===t?n.preferredWidth=i:"leftIndent"===t?n.leftIndent=i:"tableAlignment"===t?n.tableAlignment=i:"cellSpacing"===t?n.cellSpacing=i:"leftMargin"===t?n.leftMargin=i:"rightMargin"===t?n.rightMargin=i:"topMargin"===t?n.topMargin=i:"bottomMargin"===t?n.bottomMargin=i:"preferredWidthType"===t?n.preferredWidthType=i:"bidi"===t&&(n.bidi=i),"shading"===t?n.shading=i:"borders"===t&&(n.borders=i))},e.prototype.handleTableFormat=function(e,t){(this.isBordersAndShadingDialog||this.editorHistory.isUndoing||this.editorHistory.isRedoing)&&(sf.base.isNullOrUndefined(e.borders)||this.applyBordersInternal(e.borders,t.borders),sf.base.isNullOrUndefined(e.shading)||this.applyShading(e.shading,t.shading)),this.isBordersAndShadingDialog||(t.hasValue("bidi")&&t.bidi!==e.bidi&&(e.bidi=t.bidi),t.hasValue("preferredWidth")&&t.preferredWidth!==e.preferredWidth&&(e.preferredWidth=t.preferredWidth),t.hasValue("preferredWidthType")&&t.preferredWidthType!==e.preferredWidthType&&(e.preferredWidthType=t.preferredWidthType),t.hasValue("tableAlignment")&&t.tableAlignment!==e.tableAlignment&&(e.tableAlignment=t.tableAlignment),t.hasValue("leftIndent")&&t.leftIndent!==e.leftIndent&&(e.leftIndent=t.leftIndent),t.hasValue("topMargin")&&t.topMargin!==e.topMargin&&(e.topMargin=t.topMargin),t.hasValue("bottomMargin")&&t.bottomMargin!==e.bottomMargin&&(e.bottomMargin=t.bottomMargin),t.hasValue("leftMargin")&&t.leftMargin!==e.leftMargin&&(e.leftMargin=t.leftMargin),t.hasValue("rightMargin")&&t.rightMargin!==e.rightMargin&&(e.rightMargin=t.rightMargin),t.hasValue("cellSpacing")&&t.cellSpacing!==e.cellSpacing&&(e.cellSpacing=t.cellSpacing)),this.updateGridForTableDialog(e.ownerBase,!1)},e.prototype.updateGridForTableDialog=function(e,t){e.tableHolder&&(e.updateRowIndex(0),e.isGridUpdated=!1),this.documentHelper.layout.reLayoutTable(e)},e.prototype.onRowFormat=function(e){if(!sf.base.isNullOrUndefined(this.selection)&&!sf.base.isNullOrUndefined(e)){this.editorHistory.initializeHistory("RowFormat"),this.documentHelper.owner.isShiftingEnabled=!0;var t=this.selection.isForward?this.selection.start:this.selection.end,i=this.selection.isForward?this.selection.end:this.selection.start;t.paragraph.associatedCell.ownerTable.combineWidget(this.owner.viewer);this.applyRowFormat(t.paragraph.associatedCell.ownerRow,t,i,void 0,e),this.reLayout(this.selection,!1)}},e.prototype.applyRowFormat=function(e,t,i,r,n){if(this.applyRowPropertyValue(this.documentHelper.selection,r,n,e),i.paragraph.associatedCell.ownerRow!==e){var o=e.nextWidget;sf.base.isNullOrUndefined(o)||this.applyRowFormat(o,t,i,r,n)}},e.prototype.applyRowPropertyValue=function(e,t,i,r){var n=r.rowFormat;sf.base.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)||(i=this.editorHistory.currentBaseHistoryInfo.addModifiedRowProperties(n,t,i)),i instanceof C?sf.base.isNullOrUndefined(t)&&this.handleRowFormat(i,n):("heightType"===t?n.heightType=i:"height"===t?n.height=i:"isHeader"===t?n.isHeader=i:"allowBreakAcrossPages"===t&&(n.allowBreakAcrossPages=i),sf.base.isNullOrUndefined(r.ownerTable)||this.layoutItemBlock(r.ownerTable,!0))},e.prototype.handleRowFormat=function(e,t){e.hasValue("allowBreakAcrossPages")&&e.allowBreakAcrossPages!==t.allowBreakAcrossPages&&(t.allowBreakAcrossPages=e.allowBreakAcrossPages),e.hasValue("isHeader")&&e.isHeader!==t.isHeader&&(t.isHeader=e.isHeader),e.hasValue("heightType")&&e.heightType!==t.heightType&&(t.heightType=e.heightType),e.hasValue("height")&&e.height!==t.height&&(t.height=e.height),this.updateGridForTableDialog(t.ownerBase.ownerTable,!0)},e.prototype.onCellFormat=function(e){sf.base.isNullOrUndefined(this.selection)||sf.base.isNullOrUndefined(e)||(this.editorHistory.initializeHistory("CellFormat"),this.updateFormatForCell(this.selection,void 0,e),this.reLayout(this.selection,!1))},e.prototype.updateCellMargins=function(e,t){var i=e.start;e.end;e.isForward||(i=e.end,e.start),this.initHistoryPosition(e,i)},e.prototype.updateFormatForCell=function(e,t,i){var r=e.start,n=e.end;e.isForward||(r=e.end,n=e.start);for(var o,s=r.paragraph.associatedCell,a=n.paragraph.associatedCell,l=s.ownerTable.combineWidget(this.owner.viewer),h=s.columnIndex;h<=a.columnIndex;h++){o=this.getSelectedCellInColumn(s.ownerTable,s.ownerRow.rowIndex,h,a.ownerRow.rowIndex);for(var d=0;d<o.length;d++)this.applyCellPropertyValue(this.documentHelper.selection,t,i,o[d].cellFormat)}this.updateGridForTableDialog(l,!1)},e.prototype.getSelectedCellInColumn=function(e,t,i,r){for(var n=[],o=t;o<=r;o++)for(var s=e.childWidgets[o],a=0;a<s.childWidgets.length;a++)s.childWidgets[a].columnIndex===i&&n.push(s.childWidgets[a]);return n},e.prototype.getColumnCells=function(e,t,i){for(var r=[],n=0;n<e.childWidgets.length;n++)for(var o=e.childWidgets[n],s=0;s<o.childWidgets.length;s++){var a=o.childWidgets[s];i?a.columnIndex+a.cellFormat.columnSpan===t&&r.push(a):a.columnIndex===t&&r.push(a)}return r},e.prototype.getTableWidth=function(e){return 0!==e.tableFormat.preferredWidth||"Percent"===e.tableFormat.preferredWidthType?"Auto"===e.tableFormat.preferredWidthType||"Point"===e.tableFormat.preferredWidthType?e.tableFormat.preferredWidth:0===e.tableFormat.preferredWidth?0:x.convertPixelToPoint(this.owner.viewer.clientArea.width)/100*e.tableFormat.preferredWidth:x.convertPixelToPoint(this.documentHelper.layout.getTableWidth(e))},e.prototype.applyCellPropertyValue=function(e,t,i,r){if(sf.base.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)||(i=this.editorHistory.currentBaseHistoryInfo.addModifiedCellProperties(r,t,i)),i instanceof bt)return sf.base.isNullOrUndefined(t)&&this.handleCellFormat(i,r),i;"leftMargin"===t?r.leftMargin=i:"topMargin"===t?r.topMargin=i:"rightMargin"===t?r.rightMargin=i:"bottomMargin"===t?r.bottomMargin=i:"preferredWidth"===t?(r.preferredWidth=i,r.cellWidth=i):"cellWidth"===t?r.cellWidth=i:"columnSpan"===t?r.columnSpan=i:"rowSpan"===t?r.rowSpan=i:"preferredWidthType"===t?r.preferredWidthType=i:"verticalAlignment"===t&&(r.verticalAlignment=i),"shading"===t?r.shading=i:"borders"===t&&(r.borders=i)},e.prototype.handleCellFormat=function(e,t){sf.base.isNullOrUndefined(e)||sf.base.isNullOrUndefined(t)||(this.isBordersAndShadingDialog?(sf.base.isNullOrUndefined(e.borders)||this.applyBordersInternal(t.borders,e.borders),sf.base.isNullOrUndefined(e.shading)||this.applyShading(t.shading,e.shading)):(e.hasValue("preferredWidth")&&t.preferredWidth!==e.preferredWidth&&(t.preferredWidth=e.preferredWidth),e.hasValue("preferredWidthType")&&t.preferredWidthType!==e.preferredWidthType&&(t.preferredWidthType=e.preferredWidthType),e.hasValue("verticalAlignment")&&t.verticalAlignment!==e.verticalAlignment&&(t.verticalAlignment=e.verticalAlignment),e.hasValue("leftMargin")&&t.leftMargin!==e.leftMargin&&(t.leftMargin=e.leftMargin),e.hasValue("rightMargin")&&t.rightMargin!==e.rightMargin&&(t.rightMargin=e.rightMargin),e.hasValue("topMargin")&&t.topMargin!==e.topMargin&&(t.topMargin=e.topMargin),e.hasValue("bottomMargin")&&t.bottomMargin!==e.bottomMargin&&(t.bottomMargin=e.bottomMargin)))},e.prototype.destroy=function(){this.documentHelper=void 0,this.nodes=[]},e.prototype.updateToc=function(e){if(sf.base.isNullOrUndefined(e)&&(e=this.selection.getTocFieldInternal()),this.documentHelper.layout.isTocField(e)){var t=this.selection.getFieldCode(e);-1!==t.toLocaleLowerCase().indexOf("toc")&&this.insertTableOfContents(this.validateTocSettings(this.getTocSettings(t,e)))}},e.prototype.getTocSettings=function(e,t){var i={includePageNumber:!0,rightAlign:!0};if("toc \\mergeformat"===e.toLowerCase())i.startLevel=1,i.endLevel=3;else for(var r=e.split("\\"),n=0;n<r.length;n++){var o=r[n];if(0!==o.length)switch(o[0]){case"o":if(sf.base.isNullOrUndefined(o.match(/\d+/g)))i.startLevel=1,i.endLevel=9;else{var s=o.match(/\d+/g).map(Number);i.startLevel=s[0],i.endLevel=s[1]}break;case"h":i.includeHyperlink=!0;break;case"n":i.includePageNumber=!1;break;case"p":i.rightAlign=!1;break;case"u":i.includeOutlineLevels=!0;break;case"t":this.decodeTSwitch(i,o)}}var a=t.paragraph.paragraphFormat.getUpdatedTabs();return a.length>0&&(i.tabLeader=a[a.length-1].tabLeader),i.rightAlign&&sf.base.isNullOrUndefined(i.tabLeader)&&(i.tabLeader="Dot"),i},e.prototype.decodeTSwitch=function(e,t){e.levelSettings={};for(var i=(t=(t=(t=(t=t.replace("t","")).replace('"',"")).replace('"',"")).trim()).split(","),r=0;r<i.length;r++)e.levelSettings[i[r]]=parseInt(i[r+1],10),r++},e.prototype.insertTableOfContents=function(e){this.isInsertingTOC=!0,this.initComplexHistory("TOC"),sf.base.isNullOrUndefined(e)&&((e={}).startLevel=1,e.endLevel=3,e.includeHyperlink=!0,e.includeOutlineLevels=!0,e.includePageNumber=!0,e.rightAlign=!0,e.tabLeader="Dot");var t,i=void 0;if("TableOfContents"===this.selection.contextType&&(i=this.selection.getTocFieldInternal()),i instanceof fe){this.selection.start.setPositionForSelection(i.line,i,0,this.selection.start.location);var r=2;i.fieldEnd.paragraph===i.fieldEnd.paragraph.bodyWidget.lastChild&&r--,this.selection.end.setPositionForSelection(i.fieldEnd.line,i.fieldEnd,r,this.selection.end.location),this.delete()}t=this.constructTocFieldCode(e);var n=this.selection.start.isAtParagraphStart,o=this.selection.getParagraphInfo(this.selection.start),s=this.selection.getHierarchicalIndex(o.paragraph,o.offset.toString()),a=this.buildToc(this.validateTocSettings(e),t,!0,n);if(a.length>0){var l=new le,h=new ue(l);l.childWidgets.push(h);var c=0;n||(c=1);var p=a[c].childWidgets[0].children[0];this.appendEndField(p,h),a.push(l),this.appendEmptyPara(a)}this.setPositionForCurrentIndex(this.selection.start,s),this.selection.end.setPositionInternal(this.selection.start);var u=new ne;u.sectionFormat=new d(u),u.childWidgets=a,this.pasteContentsInternal([u],!1),this.isInsertingTOC=!1,this.updatePageRef(),this.editorHistory&&this.editorHistory.updateComplexHistoryInternal(),0===a.length&&(this.owner.editorHistory.undo(),this.owner.editorHistory.redoStack.pop())},e.prototype.appendEmptyPara=function(e){var t=new le,i=new ue(t);t.childWidgets.push(i),e.push(t)},e.prototype.constructTocFieldCode=function(e){var t="TOC";sf.base.isNullOrUndefined(e.startLevel)||0===e.startLevel||sf.base.isNullOrUndefined(e.endLevel)||0===e.endLevel||(t=t+' \\o "'+e.startLevel+"-"+e.endLevel+'"'),e.includePageNumber&&!e.rightAlign&&(t+=' \\p " "'),e.includePageNumber||(t+=" \\n"),e.includeHyperlink&&(t+=" \\h \\z"),e.includeOutlineLevels&&(t+=" \\u");var i=this.constructTSwitch(e);return i.length>6&&(t+=i),t},e.prototype.constructTSwitch=function(e){var t="";if(!sf.base.isNullOrUndefined(e.levelSettings))for(var i=0,r=Object.keys(e.levelSettings);i<r.length;i++){var n=r[i];t=t+n+","+e.levelSettings[n].toString()+","}return t=' \\t "'+(t=t.slice(0,-1))+'"'},e.prototype.appendEndField=function(e,t){var i=new fe(1);if(i.fieldSeparator=e.fieldSeparator,e.fieldSeparator.fieldEnd=i,i.fieldBegin=e,i.fieldBegin.fieldEnd=i,i.line=t,e.revisions.length>0){var r=e.revisions[e.revisions.length-1];r.range.push(i),i.revisions.push(r)}t.children.push(i)},e.prototype.validateTocSettings=function(e){return(sf.base.isNullOrUndefined(e.startLevel)||e.startLevel<1)&&(e.startLevel=1),(sf.base.isNullOrUndefined(e.endLevel)||e.endLevel<e.endLevel)&&(e.endLevel=e.startLevel>3?e.startLevel:3),sf.base.isNullOrUndefined(e.includeHyperlink)&&(e.includeHyperlink=!1),sf.base.isNullOrUndefined(e.includePageNumber)&&(e.includePageNumber=!1),sf.base.isNullOrUndefined(e.rightAlign)&&(e.rightAlign=!1),sf.base.isNullOrUndefined(e.levelSettings)&&(e.levelSettings={}),e},e.prototype.buildToc=function(e,t,i,r){var n=this.documentHelper.pages[0].bodyWidgets[0],o=[];this.createHeadingLevels(e),e.includeOutlineLevels&&this.createOutlineLevels(e);for(var s=this.selection.start.paragraph.bodyWidget.sectionFormat,a=n.childWidgets[0];void 0!==a;){if(a instanceof le&&(this.isHeadingStyle(a)||e.includeOutlineLevels&&this.isOutlineLevelStyle(a))){var l=this.insertTocBookmark(a);this.createTOCWidgets(a,o,t,l,e,i,r,s),i=!1}a=this.selection.getNextParagraphBlock(a.getSplitWidgets().pop())}return this.tocStyles={},o},e.prototype.createOutlineLevels=function(e){for(var t=e.startLevel;t<=e.endLevel;t++){var i="Level"+t.toString();sf.base.isNullOrUndefined(this.tocStyles[i])&&(this.tocStyles[i]=t)}},e.prototype.createHeadingLevels=function(e){for(var t=e.startLevel;t<=e.endLevel;t++){var i="Heading "+t.toString();sf.base.isNullOrUndefined(this.tocStyles[i])&&(this.tocStyles[i]=t)}if(!sf.base.isNullOrUndefined(e.levelSettings))for(var r=0,n=Object.keys(e.levelSettings);r<n.length;r++){var o=n[r];this.tocStyles[o]=e.levelSettings[o]}},e.prototype.isHeadingStyle=function(e){var t=e.paragraphFormat.baseStyle;return void 0!==t&&!sf.base.isNullOrUndefined(this.tocStyles[t.name])},e.prototype.isOutlineLevelStyle=function(e){var t=e.paragraphFormat.outlineLevel;return!sf.base.isNullOrUndefined(this.tocStyles[t])},e.prototype.createTocFieldElement=function(e,t,i){var r=new fe(0);r.hasFieldEnd=!0,r.line=e,e.children.push(r);var n=new we;n.text=t,n.line=e,e.children.push(n);var o=new fe(2);return o.fieldBegin=r,o.fieldBegin.fieldSeparator=o,o.line=e,e.children.push(o),r},e.prototype.createTOCWidgets=function(e,t,i,r,n,o,s,a){var l=void 0,h=void 0,d=void 0,c=!1;if(1!==t.length||3!==t[0].childWidgets[0].children.length||sf.base.isNullOrUndefined(o)||o){h=new le;var p=void 0,u=e.paragraphFormat.baseStyle.name;p=n.includeOutlineLevels&&sf.base.isNullOrUndefined(this.tocStyles[u])?e.paragraphFormat.outlineLevel:u;var g="TOC "+this.tocStyles[p],f=this.documentHelper.styles.findByName(g,"Paragraph");if(sf.base.isNullOrUndefined(f)&&(this.documentHelper.owner.parser.parseStyle(JSON.parse(this.getCompleteStyles()),JSON.parse(this.documentHelper.preDefinedStyles.get(g)),this.documentHelper.styles),f=this.documentHelper.styles.findByName(g,"Paragraph")),h.paragraphFormat.applyStyle(f),n.rightAlign&&n.includePageNumber){var m=new dt;m.position=a.pageWidth-(a.leftMargin+a.rightMargin),m.tabLeader=n.tabLeader,m.deletePosition=0,m.tabJustification="Right",h.paragraphFormat.tabs.push(m)}d=new ue(h),h.childWidgets.push(d)}else d=t[0].childWidgets[0];void 0!==o&&o&&(sf.base.isNullOrUndefined(s)||s||(this.appendEmptyPara(t),c=!0),this.createTocFieldElement(d,i));for(var y="",v=!1,b=e;b instanceof le;){for(var w=0;w<b.childWidgets.length;w++)for(var x=b.childWidgets[w],M=0;M<x.children.length;M++){var N=x.children[M];if(!N.isPageBreak)if(N instanceof fe||N instanceof Ce||v)N instanceof fe&&(0===N.fieldType?v=!0:2===N.fieldType&&(v=!1));else if(N instanceof we||N instanceof je){var I=N.text;-1!==I.indexOf("\t")&&(I=I.replace(new RegExp("\t","g")," ")),y+=I}}b=b.nextSplitWidget}if(""!==y){if(n.includeHyperlink&&void 0!==r)l=this.insertTocHyperlink(d,r,y);else{var S=new we;S.text=y,S.line=d,d.children.push(S)}if(n.includePageNumber&&void 0!==r){if(n.rightAlign){var C=new Se;C.text="\t",C.line=d,d.children.push(C)}var O=this.insertTocPageNumber(r,d,n.rightAlign,e);this.appendEndField(O,d)}n.includeHyperlink&&void 0!==l&&this.appendEndField(l,d)}if(sf.base.isNullOrUndefined(h)||""===y&&!o||t.push(h),this.owner.enableTrackChanges&&!sf.base.isNullOrUndefined(h))if(1===t.length||c)this.insertRevisionForBlock(h,"Insertion",!0);else{var T=this.owner.revisionsInternal.changes[0];this.insertRevisionForBlock(h,"Insertion",!0,T)}},e.prototype.insertTocHyperlink=function(e,t,i){var r=' HYPERLINK \\l "'+t+'" ',n=this.createTocFieldElement(e,r,!0),o=new we;return o.text=i,o.line=e,e.children.push(o),n},e.prototype.getPageNumber=function(e){return e.bodyWidget.sectionFormat.restartPageNumbering?e.bodyWidget.page.currentPageNum:this.documentHelper.pages.indexOf(e.bodyWidget.page)+1},e.prototype.insertTocPageNumber=function(e,t,i,r){var n=" PAGEREF"+e+" \\h ",o=this.createTocFieldElement(t,n,!0),s=this.getPageNumber(r).toString(),a=new Ie;return a.fieldBegin=o,i||(s=" "+s),a.text=s,a.line=t,t.children.push(a),this.pageRefFields[e]=a,o},e.prototype.updatePageRef=function(){for(var e=0,t=Object.keys(this.pageRefFields);e<t.length;e++){var i=t[e];if(this.documentHelper.bookmarks.containsKey(i)){var r=this.documentHelper.bookmarks.get(i),n=this.getPageNumber(r.paragraph).toString(),o=this.pageRefFields[i];if(n!==o.text){o.text=n;var s=o.paragraph,a=s.childWidgets.indexOf(o.line),l=o.line.children.indexOf(o);this.documentHelper.layout.reLayoutParagraph(s,a,l)}}}},e.prototype.insertTocBookmark=function(e){var t=void 0;if(e.childWidgets.length>0){var i=e.getSplitWidgets(),r=i[0],n=i.pop(),o=r.childWidgets[0],s=n.childWidgets[n.childWidgets.length-1];if(void 0!==o&&void 0!==s){var a=o.children[0];if(a instanceof je||a instanceof nt)do{a=a.nextNode}while(a instanceof je||a instanceof nt);if(!sf.base.isNullOrUndefined(a)&&a instanceof Ce&&0===a.bookmarkType&&a.name.toLowerCase().match("^_toc"))return a.name;var l=s.children[s.children.length-1];void 0!==a&&void 0!==l&&(this.selection.start.setPositionForSelection(o,a,0,this.selection.start.location),this.selection.end.setPositionForSelection(s,l,l.length,this.selection.end.location),t=this.generateBookmarkName(),this.insertBookmark(t))}}return t},e.prototype.generateBookmarkName=function(){this.tocBookmarkId++;for(var e=10-this.tocBookmarkId.toString().length,t="";e-1>0;)t="0"+t,e--;return"_Toc"+t+this.tocBookmarkId},e.prototype.onCellContentAlignment=function(e,t){this.owner.isShiftingEnabled=!0;var i=this.owner.selection;if(i.isEmpty&&i.start.paragraph.isInsideTable){this.owner.editorHistory&&this.owner.editorHistory.initComplexHistory(i,"MultiSelection"),i.selectTableCell(),this.initHistory("CellContentVerticalAlignment");var r=i.start.paragraph.associatedCell.cellFormat;this.applyCellPropertyValue(i,"verticalAlignment",e,r),this.reLayout(i,!1),this.initHistory("TextAlignment"),this.updateParagraphFormat("textAlignment",t,!1),this.reLayout(this.owner.selection,!1),this.owner.editorHistory&&this.owner.editorHistory.updateComplexHistory()}else this.owner.editorHistory&&this.owner.editorHistory.initComplexHistory(i,"MultiSelection"),sf.base.isNullOrUndefined(i.getTable(i.start,i.end))||(this.updateSelectionTableFormat(i,"CellContentVerticalAlignment",e),this.reLayout(this.owner.selection,!1),this.initHistory("TextAlignment"),this.updateSelectionParagraphFormatting("textAlignment",t,!1),this.reLayout(i,!1)),this.owner.editorHistory&&this.owner.editorHistory.updateComplexHistory()},e.prototype.insertEditRangeElement=function(e){if(!this.documentHelper.isDocumentProtected&&!this.documentHelper.selection.isEmpty){this.initComplexHistory("RestrictEditing"),this.selection.skipEditRangeRetrieval=!0;var t=this.documentHelper.selection;this.selection.start,this.selection.end;if(this.selection.isForward||(this.selection.end,this.selection.start),t.start.paragraph.isInsideTable&&t.end.paragraph.isInsideTable&&t.start.paragraph.associatedCell.ownerTable.contains(t.end.paragraph.associatedCell)){var i=this.getOwnerCell(this.selection.isForward),r=this.getOwnerCell(!this.selection.isForward);if(i.rowIndex===r.rowIndex){for(var n=i.ownerRow.childWidgets.indexOf(i),o=i.ownerRow.childWidgets.indexOf(r),s=[],a=[],l=n;l<=o;l++){var h=this.addEditElement(e);l==n&&this.editorHistory&&this.editorHistory.currentHistoryInfo&&(this.editorHistory.currentHistoryInfo.editRangeStart=h),h.columnFirst=l,h.columnLast=l,h.line=t.start.currentWidget;var d=h.editRangeEnd;d.line=t.end.currentWidget,s.push(h),a.push(d)}this.insertElements(a,s),this.editorHistory&&this.editorHistory.updateComplexHistoryInternal();var c=s[0].line.getOffset(s[0],1);this.selection.start.setPositionParagraph(s[0].line,c),c=a[0].line.getOffset(a[0],1),this.selection.end.setPositionParagraph(a[0].line,c),this.selection.fireSelectionChanged(!0),this.fireContentChange()}else{this.insertEditRangeInsideTable(i,r,e),this.editorHistory&&this.editorHistory.updateComplexHistoryInternal();var p=this.documentHelper.getFirstParagraphInCell(i).childWidgets[0],u=this.selection.getLastParagraph(r).childWidgets[0];c=p.getOffset(p.children[0],1);this.selection.start.setPositionParagraph(p,c),c=u.getOffset(u.children[0],1),this.selection.end.setPositionParagraph(u,c),this.selection.fireSelectionChanged(!0),this.fireContentChange()}}else this.addRestrictEditingForSelectedArea(e);this.selection.skipEditRangeRetrieval=!1}},e.prototype.insertEditRangeInsideTable=function(e,t,i){var r=e.ownerTable,n=r.childWidgets.indexOf(t.ownerRow),o=r.childWidgets.indexOf(e.ownerRow),s=this.selection.getCellLeft(e.ownerRow,e),a=s+e.cellFormat.cellWidth,l=this.selection.getCellLeft(t.ownerRow,t),h=l+t.cellFormat.cellWidth,d=this.updateSelectedCellsInTable(s,a,l,h);s=d.start,a=d.end;for(var c=[],p=o;p<=n;p++){for(var u=r.childWidgets[p],g=-1,f=-1,m=0;m<u.childWidgets.length;m++){var y=u.childWidgets[m],v=this.selection.getCellLeft(u,y);this.checkCellWithInSelection(s,a,v)&&(-1===g&&(g=m),f=m)}for(var b=[],w=g;w<=f;w++){var x=0,M=void 0,N=void 0;w===g&&(M=u.childWidgets[g],N=this.documentHelper.getFirstParagraphInCell(M).childWidgets[0]);var I=this.addEditElement(i);w===g&&this.editorHistory&&this.editorHistory.currentHistoryInfo&&(this.editorHistory.currentHistoryInfo.editRangeStart=I),I.columnFirst=w,I.columnLast=w,I.line=N,I.line.children.splice(x,0,I),x++;var S=I.editRangeEnd;if(b.push(S),c.length>0&&w===f){for(var C=0;C<c.length;C++)c[C].line=I.line,I.line.children.splice(x,0,c[C]),x++;c=[]}}if(c=b,p===n&&c.length>0){var O=u.childWidgets[f],T=this.selection.getLastParagraph(O).lastChild;for(x=T.children.length-1,C=0;C<c.length;C++)c[C].line=T,T.children.splice(x,0,c[C]),x++}}},e.prototype.addRestrictEditingForSelectedArea=function(e){var t=this.addEditElement(e),i=t.editRangeEnd;this.editorHistory&&this.editorHistory.currentHistoryInfo&&(this.editorHistory.currentHistoryInfo.editRangeStart=t),this.insertElements([i],[t]),this.editorHistory&&this.editorHistory.updateComplexHistoryInternal();var r=t.line.getOffset(t,1);this.selection.start.setPositionParagraph(t.line,r),r=i.line.getOffset(i,1),this.selection.end.setPositionParagraph(i.line,r),this.selection.fireSelectionChanged(!0),this.fireContentChange()},e.prototype.addEditElement=function(e){var t=new He;"everyone"===e.toLocaleLowerCase()?t.group=e:t.user=e;var i=new Ue;return i.editRangeStart=t,t.editRangeEnd=i,this.editStartRangeCollection.push(t),this.addEditCollectionToDocument(),this.editStartRangeCollection=[],t},e.prototype.protect=function(e){this.documentHelper.isDocumentProtected=!0,this.documentHelper.protectionType=e,this.selection.highlightEditRegion(),this.editorHistory&&this.editorHistory.destroy()},e.prototype.addEditCollectionToDocument=function(){for(var e=0;e<this.editStartRangeCollection.length;e++){var t=this.editStartRangeCollection[e],i=""===t.user?t.group:t.user;if(this.documentHelper.editRanges.length>0&&this.documentHelper.editRanges.containsKey(i))this.documentHelper.editRanges.get(i).push(t);else{var r=[];r.push(t),this.documentHelper.editRanges.add(i,r)}}this.selection.updateEditRangeCollection()},e.prototype.updateRangeCollection=function(e,t){if(this.documentHelper.editRanges.length>0&&this.documentHelper.editRanges.containsKey(t))this.documentHelper.editRanges.get(t).push(e);else{var i=[];i.push(e),this.documentHelper.editRanges.add(t,i)}},e.prototype.removeUserRestrictions=function(e){if(this.selection.checkSelectionIsAtEditRegion()){this.selection.skipEditRangeRetrieval=!0;var t=this.selection.getEditRangeStartElement();this.initHistory("RemoveEditRange"),this.editorHistory&&(this.editorHistory.currentBaseHistoryInfo.setEditRangeInfo(t),this.editorHistory.updateHistory()),t.user!==e&&t.group!==e||this.removeUserRestrictionsInternal(t,e),this.selection.updateEditRangeCollection(),this.fireContentChange(),this.selection.skipEditRangeRetrieval=!1}},e.prototype.removeUserRestrictionsInternal=function(e,t){var i=t;sf.base.isNullOrUndefined(t)&&(i=""===e.user?e.group:e.user);var r=this.documentHelper.editRanges.get(i).indexOf(e);this.documentHelper.editRanges.get(i).splice(r,1),0===this.documentHelper.editRanges.get(i).length&&this.documentHelper.editRanges.remove(i),e.removeEditRangeMark(),e.editRangeEnd.line.children.splice(e.editRangeEnd.indexInOwner,1),e.line.children.splice(e.indexInOwner,1)},e.prototype.removeAllEditRestrictions=function(){this.selection.skipEditRangeRetrieval=!0;for(var e=this.selection.start,t=this.selection.end,i=[],r=this.documentHelper.editRanges.keys,n=0;n<r.length;n++){i=this.documentHelper.editRanges.get(r[n]);for(var o=0;o<i.length;o++)i[o].editRangeEnd.line.children.splice(i[o].editRangeEnd.indexInOwner,1),i[o].line.children.splice(i[o].indexInOwner,1)}this.documentHelper.editRanges.clear(),this.selection.updateEditRangeCollection(),this.selection.start.setPositionInternal(e),this.selection.end.setPositionInternal(t),this.selection.editRegionHighlighters.clear(),this.owner.viewer.updateScrollBars(),this.selection.fireSelectionChanged(!1),this.selection.skipEditRangeRetrieval=!1},e.prototype.insertFormField=function(e){if(!sf.base.isNullOrUndefined(this.selection.start)&&!this.owner.enableHeaderAndFooter){this.initHistory("InsertHyperlink");var t=!0;this.selection.isEmpty||(t=this.removeSelectedContents(this.selection)),t&&this.insertFormFieldInternal(e)}},e.prototype.insertFormFieldInternal=function(e){this.updateInsertPosition();var t=[],i=this.getCharacterFormat(this.selection),r=new P(void 0);r.copyFormat(i);var n=new fe(0);n.formFieldData=this.getFormFieldData(e),n.characterFormat.copyFormat(r),t.push(n);var o=new Ce(0);o.characterFormat.copyFormat(r),n.formFieldData.name=this.getBookmarkName(e,"Insert",this.formFieldCounter),o.name=n.formFieldData.name,t.push(o);var s=new we;s.text=this.getFormFieldCode(e),t.push(s);var a=new fe(2);t.push(a);var l=new we;l.text="CheckBox"===e?String.fromCharCode(9744):this.documentHelper.textHelper.repeatChar(this.documentHelper.textHelper.getEnSpaceCharacter(),5),l.characterFormat.copyFormat(r),t.push(l);var h=new fe(1);h.characterFormat.copyFormat(r),t.push(h);var d=new Ce(1);d.characterFormat.copyFormat(r),d.name=n.formFieldData.name,d.reference=o,o.reference=d,t.push(d),this.insertElement(t);this.selection.start.paragraph;h.linkFieldCharacter(this.documentHelper),-1===this.documentHelper.fields.indexOf(n)&&this.documentHelper.fields.push(n),-1===this.documentHelper.formFields.indexOf(n)&&this.documentHelper.formFields.push(n);var c=d.line.getOffset(d,1);this.selection.selects(d.line,c,!0),this.updateEndPosition(),this.reLayout(this.selection,!0)},e.prototype.getFormFieldData=function(e){switch(e){case"Text":return new ye;case"CheckBox":return new ve;case"DropDown":return new be}},e.prototype.setFormField=function(e,t){var i,r;sf.base.isNullOrUndefined(t.format)?sf.base.isNullOrUndefined(t.sizeType)?sf.base.isNullOrUndefined(t.dropdownItems)||(i="DropDown",r=new be):(i="CheckBox",r=new ve):(i="Text",r=new ye),sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(r)||(r.name=sf.base.isNullOrUndefined(t.name)?e.formFieldData.name:t.name,r.copyFieldInfo(t),this.editFormField(i,r))},e.prototype.editFormField=function(e,t){var i,r,n=this.selection.getCurrentFormField();if(sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.formFieldData))return!1;this.initComplexHistory("FormField"),""!==t.name&&(n.formFieldData.name!==t.name&&this.documentHelper.bookmarks.containsKey(t.name)&&this.deleteBookmark(t.name),(i=new Ce(0)).name=t.name,(r=new Ce(1)).name=t.name,i.reference=r,r.reference=i),this.initHistory("InsertHyperlink"),this.editHyperlinkInternal=sf.base.isNullOrUndefined(this.editorHistory)||this.editorHistory&&sf.base.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo);var o=n.characterFormat.cloneFormat(),s=new P;s.copyFormat(o);var a=n.fieldSeparator.nextElement.characterFormat.cloneFormat(),l=n.line.getOffset(n,0);this.selection.start.setPositionParagraph(n.line,l);var h=n.fieldEnd;n.nextNode&&n.nextNode instanceof Ce&&(h=n.nextNode.reference),l=h.line.getOffset(h,1),this.selection.end.setPositionParagraph(h.line,l),this.skipFieldDeleteTracking=!0,this.deleteSelectedContents(this.selection,!1),this.skipFieldDeleteTracking=!1,this.updateInsertPosition();var d=[],c=new fe(0);c.formFieldData=t,d.push(c),c.characterFormat.copyFormat(s),sf.base.isNullOrUndefined(i)||d.push(i);var p=new we;p.text=this.getFormFieldCode(e),d.push(p);var u=new fe(2);u.characterFormat.copyFormat(s),d.push(u),(p=new we).characterFormat.copyFormat(a),p.text=this.getDefaultText(t),"CheckBox"===e?(p.characterFormat.copyFormat(c.characterFormat),"Exactly"===t.sizeType&&(p.characterFormat.fontSize=t.size)):t instanceof ye&&""!==t.defaultValue&&("Text"===t.type?p.text=x.formatText(t.format,t.defaultValue):"Number"===t.type?p.text=x.formatNumber(t.format,t.defaultValue):p.text=x.formatDate(t.format,t.defaultValue)),d.push(p);var g=new fe(1);g.characterFormat.copyFormat(s),d.push(g);var f=g;sf.base.isNullOrUndefined(r)||(f=r,d.push(r)),this.insertElement(d);this.selection.start.paragraph;g.linkFieldCharacter(this.documentHelper),-1===this.documentHelper.fields.indexOf(c)&&this.documentHelper.fields.push(c);var m=f.line.getOffset(f,1);return this.selection.selects(f.line,m,!0),this.updateEndPosition(),this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&this.editorHistory.updateHistory(),this.editorHistory&&this.editorHistory.currentHistoryInfo&&this.editorHistory.updateComplexHistory(),this.reLayout(this.selection,!0),this.editHyperlinkInternal=!1,this.nodes=[],!0},e.prototype.getDefaultText=function(e){var t="";return e instanceof ve?t=e.defaultValue?String.fromCharCode(9745):String.fromCharCode(9744):e instanceof be?t=e.dropdownItems.length>0?e.dropdownItems[0]:this.documentHelper.textHelper.repeatChar(this.documentHelper.textHelper.getEnSpaceCharacter(),5):e instanceof ye&&(t=""!==e.defaultValue?e.defaultValue:this.documentHelper.textHelper.repeatChar(this.documentHelper.textHelper.getEnSpaceCharacter(),5)),t},e.prototype.getFormFieldCode=function(e){switch(e){case"Text":return"FORMTEXT";case"CheckBox":return"FORMCHECKBOX";case"DropDown":return"FORMDROPDOWN"}},e.prototype.toggleCheckBoxFormField=function(e,t,i){var r=e.formFieldData;if(r instanceof ve&&r.enabled){if(this.initHistory("UpdateFormField"),this.editorHistory){var n=void 0;r instanceof ve&&(n=r.checked),this.editorHistory.currentBaseHistoryInfo.setFormFieldInfo(e,n),this.editorHistory.updateHistory()}r.checked=t?i:!r.checked;var o=e.fieldSeparator.nextNode;r.checked?o.text=String.fromCharCode(9745):o.text=String.fromCharCode(9744),this.owner.documentHelper.layout.reLayoutParagraph(e.line.paragraph,0,0),this.reLayout(this.selection,!1)}},e.prototype.updateFormField=function(e,t,i){var r=e.formFieldData;r&&this.updateFormFieldInternal(e,r,t,i)},e.prototype.updateFormFieldInternal=function(e,t,i,r){if(t instanceof ye){""===i&&(i=r?this.getDefaultText(t):this.documentHelper.textHelper.repeatChar(this.documentHelper.textHelper.getEnSpaceCharacter(),5));var n=i;"Text"===t.type&&""!==t.format&&(n=x.formatText(t.format,i)),this.updateFormFieldResult(e,n)}else if(t instanceof be){var o=t.dropdownItems[i];t.selectedIndex=i,this.updateFormFieldResult(e,o)}var s=e.fieldEnd.line.getOffset(e.fieldEnd,1),a=new Ft(this.owner);a.setPositionParagraph(e.fieldEnd.line,s),this.documentHelper.selection.selectRange(a,a),this.reLayout(this.selection,!1)},e.prototype.updateFormFieldResult=function(e,t){this.selection.selectFieldInternal(e,!1,!0),this.insertText(t)},e.prototype.checkBookmarkAvailability=function(e,t){for(var i=this.documentHelper.bookmarks,r=0;r<i.length;r++)if(i.containsKey(e))return!1;return!0},e.prototype.getBookmarkName=function(e,t,i){for(var r,n=!1;!1===n;)r=e+i,n=this.checkBookmarkAvailability(r,t),i+=1;return r},e.prototype.applyFormTextFormat=function(e){if(!sf.base.isNullOrUndefined(e)){var t=this.getFieldResultText(e),i=t;t=x.formatText(e.formFieldData.format,t),null!=e.fieldSeparator&&this.applyTextFormatInternal(e,t),this.initHistory("FormTextFormat"),this.editorHistory&&(this.editorHistory.currentBaseHistoryInfo.setFormFieldInfo(e,i),this.editorHistory.updateHistory())}},e.prototype.insertSpaceInFormField=function(){if(this.documentHelper.isInlineFormFillProtectedMode&&this.selection.isInlineFormFillMode()){var e=this.getFieldResultText();0!==e.length&&"\r"!==e||(this.insertTextInternal(this.documentHelper.textHelper.repeatChar(this.documentHelper.textHelper.getEnSpaceCharacter(),5),!0),this.selection.selectTextElementStartOfField(this.selection.getCurrentFormField()))}},e.prototype.getFieldResultText=function(e){sf.base.isNullOrUndefined(e)&&(e=this.selection.getCurrentFormField());var t=this.selection.startOffset,i=this.selection.endOffset;this.selection.isModifyingSelectionInternally=!0,this.selection.selectFieldInternal(e,!1,!0);var r=this.selection.getText(!1);return this.selection.select(t,i),this.selection.isModifyingSelectionInternally=!1,r},e.prototype.applyTextFormatInternal=function(e,t){var i=e.fieldSeparator.nextElement,r=0;t=t.replace(/\r/g,"");do{if(!sf.base.isNullOrUndefined(i)&&i instanceof we&&(i.text=t.slice(r,r+i.text.length),r+=i.length),sf.base.isNullOrUndefined(i.nextElement))if(sf.base.isNullOrUndefined(i.line.nextLine)){this.documentHelper.layout.layoutBodyWidgetCollection(i.paragraph.index,i.paragraph.bodyWidget,i.paragraph,!0);var n=i.paragraph.nextRenderedWidget;if(sf.base.isNullOrUndefined(n))break;for(n instanceof de&&(n=this.documentHelper.getFirstParagraphBlock(n));n.isEmpty();)n=n.nextRenderedWidget;i=n.childWidgets[0].children[0]}else i=i.line.nextLine.children[0];else i=i.nextElement}while(!(i instanceof fe&&1===i.fieldType&&i.fieldBegin.formFieldData instanceof ye));this.documentHelper.layout.layoutBodyWidgetCollection(i.paragraph.index,i.paragraph.bodyWidget,i.paragraph,!0),this.selection.isFormatUpdated=!0,this.reLayout(this.selection,!1),this.selection.isFormatUpdated=!1},e.prototype.constructCommentInitial=function(e){for(var t=e.split(" "),i="",r=0;r<t.length;r++)t[r].length>0&&""!==t[r]&&(i+=t[r][0]);return i},e.prototype.insertFootnote=function(){if(!this.selection.isinFootnote&&!this.selection.isinEndnote){this.isFootNoteInsert=!0,this.isFootNote=!0;var e=new Me;e.characterFormat.baselineAlignment="Superscript",e.footnoteType="Footnote",e.text="s";var t=new le,i=new ue(t),r=new we;r.characterFormat.baselineAlignment="Superscript",r.line=i,r.text="?",i.children.push(r);var n,o=new we;if(o.text=" ",o.line=i,i.children.push(o),t.childWidgets.push(i),e.bodyWidget.childWidgets.push(t),this.selection.isEmpty||this.selection.handleRightKey(),this.initInsertInline(e),e.paragraph.bodyWidget.page.footnoteWidget)for(var s=0;s<e.paragraph.bodyWidget.page.footnoteWidget.bodyWidgets.length;s++)e.paragraph.bodyWidget.page.footnoteWidget.bodyWidgets[s].footNoteReference===e&&(n=e.paragraph.bodyWidget.page.footnoteWidget.bodyWidgets[s].childWidgets[0]);this.selection.start.setPositionForLineWidget(n.childWidgets[0],o.line.getOffset(o,e.text.length)),this.selection.end.setPositionInternal(this.selection.start),this.updateFootNoteIndex(),this.reLayout(this.selection,!1),this.separator("footnote"),this.continuationSeparator("footnote"),this.isFootNote=!1}},e.prototype.updateFootnoteCollection=function(e){if(-1===this.documentHelper.footnoteCollection.indexOf(e)){var t=!1;if(this.documentHelper.footnoteCollection.length>0)for(var i=this.selection.getElementPosition(e).startPosition,r=0;r<this.documentHelper.footnoteCollection.length;r++){var n=this.selection.getElementPosition(this.documentHelper.footnoteCollection[r]).startPosition;if(i.isExistBefore(n)){t=!0,this.documentHelper.footnoteCollection.splice(r,0,e);break}}t||this.documentHelper.footnoteCollection.push(e)}},e.prototype.insertEndnote=function(){if(!this.selection.isinFootnote&&!this.selection.isinEndnote){this.documentHelper.layout.isEndnoteContentChanged=!0;var e=new Me;e.characterFormat.baselineAlignment="Superscript",e.footnoteType="Endnote",e.text="s";var t=new le,i=new ue(t),r=new we;r.characterFormat.baselineAlignment="Superscript",r.line=i,r.text="?",i.children.push(r);var n=new we;n.text=" ",n.line=i,i.children.push(n),t.childWidgets.push(i),e.bodyWidget.childWidgets.push(t),this.selection.isEmpty||this.selection.handleRightKey(),this.initInsertInline(e);var o,s=this.documentHelper.pages.length,a=this.documentHelper.pages[s-1].bodyWidgets[0];if(a.page.endnoteWidget)for(var l=0;l<a.page.endnoteWidget.bodyWidgets.length;l++)a.page.endnoteWidget.bodyWidgets[l].footNoteReference===e&&(o=a.page.endnoteWidget.bodyWidgets[l].childWidgets[0]);this.selection.start.setPositionForLineWidget(o.childWidgets[0],r.line.getOffset(n,e.text.length)),this.selection.end.setPositionInternal(this.selection.start),this.updateEndNoteIndex(),this.reLayout(this.selection,!1),this.separator("endnote"),this.continuationSeparator("endnote"),this.documentHelper.layout.isEndnoteContentChanged=!1}},e.prototype.updateEndnoteCollection=function(e){if(-1===this.documentHelper.endnoteCollection.indexOf(e)){var t=!1;if(this.documentHelper.endnoteCollection.length>0)for(var i=this.selection.getElementPosition(e).startPosition,r=0;r<this.documentHelper.endnoteCollection.length;r++){var n=this.selection.getElementPosition(this.documentHelper.endnoteCollection[r]).startPosition;if(i.isExistBefore(n)){t=!0,this.documentHelper.endnoteCollection.splice(r,0,e);break}}t||this.documentHelper.endnoteCollection.push(e);var o=this.documentHelper.pages.length;if(this.documentHelper.endnoteCollection.length>0){var s,a=!1,l=void 0,h=this.documentHelper.endnoteCollection.indexOf(e),d=1,c=void 0,p=this.documentHelper.pages[o-1].bodyWidgets[0];if(p.page.endnoteWidget)for(var u=0;u<p.page.endnoteWidget.bodyWidgets.length;u++){var g=this.documentHelper.endnoteCollection.indexOf(p.page.endnoteWidget.bodyWidgets[u].footNoteReference);if(g>h&&g-h==1){d=u,a=!0;break}}if(s=e,p.page.endnoteWidget instanceof ae&&"Endnote"===p.page.endnoteWidget.footNoteType)l=p.page.endnoteWidget;else{c=!0,(l=new ae).footNoteType="Endnote",l.page=p.page;var f=new le;f.characterFormat=new P,f.paragraphFormat=new ct,f.index=0;var m=new ue(f);f.childWidgets.push(m),this.viewer.cutFromTop(this.viewer.clientActiveArea.y+18)}var y=s.bodyWidget;for(u=0;u<s.bodyWidget.childWidgets.length;u++){var v=s.bodyWidget.childWidgets[u];this.documentHelper.layout.isLayoutWhole?v.containerWidget=void 0:(v.containerWidget=y,y.page=p.page,y.sectionFormat=l.sectionFormat,v.containerWidget.containerWidget=l),a?l.bodyWidgets.splice(d,0,y):l.bodyWidgets.push(y)}d++,c&&(p.page.endnoteWidget=l),l.height+=0}}},e.prototype.updateEndNoteIndex=function(){for(var e=this.documentHelper.endnoteCollection,t=0;t<e.length;t++)sf.base.isNullOrUndefined(e[t].bodyWidget.childWidgets[0].childWidgets[0].children[0])||(e[t].bodyWidget.childWidgets[0].childWidgets[0].children[0].text=e[t].text)},e.prototype.separator=function(e){var t=new le,i=new ue(t),r=new we;r.characterFormat.fontColor="#00000000",r.line=i,r.text=String.fromCharCode(3),i.children.push(r),t.childWidgets.push(i),"footnote"===e&&this.documentHelper.footnotes.separator.length<1?this.documentHelper.footnotes.separator.push(t):"endnote"===e&&this.documentHelper.endnotes.separator.length<1&&this.documentHelper.endnotes.separator.push(t)},e.prototype.continuationSeparator=function(e){var t=new le,i=new ue(t),r=new we;r.characterFormat.fontColor="#00000000",r.line=i,r.text=String.fromCharCode(4),i.children.push(r),t.childWidgets.push(i),"footnote"===e&&this.documentHelper.footnotes.continuationSeparator.length<1?this.documentHelper.footnotes.continuationSeparator.push(t):"endnote"===e&&this.documentHelper.endnotes.continuationSeparator.length<1&&this.documentHelper.endnotes.continuationSeparator.push(t)},e.prototype.updateFootNoteIndex=function(){for(var e=this.documentHelper.footnoteCollection,t=0;t<e.length;t++)e[t].text=(t+1).toString(),sf.base.isNullOrUndefined(e[t].bodyWidget.childWidgets[0].childWidgets[0].children[0])||(e[t].bodyWidget.childWidgets[0].childWidgets[0].children[0].text=(t+1).toString())},e.prototype.onParagraphFormat=function(e){var t=this.documentHelper.selection,i=e.bidi&&-1!==t.paragraphFormat.listId;i||(this.documentHelper.layout.isBidiReLayout=!0),this.setPreviousBlockToLayout(),this.initHistory("ParagraphFormat"),this.documentHelper.owner.isShiftingEnabled=!0,this.documentHelper.selection.isEmpty?(this.applyParaFormatProperty(t.start.paragraph,void 0,e,!1),this.layoutItemBlock(t.start.paragraph,!1)):this.updateSelectionParagraphFormatting("ParagraphFormat",e,!1),this.reLayout(t),i||(this.documentHelper.layout.isBidiReLayout=!1)},e.prototype.clear=function(){this.pageRefFields&&(this.pageRefFields={})},e}(),ri=function(){function e(e,t){this.resizeContainerDiv=void 0,this.topLeftRect=void 0,this.topMiddleRect=void 0,this.topRightRect=void 0,this.bottomLeftRect=void 0,this.bottomMiddleRect=void 0,this.bottomRightRect=void 0,this.leftMiddleRect=void 0,this.rightMiddleRect=void 0,this.topLeftRectParent=void 0,this.topMiddleRectParent=void 0,this.topRightRectParent=void 0,this.bottomLeftRectParent=void 0,this.bottomMiddleRectParent=void 0,this.bottomRightRectParent=void 0,this.leftMiddleRectParent=void 0,this.rightMiddleRectParent=void 0,this.resizeMarkSizeIn=7,this.selectedImageWidget=void 0,this.baseHistoryInfo=void 0,this.isImageResizing=!1,this.isImageResizerVisible=!1,this.isImageMoveToNextPage=!1,this.selectedResizeElement=void 0,this.topValue=void 0,this.leftValue=void 0,this.owner=e,this.selectedImageWidget=new a,this.documentHelper=t,this.imageResizerPoints=new ni,sf.base.isNullOrUndefined(this.imageResizerDiv)&&this.viewer&&this.documentHelper.pageContainer&&this.initializeImageResizer()}return Object.defineProperty(e.prototype,"currentImageElementBox",{get:function(){return this.currentImageElementBoxIn},set:function(e){this.currentImageElementBoxIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"resizeMarkSize",{get:function(){return this.resizeMarkSizeIn},set:function(e){this.resizeMarkSizeIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isShapeResize",{get:function(){return this.currentImageElementBox instanceof Ee},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"viewer",{get:function(){return this.owner.viewer},enumerable:!0,configurable:!0}),e.prototype.getModuleName=function(){return"ImageResizer"},e.prototype.setImageResizerPositions=function(e,t,i,r){this.imageResizerDivElement.style.top=t.toString()+"px",this.imageResizerDivElement.style.left=e.toString()+"px",this.imageResizerDivElement.style.borderWidth="0px",this.imageResizerDivElement.style.height=r+"px",this.owner.viewer instanceof Z?this.imageResizerDivElement.style.width=i-e-this.documentHelper.scrollbarWidth+"px":this.imageResizerDivElement.style.width=i+"px",this.imageResizerDivElement.style.backgroundColor="transparent",this.imageResizerDivElement.style.overflow="hidden",this.imageResizerDivElement.style.position="absolute"},e.prototype.initializeImageResizer=function(){this.imageResizerDivElement=document.createElement("div"),this.imageResizerDivElement.style.zIndex="1",this.imageResizerDivElement.style.display="none",this.documentHelper.pageContainer.appendChild(this.imageResizerDivElement)},e.prototype.positionImageResizer=function(e){var t;this.selectedImageWidget.clear(),sf.base.isNullOrUndefined(this.documentHelper.currentPage)||(t=this.imageResizerDivElement),sf.base.isNullOrUndefined(t)||t.contains(this.imageResizerDiv)||(this.imageResizerDiv=this.initResizeMarks(t,this)),this.imageResizerDiv.style.width=e.width+"px",this.imageResizerDiv.style.height=e.height+"px",this.currentImageElementBox=e;var i,r,n=e.line;e instanceof Re&&"Inline"!==e.textWrappingStyle?(i=e.y,r=e.x):(i=this.documentHelper.selection.getTop(n)+e.margin.top,r=this.documentHelper.selection.getLeftInternal(n,e,0));var o=this.documentHelper.selection.getPage(n.paragraph);this.currentPage=o;sf.base.isNullOrUndefined(t)||(this.owner.viewer instanceof Z&&(this.imageResizerDivElement.style.width=o.boundingRectangle.width-o.boundingRectangle.x-r-this.documentHelper.scrollbarWidth+"px"),this.imageResizerDivElement.style.display="block",this.owner.viewer instanceof Z?t.style.width=o.boundingRectangle.width-this.documentHelper.scrollbarWidth-o.boundingRectangle.x-r+"px":t.style.width=o.boundingRectangle.width+"px",t.style.height=o.boundingRectangle.height+"px",t.style.left=o.boundingRectangle.x+"px",t.style.top=o.boundingRectangle.y+"px",t.style.borderWidth="0px",t.style.backgroundColor="transparent",t.style.overflow="hidden",t.style.position="absolute");var s,a=this.documentHelper.getPageWidth(o);s=parseFloat(this.imageResizerDivElement.style.width),this.documentHelper.visibleBounds.width,this.documentHelper.zoomFactor,a<s&&this.documentHelper.zoomFactor;var l=this.imageResizerDivElement,h=parseFloat(l.style.width),d=parseFloat(l.style.height),c=parseFloat(this.imageResizerDiv.style.width),p=parseFloat(this.imageResizerDiv.style.height),u=(this.resizeMarkSize-1)/2,g=c+2*u,f=p+2*u;if(g>(h-r)*this.documentHelper.zoomFactor+u&&(g=(h-r)*this.documentHelper.zoomFactor),f>(d-i)*this.documentHelper.zoomFactor+u&&(f=(d-i)*this.documentHelper.zoomFactor),this.imageResizerDivElement.style.width=parseInt(this.imageResizerDivElement.style.width.replace("px",""),10)*this.documentHelper.zoomFactor+"px",this.imageResizerDivElement.style.height=parseInt(this.imageResizerDivElement.style.height.replace("px",""),10)*this.documentHelper.zoomFactor+"px",f=this.documentHelper.render.getScaledValue(e.height),g=this.documentHelper.render.getScaledValue(e.width),e instanceof Re?(r=this.documentHelper.render.getScaledValue(r),i=this.documentHelper.render.getScaledValue(i)):(r=e.x*this.documentHelper.zoomFactor,i=e.y*this.documentHelper.zoomFactor),this.setImageResizerPosition(r,i,g,f,this),this.owner.selection.isInShape?this.resizeContainerDiv.style.borderStyle="dashed":this.resizeContainerDiv.style.borderStyle="solid",!this.selectedImageWidget.containsKey(n)){var m=new oi(e.height,e.width);this.selectedImageWidget.add(n,m)}},e.prototype.showImageResizer=function(){sf.base.isNullOrUndefined(this.imageResizerDivElement)||(this.imageResizerDivElement.style.display=""),sf.base.isNullOrUndefined(this.resizeContainerDiv)||(this.resizeContainerDiv.style.display=""),sf.base.isNullOrUndefined(this.bottomLeftRect)||(this.bottomLeftRect.style.display="",this.bottomLeftRectParent.style.display=""),sf.base.isNullOrUndefined(this.bottomRightRect)||(this.bottomRightRect.style.display="",this.bottomRightRectParent.style.display=""),sf.base.isNullOrUndefined(this.bottomMiddleRect)||(this.bottomMiddleRect.style.display="",this.bottomMiddleRectParent.style.display=""),sf.base.isNullOrUndefined(this.rightMiddleRect)||(this.rightMiddleRect.style.display="",this.rightMiddleRectParent.style.display=""),sf.base.isNullOrUndefined(this.topRightRect)||(this.topRightRect.style.display="",this.topRightRectParent.style.display=""),sf.base.isNullOrUndefined(this.topLeftRect)||(this.topLeftRect.style.display="",this.topLeftRectParent.style.display=""),sf.base.isNullOrUndefined(this.leftMiddleRect)||(this.leftMiddleRect.style.display="",this.leftMiddleRectParent.style.display=""),sf.base.isNullOrUndefined(this.topMiddleRect)||(this.topMiddleRect.style.display="",this.topMiddleRectParent.style.display=""),this.isImageResizerVisible=!0},e.prototype.hideImageResizer=function(){sf.base.isNullOrUndefined(this.imageResizerDivElement)||(this.imageResizerDivElement.style.display="none"),sf.base.isNullOrUndefined(this.resizeContainerDiv)||(this.resizeContainerDiv.style.display="none"),sf.base.isNullOrUndefined(this.bottomLeftRect)||(this.bottomLeftRect.style.display="none",this.bottomLeftRectParent.style.display="none"),sf.base.isNullOrUndefined(this.bottomRightRect)||(this.bottomRightRect.style.display="none",this.bottomRightRectParent.style.display="none"),sf.base.isNullOrUndefined(this.bottomMiddleRect)||(this.bottomMiddleRect.style.display="none",this.bottomMiddleRectParent.style.display="none"),sf.base.isNullOrUndefined(this.rightMiddleRect)||(this.rightMiddleRect.style.display="none",this.rightMiddleRectParent.style.display="none"),sf.base.isNullOrUndefined(this.topRightRect)||(this.topRightRect.style.display="none",this.topRightRectParent.style.display="none"),sf.base.isNullOrUndefined(this.topLeftRect)||(this.topLeftRect.style.display="none",this.topLeftRectParent.style.display="none"),sf.base.isNullOrUndefined(this.leftMiddleRect)||(this.leftMiddleRect.style.display="none",this.leftMiddleRectParent.style.display="none"),sf.base.isNullOrUndefined(this.topMiddleRect)||(this.topMiddleRect.style.display="none",this.topMiddleRectParent.style.display="none"),this.isImageResizerVisible=!1,this.currentPage=void 0},e.prototype.initResizeMarks=function(e,t){return this.initResizeContainerDiv(t),e.appendChild(t.resizeContainerDiv),t.topRightRectParent=document.createElement("div"),t.topRightRectParent.style.cursor="ne-resize",t.topRightRectParent.id=this.documentHelper.owner.containerId+"_TopRightRectParent",this.applyProperties(t.topRightRectParent),t.topRightRectParent.style.width=this.documentHelper.isTouchInput?"30px":"14px",t.topRightRectParent.style.height=this.documentHelper.isTouchInput?"30px":"14px",t.topRightRectParent.style.opacity="-1",e.appendChild(t.topRightRectParent),t.topRightRect=document.createElement("div"),t.topRightRect.id=this.documentHelper.owner.containerId+"_TopRightRect",t.topRightRect.style.cursor="ne-resize",this.applyProperties(t.topRightRect),e.appendChild(t.topRightRect),t.topLeftRectParent=document.createElement("div"),t.topLeftRectParent.style.cursor="nw-resize",t.topLeftRectParent.id=this.documentHelper.owner.containerId+"_TopLeftRectParent",this.applyProperties(t.topLeftRectParent),t.topLeftRectParent.style.width=this.documentHelper.isTouchInput?"30px":"14px",t.topLeftRectParent.style.height=this.documentHelper.isTouchInput?"30px":"14px",t.topLeftRectParent.style.opacity="-1",e.appendChild(t.topLeftRectParent),t.topLeftRect=document.createElement("div"),t.topLeftRect.id=this.documentHelper.owner.containerId+"_TopLeftRect",t.topLeftRect.style.cursor="nw-resize",this.applyProperties(t.topLeftRect),e.appendChild(t.topLeftRect),t.topMiddleRectParent=document.createElement("div"),t.topMiddleRectParent.style.cursor="n-resize",t.topMiddleRectParent.id=this.documentHelper.owner.containerId+"_TopMiddleRectParent",this.applyProperties(t.topMiddleRectParent),t.topMiddleRectParent.style.width=this.documentHelper.isTouchInput?"30px":"14px",t.topMiddleRectParent.style.height=this.documentHelper.isTouchInput?"30px":"14px",t.topMiddleRectParent.style.opacity="-1",e.appendChild(t.topMiddleRectParent),t.topMiddleRect=document.createElement("div"),t.topMiddleRect.id=this.documentHelper.owner.containerId+"_TopMiddleRect",t.topMiddleRect.style.cursor="n-resize",this.applyProperties(t.topMiddleRect),e.appendChild(t.topMiddleRect),t.bottomRightRectParent=document.createElement("div"),t.bottomRightRectParent.style.cursor="se-resize",t.bottomRightRectParent.id=this.documentHelper.owner.containerId+"_BottomRightRectParent",this.applyProperties(t.bottomRightRectParent),t.bottomRightRectParent.style.width=this.documentHelper.isTouchInput?"30px":"14px",t.bottomRightRectParent.style.height=this.documentHelper.isTouchInput?"30px":"14px",t.bottomRightRectParent.style.opacity="-1",e.appendChild(t.bottomRightRectParent),t.bottomRightRect=document.createElement("div"),t.bottomRightRect.id=this.documentHelper.owner.containerId+"_BottomRightRect",t.bottomRightRect.style.cursor="se-resize",this.applyProperties(t.bottomRightRect),e.appendChild(t.bottomRightRect),t.bottomLeftRectParent=document.createElement("div"),t.bottomLeftRectParent.style.cursor="sw-resize",t.bottomLeftRectParent.id=this.documentHelper.owner.containerId+"_BottomLeftRectParent",this.applyProperties(t.bottomLeftRectParent),t.bottomLeftRectParent.style.width=this.documentHelper.isTouchInput?"30px":"14px",t.bottomLeftRectParent.style.height=this.documentHelper.isTouchInput?"30px":"14px",t.bottomLeftRectParent.style.opacity="-1",e.appendChild(t.bottomLeftRectParent),t.bottomLeftRect=document.createElement("div"),t.bottomLeftRect.id=this.documentHelper.owner.containerId+"_BottomLeftRect",t.bottomLeftRect.style.cursor="sw-resize",this.applyProperties(t.bottomLeftRect),e.appendChild(t.bottomLeftRect),t.bottomMiddleRectParent=document.createElement("div"),t.bottomMiddleRectParent.style.cursor="s-resize",t.bottomMiddleRectParent.id=this.documentHelper.owner.containerId+"_BottomMiddleRectParent",this.applyProperties(t.bottomMiddleRectParent),t.bottomMiddleRectParent.style.width=this.documentHelper.isTouchInput?"30px":"14px",t.bottomMiddleRectParent.style.height=this.documentHelper.isTouchInput?"30px":"14px",t.bottomMiddleRectParent.style.opacity="-1",e.appendChild(t.bottomMiddleRectParent),t.bottomMiddleRect=document.createElement("div"),t.bottomMiddleRect.id=this.documentHelper.owner.containerId+"_BottomMiddleRect",t.bottomMiddleRect.style.cursor="s-resize",this.applyProperties(t.bottomMiddleRect),e.appendChild(t.bottomMiddleRect),t.rightMiddleRectParent=document.createElement("div"),t.rightMiddleRectParent.style.cursor="e-resize",t.rightMiddleRectParent.id=this.documentHelper.owner.containerId+"_RightMiddleRectParent",this.applyProperties(t.rightMiddleRectParent),t.rightMiddleRectParent.style.width=this.documentHelper.isTouchInput?"30px":"14px",t.rightMiddleRectParent.style.height=this.documentHelper.isTouchInput?"30px":"14px",t.rightMiddleRectParent.style.opacity="-1",e.appendChild(t.rightMiddleRectParent),t.rightMiddleRect=document.createElement("div"),t.rightMiddleRect.id=this.documentHelper.owner.containerId+"_RightMiddleRect",t.rightMiddleRect.style.cursor="e-resize",this.applyProperties(t.rightMiddleRect),e.appendChild(t.rightMiddleRect),t.leftMiddleRectParent=document.createElement("div"),t.leftMiddleRectParent.style.cursor="w-resize",t.leftMiddleRectParent.id=this.documentHelper.owner.containerId+"_LeftMiddleRectParent",this.applyProperties(t.leftMiddleRectParent),t.leftMiddleRectParent.style.width=this.documentHelper.isTouchInput?"30px":"14px",t.leftMiddleRectParent.style.height=this.documentHelper.isTouchInput?"30px":"14px",t.leftMiddleRectParent.style.opacity="-1",e.appendChild(t.leftMiddleRectParent),t.leftMiddleRect=document.createElement("div"),t.leftMiddleRect.id=this.documentHelper.owner.containerId+"_LeftMiddleRect",t.leftMiddleRect.style.cursor="w-resize",this.applyProperties(t.leftMiddleRect),e.appendChild(t.leftMiddleRect),t.resizeContainerDiv},e.prototype.setImageResizerPosition=function(e,t,i,r,n){n.resizeContainerDiv.style.width=i+"px",n.resizeContainerDiv.style.height=r+"px",n.resizeContainerDiv.style.left=e+"px",n.resizeContainerDiv.style.top=t+"px",n.topRightRect.style.left=e+i-5+"px",n.topRightRect.style.top=t-4+"px",n.topLeftRect.style.left=e-5+"px",n.topLeftRect.style.top=t-4+"px",n.topMiddleRect.style.left=parseFloat(n.topLeftRect.style.left)+i/2-4+"px",n.topMiddleRect.style.top=t-4+"px",n.bottomRightRect.style.left=n.topRightRect.style.left,n.bottomRightRect.style.top=parseFloat(n.topRightRect.style.top)+r+"px",n.bottomLeftRect.style.left=n.topLeftRect.style.left,n.bottomLeftRect.style.top=parseFloat(n.topLeftRect.style.top)+r+"px",n.bottomMiddleRect.style.left=n.topMiddleRect.style.left,n.bottomMiddleRect.style.top=parseFloat(n.topMiddleRect.style.top)+r+"px",n.rightMiddleRect.style.left=e+i-4+"px",n.rightMiddleRect.style.top=parseFloat(n.topRightRect.style.top)+r/2+"px",n.leftMiddleRect.style.left=n.topLeftRect.style.left,n.leftMiddleRect.style.top=parseFloat(n.topLeftRect.style.top)+r/2+"px",n.topRightRectParent.style.left=this.documentHelper.isTouchInput?e+i-15+"px":e+i-8+"px",n.topRightRectParent.style.top=this.documentHelper.isTouchInput?t-15+"px":t-7+"px",n.topLeftRectParent.style.left=this.documentHelper.isTouchInput?e-15+"px":e-8+"px",n.topLeftRectParent.style.top=this.documentHelper.isTouchInput?t-15+"px":t-7+"px",n.topMiddleRectParent.style.left=parseFloat(n.topLeftRectParent.style.left)+i/2-4+"px",n.topMiddleRectParent.style.top=this.documentHelper.isTouchInput?t-15+"px":t-7+"px",n.bottomRightRectParent.style.left=n.topRightRectParent.style.left,n.bottomRightRectParent.style.top=parseFloat(n.topRightRectParent.style.top)+r+"px",n.bottomLeftRectParent.style.left=n.topLeftRectParent.style.left,n.bottomLeftRectParent.style.top=parseFloat(n.topLeftRectParent.style.top)+r+"px",n.bottomMiddleRectParent.style.left=n.topMiddleRectParent.style.left,n.bottomMiddleRectParent.style.top=parseFloat(n.topMiddleRectParent.style.top)+r+"px",n.rightMiddleRectParent.style.left=this.documentHelper.isTouchInput?e+i-15+"px":e+i-7+"px",n.rightMiddleRectParent.style.top=parseFloat(n.topRightRectParent.style.top)+r/2+"px",n.leftMiddleRectParent.style.left=n.topLeftRectParent.style.left,n.leftMiddleRectParent.style.top=parseFloat(n.topLeftRectParent.style.top)+r/2+"px",this.setImageResizingPoints(n),this.documentHelper.isTouchInput?this.applyPropertiesForTouch():this.applyPropertiesForMouse()},e.prototype.setImageResizingPoints=function(e){this.imageResizerPoints.resizeContainerDiv.x=parseFloat(e.resizeContainerDiv.style.left),this.imageResizerPoints.resizeContainerDiv.y=parseFloat(e.resizeContainerDiv.style.top),this.imageResizerPoints.bottomLeftRectParent.x=parseFloat(e.bottomLeftRectParent.style.left),this.imageResizerPoints.bottomLeftRectParent.y=parseFloat(e.bottomLeftRectParent.style.top),this.imageResizerPoints.bottomRightRectParent.x=parseFloat(e.bottomRightRectParent.style.left),this.imageResizerPoints.bottomRightRectParent.y=parseFloat(e.bottomRightRectParent.style.top),this.imageResizerPoints.bottomMiddleRectParent.x=parseFloat(e.bottomMiddleRectParent.style.left),this.imageResizerPoints.bottomMiddleRectParent.y=parseFloat(e.bottomMiddleRectParent.style.top),this.imageResizerPoints.topLeftRectParent.x=parseFloat(e.topLeftRectParent.style.left),this.imageResizerPoints.topLeftRectParent.y=parseFloat(e.topLeftRectParent.style.top),this.imageResizerPoints.topRightRectParent.x=parseFloat(e.topRightRectParent.style.left),this.imageResizerPoints.topRightRectParent.y=parseFloat(e.topRightRectParent.style.top),this.imageResizerPoints.topMiddleRectParent.x=parseFloat(e.topMiddleRectParent.style.left),this.imageResizerPoints.topMiddleRectParent.y=parseFloat(e.topMiddleRectParent.style.top),this.imageResizerPoints.leftMiddleRectParent.x=parseFloat(e.leftMiddleRectParent.style.left),this.imageResizerPoints.leftMiddleRectParent.y=parseFloat(e.leftMiddleRectParent.style.top),this.imageResizerPoints.rightMiddleRectParent.x=parseFloat(e.rightMiddleRectParent.style.left),this.imageResizerPoints.rightMiddleRectParent.y=parseFloat(e.rightMiddleRectParent.style.top)},e.prototype.initResizeContainerDiv=function(e){e.resizeContainerDiv=document.createElement("div"),e.resizeContainerDiv.id=this.documentHelper.owner.containerId+"_ResizeDivElement",e.resizeContainerDiv.style.position="absolute",e.resizeContainerDiv.style.border="1px solid #bfbfbf",e.resizeContainerDiv.style.zIndex="30",e.resizeContainerDiv.style.backgroundColor="transparent",e.resizeContainerDiv.style.display="block"},e.prototype.applyProperties=function(e){e.style.position="absolute",e.style.width="8px",e.style.height="8px",e.style.fontSize="0px",e.style.zIndex=" 551",e.style.backgroundColor="#ffffff",e.style.border="1px solid #bfbfbf",e.style.boxShadow="0 1px 2px 0 #bfbfbf 0.35",e.style.color="#000000"},e.prototype.handleImageResizing=function(e,t,i){var r;t/=this.documentHelper.zoomFactor,i/=this.documentHelper.zoomFactor,this.leftValue=sf.base.isNullOrUndefined(this.leftValue)?t:this.leftValue,this.topValue=sf.base.isNullOrUndefined(this.topValue)?i:this.topValue;var n=this.selectedResizeElement.id.split("_"),o=n[n.length-1];switch(o){case"TopRightRectParent":t=(r=this.topRightResizing(e)).left,i=r.top;break;case"TopLeftRectParent":t=-(r=this.topLeftResizing(e)).left,i=-r.top;break;case"TopMiddleRectParent":t=0,i=this.topMiddleResizing(e);break;case"BottomRightRectParent":t=(r=this.bottomRightResizing(e)).left,i=r.top;break;case"BottomLeftRectParent":t=-(r=this.bottomLeftResizing(e)).left,i=-r.top;break;case"BottomMiddleRectParent":i=e.y-i,t=0;break;case"RightMiddleRectParent":t=e.x-t,i=0;break;case"LeftMiddleRectParent":t=this.leftMiddleResizing(e),i=0}if(0!==t||0!==i){var s=this.currentImageElementBox.line.paragraph,a=this.currentImageElementBox;if(!sf.base.isNullOrUndefined(s)&&s.isInsideTable){var l=s.containerWidget;if(!sf.base.isNullOrUndefined(l)){var h=l.containerWidget,d=x.convertPointToPixel(a.height),c=h.height-d;i>0&&h.y+c+d+i>this.viewer.clientArea.bottom&&(this.isImageMoveToNextPage=!0)}}if(this.owner.enableHistoryMode&&this.initHistoryForImageResizer(this.currentImageElementBox),!sf.base.isNullOrUndefined(this.currentImageElementBox)){var p=this.currentImageElementBox.width+t>10?this.currentImageElementBox.width+t:10,u=this.currentImageElementBox.height+i>10?this.currentImageElementBox.height+i:10;"BottomRightRectParent"!==o&&"TopRightRectParent"!==o&&"BottomLeftRectParent"!==o&&"TopLeftRectParent"!==o||(u=this.currentImageElementBox.height/this.currentImageElementBox.width*p,p=this.currentImageElementBox.width/this.currentImageElementBox.height*u),this.currentImageElementBox.width=p,this.currentImageElementBox.height=u;this.currentImageElementBox.line.paragraph;this.positionImageResizer(this.currentImageElementBox)}this.isImageResizing=!0}},e.prototype.handleImageResizingOnMouse=function(e){if(!sf.base.isNullOrUndefined(this.selectedResizeElement)){var t=parseFloat(this.selectedResizeElement.style.left),i=parseFloat(this.selectedResizeElement.style.top),r=new M(e.offsetX,e.offsetY),n=this.viewer.findFocusedPage(r,!0);this.handleImageResizing(n,t,i)}},e.prototype.topMiddleResizing=function(e){var t;return this.topValue>=e.y?(t=this.topValue/e.y,this.topValue=e.y,this.viewer instanceof X&&this.topValue<=this.viewer.pageGap&&(t=1)):(t=-e.y/this.topValue,this.topValue=e.y,0===this.topValue&&(t=-1)),t},e.prototype.leftMiddleResizing=function(e){var t;return this.leftValue>=e.x?(t=this.leftValue/e.x,this.leftValue=e.x,0===this.leftValue&&(t=1,this.leftValue=parseFloat(this.selectedResizeElement.style.left))):(t=-e.x/this.leftValue,this.leftValue=e.x),t},e.prototype.topRightResizing=function(e){return this.leftValue<=e.x&&this.topValue>=e.y?this.getOuterResizingPoint(e):this.getInnerResizingPoint(e)},e.prototype.topLeftResizing=function(e){return this.leftValue>=e.x&&this.topValue>=e.y?this.getOuterResizingPoint(e):this.getInnerResizingPoint(e)},e.prototype.bottomRightResizing=function(e){return this.leftValue<=e.x&&this.topValue<=e.y?this.getOuterResizingPoint(e):this.getInnerResizingPoint(e)},e.prototype.bottomLeftResizing=function(e){return this.leftValue>=e.x&&this.topValue<=e.y?this.getOuterResizingPoint(e):this.getInnerResizingPoint(e)},e.prototype.getOuterResizingPoint=function(e){var t,i;return t=e.x-this.leftValue,this.leftValue=e.x,i=e.y-this.topValue,this.topValue=e.y,{left:t,top:i}},e.prototype.getInnerResizingPoint=function(e){var t,i;return t=-(this.leftValue-e.x),this.leftValue=e.x,i=-(this.topValue-e.y),this.topValue=e.y,{left:t,top:i}},e.prototype.handleImageResizingOnTouch=function(e){if(!sf.base.isNullOrUndefined(this.selectedResizeElement)){var t=parseFloat(this.selectedResizeElement.style.left)+24,i=parseFloat(this.selectedResizeElement.style.top)+24,r=e.touches,n=new M(r[0].clientX,r[0].clientY),o=this.viewer.findFocusedPage(n,!0);if(sf.base.isNullOrUndefined(this.currentImageElementBox)||sf.base.isNullOrUndefined(this.currentImageElementBox))return;this.handleImageResizing(o,t,i)}},e.prototype.getImagePoint=function(e){var t=this.documentHelper.render.getScaledValue(e.x,1),i=this.documentHelper.render.getScaledValue(e.y,2);e=new M(t,i);var r=this.imageResizerPoints,n="",o=void 0,s=r.bottomMiddleRectParent,a=r.bottomRightRectParent,l=r.bottomLeftRectParent,h=r.topMiddleRectParent,d=r.topRightRectParent,c=r.topLeftRectParent,p=r.rightMiddleRectParent,u=r.leftMiddleRectParent;return sf.base.isNullOrUndefined(this.bottomMiddleRectParent)||"none"===this.bottomMiddleRectParent.style.display||(e.x>s.x&&e.x<=s.x+15&&e.y>s.y&&e.y<=s.y+15?(o=this.bottomMiddleRectParent,n="s-resize"):e.x>a.x&&e.x<=a.x+15&&e.y>a.y&&e.y<=a.y+15?(o=this.bottomRightRectParent,n="se-resize"):e.x>l.x&&e.x<=l.x+15&&e.y>l.y&&e.y<=l.y+15?(o=this.bottomLeftRectParent,n="sw-resize"):e.x>h.x&&e.x<=h.x+15&&e.y>h.y&&e.y<=h.y+15?(o=this.topMiddleRectParent,n="n-resize"):e.x>d.x&&e.x<=d.x+15&&e.y>d.y&&e.y<=d.y+15?(o=this.topRightRectParent,n="ne-resize"):e.x>c.x&&e.x<=c.x+15&&e.y>c.y&&e.y<=c.y+15?(o=this.topLeftRectParent,n="nw-resize"):e.x>u.x&&e.x<=u.x+15&&e.y>u.y&&e.y<=u.y+15?(o=this.leftMiddleRectParent,n="w-resize"):e.x>p.x&&e.x<=p.x+15&&e.y>p.y&&e.y<=p.y+15?(o=this.rightMiddleRectParent,n="e-resize"):!sf.base.isNullOrUndefined(this.resizeContainerDiv)&&e.x>parseFloat(this.resizeContainerDiv.style.left)&&e.x<=parseFloat(this.resizeContainerDiv.style.left)+parseFloat(this.resizeContainerDiv.style.width)&&e.y>parseFloat(this.resizeContainerDiv.style.top)&&e.y<=parseFloat(this.resizeContainerDiv.style.top)+parseFloat(this.resizeContainerDiv.style.height)&&(n="move")),{selectedElement:o,resizePosition:n}},e.prototype.applyPropertiesForMouse=function(){sf.base.isNullOrUndefined(this.bottomLeftRectParent)||(this.bottomMiddleRectParent.style.width="14px",this.bottomMiddleRectParent.style.height="14px",this.bottomRightRectParent.style.width="14px",this.bottomRightRectParent.style.height="14px",this.bottomLeftRectParent.style.width="14px",this.bottomLeftRectParent.style.height="14px",this.topMiddleRectParent.style.width="14px",this.topMiddleRectParent.style.height="14px",this.topRightRectParent.style.width="14px",this.topRightRectParent.style.height="14px",this.topLeftRectParent.style.width="14px",this.topLeftRectParent.style.height="14px",this.leftMiddleRectParent.style.width="14px",this.leftMiddleRectParent.style.height="14px",this.rightMiddleRectParent.style.width="14px",this.rightMiddleRectParent.style.height="14px")},e.prototype.getImagePointOnTouch=function(e){var t=this.documentHelper.render.getScaledValue(e.x,1),i=this.documentHelper.render.getScaledValue(e.y,2);e=new M(t,i);var r=this.imageResizerPoints,n="",o=void 0,s=r.bottomMiddleRectParent,a=r.bottomRightRectParent,l=r.bottomLeftRectParent,h=r.topMiddleRectParent,d=r.topRightRectParent,c=r.topLeftRectParent,p=r.rightMiddleRectParent,u=r.leftMiddleRectParent;return sf.base.isNullOrUndefined(this.bottomMiddleRectParent)||"none"===this.bottomMiddleRectParent.style.display||(e.x>s.x&&e.x<=s.x+25&&e.y>s.y&&e.y<=s.y+25?(o=this.bottomMiddleRectParent,n="s-resize"):e.x>a.x&&e.x<=a.x+25&&e.y>a.y&&e.y<=a.y+25?(o=this.bottomRightRectParent,n="se-resize"):e.x>l.x&&e.x<=l.x+25&&e.y>l.y&&e.y<=l.y+25?(o=this.bottomLeftRectParent,n="sw-resize"):e.x>h.x&&e.x<=h.x+25&&e.y>h.y&&e.y<=h.y+25?(o=this.topMiddleRectParent,n="n-resize"):e.x>d.x&&e.x<=d.x+25&&e.y>d.y&&e.y<=d.y+25?(o=this.topRightRectParent,n="ne-resize"):e.x>c.x&&e.x<=c.x+25&&e.y>c.y&&e.y<=c.y+25?(o=this.topLeftRectParent,n="nw-resize"):e.x>u.x&&e.x<=u.x+25&&e.y>u.y&&e.y<=u.y+25?(o=this.leftMiddleRectParent,n="w-resize"):e.x>p.x&&e.x<=p.x+25&&e.y>p.y&&e.y<=p.y+25?(o=this.rightMiddleRectParent,n="e-resize"):!sf.base.isNullOrUndefined(this.resizeContainerDiv)&&e.x>parseFloat(this.resizeContainerDiv.style.left)&&e.x<=parseFloat(this.resizeContainerDiv.style.left)+parseFloat(this.resizeContainerDiv.style.width)&&e.y>parseFloat(this.resizeContainerDiv.style.top)&&e.y<=parseFloat(this.resizeContainerDiv.style.top)+parseFloat(this.resizeContainerDiv.style.height)&&(n="move")),{selectedElement:o,resizePosition:n}},e.prototype.applyPropertiesForTouch=function(){sf.base.isNullOrUndefined(this.bottomLeftRectParent)||(this.bottomMiddleRectParent.style.width="30px",this.bottomMiddleRectParent.style.height="30px",this.bottomRightRectParent.style.width="30px",this.bottomRightRectParent.style.height="30px",this.bottomLeftRectParent.style.width="30px",this.bottomLeftRectParent.style.height="30px",this.topMiddleRectParent.style.width="30px",this.topMiddleRectParent.style.height="30px",this.topRightRectParent.style.width="30px",this.topRightRectParent.style.height="30px",this.topLeftRectParent.style.width="30px",this.topLeftRectParent.style.height="30px",this.leftMiddleRectParent.style.width="30px",this.leftMiddleRectParent.style.height="30px",this.rightMiddleRectParent.style.width="30px",this.rightMiddleRectParent.style.height="30px")},e.prototype.mouseUpInternal=function(){this.currentImageElementBox.width=parseFloat(this.imageResizerDiv.style.width)/this.documentHelper.zoomFactor,this.currentImageElementBox.height=parseFloat(this.imageResizerDiv.style.height)/this.documentHelper.zoomFactor,this.owner.isShiftingEnabled=!0,this.owner.editorModule.setOffsetValue(this.owner.selection),this.documentHelper.layout.reLayoutParagraph(this.currentImageElementBox.line.paragraph,0,0),this.updateHistoryForImageResizer(),this.owner.editorModule.reLayout(this.owner.selection,!0),this.viewer.updateScrollBars()},e.prototype.initHistoryForImageResizer=function(e){!sf.base.isNullOrUndefined(this.owner)&&sf.base.isNullOrUndefined(this.baseHistoryInfo)&&(this.baseHistoryInfo=new Kt(this.owner),this.baseHistoryInfo.action="ImageResizing",this.baseHistoryInfo.updateSelection(),this.baseHistoryInfo.modifiedProperties.push(new zt(e)))},e.prototype.updateHistoryForImageResizer=function(){if(!sf.base.isNullOrUndefined(this.owner)&&!sf.base.isNullOrUndefined(this.baseHistoryInfo)){var e=this.baseHistoryInfo.modifiedProperties[0];this.currentImageElementBox.width===e.width&&this.currentImageElementBox.height===e.height?this.baseHistoryInfo.modifiedProperties.pop():this.owner.editorHistory.recordChanges(this.baseHistoryInfo),this.baseHistoryInfo=void 0}},e.prototype.updateImageResizerPosition=function(){if(!sf.base.isNullOrUndefined(this.currentImageElementBox)){var e,t=(this.currentImageElementBox,this.currentImageElementBox),i=t.line,r=void 0,n=void 0,o=void 0;this.currentImageElementBox instanceof Re?(e=this.documentHelper.selection.getTop(i)+t.margin.top,r=this.documentHelper.selection.getLeftInternal(i,t,0),n=e*this.documentHelper.zoomFactor,o=r*this.documentHelper.zoomFactor):(o=t.x*this.documentHelper.zoomFactor,n=t.y*this.documentHelper.zoomFactor);var s=this.documentHelper.render.getScaledValue(t.height,2),a=this.documentHelper.render.getScaledValue(t.width,1);this.setImageResizerPosition(o,n,a,s,this)}},e.prototype.destroy=function(){sf.base.isNullOrUndefined(this.resizeContainerDiv)||(this.resizeContainerDiv.innerHTML=""),sf.base.isNullOrUndefined(this.topLeftRect)||(this.topLeftRect.innerHTML=""),sf.base.isNullOrUndefined(this.topMiddleRect)||(this.topMiddleRect.innerHTML=""),sf.base.isNullOrUndefined(this.topRightRect)||(this.topRightRect.innerHTML=""),sf.base.isNullOrUndefined(this.bottomLeftRect)||(this.bottomLeftRect.innerHTML=""),sf.base.isNullOrUndefined(this.bottomMiddleRect)||(this.bottomMiddleRect.innerHTML=""),sf.base.isNullOrUndefined(this.bottomRightRect)||(this.bottomRightRect.innerHTML=""),sf.base.isNullOrUndefined(this.leftMiddleRect)||(this.leftMiddleRect.innerHTML=""),sf.base.isNullOrUndefined(this.rightMiddleRect)||(this.rightMiddleRect.innerHTML=""),sf.base.isNullOrUndefined(this.imageResizerDiv)||(this.imageResizerDiv.innerHTML=""),sf.base.isNullOrUndefined(this.selectedImageWidget)||this.selectedImageWidget.destroy(),sf.base.isNullOrUndefined(this.imageResizerDivElement)||(this.imageResizerDivElement.innerHTML=""),this.imageResizerDivElement=void 0,this.resizeContainerDiv=void 0,this.topLeftRect=void 0,this.topMiddleRect=void 0,this.topRightRect=void 0,this.bottomLeftRect=void 0,this.bottomMiddleRect=void 0,this.bottomRightRect=void 0,this.leftMiddleRect=void 0,this.rightMiddleRect=void 0,this.imageResizerDiv=void 0,this.selectedImageWidget=void 0,this.isImageResizing=!1,this.isImageResizerVisible=!1,this.currentImageElementBoxIn=void 0,this.resizeMarkSizeIn=void 0,this.documentHelper=void 0,this.owner=void 0},e}(),ni=function(){this.resizeContainerDiv=new M(0,0),this.topLeftRectParent=new M(0,0),this.topMiddleRectParent=new M(0,0),this.topRightRectParent=new M(0,0),this.bottomLeftRectParent=new M(0,0),this.bottomMiddleRectParent=new M(0,0),this.bottomRightRectParent=new M(0,0),this.leftMiddleRectParent=new M(0,0),this.rightMiddleRectParent=new M(0,0)},oi=function(){function e(e,t){this.heightIn=0,this.widthIn=0,this.heightIn=e,this.widthIn=t}return Object.defineProperty(e.prototype,"height",{get:function(){return this.heightIn},set:function(e){this.heightIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return this.widthIn},set:function(e){this.widthIn=e},enumerable:!0,configurable:!0}),e}(),si=function(){function e(){this.customXMLItemsPath="customXml/item",this.customXMLItemsPropspath="customXml/itemProps",this.itemPropsPath="itemProps",this.documentPath="word/document.xml",this.stylePath="word/styles.xml",this.chartPath="word/charts",this.numberingPath="word/numbering.xml",this.settingsPath="word/settings.xml",this.headerPath="word/header",this.footerPath="word/footer",this.imagePath="word/media/image",this.footnotesPath="word/footnotes.xml",this.endnotesPath="word/endnotes.xml",this.appPath="docProps/app.xml",this.corePath="docProps/core.xml",this.contentTypesPath="[Content_Types].xml",this.defaultEmbeddingPath="word/embeddings/",this.commentsPath="word/comments.xml",this.commentsExtendedPath="word/commentsExtended.xml",this.themePath="word/theme/theme1.xml",this.generalRelationPath="_rels/.rels",this.wordRelationPath="word/_rels/document.xml.rels",this.customXMLRelPath="customXml/_rels/item",this.excelRelationPath="xl/_rels/workbook.xml.rels",this.footnotesRelationPath="word/_rels/footnotes.xml.rels",this.endnotesRelationPath="word/_rels/endnotes.xml.rels",this.headerRelationPath="word/_rels/header",this.footerRelationPath="word/_rels/footer",this.xmlContentType="application/xml",this.fontContentType="application/vnd.openxmlformats-officedocument.obfuscatedFont",this.documentContentType="application/vnd.openxmlformats-officedocument.wordprocessingml.document.main+xml",this.settingsContentType="application/vnd.openxmlformats-officedocument.wordprocessingml.settings+xml",this.commentsContentType="application/vnd.openxmlformats-officedocument.wordprocessingml.comments+xml",this.commentsExContentType="application/vnd.openxmlformats-officedocument.wordprocessingml.commentsExtended+xml",this.endnoteContentType="application/vnd.openxmlformats-officedocument.wordprocessingml.endnotes+xml",this.footerContentType="application/vnd.openxmlformats-officedocument.wordprocessingml.footer+xml",this.footnoteContentType="application/vnd.openxmlformats-officedocument.wordprocessingml.footnotes+xml",this.headerContentType="application/vnd.openxmlformats-officedocument.wordprocessingml.header+xml",this.numberingContentType="application/vnd.openxmlformats-officedocument.wordprocessingml.numbering+xml",this.stylesContentType="application/vnd.openxmlformats-officedocument.wordprocessingml.styles+xml",this.webSettingsContentType="application/vnd.openxmlformats-officedocument.wordprocessingml.webSettings+xml",this.appContentType="application/vnd.openxmlformats-officedocument.extended-properties+xml",this.coreContentType="application/vnd.openxmlformats-package.core-properties+xml",this.customContentType="application/vnd.openxmlformats-officedocument.custom-properties+xml",this.customXmlContentType="application/vnd.openxmlformats-officedocument.customXmlProperties+xml",this.relationContentType="application/vnd.openxmlformats-package.relationships+xml",this.chartsContentType="application/vnd.openxmlformats-officedocument.drawingml.chart+xml",this.themeContentType="application/vnd.openxmlformats-officedocument.theme+xml",this.tableStyleContentType="application/vnd.openxmlformats-officedocument.presentationml.tableStyles+xml",this.chartColorStyleContentType="application/vnd.ms-office.chartcolorstyle+xml",this.commentsRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",this.commentsExRelType="http://schemas.microsoft.com/office/2011/relationships/commentsExtended",this.settingsRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/settings",this.endnoteRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/endnotes",this.footerRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/footer",this.footnoteRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/footnotes",this.headerRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/header",this.documentRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",this.numberingRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/numbering",this.stylesRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",this.chartRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",this.ThemeRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",this.fontRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/font",this.tableStyleRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/tableStyles",this.coreRelType="http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",this.appRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",this.customRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",this.imageRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",this.hyperlinkRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",this.controlRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/control",this.packageRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/package",this.customXmlRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",this.customUIRelType="http://schemas.microsoft.com/office/2006/relationships/ui/extensibility",this.attachedTemplateRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/attachedTemplate",this.chartColorStyleRelType="http://schemas.microsoft.com/office/2011/relationships/chartColorStyle",this.wNamespace="http://schemas.openxmlformats.org/wordprocessingml/2006/main",this.wpNamespace="http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing",this.pictureNamespace="http://schemas.openxmlformats.org/drawingml/2006/picture",this.aNamespace="http://schemas.openxmlformats.org/drawingml/2006/main",this.a14Namespace="http://schemas.microsoft.com/office/drawing/2010/main",this.svgNamespace="http://schemas.microsoft.com/office/drawing/2016/SVG/main",this.rNamespace="http://schemas.openxmlformats.org/officeDocument/2006/relationships",this.rpNamespace="http://schemas.openxmlformats.org/package/2006/relationships",this.vNamespace="urn:schemas-microsoft-com:vml",this.oNamespace="urn:schemas-microsoft-com:office:office",this.xmlNamespace="http://www.w3.org/XML/1998/namespace",this.w10Namespace="urn:schemas-microsoft-com:office:word",this.cpNamespace="http://schemas.openxmlformats.org/package/2006/metadata/core-properties",this.dcNamespace="http://purl.org/dc/elements/1.1/",this.docPropsNamespace="http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",this.veNamespace="http://schemas.openxmlformats.org/markup-compatibility/2006",this.mNamespace="http://schemas.openxmlformats.org/officeDocument/2006/math",this.wneNamespace="http://schemas.microsoft.com/office/word/2006/wordml",this.customPropsNamespace="http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",this.vtNamespace="http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",this.chartNamespace="http://schemas.openxmlformats.org/drawingml/2006/chart",this.slNamespace="http://schemas.openxmlformats.org/schemaLibrary/2006/main",this.dtNamespace="uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",this.wmlNamespace="http://schemas.microsoft.com/office/word/2003/wordml",this.w14Namespace="http://schemas.microsoft.com/office/word/2010/wordml",this.wpCanvasNamespace="http://schemas.microsoft.com/office/word/2010/wordprocessingCanvas",this.wpDrawingNamespace="http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing",this.wpGroupNamespace="http://schemas.microsoft.com/office/word/2010/wordprocessingGroup",this.wpInkNamespace="http://schemas.microsoft.com/office/word/2010/wordprocessingInk",this.wpShapeNamespace="http://schemas.microsoft.com/office/word/2010/wordprocessingShape",this.w15Namespace="http://schemas.microsoft.com/office/word/2012/wordml",this.diagramNamespace="http://schemas.openxmlformats.org/drawingml/2006/diagram",this.eNamespace="http://schemas.microsoft.com/office/2006/encryption",this.pNamespace="http://schemas.microsoft.com/office/2006/keyEncryptor/password",this.certNamespace="http://schemas.microsoft.com/office/2006/keyEncryptor/certificate",this.cxNamespace="http://schemas.microsoft.com/office/drawing/2014/chartex",this.c15Namespace="http://schemas.microsoft.com/office/drawing/2015/06/chart",this.c7Namespace="http://schemas.microsoft.com/office/drawing/2007/8/2/chart",this.csNamespace="http://schemas.microsoft.com/office/drawing/2012/chartStyle",this.spreadSheetNamespace="http://schemas.openxmlformats.org/spreadsheetml/2006/main",this.spreadSheet9="http://schemas.microsoft.com/office/spreadsheetml/2009/9/main",this.cRelationshipsTag="Relationships",this.cRelationshipTag="Relationship",this.cIdTag="Id",this.cTypeTag="Type",this.cTargetTag="Target",this.cUserShapesTag="userShapes",this.cExternalData="externalData",this.twipsInOnePoint=20,this.twentiethOfPoint=20,this.borderMultiplier=8,this.percentageFactor=50,this.emusPerPoint=12700,this.cConditionalTableStyleTag="tblStylePr",this.cTableFormatTag="tblPr",this.cTowFormatTag="trPr",this.cCellFormatTag="tcPr",this.cParagraphFormatTag="pPr",this.cCharacterFormatTag="rPr",this.packageType="http://schemas.microsoft.com/office/2006/xmlPackage",this.relsPartPath="/_rels/.rels",this.documentRelsPartPath="/word/_rels/document.xml.rels",this.webSettingsPath="/word/webSettings.xml",this.wordMLDocumentPath="/word/document.xml",this.wordMLStylePath="/word/styles.xml",this.wordMLNumberingPath="/word/numbering.xml",this.wordMLSettingsPath="/word/settings.xml",this.wordMLHeaderPath="/word/header",this.wordMLFooterPath="/word/footer",this.wordMLCommentsPath="/word/comments.xml",this.wordMLImagePath="/word/media/image",this.wordMLFootnotesPath="/word/footnotes.xml",this.wordMLEndnotesPath="/word/endnotes.xml",this.wordMLAppPath="/docProps/app.xml",this.wordMLCorePath="/docProps/core.xml",this.wordMLCustomPath="/docProps/custom.xml",this.wordMLFontTablePath="/word/fontTable.xml",this.wordMLChartsPath="/word/charts/",this.wordMLDefaultEmbeddingPath="/word/embeddings/",this.wordMLEmbeddingPath="/word/embeddings/",this.wordMLDrawingPath="/word/drawings/",this.wordMLThemePath="/word/theme/theme1.xml",this.wordMLFontsPath="/word/fonts/",this.wordMLDiagramPath="/word/diagrams/",this.wordMLControlPath="/word/activeX/",this.wordMLVbaProject="/vbaProject.bin",this.wordMLVbaData="/vbaData.xml",this.wordMLVbaProjectPath="/word/vbaProject.bin",this.wordMLVbaDataPath="/word/vbaData.xml",this.wordMLWebSettingsPath="/word/webSettings.xml",this.wordMLCustomItemProp1Path="/customXml/itemProps1.xml",this.wordMLFootnoteRelPath="/word/_rels/footnotes.xml.rels",this.wordMLEndnoteRelPath="/word/_rels/endnotes.xml.rels",this.wordMLSettingsRelPath="/word/_rels/settings.xml.rels",this.wordMLNumberingRelPath="/word/_rels/numbering.xml.rels",this.wordMLFontTableRelPath="/word/_rels/fontTable.xml.rels",this.wordMLCustomXmlPropsRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",this.wordMLControlRelType="http://schemas.microsoft.com/office/2006/relationships/activeXControlBinary",this.wordMLDiagramContentType="application/vnd.ms-office.drawingml.diagramDrawing+xml",this.dsNamespace="http://schemas.openxmlformats.org/officeDocument/2006/customXml",this.excelFiles=void 0,this.lastSection=!1,this.mRelationShipID=0,this.cRelationShipId=0,this.eRelationShipId=0,this.efRelationShipId=0,this.mDocPrID=1,this.chartCount=0,this.seriesCount=0,this.chartStringCount=0,this.mDifferentFirstPage=!1,this.mBookmarks=void 0,this.mComments=[],this.revisions=[],this.customXMLProps=[],this.paraID=0,this.commentParaID=0,this.commentParaIDInfo={},this.isInsideComment=!1,this.commentId={},this.currentCommentId=0,this.trackChangesId=0,this.prevRevisionIds=[],this.isRevisionContinuous=!1}return e.prototype.getModuleName=function(){return"WordExport"},Object.defineProperty(e.prototype,"bookmarks",{get:function(){return sf.base.isNullOrUndefined(this.mBookmarks)&&(this.mBookmarks=[]),this.mBookmarks},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"documentImages",{get:function(){return void 0===this.mDocumentImages&&(this.mDocumentImages=new a),this.mDocumentImages},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"svgImages",{get:function(){return void 0===this.mSvgImages&&(this.mSvgImages=new a),this.mSvgImages},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"externalImages",{get:function(){return void 0===this.mExternalLinkImages&&(this.mExternalLinkImages=new a),this.mExternalLinkImages},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"headerFooterImages",{get:function(){return void 0===this.mHeaderFooterImages&&(this.mHeaderFooterImages=new a),this.mHeaderFooterImages},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"headerFooterSvgImages",{get:function(){return void 0===this.mHeaderFooterSvgImages&&(this.mHeaderFooterSvgImages=new a),this.mHeaderFooterSvgImages},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"documentCharts",{get:function(){return void 0===this.mDocumentCharts&&(this.mDocumentCharts=new a),this.mDocumentCharts},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"headersFooters",{get:function(){return void 0===this.mHeaderFooterColl&&(this.mHeaderFooterColl=new a),this.mHeaderFooterColl},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"endnotesFootnotes",{get:function(){return void 0===this.mFootEndnotesColl&&(this.mFootEndnotesColl=new a),this.mFootEndnotesColl},enumerable:!0,configurable:!0}),e.prototype.save=function(e,t){var i=this;this.fileName=t,this.serialize(e);var r=this.serializeExcelFiles();r&&r.length>0?Promise.all(r).then((function(){i.saveInternal(t)})):this.saveInternal(t),this.close()},e.prototype.saveInternal=function(e){this.mArchive.save(e+".docx").then((function(e){e.destroy()}))},e.prototype.saveAsBlob=function(e){var t=this;this.serialize(e);var i=this.serializeExcelFiles();return new Promise((function(e,r){i.length>0?Promise.all(i).then((function(){t.mArchive.saveAsBlob().then((function(i){t.mArchive.destroy(),i=new Blob([i],{type:"application/vnd.openxmlformats-officedocument.wordprocessingml.document"}),e(i)}))})):t.mArchive.saveAsBlob().then((function(i){t.mArchive.destroy(),i=new Blob([i],{type:"application/vnd.openxmlformats-officedocument.wordprocessingml.document"}),e(i)}))}))},e.prototype.serializeExcelFiles=function(){var e=this,t=this.excelFiles,i=[];if(t&&t.length>0){for(var r=function(r){var n=t.keys[parseInt(r.toString(),10)],o=t.get(n).saveAsBlob();i.push(o),o.then((function(t){var i=new sf.compression.ZipArchiveItem(t,n);e.mArchive.addItem(i)}))},n=0;n<t.length;n++)r(n);this.excelFiles.clear()}return i},e.prototype.saveExcel=function(){var e=this.defaultEmbeddingPath+"Microsoft_Excel_Worksheet"+this.chartCount+".xlsx";this.excelFiles.add(e,this.mArchiveExcel),this.mArchiveExcel=void 0},e.prototype.destroy=function(){this.clearDocument(),this.mRelationShipID=void 0,this.mDocPrID=void 0,this.mDifferentFirstPage=void 0,this.fileName=void 0,this.mArchive&&(this.mArchive.destroy(),this.mArchive=void 0),this.mArchiveExcel&&(this.mArchiveExcel.destroy(),this.mArchiveExcel=void 0)},e.prototype.serialize=function(e){var t=e.owner.sfdtExportModule.write();this.setDocument(t),this.mComments=e.comments,this.mCustomXML=e.customXmlData,this.revisions=e.owner.revisions.changes,this.mArchive=new sf.compression.ZipArchive,this.mArchive.compressionLevel="Normal",this.commentParaIDInfo={},this.commentParaID=0,this.currentCommentId=0,this.commentId={},this.mVerticalMerge=new a,this.mGridSpans=new a,this.serializeDocument(),this.serializeStyles(),this.serializeNumberings(),this.serializeComments(),this.serializeCommentsExtended(),this.serializeThemes(),this.serializeSettings(),this.serializeCoreProperties(),this.serializeAppProperties(),this.serializeFontTable(void 0),this.serializeSettingsRelation(),this.serializeHeaderFooters(),this.serializeFootnotes(),this.serializeEndnotes(),this.serializeDocumentRelations(),this.serializeGeneralRelations(),this.serializeContentTypes(void 0),this.clearDocument()},e.prototype.setDocument=function(e){this.document=e,this.mSections=e.sections,this.mLists=e.lists,this.mAbstractLists=e.abstractLists,this.defCharacterFormat=e.characterFormat,this.defParagraphFormat=e.paragraphFormat,this.defaultTabWidthValue=e.defaultTabWidth,this.themeFontLang=e.themeFontLanguages,this.dontUseHtmlParagraphAutoSpacing=e.dontUseHTMLParagraphAutoSpacing,this.mStyles=e.styles,this.mThemes=e.themes,this.formatting=e.formatting,this.enforcement=e.enforcement,this.hashValue=e.hashValue,this.saltValue=e.saltValue,this.protectionType=e.protectionType,this.formFieldShading=e.formFieldShading,this.trackChanges=e.trackChanges,this.compatibilityMode=e.compatibilityMode},e.prototype.clearDocument=function(){this.section=void 0,this.lastSection=void 0,this.blockOwner=void 0,this.paragraph=void 0,this.table=void 0,this.row=void 0,this.headerFooter=void 0,this.commentParaIDInfo={},this.commentParaID=0,this.currentCommentId=0,this.commentId={},this.document=void 0,this.mSections=void 0,this.mLists=void 0,this.mAbstractLists=void 0,this.defCharacterFormat=void 0,this.defParagraphFormat=void 0,this.defaultTabWidthValue=void 0,this.trackChanges=void 0,this.customXMLProps=[],this.mRelationShipID=0,this.eRelationShipId=0,this.cRelationShipId=0,this.efRelationShipId=0,this.mDocPrID=1,this.chartCount=0,this.mDifferentFirstPage=!1,this.mHeaderFooterColl&&(this.mHeaderFooterColl.destroy(),this.mHeaderFooterColl=void 0),this.mVerticalMerge&&(this.mVerticalMerge.destroy(),this.mVerticalMerge=void 0),this.mGridSpans&&(this.mGridSpans.destroy(),this.mGridSpans=void 0),this.mDocumentImages&&(this.mDocumentImages.destroy(),this.mDocumentImages=void 0),this.mExternalLinkImages&&(this.mExternalLinkImages.destroy(),this.mExternalLinkImages=void 0),this.mHeaderFooterImages&&(this.mHeaderFooterImages.destroy(),this.mHeaderFooterImages=void 0),this.mDocumentCharts&&(this.mDocumentCharts.destroy(),this.mDocumentCharts=void 0),this.mFootEndnotesColl&&(this.mFootEndnotesColl.destroy(),this.mFootEndnotesColl=void 0)},e.prototype.serializeDocument=function(){var e=new sf.fileutils.XmlWriter;e.writeStartElement("w","document",this.wNamespace),this.writeCommonAttributeStrings(e),this.serializeDocumentBody(e),e.writeEndElement();var t=new sf.compression.ZipArchiveItem(e.buffer,this.documentPath);this.mArchive.addItem(t)},e.prototype.writeCommonAttributeStrings=function(e){e.writeAttributeString("xmlns","wpc",void 0,this.wpCanvasNamespace),this.writeCustom(e),e.writeAttributeString("xmlns","wp14",void 0,this.wpDrawingNamespace),e.writeAttributeString("xmlns","wp",void 0,this.wpNamespace),e.writeAttributeString("xmlns","w10",void 0,this.w10Namespace),e.writeAttributeString("xmlns","w",void 0,this.wNamespace),this.writeDup(e),e.writeAttributeString("xmlns","wne",void 0,this.wneNamespace),e.writeAttributeString("xmlns","wps",void 0,this.wpShapeNamespace),e.writeAttributeString("mc","Ignorable",void 0,"w14 w15 wp14")},e.prototype.writeDup=function(e){e.writeAttributeString("xmlns","w14",void 0,this.w14Namespace),e.writeAttributeString("xmlns","w15",void 0,this.w15Namespace),e.writeAttributeString("xmlns","wpg",void 0,this.wpGroupNamespace),e.writeAttributeString("xmlns","wpi",void 0,this.wpInkNamespace)},e.prototype.writeCustom=function(e){e.writeAttributeString("xmlns","mc",void 0,this.veNamespace),e.writeAttributeString("xmlns","o",void 0,this.oNamespace),e.writeAttributeString("xmlns","r",void 0,this.rNamespace),e.writeAttributeString("xmlns","m",void 0,this.mNamespace),e.writeAttributeString("xmlns","v",void 0,this.vNamespace)},e.prototype.serializeDocumentBody=function(e){e.writeStartElement(void 0,"body",this.wNamespace);for(var t=this.document.sections.length,i=0;i<t;i++)this.section=this.document.sections[parseInt(i.toString(),10)],this.lastSection=i===t-1,this.serializeSection(e,this.section,i===t-1),this.section=void 0;e.writeEndElement()},e.prototype.serializeSection=function(e,t,i){this.blockOwner=t,this.serializeBodyItems(e,t.blocks,i),i&&this.serializeSectionProperties(e,t),this.blockOwner=void 0},e.prototype.serializeComments=function(){if(0!==this.mComments.length&&(1!==this.mComments.length||""!==this.mComments[0].text)){var e=new sf.fileutils.XmlWriter;e.writeStartElement("w","comments",this.wNamespace),this.serializeCommentCommonAttribute(e),this.serializeCommentInternal(e,this.mComments),e.writeEndElement();var t=new sf.compression.ZipArchiveItem(e.buffer,this.commentsPath);this.mArchive.addItem(t)}},e.prototype.serializeThemes=function(){if(!sf.base.isNullOrUndefined(this.mThemes)){var e=new sf.fileutils.XmlWriter;e.writeStartElement("a","theme",this.aNamespace),e.writeAttributeString(void 0,"name",void 0,"Office Theme"),e.writeStartElement(void 0,"themeElements",this.aNamespace),e.writeRaw('<a:clrScheme name="Office"><a:dk1><a:sysClr val="windowText" lastClr="000000" /></a:dk1><a:lt1><a:sysClr val="window" lastClr="FFFFFF" /></a:lt1><a:dk2><a:srgbClr val="44546A" /></a:dk2><a:lt2><a:srgbClr val="E7E6E6" /></a:lt2><a:accent1><a:srgbClr val="4472C4" /></a:accent1><a:accent2><a:srgbClr val="ED7D31" /></a:accent2><a:accent3><a:srgbClr val="A5A5A5" /></a:accent3><a:accent4><a:srgbClr val="FFC000" /></a:accent4><a:accent5><a:srgbClr val="5B9BD5" /></a:accent5><a:accent6><a:srgbClr val="70AD47" /></a:accent6><a:hlink><a:srgbClr val="0563C1" /></a:hlink><a:folHlink><a:srgbClr val="954F72" /></a:folHlink></a:clrScheme>'),e.writeStartElement(void 0,"fontScheme",this.aNamespace),e.writeAttributeString(void 0,"name",void 0,this.mThemes.fontSchemeName),e.writeStartElement(void 0,"majorFont",this.aNamespace);for(var t=0;t<this.mThemes.fontScheme.majorFontScheme.fontSchemeList.length;t++){var i=this.mThemes.fontScheme.majorFontScheme.fontSchemeList[parseInt(t.toString(),10)];this.themeFont(e,i)}for(var r=Object.keys(this.mThemes.fontScheme.majorFontScheme.fontTypeface),n=0,o=r;n<o.length;n++){var s=o[n];this.themeType(e,s,this.mThemes.fontScheme.majorFontScheme.fontTypeface[""+s])}e.writeEndElement(),e.writeStartElement(void 0,"minorFont",this.aNamespace);for(t=0;t<this.mThemes.fontScheme.minorFontScheme.fontSchemeList.length;t++){i=this.mThemes.fontScheme.minorFontScheme.fontSchemeList[parseInt(t.toString(),10)];this.themeFont(e,i)}for(var a=0,l=r=Object.keys(this.mThemes.fontScheme.minorFontScheme.fontTypeface);a<l.length;a++){s=l[a];this.themeType(e,s,this.mThemes.fontScheme.minorFontScheme.fontTypeface[""+s])}e.writeEndElement(),e.writeEndElement(),e.writeStartElement(void 0,"fmtScheme",this.aNamespace),e.writeAttributeString(void 0,"name",void 0,"Office"),e.writeRaw('<a:fillStyleLst><a:solidFill><a:schemeClr val="phClr" /></a:solidFill><a:gradFill rotWithShape="1"><a:gsLst><a:gs pos="0"><a:schemeClr val="phClr"><a:lumMod val="110000" /><a:satMod val="105000" /><a:tint val="67000" /></a:schemeClr></a:gs><a:gs pos="50000"><a:schemeClr val="phClr"><a:lumMod val="105000" /><a:satMod val="103000" /><a:tint val="73000" /></a:schemeClr></a:gs><a:gs pos="100000"><a:schemeClr val="phClr"><a:lumMod val="105000" /><a:satMod val="109000" /><a:tint val="81000" /></a:schemeClr></a:gs></a:gsLst><a:lin ang="5400000" scaled="0" /></a:gradFill><a:gradFill rotWithShape="1"><a:gsLst><a:gs pos="0"><a:schemeClr val="phClr"><a:satMod val="103000" /><a:lumMod val="102000" /><a:tint val="94000" /></a:schemeClr></a:gs><a:gs pos="50000"><a:schemeClr val="phClr"><a:satMod val="110000" /><a:lumMod val="100000" /><a:shade val="100000" /></a:schemeClr></a:gs><a:gs pos="100000"><a:schemeClr val="phClr"><a:lumMod val="99000" /><a:satMod val="120000" /><a:shade val="78000" /></a:schemeClr></a:gs></a:gsLst><a:lin ang="5400000" scaled="0" /></a:gradFill></a:fillStyleLst><a:lnStyleLst><a:ln w="6350" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr" /></a:solidFill><a:prstDash val="solid" /><a:miter lim="800000" /></a:ln><a:ln w="12700" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr" /></a:solidFill><a:prstDash val="solid" /><a:miter lim="800000" /></a:ln><a:ln w="19050" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr" /></a:solidFill><a:prstDash val="solid" /><a:miter lim="800000" /></a:ln></a:lnStyleLst><a:effectStyleLst><a:effectStyle><a:effectLst /></a:effectStyle><a:effectStyle><a:effectLst /></a:effectStyle><a:effectStyle><a:effectLst><a:outerShdw blurRad="57150" dist="19050" dir="5400000" algn="ctr" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="63000" /></a:srgbClr></a:outerShdw></a:effectLst></a:effectStyle></a:effectStyleLst><a:bgFillStyleLst><a:solidFill><a:schemeClr val="phClr" /></a:solidFill><a:solidFill><a:schemeClr val="phClr"><a:tint val="95000" /><a:satMod val="170000" /></a:schemeClr></a:solidFill><a:gradFill rotWithShape="1"><a:gsLst><a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="93000" /><a:satMod val="150000" /><a:shade val="98000" /><a:lumMod val="102000" /></a:schemeClr></a:gs><a:gs pos="50000"><a:schemeClr val="phClr"><a:tint val="98000" /><a:satMod val="130000" /><a:shade val="90000" /><a:lumMod val="103000" /></a:schemeClr></a:gs><a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="63000" /><a:satMod val="120000" /></a:schemeClr></a:gs></a:gsLst><a:lin ang="5400000" scaled="0" /></a:gradFill></a:bgFillStyleLst>'),e.writeEndElement(),e.writeEndElement(),e.writeEndElement();var h=new sf.compression.ZipArchiveItem(e.buffer,this.themePath);this.mArchive.addItem(h)}},e.prototype.themeFont=function(e,t){"latin"!=t.name&&"ea"!=t.name&&"cs"!=t.name||(e.writeStartElement(void 0,t.name,this.aNamespace),e.writeAttributeString(void 0,"typeface",void 0,t.typeface),e.writeAttributeString(void 0,"panose",void 0,t.panose),e.writeEndElement())},e.prototype.themeType=function(e,t,i){e.writeStartElement(void 0,"font",this.aNamespace),e.writeAttributeString(void 0,"script",void 0,t),e.writeAttributeString(void 0,"typeface",void 0,i),e.writeEndElement()},e.prototype.serializeCommentCommonAttribute=function(e){e.writeAttributeString("xmlns","wpc",void 0,this.wpCanvasNamespace),e.writeAttributeString("xmlns","cx",void 0,this.cxNamespace),e.writeAttributeString("xmlns","mc",void 0,this.veNamespace),e.writeAttributeString("xmlns","o",void 0,this.oNamespace),e.writeAttributeString("xmlns","r",void 0,this.rNamespace),e.writeAttributeString("xmlns","m",void 0,this.mNamespace),e.writeAttributeString("xmlns","v",void 0,this.vNamespace),e.writeAttributeString("xmlns","wp14",void 0,this.wpDrawingNamespace),e.writeAttributeString("xmlns","wp",void 0,this.wpNamespace),e.writeAttributeString("xmlns","w10",void 0,this.w10Namespace),e.writeAttributeString("xmlns","w",void 0,this.wNamespace),e.writeAttributeString("xmlns","w14",void 0,this.w14Namespace),e.writeAttributeString("xmlns","w15",void 0,this.w15Namespace),e.writeAttributeString("mc","Ignorable",void 0,"w14 w15")},e.prototype.serializeCommentInternal=function(e,t){for(var i=0;i<t.length;i++){var r=t[parseInt(i.toString(),10)];e.writeStartElement("w","comment",this.wNamespace),e.writeAttributeString("w","id",this.wNamespace,this.commentId[r.commentId].toString()),r.author&&" "!==r.author&&e.writeAttributeString("w","author",this.wNamespace,r.author),r.date&&e.writeAttributeString("w","date",this.wNamespace,r.date),r.initial&&""!==r.initial&&e.writeAttributeString("w","initials",this.wNamespace,r.initial);for(var n=this.retrieveCommentText(r.text),o=0;o<n.length;o++)this.isInsideComment=!0,this.commentParaID++,this.serializeBodyItem(e,n[parseInt(o.toString(),10)],!0),this.isInsideComment=!1;0===n.length&&(this.isInsideComment=!0,this.commentParaID++),this.commentParaIDInfo[r.commentId]=this.commentParaID,this.isInsideComment=!1,e.writeEndElement(),r.replyComments.length>0&&this.serializeCommentInternal(e,r.replyComments)}},e.prototype.retrieveCommentText=function(e){for(var t=[],i=e.split("\n");i.length>0;){var r={};r.inlines=[{text:i[0]}],t.push(r),i.splice(0,1)}return t},e.prototype.serializeCommentsExtended=function(){if(0!==this.mComments.length&&(1!==this.mComments.length||""!==this.mComments[0].text)){var e=new sf.fileutils.XmlWriter;e.writeStartElement("w15","commentsEx",this.wNamespace),this.serializeCommentCommonAttribute(e),this.serializeCommentsExInternal(e,this.mComments,!1),e.writeEndElement();var t=new sf.compression.ZipArchiveItem(e.buffer,this.commentsExtendedPath);this.mArchive.addItem(t)}},e.prototype.serializeCommentsExInternal=function(e,t,i){for(var r=0;r<t.length;r++){var n=t[parseInt(r.toString(),10)];e.writeStartElement("w15","commentEx",this.wNamespace);var o=this.commentParaIDInfo[n.commentId];if(i){var s=this.commentParaIDInfo[n.ownerComment.commentId];e.writeAttributeString("w15","paraIdParent",this.wNamespace,s.toString())}e.writeAttributeString("w15","paraId",this.wNamespace,o.toString());var a=n.done?1:0;e.writeAttributeString("w15","done",this.wNamespace,a.toString()),e.writeEndElement(),n.replyComments.length>0&&this.serializeCommentsExInternal(e,n.replyComments,!0)}},e.prototype.serializeSectionProperties=function(e,t){e.writeStartElement("w","sectPr",this.wNamespace),t.headersFooters&&this.serializeHFReference(e,t.headersFooters),"NoBreak"===t.sectionFormat.breakCode?this.serializeSectionType(e,"continuous"):this.serializeSectionType(e,"nextPage"),this.serializePageSetup(e,t.sectionFormat),this.serializeColumns(e,t.sectionFormat),this.serializeFootNotesPr(e,t.sectionFormat),this.serializeEndNotesPr(e,t.sectionFormat),void 0!==t.sectionFormat&&t.sectionFormat.differentFirstPage&&(e.writeStartElement(void 0,"titlePg",this.wNamespace),e.writeEndElement()),!sf.base.isNullOrUndefined(t.sectionFormat)&&t.sectionFormat.bidi&&(e.writeStartElement(void 0,"bidi",this.wNamespace),e.writeEndElement()),e.writeEndElement()},e.prototype.serializeFootNotesPr=function(e,t){(t.footNoteNumberFormat||t.restartIndexForFootnotes)&&(e.writeStartElement(void 0,"footnotePr",this.wNamespace),e.writeStartElement(void 0,"pos",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,"pageBottom"),e.writeEndElement(),void 0!==t.footNoteNumberFormat&&(e.writeStartElement(void 0,"numFmt",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,this.getFootNoteNumberFormat(t.footNoteNumberFormat)),e.writeEndElement()),void 0!==t.restartIndexForFootnotes&&(e.writeStartElement(void 0,"numRestart",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,this.getFootNoteNumberRestart(t.restartIndexForFootnotes)),e.writeEndElement()),void 0!==t.initialFootNoteNumber&&(e.writeStartElement(void 0,"numStart",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,t.initialFootNoteNumber.toString()),e.writeEndElement()),e.writeEndElement())},e.prototype.getFootNoteNumberFormat=function(e){var t;switch(e){case"UpperCaseRoman":t="upperRoman";break;case"LowerCaseRoman":t="lowerRoman";break;case"UpperCaseLetter":t="upperLetter";break;case"LowerCaseLetter":t="lowerLetter";break;default:t="decimal"}return t},e.prototype.getFootNoteNumberRestart=function(e){switch(e){case"RestartForEachSection ":return"eachSect";case"RestartForEachPage":return"eachPage";default:return"continuous"}},e.prototype.getPageNumberFormat=function(e){var t;switch(e){case"RomanUpper":t="upperRoman";break;case"RomanLower":t="lowerRoman";break;case"LetterUpper":t="upperLetter";break;case"LetterLower":t="lowerLetter";break;default:t="Arabic"}return t},e.prototype.serializeEndNotesPr=function(e,t){(t.endnoteNumberFormat||t.restartIndexForEndnotes)&&(e.writeStartElement(void 0,"endnotePr",this.wNamespace),e.writeStartElement(void 0,"pos",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,"docEnd"),e.writeEndElement(),void 0!==t.endnoteNumberFormat&&(e.writeStartElement(void 0,"numFmt",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,this.getFootNoteNumberFormat(t.endnoteNumberFormat)),e.writeEndElement()),void 0!==t.restartIndexForEndnotes&&(e.writeStartElement(void 0,"numRestart",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,this.getFootNoteNumberRestart(t.restartIndexForEndnotes)),e.writeEndElement()),void 0!==t.initialEndNoteNumber&&(e.writeStartElement(void 0,"numStart",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,t.initialEndNoteNumber.toString()),e.writeEndElement()),e.writeEndElement())},e.prototype.serializeColumns=function(e,t){if(void 0!==t.numberOfColumns&&t.numberOfColumns>1){if(e.writeStartElement(void 0,"cols",this.wNamespace),e.writeAttributeString(void 0,"num",this.wNamespace,t.numberOfColumns.toString()),t.lineBetweenColumns&&e.writeAttributeString(void 0,"sep",this.wNamespace,"1"),t.equalWidth)e.writeAttributeString(void 0,"equalWidth",this.wNamespace,"1");else if(e.writeAttributeString(void 0,"equalWidth",this.wNamespace,"0"),void 0!==t.columns&&t.columns.length>0)for(var i=0;i<t.columns.length;i++)e.writeStartElement(void 0,"col",this.wNamespace),e.writeAttributeString(void 0,"w",this.wNamespace,this.roundToTwoDecimal(t.columns[parseInt(i.toString(),10)].width*this.twentiethOfPoint).toString()),e.writeAttributeString(void 0,"space",this.wNamespace,this.roundToTwoDecimal(t.columns[parseInt(i.toString(),10)].space*this.twentiethOfPoint).toString()),e.writeEndElement();e.writeEndElement()}},e.prototype.serializePageSetup=function(e,t){void 0!==t&&(this.serializePageSize(e,t),this.serializePageMargins(e,t),this.serializePageNumberType(e,t)),t.restartPageNumbering&&(e.writeStartElement(void 0,"pgNumType",this.wNamespace),e.writeAttributeString(void 0,"start",this.wNamespace,t.pageStartingNumber.toString()),e.writeEndElement()),e.writeStartElement(void 0,"pgBorders",this.wNamespace),e.writeEndElement()},e.prototype.serializePageSize=function(e,t){e.writeStartElement(void 0,"pgSz",this.wNamespace),e.writeAttributeString(void 0,"w",this.wNamespace,this.roundToTwoDecimal(t.pageWidth*this.twentiethOfPoint).toString()),e.writeAttributeString(void 0,"h",this.wNamespace,this.roundToTwoDecimal(t.pageHeight*this.twentiethOfPoint).toString()),e.writeEndElement()},e.prototype.serializePageMargins=function(e,t){e.writeStartElement(void 0,"pgMar",this.wNamespace);var i=Math.round(t.topMargin*this.twentiethOfPoint);e.writeAttributeString(void 0,"top",this.wNamespace,i.toString()),i=Math.round(t.rightMargin*this.twentiethOfPoint),e.writeAttributeString(void 0,"right",this.wNamespace,i.toString()),i=Math.round(t.bottomMargin*this.twentiethOfPoint),e.writeAttributeString(void 0,"bottom",this.wNamespace,i.toString()),i=Math.round(t.leftMargin*this.twentiethOfPoint),e.writeAttributeString(void 0,"left",this.wNamespace,i.toString()),e.writeAttributeString(void 0,"header",this.wNamespace,this.roundToTwoDecimal(t.headerDistance*this.twentiethOfPoint).toString()),e.writeAttributeString(void 0,"footer",this.wNamespace,this.roundToTwoDecimal(t.footerDistance*this.twentiethOfPoint).toString()),e.writeAttributeString(void 0,"gutter",this.wNamespace,"0"),e.writeEndElement()},e.prototype.serializeSectionType=function(e,t){e.writeStartElement("w","type",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,t),e.writeEndElement()},e.prototype.serializeHFReference=function(e,t){var i="";if(void 0!==t){this.mDifferentFirstPage=this.section.sectionFormat.differentOddAndEvenPages;var r=t.firstPageHeader;r&&r.blocks&&r.blocks.length>0&&(e.writeStartElement(void 0,"headerReference",this.wNamespace),e.writeAttributeString(void 0,"type",this.wNamespace,"first"),i=this.getNextRelationShipID(),e.writeAttributeString(void 0,"id",this.rNamespace,i),this.addHeaderFooter(r,"FirstPageHeader",i),e.writeEndElement()),(r=t.firstPageFooter)&&r.blocks&&r.blocks.length>0&&(e.writeStartElement(void 0,"footerReference",this.wNamespace),e.writeAttributeString(void 0,"type",this.wNamespace,"first"),i=this.getNextRelationShipID(),e.writeAttributeString(void 0,"id",this.rNamespace,i),this.addHeaderFooter(r,"FirstPageFooter",i),e.writeEndElement()),(r=t.evenHeader)&&r.blocks&&r.blocks.length>0&&(e.writeStartElement(void 0,"headerReference",this.wNamespace),e.writeAttributeString(void 0,"type",this.wNamespace,"even"),i=this.getNextRelationShipID(),e.writeAttributeString(void 0,"id",this.rNamespace,i),this.addHeaderFooter(r,"EvenHeader",i),e.writeEndElement()),(r=t.evenFooter)&&r.blocks&&r.blocks.length>0&&(e.writeStartElement(void 0,"footerReference",this.wNamespace),e.writeAttributeString(void 0,"type",this.wNamespace,"even"),i=this.getNextRelationShipID(),e.writeAttributeString(void 0,"id",this.rNamespace,i),this.addHeaderFooter(r,"EvenFooter",i),e.writeEndElement()),(r=t.header)&&r.blocks&&r.blocks.length>0&&(e.writeStartElement(void 0,"headerReference",this.wNamespace),e.writeAttributeString(void 0,"type",this.wNamespace,"default"),i=this.getNextRelationShipID(),e.writeAttributeString(void 0,"id",this.rNamespace,i),this.addHeaderFooter(r,"OddHeader",i),e.writeEndElement()),(r=t.footer)&&r.blocks&&r.blocks.length>0&&(e.writeStartElement(void 0,"footerReference",this.wNamespace),e.writeAttributeString(void 0,"type",this.wNamespace,"default"),i=this.getNextRelationShipID(),e.writeAttributeString(void 0,"id",this.rNamespace,i),this.addHeaderFooter(r,"OddFooter",i),e.writeEndElement())}},e.prototype.addHeaderFooter=function(e,t,i){var r=new a;this.headersFooters.add(t,r),this.headersFooters.get(t).add(i,e)},e.prototype.serializeBodyItems=function(e,t,i){for(var r=0;r<t.length;r++)this.serializeBodyItem(e,t[parseInt(r.toString(),10)],i)},e.prototype.serializeContentControl=function(e,t,i,r,n){if(sf.base.isNullOrUndefined(t))throw new Error("contentCOntrol should not be undefined");e.writeStartElement("w","sdt",this.wNamespace),e.writeStartElement(void 0,"sdtPr",this.wNamespace),sf.base.isNullOrUndefined(t)||this.serializeContentProperties(e,t,i,r,n)},e.prototype.serializeContentProperties=function(e,t,i,r,n){if(sf.base.isNullOrUndefined(t.title)||(e.writeStartElement(void 0,"alias",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,t.title),e.writeEndElement(),e.writeStartElement(void 0,"tag",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,t.tag),e.writeEndElement()),sf.base.isNullOrUndefined(t.characterFormat)||this.serializeCharacterFormat(e,i.contentControlProperties.characterFormat),(t.lockContents||t.lockContentControl)&&(e.writeStartElement(void 0,"lock",this.wNamespace),t.lockContentControl&&t.lockContents?e.writeAttributeString("w","val",this.wNamespace,"sdtContentLocked"):t.lockContentControl?e.writeAttributeString("w","val",this.wNamespace,"sdtLocked"):t.lockContents&&e.writeAttributeString("w","val",this.wNamespace,"contentLocked"),e.writeEndElement()),t.hasPlaceHolderText&&sf.base.isNullOrUndefined(void 0)&&(e.writeStartElement("w","placeholder",void 0),e.writeAttributeString("w","docPart",this.wNamespace,void 0),e.writeEndElement(),e.writeStartElement("w","showingPlcHdr",void 0),e.writeEndElement()),t.isTemporary&&(e.writeStartElement("w","temporary",void 0),e.writeEndElement()),sf.base.isNullOrUndefined(t.appearance)||(e.writeStartElement("w15","appearance",void 0),e.writeAttributeString("w15","val",void 0,t.appearance.toLowerCase()),e.writeEndElement()),sf.base.isNullOrUndefined(t.color)||(e.writeStartElement("w15","color",void 0),e.writeAttributeString("w","val",void 0,this.getColor(t.color)),e.writeEndElement()),t.multiline&&(e.writeStartElement(void 0,"text",this.wNamespace),e.writeAttributeString("w","multiLine",this.wNamespace,"1"),e.writeEndElement()),sf.base.isNullOrUndefined(t.xmlMapping)||t.xmlMapping.isMapped&&(e.writeStartElement("w","dataBinding",this.wNamespace),e.writeAttributeString("w","xpath",void 0,t.xmlMapping.xPath),e.writeAttributeString("w","storeItemID",void 0,t.xmlMapping.storeItemId),e.writeEndElement()),t.picture&&(e.writeStartElement("w","picture",this.wNamespace),e.writeEndElement()),sf.base.isNullOrUndefined(t.uncheckedState||t.checkedState)||(e.writeStartElement("w14","checkbox",void 0),t.isChecked?(e.writeStartElement("w14","checked",void 0),e.writeAttributeString("w14","val",void 0,"1"),e.writeEndElement()):(e.writeStartElement("w14","checked",void 0),e.writeAttributeString("w14","val",void 0,"0"),e.writeEndElement()),e.writeStartElement("w14","uncheckedState",void 0),e.writeAttributeString("w14","val",void 0,this.toUnicode(t.uncheckedState.value)),e.writeAttributeString("w14","font",void 0,t.uncheckedState.font),e.writeEndElement(),e.writeStartElement("w14","checkedState",void 0),e.writeAttributeString("w14","val",void 0,this.toUnicode(t.checkedState.value)),e.writeAttributeString("w14","font",void 0,t.checkedState.font),e.writeEndElement(),e.writeEndElement()),!sf.base.isNullOrUndefined(t.contentControlListItems)&&"DropDownList"===t.type){var o=t.contentControlListItems;e.writeStartElement(void 0,"dropDownList",this.wNamespace),this.serializeContentControlList(e,o),e.writeEndElement()}if(!sf.base.isNullOrUndefined(t.contentControlListItems)&&"ComboBox"===t.type){var s=t.contentControlListItems;e.writeStartElement(void 0,"comboBox",this.wNamespace),this.serializeContentControlList(e,s),e.writeEndElement()}if(this.serializeContentControlDate(e,t),sf.base.isNullOrUndefined(t.type)||"Picture"===t.type&&(e.writeStartElement(void 0,"picture",this.wNamespace),e.writeEndElement()),e.writeEndElement(),e.writeStartElement("w","sdtContent",this.wNamespace),!n){if(i.hasOwnProperty("blocks")&&sf.base.isNullOrUndefined(i.cellFormat))for(var l=0;l<i.blocks.length;l++){var h=i.blocks[l];if(h.hasOwnProperty("inlines"))this.paragraph=h,this.serializeParagraph(e,h,r),this.paragraph=void 0;else if(h.hasOwnProperty("rowFormat")){var d=new a;this.serializeRow(e,h,d)}else if(h.hasOwnProperty("contentControlProperties"))this.serializeContentControl(e,h.contentControlProperties,h,r);else{var c=h;this.serializeTable(e,c)}}else if(i.hasOwnProperty("rowFormat")){if(i.cells.length>0){d=new a;this.serializeRow(e,i,d)}}else if(i.hasOwnProperty("cellFormat")){d=new a;this.serializeCell(e,i,d)}e.writeEndElement(),e.writeEndElement()}},e.prototype.toUnicode=function(e){return e.charCodeAt(0).toString(16)},e.prototype.serializeContentControlList=function(e,t){for(var i=0;i<t.length;i++)e.writeStartElement(void 0,"listItem",this.wNamespace),sf.base.isNullOrUndefined(t[i].displayText)||e.writeAttributeString("w","displayText",this.wNamespace,t[i].displayText),e.writeAttributeString("w","value",this.wNamespace,t[i].value),e.writeEndElement()},e.prototype.serializeContentParagraph=function(e,t){for(var i=0;i<t.blocks.length;i++){var r=t.blocks[i];if(r.hasOwnProperty("inlines"))for(var n=0;n<r.inlines.length;n++){var o=r.inlines[n];sf.base.isNullOrUndefined(o.characterFormat)||this.serializeCharacterFormat(e,o.characterFormat)}}},e.prototype.serializeContentControlDate=function(e,t){"Date"===t.type&&(e.writeStartElement("w","date",this.wNamespace),sf.base.isNullOrUndefined(t.dateDisplayFormat)||(e.writeStartElement("w","calender",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,t.dateCalendarType),e.writeEndElement()),sf.base.isNullOrUndefined(t.dateDisplayLocale)||(e.writeStartElement("w","lid",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,t.dateDisplayLocale),e.writeEndElement()),sf.base.isNullOrUndefined(t.dateStorageFormat)||(e.writeStartElement("w","storeMappedDataAs",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,t.dateStorageFormat),e.writeEndElement()),sf.base.isNullOrUndefined(t.dateCalendarType)||(e.writeStartElement("w","dateFormat",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,t.dateDisplayFormat),e.writeEndElement()),e.writeEndElement())},e.prototype.serializeBodyItem=function(e,t,i){if(sf.base.isNullOrUndefined(t))throw new Error("BodyItem should not be undefined");if(t.hasOwnProperty("contentControlProperties"))this.serializeContentControl(e,t.contentControlProperties,t,i);else if(t.hasOwnProperty("inlines"))this.paragraph=t,this.serializeParagraph(e,t,i),this.paragraph=void 0;else for(var r=t,n=0;n<r.rows.length;n++)if(r.rows[n].cells.length>0){this.serializeTable(e,r);break}var o=this.blockOwner;!i&&o.hasOwnProperty("sectionFormat")&&o.blocks.indexOf(t)===o.blocks.length-1&&(e.writeStartElement("w","p",this.wNamespace),e.writeStartElement(void 0,"pPr",this.wNamespace),this.serializeSectionProperties(e,o),e.writeEndElement(),e.writeEndElement())},e.prototype.serializeParagraph=function(e,t,i){if(sf.base.isNullOrUndefined(t))throw new Error("Paragraph should not be undefined");e.writeStartElement("w","p",this.wNamespace),this.isInsideComment&&e.writeAttributeString("w14","paraId",void 0,this.commentParaID.toString()),e.writeStartElement(void 0,"pPr",this.wNamespace),sf.base.isNullOrUndefined(t.paragraphFormat)||this.serializeParagraphFormat(e,t.paragraphFormat,t),sf.base.isNullOrUndefined(t.characterFormat)||this.serializeCharacterFormat(e,t.characterFormat),e.writeEndElement(),this.prevRevisionIds=[],this.serializeParagraphItems(e,t.inlines),e.writeEndElement()},e.prototype.serializeRevisionStart=function(e,t,i){if(t.hasOwnProperty("revisionIds")){if(!sf.base.isNullOrUndefined(i)&&i.hasOwnProperty("bookmarkType")&&0===i.bookmarkType&&!(i.name.indexOf("_Toc")>=0)&&sf.base.isNullOrUndefined(t.revisionIds))return;for(var r=t.revisionIds,n=0;n<r.length;n++){var o=this.retrieveRevision(r[n]);"Insertion"===o.revisionType&&this.serializeTrackChanges(e,"ins",o.author,o.date),"Deletion"===o.revisionType&&this.serializeTrackChanges(e,"del",o.author,o.date)}}},e.prototype.serializeTrackChanges=function(e,t,i,r){e.writeStartElement("w",t,this.wNamespace),e.writeAttributeString("w","id",this.wNamespace,(this.trackChangesId++).toString()),e.writeAttributeString("w","author",this.wNamespace,i),e.writeAttributeString("w","date",this.wNamespace,r)},e.prototype.retrieveRevision=function(e){for(var t=0;t<this.revisions.length;t++)if(this.revisions[t].revisionID===e)return this.revisions[t]},e.prototype.serializeParagraphItems=function(e,t){for(var i,r=void 0,n=!1,o=0;o<t.length;o++){var s=t[o];s.hasOwnProperty("contentControlProperties")&&(i=!0,this.serializeContentControl(e,s.contentControlProperties,s,void 0,i),this.serializeParagraphItems(e,s.inlines)),s.hasOwnProperty("inlines")&&this.serializeParagraphItems(e,s),this.serializeRevisionStart(e,s,r);var a=!1;if(s.characterFormat&&(a=!sf.base.isNullOrUndefined(s.characterFormat.bdo)&&"None"!==s.characterFormat.bdo)&&!n&&(this.serializeBiDirectionalOverride(e,s.characterFormat),n=!0),n&&!a&&(e.writeEndElement(),n=!1),s.hasOwnProperty("fieldType"))this.serializeFieldCharacter(e,s);else if(s.hasOwnProperty("imageString"))this.serializePicture(e,s);else if(s.hasOwnProperty("shapeId")){var l=this.paragraph;this.serializeShape(e,s),this.paragraph=l}else s.hasOwnProperty("bookmarkType")?this.serializeBookMark(e,s):s.hasOwnProperty("editRangeId")?this.serializeEditRange(e,s):s.hasOwnProperty("chartType")?(this.chart=s,this.serializeChart(e,s),this.serializeChartStructure()):s.hasOwnProperty("commentCharacterType")?this.serializeComment(e,s):s.hasOwnProperty("footnoteType")?this.serializeEFReference(e,s):this.serializeTextRange(e,s,r);this.serializeRevisionEnd(e,s,r),r=s,i&&(e.writeEndElement(),e.writeEndElement(),i=!1)}n&&e.writeEndElement()},e.prototype.serializeEFReference=function(e,t){var i="",r=t.blocks;"Footnote"===t.footnoteType?(e.writeStartElement(void 0,"r",this.wNamespace),this.serializeCharacterFormat(e,t.characterFormat),e.writeStartElement(void 0,"footnoteReference",this.wNamespace),this.document.footnotes.continuationNotice&&0===this.efRelationShipId&&(this.efRelationShipId=1),i=this.getEFNextRelationShipID(),e.writeAttributeString(void 0,"id",this.wNamespace,i),this.addFootnotesEndnotes(r,"footnote",i),e.writeEndElement(),e.writeEndElement()):(e.writeStartElement(void 0,"r",this.wNamespace),this.serializeCharacterFormat(e,t.characterFormat),e.writeStartElement(void 0,"endnoteReference",this.wNamespace),i=this.getEFNextRelationShipID(),e.writeAttributeString(void 0,"id",this.wNamespace,i),this.addFootnotesEndnotes(r,"endnote",i),e.writeEndElement(),e.writeEndElement())},e.prototype.addFootnotesEndnotes=function(e,t,i){var r=new a;this.endnotesFootnotes.add(t,r),this.endnotesFootnotes.get(t).add(i,e)},e.prototype.serializeEndnotesFootnote=function(e,t){if(0!==this.endnotesFootnotes.length&&this.endnotesFootnotes.containsKey(t))for(var i=this.endnotesFootnotes.get(t),r=void 0,n=0;n<i.keys.length;n++){var o=i.keys[n];r=i.get(o),"endnote"===t?(this.endnotesPath,this.endnotesRelationPath,this.serializeInlineEndnotes(e,r,o)):(this.footnotesPath,this.footnotesRelationPath,this.serializeInlineFootnotes(e,r,o))}},e.prototype.serializeInlineEndnotes=function(e,t,i){this.endNoteFootnote=t;var r=this.blockOwner;this.blockOwner=t,e.writeStartElement("w","endnote",this.wNamespace),e.writeAttributeString(void 0,"id",this.wNamespace,i),this.serializeBodyItems(e,t,!0),e.writeEndElement(),this.blockOwner=r,this.endNoteFootnote=void 0},e.prototype.serializeInlineFootnotes=function(e,t,i){this.endNoteFootnote=t;var r=this.blockOwner;this.blockOwner=t,e.writeStartElement("w","footnote",this.wNamespace),e.writeAttributeString(void 0,"id",this.wNamespace,i),this.serializeBodyItems(e,t,!0),e.writeEndElement(),this.blockOwner=r,this.endNoteFootnote=void 0},e.prototype.writeEFCommonAttributes=function(e){e.writeAttributeString("xmlns","wpc",void 0,this.wpCanvasNamespace),e.writeAttributeString("xmlns","cx",void 0,this.cxNamespace),e.writeAttributeString("xmlns","aink",void 0,"http://schemas.microsoft.com/office/drawing/2016/ink"),e.writeAttributeString("xmlns","am3d",void 0,"http://schemas.microsoft.com/office/drawing/2017/,odel3d"),this.writeCustom(e),e.writeAttributeString("xmlns","wp14",void 0,this.wpDrawingNamespace),e.writeAttributeString("xmlns","wp",void 0,this.wpNamespace),e.writeAttributeString("xmlns","w",void 0,this.wNamespace),this.writeDup(e),e.writeAttributeString("xmlns","wne",void 0,this.wneNamespace),e.writeAttributeString("xmlns","wps",void 0,this.wpShapeNamespace),e.writeAttributeString("mc","Ignorable",void 0,"w14 w15")},e.prototype.serializeFootnotes=function(){if(!sf.base.isNullOrUndefined(this.document.footnotes)){var e=new sf.fileutils.XmlWriter;e.writeStartElement("w","footnotes",this.wNamespace),this.writeEFCommonAttributes(e),e.writeStartElement("w","footnote",this.wNamespace),e.writeAttributeString(void 0,"type",this.wNamespace,"separator"),e.writeAttributeString(void 0,"id",this.wNamespace,"-1"),this.serializeBodyItems(e,this.document.footnotes.separator,!0),e.writeEndElement(),e.writeStartElement("w","footnote",this.wNamespace),e.writeAttributeString(void 0,"type",this.wNamespace,"continuationSeparator"),e.writeAttributeString(void 0,"id",this.wNamespace,"0"),this.serializeBodyItems(e,this.document.footnotes.continuationSeparator,!0),e.writeEndElement(),this.document.footnotes.continuationNotice&&(e.writeStartElement("w","footnote",this.wNamespace),e.writeAttributeString(void 0,"type",this.wNamespace,"continuationNotice"),e.writeAttributeString(void 0,"id",this.wNamespace,"1"),this.serializeBodyItems(e,this.document.footnotes.continuationNotice,!0),e.writeEndElement()),this.serializeEndnotesFootnote(e,"footnote"),e.writeEndElement();var t=new sf.compression.ZipArchiveItem(e.buffer,this.footnotesPath);this.mArchive.addItem(t)}},e.prototype.serializeEndnotes=function(){if(!sf.base.isNullOrUndefined(this.document.endnotes)){var e=new sf.fileutils.XmlWriter;e.writeStartElement("w","endnotes",this.wNamespace),this.writeEFCommonAttributes(e),e.writeStartElement("w","endnote",this.wNamespace),e.writeAttributeString(void 0,"type",this.wNamespace,"separator"),e.writeAttributeString(void 0,"id",this.wNamespace,"-1"),this.serializeBodyItems(e,this.document.endnotes.separator,!0),e.writeEndElement(),e.writeStartElement("w","endnote",this.wNamespace),e.writeAttributeString(void 0,"type",this.wNamespace,"continuationSeparator"),e.writeAttributeString(void 0,"id",this.wNamespace,"0"),this.serializeBodyItems(e,this.document.endnotes.continuationSeparator,!0),e.writeEndElement(),this.document.endnotes.continuationNotice&&(e.writeStartElement("w","endnote",this.wNamespace),e.writeAttributeString(void 0,"type",this.wNamespace,"continuationNotice"),e.writeAttributeString(void 0,"id",this.wNamespace,"1"),this.serializeBodyItems(e,this.document.endnotes.continuationNotice,!0),e.writeEndElement()),this.serializeEndnotesFootnote(e,"endnote"),e.writeEndElement();var t=new sf.compression.ZipArchiveItem(e.buffer,this.endnotesPath);this.mArchive.addItem(t)}},e.prototype.serializeRevisionEnd=function(e,t,i){if(t.hasOwnProperty("revisionIds")){if(!sf.base.isNullOrUndefined(i)&&i.hasOwnProperty("fieldType")&&0===i.fieldType&&t.text.indexOf("TOC")>=0)return;for(var r=0;r<t.revisionIds.length;r++){var n=this.retrieveRevision(t.revisionIds[r]);"Insertion"!==n.revisionType&&"Deletion"!==n.revisionType||e.writeEndElement()}}},e.prototype.serializeComment=function(e,t){if(1!==this.mComments.length||""!==this.mComments[0].text){0===t.commentCharacterType?e.writeStartElement("w","commentRangeStart",this.wNamespace):1===t.commentCharacterType&&e.writeStartElement("w","commentRangeEnd",this.wNamespace);var i=this.commentId[t.commentId];sf.base.isNullOrUndefined(i)&&(i=this.commentId[t.commentId]=this.currentCommentId++),e.writeAttributeString("w","id",this.wNamespace,i.toString()),e.writeEndElement(),1===t.commentCharacterType&&this.serializeCommentItems(e,i)}},e.prototype.serializeCommentItems=function(e,t){e.writeStartElement("w","r",this.wNamespace),e.writeStartElement("w","commentReference",this.wNamespace),e.writeAttributeString("w","id",this.wNamespace,t.toString()),e.writeEndElement(),e.writeEndElement()},e.prototype.serializeBiDirectionalOverride=function(e,t){e.writeStartElement(void 0,"bdo",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,t.bdo.toLowerCase())},e.prototype.serializeEditRange=function(e,t){t.hasOwnProperty("editableRangeStart")?e.writeStartElement("w","permEnd",this.wNamespace):(e.writeStartElement("w","permStart",this.wNamespace),t.user&&""!==t.user&&e.writeAttributeString("w","ed",this.wNamespace,t.user),t.group&&""!==t.group&&e.writeAttributeString("w","edGrp",this.wNamespace,t.group.toLowerCase()),t.columnFirst&&-1!==t.columnFirst&&e.writeAttributeString("w","colFirst",this.wNamespace,t.columnFirst.toString()),t.columnLast&&-1!==t.columnLast&&e.writeAttributeString("w","colLast",this.wNamespace,t.columnLast.toString())),e.writeAttributeString("w","id",this.wNamespace,t.editRangeId),e.writeEndElement()},e.prototype.serializeBookMark=function(e,t){var i=this.getBookmarkId(t.name),r=t.name;0===t.bookmarkType?(e.writeStartElement("w","bookmarkStart",this.wNamespace),e.writeAttributeString("w","name",this.wNamespace,r)):1===t.bookmarkType&&e.writeStartElement("w","bookmarkEnd",this.wNamespace),e.writeAttributeString("w","id",this.wNamespace,i.toString()),e.writeEndElement()},e.prototype.getBookmarkId=function(e){var t=this.bookmarks.indexOf(e);return t<0&&(t=this.bookmarks.length,this.bookmarks.push(e)),t},e.prototype.serializePicture=function(e,t){t.width>=0&&t.height>=0&&(e.writeStartElement(void 0,"r",this.wNamespace),this.serializeCharacterFormat(e,t.characterFormat),this.serializeDrawing(e,t),e.writeEndElement())},e.prototype.serializeShape=function(e,t){t.width>=0&&t.height>=0&&(e.writeStartElement(void 0,"r",this.wNamespace),this.serializeCharacterFormat(e,t.characterFormat),this.serializeDrawing(e,t),e.writeEndElement())},e.prototype.serializeDrawing=function(e,t){e.writeStartElement(void 0,"drawing",this.wNamespace),t.hasOwnProperty("chartType")?this.serializeInlineCharts(e,t):"Inline"===t.textWrappingStyle?this.serializeInlinePictureAndShape(e,t):this.serializeWrappingPictureAndShape(e,t),e.writeEndElement()},e.prototype.serializeWrappingPictureAndShape=function(e,t){e.writeStartElement("wp","anchor",this.wpNamespace),this.serializePictureAndShapeDistance(e,t),e.writeAttributeString(void 0,"simplePos",void 0,"0"),e.writeAttributeString(void 0,"relativeHeight",void 0,t.zOrderPosition?Math.abs(t.zOrderPosition).toString():"0");var i=t.textWrappingStyle&&"Behind"===t.textWrappingStyle;e.writeAttributeString(void 0,"behindDoc",void 0,i?"1":"0");var r=t.LockAnchor?"1":"0";e.writeAttributeString(void 0,"locked",void 0,r);var n=t.layoutInCell?"1":"0";e.writeAttributeString(void 0,"layoutInCell",void 0,n);var o=t.allowOverlap?"1":"0";if(e.writeAttributeString(void 0,"allowOverlap",void 0,o),e.writeStartElement("wp","simplePos",this.wpNamespace),e.writeAttributeString(void 0,"x",void 0,"0"),e.writeAttributeString(void 0,"y",void 0,"0"),e.writeEndElement(),e.writeStartElement("wp","positionH",this.wpNamespace),e.writeAttributeString(void 0,"relativeFrom",void 0,x.formatText("firstlower",t.horizontalOrigin.toString())),"None"===t.horizontalAlignment){e.writeStartElement("wp","posOffset",this.wpNamespace);var s=Math.round(t.horizontalPosition*this.emusPerPoint);e.writeString(s.toString()),e.writeEndElement()}else{e.writeStartElement("wp","align",this.wpNamespace);var a=t.horizontalAlignment.toString().toLowerCase();e.writeString(a),e.writeEndElement()}if(e.writeEndElement(),e.writeStartElement("wp","positionV",this.wpNamespace),e.writeAttributeString(void 0,"relativeFrom",void 0,x.formatText("firstlower",t.verticalOrigin.toString())),"None"===t.verticalAlignment){e.writeStartElement("wp","posOffset",this.wpNamespace);var l=Math.round(t.verticalPosition*this.emusPerPoint);e.writeString(l.toString()),e.writeEndElement()}else{e.writeStartElement("wp","align",this.wpNamespace);var h=t.verticalAlignment.toString().toLowerCase();e.writeString(h),e.writeEndElement()}e.writeEndElement(),e.writeStartElement(void 0,"extent",this.wpNamespace);var d=Math.round(t.width*this.emusPerPoint);e.writeAttributeString(void 0,"cx",void 0,d.toString());var c=Math.round(t.height*this.emusPerPoint);e.writeAttributeString(void 0,"cy",void 0,c.toString()),e.writeEndElement(),sf.base.isNullOrUndefined(t.imageString)?this.serializeShapeDrawingGraphics(e,t):(this.serializeShapeWrapStyle(e,t),this.serializeDrawingGraphics(e,t)),e.writeEndElement()},e.prototype.serializeInlinePictureAndShape=function(e,t){e.writeStartElement(void 0,"inline",this.wpNamespace),this.writeDefaultDistAttribute(e),e.writeStartElement(void 0,"extent",this.wpNamespace);var i=Math.round(t.width*this.emusPerPoint);e.writeAttributeString(void 0,"cx",void 0,i.toString());var r=Math.round(t.height*this.emusPerPoint);e.writeAttributeString(void 0,"cy",void 0,r.toString()),e.writeEndElement(),sf.base.isNullOrUndefined(t.imageString)?this.serializeShapeDrawingGraphics(e,t):(this.serializeShapeWrapStyle(e,t),this.serializeDrawingGraphics(e,t)),e.writeEndElement()},e.prototype.serializePictureAndShapeDistance=function(e,t){var i=t.distanceTop?Math.round(t.distanceTop*this.emusPerPoint).toString():"0";e.writeAttributeString(void 0,"distT",void 0,i);var r=t.distanceBottom?Math.round(t.distanceBottom*this.emusPerPoint).toString():"0";e.writeAttributeString(void 0,"distB",void 0,r);var n=t.distanceLeft?Math.round(t.distanceLeft*this.emusPerPoint).toString():"114300";e.writeAttributeString(void 0,"distL",void 0,n);var o=t.distanceRight?Math.round(t.distanceRight*this.emusPerPoint).toString():"114300";e.writeAttributeString(void 0,"distR",void 0,o)},e.prototype.writeDefaultDistAttribute=function(e){e.writeAttributeString(void 0,"distT",void 0,"0"),e.writeAttributeString(void 0,"distB",void 0,"0"),e.writeAttributeString(void 0,"distL",void 0,"0"),e.writeAttributeString(void 0,"distR",void 0,"0")},e.prototype.serializeInlineCharts=function(e,t){e.writeStartElement(void 0,"inline",this.wpNamespace),this.writeDefaultDistAttribute(e),e.writeStartElement(void 0,"extent",this.wpNamespace);var i=Math.round(t.width*this.emusPerPoint);e.writeAttributeString(void 0,"cx",void 0,i.toString());var r=Math.round(t.height*this.emusPerPoint);e.writeAttributeString(void 0,"cy",void 0,r.toString()),e.writeEndElement(),e.writeStartElement(void 0,"effectExtent",this.wpNamespace),e.writeAttributeString(void 0,"l",void 0,"0"),e.writeAttributeString(void 0,"t",void 0,"0"),e.writeAttributeString(void 0,"r",void 0,"0"),e.writeAttributeString(void 0,"b",void 0,"0"),e.writeEndElement(),this.serializeDrawingGraphicsChart(e,t),e.writeEndElement()},e.prototype.serializeDrawingGraphicsChart=function(e,t){var i;i=this.updatechartId(t),e.writeStartElement("wp","docPr",this.wpNamespace),e.writeAttributeString(void 0,"id",void 0,(this.mDocPrID++).toString()),e.writeAttributeString(void 0,"name",void 0,this.getNextChartName()),e.writeEndElement(),e.writeStartElement("wp","cNvGraphicFramePr",this.wpNamespace),e.writeEndElement(),e.writeStartElement("a","graphic",this.aNamespace),e.writeStartElement("a","graphicData",this.aNamespace),e.writeAttributeString(void 0,"uri",void 0,this.chartNamespace),e.writeStartElement("c","chart",this.chartNamespace),e.writeAttributeString("xmlns","r",void 0,this.rNamespace),e.writeAttributeString("r","id",void 0,i),e.writeEndElement(),e.writeEndElement(),e.writeEndElement()},e.prototype.getNextChartName=function(){return"Chart"+ ++this.chartCount},e.prototype.serializeChart=function(e,t){e.writeStartElement("w","r",this.wNamespace),this.serializeCharacterFormat(e,t.characterFormat),this.serializeDrawing(e,t),e.writeEndElement()},e.prototype.serializeChartStructure=function(){this.serializeChartXML(),this.serializeChartColors(),this.serializeChartExcelData(),this.serializeChartRelations(),this.chart=void 0,this.saveExcel()},e.prototype.serializeChartXML=function(){var e,t=new sf.fileutils.XmlWriter;t.writeStartElement("c","chartSpace",this.chartNamespace),t.writeAttributeString("xmlns","a",void 0,this.aNamespace),t.writeAttributeString("xmlns","r",void 0,this.rNamespace),t.writeAttributeString("xmlns","c16r2",void 0,this.c15Namespace),this.serializeChartData(t,this.chart),t.writeStartElement("c","externalData",this.chartNamespace),t.writeAttributeString("r","id",void 0,"rId1"),t.writeStartElement("c","autoUpdate",this.chartNamespace),t.writeAttributeString(void 0,"val",void 0,"0"),t.writeEndElement(),t.writeEndElement(),t.writeEndElement(),e=this.chartPath+"/chart"+this.chartCount+".xml";var i=new sf.compression.ZipArchiveItem(t.buffer,e);this.mArchive.addItem(i)},e.prototype.serializeChartColors=function(){var e=new sf.fileutils.XmlWriter,t="";e.writeStartElement("cs","colorStyle",this.csNamespace),e.writeAttributeString("xmlns","a",void 0,this.aNamespace),e.writeAttributeString(void 0,"meth",void 0,"cycle"),e.writeAttributeString(void 0,"id",void 0,"10"),this.serializeChartColor(e),t=this.chartPath+"/colors"+this.chartCount+".xml",e.writeEndElement();var i=new sf.compression.ZipArchiveItem(e.buffer,t);this.mArchive.addItem(i),t=""},e.prototype.serializeChartColor=function(e){for(var t=1;t<=6;t++)e.writeStartElement("a","schemeClr",this.aNamespace),e.writeAttributeString(void 0,"val",void 0,"accent"+t),e.writeEndElement();e.writeStartElement("cs","variation",this.csNamespace),e.writeEndElement(),e.writeStartElement("cs","variation",this.csNamespace),e.writeStartElement("a","lumMod",this.aNamespace),e.writeAttributeString(void 0,"val",void 0,"60000"),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("cs","variation",this.csNamespace),e.writeStartElement("a","lumMod",this.aNamespace),e.writeAttributeString(void 0,"val",void 0,"80000"),e.writeEndElement(),e.writeStartElement("a","lumOff",this.aNamespace),e.writeAttributeString(void 0,"val",void 0,"20000"),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("cs","variation",this.csNamespace),e.writeStartElement("a","lumMod",this.aNamespace),e.writeAttributeString(void 0,"val",void 0,"80000"),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("cs","variation",this.csNamespace),e.writeStartElement("a","lumMod",this.aNamespace),e.writeAttributeString(void 0,"val",void 0,"60000"),e.writeEndElement(),e.writeStartElement("a","lumOff",this.aNamespace),e.writeAttributeString(void 0,"val",void 0,"40000"),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("cs","variation",this.csNamespace),e.writeStartElement("a","lumMod",this.aNamespace),e.writeAttributeString(void 0,"val",void 0,"50000"),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("cs","variation",this.csNamespace),e.writeStartElement("a","lumMod",this.aNamespace),e.writeAttributeString(void 0,"val",void 0,"70000"),e.writeEndElement(),e.writeStartElement("a","lumOff",this.aNamespace),e.writeAttributeString(void 0,"val",void 0,"30000"),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("cs","variation",this.csNamespace),e.writeStartElement("a","lumMod",this.aNamespace),e.writeAttributeString(void 0,"val",void 0,"70000"),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("cs","variation",this.csNamespace),e.writeStartElement("a","lumMod",this.aNamespace),e.writeAttributeString(void 0,"val",void 0,"50000"),e.writeEndElement(),e.writeStartElement("a","lumOff",this.aNamespace),e.writeAttributeString(void 0,"val",void 0,"50000"),e.writeEndElement(),e.writeEndElement()},e.prototype.serializeChartExcelData=function(){sf.base.isNullOrUndefined(this.excelFiles)&&(this.excelFiles=new a),this.mArchiveExcel=new sf.compression.ZipArchive,this.mArchiveExcel.compressionLevel="Normal";var e=this.chart.chartType,t="Scatter_Markers"===e||"Bubble"===e;this.serializeWorkBook(),this.serializeSharedString(t),this.serializeExcelContentTypes(),this.serializeExcelData(t),this.serializeExcelStyles(),this.serializeExcelRelation(),this.serializeExcelGeneralRelations(),this.chartStringCount=0},e.prototype.serializeWorkBook=function(){var e=new sf.fileutils.XmlWriter;this.resetExcelRelationShipId(),e.writeStartElement(void 0,"workbook",void 0),e.writeAttributeString("xmlns","r",void 0,this.rNamespace),e.writeAttributeString("xmlns",void 0,void 0,this.spreadSheetNamespace),e.writeStartElement(void 0,"sheets",void 0),e.writeStartElement(void 0,"sheet",void 0),e.writeAttributeString(void 0,"name",void 0,"Sheet1"),e.writeAttributeString(void 0,"sheetId",void 0,"1"),e.writeAttributeString("r","id",void 0,this.getNextExcelRelationShipID()),e.writeEndElement(),e.writeEndElement(),e.writeEndElement();var t=new sf.compression.ZipArchiveItem(e.buffer,"xl/workbook.xml");this.mArchiveExcel.addItem(t)},e.prototype.serializeExcelStyles=function(){var e=new sf.fileutils.XmlWriter;e.writeStartElement(void 0,"styleSheet",void 0),e.writeAttributeString("xmlns","mc",void 0,this.veNamespace),e.writeAttributeString("mc","Ignorable",void 0,"x14ac"),e.writeAttributeString("xmlns","x14ac",void 0,"http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac"),e.writeAttributeString("xmlns",void 0,void 0,this.spreadSheetNamespace),e.writeEndElement();var t=new sf.compression.ZipArchiveItem(e.buffer,"xl/styles.xml");this.mArchiveExcel.addItem(t)},e.prototype.serializeExcelData=function(e){var t=new sf.fileutils.XmlWriter;t.writeStartElement(void 0,"worksheet",void 0),t.writeAttributeString("xmlns","r",void 0,this.rNamespace),t.writeAttributeString("xmlns","x14",void 0,this.spreadSheet9),t.writeAttributeString("xmlns","mc",void 0,this.veNamespace),t.writeAttributeString("xmlns",void 0,void 0,this.spreadSheetNamespace),this.serializeExcelSheet(t,e),t.writeEndElement();var i=new sf.compression.ZipArchiveItem(t.buffer,"xl/worksheets/sheet1.xml");this.mArchiveExcel.addItem(i)},e.prototype.serializeSharedString=function(e){for(var t=this.chart,i=new sf.fileutils.XmlWriter,r=[],n=this.chart.chartType,o=t.chartSeries.length,s=0;s<o;s++){var a=t.chartSeries[s],l=a.seriesName.match(/[a-z]/i);e&&0===s&&r.push("X-Values"),l&&(r.push(a.seriesName),this.chartStringCount++)}"Bubble"===n&&r.push("Size");for(var h=0;h<t.chartCategory.length;h++){var d=t.chartCategory[h],c=t.chartPrimaryCategoryAxis.numberFormat;((l=d.categoryXName.match(/[a-z]/i))||"m/d/yyyy"===c)&&(r.push(d.categoryXName),this.chartStringCount++)}var p=this.chartStringCount+1;i.writeStartElement(void 0,"sst",void 0),i.writeAttributeString("xmlns",void 0,void 0,this.spreadSheetNamespace),i.writeAttributeString(void 0,"count",void 0,p.toString()),i.writeAttributeString(void 0,"uniqueCount",void 0,p.toString());for(var u=0;u<=r.length;u++)i.writeStartElement(void 0,"si",void 0),i.writeStartElement(void 0,"t",void 0),u!==r.length?i.writeString(r[u]):e||(i.writeAttributeString("xml","space",this.xmlNamespace,"preserve"),i.writeString(" ")),i.writeEndElement(),i.writeEndElement();i.writeEndElement();var g=new sf.compression.ZipArchiveItem(i.buffer,"xl/sharedStrings.xml");this.mArchiveExcel.addItem(g)},e.prototype.serializeExcelSheet=function(e,t){var i,r=this.chart,n="s",o="Bubble"===r.chartType,s=r.chartCategory.length+1,a=r.chartPrimaryCategoryAxis.numberFormat,l=r.chartSeries.length+1;o&&(i=l,l+=1);var h=void 0,d=void 0,c=0;e.writeStartElement(void 0,"sheetData",void 0);for(var p=0;p<s;p++){e.writeStartElement(void 0,"row",void 0),e.writeAttributeString(void 0,"r",void 0,(p+1).toString());for(var u=0;u<l;u++){var g=String.fromCharCode("A".charCodeAt(0)+u)+(p+1).toString();if(e.writeStartElement(void 0,"c",void 0),e.writeAttributeString(void 0,"r",void 0,g),0!==p&&0===u){var f=(h=r.chartCategory[p-1]).categoryXName.match(/[a-z]/i);n=sf.base.isNullOrUndefined(f)&&"m/d/yyyy"===a?"s":!f&&!sf.base.isNullOrUndefined(f)||t?"n":"s"}else if(0===p&&0!==u&&u!==i){n=(f=(d=r.chartSeries[u-1]).seriesName.match(/[a-z]/i))?"s":"n"}else n=0===p&&o&&u===i||0===p&&0===u?"s":"n";if(e.writeAttributeString(void 0,"t",void 0,n),e.writeStartElement(void 0,"v",void 0),0!==p||0!==u||t){if("s"===n)e.writeString(c.toString()),c++;else if(0!==p&&"s"!==n&&0===u&&u!==i)e.writeString(h.categoryXName);else if(0!==u&&"s"!==n&&0===p&&u!==i)e.writeString(d.seriesName);else if(0!==u&&u!==i){var m=h.chartData[u-1].yValue;e.writeString(m.toString())}else if(o&&u===i){var y=h.chartData[u-2].size;e.writeString(y.toString())}}else e.writeString(this.chartStringCount.toString());e.writeEndElement(),e.writeEndElement(),n=""}e.writeEndElement()}e.writeEndElement()},e.prototype.serializeExcelContentTypes=function(){var e=new sf.fileutils.XmlWriter;e.writeStartElement(void 0,"Types","http://schemas.openxmlformats.org/package/2006/content-types"),this.serializeDefaultContentType(e,"xml",this.xmlContentType),this.serializeDefaultContentType(e,"rels",this.relationContentType),this.serializeOverrideContentType(e,"xl/styles.xml","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml"),this.serializeOverrideContentType(e,"xl/workbook.xml","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml"),this.serializeOverrideContentType(e,"xl/sharedStrings.xml","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml"),this.serializeOverrideContentType(e,"xl/worksheets/sheet1.xml","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml"),e.writeEndElement();var t=new sf.compression.ZipArchiveItem(e.buffer,this.contentTypesPath);this.mArchiveExcel.addItem(t)},e.prototype.serializeExcelRelation=function(){var e=new sf.fileutils.XmlWriter;this.resetExcelRelationShipId();e.writeStartElement(void 0,"Relationships",this.rpNamespace),this.serializeRelationShip(e,this.getNextExcelRelationShipID(),"http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","worksheets/sheet1.xml"),this.serializeRelationShip(e,this.getNextExcelRelationShipID(),this.stylesRelType,"styles.xml"),this.serializeRelationShip(e,this.getNextExcelRelationShipID(),"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings","sharedStrings.xml"),e.writeEndElement();var t=new sf.compression.ZipArchiveItem(e.buffer,this.excelRelationPath);this.mArchiveExcel.addItem(t)},e.prototype.serializeExcelGeneralRelations=function(){var e=new sf.fileutils.XmlWriter;this.resetExcelRelationShipId(),e.writeStartElement(void 0,"Relationships",this.rpNamespace),this.serializeRelationShip(e,this.getNextExcelRelationShipID(),this.documentRelType,"xl/workbook.xml"),e.writeEndElement();var t=new sf.compression.ZipArchiveItem(e.buffer,this.generalRelationPath);this.mArchiveExcel.addItem(t)},e.prototype.getNextExcelRelationShipID=function(){return"rId"+ ++this.eRelationShipId},e.prototype.getNextChartRelationShipID=function(){return"rId"+ ++this.cRelationShipId},e.prototype.serializeChartData=function(e,t){e.writeStartElement("c","date1904",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"0"),e.writeEndElement(),e.writeStartElement("c","lang",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"en-US"),e.writeEndElement(),e.writeStartElement("c","roundedCorners",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"0"),e.writeEndElement(),e.writeStartElement("mc","AlternateContent",this.veNamespace),e.writeStartElement("mc","Choice",this.veNamespace),e.writeAttributeString("xmlns","c14",void 0,this.c7Namespace),e.writeAttributeString(void 0,"Requires",void 0,"c14"),e.writeStartElement("c14","style",void 0),e.writeAttributeString(void 0,"val",void 0,"102"),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("mc","Fallback",this.veNamespace),e.writeStartElement("c","style",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"2"),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("c","chart",this.chartNamespace),sf.base.isNullOrUndefined(this.chart.chartTitle)||(e.writeStartElement("c","title",this.chartNamespace),this.serializeTextProperties(e,this.chart.chartTitleArea,this.chart.chartTitle),e.writeEndElement()),this.serializeChartPlotArea(e,t),e.writeEndElement(),this.serializeShapeProperties(e,"D9D9D9",!0),e.writeStartElement("c","txPr",this.chartNamespace),e.writeAttributeString("xmlns","c",void 0,this.chartNamespace),e.writeStartElement("a","bodyPr",this.aNamespace),e.writeAttributeString("xmlns","a",void 0,this.aNamespace),e.writeEndElement(),e.writeStartElement("a","lstStyle",this.aNamespace),e.writeAttributeString("xmlns","a",void 0,this.aNamespace),e.writeEndElement(),e.writeStartElement("a","p",this.aNamespace),e.writeAttributeString("xmlns","a",void 0,this.aNamespace),e.writeStartElement("a","pPr",this.aNamespace),e.writeStartElement("a","defRPr",this.aNamespace),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("a","endParaRPr",this.aNamespace),e.writeAttributeString(void 0,"lang",void 0,"en-US"),e.writeEndElement(),e.writeEndElement(),e.writeEndElement()},e.prototype.serializeChartPlotArea=function(e,t){e.writeStartElement("c","autoTitleDeleted",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"0"),e.writeEndElement(),e.writeStartElement("c","plotArea",this.chartNamespace),e.writeStartElement("c","layout",this.chartNamespace),e.writeEndElement();var i=this.chartType(t),r="pieChart"===i||"doughnutChart"===i,n="scatterChart"===i||"bubbleChart"===i;if(e.writeStartElement("c",i,this.chartNamespace),"barChart"===i){var o="";o="Column_Clustered"===t.chartType||"Column_Stacked"===t.chartType||"Column_Stacked_100"===t.chartType?"col":"bar",e.writeStartElement("c","barDir",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,o),e.writeEndElement()}if(!r&&!n){var s=this.chartGrouping(t.chartType);e.writeStartElement("c","grouping",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,s),e.writeEndElement()}"scatterChart"===i&&(e.writeStartElement("c","scatterStyle",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"marker"),e.writeEndElement()),e.writeStartElement("c","varyColors",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"0"),e.writeEndElement();for(var a="",l=0;l<t.chartSeries.length;l++){var h=t.chartSeries[l];this.seriesCount=l,e.writeStartElement("c","ser",this.chartNamespace),e.writeStartElement("c","idx",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,l.toString()),e.writeEndElement(),e.writeStartElement("c","order",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,l.toString()),e.writeEndElement(),e.writeStartElement("c","tx",this.chartNamespace),e.writeStartElement("c","strRef",this.chartNamespace),e.writeStartElement("c","f",this.chartNamespace);var d=String.fromCharCode("B".charCodeAt(0)+l);if(a="Sheet1!$"+d,e.writeString(a+"$1"),a=a+"$2:$"+d+"$",e.writeEndElement(),e.writeStartElement("c","strCache",this.chartNamespace),e.writeStartElement("c","ptCount",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"1"),e.writeEndElement(),e.writeStartElement("c","pt",this.chartNamespace),e.writeAttributeString(void 0,"idx",void 0,"0"),e.writeStartElement("c","v",this.chartNamespace),e.writeString(h.seriesName),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),"Pie"===t.chartType||"Doughnut"===t.chartType?(this.parseChartDataPoint(e,h),e.writeStartElement("c","explosion",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"0"),e.writeEndElement()):n||this.parseChartSeriesColor(e,h.dataPoints,i),"scatterChart"===i){var c=h.dataPoints[0].fill.foreColor;e.writeStartElement("c","marker",this.chartNamespace),e.writeStartElement("c","symbol",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"circle"),e.writeEndElement(),e.writeStartElement("c","size",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"5"),e.writeEndElement(),this.serializeShapeProperties(e,c,!1),e.writeEndElement()}h.dataLabel&&this.parseChartDataLabels(e,h.dataLabel),h.trendLines&&this.parseChartTrendLines(e,h),h.errorBar&&this.serializeChartErrorBar(e,h),"scatterChart"===i?this.serializeDefaultShapeProperties(e):"bubbleChart"===i&&this.serializeShapeProperties(e,h.dataPoints[l].fill.foreColor,!1);var p="cat",u="strRef",g="strCache";"scatterChart"===i&&(p="xVal",u="numRef",g="numCache"),e.writeStartElement("c",p,this.chartNamespace),e.writeStartElement("c",u,this.chartNamespace),this.serializeChartCategory(e,t,g),e.writeEndElement(),e.writeEndElement(),this.serializeChartValue(e,a,i),e.writeEndElement()}if(e.writeStartElement("c","dLbls",this.chartNamespace),r&&(e.writeStartElement("c","dLblPos",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"bestFit"),e.writeEndElement()),e.writeStartElement("c","showLegendKey",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"0"),e.writeEndElement(),e.writeStartElement("c","showVal",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"0"),e.writeEndElement(),e.writeStartElement("c","showCatName",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"0"),e.writeEndElement(),e.writeStartElement("c","showSerName",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"0"),e.writeEndElement(),e.writeStartElement("c","showPercent",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"0"),e.writeEndElement(),e.writeStartElement("c","showBubbleSize",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"0"),e.writeEndElement(),e.writeStartElement("c","showLeaderLines",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"1"),e.writeEndElement(),e.writeEndElement(),r){var f=0,m=0;(h=this.chart.chartSeries[0]).hasOwnProperty("firstSliceAngle")&&(f=h.firstSliceAngle),e.writeStartElement("c","firstSliceAng",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,f.toString()),e.writeEndElement(),"Doughnut"===t.chartType&&(m=h.holeSize,e.writeStartElement("c","holeSize",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,m.toString()),e.writeEndElement())}"lineChart"===i||n?"bubbleChart"!==i&&(e.writeStartElement("c","smooth",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"0"),e.writeEndElement()):(e.writeStartElement("c","gapWidth",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,this.chart.gapWidth.toString()),e.writeEndElement(),e.writeStartElement("c","overlap",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,this.chart.overlap.toString()),e.writeEndElement()),"bubbleChart"===i&&(e.writeStartElement("c","sizeRepresents",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"area"),e.writeEndElement());var y=this.chart.chartType;r||(e.writeStartElement("c","axId",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"335265000"),e.writeEndElement(),e.writeStartElement("c","axId",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"335263360"),e.writeEndElement()),e.writeEndElement();var v="Column_Stacked_100"===y||"Area_Stacked_100"===y||"Bar_Stacked_100"===y||"Line_Stacked_100"===y||"Line_Markers_Stacked_100"===y,b=this.chart.chartPrimaryCategoryAxis.categoryType;if(r||(this.serializeCategoryAxis(e,b,v),this.serializeValueAxis(e,b,v)),this.chart.hasOwnProperty("chartDataTable")){var w=this.chart.chartDataTable,x=0,M=0,N=0,I=0;w.showSeriesKeys&&(I=1),w.hasHorzBorder&&(x=1),w.hasVertBorder&&(M=1),w.hasBorders&&(N=1),e.writeStartElement("c","dTable",this.chartNamespace),e.writeStartElement("c","showHorzBorder",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,x.toString()),e.writeEndElement(),e.writeStartElement("c","showVertBorder",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,M.toString()),e.writeEndElement(),e.writeStartElement("c","showOutline",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,N.toString()),e.writeEndElement(),e.writeStartElement("c","showKeys",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,I.toString()),e.writeEndElement(),e.writeEndElement()}this.serializeDefaultShapeProperties(e),e.writeEndElement(),sf.base.isNullOrUndefined(this.chart.chartLegend.position)||this.serializeChartLegend(e),e.writeStartElement("c","plotVisOnly",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"1"),e.writeEndElement(),e.writeStartElement("c","dispBlanksAs",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"gap"),e.writeEndElement()},e.prototype.serializeChartLegend=function(e){var t=this.chartLegendPosition(this.chart.chartLegend),i=this.chart.chartLegend.chartTitleArea,r=i.dataFormat.fill.foreColor;e.writeStartElement("c","legend",this.chartNamespace),e.writeStartElement("c","legendPos",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,t),e.writeEndElement(),e.writeStartElement("c","overlay",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"0"),e.writeEndElement(),this.serializeDefaultShapeProperties(e),e.writeStartElement("c","txPr",this.chartNamespace),e.writeStartElement("a","bodyPr",this.aNamespace),e.writeEndElement(),e.writeStartElement("a","lstStyle",this.aNamespace),e.writeEndElement(),e.writeStartElement("a","p",this.aNamespace),this.serializeChartTitleFont(e,i.fontSize,r,i.fontName),e.writeEndElement(),e.writeEndElement(),e.writeEndElement()},e.prototype.serializeChartErrorBar=function(e,t){var i=t.errorBar,r=this.errorBarValueType(i.type),n=0;"Cap"!==i.endStyle&&(n=1),e.writeStartElement("c","errBars",this.chartNamespace),e.writeStartElement("c","errBarType",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,i.direction.toLowerCase()),e.writeEndElement(),e.writeStartElement("c","errValType",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,r),e.writeEndElement(),e.writeStartElement("c","noEndCap",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,n.toString()),e.writeEndElement(),e.writeStartElement("c","val",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,i.numberValue.toString()),e.writeEndElement(),this.serializeShapeProperties(e,"595959",!0),e.writeEndElement()},e.prototype.errorBarValueType=function(e){var t="";switch(e){case"StandardError":t="stdErr";break;case"StandardDeviation":t="stdDev";break;case"Percentage":t="percentage";break;case"Fixed":t="fixedVal";break;default:t="stdErr"}return t},e.prototype.serializeCategoryAxis=function(e,t,i){var r="catAx",n=this.chart.chartPrimaryCategoryAxis.numberFormat,o=this.chart.chartType,s="Scatter_Markers"===o||"Bubble"===o;"Time"===t&&(r="dateAx"),s&&(r="valAx"),e.writeStartElement("c",r,this.chartNamespace),e.writeStartElement("c","axId",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"335265000"),e.writeEndElement(),this.serializeAxis(e,"335263360",this.chart.chartPrimaryCategoryAxis,n,i),s||(e.writeStartElement("c","auto",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"1"),e.writeEndElement(),e.writeStartElement("c","lblAlgn",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"ctr"),e.writeEndElement(),e.writeStartElement("c","lblOffset",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"100"),e.writeEndElement()),"Time"===t?(e.writeStartElement("c","baseTimeUnit",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"days"),e.writeEndElement()):"Bubble"!==this.chart.chartType&&(e.writeStartElement("c","noMultiLvlLbl",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"0"),e.writeEndElement()),e.writeEndElement()},e.prototype.serializeValueAxis=function(e,t,i){var r=this.chart.chartPrimaryValueAxis,n="between";"Time"===t&&(n="midCat"),e.writeStartElement("c","valAx",this.chartNamespace),e.writeStartElement("c","axId",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"335263360"),e.writeEndElement(),this.serializeAxis(e,"335265000",r,"General",i),e.writeStartElement("c","crossBetween",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,n),e.writeEndElement(),0===r.majorUnit||i||(e.writeStartElement("c","majorUnit",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,r.majorUnit.toString()),e.writeEndElement()),e.writeEndElement()},e.prototype.serializeAxis=function(e,t,i,r,n){e.writeStartElement("c","scaling",this.chartNamespace),e.writeStartElement("c","orientation",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"minMax"),e.writeEndElement(),0===i.maximumValue||n||(e.writeStartElement("c","max",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,i.maximumValue.toString()),e.writeEndElement(),e.writeStartElement("c","min",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,i.minimumValue.toString()),e.writeEndElement()),e.writeEndElement(),e.writeStartElement("c","delete",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"0"),e.writeEndElement(),e.writeStartElement("c","axPos",this.chartNamespace),"335265000"===t?e.writeAttributeString(void 0,"val",void 0,"l"):e.writeAttributeString(void 0,"val",void 0,"b"),e.writeEndElement(),i.hasMajorGridLines&&(e.writeStartElement("c","majorGridlines",this.chartNamespace),this.serializeShapeProperties(e,"D9D9D9",!0),e.writeEndElement()),i.hasMinorGridLines&&(e.writeStartElement("c","minorGridlines",this.chartNamespace),this.serializeShapeProperties(e,"F2F2F2",!0),e.writeEndElement()),i.chartTitle&&(e.writeStartElement("c","title",this.chartNamespace),this.serializeTextProperties(e,i.chartTitleArea,i.chartTitle),e.writeEndElement()),e.writeStartElement("c","numFmt",this.chartNamespace),e.writeAttributeString(void 0,"formatCode",void 0,r),e.writeAttributeString(void 0,"sourceLinked",void 0,"1"),e.writeEndElement(),e.writeStartElement("c","majorTickMark",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"none"),e.writeEndElement(),e.writeStartElement("c","minorTickMark",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"none"),e.writeEndElement(),e.writeStartElement("c","tickLblPos",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"nextTo"),e.writeEndElement(),"Bubble"===this.chart.chartType?this.serializeShapeProperties(e,"BFBFBF",!0):this.serializeDefaultShapeProperties(e),e.writeStartElement("c","txPr",this.chartNamespace),e.writeStartElement("a","bodyPr",this.aNamespace),e.writeEndElement(),e.writeStartElement("a","p",this.aNamespace),this.serializeChartTitleFont(e,i.fontSize,"595959",i.fontName),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("c","crossAx",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,t),e.writeEndElement(),e.writeStartElement("c","crosses",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"autoZero"),e.writeEndElement()},e.prototype.parseChartTrendLines=function(e,t){for(var i=0;i<t.trendLines.length;i++){var r=t.trendLines[i],n=this.chartTrendLineType(r.type),o=0,s=0;r.isDisplayEquation?s=1:r.isDisplayRSquared&&(o=1);var a=t.dataPoints[i];e.writeStartElement("c","trendline",this.chartNamespace),e.writeStartElement("c","spPr",this.chartNamespace),e.writeStartElement("a","ln",this.aNamespace),e.writeAttributeString(void 0,"w",void 0,"19050"),this.serializeChartSolidFill(e,a.fill.foreColor,!1),e.writeStartElement("a","prstDash",this.aNamespace),e.writeAttributeString(void 0,"val",void 0,"sysDot"),e.writeEndElement(),e.writeStartElement("a","round",this.aNamespace),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("c","trendlineType",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,n),e.writeEndElement(),e.writeStartElement("c","forward",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,r.forward.toString()),e.writeEndElement(),e.writeStartElement("c","backward",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,r.backward.toString()),e.writeEndElement(),"NaN"!==r.intercept&&(e.writeStartElement("c","intercept",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,r.intercept.toString()),e.writeEndElement()),e.writeStartElement("c","dispRSqr",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,o.toString()),e.writeEndElement(),e.writeStartElement("c","dispEq",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,s.toString()),e.writeEndElement(),e.writeEndElement()}},e.prototype.chartTrendLineType=function(e){var t="";switch(e){case"Linear":t="linear";break;case"Exponential":t="exp"}return t},e.prototype.parseChartDataLabels=function(e,t){var i="",r=0,n=0,o=0,s=0,a=0,l=0,h=0;switch(t.position){case"Center":i="ctr";break;case"Left":i="l";break;case"Right":i="r";break;case"Outside":i="outEnd";break;case"BestFit":i="bestFit";break;case"Bottom":case"OutsideBase":i="inBase";break;case"Inside":i="inEnd";break;case"Above":i="t";break;case"Below":i="b";break;default:i="Automatic"}e.writeStartElement("c","dLbls",this.chartNamespace),this.serializeDefaultShapeProperties(e),e.writeStartElement("c","txPr",this.chartNamespace),e.writeStartElement("a","bodyPr",this.aNamespace),e.writeEndElement(),e.writeStartElement("a","lstStyle",this.aNamespace),e.writeEndElement(),e.writeStartElement("a","p",this.aNamespace),this.serializeChartTitleFont(e,t.fontSize,t.fontColor,t.fontName),e.writeEndElement(),e.writeEndElement(),t.isLegendKey?r=1:t.isBubbleSize?n=1:t.isCategoryName?o=1:t.isSeriesName?s=1:t.isValue?a=1:t.isPercentage?l=1:t.isLeaderLines&&(h=1),"Automatic"!==i&&(e.writeStartElement("c","dLblPos",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,i),e.writeEndElement()),e.writeStartElement("c","showLegendKey",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,r.toString()),e.writeEndElement(),e.writeStartElement("c","showVal",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,a.toString()),e.writeEndElement(),e.writeStartElement("c","showCatName",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,o.toString()),e.writeEndElement(),e.writeStartElement("c","showSerName",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,s.toString()),e.writeEndElement(),e.writeStartElement("c","showPercent",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,l.toString()),e.writeEndElement(),e.writeStartElement("c","showBubbleSize",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,n.toString()),e.writeEndElement(),e.writeStartElement("c","showLeaderLines",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,h.toString()),e.writeEndElement(),e.writeEndElement()},e.prototype.serializeShapeProperties=function(e,t,i){var r=this.chart.chartType,n="Scatter_Markers"===r||"Bubble"===r;e.writeStartElement("c","spPr",this.chartNamespace),!n||i?(e.writeStartElement("a","ln",this.aNamespace),e.writeAttributeString(void 0,"w",void 0,"9525"),this.serializeChartSolidFill(e,t,!1),e.writeStartElement("a","prstDash",this.aNamespace),e.writeAttributeString(void 0,"val",void 0,"solid"),e.writeEndElement(),e.writeStartElement("a","round",this.aNamespace),e.writeEndElement(),e.writeEndElement()):"Scatter_Markers"===r?(this.serializeChartSolidFill(e,t,!1),this.serializeDefaultLineProperties(e)):"Bubble"===r&&(this.serializeChartSolidFill(e,t,!0),this.serializeDefaultLineProperties(e)),e.writeStartElement("a","effectLst",this.aNamespace),e.writeEndElement(),e.writeEndElement()},e.prototype.serializeDefaultShapeProperties=function(e){e.writeStartElement("c","spPr",this.chartNamespace),e.writeStartElement("a","noFill",this.aNamespace),e.writeEndElement(),this.serializeDefaultLineProperties(e),e.writeStartElement("a","effectLst",this.aNamespace),e.writeEndElement(),e.writeEndElement()},e.prototype.serializeDefaultLineProperties=function(e){e.writeStartElement("a","ln",this.aNamespace),e.writeStartElement("a","noFill",this.aNamespace),e.writeEndElement(),e.writeStartElement("a","round",this.aNamespace),e.writeEndElement(),e.writeEndElement()},e.prototype.serializeTextProperties=function(e,t,i){var r=t.dataFormat.fill.foreColor,n=100*t.fontSize;e.writeStartElement("c","tx",this.chartNamespace),e.writeStartElement("c","rich",this.chartNamespace),e.writeStartElement("a","bodyPr",this.aNamespace),e.writeAttributeString(void 0,"rot",void 0,"0"),e.writeAttributeString(void 0,"vert",void 0,"horz"),e.writeEndElement(),e.writeStartElement("a","lstStyle",this.aNamespace),e.writeEndElement(),e.writeStartElement("a","p",this.aNamespace),this.serializeChartTitleFont(e,t.fontSize,r,t.fontName),e.writeStartElement("a","r",this.aNamespace),e.writeStartElement("a","rPr",this.aNamespace),e.writeAttributeString(void 0,"lang",void 0,"en-US"),e.writeAttributeString(void 0,"b",void 0,"0"),e.writeAttributeString(void 0,"sz",void 0,n.toString()),e.writeAttributeString(void 0,"baseline",void 0,"0"),this.serializeChartSolidFill(e,r,!1),this.serializeFont(e,t.fontName),e.writeEndElement(),e.writeStartElement("a","t",this.aNamespace),e.writeString(i),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("c","layout",this.chartNamespace),e.writeEndElement(),e.writeStartElement("c","overlay",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"0"),e.writeEndElement(),this.serializeDefaultShapeProperties(e),e.writeStartElement("c","txPr",this.chartNamespace),e.writeStartElement("a","bodyPr",this.aNamespace),e.writeEndElement(),e.writeStartElement("a","lstStyle",this.aNamespace),e.writeEndElement(),e.writeStartElement("a","p",this.aNamespace),e.writeEndElement(),this.serializeChartTitleFont(e,t.fontSize,r,t.fontName),e.writeEndElement()},e.prototype.serializeChartTitleFont=function(e,t,i,r){var n=100*t;e.writeStartElement("a","pPr",this.aNamespace),e.writeStartElement("a","defRPr",this.aNamespace),e.writeAttributeString(void 0,"lang",void 0,"en-US"),e.writeAttributeString(void 0,"b",void 0,"0"),e.writeAttributeString(void 0,"sz",void 0,n.toString()),e.writeAttributeString(void 0,"baseline",void 0,"0"),this.serializeChartSolidFill(e,i,!1),this.serializeFont(e,r),e.writeEndElement(),e.writeEndElement()},e.prototype.serializeChartSolidFill=function(e,t,i){e.writeStartElement("a","solidFill",this.aNamespace),e.writeStartElement("a","srgbClr",this.aNamespace),"000000"!==t?e.writeAttributeString(void 0,"val",void 0,t):e.writeAttributeString(void 0,"val",void 0,"595959"),"Bubble"===this.chart.chartType&&i&&(e.writeStartElement("a","alpha",this.aNamespace),e.writeAttributeString(void 0,"val",void 0,"75000"),e.writeEndElement()),e.writeEndElement(),e.writeEndElement()},e.prototype.serializeFont=function(e,t){e.writeStartElement("a","latin",this.aNamespace),e.writeAttributeString(void 0,"typeface",void 0,t),e.writeEndElement(),e.writeStartElement("a","ea",this.aNamespace),e.writeAttributeString(void 0,"typeface",void 0,t),e.writeEndElement(),e.writeStartElement("a","cs",this.aNamespace),e.writeAttributeString(void 0,"typeface",void 0,t),e.writeEndElement()},e.prototype.parseChartSeriesColor=function(e,t,i){for(var r=0;r<t.length;r++){var n=t[r];if(e.writeStartElement("c","spPr",this.chartNamespace),"lineChart"===i&&(e.writeStartElement("a","ln",this.aNamespace),e.writeAttributeString(void 0,"w",void 0,"28575"),e.writeAttributeString(void 0,"cap",void 0,"rnd")),"lineChart"!==i?this.serializeChartSolidFill(e,n.fill.foreColor,!0):this.serializeChartSolidFill(e,n.line.color,!0),"lineChart"!==i&&(e.writeStartElement("a","ln",this.aNamespace),e.writeStartElement("a","noFill",this.aNamespace),e.writeEndElement()),e.writeStartElement("a","round",this.aNamespace),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("a","effectLst",this.aNamespace),e.writeEndElement(),e.writeEndElement(),"lineChart"===i){var o="none",s=0;this.chart.chartSeries[r].hasOwnProperty("seriesFormat")&&(o=this.chart.chartSeries[r].seriesFormat.markerStyle,s=this.chart.chartSeries[r].seriesFormat.markerSize),e.writeStartElement("c","marker",this.chartNamespace),e.writeStartElement("c","symbol",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,o.toLowerCase()),e.writeEndElement(),this.chart.chartSeries[r].hasOwnProperty("seriesFormat")&&(e.writeStartElement("c","size",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,s.toString()),e.writeEndElement()),e.writeEndElement()}}},e.prototype.parseChartDataPoint=function(e,t){for(var i=t.dataPoints,r=[],n=0;n<i.length;n++)r.push(i[n]),e.writeStartElement("c","dPt",this.chartNamespace),e.writeStartElement("c","idx",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,n.toString()),e.writeEndElement(),e.writeStartElement("c","bubble3D",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"0"),e.writeEndElement(),this.parseChartSeriesColor(e,r,this.chart.chartType),e.writeEndElement(),r=[]},e.prototype.serializeChartCategory=function(e,t,i){var r=t.chartCategory,n=r.length;e.writeStartElement("c","f",this.chartNamespace),e.writeString("Sheet1!$A$2:$A$"+(n+1).toString()),e.writeEndElement(),e.writeStartElement("c",i,this.chartNamespace),"numCache"===i&&(e.writeStartElement("c","formatCode",this.chartNamespace),e.writeString("General"),e.writeEndElement()),e.writeStartElement("c","ptCount",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,n.toString()),e.writeEndElement();for(var o=0;o<r.length;o++){var s=r[o];e.writeStartElement("c","pt",this.chartNamespace),e.writeAttributeString(void 0,"idx",void 0,o.toString()),e.writeStartElement("c","v",this.chartNamespace),""!==s.categoryXName&&e.writeString(s.categoryXName),e.writeEndElement(),e.writeEndElement()}e.writeEndElement()},e.prototype.serializeChartValue=function(e,t,i){var r="val";("scatterChart"===i||"bubbleChart"===i)&&(r="yVal"),this.serializeChartYValue(e,r,t),"bubbleChart"===i&&(r="bubbleSize",t="Sheet1!$C$2:$C$",this.serializeChartYValue(e,r,t)),"lineChart"!==i&&"scatterChart"!==i||(e.writeStartElement("c","smooth",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"0"),e.writeEndElement())},e.prototype.serializeChartYValue=function(e,t,i){var r=this.chart.chartCategory,n=r.length;e.writeStartElement("c",t,this.chartNamespace),e.writeStartElement("c","numRef",this.chartNamespace),e.writeStartElement("c","f",this.chartNamespace),e.writeString(i+(n+1).toString()),e.writeEndElement(),e.writeStartElement("c","numCache",this.chartNamespace),e.writeStartElement("c","formatCode",this.chartNamespace),e.writeString("General"),e.writeEndElement(),e.writeStartElement("c","ptCount",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,n.toString()),e.writeEndElement();for(var o=0;o<n;o++)for(var s=r[o],a=0;a<s.chartData.length;a++)if(a===this.seriesCount){var l=s.chartData[this.seriesCount];e.writeStartElement("c","pt",this.chartNamespace),e.writeAttributeString(void 0,"idx",void 0,o.toString()),e.writeStartElement("c","v",this.chartNamespace),"bubbleSize"!==t?e.writeString(l.yValue.toString()):e.writeString(l.size.toString()),e.writeEndElement(),e.writeEndElement()}e.writeEndElement(),e.writeEndElement(),e.writeEndElement()},e.prototype.chartType=function(e){var t=e.chartType;switch(t){case"Pie":t="pieChart";break;case"Doughnut":t="doughnutChart";break;case"Scatter_Markers":t="scatterChart";break;case"Bubble":t="bubbleChart"}return"Area"!==t&&"Area_Stacked"!==t&&"Area_Stacked_100"!==t||(t="areaChart"),"Bar_Stacked_100"!==t&&"Bar_Stacked"!==t&&"Bar_Clustered"!==t&&"Column_Clustered"!==t&&"Column_Stacked"!==t&&"Column_Stacked_100"!==t||(t="barChart"),"Line"!==t&&"Line_Markers"!==t&&"Line_Markers_Stacked"!==t&&"Line_Stacked"!==t&&"Line_Markers_Stacked_100"!==t&&"Line_Stacked_100"!==t||(t="lineChart"),t},e.prototype.chartGrouping=function(e){var t="standard";return"Bar_Stacked"===e||"Column_Stacked"===e||"Area_Stacked"===e||"Line_Stacked"===e||"Line_Markers_Stacked"===e?t="stacked":"Bar_Stacked_100"===e||"Column_Stacked_100"===e||"Area_Stacked_100"===e||"Line_Stacked_100"===e||"Line_Markers_Stacked_100"===e?t="percentStacked":"Bar_Clustered"!==e&&"Column_Clustered"!==e||(t="clustered"),t},e.prototype.chartLegendPosition=function(e){var t=e.position;switch(t){case"Top":t="t";break;case"Bottom":t="b";break;case"Left":t="l";break;case"Right":t="r";break;case"Corner":t="tr";break;default:t="b"}return t},e.prototype.updatechartId=function(e){var t="";return""===t&&(t=this.addChartRelation(this.documentCharts,e)),t},e.prototype.addChartRelation=function(e,t){var i;return i=this.getNextRelationShipID(),e.add(i,t),i},e.prototype.startsWith=function(e,t){return t.length>0&&e.substring(0,t.length)===t},e.prototype.serializeShapeDrawingGraphics=function(e,t){var i=t.autoShapeType;t.shapeId;this.serializeShapeWrapStyle(e,t),e.writeStartElement("wp","docPr",this.wpNamespace),e.writeAttributeString(void 0,"id",void 0,(this.mDocPrID++).toString()),e.writeAttributeString(void 0,"name",void 0,t.name),e.writeAttributeString(void 0,"title",void 0,t.title),e.writeEndElement(),e.writeStartElement("a","graphic",this.aNamespace),e.writeStartElement("a","graphicData",this.aNamespace),e.writeAttributeString(void 0,"uri",void 0,this.wpShapeNamespace),e.writeStartElement("wps","wsp",this.wpShapeNamespace),e.writeStartElement("wps","cNvCnPr",this.wpShapeNamespace),e.writeStartElement("a","cxnSpLocks",this.aNamespace),e.writeAttributeString(void 0,"noChangeShapeType",void 0,"1"),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("wps","spPr",this.wpShapeNamespace),e.writeAttributeString(void 0,"bwMode",void 0,"auto"),e.writeStartElement("a","xfrm",this.aNamespace),e.writeStartElement("a","off",this.aNamespace),e.writeAttributeString(void 0,"x",void 0,"0"),e.writeAttributeString(void 0,"y",void 0,"0"),e.writeEndElement(),e.writeStartElement("a","ext",this.aNamespace);var r=Math.round(t.width*this.emusPerPoint);e.writeAttributeString(void 0,"cx",void 0,r.toString());var n=Math.round(t.height*this.emusPerPoint);e.writeAttributeString(void 0,"cy",void 0,n.toString()),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("a","prstGeom",this.aNamespace),"StraightConnector"===i?e.writeAttributeString(void 0,"prst",void 0,"straightConnector1"):"RoundedRectangle"===i?e.writeAttributeString(void 0,"prst",void 0,"roundRect"):e.writeAttributeString(void 0,"prst",void 0,"rect"),e.writeStartElement("a","avLst",this.aNamespace),e.writeEndElement(),e.writeEndElement(),t.fillFormat&&t.fillFormat.color&&t.fillFormat.fill?(e.writeStartElement("a","solidFill",this.aNamespace),e.writeStartElement("a","srgbClr",this.aNamespace),e.writeAttributeString(void 0,"val",void 0,this.getColor(t.fillFormat.color)),e.writeEndElement(),e.writeEndElement()):(e.writeStartElement("a","noFill",this.aNamespace),e.writeEndElement());var o=t.lineFormat.weight?t.lineFormat.weight*this.emusPerPoint:this.emusPerPoint;if(e.writeStartElement("a","ln",this.aNamespace),e.writeAttributeString(void 0,"w",void 0,o.toString()),!sf.base.isNullOrUndefined(t.lineFormat.lineFormatType)&&"None"!==t.lineFormat.lineFormatType&&t.lineFormat.line?(e.writeStartElement("a","solidFill",this.aNamespace),e.writeStartElement("a","srgbClr",this.aNamespace),e.writeAttributeString(void 0,"val",void 0,this.getColor(t.lineFormat.color)),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("a","round",this.aNamespace),e.writeEndElement(),e.writeStartElement("a","headEnd",this.aNamespace),e.writeEndElement(),e.writeStartElement("a","tailEnd",this.aNamespace),e.writeEndElement()):(e.writeStartElement("a","noFill",this.aNamespace),e.writeEndElement()),e.writeEndElement(),e.writeEndElement(),"Rectangle"!==i&&"RoundedRectangle"!==i||(e.writeStartElement("wps","txbx",this.wpShapeNamespace),e.writeStartElement(void 0,"txbxContent",this.wNamespace),this.serializeBodyItems(e,t.textFrame.blocks,!0),e.writeEndElement(),e.writeEndElement()),e.writeStartElement("wps","bodyPr",this.wpShapeNamespace),!sf.base.isNullOrUndefined(t.textFrame)){var s=void 0;t.textFrame.leftMargin>=0&&(s=Math.round(t.textFrame.leftMargin*this.emusPerPoint).toString(),e.writeAttributeString(void 0,"lIns",void 0,s)),t.textFrame.topMargin>=0&&(s=Math.round(t.textFrame.topMargin*this.emusPerPoint).toString(),e.writeAttributeString(void 0,"tIns",void 0,s)),t.textFrame.rightMargin>=0&&(s=Math.round(t.textFrame.rightMargin*this.emusPerPoint).toString(),e.writeAttributeString(void 0,"rIns",void 0,s)),t.textFrame.bottomMargin>=0&&(s=Math.round(t.textFrame.bottomMargin*this.emusPerPoint).toString(),e.writeAttributeString(void 0,"bIns",void 0,s)),e.writeAttributeString(void 0,"anchor",void 0,"t"),e.writeAttributeString(void 0,"anchorCtr",void 0,"0")}e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeEndElement()},e.prototype.serializeShapeWrapStyle=function(e,t){if("Inline"!==t.textWrappingStyle){var i="wrapNone";if(t.textWrappingStyle&&"InFrontOfText"!==t.textWrappingStyle&&"Behind"!==t.textWrappingStyle&&(i="wrap"+t.textWrappingStyle,"Tight"===t.textWrappingStyle&&(i="wrapSquare")),e.writeStartElement("wp",i,this.wpNamespace),t.textWrappingStyle&&"InFrontOfText"!==t.textWrappingStyle&&"Behind"!==t.textWrappingStyle&&t.textWrappingType){var r="Both"===t.textWrappingType?"bothSides":t.textWrappingType.toLowerCase();e.writeAttributeString(void 0,"wrapText",void 0,r)}e.writeEndElement()}},e.prototype.serializeDrawingGraphics=function(e,t){var i,r;if(t.isMetaFile&&!sf.base.isNullOrUndefined(t.metaFileImageString)&&".svg"!==(r=x.formatClippedString(t.metaFileImageString).extension)&&(t.imageString=t.metaFileImageString),this.document&&!sf.base.isNullOrUndefined(this.document.images)&&Object.keys(this.document.images).length>0&&this.document.images[t.imageString]&&(t.imageString=this.document.images[t.imageString]),i=this.updateShapeId(t,!1),e.writeStartElement("wp","docPr",this.wpNamespace),e.writeAttributeString(void 0,"id",void 0,(this.mDocPrID++).toString()),sf.base.isNullOrUndefined(t.alternativeText)||e.writeAttributeString(void 0,"descr",void 0,t.alternativeText),e.writeAttributeString(void 0,"name",void 0,sf.base.isNullOrUndefined(t.name)?"":t.name),sf.base.isNullOrUndefined(t.title)||e.writeAttributeString(void 0,"title",void 0,t.title),e.writeEndElement(),e.writeStartElement("a","graphic",this.aNamespace),e.writeStartElement("a","graphicData",this.aNamespace),e.writeAttributeString(void 0,"uri",void 0,this.pictureNamespace),e.writeStartElement("pic","pic",this.pictureNamespace),e.writeStartElement("pic","nvPicPr",this.pictureNamespace),e.writeStartElement("pic","cNvPr",this.pictureNamespace),e.writeAttributeString(void 0,"id",void 0,"0"),e.writeAttributeString(void 0,"name",void 0,""),e.writeAttributeString(void 0,"descr",void 0,""),e.writeEndElement(),e.writeStartElement("pic","cNvPicPr",this.pictureNamespace),e.writeStartElement("a","picLocks",this.aNamespace),e.writeAttributeString(void 0,"noChangeAspect",void 0,"1"),e.writeAttributeString(void 0,"noChangeArrowheads",void 0,"1"),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("pic","blipFill",this.pictureNamespace),e.writeStartElement("a","blip",this.aNamespace),this.startsWith(t.imageString,"data:image")?e.writeAttributeString("r","embed",this.rNamespace,i):this.documentImages.containsKey(i)&&(this.documentImages.remove(i),this.externalImages.add(i,t.imageString),e.writeAttributeString(void 0,"link",this.rNamespace,i)),".svg"===r&&this.serializeBlipExtensions(e,t),e.writeEndElement(),t.iscrop){e.writeStartElement("a","srcRect",this.aNamespace);var n=Math.round(1e3*t.left);e.writeAttributeString(void 0,"l",void 0,n.toString());var o=Math.round(1e3*t.top);e.writeAttributeString(void 0,"t",void 0,o.toString());var s=Math.round(1e3*t.right);e.writeAttributeString(void 0,"r",void 0,s.toString());var a=Math.round(1e3*t.bottom);e.writeAttributeString(void 0,"b",void 0,a.toString()),e.writeEndElement()}e.writeStartElement("a","stretch",this.aNamespace),e.writeStartElement("a","fillRect",this.aNamespace),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("pic","spPr",this.pictureNamespace),e.writeAttributeString(void 0,"bwMode",void 0,"auto"),e.writeStartElement("a","xfrm",this.aNamespace),e.writeStartElement("a","off",this.aNamespace),e.writeAttributeString(void 0,"x",void 0,"0"),e.writeAttributeString(void 0,"y",void 0,"0"),e.writeEndElement(),e.writeStartElement("a","ext",this.aNamespace);var l=Math.round(t.width*this.emusPerPoint);e.writeAttributeString(void 0,"cx",void 0,l.toString());var h=Math.round(t.height*this.emusPerPoint);e.writeAttributeString(void 0,"cy",void 0,h.toString()),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("a","prstGeom",this.aNamespace),e.writeAttributeString(void 0,"prst",void 0,"rect"),e.writeStartElement("a","avLst",this.aNamespace),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeEndElement()},e.prototype.serializeBlipExtensions=function(e,t){e.writeStartElement("a","extLst",this.aNamespace),e.writeStartElement("a","ext",this.aNamespace),e.writeAttributeString(void 0,"uri",void 0,"{96DAC541-7B7A-43D3-8B79-37D633B846F1}"),e.writeStartElement("asvg","svgBlip",this.svgNamespace);var i=this.updateShapeId(t,!0);e.writeAttributeString("r","embed",void 0,i),e.writeEndElement(),e.writeEndElement(),e.writeEndElement()},e.prototype.updateShapeId=function(e,t){var i="",r=this.paragraph;return this.headerFooter?i=this.updateHFImageRels(this.headerFooter,e,t):""===i&&(r.hasOwnProperty("sectionFormat")||r.hasOwnProperty("inlines"))&&(i=this.addImageRelation(t?this.svgImages:this.documentImages,e)),i},e.prototype.addImageRelation=function(e,t){var i;return i=this.getNextRelationShipID(),e.add(i,t),i},e.prototype.updateHFImageRels=function(e,t,i){for(var r="",n="",o=this.headersFooters.keys,s=0;s<o.length;s++)for(var l=this.headersFooters.get(o[s]),h=l.keys,d=0;d<h.length;d++)if(l.get(h[d])===e){n=h[d];var c=void 0;i?this.headerFooterSvgImages.containsKey(n)?(c=this.headerFooterSvgImages.get(n),r=this.addImageRelation(c,t)):(c=new a,r=this.addImageRelation(c,t),this.headerFooterSvgImages.add(n,c)):this.headerFooterImages.containsKey(n)?(c=this.headerFooterImages.get(n),r=this.addImageRelation(c,t)):(c=new a,r=this.addImageRelation(c,t),this.headerFooterImages.add(n,c))}return r},e.prototype.serializeTable=function(e,t){if(!(t.rows.length<=0)){var i=this.table;this.table=t,e.writeStartElement(void 0,"tbl",this.wNamespace);var r=t.rows[0].rowFormat;this.serializeTableFormat(e,r,t),this.serializeTableGrid(e,t);var n=new a,o=new a,s=new a,l=t.rows;if(l.length>0)for(var h=0;h<l.length;h++){var d=l[h];if(d.cells.length>0){if(d.hasOwnProperty("contentControlProperties")){this.serializeContentControl(e,d.contentControlProperties,d);continue}var c=this.row;this.row=d,e.writeStartElement(void 0,"tr",this.wNamespace),this.serializeRowFormat(e,d);for(var p=d.cells,u=p.length,g=0,f=0;f<u;f++){var m=p[f],y=m.columnIndex;if(m.hasOwnProperty("contentControlProperties"))this.serializeContentControl(e,m.contentControlProperties,m);else{var v=m.cellFormat;if(y-g>0)for(var b=0===f?0:g+1;b<y;b++)if(n.containsKey(b)){var w=this.getMergeCellFormat(v,s.get(b),b<m.columnIndex);this.serializeTableCell(e,m,w,!1),n.set(b,n.get(b)-1),1===n.get(b)&&(n.remove(b),s.remove(b),o.containsKey(b)&&o.remove(b)),o.containsKey(b)&&(g+=o.get(b)-1,(b+=o.get(b))>0&&b--)}g=y,v.rowSpan>1&&(n.add(y,v.rowSpan),s.add(y,v)),this.serializeTableCell(e,m,v,!0),v.columnSpan>1&&v.rowSpan>1&&o.add(y,v.columnSpan);for(var x=y+1;;x++)if(n.containsKey(x)){var M=this.getMergeCellFormat(v,s.get(x),x<m.columnIndex);this.serializeTableCell(e,m,M,!1),n.set(x,n.get(x)-1),g++,1===n.get(x)&&(n.remove(x),s.remove(x),o.containsKey(x)&&o.remove(x)),o.containsKey(x)&&(g+=o.get(x)-1,x+=o.get(x))}else if(!(f===u-1&&x<t.columnCount))break}}e.writeEndElement(),this.row=c}}e.writeEndElement(),this.table=i}},e.prototype.getMergeCellFormat=function(e,t,i){var r=t;return i?r.borders.right=e.borders.left:r.borders.left=e.borders.right,r},e.prototype.serializeTableCell=function(e,t,i,r){var n=this.blockOwner;if(this.blockOwner=t,e.writeStartElement(void 0,"tc",this.wNamespace),e.writeStartElement(void 0,"tcPr",this.wNamespace),this.serializeCellWidth(e,i),this.serializeCellMargins(e,i),e.writeStartElement(void 0,"tcBorders",this.wNamespace),this.serializeBorders(e,i.borders,8,!1),e.writeEndElement(),this.serializeShading(e,t.cellFormat.shading),this.serializeTableCellDirection(e,i),this.serializeCellVerticalAlign(e,i.verticalAlignment),i.columnSpan>1){var o=i.columnSpan;e.writeStartElement(void 0,"gridSpan",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,o.toString()),e.writeEndElement()}if(i.rowSpan>1&&(e.writeStartElement(void 0,"vMerge",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,r?"restart":"continue"),e.writeEndElement()),e.writeEndElement(),t&&t.blocks.length>0)for(var s=0,a=void 0;s<t.blocks.length;)a=t.blocks[s],this.serializeBodyItem(e,a,!1),s+=1;else e.writeStartElement(void 0,"p",this.wNamespace),e.writeStartElement(void 0,"pPr",this.wNamespace),e.writeStartElement(void 0,"pStyle",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,"Normal"),e.writeEndElement(),e.writeEndElement(),e.writeEndElement();e.writeEndElement(),this.blockOwner=n},e.prototype.serializeTableGrid=function(e,t){e.writeStartElement(void 0,"tblGrid",this.wNamespace),0!==t.grid.length&&this.serializeGridColumns(e,t.grid),e.writeEndElement()},e.prototype.serializeTableRows=function(e,t){var i=new a;if(t.length>0)for(var r=0;r<t.length;r++){var n=t[r];if(n.cells.length>0){if(n.hasOwnProperty("contentControlProperties")){this.serializeContentControl(e,n.contentControlProperties,n);continue}this.serializeRow(e,n,i)}}},e.prototype.serializeRow=function(e,t,i){var r=this.row;this.row=t,e.writeStartElement(void 0,"tr",this.wNamespace),this.serializeRowFormat(e,t),this.serializeCells(e,t.cells,i),e.writeEndElement(),this.row=r},e.prototype.serializeRowFormat=function(e,t){if(this.serializeRowMargins(e,t.rowFormat),e.writeStartElement(void 0,"trPr",this.wNamespace),t.rowFormat.height>0){e.writeStartElement(void 0,"trHeight",this.wNamespace),"Exactly"===t.rowFormat.heightType?e.writeAttributeString("w","hRule",this.wNamespace,"exact"):"AtLeast"===t.rowFormat.heightType&&e.writeAttributeString("w","hRule",this.wNamespace,"atLeast");var i=this.roundToTwoDecimal(t.rowFormat.height*this.twentiethOfPoint).toString();e.writeAttributeString("w","val",this.wNamespace,i),e.writeEndElement()}var r=t.rowFormat,n=r.gridBefore;n>0&&(e.writeStartElement(void 0,"gridBefore",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,n.toString()),e.writeEndElement());var o=r.gridAfter;if(o>0&&(e.writeStartElement(void 0,"gridAfter",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,o.toString()),e.writeEndElement()),n>0){switch(e.writeStartElement(void 0,"wBefore",this.wNamespace),r.gridBeforeWidthType){case"Percent":var s=this.roundToTwoDecimal(r.gridBeforeWidth*this.percentageFactor).toString();e.writeAttributeString("w","w",this.wNamespace,s),e.writeAttributeString("w","type",this.wNamespace,"pct");break;case"Point":var a=this.roundToTwoDecimal(r.gridBeforeWidth*this.twipsInOnePoint).toString();e.writeAttributeString("w","w",this.wNamespace,a),e.writeAttributeString("w","type",this.wNamespace,"dxa")}e.writeEndElement()}if(o>0){switch(e.writeStartElement(void 0,"wAfter",this.wNamespace),r.gridAfterWidthType){case"Percent":s=this.roundToTwoDecimal(r.gridAfterWidth*this.percentageFactor).toString();e.writeAttributeString("w","val",this.wNamespace,s),e.writeAttributeString("w","type",this.wNamespace,"pct");break;case"Point":a=this.roundToTwoDecimal(r.gridAfterWidth*this.twipsInOnePoint).toString();e.writeAttributeString("w","val",this.wNamespace,a),e.writeAttributeString("w","type",this.wNamespace,"dxa")}e.writeEndElement()}r.allowBreakAcrossPages||(e.writeStartElement(void 0,"cantSplit",this.wNamespace),e.writeEndElement()),r.isHeader&&(e.writeStartElement(void 0,"tblHeader",this.wNamespace),e.writeEndElement()),!sf.base.isNullOrUndefined(r.revisionIds)&&r.revisionIds.length>0&&(this.serializeRevisionStart(e,r,void 0),this.serializeRevisionEnd(e,r,void 0)),e.writeEndElement()},e.prototype.serializeCells=function(e,t,i){for(var r=0;r<t.length;r++)t[r].hasOwnProperty("contentControlProperties")?this.serializeContentControl(e,t[r].contentControlProperties,t[r]):this.serializeCell(e,t[r],i)},e.prototype.serializeCell=function(e,t,i){var r=this.blockOwner;if(this.blockOwner=t,e.writeStartElement(void 0,"tc",this.wNamespace),i=this.serializeCellFormat(e,t.cellFormat,!0,!0,i),t.blocks.length>0)for(var n=0,o=void 0;n<t.blocks.length;)o=t.blocks[n],this.serializeBodyItem(e,o,!1),n+=1;else e.writeStartElement(void 0,"p",this.wNamespace),e.writeStartElement(void 0,"pPr",this.wNamespace),e.writeStartElement(void 0,"pStyle",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,"Normal"),e.writeEndElement(),e.writeEndElement(),e.writeEndElement();e.writeEndElement();var s=1;if(i.containsKey(t.columnIndex+t.cellFormat.columnSpan-1+s)&&1===this.row.cells.length)for(var a=i.keys[i.keys.length-1];s<=a;)s=this.createCellForMerge(e,t,i,s),s++;else this.createCellForMerge(e,t,i,s);this.blockOwner=r},e.prototype.createCellForMerge=function(e,t,i,r){for(;i.containsKey(t.columnIndex+t.cellFormat.columnSpan-1+r)&&(this.row.cells.indexOf(t)===this.row.cells.length-1||this.row.cells.indexOf(t)===t.columnIndex)&&void 0===t.nextNode;){var n=t.columnIndex+t.cellFormat.columnSpan-1+r;e.writeStartElement(void 0,"tc",this.wNamespace);var o=!0;sf.base.isNullOrUndefined(this.spanCellFormat)?(e.writeStartElement(void 0,"tcPr",this.wNamespace),o=!1):(o=!1,i=this.serializeCellFormat(e,this.spanCellFormat,!1,o,i)),this.serializeColumnSpan(n,e),e.writeStartElement(void 0,"vMerge",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,"continue"),e.writeEndElement(),sf.base.isNullOrUndefined(this.spanCellFormat)&&(e.writeStartElement(void 0,"tcBorders",this.wNamespace),this.serializeBorders(e,t.cellFormat.borders,8,!1),e.writeEndElement()),o||e.writeEndElement(),i=this.checkMergeCell(n,i),e.writeStartElement("w","p",this.wNamespace),e.writeEndElement(),e.writeEndElement(),r++}return r},e.prototype.serializeCellFormat=function(e,t,i,r,n){var o=this.blockOwner;this.table.tableFormat,this.row.rowFormat;return e.writeStartElement(void 0,"tcPr",this.wNamespace),this.serializeCellWidth(e,t),this.serializeCellMargins(e,t),i&&(n=this.serializeCellMerge(e,t,n),this.serializeGridSpan(e,o)),e.writeStartElement(void 0,"tcBorders",this.wNamespace),this.serializeBorders(e,t.borders,8,!1),e.writeEndElement(),this.serializeShading(e,o.cellFormat.shading),this.serializeTableCellDirection(e,t),this.serializeCellVerticalAlign(e,t.verticalAlignment),r&&e.writeEndElement(),n},e.prototype.serializeCellWidth=function(e,t){e.writeStartElement(void 0,"tcW",this.wNamespace),"Percent"===t.preferredWidthType?(e.writeAttributeString(void 0,"type",this.wNamespace,"pct"),e.writeAttributeString(void 0,"w",this.wNamespace,this.roundToTwoDecimal(t.preferredWidth*this.percentageFactor).toString())):"Auto"===t.preferredWidthType?(e.writeAttributeString(void 0,"type",this.wNamespace,"auto"),e.writeAttributeString(void 0,"w",this.wNamespace,"0")):(e.writeAttributeString(void 0,"w",this.wNamespace,this.roundToTwoDecimal(t.preferredWidth*this.twipsInOnePoint).toString()),e.writeAttributeString(void 0,"type",this.wNamespace,"dxa")),e.writeEndElement()},e.prototype.serializeCellMerge=function(e,t,i){var r,n=this.blockOwner,o=!1,s=n.columnIndex,a=this.row.cells.indexOf(n),l=a>0?this.row.cells[a-1].columnIndex:n.columnIndex;if(n.columnIndex===a?(r=n.columnIndex,o=!0):o=!1,!o){0===a&&(s=n.columnIndex,l=-1);for(var h=l;h<s;h++)r=l+1,l+=1,0===r&&i.containsKey(r)&&(i=this.createMerge(e,r,n,i))}return t.rowSpan>1?(e.writeStartElement(void 0,"vMerge",this.wNamespace),this.spanCellFormat=t,i.add(r,t.rowSpan-1),t.columnSpan>1&&this.mGridSpans.add(r,t.columnSpan),e.writeAttributeString("w","val",this.wNamespace,"restart"),e.writeEndElement()):i.containsKey(r)&&o&&(i=this.createMerge(e,r,n,i)),i},e.prototype.createMerge=function(e,t,i,r){return this.serializeColumnSpan(t,e),e.writeStartElement(void 0,"vMerge",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,"continue"),e.writeEndElement(),e.writeStartElement(void 0,"tcBorders",this.wNamespace),this.serializeBorders(e,i.cellFormat.borders,8,!1),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("w","p",this.wNamespace),e.writeEndElement(),e.writeEndElement(),e.writeStartElement(void 0,"tc",this.wNamespace),e.writeStartElement(void 0,"tcPr",this.wNamespace),this.serializeCellWidth(e,i.cellFormat),r=this.checkMergeCell(t,r)},e.prototype.serializeColumnSpan=function(e,t){this.mGridSpans.keys.length>0&&this.mGridSpans.containsKey(e)&&(t.writeStartElement(void 0,"gridSpan",this.wNamespace),t.writeAttributeString("w","val",this.wNamespace,this.mGridSpans.get(e).toString()),t.writeEndElement())},e.prototype.checkMergeCell=function(e,t){return t.get(e)-1==0?(t.remove(e),this.spanCellFormat=void 0,this.mGridSpans.keys.length>0&&this.mGridSpans.containsKey(e)&&this.mGridSpans.remove(e)):t.set(e,t.get(e)-1),t},e.prototype.serializeGridSpan=function(e,t){if(t.cellFormat.columnSpan>1){var i=t.cellFormat.columnSpan;e.writeStartElement(void 0,"gridSpan",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,i.toString()),e.writeEndElement()}},e.prototype.serializeTableCellDirection=function(e,t){},e.prototype.serializeCellVerticalAlign=function(e,t){switch(e.writeStartElement(void 0,"vAlign",this.wNamespace),t){case"Center":e.writeAttributeString("w","val",this.wNamespace,"center");break;case"Bottom":e.writeAttributeString("w","val",this.wNamespace,"bottom");break;default:e.writeAttributeString("w","val",this.wNamespace,"top")}e.writeEndElement()},e.prototype.serializeGridColumns=function(e,t){for(var i=0,r=t.length;i<r;i++){var n=Math.round(20*t[i]);e.writeStartElement(void 0,"gridCol",this.wNamespace),e.writeAttributeString(void 0,"w",this.wNamespace,n.toString()),e.writeEndElement()}},e.prototype.serializeTableFormat=function(e,t,i){e.writeStartElement(void 0,"tblPr",this.wNamespace),this.serializeTablePositioning(e,i),this.serializeTableWidth(e,i),this.serializeTableAlignment(e,i.tableFormat),this.serializeCellSpacing(e,i.tableFormat),this.serializeTableIndentation(e,i.tableFormat),this.serializeTableMargins(e,i.tableFormat),this.serializeTableBorders(e,i.tableFormat),this.serializeShading(e,i.tableFormat.shading),i.tableFormat.bidi&&(e.writeStartElement(void 0,"bidiVisual",this.wNamespace),e.writeEndElement()),this.serializeTblLayout(e,i.tableFormat),sf.base.isNullOrUndefined(i)||e.writeEndElement()},e.prototype.serializeTablePositioning=function(e,t){if(t.wrapTextAround){if(e.writeStartElement("w","tblpPr",this.wNamespace),t.positioning.distanceLeft>0){var i=Math.round(t.positioning.distanceLeft*this.twipsInOnePoint).toString();e.writeAttributeString("w","leftFromText",this.wNamespace,i)}if(t.positioning.distanceRight>0){var r=Math.round(t.positioning.distanceRight*this.twipsInOnePoint).toString();e.writeAttributeString("w","rightFromText",this.wNamespace,r)}if(t.positioning.distanceTop>0){var n=Math.round(t.positioning.distanceTop*this.twipsInOnePoint).toString();e.writeAttributeString("w","topFromText",this.wNamespace,n)}if(t.positioning.distanceBottom>0){var o=Math.round(t.positioning.distanceBottom*this.twipsInOnePoint).toString();e.writeAttributeString("w","bottomFromText",this.wNamespace,o)}if(t.positioning.verticalOrigin){var s="Paragraph"===t.positioning.verticalOrigin?"text":t.positioning.verticalOrigin.toLowerCase();e.writeAttributeString("w","vertAnchor",this.wNamespace,s)}if(t.positioning.horizontalOrigin&&"Column"!==t.positioning.horizontalOrigin&&e.writeAttributeString("w","horzAnchor",this.wNamespace,t.positioning.horizontalOrigin.toLowerCase()),t.positioning.horizontalAlignment&&"Left"!==t.positioning.horizontalAlignment){var a=t.positioning.horizontalAlignment.toLowerCase();e.writeAttributeString("w","tblpXSpec",this.wNamespace,a)}if(t.positioning.verticalAlignment&&"None"!==t.positioning.verticalAlignment){var l=t.positioning.verticalAlignment.toLowerCase();e.writeAttributeString("w","tblpYSpec",this.wNamespace,l)}if((!sf.base.isNullOrUndefined(t.positioning.horizontalAlignment)&&"Left"===t.positioning.horizontalAlignment||!t.positioning.horizontalAlignment)&&t.positioning.horizontalPosition>0){var h=Math.round(t.positioning.horizontalPosition*this.twipsInOnePoint).toString();e.writeAttributeString("w","tblpX",this.wNamespace,h)}if(!sf.base.isNullOrUndefined(t.positioning.verticalAlignment)&&"None"===t.positioning.verticalAlignment){var d=Math.round(t.positioning.verticalPosition*this.twipsInOnePoint).toString();e.writeAttributeString("w","tblpY",this.wNamespace,d)}e.writeEndElement(),t.positioning.allowOverlap||(e.writeStartElement("w","tblOverlap",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,"never"),e.writeEndElement())}},e.prototype.serializeTableMargins=function(e,t){this.serializeMargins(e,t,"tblCellMar")},e.prototype.serializeRowMargins=function(e,t){e.writeStartElement(void 0,"tblPrEx",this.wNamespace),this.serializeMargins(e,t,"tblCellMar"),e.writeEndElement()},e.prototype.serializeCellMargins=function(e,t){this.serializeMargins(e,t,"tcMar")},e.prototype.serializeMargins=function(e,t,i){if(e.writeStartElement(void 0,i,this.wNamespace),!sf.base.isNullOrUndefined(t.topMargin)){var r=Math.round(20*t.topMargin);e.writeStartElement(void 0,"top",this.wNamespace),e.writeAttributeString(void 0,"w",this.wNamespace,r.toString()),e.writeAttributeString(void 0,"type",this.wNamespace,"dxa"),e.writeEndElement()}if(!sf.base.isNullOrUndefined(t.leftMargin)){var n=Math.round(20*t.leftMargin);e.writeStartElement(void 0,"left",this.wNamespace),e.writeAttributeString(void 0,"w",this.wNamespace,n.toString()),e.writeAttributeString(void 0,"type",this.wNamespace,"dxa"),e.writeEndElement()}if(!sf.base.isNullOrUndefined(t.bottomMargin)){var o=Math.round(20*t.bottomMargin);e.writeStartElement(void 0,"bottom",this.wNamespace),e.writeAttributeString(void 0,"w",this.wNamespace,o.toString()),e.writeAttributeString(void 0,"type",this.wNamespace,"dxa"),e.writeEndElement()}if(!sf.base.isNullOrUndefined(t.rightMargin)){var s=Math.round(20*t.rightMargin);e.writeStartElement(void 0,"right",this.wNamespace),e.writeAttributeString(void 0,"w",this.wNamespace,s.toString()),e.writeAttributeString(void 0,"type",this.wNamespace,"dxa"),e.writeEndElement()}e.writeEndElement()},e.prototype.serializeShading=function(e,t){e.writeStartElement(void 0,"shd",this.wNamespace),t.backgroundColor&&"empty"!==t.backgroundColor?e.writeAttributeString(void 0,"fill",this.wNamespace,this.getColor(t.backgroundColor)):e.writeAttributeString(void 0,"fill",this.wNamespace,"auto"),"empty"===t.foregroundColor||sf.base.isNullOrUndefined(t.foregroundColor)?e.writeAttributeString(void 0,"color",this.wNamespace,"auto"):e.writeAttributeString(void 0,"color",this.wNamespace,this.getColor(t.foregroundColor)),sf.base.isNullOrUndefined(t.textureStyle)||e.writeAttributeString("w","val",this.wNamespace,this.getTextureStyle(t.textureStyle)),e.writeEndElement()},e.prototype.getTextureStyle=function(e){switch(e){case"Texture5Percent":case"Texture2Pt5Percent":case"Texture7Pt5Percent":return"pct5";case"Texture10Percent":return"pct10";case"Texture12Pt5Percent":return"pct12";case"Texture15Percent":case"Texture17Pt5Percent":return"pct15";case"Texture20Percent":case"Texture22Pt5Percent":return"pct20";case"Texture25Percent":case"Texture27Pt5Percent":return"pct25";case"Texture30Percent":case"Texture32Pt5Percent":return"pct30";case"Texture35Percent":return"pct35";case"Texture37Pt5Percent":return"pct37";case"Texture40Percent":case"Texture42Pt5Percent":return"pct40";case"Texture45Percent":case"Texture47Pt5Percent":return"pct45";case"Texture50Percent":case"Texture52Pt5Percent":return"pct50";case"Texture55Percent":case"Texture57Pt5Percent":return"pct55";case"Texture60Percent":return"pct60";case"Texture62Pt5Percent":return"pct62";case"Texture65Percent":case"Texture67Pt5Percent":return"pct65";case"Texture70Percent":case"Texture72Pt5Percent":return"pct70";case"Texture75Percent":case"Texture77Pt5Percent":return"pct75";case"Texture80Percent":case"Texture82Pt5Percent":return"pct80";case"Texture85Percent":return"pct85";case"Texture87Pt5Percent":return"pct87";case"Texture90Percent":case"Texture92Pt5Percent":return"pct90";case"Texture95Percent":case"Texture97Pt5Percent":return"pct95";case"TextureCross":return"thinHorzCross";case"TextureDarkCross":return"horzCross";case"TextureDarkDiagonalCross":return"diagCross";case"TextureDarkDiagonalDown":return"reverseDiagStripe";case"TextureDarkDiagonalUp":return"diagStripe";case"TextureDarkHorizontal":return"horzStripe";case"TextureDarkVertical":return"vertStripe";case"TextureDiagonalCross":return"thinDiagCross";case"TextureDiagonalDown":return"thinReverseDiagStripe";case"TextureDiagonalUp":return"thinDiagStripe";case"TextureHorizontal":return"thinHorzStripe";case"TextureSolid":return"solid";case"TextureVertical":return"thinVertStripe";default:return"clear"}},e.prototype.serializeParagraphBorders=function(e,t){t.borders;e.writeStartElement(void 0,"pBdr",this.wNamespace),this.serializeBorders(e,t.borders,8,!0),e.writeEndElement()},e.prototype.serializeTableBorders=function(e,t){t.borders;e.writeStartElement(void 0,"tblBorders",this.wNamespace),this.serializeBorders(e,t.borders,8,!1),e.writeEndElement()},e.prototype.serializeBorders=function(e,t,i,r){this.serializeBorder(e,t.top,"top",i),this.serializeBorder(e,t.left,"left",i),this.serializeBorder(e,t.bottom,"bottom",i),this.serializeBorder(e,t.right,"right",i),r?(this.serializeBorder(e,t.horizontal,"between",i),this.serializeBorder(e,t.vertical,"bar",i)):(this.serializeBorder(e,t.horizontal,"insideH",i),this.serializeBorder(e,t.vertical,"insideV",i),this.serializeBorder(e,t.diagonalDown,"tl2br",i),this.serializeBorder(e,t.diagonalUp,"tr2bl",i))},e.prototype.serializePageNumberType=function(e,t){void 0!==t.pageNumberStyle&&(e.writeStartElement(void 0,"pgNumType",this.wNamespace),e.writeAttributeString(void 0,"fmt",this.wNamespace,this.getPageNumberFormat(t.pageNumberStyle)),e.writeEndElement())},e.prototype.serializeTblLayout=function(e,t){t.allowAutoFit||(e.writeStartElement(void 0,"tblLayout",this.wNamespace),e.writeAttributeString(void 0,"type",this.wNamespace,"fixed"),e.writeEndElement())},e.prototype.serializeBorder=function(e,t,i,r){var n=t.lineStyle,o=(t.lineWidth?t.lineWidth:0)*r,s=t.space?t.space:0;if("Cleared"===n)return e.writeStartElement(void 0,i,this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,"nil"),void e.writeEndElement();("None"===n||sf.base.isNullOrUndefined(n))&&!t.hasNoneStyle||o<=0||(e.writeStartElement(void 0,i,this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,this.getBorderStyle(n)),t.color&&e.writeAttributeString(void 0,"color",this.wNamespace,this.getColor(t.color)),e.writeAttributeString(void 0,"sz",this.wNamespace,this.roundToTwoDecimal(o).toString()),e.writeAttributeString(void 0,"space",this.wNamespace,s.toString()),t.shadow&&e.writeAttributeString(void 0,"shadow",this.wNamespace,"on"),e.writeEndElement())},e.prototype.getBorderStyle=function(e){switch(e){case"Cleared":return"cleared";case"None":return"None";case"DashSmallGap":return"dashSmallGap";case"Triple":return"triple";case"Dot":return"dotted";case"DashDot":return"dotDash";case"DashLargeGap":return"dashed";case"DashDotDot":return"dotDotDash";case"Double":return"double";case"ThinThickSmallGap":return"thinThickSmallGap";case"ThickThinSmallGap":return"thickThinSmallGap";case"ThinThickThinSmallGap":return"thinThickThinSmallGap";case"ThickThinMediumGap":return"thickThinMediumGap";case"ThinThickMediumGap":return"thinThickMediumGap";case"ThinThickThinMediumGap":return"thinThickThinMediumGap";case"ThickThinLargeGap":return"thickThinLargeGap";case"ThinThickLargeGap":return"thinThickLargeGap";case"ThinThickThinLargeGap":return"thinThickThinLargeGap";case"Thick":return"thick";case"SingleWavy":return"wave";case"DoubleWavy":return"doubleWave";case"DashDotStroked":return"dashDotStroked";case"Engrave3D":return"threeDEngrave";case"Emboss3D":return"threeDEmboss";case"Outset":return"outset";case"Inset":return"inset";default:return"single"}},e.prototype.serializeTableIndentation=function(e,t){if(!sf.base.isNullOrUndefined(t.leftIndent)){e.writeStartElement(void 0,"tblInd",this.wNamespace);var i=Math.round(t.leftIndent*this.twipsInOnePoint);e.writeAttributeString(void 0,"w",this.wNamespace,i.toString()),e.writeAttributeString(void 0,"type",this.wNamespace,"dxa"),e.writeEndElement()}},e.prototype.serializeCellSpacing=function(e,t){!sf.base.isNullOrUndefined(t.cellSpacing)&&t.cellSpacing>0&&(e.writeStartElement(void 0,"tblCellSpacing",this.wNamespace),e.writeAttributeString(void 0,"w",this.wNamespace,this.roundToTwoDecimal(t.cellSpacing/2*this.twentiethOfPoint).toString()),e.writeAttributeString(void 0,"type",this.wNamespace,"dxa"),e.writeEndElement())},e.prototype.serializeTableWidth=function(e,t){if(e.writeStartElement(void 0,"tblW",this.wNamespace),"Percent"===t.tableFormat.preferredWidthType)e.writeAttributeString(void 0,"w",this.wNamespace,(t.tableFormat.preferredWidth*this.percentageFactor).toString()),e.writeAttributeString(void 0,"type",this.wNamespace,"pct");else if("Point"===t.tableFormat.preferredWidthType){var i=Math.round(t.tableFormat.preferredWidth*this.twipsInOnePoint);e.writeAttributeString(void 0,"w",this.wNamespace,i.toString()),e.writeAttributeString(void 0,"type",this.wNamespace,"dxa")}else e.writeAttributeString(void 0,"w",this.wNamespace,"0"),e.writeAttributeString(void 0,"type",this.wNamespace,"auto");e.writeEndElement()},e.prototype.serializeTableAlignment=function(e,t){switch(e.writeStartElement(void 0,"jc",this.wNamespace),t.tableAlignment){case"Right":e.writeAttributeString("w","val",this.wNamespace,"right");break;case"Center":e.writeAttributeString("w","val",this.wNamespace,"center");break;default:e.writeAttributeString("w","val",this.wNamespace,"left")}e.writeEndElement()},e.prototype.serializeFieldCharacter=function(e,t){e.writeStartElement(void 0,"r",this.wNamespace),this.serializeCharacterFormat(e,t.characterFormat),e.writeStartElement(void 0,"fldChar",this.wNamespace);var i=0===t.fieldType?"begin":1===t.fieldType?"end":"separate";if(e.writeAttributeString(void 0,"fldCharType",this.wNamespace,i),"begin"===i&&!sf.base.isNullOrUndefined(t.formFieldData)){var r=t.formFieldData;if(e.writeStartElement(void 0,"ffData",this.wNamespace),e.writeStartElement(void 0,"name",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,r.name),e.writeEndElement(),e.writeStartElement(void 0,"enabled",this.wNamespace),e.writeEndElement(),r.hasOwnProperty("textInput")){e.writeStartElement(void 0,"textInput",this.wNamespace);r.textInput.type;e.writeStartElement(void 0,"type",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,"Calculation"==r.textInput.type?"calculated":r.textInput.type.toString().toLowerCase()),e.writeEndElement(),e.writeStartElement(void 0,"default",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,r.textInput.defaultValue),e.writeEndElement(),e.writeStartElement(void 0,"format",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,r.textInput.format),e.writeEndElement(),e.writeEndElement()}else if(r.hasOwnProperty("checkBox"))e.writeStartElement(void 0,"checkBox",this.wNamespace),"Auto"===r.checkBox.sizeType?(e.writeStartElement(void 0,"sizeAuto",this.wNamespace),e.writeEndElement()):(e.writeStartElement(void 0,"size",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,this.roundToTwoDecimal(2*r.checkBox.size).toString()),e.writeEndElement()),e.writeStartElement(void 0,"defalut",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,r.checkBox.defaultValue?"1":"0"),e.writeEndElement(),r.checkBox.checked&&(e.writeStartElement(void 0,"checked",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,r.checkBox.checked?"1":"0"),e.writeEndElement()),e.writeEndElement();else{e.writeStartElement(void 0,"ddList",this.wNamespace),0!==r.dropDownList.selectedIndex&&(e.writeStartElement(void 0,"result",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,r.dropDownList.selectedIndex.toString()),e.writeEndElement());for(var n=0;n<r.dropDownList.dropDownItems.length;n++)e.writeStartElement(void 0,"listEntry",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,r.dropDownList.dropDownItems[n].toString()),e.writeEndElement();e.writeEndElement()}e.writeEndElement()}e.writeEndElement(),e.writeEndElement(),0===t.fieldType&&"FieldFormTextInput"===t.fieldCodeType&&(e.writeStartElement("w","r",this.wNamespace),e.writeStartElement(void 0,"instrText",this.wNamespace),e.writeAttributeString("xml","space",this.xmlNamespace,"preserve"),e.writeString("FORMTEXT"),e.writeEndElement(),e.writeEndElement())},e.prototype.serializeTextRange=function(e,t,i,r){if(e.writeStartElement("w","r",this.wNamespace),sf.base.isNullOrUndefined(t.characterFormat)||this.serializeCharacterFormat(e,t.characterFormat),"\t"===t.text)e.writeElementString(void 0,"tab",this.wNamespace,void 0);else if("\v"===t.text)e.writeElementString(void 0,"br",this.wNamespace,void 0);else if("\f"===t.text)e.writeStartElement(void 0,"br",this.wNamespace),e.writeAttributeString("w","type",this.wNamespace,"page"),e.writeEndElement();else if(t.text===String.fromCharCode(14))e.writeStartElement(void 0,"br",this.wNamespace),e.writeAttributeString("w","type",this.wNamespace,"column"),e.writeEndElement();else if("%02"===encodeURI(t.text))e.writeStartElement(void 0,"footnoteRef",this.wNamespace),e.writeEndElement();else if("%02"===encodeURI(t.text)&&"endnote"===r)e.writeStartElement(void 0,"endnoteRef",this.wNamespace),e.writeEndElement();else if("%03"===encodeURI(t.text))e.writeStartElement(void 0,"separator",this.wNamespace),e.writeEndElement();else if("%04"===encodeURI(t.text))e.writeStartElement(void 0,"continuationSeparator",this.wNamespace),e.writeEndElement();else{var n=this.retrieveDeleteRevision(t),o=!sf.base.isNullOrUndefined(i)&&i.hasOwnProperty("fieldType")&&2!==i.fieldType?n?"delInstrText":"instrText":n?"delText":"t";e.writeStartElement(void 0,o,this.wNamespace),e.writeAttributeString("xml","space",this.xmlNamespace,"preserve"),e.writeString(t.text),e.writeEndElement()}e.writeEndElement()},e.prototype.retrieveDeleteRevision=function(e){if(e.hasOwnProperty("revisionIds")&&e.revisionIds.length>0)for(var t=0;t<e.revisionIds.length;t++)if("Deletion"===this.retrieveRevision(e.revisionIds[t]).revisionType)return!0;return!1},e.prototype.serializeParagraphFormat=function(e,t,i){sf.base.isNullOrUndefined(t)||(this.serializeParagraphBorders(e,t),sf.base.isNullOrUndefined(t.styleName)||(e.writeStartElement(void 0,"pStyle",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,t.styleName),e.writeEndElement()),sf.base.isNullOrUndefined(i)?this.serializeListFormat(e,t.listFormat):this.serializeListFormat(e,i.paragraphFormat.listFormat),t.bidi&&(e.writeStartElement(void 0,"bidi",this.wNamespace),e.writeEndElement()),sf.base.isNullOrUndefined(t.keepWithNext)||(e.writeStartElement(void 0,"keepNext",this.wNamespace),t.keepWithNext||e.writeAttributeString("w","val",this.wNamespace,"0"),e.writeEndElement()),sf.base.isNullOrUndefined(t.keepLinesTogether)||(e.writeStartElement(void 0,"keepLines",this.wNamespace),t.keepLinesTogether||e.writeAttributeString("w","val",this.wNamespace,"0"),e.writeEndElement()),sf.base.isNullOrUndefined(t.outlineLevel)||(e.writeStartElement(void 0,"outlineLvl",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,this.getOutlineLevelValue(t.outlineLevel).toString()),e.writeEndElement()),this.serializeParagraphSpacing(e,t),sf.base.isNullOrUndefined(t.contextualSpacing)||(e.writeStartElement("w","contextualSpacing",this.wNamespace),t.contextualSpacing||e.writeAttributeString("w","val",this.wNamespace,"0"),e.writeEndElement()),sf.base.isNullOrUndefined(t.widowControl)||(e.writeStartElement("w","widowControl",this.wNamespace),t.widowControl?e.writeAttributeString("w","val",this.wNamespace,"1"):e.writeAttributeString("w","val",this.wNamespace,"0"),e.writeEndElement()),this.serializeIndentation(e,t),this.serializeParagraphAlignment(e,t.textAlignment,t.bidi),!sf.base.isNullOrUndefined(t.tabs)&&t.tabs.length>0&&this.serializeTabs(e,t.tabs))},e.prototype.getOutlineLevelValue=function(e){if(-1!==e.indexOf("Level")){var t=parseInt(e.substring(5),10);if(t>0)return t-1}return 9},e.prototype.serializeTabs=function(e,t){e.writeStartElement("w","tabs",this.wNamespace);for(var i=0;i<t.length;i++)this.serializeTab(e,t[i]);e.writeEndElement()},e.prototype.serializeTab=function(e,t){var i=0;e.writeStartElement("w","tab",this.wNamespace),0===t.position&&0!==t.deletePosition?(i=t.deletePosition*this.twentiethOfPoint,e.writeAttributeString("w","val",this.wNamespace,"clear")):(i=t.position*this.twentiethOfPoint,e.writeAttributeString("w","val",this.wNamespace,this.getTabJustification(t.tabJustification))),sf.base.isNullOrUndefined(t.tabLeader)||"None"===t.tabLeader||e.writeAttributeString("w","leader",this.wNamespace,this.getTabLeader(t.tabLeader)),isNaN(i)||e.writeAttributeString("w","pos",this.wNamespace,i.toString()+""),e.writeEndElement()},e.prototype.getTabLeader=function(e){switch(e){case"Dot":return"dot";case"Hyphen":return"hyphen";case"Underscore":return"underscore";default:return"none"}},e.prototype.getTabJustification=function(e){switch(e){case"Bar":return"bar";case"Center":return"center";case"Decimal":return"decimal";case"Left":return"left";case"List":return"num";case"Right":return"right";default:return"clear"}},e.prototype.serializeListFormat=function(e,t){if(!sf.base.isNullOrUndefined(t.listId)||!sf.base.isNullOrUndefined(t.listLevelNumber)){if(e.writeStartElement(void 0,"numPr",this.wNamespace),sf.base.isNullOrUndefined(t.listLevelNumber)||-1===t.listLevelNumber||(e.writeStartElement(void 0,"ilvl",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,t.listLevelNumber.toString()),e.writeEndElement()),!sf.base.isNullOrUndefined(t.listId)){e.writeStartElement(void 0,"numId",this.wNamespace);var i=(t.listId+1).toString();-1===t.listId&&(i=""),e.writeAttributeString("w","val",this.wNamespace,i),e.writeEndElement()}e.writeEndElement()}},e.prototype.serializeParagraphAlignment=function(e,t,i){if(!sf.base.isNullOrUndefined(t)){e.writeStartElement(void 0,"jc",this.wNamespace);var r=void 0;switch(t){case"Center":r="center";break;case"Right":r="right";break;case"Justify":r="both";break;default:r="left"}e.writeAttributeString("w","val",this.wNamespace,r),e.writeEndElement()}},e.prototype.serializeParagraphSpacing=function(e,t){if(e.writeStartElement(void 0,"spacing",this.wNamespace),sf.base.isNullOrUndefined(t.beforeSpacing)||e.writeAttributeString(void 0,"before",this.wNamespace,this.roundToTwoDecimal(t.beforeSpacing*this.twentiethOfPoint).toString()),!sf.base.isNullOrUndefined(t.spaceBeforeAuto)){var i=t.spaceBeforeAuto?"1":"0";e.writeAttributeString(void 0,"beforeAutospacing",this.wNamespace,i)}if(sf.base.isNullOrUndefined(t.afterSpacing)||e.writeAttributeString(void 0,"after",this.wNamespace,this.roundToTwoDecimal(t.afterSpacing*this.twentiethOfPoint).toString()),!sf.base.isNullOrUndefined(t.spaceAfterAuto)){i=t.spaceAfterAuto?"1":"0";e.writeAttributeString(void 0,"afterAutospacing",this.wNamespace,i)}if(!sf.base.isNullOrUndefined(t.lineSpacing)){var r="AtLeast"===t.lineSpacingType||"Exactly"===t.lineSpacingType?this.roundToTwoDecimal(t.lineSpacing*this.twentiethOfPoint):this.roundToTwoDecimal(240*t.lineSpacing);e.writeAttributeString(void 0,"line",this.wNamespace,r.toString())}if(!sf.base.isNullOrUndefined(t.lineSpacingType)){var n="auto";"AtLeast"===t.lineSpacingType?n="atLeast":"Exactly"===t.lineSpacingType&&(n="exact"),e.writeAttributeString(void 0,"lineRule",this.wNamespace,n)}e.writeEndElement()},e.prototype.serializeIndentation=function(e,t){e.writeStartElement(void 0,"ind",this.wNamespace),sf.base.isNullOrUndefined(t.leftIndent)||e.writeAttributeString(void 0,"left",this.wNamespace,this.roundToTwoDecimal(t.leftIndent*this.twipsInOnePoint).toString()),sf.base.isNullOrUndefined(t.rightIndent)||e.writeAttributeString(void 0,"right",this.wNamespace,this.roundToTwoDecimal(t.rightIndent*this.twipsInOnePoint).toString()),sf.base.isNullOrUndefined(t.firstLineIndent)||(t.firstLineIndent<0?e.writeAttributeString(void 0,"hanging",this.wNamespace,this.roundToTwoDecimal(-1*t.firstLineIndent*this.twipsInOnePoint).toString()):e.writeAttributeString(void 0,"firstLine",this.wNamespace,this.roundToTwoDecimal(t.firstLineIndent*this.twipsInOnePoint).toString())),e.writeEndElement()},e.prototype.serializeCustomXMLMapping=function(e,t){if(e.length>0)for(var i=e.keys,r=0;r<i.length;r++){var n=new sf.fileutils.XmlWriter;n.writeStartElement(void 0,"Relationships",this.rpNamespace);var o=this.mCustomXML.get(i[r]),s=i[r],a=this.getNextRelationShipID(),l=r+1,h=this.createXMLItem(o,a,l),d=this.createXMLItemProps(s,l);this.serializeRelationShip(t,a,this.customXmlRelType,"../"+h),this.customXMLRelation(n,l,d),n.writeEndElement();var c=new sf.compression.ZipArchiveItem(n.buffer,this.customXMLRelPath+l+".xml.rels");this.mArchive.addItem(c)}},e.prototype.customXMLRelation=function(e,t,i){this.serializeRelationShip(e,"rId1",this.wordMLCustomXmlPropsRelType,i)},e.prototype.createXMLItem=function(e,t,i){var r=new Blob([e],{type:"text/plain"}),n=this.customXMLItemsPath+i+".xml",o=new sf.compression.ZipArchiveItem(r,n);return this.mArchive.addItem(o),n},e.prototype.createXMLItemProps=function(e,t){var i=new sf.fileutils.XmlWriter,r=this.customXMLItemsPropspath+t+".xml",n=this.itemPropsPath+t+".xml";i.writeStartElement("ds","datastoreItem",this.wNamespace),i.writeAttributeString("ds","itemID",void 0,e),i.writeAttributeString("xmlns","ds",void 0,this.dsNamespace),i.writeEndElement(),this.customXMLProps.push(r);var o=new sf.compression.ZipArchiveItem(i.buffer,r);return this.mArchive.addItem(o),n},e.prototype.serializeStyles=function(){var e=new sf.fileutils.XmlWriter;e.writeStartElement("w","styles",this.wNamespace),e.writeAttributeString("xmlns","mc",void 0,this.veNamespace),e.writeAttributeString("xmlns","r",void 0,this.rNamespace),e.writeAttributeString("xmlns","w",void 0,this.wNamespace),e.writeAttributeString("xmlns","w14",void 0,this.w14Namespace),e.writeAttributeString("xmlns","w15",void 0,this.w15Namespace),e.writeAttributeString("mc","Ignorable",void 0,"w14 w15"),this.serializeDefaultStyles(e),this.serializeDocumentStyles(e),e.writeEndElement();var t=new sf.compression.ZipArchiveItem(e.buffer,this.stylePath);this.mArchive.addItem(t)},e.prototype.serializeDefaultStyles=function(e){e.writeStartElement(void 0,"docDefaults",this.wNamespace),e.writeStartElement(void 0,"rPrDefault",this.wNamespace),this.serializeCharacterFormat(e,this.defCharacterFormat),e.writeEndElement(),e.writeStartElement(void 0,"pPrDefault",this.wNamespace),sf.base.isNullOrUndefined(this.defParagraphFormat)||(e.writeStartElement(void 0,"pPr",this.wNamespace),this.serializeParagraphFormat(e,this.defParagraphFormat,void 0),e.writeEndElement()),e.writeEndElement(),e.writeEndElement()},e.prototype.serializeDocumentStyles=function(e){for(var t=0;t<this.mStyles.length;t++){var i=this.mStyles[t];e.writeStartElement(void 0,"style",this.wNamespace);var r="Paragraph"===i.type?"paragraph":"character";e.writeAttributeString("w","type",this.wNamespace,r),e.writeAttributeString("w","styleId",this.wNamespace,i.name),e.writeStartElement(void 0,"name",this.wNamespace);-1!=["TOC 1","TOC 2","TOC 3","TOC 4","TOC 5","TOC 6","TOC 7","TOC 8","TOC 9"].indexOf(i.name)?e.writeAttributeString("w","val",this.wNamespace,i.name.toLowerCase()):e.writeAttributeString("w","val",this.wNamespace,i.name),e.writeEndElement(),sf.base.isNullOrUndefined(i.basedOn)||(e.writeStartElement(void 0,"basedOn",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,i.basedOn),e.writeEndElement()),sf.base.isNullOrUndefined(i.next)||(e.writeStartElement(void 0,"next",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,i.next),e.writeEndElement()),sf.base.isNullOrUndefined(i.link)||(e.writeStartElement(void 0,"link",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,i.link),e.writeEndElement()),"Paragraph"===i.type&&(e.writeStartElement(void 0,"pPr",this.wNamespace),this.serializeParagraphFormat(e,i.paragraphFormat,void 0),e.writeEndElement()),this.serializeCharacterFormat(e,i.characterFormat),e.writeEndElement()}},e.prototype.serializeCharacterFormat=function(e,t){if(e.writeStartElement(void 0,"rPr",this.wNamespace),sf.base.isNullOrUndefined(t.styleName)||(e.writeStartElement(void 0,"rStyle",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,t.styleName),e.writeEndElement()),!sf.base.isNullOrUndefined(t.fontFamily)){if(e.writeStartElement(void 0,"rFonts",this.wNamespace),!sf.base.isNullOrUndefined(t.fontFamilyAscii)){var i=x.isThemeFont(t.fontFamilyAscii)?"asciiTheme":"ascii";e.writeAttributeString(void 0,i,this.wNamespace,t.fontFamily)}if(!sf.base.isNullOrUndefined(t.fontFamilyFarEast)){i=x.isThemeFont(t.fontFamilyFarEast)?"eastAsiaTheme":"eastAsia";e.writeAttributeString(void 0,i,this.wNamespace,t.fontFamilyFarEast)}if(!sf.base.isNullOrUndefined(t.fontFamilyNonFarEast)){i=x.isThemeFont(t.fontFamilyNonFarEast)?"hAnsiTheme":"hAnsi";e.writeAttributeString(void 0,i,this.wNamespace,t.fontFamilyNonFarEast)}if(!sf.base.isNullOrUndefined(t.fontFamilyBidi)){i=x.isThemeFont(t.fontFamilyBidi)?"cstheme":"cs";e.writeAttributeString(void 0,i,this.wNamespace,t.fontFamilyBidi)}e.writeEndElement()}if(sf.base.isNullOrUndefined(t.bold)||this.serializeBoolProperty(e,"b",t.bold),t.boldBidi&&this.serializeBoolProperty(e,"bCs",t.boldBidi),sf.base.isNullOrUndefined(t.italic)||this.serializeBoolProperty(e,"i",t.italic),sf.base.isNullOrUndefined(t.italicBidi)||this.serializeBoolProperty(e,"iCs",t.italicBidi),t.bidi&&(e.writeStartElement(void 0,"rtl",this.wNamespace),e.writeEndElement()),t.allCaps&&this.serializeBoolProperty(e,"caps",t.allCaps),t.complexScript&&this.serializeBoolProperty(e,"cs",t.complexScript),!sf.base.isNullOrUndefined(t.strikethrough))switch(t.strikethrough){case"SingleStrike":this.serializeBoolProperty(e,"strike",!0);break;case"DoubleStrike":this.serializeBoolProperty(e,"dstrike",!0);break;default:this.serializeBoolProperty(e,"strike",!1),this.serializeBoolProperty(e,"dstrike",!1)}if(sf.base.isNullOrUndefined(t.fontColor)||(e.writeStartElement(void 0,"color",this.wNamespace),"empty"===t.fontColor||"#00000000"===t.fontColor?e.writeAttributeString("w","val",this.wNamespace,"auto"):e.writeAttributeString("w","val",this.wNamespace,this.getColor(t.fontColor)),e.writeEndElement()),sf.base.isNullOrUndefined(t.fontSize)||(e.writeStartElement(void 0,"sz",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,this.roundToTwoDecimal(2*t.fontSize).toString()),e.writeEndElement()),sf.base.isNullOrUndefined(t.fontSizeBidi)||(e.writeStartElement(void 0,"szCs",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,this.roundToTwoDecimal(2*t.fontSizeBidi).toString()),e.writeEndElement()),sf.base.isNullOrUndefined(t.highlightColor)||"NoColor"===t.highlightColor||(e.writeStartElement(void 0,"highlight",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,this.getHighlightColor(t.highlightColor)),e.writeEndElement()),!sf.base.isNullOrUndefined(t.revisionIds)&&t.revisionIds.length>0&&(this.serializeRevisionStart(e,t,void 0),this.serializeRevisionEnd(e,t,void 0)),sf.base.isNullOrUndefined(t.underline)||(e.writeStartElement(void 0,"u",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,this.getUnderlineStyle(t.underline)),e.writeEndElement()),!sf.base.isNullOrUndefined(t.baselineAlignment)){switch(e.writeStartElement(void 0,"vertAlign",this.wNamespace),t.baselineAlignment){case"Subscript":e.writeAttributeString("w","val",this.wNamespace,"subscript");break;case"Superscript":e.writeAttributeString("w","val",this.wNamespace,"superscript");break;default:e.writeAttributeString("w","val",this.wNamespace,"baseline")}e.writeEndElement()}e.writeEndElement()},e.prototype.getColor=function(e){return e.length>0&&("#"===e[0]&&(e=e.substr(1)),e.length>6&&(e=e.substr(0,6))),e},e.prototype.getUnderlineStyle=function(e){switch(e){case"DotDotDashHeavy":return"dashDotDotHeavy";case"DotDashHeavy":return"dashDotHeavy";case"DashHeavy":return"dashedHeavy";case"DashLong":return"dashLong";case"DashLongHeavy":return"dashLongHeavy";case"DotDash":return"dotDash";case"DotDotDash":return"dotDotDash";case"Dotted":return"dotted";case"DottedHeavy":return"dottedHeavy";case"Double":return"double";case"Single":return"single";case"Thick":return"thick";case"Wavy":return"wave";case"WavyDouble":return"wavyDouble";case"WavyHeavy":return"wavyHeavy";case"Words":return"words";case"None":return"none";default:return"dash"}},e.prototype.getHighlightColor=function(e){switch(e){case"BrightGreen":return"green";case"Turquoise":return"cyan";case"Pink":return"magenta";case"Blue":return"blue";case"Red":return"red";case"DarkBlue":return"darkBlue";case"Teal":return"darkCyan";case"Green":return"darkGreen";case"Violet":return"darkMagenta";case"DarkRed":return"darkRed";case"DarkYellow":return"darkYellow";case"Gray50":return"darkGray";case"Gray25":return"lightGray";case"Black":return"black";default:return"yellow"}},e.prototype.serializeBoolProperty=function(e,t,i){e.writeStartElement(void 0,t,this.wNamespace),i||e.writeAttributeString(void 0,"val",this.wNamespace,"0"),e.writeEndElement()},e.prototype.serializeNumberings=function(){if(0!==this.document.lists.length){var e=new sf.fileutils.XmlWriter;e.writeStartElement("w","numbering",this.wNamespace),this.writeCommonAttributeStrings(e),this.serializeAbstractListStyles(e,this.document.abstractLists),this.serializeListInstances(e,this.document.lists),e.writeEndElement();var t=new sf.compression.ZipArchiveItem(e.buffer,this.numberingPath);this.mArchive.addItem(t)}},e.prototype.serializeAbstractListStyles=function(e,t){for(var i=0;i<t.length;i++){var r=t[i];e.writeStartElement(void 0,"abstractNum",this.wNamespace),e.writeAttributeString(void 0,"abstractNumId",this.wNamespace,r.abstractListId.toString()),e.writeStartElement(void 0,"nsid",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,this.generateHex()),e.writeEndElement();for(var n=0,o=r.levels.length;n<o;n++)this.serializeListLevel(e,r.levels[n],n);e.writeEndElement()}},e.prototype.serializeListInstances=function(e,t){for(var i=0;i<t.length;i++){var r=t[i];e.writeStartElement(void 0,"num",this.wNamespace),e.writeAttributeString(void 0,"numId",this.wNamespace,(r.listId+1).toString()),e.writeStartElement(void 0,"abstractNumId",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,r.abstractListId.toString()),e.writeEndElement();for(var n=0,o=r.levelOverrides.length;n<o;n++)this.serializeLevelOverrides(e,r.levelOverrides[n],r.levelOverrides[n].levelNumber);e.writeEndElement()}},e.prototype.generateHex=function(){return(Math.floor(373e7*Math.random())+27e7).toString(16).toUpperCase()},e.prototype.roundToTwoDecimal=function(e){return Math.round(e)},e.prototype.serializeListLevel=function(e,t,i){e.writeStartElement(void 0,"lvl",this.wNamespace),e.writeAttributeString(void 0,"ilvl",this.wNamespace,i.toString()),e.writeStartElement(void 0,"start",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,t.startAt.toString()),e.writeEndElement(),e.writeStartElement(void 0,"numFmt",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,this.getLevelPattern(t.listLevelPattern)),e.writeEndElement(),this.serializeLevelFollow(e,t),this.serializeLevelText(e,t,i+1),e.writeStartElement(void 0,"pPr",this.wNamespace),this.serializeParagraphFormat(e,t.paragraphFormat,void 0),e.writeEndElement(),this.serializeCharacterFormat(e,t.characterFormat),e.writeEndElement()},e.prototype.serializeLevelOverrides=function(e,t,i){e.writeStartElement(void 0,"lvlOverride",this.wNamespace),e.writeAttributeString(void 0,"ilvl",this.wNamespace,i.toString()),sf.base.isNullOrUndefined(t.overrideListLevel)||this.serializeListLevel(e,t.overrideListLevel,i),sf.base.isNullOrUndefined(t.startAt)||(e.writeStartElement(void 0,"startOverride",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,t.startAt.toString()),e.writeEndElement()),e.writeEndElement()},e.prototype.getLevelPattern=function(e){var t;switch(e){case"Arabic":t="decimal";break;case"UpRoman":t="upperRoman";break;case"LowRoman":t="lowerRoman";break;case"UpLetter":t="upperLetter";break;case"LowLetter":t="lowerLetter";break;case"None":t="none";break;case"Ordinal":t="ordinal";break;case"Number":t="cardinalText";break;case"OrdinalText":t="ordinalText";break;case"LeadingZero":t="decimalZero";break;case"FarEast":t="aiueoFullWidth";break;case"Special":t="russianLower";break;default:t="bullet"}return t},e.prototype.serializeLevelText=function(e,t,i){e.writeStartElement(void 0,"lvlText",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,t.numberFormat),e.writeEndElement()},e.prototype.serializeLevelFollow=function(e,t){var i;i="Tab"===t.followCharacter?"tab":"Space"===t.followCharacter?"space":"nothing",e.writeStartElement(void 0,"suff",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,i),e.writeEndElement()},e.prototype.serializeDocumentProtectionSettings=function(e){if(e.writeStartElement("w","documentProtection",this.wNamespace),this.formatting&&e.writeAttributeString("w","formatting",this.wNamespace,"1"),this.protectionType&&"NoProtection"!==this.protectionType){var t=void 0;switch(this.protectionType){case"ReadOnly":t="readOnly";break;case"FormFieldsOnly":t="forms";break;case"CommentsOnly":t="comments";break;case"RevisionsOnly":t="trackedChanges"}e.writeAttributeString("w","edit",this.wNamespace,t)}e.writeAttributeString("w","cryptProviderType",this.wNamespace,"rsaAES"),e.writeAttributeString("w","cryptAlgorithmClass",this.wNamespace,"hash"),e.writeAttributeString("w","cryptAlgorithmType",this.wNamespace,"typeAny"),e.writeAttributeString("w","cryptAlgorithmSid",this.wNamespace,"14"),e.writeAttributeString("w","cryptSpinCount",this.wNamespace,"100000"),this.enforcement&&e.writeAttributeString("w","enforcement",this.wNamespace,"1"),this.hashValue&&e.writeAttributeString("w","hash",this.wNamespace,this.hashValue),this.saltValue&&e.writeAttributeString("w","salt",this.wNamespace,this.saltValue),e.writeEndElement()},e.prototype.serializeSettings=function(){var e=new sf.fileutils.XmlWriter;e.writeStartElement("w","settings",this.wNamespace),this.writeCustom(e),e.writeAttributeString("xmlns","w10",void 0,this.w10Namespace),e.writeAttributeString("xmlns","w14",void 0,this.w14Namespace),e.writeAttributeString("xmlns","w15",void 0,this.w15Namespace),e.writeAttributeString("xmlns","sl",void 0,this.slNamespace),e.writeAttributeString("mc","Ignorable",void 0,"w14 w15"),this.serializeDocumentProtectionSettings(e),e.writeStartElement("w","zoom",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,"none"),e.writeAttributeString("w","percent",this.wNamespace,"100"),e.writeEndElement(),this.serializeThemeFontLang(e),e.writeStartElement(void 0,"displayBackgroundShape",this.wNamespace),e.writeEndElement(),e.writeStartElement(void 0,"defaultTabStop",this.wNamespace);var t=Math.round(this.defaultTabWidthValue*this.twipsInOnePoint);e.writeAttributeString(void 0,"val",this.wNamespace,t.toString()),e.writeEndElement(),this.trackChanges&&(e.writeStartElement(void 0,"trackRevisions",this.wNamespace),e.writeEndElement()),this.mDifferentFirstPage&&(e.writeStartElement(void 0,"evenAndOddHeaders",this.wNamespace),e.writeEndElement()),this.formFieldShading||(e.writeStartElement(void 0,"doNotShadeFormData",this.wNamespace),e.writeEndElement()),e.writeStartElement(void 0,"compat",this.wNamespace),this.dontUseHtmlParagraphAutoSpacing&&this.serializeBoolProperty(e,"doNotUseHTMLParagraphAutoSpacing",this.dontUseHtmlParagraphAutoSpacing),e.writeStartElement(void 0,"compatSetting",this.wNamespace),e.writeAttributeString(void 0,"name",this.wNamespace,"compatibilityMode"),e.writeAttributeString(void 0,"uri",this.wNamespace,"http://schemas.microsoft.com/office/word");var i=x.getCompatibilityModeValue(this.compatibilityMode);e.writeAttributeString(void 0,"val",this.wNamespace,i),e.writeEndElement(),e.writeEndElement(),this.document.footnotes&&(e.writeStartElement(void 0,"footnotePr",this.wNamespace),e.writeStartElement(void 0,"footnote",this.wNamespace),e.writeAttributeString(void 0,"id",this.wNamespace,"-1"),e.writeEndElement(),e.writeStartElement(void 0,"footnote",this.wNamespace),e.writeAttributeString(void 0,"id",this.wNamespace,"0"),e.writeEndElement(),e.writeEndElement()),this.document.endnotes&&(e.writeStartElement(void 0,"endnotePr",this.wNamespace),e.writeStartElement(void 0,"endnote",this.wNamespace),e.writeAttributeString(void 0,"id",this.wNamespace,"-1"),e.writeEndElement(),e.writeStartElement(void 0,"endnote",this.wNamespace),e.writeAttributeString(void 0,"id",this.wNamespace,"0"),e.writeEndElement(),e.writeEndElement()),e.writeEndElement();var r=new sf.compression.ZipArchiveItem(e.buffer,this.settingsPath);this.mArchive.addItem(r)},e.prototype.serializeThemeFontLang=function(e){var t=this.themeFontLang.localeIdBidi>0,i=this.themeFontLang.localeIdAscii>0,r=this.themeFontLang.localeIdFarEast>0;if(i||r||t){if(e.writeStartElement("w","themeFontLang",void 0),i){var o=n[this.themeFontLang.localeIdAscii];e.writeAttributeString("w","val",void 0,o.replace("_","-"))}if(t){var s=n[this.themeFontLang.localeIdBidi];e.writeAttributeString("w","bidi",void 0,s.replace("_","-"))}if(r){var a=n[this.themeFontLang.localeIdFarEast];e.writeAttributeString("w","eastAsia",void 0,a.replace("_","-"))}e.writeEndElement()}},e.prototype.serializeCoreProperties=function(){},e.prototype.serializeAppProperties=function(){},e.prototype.serializeFontTable=function(e){},e.prototype.serializeSettingsRelation=function(){},e.prototype.serializeHeaderFooters=function(){this.serializeHeaderFooter("EvenFooter"),this.serializeHeaderFooter("EvenHeader"),this.serializeHeaderFooter("FirstPageFooter"),this.serializeHeaderFooter("FirstPageHeader"),this.serializeHeaderFooter("OddFooter"),this.serializeHeaderFooter("OddHeader")},e.prototype.serializeHeaderFooter=function(e){var t,i;if(0!==this.headersFooters.length&&this.headersFooters.containsKey(e))for(var r=this.headersFooters.get(e),n=void 0,o=0;o<r.keys.length;o++){var s=r.keys[o];n=r.get(s),"EvenHeader"===e||"FirstPageHeader"===e||"OddHeader"===e?(t=this.headerPath+s.replace("rId","")+".xml",i=this.headerRelationPath+s.replace("rId","")+".xml.rels",this.serializeHeader(n,s,t,i)):(t=this.footerPath+s.replace("rId","")+".xml",i=this.footerRelationPath+s.replace("rId","")+".xml.rels",this.serializeFooter(n,s,t,i))}},e.prototype.serializeHeader=function(e,t,i,r){this.headerFooter=e;var n=new sf.fileutils.XmlWriter;n.writeStartElement("w","hdr",this.wNamespace),this.writeHFCommonAttributes(n);var o=this.blockOwner;this.blockOwner=e,this.serializeBodyItems(n,e.blocks,!0),this.blockOwner=o,n.writeEndElement();var s=new sf.compression.ZipArchiveItem(n.buffer,i);this.mArchive.addItem(s),this.serializeHFRelations(t,r),this.headerFooter=void 0},e.prototype.serializeHFRelations=function(e,t){if(this.headerFooterImages.containsKey(e)){var i=new sf.fileutils.XmlWriter;i.writeStartElement(void 0,"Relationships",this.rpNamespace),this.serializeImagesRelations(this.headerFooterImages.get(e),i,!1),this.headerFooterSvgImages.containsKey(e)&&this.serializeSvgImageRelation(this.headerFooterSvgImages.get(e),i),i.writeEndElement();var r=new sf.compression.ZipArchiveItem(i.buffer,t);this.mArchive.addItem(r)}},e.prototype.writeHFCommonAttributes=function(e){e.writeAttributeString("xmlns","v",void 0,this.vNamespace),e.writeAttributeString("xmlns","w10",void 0,this.w10Namespace),e.writeAttributeString("xmlns","o",void 0,this.oNamespace),e.writeAttributeString("xmlns","ve",void 0,this.veNamespace),e.writeAttributeString("xmlns","r",void 0,this.rNamespace),e.writeAttributeString("xmlns","m",void 0,this.mNamespace),e.writeAttributeString("xmlns","wne",void 0,this.wneNamespace),e.writeAttributeString("xmlns","a",void 0,this.aNamespace),e.writeAttributeString("xmlns","pic",void 0,this.pictureNamespace),e.writeAttributeString("xmlns","wp",void 0,this.wpNamespace),e.writeAttributeString("xmlns","wpc",void 0,this.wpCanvasNamespace),e.writeAttributeString("xmlns","wp14",void 0,this.wpDrawingNamespace),this.writeDup(e),e.writeAttributeString("xmlns","wps",void 0,this.wpShapeNamespace),e.writeAttributeString("ve","Ignorable",void 0,"w14 w15 wp14")},e.prototype.serializeFooter=function(e,t,i,r){this.headerFooter=e;var n=new sf.fileutils.XmlWriter;n.writeStartElement("w","ftr",this.wNamespace),this.writeHFCommonAttributes(n),this.serializeBodyItems(n,e.blocks,!0),n.writeEndElement();var o=new sf.compression.ZipArchiveItem(n.buffer,i);this.mArchive.addItem(o),this.serializeHFRelations(t,r)},e.prototype.serializeDocumentRelations=function(){var e=new sf.fileutils.XmlWriter;e.writeStartElement(void 0,"Relationships",this.rpNamespace),this.serializeRelationShip(e,this.getNextRelationShipID(),this.stylesRelType,"styles.xml"),this.serializeRelationShip(e,this.getNextRelationShipID(),this.settingsRelType,"settings.xml"),this.document.endnotes&&this.serializeRelationShip(e,this.getNextRelationShipID(),this.endnoteRelType,"endnotes.xml"),this.document.footnotes&&this.serializeRelationShip(e,this.getNextRelationShipID(),this.footnoteRelType,"footnotes.xml"),this.mComments.length>0&&(1===this.mComments.length&&""===this.mComments[0].text||(this.serializeRelationShip(e,this.getNextRelationShipID(),this.commentsRelType,"comments.xml"),this.serializeRelationShip(e,this.getNextRelationShipID(),this.commentsExRelType,"commentsExtended.xml"))),sf.base.isNullOrUndefined(this.mThemes)||this.serializeRelationShip(e,this.getNextRelationShipID(),this.ThemeRelType,"theme/theme1.xml"),this.document.lists.length>0&&this.serializeRelationShip(e,this.getNextRelationShipID(),this.numberingRelType,"numbering.xml"),this.serializeHeaderFooterRelations(e),this.serializeImagesRelations(this.documentImages,e,!1),this.serializeSvgImageRelation(this.svgImages,e),this.serializeCustomXMLMapping(this.mCustomXML,e),this.serializeChartDocumentRelations(this.documentCharts,e),this.serializeExternalLinkImages(e),e.writeEndElement();var t=new sf.compression.ZipArchiveItem(e.buffer,this.wordRelationPath);this.mArchive.addItem(t),this.headerFooter=void 0},e.prototype.serializeChartDocumentRelations=function(e,t){if(e.length>0)for(var i=e.keys,r=1;r<=i.length;r++)this.serializeRelationShip(t,i[r-1],this.chartRelType,"charts/chart"+r+".xml")},e.prototype.serializeChartRelations=function(){var e=new sf.fileutils.XmlWriter;this.resetChartRelationShipId(),e.writeStartElement(void 0,"Relationships",this.rpNamespace);var t="colors"+this.chartCount+".xml",i=this.chartPath+"/_rels/chart"+this.chartCount+".xml.rels",r="../embeddings/Microsoft_Excel_Worksheet"+this.chartCount+".xlsx";this.serializeRelationShip(e,this.getNextChartRelationShipID(),this.packageRelType,r),this.serializeRelationShip(e,this.getNextChartRelationShipID(),this.chartColorStyleRelType,t),e.writeEndElement();var n=new sf.compression.ZipArchiveItem(e.buffer,i);this.mArchive.addItem(n)},e.prototype.serializeImagesRelations=function(e,t,i){if(e.length>0)for(var r="",n=void 0,o=e.keys,s=0;s<o.length;s++){var a=e.get(o[s]);if(n=i?a.metaFileImageString:a.imageString,sf.base.isNullOrUndefined(n))r=this.imagePath+"/0.jpeg",this.serializeRelationShip(t,o[s],this.imageRelType,r.replace("word/",""));else{var l=x.formatClippedString(n),h=l.extension,d=l.formatClippedString;r=this.imagePath+o[s]+h,this.serializeRelationShip(t,o[s],this.imageRelType,r.replace("word/",""));var c=new Blob([this.encodedString(d)]),p=new sf.compression.ZipArchiveItem(c,r);this.mArchive.addItem(p)}}},e.prototype.serializeSvgImageRelation=function(e,t){this.serializeImagesRelations(e,t,!0)},e.prototype.encodedString=function(e){var t,i,r,n,o,s,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",l=0,h=0,d=3*(e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"")).length/4;if(e.charAt(e.length-1)===a.charAt(64)&&d--,e.charAt(e.length-2)===a.charAt(64)&&d--,d%1!=0)throw new Error("Invalid base64 input, bad content length.");for(var c=new Uint8Array(0|d);l<e.length;)t=a.indexOf(e.charAt(l++))<<2|(n=a.indexOf(e.charAt(l++)))>>4,i=(15&n)<<4|(o=a.indexOf(e.charAt(l++)))>>2,r=(3&o)<<6|(s=a.indexOf(e.charAt(l++))),c[h++]=t,64!==o&&(c[h++]=i),64!==s&&(c[h++]=r);return c},e.prototype.serializeExternalLinkImages=function(e){for(var t=this.externalImages.keys,i=0;i<this.externalImages.keys.length;i++)this.serializeRelationShip(e,t[i],this.imageRelType,this.externalImages.get(t[i]))},e.prototype.serializeHeaderFooterRelations=function(e){this.serializeHFRelation(e,"EvenFooter"),this.serializeHFRelation(e,"EvenHeader"),this.serializeHFRelation(e,"FirstPageFooter"),this.serializeHFRelation(e,"FirstPageHeader"),this.serializeHFRelation(e,"OddFooter"),this.serializeHFRelation(e,"OddHeader")},e.prototype.serializeHFRelation=function(e,t){var i,r="";if(this.headersFooters.containsKey(t))for(var n=this.headersFooters.get(t),o=0;o<n.keys.length;o++){var s=n.keys[o];"EvenHeader"===t||"FirstPageHeader"===t||"OddHeader"===t?(r="header"+s.replace("rId","")+".xml",i=this.headerRelType):(r="footer"+s.replace("rId","")+".xml",i=this.footerRelType),this.serializeRelationShip(e,s,i,r)}},e.prototype.serializeRelationShip=function(e,t,i,r){e.writeStartElement(void 0,"Relationship",void 0),e.writeAttributeString(void 0,"Id",void 0,t),e.writeAttributeString(void 0,"Type",void 0,i),e.writeAttributeString(void 0,"Target",void 0,r.replace("\\","/").replace("\v","")),(i===this.hyperlinkRelType||this.startsWith(r,"http://")||this.startsWith(r,"https://")||this.startsWith(r,"file:///"))&&e.writeAttributeString(void 0,"TargetMode",void 0,"External"),e.writeEndElement()},e.prototype.getNextRelationShipID=function(){return"rId"+ ++this.mRelationShipID},e.prototype.getEFNextRelationShipID=function(){return(++this.efRelationShipId).toString()},e.prototype.serializeGeneralRelations=function(){var e=new sf.fileutils.XmlWriter;this.resetRelationShipID(),e.writeStartElement(void 0,"Relationships",this.rpNamespace),this.serializeRelationShip(e,this.getNextRelationShipID(),this.documentRelType,this.documentPath),e.writeEndElement();var t=new sf.compression.ZipArchiveItem(e.buffer,this.generalRelationPath);this.mArchive.addItem(t)},e.prototype.serializeContentTypes=function(e){var t=new sf.fileutils.XmlWriter;if(t.writeStartElement(void 0,"Types","http://schemas.openxmlformats.org/package/2006/content-types"),this.serializeDefaultContentType(t,"rels",this.relationContentType),this.serializeDefaultContentType(t,"xml",this.xmlContentType),(this.documentImages.length>0||this.externalImages.length>0||this.headerFooterImages.length>0)&&(this.serializeDefaultContentType(t,"png","image/png"),this.serializeDefaultContentType(t,"bmp","image/bmp"),this.serializeDefaultContentType(t,"emf","image/x-emf"),this.serializeDefaultContentType(t,"wmf","image/x-wmf"),this.serializeDefaultContentType(t,"gif","image/gif"),this.serializeDefaultContentType(t,"ico","image/x-icon"),this.serializeDefaultContentType(t,"tif","image/tiff"),this.serializeDefaultContentType(t,"tiff","image/tiff"),this.serializeDefaultContentType(t,"jpeg","image/jpeg"),this.serializeDefaultContentType(t,"jpg","image/jpeg"),this.serializeDefaultContentType(t,"svg","image/svg+xml")),this.serializeOverrideContentType(t,this.documentPath,this.documentContentType),this.serializeOverrideContentType(t,this.numberingPath,this.numberingContentType),this.serializeOverrideContentType(t,this.stylePath,this.stylesContentType),this.serializeOverrideContentType(t,this.settingsPath,this.settingsContentType),this.serializeOverrideContentType(t,this.commentsPath,this.commentsContentType),this.serializeOverrideContentType(t,this.themePath,this.themeContentType),this.serializeOverrideContentType(t,this.commentsExtendedPath,this.commentsExContentType),this.chartCount>0){var i=1;for(this.serializeDefaultContentType(t,"xlsx","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet");i<=this.chartCount;)this.serializeOverrideContentType(t,"word/charts/chart"+i+".xml",this.chartsContentType),this.serializeOverrideContentType(t,"word/charts/colors"+i+".xml",this.chartColorStyleContentType),i++}if(this.customXMLProps.length>0)for(var r=0;r<this.customXMLProps.length;r++)this.serializeOverrideContentType(t,this.customXMLProps[r],this.customXmlContentType);this.serializeHFContentTypes(t),this.SerializeEFContentTypes(t),t.writeEndElement();var n=new sf.compression.ZipArchiveItem(t.buffer,this.contentTypesPath);this.mArchive.addItem(n)},e.prototype.serializeHFContentTypes=function(e){this.serializeHeaderFootersContentType(e,"EvenFooter"),this.serializeHeaderFootersContentType(e,"EvenHeader"),this.serializeHeaderFootersContentType(e,"FirstPageFooter"),this.serializeHeaderFootersContentType(e,"FirstPageHeader"),this.serializeHeaderFootersContentType(e,"OddFooter"),this.serializeHeaderFootersContentType(e,"OddHeader")},e.prototype.serializeHeaderFootersContentType=function(e,t){var i,r;if(this.headersFooters.containsKey(t))for(var n=this.headersFooters.get(t),o=0;o<n.keys.length;o++){var s=n.keys[o];"EvenHeader"===t||"FirstPageHeader"===t||"OddHeader"===t?(r=this.headerPath+s.replace("rId","")+".xml",i=this.headerContentType):(r=this.footerPath+s.replace("rId","")+".xml",i=this.footerContentType),this.serializeOverrideContentType(e,r,i)}},e.prototype.SerializeEFContentTypes=function(e){this.serializeEFContentType(e)},e.prototype.serializeEFContentType=function(e){var t,i;i=this.endnotesPath,t=this.endnoteContentType,this.serializeOverrideContentType(e,i,t),i=this.footnotesPath,t=this.footnoteContentType,this.serializeOverrideContentType(e,i,t)},e.prototype.serializeOverrideContentType=function(e,t,i){e.writeStartElement(void 0,"Override",void 0),e.writeAttributeString(void 0,"PartName",void 0,"/"+t.replace("\\","/")),e.writeAttributeString(void 0,"ContentType",void 0,i),e.writeEndElement()},e.prototype.serializeDefaultContentType=function(e,t,i){e.writeStartElement(void 0,"Default",void 0),e.writeAttributeString(void 0,"Extension",void 0,t),e.writeAttributeString(void 0,"ContentType",void 0,i),e.writeEndElement()},e.prototype.resetRelationShipID=function(){this.mRelationShipID=0},e.prototype.resetExcelRelationShipId=function(){this.eRelationShipId=0},e.prototype.resetChartRelationShipId=function(){this.cRelationShipId=0},e.prototype.close=function(){},e}(),ai=function(){function e(){this.pageContent="",this.curSectionIndex=0,this.inField=!1}return e.prototype.getModuleName=function(){return"TextExport"},e.prototype.save=function(e,t){this.serialize(e);var i=new sf.fileutils.StreamWriter;this.writeInternal(i),i.save(t+".txt")},e.prototype.saveAsBlob=function(e){this.serialize(e);var t=new sf.fileutils.StreamWriter;this.writeInternal(t);var i=t.buffer;return t.destroy(),new Promise((function(e,t){e(i)}))},e.prototype.serialize=function(e){var t=e.owner.sfdtExportModule.write();this.setDocument(t)},e.prototype.setDocument=function(e){this.document=e,this.mSections=e.sections},e.prototype.writeInternal=function(e){var t=void 0,i=this.document.sections.length-1,r=!1;this.updateLastParagraph();for(var n=0;n<=i;n++)t=this.document.sections[n],r=n===i,this.writeBody(e,t.blocks,!1),this.writeNewLine(e),this.writeSectionEnd(t,r);for(var o=0;o<=i;o++)t=this.document.sections[o],this.writeHeadersFooters(e,t)},e.prototype.writeBody=function(e,t,i){for(var r=t.length-1,n=void 0,o=0;o<=r;o++)if((n=t[o]).hasOwnProperty("inlines")){var s=n===this.lastPara;this.writeParagraph(e,n,s,i)}else this.writeTable(e,n)},e.prototype.writeParagraph=function(e,t,i,r){for(var n=0;n<t.inlines.length;n++){var o=t.inlines[n];o.hasOwnProperty("fieldType")?this.inField=0===o.fieldType:o.hasOwnProperty("text")&&!this.inField&&this.writeText(e,o.text)}(!r||t.inlines.length>0)&&(i||this.writeNewLine(e))},e.prototype.writeTable=function(e,t){for(var i=0;i<t.rows.length;i++)for(var r=t.rows[i],n=0;n<r.cells.length;n++){var o=r.cells[n];this.writeBody(e,o.blocks,!1)}},e.prototype.writeHeadersFooters=function(e,t){var i=t.headersFooters;sf.base.isNullOrUndefined(i)||(this.writeHeaderFooter(e,t.headersFooters.header),this.writeHeaderFooter(e,t.headersFooters.footer),this.writeHeaderFooter(e,t.headersFooters.evenFooter),this.writeHeaderFooter(e,t.headersFooters.evenHeader),this.writeHeaderFooter(e,t.headersFooters.firstPageHeader),this.writeHeaderFooter(e,t.headersFooters.firstPageFooter))},e.prototype.writeHeaderFooter=function(e,t){t&&t.blocks&&this.writeBody(e,t.blocks,!0)},e.prototype.writeSectionEnd=function(e,t){this.curSectionIndex++},e.prototype.writeNewLine=function(e){sf.base.isNullOrUndefined(e)?this.pageContent=this.pageContent+" ":e.writeLine("")},e.prototype.writeText=function(e,t){sf.base.isNullOrUndefined(e)?this.pageContent+=t:e.write(t)},e.prototype.updateLastParagraph=function(){var e,t=this.document.sections.length;if(t>0&&(e=this.document.sections[t-1]),!sf.base.isNullOrUndefined(e)){for(var i=[],r=0;r<e.blocks.length;r++)e.blocks[r].hasOwnProperty("inlines")&&i.push(e.blocks[r]);var n=i.length;n>0&&(this.lastPara=i[n-1])}},e.prototype.destroy=function(){this.document=void 0,this.lastPara=void 0,this.mSections=void 0,this.sections=void 0},e}(),li=function(){function e(e){this.startLine=void 0,this.endLine=void 0,this.endOffset=void 0,this.endCell=void 0,this.startColumnIndex=void 0,this.endColumnIndex=void 0,this.lists=void 0,this.document=void 0,this.writeInlineStyles=void 0,this.blockContent=!1,this.startContent=!1,this.multipleLineContent=!1,this.nestedContent=!1,this.editRangeId=-1,this.selectedCommentsId=[],this.selectedRevisionId=[],this.nestedBlockContent=!1,this.nestedBlockEnabled=!1,this.blocks=[],this.contentInline=[],this.isContentControl=!1,this.isBlockClosed=!0,this.images=void 0,this.isExport=!0,this.isPartialExport=!1,this.checkboxOrDropdown=!1,this.copyWithTrackChange=!1,this.documentHelper=e}return Object.defineProperty(e.prototype,"viewer",{get:function(){return this.documentHelper.owner.viewer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"owner",{get:function(){return this.documentHelper.owner},enumerable:!0,configurable:!0}),e.prototype.getModuleName=function(){return"SfdtExport"},e.prototype.clear=function(){this.writeInlineStyles=void 0,this.startLine=void 0,this.endLine=void 0,this.lists=void 0,this.document=void 0,this.endCell=void 0,this.startColumnIndex=void 0,this.endColumnIndex=void 0,this.selectedCommentsId=[],this.selectedRevisionId=[],this.startBlock=void 0,this.endBlock=void 0,this.isPartialExport=!1,this.images=void 0},e.prototype.serialize=function(){return JSON.stringify(this.write())},e.prototype.saveAsBlob=function(e){var t=new Blob([this.serialize()],{type:"text/plain"});return new Promise((function(e,i){e(t)}))},e.prototype.updateEditRangeId=function(){for(var e=-1,t=0;t<this.documentHelper.editRanges.keys.length;t++)for(var i=this.documentHelper.editRanges.keys,r=0;r<i[t].length;r++)for(var n=this.documentHelper.editRanges.get(i[t]),o=0;o<n.length;o++)e++,n[o].editRangeId=e,n[o].editRangeEnd.editRangeId=e},e.prototype.write=function(e,t,i,r,n,o){if(n&&(this.writeInlineStyles=!0),this.Initialize(),this.updateEditRangeId(),e instanceof ue&&i instanceof ue){this.isExport=!1,sf.base.isNullOrUndefined(o)||(this.isExport=o);var s=e.paragraph,a=i.paragraph;this.isPartialExport&&(this.startBlock=this.getParentBlock(s),this.endBlock=this.getParentBlock(a));var l=s.associatedCell,h=a.associatedCell,d=(s.bodyWidget,this.createSection(e.paragraph.bodyWidget));this.document.sections.push(d);var c=l,p=h;l instanceof pe&&(c=this.getParentCell(c)),h instanceof pe&&(p=this.getParentCell(p));var u=c instanceof pe&&p instanceof pe&&c.equals(p);if(u||sf.base.isNullOrUndefined(h))this.startLine=e,this.endLine=i,this.endOffset=r;else if(l instanceof pe){var g=l.getContainerTable(),f=h.getContainerTable();g.tableFormat===f.tableFormat&&(this.endCell=h,this.endCell.ownerTable!==l.ownerTable&&l.ownerTable.associatedCell&&l.ownerTable.associatedCell.ownerTable===this.endCell.ownerTable&&0===l.ownerTable.associatedCell.childWidgets.indexOf(l.ownerTable)&&(l=l.ownerTable.associatedCell),this.endColumnIndex=this.endCell.columnIndex+this.endCell.cellFormat.columnSpan,this.startColumnIndex=l.columnIndex)}else this.endCell=h;var m=void 0;if(u&&!this.isPartialExport||sf.base.isNullOrUndefined(l)){var y=this.createParagraph(e.paragraph);d.blocks.push(y);var v=e.paragraph;for(m=this.writeParagraph(e.paragraph,y,d.blocks,e.indexInOwner,t),this.isPartialExport&&(m=this.getNextBlock(m,v),d=this.document.sections[this.document.sections.length-1]);m;)v=m,m=this.writeBlock(m,0,d.blocks),this.isPartialExport&&sf.base.isNullOrUndefined(m)&&(m=this.getNextBlock(m,v),d=this.document.sections[this.document.sections.length-1])}else{if(sf.base.isNullOrUndefined(h)&&l.ownerTable.associatedCell){var b=(g=l.getContainerTable()).childWidgets[g.childWidgets.length-1],w=b.childWidgets[b.childWidgets.length-1];if(w.ownerTable!==l.ownerTable&&l.ownerTable.associatedCell&&0===l.ownerTable.associatedCell.childWidgets.indexOf(l.ownerTable))for(;l.ownerTable!==w.ownerTable;)l=l.ownerTable.associatedCell;this.endColumnIndex=w.columnIndex+w.cellFormat.columnSpan,this.startColumnIndex=l.columnIndex}var x=this.createTable(l.ownerTable);d.blocks.push(x);v=l.ownerTable;for(m=this.writeTable(l.ownerTable,x,l.ownerRow.indexInOwner,d.blocks),this.isPartialExport&&(m=this.getNextBlock(m,v),d=this.document.sections[this.document.sections.length-1]);m;)v=m,m=this.writeBlock(m,0,d.blocks),this.isPartialExport&&(m=this.getNextBlock(m,v),d=this.document.sections[this.document.sections.length-1])}}else if(this.isExport=!0,this.documentHelper.pages.length>0){var M=this.documentHelper.pages[0];this.writePage(M)}this.writeStyles(this.documentHelper),this.writeLists(this.documentHelper),this.writeComments(this.documentHelper),this.writeRevisions(this.documentHelper),this.writeCustomXml(this.documentHelper),this.footnotes(this.documentHelper),this.endnotes(this.documentHelper),this.isExport&&(this.document.images=this.images);var N=this.document;return this.clear(),N},e.prototype.getNextBlock=function(e,t){if(sf.base.isNullOrUndefined(e)&&this.isPartialExport&&this.endBlock&&!this.endBlock.equals(t))if((e=t.getSplitWidgets().pop().nextRenderedWidget)&&t.bodyWidget.index!==e.bodyWidget.index){var i=this.createSection(e.bodyWidget);this.document.sections.push(i)}else e=void 0;return e},e.prototype.Initialize=function(){this.lists=[],this.document={},this.document.sections=[],this.document.characterFormat=this.writeCharacterFormat(this.documentHelper.characterFormat),this.document.paragraphFormat=this.writeParagraphFormat(this.documentHelper.paragraphFormat),this.document.themeFontLanguages=this.writeCharacterFormat(this.documentHelper.themeFontLanguage),this.document.defaultTabWidth=this.documentHelper.defaultTabWidth,this.document.trackChanges=this.owner.enableTrackChanges,this.document.enforcement=this.documentHelper.isDocumentProtected,this.document.hashValue=this.documentHelper.hashValue,this.document.saltValue=this.documentHelper.saltValue,this.document.formatting=this.documentHelper.restrictFormatting,this.document.protectionType=this.documentHelper.protectionType,this.document.dontUseHTMLParagraphAutoSpacing=this.documentHelper.dontUseHtmlParagraphAutoSpacing,this.document.formFieldShading=this.documentHelper.owner.documentEditorSettings.formFieldSettings.applyShading,this.document.compatibilityMode=this.documentHelper.compatibilityMode,this.documentHelper.hasThemes&&(this.document.themes=this.writeThemes(this.documentHelper.themes))},e.prototype.writePage=function(e){if(e.bodyWidgets.length>0){var t=e.bodyWidgets[0];do{t=this.writeBodyWidget(t,0)}while(!sf.base.isNullOrUndefined(t))}return this.document},e.prototype.writeBodyWidget=function(e,t){if(e instanceof ne){var i=this.createSection(e);this.document.sections.push(i),this.writeHeaderFooters(this.documentHelper.headersFooters[e.index],i);var r=e.childWidgets[t];do{r=this.writeBlock(r,0,i.blocks)}while(r);var n=e;do{e=n,n=n.nextRenderedWidget,!sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(e.page.nextPage)||sf.base.isNullOrUndefined(e.page.nextPage)||(n=e.page.nextPage.bodyWidgets[0])}while(n instanceof ne&&n.index===e.index);return n}},e.prototype.writeHeaderFooters=function(e,t){sf.base.isNullOrUndefined(e)||(t.headersFooters.header=this.writeHeaderFooter(e[0]),t.headersFooters.footer=this.writeHeaderFooter(e[1]),t.headersFooters.evenHeader=this.writeHeaderFooter(e[2]),t.headersFooters.evenFooter=this.writeHeaderFooter(e[3]),t.headersFooters.firstPageHeader=this.writeHeaderFooter(e[4]),t.headersFooters.firstPageFooter=this.writeHeaderFooter(e[5]))},e.prototype.writeHeaderFooter=function(e){if(!sf.base.isNullOrUndefined(e)&&!e.isEmpty){var t={};if(e&&e.childWidgets&&e.childWidgets.length>0){t.blocks=[];var i=e.firstChild;do{i=this.writeBlock(i,0,t.blocks)}while(i)}return t}},e.prototype.createSection=function(e){var t={sectionFormat:{}};if(t.sectionFormat.pageWidth=e.sectionFormat.pageWidth,t.sectionFormat.pageHeight=e.sectionFormat.pageHeight,t.sectionFormat.leftMargin=e.sectionFormat.leftMargin,t.sectionFormat.rightMargin=e.sectionFormat.rightMargin,t.sectionFormat.topMargin=e.sectionFormat.topMargin,t.sectionFormat.bottomMargin=e.sectionFormat.bottomMargin,t.sectionFormat.differentFirstPage=e.sectionFormat.differentFirstPage,t.sectionFormat.differentOddAndEvenPages=e.sectionFormat.differentOddAndEvenPages,t.sectionFormat.headerDistance=e.sectionFormat.headerDistance,t.sectionFormat.footerDistance=e.sectionFormat.footerDistance,t.sectionFormat.bidi=e.sectionFormat.bidi,sf.base.isNullOrUndefined(e.sectionFormat.breakCode)||(t.sectionFormat.breakCode=e.sectionFormat.breakCode),e.sectionFormat.restartPageNumbering&&(t.sectionFormat.restartPageNumbering=e.sectionFormat.restartPageNumbering,t.sectionFormat.pageStartingNumber=e.sectionFormat.pageStartingNumber),sf.base.isNullOrUndefined(e.page.endnoteWidget||e.page.footnoteWidget)||(t.sectionFormat.endnoteNumberFormat=e.sectionFormat.endnoteNumberFormat,t.sectionFormat.footNoteNumberFormat=e.sectionFormat.footNoteNumberFormat,t.sectionFormat.restartIndexForFootnotes=e.sectionFormat.restartIndexForFootnotes,t.sectionFormat.restartIndexForEndnotes=e.sectionFormat.restartIndexForEndnotes,t.sectionFormat.initialFootNoteNumber=e.sectionFormat.initialFootNoteNumber,t.sectionFormat.initialEndNoteNumber=e.sectionFormat.initialEndNoteNumber),sf.base.isNullOrUndefined(e.sectionFormat.pageNumberStyle)||(t.sectionFormat.pageNumberStyle=e.sectionFormat.pageNumberStyle),!sf.base.isNullOrUndefined(e.sectionFormat.columns)&&!sf.base.isNullOrUndefined(e.sectionFormat.numberOfColumns&&e.sectionFormat.numberOfColumns>1)){var i=e.sectionFormat.columns;t.sectionFormat.numberOfColumns=e.sectionFormat.numberOfColumns,t.sectionFormat.equalWidth=e.sectionFormat.equalWidth,t.sectionFormat.lineBetweenColumns=e.sectionFormat.lineBetweenColumns,t.sectionFormat.columns=[];for(var r=0;r<i.length;r++){var n={};n.width=x.convertPixelToPoint(i[r].width),n.space=x.convertPixelToPoint(i[r].space),t.sectionFormat.columns.push(n)}}return t.blocks=[],t.headersFooters={},t},e.prototype.writeBlock=function(e,t,i){if(e instanceof se){if(e instanceof le){if(e.hasOwnProperty("contentControlProperties")){var r=this.blockContentControl(e);return this.blockContent=!1,sf.base.isNullOrUndefined(r)||!this.isBlockClosed&&this.nestedBlockContent||(this.nestedBlockEnabled=!1,i.push(r),this.blocks=[]),this.nextBlock}var n=this.createParagraph(e);return i.push(n),this.writeParagraph(e,n,i)}var o=e;if(o.hasOwnProperty("contentControlProperties")&&"BuildingBlockGallery"!==o.contentControlProperties.type){r=this.tableContentControl(o);return!sf.base.isNullOrUndefined(r)&&this.isBlockClosed&&i.push(r),this.nextBlock}var s=this.createTable(o);return i.push(s),this.writeTable(o,s,0,i)}},e.prototype.writeParagraphs=function(e){var t=this.blocks,i=e.childWidgets[0],r=i.children[0],n=i.children[1];if((r instanceof je||n instanceof je)&&(r=i.children[2],n=i.children[3]),this.nestedBlockEnabled&&(t=[]),r instanceof Oe&&n instanceof Oe&&!this.nestedBlockContent||this.blockContent&&r instanceof Oe&&!this.nestedBlockContent){var o=!1;if(n instanceof Oe&&"Block"===n.contentControlWidgetType&&(o=!0),o||this.blockContent&&r instanceof Oe&&!this.nestedBlockContent&&0===r.type&&n instanceof Oe&&"Block"===r.contentControlWidgetType){this.nestedBlockContent=!0,this.nestedBlockEnabled=!0;var s=this.blockContentControl(e);sf.base.isNullOrUndefined(s)||this.blocks.push(s)}else{var a=this.createParagraph(e);t.push(a),this.nextBlock=this.writeParagraph(e,a,t)}}else{a=this.createParagraph(e);t.push(a),this.nextBlock=this.writeParagraph(e,a,t)}return!this.nestedBlockContent&&this.nestedBlockEnabled&&(this.nestedBlockEnabled=!1),t},e.prototype.contentControlProperty=function(e){var t={};return t.lockContentControl=e.lockContentControl,t.lockContents=e.lockContents,t.tag=e.tag,t.color=e.color,t.title=e.title,sf.base.isNullOrUndefined(e.appearance)||(t.appearance=e.appearance),t.type=e.type,t.hasPlaceHolderText=e.hasPlaceHolderText,t.multiline=e.multiline,t.isTemporary=e.isTemporary,sf.base.isNullOrUndefined(e.isChecked)||(t.isChecked=e.isChecked),sf.base.isNullOrUndefined(e.uncheckedState)||(t.uncheckedState=this.tounCheckedState(e.uncheckedState)),sf.base.isNullOrUndefined(e.checkedState)||(t.checkedState=this.toCheckedState(e.checkedState)),sf.base.isNullOrUndefined(e.dateCalendarType)||(t.dateCalendarType=e.dateCalendarType),sf.base.isNullOrUndefined(e.dateStorageFormat)||(t.dateStorageFormat=e.dateStorageFormat),sf.base.isNullOrUndefined(e.dateDisplayLocale)||(t.dateDisplayLocale=e.dateDisplayLocale),sf.base.isNullOrUndefined(e.dateDisplayFormat)||(t.dateDisplayFormat=e.dateDisplayFormat),sf.base.isNullOrUndefined(e.xmlMapping)||(t.xmlMapping=e.xmlMapping),sf.base.isNullOrUndefined(e.characterFormat)||(t.characterFormat=this.writeCharacterFormat(e.characterFormat)),t.contentControlListItems=e.contentControlListItems,t},e.prototype.tounCheckedState=function(e){var t={};return t.font=e.font,t.value=e.value,t},e.prototype.toCheckedState=function(e){var t={};return t.font=e.font,t.value=e.value,t},e.prototype.blockContentControl=function(e){var t={};if(0!==e.childWidgets.length){if(t.blocks=this.writeParagraphs(e),!sf.base.isNullOrUndefined(this.nextBlock)){if(e.contentControlProperties===this.nextBlock.contentControlProperties)return this.isBlockClosed=!1,this.nestedBlockContent=!0,this.blocks=t.blocks;this.isBlockClosed=!0}if(!sf.base.isNullOrUndefined(t.blocks)){var i=e.childWidgets[0],r=i.children[0],n=i.children[1];if((r instanceof je||n instanceof je)&&(r=i.children[2],n=i.children[3]),r instanceof Oe&&n instanceof Oe&&!this.nestedBlockContent||this.blockContent&&r instanceof Oe&&!this.nestedBlockContent){if(!(n instanceof Oe))return t.contentControlProperties=this.contentControlProperty(r.contentControlProperties),t;"Block"===n.contentControlWidgetType?t.contentControlProperties=this.contentControlProperty(n.contentControlProperties):t.contentControlProperties=this.contentControlProperty(e.contentControlProperties)}else t.contentControlProperties=this.contentControlProperty(e.contentControlProperties);return t}}else this.nextBlock=e.nextWidget},e.prototype.tableContentControl=function(e){var t={};if(t.blocks=this.tableContentControls(e),!sf.base.isNullOrUndefined(this.nextBlock)){if(e.contentControlProperties===this.nextBlock.contentControlProperties)return this.isBlockClosed=!1,this.blocks=t.blocks;this.isBlockClosed=!0}return t.contentControlProperties=this.contentControlProperty(e.contentControlProperties),t},e.prototype.tableContentControls=function(e){var t=[];this.isBlockClosed||(t=this.blocks);var i=this.createTable(e);return t.push(i),this.nextBlock=this.writeTable(e,i,0,t),t},e.prototype.writeParagraph=function(e,t,i,r,n){sf.base.isNullOrUndefined(r)&&(r=0),sf.base.isNullOrUndefined(n)&&(n=0);for(var o=e;o instanceof le;){if(this.writeLines(o,r,n,t.inlines))return;r=0,n=0,o=(e=o).nextSplitWidget}return o=e.nextRenderedWidget,sf.base.isNullOrUndefined(o)&&e.containerWidget instanceof ne&&!sf.base.isNullOrUndefined(e.containerWidget.page.nextPage)&&!sf.base.isNullOrUndefined(e.containerWidget.page.nextPage.bodyWidgets)&&(o=e.containerWidget.page.nextPage.bodyWidgets[0].childWidgets[0]),this.isExport?o instanceof se&&e.containerWidget.index===o.containerWidget.index?o:void 0:o},e.prototype.writeInlines=function(e,t,i){this.contentInline=[];for(var r=t,n=!1,o=0;o<r.children.length;o++){var s=r.children[o];if(this.isExport&&this.checkboxOrDropdown){if(n&&s instanceof we)continue;s instanceof fe&&2===s.fieldType&&(n=!0)}if(!(s instanceof je))if(s instanceof Me)i.push(this.writeInlinesFootNote(e,s,t,i));else{if(s instanceof Oe||this.startContent||this.blockContent)this.writeInlinesContentControl(s,t,i,o);else{var a=this.writeInline(s);sf.base.isNullOrUndefined(a)||i.push(a)}this.isExport&&s instanceof fe&&1===s.fieldType&&(n=!1,this.checkboxOrDropdown=!1)}}},e.prototype.inlineContentControl=function(e,t,i){var r={},n=[];if(sf.base.isNullOrUndefined(i))if(this.nestedContent){r.inlines=this.inlineContentControls(e,void 0,n);o=this.nestedContentProperty(t,r);sf.base.isNullOrUndefined(o)&&!this.multipleLineContent||(this.contentInline.push(r),n=[])}else r.inlines=this.inlineContentControls(e,this.contentInline);else if(this.nestedContent){i=i[i.length-1].inlines,r=this.inlineContentControls(e,i[i.length-1].inlines);var o=this.nestedContentProperty(t,i[i.length-1]);sf.base.isNullOrUndefined(o)||(this.contentInline.push(r),n=[])}else this.inlineContentControls(e,i[i.length-1].inlines);return t instanceof Oe&&1===t.type&&!this.nestedContent?this.multipleLineContent?(i[i.length-1].contentControlProperties=this.contentControlProperty(t.contentControlProperties),void(this.multipleLineContent=!1)):(r.contentControlProperties=this.contentControlProperty(t.contentControlProperties),r):this.startContent?(this.multipleLineContent=!0,r):void 0},e.prototype.nestedContentProperty=function(e,t,i){if(sf.base.isNullOrUndefined(e)){if(this.startContent)return this.multipleLineContent=!0,t}else{if(1===e.type)return t.contentControlProperties=this.contentControlProperty(e.contentControlProperties),t;if(this.startContent)return this.multipleLineContent=!0,t}},e.prototype.inlineContentControls=function(e,t,i){var r=this.writeInline(e);return sf.base.isNullOrUndefined(i)?(t.push(r),t):(i.push(r),i)},e.prototype.writeInline=function(e){var t={};if(e.removedIds.length>0)for(var i=0;i<e.removedIds.length;i++)e.revisions[i]=this.documentHelper.revisionsInternal.get(e.removedIds[i]);if(t.characterFormat=this.writeCharacterFormat(e.characterFormat),e instanceof fe)t.fieldType=e.fieldType,0===e.fieldType&&(t.hasFieldEnd=!0,e.formFieldData&&(t.formFieldData={},t.formFieldData.name=e.formFieldData.name,t.formFieldData.enabled=e.formFieldData.enabled,t.formFieldData.helpText=e.formFieldData.helpText,t.formFieldData.statusText=e.formFieldData.statusText,e.formFieldData instanceof ye?(t.formFieldData.textInput={},t.formFieldData.textInput.type=e.formFieldData.type,t.formFieldData.textInput.maxLength=e.formFieldData.maxLength,t.formFieldData.textInput.defaultValue=e.formFieldData.defaultValue,t.formFieldData.textInput.format=e.formFieldData.format):e.formFieldData instanceof ve?(t.formFieldData.checkBox={},this.checkboxOrDropdown=!0,t.formFieldData.checkBox.sizeType=e.formFieldData.sizeType,t.formFieldData.checkBox.size=e.formFieldData.size,t.formFieldData.checkBox.defaultValue=e.formFieldData.defaultValue,t.formFieldData.checkBox.checked=e.formFieldData.checked):(t.formFieldData.dropDownList={},this.checkboxOrDropdown=!0,t.formFieldData.dropDownList.dropDownItems=e.formFieldData.dropdownItems,t.formFieldData.dropDownList.selectedIndex=e.formFieldData.selectedIndex))),e.fieldCodeType&&""!==e.fieldCodeType&&(t.fieldCodeType=e.fieldCodeType);else if(e instanceof Be)this.writeChart(e,t);else if(e instanceof Re)t.imageString=this.getImageString(e.imageString),t.metaFileImageString=e.metaFileImageString,t.isMetaFile=e.isMetaFile,t.isCompressed=e.isCompressed,t.width=x.convertPixelToPoint(e.width),t.height=x.convertPixelToPoint(e.height),t.iscrop=e.isCrop,e.isCrop&&(t.bottom=e.bottom,t.right=e.right,t.left=e.left,t.top=e.top,t.getimagewidth=e.cropWidthScale,t.getimageheight=e.cropHeightScale),t.name=e.name,t.alternativeText=e.alternativeText,t.title=e.title,t.visible=e.visible,t.widthScale=e.widthScale,t.heightScale=e.heightScale,t.verticalPosition=x.convertPixelToPoint(e.verticalPosition),t.verticalOrigin=e.verticalOrigin,t.verticalAlignment=e.verticalAlignment,t.horizontalPosition=x.convertPixelToPoint(e.horizontalPosition),t.horizontalOrigin=e.horizontalOrigin,t.horizontalAlignment=e.horizontalAlignment,t.allowOverlap=e.allowOverlap,t.textWrappingStyle=e.textWrappingStyle,t.textWrappingType=e.textWrappingType,t.distanceBottom=x.convertPixelToPoint(e.distanceBottom),t.distanceLeft=x.convertPixelToPoint(e.distanceLeft),t.distanceRight=x.convertPixelToPoint(e.distanceRight),t.distanceTop=x.convertPixelToPoint(e.distanceTop),t.layoutInCell=e.layoutInCell,t.zOrderPosition=e.zOrderPosition;else if(e instanceof Ce)t.bookmarkType=e.bookmarkType,t.name=e.name;else if(e instanceof we)if(-1!==e.text.indexOf(String.fromCharCode(30)))t.text=e.text.replace(/\u001e/g,"-");else if(-1!==e.text.indexOf(String.fromCharCode(31)))t.text=e.text.replace(/\u001f/g,"");else if(0!==e.revisions.length)if(this.isExport||!this.owner.enableTrackChanges||this.isPartialExport)t.text=e.text;else{this.copyWithTrackChange=!0;for(var r=0;r<e.revisions.length;r++){var n=e.revisions[r];-1===this.selectedRevisionId.indexOf(n.revisionID)&&this.selectedRevisionId.push(n.revisionID),"Deletion"!==e.revisions[r].revisionType&&(t.text=e.text)}}else t.text=e.text;else e instanceof He?(""!==e.user&&(t.user=e.user),t.group=e.group,t.columnFirst=e.columnFirst,t.columnLast=e.columnLast,t.editRangeId=e.editRangeId.toString()):e instanceof Ue?(t.editableRangeStart={user:e.editRangeStart.user,group:e.editRangeStart.group,columnFirst:e.editRangeStart.columnFirst,columnLast:e.editRangeStart.columnLast},t.editRangeId=e.editRangeId.toString()):e instanceof nt?(this.isExport||0!==e.commentType||this.selectedCommentsId.push(e.commentId),t.commentCharacterType=e.commentType,t.commentId=e.commentId):e instanceof Ee?this.writeShape(e,t):t=void 0;if(e.revisions.length>0&&(this.isExport||!this.isExport&&!this.owner.enableTrackChanges)){t.revisionIds=[];for(r=0;r<e.revisions.length;r++)-1===this.selectedRevisionId.indexOf(e.revisions[r].revisionID)&&this.selectedRevisionId.push(e.revisions[r].revisionID),t.revisionIds.push(e.revisions[r].revisionID)}return t},e.prototype.getImageString=function(e){if(this.isExport){sf.base.isNullOrUndefined(this.images)&&(this.images={});for(var t=Object.keys(this.images),i=t.length,r=i.toString(),n=!0,o=0;o<i;o++){var s=this.images[t[o].toString()];if(s.length===e.length&&s===e){r=t[o].toString(),n=!1;break}}return n&&(this.images[r.toString()]=e),r.toString()}return e},e.prototype.writeShape=function(e,t){if(t.shapeId=e.shapeId,t.name=e.name,t.alternativeText=e.alternativeText,t.title=e.title,t.visible=e.visible,t.width=x.convertPixelToPoint(e.width),t.height=x.convertPixelToPoint(e.height),t.widthScale=e.widthScale,t.heightScale=e.heightScale,t.verticalPosition=x.convertPixelToPoint(e.verticalPosition),t.verticalOrigin=e.verticalOrigin,t.verticalAlignment=e.verticalAlignment,t.verticalRelativePercent=e.verticalRelativePercent,t.horizontalPosition=x.convertPixelToPoint(e.horizontalPosition),t.horizontalOrigin=e.horizontalOrigin,t.horizontalAlignment=e.horizontalAlignment,t.horizontalRelativePercent=e.horizontalRelativePercent,t.zOrderPosition=e.zOrderPosition,t.allowOverlap=e.allowOverlap,t.textWrappingStyle=e.textWrappingStyle,t.textWrappingType=e.textWrappingType,t.distanceBottom=x.convertPixelToPoint(e.distanceBottom),t.distanceLeft=x.convertPixelToPoint(e.distanceLeft),t.distanceRight=x.convertPixelToPoint(e.distanceRight),t.distanceTop=x.convertPixelToPoint(e.distanceTop),t.layoutInCell=e.layoutInCell,t.lockAnchor=e.lockAnchor,t.autoShapeType=e.autoShapeType,e.fillFormat&&(t.fillFormat={},t.fillFormat.color=e.fillFormat.color,t.fillFormat.fill=e.fillFormat.fill),e.lineFormat&&(t.lineFormat={},t.lineFormat.lineFormatType=e.lineFormat.lineFormatType,t.lineFormat.color=e.lineFormat.color,t.lineFormat.weight=e.lineFormat.weight,t.lineFormat.lineStyle=e.lineFormat.dashStyle,t.lineFormat.line=e.lineFormat.line),e.textFrame){t.textFrame={},t.textFrame.textVerticalAlignment=e.textFrame.textVerticalAlignment,t.textFrame.leftMargin=x.convertPixelToPoint(e.textFrame.marginLeft),t.textFrame.rightMargin=x.convertPixelToPoint(e.textFrame.marginRight),t.textFrame.topMargin=x.convertPixelToPoint(e.textFrame.marginTop),t.textFrame.bottomMargin=x.convertPixelToPoint(e.textFrame.marginBottom),t.textFrame.blocks=[];for(var i=0;i<e.textFrame.childWidgets.length;i++){var r=e.textFrame.childWidgets[i];this.writeBlock(r,0,t.textFrame.blocks)}}},e.prototype.writeChart=function(e,t){t.chartLegend={},t.chartTitleArea={},t.chartArea={},t.plotArea={},t.chartCategory=[],t.chartSeries=[],t.chartPrimaryCategoryAxis={},t.chartPrimaryValueAxis={},this.writeChartTitleArea(e.chartTitleArea,t.chartTitleArea),this.writeChartArea(e.chartArea,t.chartArea),this.writeChartArea(e.chartPlotArea,t.plotArea),this.writeChartCategory(e,t.chartCategory),this.createChartSeries(e,t.chartSeries),this.writeChartLegend(e.chartLegend,t.chartLegend),this.writeChartCategoryAxis(e.chartPrimaryCategoryAxis,t.chartPrimaryCategoryAxis),this.writeChartCategoryAxis(e.chartPrimaryValueAxis,t.chartPrimaryValueAxis),void 0!==e.chartDataTable.showSeriesKeys&&(t.chartDataTable={},this.writeChartDataTable(e.chartDataTable,t.chartDataTable)),t.chartTitle=e.title,t.chartType=e.type,t.gapWidth=e.chartGapWidth,t.overlap=e.chartOverlap,t.height=x.convertPixelToPoint(e.height),t.width=x.convertPixelToPoint(e.width)},e.prototype.writeChartTitleArea=function(e,t){t.fontName=e.chartfontName,t.fontSize=e.chartFontSize,t.layout={},t.dataFormat=this.writeChartDataFormat(e.dataFormat),this.writeChartLayout(e.layout,t.layout)},e.prototype.writeChartDataFormat=function(e){var t={fill:{},line:{}};return sf.base.isNullOrUndefined(e.fill.color)||(e.fill.color.length>6?t.fill.foreColor=e.fill.color.substring(2):t.fill.foreColor=e.fill.color),t.fill.rgb=e.fill.rgb,t.line.color=e.line.color,t.line.rgb=e.line.rgb,t},e.prototype.writeChartLayout=function(e,t){t.layoutX=e.chartLayoutLeft,t.layoutY=e.chartLayoutTop},e.prototype.writeChartArea=function(e,t){t.foreColor=e.chartForeColor},e.prototype.writeChartLegend=function(e,t){t.position=e.chartLegendPostion,t.chartTitleArea={},this.writeChartTitleArea(e.chartTitleArea,t.chartTitleArea)},e.prototype.writeChartCategoryAxis=function(e,t){t.chartTitle=e.categoryAxisTitle,t.chartTitleArea={},this.writeChartTitleArea(e.chartTitleArea,t.chartTitleArea),t.categoryType=e.categoryAxisType,t.fontSize=e.axisFontSize,t.fontName=e.axisFontName,t.numberFormat=e.categoryNumberFormat,t.maximumValue=e.max,t.minimumValue=e.min,t.majorUnit=e.interval,t.hasMajorGridLines=e.majorGridLines,t.hasMinorGridLines=e.minorGridLines,t.majorTickMark=e.majorTick,t.minorTickMark=e.minorTick,t.tickLabelPosition=e.tickPosition},e.prototype.writeChartDataTable=function(e,t){t.showSeriesKeys=e.showSeriesKeys,t.hasHorzBorder=e.hasHorzBorder,t.hasVertBorder=e.hasVertBorder,t.hasBorders=e.hasBorders},e.prototype.writeChartCategory=function(e,t){var i=e.chartCategory;t.chartData=[];for(var r=0;r<i.length;r++){var n=i[r],o=this.createChartCategory(n,e.chartType);t.push(o)}},e.prototype.createChartCategory=function(e,t){var i={chartData:[]};return this.writeChartData(e,i.chartData,t),i.categoryXName=e.categoryXName,i},e.prototype.writeChartData=function(e,t,i){for(var r=e.chartData,n=0;n<r.length;n++){var o=r[n],s=this.createChartData(o,i);t.push(s)}},e.prototype.createChartData=function(e,t){var i={};return i.yValue=e.yValue,"Bubble"===t&&(i.size=e.size),i},e.prototype.createChartSeries=function(e,t){for(var i=e.chartSeries,r=e.chartType,n=0;n<i.length;n++){var o=i[n],s=this.writeChartSeries(o,r);t.push(s)}},e.prototype.writeChartSeries=function(e,t){var i="Pie"===t||"Doughnut"===t,r={},n={},o=e.errorBar;if(r.dataPoints=[],r.seriesName=e.seriesName,i&&(sf.base.isNullOrUndefined(e.firstSliceAngle)||(r.firstSliceAngle=e.firstSliceAngle),"Doughnut"===t&&(r.holeSize=e.doughnutHoleSize)),!sf.base.isNullOrUndefined(e.dataLabels.labelPosition)){var s=this.writeChartDataLabels(e.dataLabels);r.dataLabel=s}if(!sf.base.isNullOrUndefined(e.seriesFormat.markerStyle)){var a={},l=e.seriesFormat;a.markerStyle=l.markerStyle,a.markerSize=l.numberValue,a.markerColor=l.markerColor,r.seriesFormat=a}if(sf.base.isNullOrUndefined(o.type)||(n.type=o.type,n.direction=o.direction,n.endStyle=o.endStyle,n.numberValue=o.numberValue,r.errorBar=o),e.trendLines.length>0){r.trendLines=[];for(var h=0;h<e.trendLines.length;h++){var d=this.writeChartTrendLines(e.trendLines[h]);r.trendLines.push(d)}}for(h=0;h<e.chartDataFormat.length;h++){l=this.writeChartDataFormat(e.chartDataFormat[h]);r.dataPoints.push(l)}return r},e.prototype.writeChartDataLabels=function(e){var t={};return t.position=e.position,t.fontName=e.fontName,t.fontColor=x.convertArgbToRgb(e.fontColor),t.fontSize=e.fontSize,t.isLegendKey=e.isLegendKey,t.isBubbleSize=e.isBubbleSize,t.isCategoryName=e.isCategoryName,t.isSeriesName=e.isSeriesName,t.isValue=e.isValue,t.isPercentage=e.isPercentage,t.isLeaderLines=e.isLeaderLines,t},e.prototype.writeChartTrendLines=function(e){var t={};return t.name=e.trendLineName,t.type=e.trendLineType,t.forward=e.forwardValue,t.backward=e.backwardValue,t.intercept=e.interceptValue,t.isDisplayEquation=e.isDisplayEquation,t.isDisplayRSquared=e.isDisplayRSquared,t},e.prototype.writeLines=function(e,t,i,r){for(var n=t,o=this.endLine instanceof ue&&this.endLine.paragraph===e,s=o?this.endLine.indexInOwner:e.childWidgets.length-1,a=n;a<=s;a++){var l=e.childWidgets[a];this.endLine===l||t===a&&0!==i?this.writeLine(l,this.startLine!==this.endLine&&l!==this.startLine?0:i,r):this.writeInlines(e,l,r)}return o},e.prototype.writeLine=function(e,t,i){this.contentInline=[];for(var r=!1,n=!1,o=e===this.endLine,s=e,a=!1,l=!1,h=0,d=0;d<s.children.length;d++){var c=s.children[d];if(!(c instanceof je)){var p=void 0;if(a=(h+=c.length)>t,c instanceof Oe&&(a||(r=0===c.type),n=!0),c instanceof we&&c.hasOwnProperty("contentControlProperties")&&a&&!n&&(r=!0),c instanceof Oe&&(r&&1===c.type&&(r=!1),n&&1===c.type&&(n=!1)),l=o&&h>=this.endOffset,a&&!r)if(c instanceof Oe||this.startContent||this.blockContent){if(l){this.startContent=!1;break}this.writeInlinesContentControl(c,e,i,d)}else{if(p=this.writeInline(c),i[i.length]=p,h>t||l){if(p.hasOwnProperty("text")){var u=h-c.length,g=t-u,f=l?this.endOffset-u:c.length;p.text=p.text.substring(g,f)}t=-1}if(l)break}}}},e.prototype.writeInlinesFootNote=function(e,t,i,r){var n={};n.footnoteType=t.footnoteType,n.characterFormat={},n.characterFormat=this.writeCharacterFormat(t.characterFormat),n.blocks=[];for(var o=0;o<t.bodyWidget.childWidgets.length;o++)this.writeBlock(t.bodyWidget.childWidgets[o],0,n.blocks);return n.symbolCode=t.symbolCode,n.symbolFontName=t.symbolFontName,n.customMarker=t.customMarker,n},e.prototype.writeInlinesContentControl=function(e,t,i,r){if(e instanceof Oe&&"Block"===e.contentControlWidgetType)return this.isBlockClosed=!1,this.blockContent&&0===e.type?(this.nestedBlockContent=!0,!0):this.nestedBlockContent&&1===e.type?(this.nestedBlockContent=!1,!0):(this.blockContent=0===e.type,t.children[r-1]instanceof Oe&&"Block"===t.children[r-1].contentControlWidgetType&&(this.blockContent=!0),this.blockContent||(this.isBlockClosed=!0),!0);if(e instanceof Oe){if(this.startContent&&0===e.type)return this.nestedContent=!0,!0;if(this.startContent&&this.nestedContent){if((s={}).inlines=this.contentInline,this.contentInline.length>0){var n=this.nestedContentProperty(t.children[r+1],s);i.push(n),this.contentInline=[]}return this.multipleLineContent&&(s=i[i.length-1],this.nestedContentProperty(t.children[r+1],s),this.multipleLineContent=!1),this.nestedContent=!1,!0}return this.contentType=e.contentControlWidgetType,this.startContent=0===e.type,!0}if(this.startContent&&"Inline"===this.contentType)if(this.multipleLineContent)this.inlineContentControl(e,t.children[r+1],i),this.contentInline=[];else{var o=this.inlineContentControl(e,t.children[r+1]);if(!sf.base.isNullOrUndefined(o)){if(!this.nestedContent||!this.multipleLineContent)return i.push(o),this.contentInline=[],!1;(s={}).inlines=this.contentInline,i.push(s),this.contentInline=[]}}else{var s=this.writeInline(e);sf.base.isNullOrUndefined(s)||i.push(s)}},e.prototype.createParagraph=function(e){var t={},i=!1;if(!this.documentHelper.selection||this.documentHelper.selection.isEmpty||this.isExport)i=!0;else{var r=this.documentHelper.selection.end;this.documentHelper.selection.isForward||(r=this.documentHelper.selection.start);var n=r.paragraph.childWidgets[r.paragraph.childWidgets.length-1];i=this.documentHelper.selection.isParagraphLastLine(n)&&r.currentWidget===n&&r.offset===this.documentHelper.selection.getLineLength(n)+1}return t.paragraphFormat=this.writeParagraphFormat(i?e.paragraphFormat:new ct(e)),t.characterFormat=this.writeCharacterFormat(i?e.characterFormat:new P(e)),t.inlines=[],t},e.prototype.writeCharacterFormat=function(e,t){var i={};if(x.writeCharacterFormat(i,t,e),i.boldBidi=t?e.bold:e.getValue("bold"),i.italicBidi=t?e.italic:e.getValue("italic"),i.fontSizeBidi=t?e.fontSize:e.getValue("fontSize"),e.revisions.length>0){i.revisionIds=[];for(var r=0;r<e.revisions.length;r++)i.revisionIds.push(e.revisions[r].revisionID)}return this.writeInlineStyles&&!t&&(i.inlineFormat=this.writeCharacterFormat(e,!0)),i},e.prototype.writeParagraphFormat=function(e,t){var i={};return i.borders=this.writeParagraphBorders(e.borders),i.leftIndent=t?e.leftIndent:e.getValue("leftIndent"),i.rightIndent=t?e.rightIndent:e.getValue("rightIndent"),i.firstLineIndent=t?e.firstLineIndent:e.getValue("firstLineIndent"),i.textAlignment=t?e.textAlignment:e.getValue("textAlignment"),i.beforeSpacing=t?e.beforeSpacing:e.getValue("beforeSpacing"),i.afterSpacing=t?e.afterSpacing:e.getValue("afterSpacing"),i.spaceBeforeAuto=t?e.spaceBeforeAuto:e.getValue("spaceBeforeAuto"),i.spaceAfterAuto=t?e.spaceAfterAuto:e.getValue("spaceAfterAuto"),i.lineSpacing=t?e.lineSpacing:e.getValue("lineSpacing"),i.lineSpacingType=t?e.lineSpacingType:e.getValue("lineSpacingType"),i.styleName=sf.base.isNullOrUndefined(e.baseStyle)?void 0:e.baseStyle.name,i.outlineLevel=t?e.outlineLevel:e.getValue("outlineLevel"),i.listFormat=this.writeListFormat(e.listFormat,t),i.tabs=this.writeTabs(e.tabs),i.bidi=t?e.bidi:e.getValue("bidi"),i.keepLinesTogether=t?e.keepLinesTogether:e.getValue("keepLinesTogether"),i.keepWithNext=t?e.keepWithNext:e.getValue("keepWithNext"),i.widowControl=t?e.widowControl:e.getValue("widowControl"),i.contextualSpacing=t?e.contextualSpacing:e.getValue("contextualSpacing"),this.writeInlineStyles&&!t&&(i.inlineFormat=this.writeParagraphFormat(e,!0)),i},e.prototype.writeThemes=function(e){var t={fontScheme:{}};return t.fontScheme.fontSchemeName=e.fontScheme.fontSchemeName,t.fontScheme.majorFontScheme=this.writeMajorMinorFontScheme(e.fontScheme.majorFontScheme),t.fontScheme.minorFontScheme=this.writeMajorMinorFontScheme(e.fontScheme.minorFontScheme),t},e.prototype.writeMajorMinorFontScheme=function(e){var t={};t.fontSchemeList=this.writeFontSchemeList(e.fontSchemeList);for(var i={},r=0,n=e.fontTypeface.keys;r<n.length;r++){var o=n[r];i[o]=e.fontTypeface.get(o)}return t.fontTypeface=i,t},e.prototype.writeFontSchemeList=function(e){var t=[];return e.forEach((function(e){var i={};i.name=e.name,i.typeface=e.typeface,i.panose=e.panose,t.push(i)})),t},e.prototype.writeTabs=function(e){if(!(sf.base.isNullOrUndefined(e)||e.length<1)){for(var t=[],i=0;i<e.length;i++){var r=e[i],n={};n.position=r.position,n.deletePosition=r.deletePosition,n.tabJustification=r.tabJustification,n.tabLeader=r.tabLeader,t.push(n)}return t}},e.prototype.writeListFormat=function(e,t){var i={},r=e.getValue("listId");sf.base.isNullOrUndefined(r)||(i.listId=r,this.lists.indexOf(e.listId)<0&&this.lists.push(e.listId));var n=e.getValue("listLevelNumber");return sf.base.isNullOrUndefined(n)||(i.listLevelNumber=n),i},e.prototype.writeTable=function(e,t,i,r){var n=e.childWidgets[i];if(!(n instanceof ce&&this.writeRow(n,t.rows))){var o=e;do{o=(e=o).nextSplitWidget}while(o instanceof se);return(o=e.nextRenderedWidget)instanceof se&&o.containerWidget.index===e.containerWidget.index?o:void 0}},e.prototype.writeRow=function(e,t){var i=e;do{if((e=i)===(i=this.writeRowInternal(i,t)))return!0}while(i instanceof ce);return!1},e.prototype.writeRowInternal=function(e,t){if(!(e instanceof ce))return e;e.isCellsHaveSameWidthUnit()||e.updateUniformWidthUnitForCells();var i=this.createRow(e);t.push(i);for(var r=0;r<e.childWidgets.length;r++){var n=e.childWidgets[r];if(n instanceof pe&&e.index===n.rowIndex&&(sf.base.isNullOrUndefined(this.startColumnIndex)||n.columnIndex>=this.startColumnIndex)&&(sf.base.isNullOrUndefined(this.endColumnIndex)||n.columnIndex<this.endColumnIndex)&&this.writeCell(n,i.cells))return e}var o=e;do{o=(e=o).nextRenderedWidget,!sf.base.isNullOrUndefined(e.ownerTable.bodyWidget)&&o&&(e.ownerTable.index!==o.ownerTable.index&&e.ownerTable.bodyWidget.sectionIndex===o.ownerTable.bodyWidget.sectionIndex||e.ownerTable.bodyWidget.sectionIndex!==o.ownerTable.bodyWidget.sectionIndex)&&(o=void 0)}while(o instanceof ce&&o.index===e.index);return o},e.prototype.writeCell=function(e,t){var i=this.createCell(e);t.push(i);var r=e.firstChild;do{r=this.writeBlock(r,0,i.blocks)}while(r);return this.endCell instanceof pe&&this.endCell.cellFormat===e.cellFormat},e.prototype.createTable=function(e){for(var t={rows:[],grid:[]},i=0;i<e.tableHolder.columns.length;i++)t.grid[i]=e.tableHolder.columns[i].preferredWidth;return t.tableFormat=this.writeTableFormat(e.tableFormat),t.description=e.description,t.title=e.title,t.columnCount=e.tableHolder.columns.length,this.writeTablePositioning(t,e),t},e.prototype.writeTablePositioning=function(e,t){t.wrapTextAround&&(e.wrapTextAround=t.wrapTextAround,e.positioning={},e.positioning.allowOverlap=t.positioning.allowOverlap,e.positioning.distanceBottom=x.convertPixelToPoint(t.positioning.distanceBottom),e.positioning.distanceLeft=x.convertPixelToPoint(t.positioning.distanceLeft),e.positioning.distanceRight=x.convertPixelToPoint(t.positioning.distanceRight),e.positioning.distanceTop=x.convertPixelToPoint(t.positioning.distanceTop),sf.base.isNullOrUndefined(t.positioning.verticalAlignment)||(e.positioning.verticalAlignment=t.positioning.verticalAlignment),sf.base.isNullOrUndefined(t.positioning.verticalOrigin)||(e.positioning.verticalOrigin=t.positioning.verticalOrigin),e.positioning.verticalPosition=t.positioning.verticalPosition,sf.base.isNullOrUndefined(t.positioning.horizontalAlignment)||(e.positioning.horizontalAlignment=t.positioning.horizontalAlignment),sf.base.isNullOrUndefined(t.positioning.horizontalOrigin)||(e.positioning.horizontalOrigin=t.positioning.horizontalOrigin),e.positioning.horizontalPosition=t.positioning.horizontalPosition)},e.prototype.createRow=function(e){var t={cells:[]};return t.rowFormat=this.writeRowFormat(e.rowFormat),e.hasOwnProperty("contentControlProperties")&&(t.contentControlProperties=this.contentControlProperty(e.contentControlProperties)),t},e.prototype.createCell=function(e){var t={blocks:[]};return t.cellFormat=this.writeCellFormat(e.cellFormat),t.columnIndex=e.columnIndex,e.hasOwnProperty("contentControlProperties")&&(t.contentControlProperties=this.contentControlProperty(e.contentControlProperties)),t},e.prototype.writeShading=function(e){var t={};return t.backgroundColor=e.hasValue("backgroundColor")?e.backgroundColor:void 0,t.foregroundColor=e.hasValue("foregroundColor")?e.foregroundColor:void 0,t.textureStyle=e.hasValue("textureStyle")?e.textureStyle:void 0,t},e.prototype.writeBorder=function(e){var t={};return t.color=e.hasValue("color")?e.color:void 0,t.hasNoneStyle=e.hasValue("hasNoneStyle")?e.hasNoneStyle:void 0,t.lineStyle=e.hasValue("lineStyle")?e.lineStyle:void 0,t.lineWidth=e.hasValue("lineWidth")?e.lineWidth:void 0,t.shadow=e.hasValue("shadow")?e.shadow:void 0,t.space=e.hasValue("space")?e.space:void 0,t},e.prototype.writeParagraphBorders=function(e){var t={};return t.top=this.writeBorder(e.getBorder("top")),t.left=this.writeBorder(e.getBorder("left")),t.right=this.writeBorder(e.getBorder("right")),t.bottom=this.writeBorder(e.getBorder("bottom")),t.horizontal=this.writeBorder(e.getBorder("horizontal")),t.vertical=this.writeBorder(e.getBorder("vertical")),t},e.prototype.writeBorders=function(e){var t={};return t.top=this.writeBorder(e.top),t.left=this.writeBorder(e.left),t.right=this.writeBorder(e.right),t.bottom=this.writeBorder(e.bottom),t.diagonalDown=this.writeBorder(e.diagonalDown),t.diagonalUp=this.writeBorder(e.diagonalUp),t.horizontal=this.writeBorder(e.horizontal),t.vertical=this.writeBorder(e.vertical),t},e.prototype.writeCellFormat=function(e){var t={};return t.borders=this.writeBorders(e.borders),t.shading=this.writeShading(e.shading),t.topMargin=e.hasValue("topMargin")?e.topMargin:void 0,t.rightMargin=e.hasValue("rightMargin")?e.rightMargin:void 0,t.leftMargin=e.hasValue("leftMargin")?e.leftMargin:void 0,t.bottomMargin=e.hasValue("bottomMargin")?e.bottomMargin:void 0,t.preferredWidth=e.hasValue("preferredWidth")?e.preferredWidth:void 0,t.preferredWidthType=e.hasValue("preferredWidthType")?e.preferredWidthType:void 0,t.cellWidth=e.hasValue("cellWidth")?e.cellWidth:void 0,t.columnSpan=e.columnSpan,t.rowSpan=e.rowSpan,t.verticalAlignment=e.hasValue("verticalAlignment")?e.verticalAlignment:void 0,t},e.prototype.writeRowFormat=function(e){var t={},i=[];t.height=e.hasValue("height")?e.height:void 0,t.allowBreakAcrossPages=e.hasValue("allowBreakAcrossPages")?e.allowBreakAcrossPages:void 0,t.heightType=e.hasValue("heightType")?e.heightType:void 0,t.isHeader=e.hasValue("isHeader")?e.isHeader:void 0,t.borders=this.writeBorders(e.borders),t.gridBefore=e.gridBefore,t.gridBeforeWidth=e.hasValue("gridBeforeWidth")?e.gridBeforeWidth:void 0,t.gridBeforeWidthType=e.hasValue("gridBeforeWidthType")?e.gridBeforeWidthType:void 0,t.gridAfter=e.gridAfter,t.gridAfterWidth=e.hasValue("gridAfterWidth")?e.gridAfterWidth:void 0,t.gridAfterWidthType=e.hasValue("gridAfterWidthType")?e.gridAfterWidthType:void 0,t.leftMargin=e.hasValue("leftMargin")?e.leftMargin:void 0,t.topMargin=e.hasValue("topMargin")?e.topMargin:void 0,t.rightMargin=e.hasValue("rightMargin")?e.rightMargin:void 0,t.bottomMargin=e.hasValue("bottomMargin")?e.bottomMargin:void 0,t.leftIndent=e.hasValue("leftIndent")?e.leftIndent:void 0;for(var r=0;r<e.revisions.length;r++)t.revisionIds=this.writeRowRevisions(e.revisions[r],i);return t},e.prototype.writeRowRevisions=function(e,t){return-1===this.selectedRevisionId.indexOf(e.revisionID)&&this.selectedRevisionId.push(e.revisionID),t.push(e.revisionID),t},e.prototype.writeTableFormat=function(e){var t={};return t.borders=this.writeBorders(e.borders),t.shading=this.writeShading(e.shading),t.cellSpacing=e.hasValue("cellSpacing")?e.cellSpacing:void 0,t.leftIndent=e.hasValue("leftIndent")?e.leftIndent:void 0,t.tableAlignment=e.hasValue("tableAlignment")?e.tableAlignment:void 0,t.topMargin=e.hasValue("topMargin")?e.topMargin:void 0,t.rightMargin=e.hasValue("rightMargin")?e.rightMargin:void 0,t.leftMargin=e.hasValue("leftMargin")?e.leftMargin:void 0,t.bottomMargin=e.hasValue("bottomMargin")?e.bottomMargin:void 0,t.preferredWidth=e.hasValue("preferredWidth")?e.preferredWidth:void 0,t.preferredWidthType=e.hasValue("preferredWidthType")?e.preferredWidthType:void 0,t.bidi=e.hasValue("bidi")?e.bidi:void 0,t.allowAutoFit=e.hasValue("allowAutoFit")?e.allowAutoFit:void 0,t.styleName=sf.base.isNullOrUndefined(e.styleName)?void 0:e.styleName,t},e.prototype.footnotes=function(e){for(var t=0;t<e.footnotes.separator.length;t++)this.seprators(e)},e.prototype.seprators=function(e){if(e.footnotes.separator.length>0){this.document.footnotes={},this.document.footnotes.separator=[];for(var t=0;t<e.footnotes.separator.length;t++)this.writeBlock(e.footnotes.separator[t],0,this.document.footnotes.separator)}if(e.footnotes.continuationSeparator.length>0){this.document.footnotes.continuationSeparator=[];for(t=0;t<e.footnotes.continuationSeparator.length;t++)this.writeBlock(e.footnotes.continuationSeparator[t],0,this.document.footnotes.continuationSeparator)}if(e.footnotes.continuationNotice.length>0){this.document.footnotes.continuationNotice=[];for(t=0;t<e.footnotes.continuationNotice.length;t++)this.writeBlock(e.footnotes.continuationNotice[t],0,this.document.footnotes.continuationNotice)}},e.prototype.endnotes=function(e){for(var t=0;t<this.documentHelper.endnotes.separator.length;t++)this.endnoteSeparator(e)},e.prototype.endnoteSeparator=function(e){if(e.endnotes.separator.length>0){this.document.endnotes={},this.document.endnotes.separator=[];for(var t=0;t<e.endnotes.separator.length;t++)this.writeBlock(e.endnotes.separator[t],0,this.document.endnotes.separator)}if(e.endnotes.continuationSeparator.length>0){this.document.endnotes.continuationSeparator=[];for(t=0;t<e.endnotes.continuationSeparator.length;t++)this.writeBlock(e.endnotes.continuationSeparator[t],0,this.document.endnotes.continuationSeparator)}if(e.endnotes.continuationNotice.length>0){this.document.endnotes.continuationNotice=[];for(t=0;t<e.endnotes.continuationNotice.length;t++)this.writeBlock(e.endnotes.continuationNotice[t],0,this.document.endnotes.continuationNotice)}},e.prototype.writeStyles=function(e){this.document.styles=[];for(var t=0;t<e.styles.length;t++)this.document.styles.push(this.writeStyle(e.styles.getItem(t)))},e.prototype.writeStyle=function(e){var t={};return t.name=e.name,"Paragraph"===e.type&&(t.type="Paragraph",t.paragraphFormat=this.writeParagraphFormat(e.paragraphFormat),t.characterFormat=this.writeCharacterFormat(e.characterFormat)),"Character"===e.type&&(t.type="Character",t.characterFormat=this.writeCharacterFormat(e.characterFormat)),sf.base.isNullOrUndefined(e.basedOn)||(t.basedOn=e.basedOn.name),sf.base.isNullOrUndefined(e.link)||(t.link=e.link.name),sf.base.isNullOrUndefined(e.next)||(t.next=e.next.name),t},e.prototype.writeRevisions=function(e){this.document.revisions=[];for(var t=0;t<e.owner.revisions.changes.length;t++)(this.isExport||!this.isExport&&!this.owner.enableTrackChanges&&-1!==this.selectedRevisionId.indexOf(e.owner.revisions.changes[t].revisionID))&&this.document.revisions.push(this.writeRevision(e.owner.revisions.changes[t]))},e.prototype.writeRevision=function(e){var t={};return t.author=e.author,t.date=e.date,t.revisionType=e.revisionType,t.revisionId=e.revisionID,t},e.prototype.writeComments=function(e){this.document.comments=[];for(var t=0;t<e.comments.length;t++)(this.isExport||!this.isExport&&-1!==this.selectedCommentsId.indexOf(this.documentHelper.comments[t].commentId))&&this.document.comments.push(this.writeComment(this.documentHelper.comments[t]))},e.prototype.writeCustomXml=function(e){this.document.customXml=[];for(var t=0;t<e.customXmlData.length;t++){var i={},r=e.customXmlData.keys[t];i.itemID=r;var n=this.documentHelper.customXmlData.get(r);i.xml=n,this.document.customXml.push(i)}},e.prototype.writeComment=function(e){var t={};t.commentId=e.commentId,t.author=e.author,t.date=e.date,t.blocks=[],t.blocks.push(this.commentInlines(e.text)),t.done=e.isResolved,t.replyComments=[];for(var i=0;i<e.replyComments.length;i++)t.replyComments.push(this.writeComment(e.replyComments[i]));return t},e.prototype.commentInlines=function(e){var t={};return t.inlines=[{text:e}],t},e.prototype.writeLists=function(e){var t=[];this.document.lists=[];for(var i=0;i<e.lists.length;i++){var r=e.lists[i];this.lists.indexOf(r.listId)>-1&&(this.document.lists.push(this.writeList(r)),t.indexOf(r.abstractListId)<0&&t.push(r.abstractListId))}this.document.abstractLists=[];for(i=0;i<e.abstractLists.length;i++){var n=e.abstractLists[i];t.indexOf(n.abstractListId)>-1&&this.document.abstractLists.push(this.writeAbstractList(n))}},e.prototype.writeAbstractList=function(e){var t={};t.abstractListId=e.abstractListId,t.levels=[];for(var i=0;i<e.levels.length;i++)t.levels[i]=this.writeListLevel(e.levels[i]);return t},e.prototype.writeList=function(e){var t={};t.abstractListId=e.abstractListId,t.levelOverrides=[];for(var i=0;i<e.levelOverrides.length;i++)t.levelOverrides.push(this.writeLevelOverrides(e.levelOverrides[i]));return t.listId=e.listId,t},e.prototype.writeLevelOverrides=function(e){var t={};return t.levelNumber=e.levelNumber,e.overrideListLevel&&(t.overrideListLevel=this.writeListLevel(e.overrideListLevel)),t.startAt=e.startAt,t},e.prototype.writeListLevel=function(e){var t={};return t.characterFormat=this.writeCharacterFormat(e.characterFormat),t.paragraphFormat=this.writeParagraphFormat(e.paragraphFormat),t.followCharacter=e.followCharacter,t.listLevelPattern=e.listLevelPattern,t.numberFormat=e.numberFormat,t.restartLevel=e.restartLevel,t.startAt=e.startAt,t},e.prototype.getParentBlock=function(e){return e.isInsideTable&&(e=this.owner.documentHelper.layout.getParentTable(e)),e},e.prototype.getParentCell=function(e){for(;e.ownerTable.isInsideTable;)e=e.ownerTable.associatedCell;return e},e.prototype.destroy=function(){this.lists=void 0,this.endLine=void 0,this.startLine=void 0,this.endOffset=void 0,this.documentHelper=void 0},e}(),hi=function(){function e(e){this.documentHelper=e,this.optimizedHeightCollection={}}return e.prototype.getModuleName=function(){return"Optimized"},e.prototype.getkeyFromCharFormat=function(e){var t=e.fontFamily.toLocaleLowerCase();return e.bold&&(t+=";bold"),e.italic&&(t+=";italic"),t},e.prototype.getFontInfo=function(e){var t=document.createElement("div");t.setAttribute("style","position:absolute;top:-1000px;left:-1000px;opacity:0;font-size:0px;line-height:normal;");var i=1/window.devicePixelRatio;t.style.transform="scale("+i.toString()+","+i.toString()+")",t.innerHTML='<span class="e-de-font-info" style="font-size:0; font-family: '+e.fontFamily+'; display: inline-block;">m</span><span class="e-de-font-info" style="font-size:288pt; font-family: '+e.fontFamily+";"+(e.bold?"font-weight:bold;":"")+(e.italic?"font-style:italic;":"")+' display: inline-block;">m</span>',document.body.appendChild(t);var r=t.firstChild.offsetTop/t.lastChild.offsetHeight,n=parseFloat((t.lastChild.offsetHeight/288).toFixed(2));return document.body.removeChild(t),{HeightFactor:n,BaselineFactor:r}},e.prototype.getHeightInternal=function(e){var t=this.getkeyFromCharFormat(e);if(sf.base.isNullOrUndefined(this.optimizedHeightCollection[""+t])){var i=this.getFontInfo(e);return this.optimizedHeightCollection[""+t]=i,{Height:r=i.HeightFactor*e.fontSize,BaselineOffset:i.BaselineFactor*r}}var r,n=this.optimizedHeightCollection[""+t];return{Height:r=n.HeightFactor*e.fontSize,BaselineOffset:n.BaselineFactor*r}},e.prototype.destroy=function(){this.documentHelper=void 0,this.optimizedHeightCollection=void 0},e}(),di=function(){function e(e){this.documentHelper=e}return e.prototype.getModuleName=function(){return"Regular"},e.prototype.getHeightInternal=function(e,t){var i,r,n=document.createElement("span");n.innerText="m";var o=sf.base.createElement("iframe");document.body.appendChild(o);sf.base.isNullOrUndefined(o.contentDocument)||(o.contentDocument.open(),o.contentDocument.write("<!DOCTYPE html><html><head></head><body></body></html>"),o.contentDocument.close()),this.applyStyle(n,e,t);var s=document.createElement("div");s.setAttribute("style","display:inline-block;position:absolute;");var a=document.createElement("div");a.setAttribute("style","display:inline-block;width: 1px; height: 0px;vertical-align: baseline;"),s.appendChild(n),s.appendChild(a),o.contentDocument.body.appendChild(s),i=n.offsetHeight;var l=n.offsetTop;return r=a.offsetTop-l,document.body.removeChild(o),{Height:i,BaselineOffset:r}},e.prototype.applyStyle=function(e,t,i){if(!sf.base.isNullOrUndefined(e)&&!sf.base.isNullOrUndefined(t)){var r="white-space:nowrap;";sf.base.isNullOrUndefined(i)||""===i?r+="font-family:"+t.fontFamily+";":r+="font-family:"+i+";";var n=t.fontSize;n<=.5&&(n=.5),r+="font-size:"+n.toString()+"pt;",t.bold&&(r+="font-weight:bold;"),t.italic&&(r+="font-style:italic;"),e.setAttribute("style",r)}},e.prototype.destroy=function(){this.documentHelper=void 0},e}(),ci=function(){function e(e,t,i,r,n){this.isDestroyed=!1,this.enableHeaderFooterIn=!1,window.sfBlazor=window.sfBlazor,this.isShiftingEnabled=!1,this.isLayoutEnabled=!0,this.isPastingContent=!1,this.parser=void 0,this.disableHistoryIn=!1,this.findResultsList=void 0,this.defaultLocale={},this.imageResizerModule=void 0,this.zoomFactor=1,this.dotNetRef=i,this.localeKeys=n,this.element=t,this.dataId=e,window.sfBlazor.setCompInstance(this),this.documentHelper=new q(this),sf.base.isNullOrUndefined(r)||(this.options=r,this.updateOptions(r)),"Pages"===this.layoutType?this.viewer=new X(this):this.viewer=new Z(this)}return Object.defineProperty(e.prototype,"enableHeaderAndFooter",{get:function(){return this.enableHeaderFooterIn},set:function(e){this.enableHeaderFooterIn=e,!e&&this.selection&&this.selection.isWebLayout&&(this.selection.isWebLayout=!1),this.viewer.updateScrollBars()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pageCount",{get:function(){return!this.isDocumentLoaded||sf.base.isNullOrUndefined(this.viewer)||this.viewer instanceof Z?1:this.documentHelper.pages.length},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selection",{get:function(){return this.selectionModule},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"editor",{get:function(){return this.editorModule},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"editorHistory",{get:function(){return this.editorHistoryModule},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"search",{get:function(){return this.searchModule},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"spellChecker",{get:function(){return this.spellCheckerModule},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"containerId",{get:function(){return this.element.id},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isDocumentLoaded",{get:function(){return this.isDocumentLoadedIn},set:function(e){this.isDocumentLoadedIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"revisions",{get:function(){return sf.base.isNullOrUndefined(this.revisionsInternal)&&(this.revisionsInternal=new T(this)),this.revisionsInternal},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"enableHistoryMode",{get:function(){return this.enableEditorHistory&&!sf.base.isNullOrUndefined(this.editorHistoryModule)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"documentStart",{get:function(){if(!sf.base.isNullOrUndefined(this.selectionModule))return this.selection.getDocumentStart()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"documentEnd",{get:function(){if(!sf.base.isNullOrUndefined(this.selectionModule))return this.selection.getDocumentEnd()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isReadOnlyMode",{get:function(){return this.isReadOnly||sf.base.isNullOrUndefined(this.editorModule)||sf.base.isNullOrUndefined(this.selectionModule)||!sf.base.isNullOrUndefined(this.editor)&&this.editor.restrictEditing},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isSpellCheck",{get:function(){return this.enableSpellCheck&&this.spellChecker.enableSpellCheck},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"enableImageResizerMode",{get:function(){return this.enableImageResizer&&!sf.base.isNullOrUndefined(this.imageResizerModule)},enumerable:!0,configurable:!0}),e.prototype.updateOptions=function(e){this.acceptTab=e.acceptTab,this.currentUser=e.currentUser,this.documentName=e.documentName,this.enableBookmarkDialog=e.enableBookmarkDialog,this.enableBordersAndShadingDialog=e.enableBordersAndShadingDialog,this.enableComment=e.enableComment,this.enableContextMenu=e.enableContextMenu,this.enableCursorOnReadOnly=e.enableCursorOnReadOnly,this.enableEditor=e.enableEditor,this.enableEditorHistory=e.enableEditorHistory,this.enableFontDialog=e.enableFontDialog,this.enableFormField=e.enableFormField,this.enableHyperlinkDialog=e.enableHyperlinkDialog,this.enableImageResizer=e.enableImageResizer,this.enableListDialog=e.enableListDialog,this.enableLocalPaste=e.enableLocalPaste,this.enableOptionsPane=e.enableOptionsPane,this.enablePageSetupDialog=e.enablePageSetupDialog,this.enableParagraphDialog=e.enableParagraphDialog,this.enablePrint=e.enablePrint,this.enableSearch=e.enableSearch,this.enableSelection=e.enableSelection,this.enableSfdtExport=e.enableSfdtExport,this.enableSpellCheck=e.enableSpellCheck,this.enableStyleDialog=e.enableStyleDialog,this.enableTableDialog=e.enableTableDialog,this.enableTableOfContentsDialog=e.enableTableOfContentsDialog,this.enableTableOptionsDialog=e.enableTableOptionsDialog,this.enableTextExport=e.enableTextExport,this.enableTrackChanges=e.enableTrackChanges,this.enableWordExport=e.enableWordExport,this.headers=e.headers?e.headers:[],this.height=e.height,this.isReadOnly=e.isReadOnly,this.pageGap=e.pageGap,this.pageOutline=e.pageOutline,this.serviceUrl=e.serviceUrl,this.showComments=e.showComments,this.showRevisions=e.showRevisions,this.useCtrlClickToFollowHyperlink=e.useCtrlClickToFollowHyperlink,this.userColor=e.userColor,this.width=e.width,this.zIndex=e.zIndex,this.zoomFactor=e.zoomFactor,this.layoutType=e.layoutType,this.defaultPasteOption=e.defaultPasteOption,this.documentEditorSettings=e.documentEditorSettings,this.documentSettings=e.documentSettings,this.serverActionSettings=e.serverActionSettings,this.requiredModules()},e.prototype.setOptions=function(e,t,i){for(var r=this,n=0,o=Object.keys(e);n<o.length;n++){switch(o[n]){case"zoomFactor":t.zoomFactor!=e.zoomFactor&&(this.zoomFactor=e.zoomFactor,this.documentHelper&&(this.documentHelper.zoomFactor=e.zoomFactor));break;case"layoutType":if(this.selection&&this.selection.isWebLayout)break;t.layoutType!=e.layoutType&&(this.layoutType=e.layoutType,this.viewer.destroy(),"Pages"===this.layoutType?this.viewer=new X(this):(!0===this.enableHeaderAndFooter&&this.selection.closeHeaderFooter(),this.viewer=new Z(this)),this.editor.layoutWholeDocument(),setTimeout((function(){r.fireViewChange()}),200));break;case"locale":break;case"isReadOnly":this.isReadOnly=e.isReadOnly;break;case"currentUser":t.currentUser!=e.currentUser&&(this.currentUser=e.currentUser,this.selection&&this.documentHelper.isDocumentProtected&&this.selection.highlightEditRegion());break;case"userColor":t.userColor!=e.userColor&&(this.userColor=e.userColor,this.selection&&this.documentHelper.isDocumentProtected&&this.selection.highlightEditRegion());break;case"pageGap":t.pageGap!=e.pageGap&&(this.pageGap=e.pageGap,this.viewer.updateScrollBars());break;case"pageOutline":t.pageOutline!=e.pageOutline&&(this.pageOutline=e.pageOutline,this.viewer.updateScrollBars());break;case"zIndex":case"showComments":case"enableRtl":case"enableComment":break;case"showRevisions":this.isReadOnly||this.documentHelper.isDocumentProtected?(this.showRevisions=!1,this.documentHelper.showRevisions(!1)):this.viewer&&this.documentHelper.showRevisions(e.showRevisions);break;case"documentEditorSettings":this.documentEditorSettings=e.documentEditorSettings,sf.base.isNullOrUndefined(e.documentEditorSettings.enableOptimizedTextMeasuring)||(e.documentEditorSettings.enableOptimizedTextMeasuring?this.textMeasureHelper=new hi(this.documentHelper):this.textMeasureHelper=new di(this.documentHelper),this.viewer.updateScrollBars()),sf.base.isNullOrUndefined(e.documentEditorSettings.showHiddenMarks)||e.documentEditorSettings.showHiddenMarks===this.documentEditorSettings.showHiddenMarks||this.viewer.updateScrollBars();break;case"documentSettings":var s=this.documentSettings;if(this.documentSettings=e.documentSettings,!sf.base.isNullOrUndefined(e.documentSettings.compatibilityMode)){var a=s.compatibilityMode,l=e.documentSettings.compatibilityMode;("Word2013"==a&&"Word2013"!=l||"Word2013"!=a&&"Word2013"==l)&&this.documentHelper.compatibilityMode!==l&&(this.documentHelper.compatibilityMode=l,this.editor.layoutWholeDocument())}this.viewer.updateScrollBars();break;case"height":if(t.height!=e.height){var h="";h=-1!==this.height.indexOf("%")?window.innerHeight*(parseInt(this.height)/100)+"px":sf.base.formatUnit(this.height),this.height=e.height,this.element.style.height=h,this.resize()}break;case"width":t.width!=e.width&&(this.width=e.width,this.element.style.width=sf.base.formatUnit(this.width),this.resize())}}i&&this.updateOptions(e)},e.prototype.preRender=function(){this.findResultsList=[]},e.prototype.render=function(){if(!sf.base.isNullOrUndefined(this.element)){var e=this.element;e.style.minHeight="200px",e.style.minWidth="200px",this.element.style.height=sf.base.formatUnit(this.height),""!==this.width&&(this.element.style.width=sf.base.formatUnit(this.width))}this.documentHelper.initializeComponents(),this.openBlank()},e.prototype.onPropertyChanged=function(e,t){for(var i=this,r=0,n=Object.keys(e);r<n.length;r++){switch(n[r]){case"zoomFactor":this.viewer&&(this.documentHelper.zoomFactor=e.zoomFactor);break;case"layoutType":if(this.selection&&this.selection.isWebLayout)break;this.viewer.destroy(),"Pages"===this.layoutType?this.viewer=new X(this):(!0===this.enableHeaderAndFooter&&this.selection.closeHeaderFooter(),this.viewer=new Z(this)),this.editor.layoutWholeDocument(),setTimeout((function(){i.fireViewChange()}),200);break;case"locale":break;case"isReadOnly":this.isReadOnly=e.isReadOnly;break;case"currentUser":case"userColor":this.selection&&this.documentHelper.isDocumentProtected&&this.selection.highlightEditRegion();break;case"pageGap":case"pageOutline":this.viewer.updateScrollBars();break;case"zIndex":break;case"showComments":this.viewer&&this.documentHelper.showComments(e.showComments);break;case"enableRtl":break;case"enableComment":this.viewer&&this.showComments&&(this.showComments=!!this.showComments&&this.enableComment,this.documentHelper.showComments(e.enableComment)),this.viewer.updateScrollBars();break;case"showRevisions":this.viewer&&this.documentHelper.showRevisions(e.showRevisions),this.viewer.updateScrollBars();break;case"documentEditorSettings":this.viewer.updateScrollBars();break;case"height":this.element.style.height=sf.base.formatUnit(this.height),this.resize();break;case"width":this.element.style.width=sf.base.formatUnit(this.width),this.resize()}}},e.prototype.setDefaultCharacterFormat=function(e){this.characterFormat=e},e.prototype.setDefaultParagraphFormat=function(e){this.paragraphFormat=e},e.prototype.setDefaultSectionFormat=function(e){this.sectionFormat=e},e.prototype.getPersistData=function(){return"documenteditor"},e.prototype.clearPreservedCollectionsInViewer=function(){this.viewer instanceof G&&this.documentHelper.clearDocumentItems()},e.prototype.getDocumentEditorElement=function(){return this.element},e.prototype.fireContentChange=function(){var e=this;this.contentChangeTimer&&(clearTimeout(this.contentChangeTimer),this.contentChangeTimer=void 0),this.contentChangeTimer=setTimeout((function(){var t={canUndo:e.editorHistory.canUndo(),canRedo:e.editorHistory.canRedo(),pageCount:e.pageCount};e.dotNetRef.invokeMethodAsync("ContentChangeInternal",t)}),200),this.dotNetRef.invokeMethodAsync("ContentChange")},e.prototype.fireDocumentChange=function(){var e=this;this.documentChangeTimer&&(clearTimeout(this.documentChangeTimer),this.documentChangeTimer=void 0);var t={enableTrackChanges:this.enableTrackChanges,compatibilityMode:this.documentHelper.compatibilityMode};this.documentChangeTimer=setTimeout((function(){e.fireDocumentChangeInternal(t)}),200),this.isDestroyed||(this.dotNetRef.invokeMethodAsync("DocumentChange",t),this.dotNetRef.invokeMethodAsync("UpdateCommentsCollection",this.fetchComments()))},e.prototype.fireDocumentChangeInternal=function(e){this.isDestroyed||this.dotNetRef.invokeMethodAsync("DocumentChangeInternal",e)},e.prototype.showFormFieldPopup=function(e){this.dotNetRef.invokeMethodAsync("ShowFormFieldPopup",e.type,JSON.stringify(e),!0)},e.prototype.hideFormFieldPopup=function(){this.dotNetRef.invokeMethodAsync("ShowFormFieldPopup","","",!1)},e.prototype.fireSelectionChange=function(){var e=this;if(!this.documentHelper.isCompositionStart&&sf.base.Browser.isDevice&&this.editorModule&&this.editorModule.predictText(),!this.editor||!this.editor.isInsertingTOC){var t={source:sf.base.isBlazor()?null:this};sf.base.EventHandler.trigger(this.element,"selectionChange",t),this.selectionTimer&&(clearTimeout(this.selectionTimer),this.selectionTimer=void 0),this.selectionTimer=setTimeout((function(){e.fireSelectionChangeInternal()}),200),this.isDestroyed||this.dotNetRef.invokeMethodAsync("SelectionChange")}},e.prototype.fireSelectionChangeInternal=function(){this.isDestroyed||this.dotNetRef.invokeMethodAsync("SelectionChangeInternal",this.getCurrentContext())},e.prototype.setShowHiddenMarks=function(e){this.isDestroyed||(this.dotNetRef.invokeMethodAsync("SetShowHiddenMarks",e),this.viewer.updateScrollBars())},e.prototype.isContentProtected=function(){var e=this.documentHelper.isDocumentProtected,t=!1,i=!1,r="",n="",o="NoProtection";if(e&&(t=e&&this.documentHelper.restrictFormatting,i=this.editor.restrictEditing,o=this.documentHelper.protectionType,this.documentHelper.selection.checkSelectionIsAtEditRegion())){var s=this.documentHelper.selection.getEditRangeStartElement();s&&(r=s.user,n=s.group)}return{isDocumentProtected:e,allowFormatting:t,isInProtectecRegion:i,isReadOnly:this.isReadOnly,protectionType:o,editUser:r,editGroup:n}},e.prototype.getCurrentContext=function(){var e={};e.characterFormat=this.fetchCharacterFormat(this.selection.characterFormat),e.paragraphFormat=this.fetchParagraphFormat(this.selection.paragraphFormat),e.sectionFormat=this.fetchSectionFormat(this.selection.sectionFormat),this.selection.contextType.indexOf("Table")>=0&&(e.tableFormat=this.fetchTableFormat(this.selection.tableFormat),e.rowFormat=this.fetchRowFormat(this.selection.rowFormat),e.cellFormat=this.fetchCellFormat(this.selection.cellFormat)),this.selection.contextType.indexOf("Image")>=0&&(e.imageFormat=this.fetchImageFormat());var t={},i=this.selection.contextType,r=this.documentHelper.selection,n=!1,o=r.getHyperlinkField();t.isHideComment=this.documentHelper.owner.isReadOnlyMode&&!this.documentHelper.isCommentOnlyMode||this.documentHelper.owner.enableHeaderAndFooter||!this.documentHelper.owner.enableComment,o instanceof fe&&r.isReferenceField(o)&&(n=!0,"FormFieldsOnly"!==this.documentHelper.protectionType&&this.documentHelper.owner.isReadOnlyMode||(t.canUpdateField=!0)),t.contextType=i,t.isReadOnly=this.documentHelper.owner.isReadOnlyMode;var s=this.selection.isinFootnote,a=this.selection.isinEndnote;t.isinEndnote=a,t.isinFootnote=s;var l=this.selection.isEmpty;if(t.isEmpty=l,"TableOfContents"===i)t.isTableOfContents=!0;else{var h=r.start,d=r.end;"List"===r.contextType&&"Bullet"!==r.getListLevel(h.paragraph).listLevelPattern&&(t.isList=!0);var c=h.paragraph.isInsideTable&&(!d.paragraph.isInsideTable||h.paragraph.associatedCell!==d.paragraph.associatedCell||this.documentHelper.selection.isCellSelected(h.paragraph.associatedCell,h,d));if(t.isHyperlinkEnabled=!!c,o instanceof fe&&!r.isImageField()&&!n?t.editHyperLink=!0:t.editHyperLink=!1,t.formFieldType="",r.isFormField()){var p=this.documentHelper.selection.getCurrentFormField();p instanceof fe&&(p.formFieldData instanceof ye?t.formFieldType="Text":p.formFieldData instanceof ve?t.formFieldType="CheckBox":p.formFieldData instanceof be&&(t.formFieldType="DropDown"))}o instanceof fe&&n&&(t.canUpdateField=!0)}return this.documentHelper.owner.selection.start.paragraph.isInsideTable&&this.documentHelper.owner.selection.end.paragraph.isInsideTable&&(t.isTable=!0,this.editor.canMergeCells()&&(t.canMergeCells=!0),t.isTableSelected=this.documentHelper.selection.isTableSelected()),t.isFont="Image"!==i,this.enableTrackChanges&&this.documentHelper.selection.hasRevisions()&&(t.canAcceptChange=!0),t.isElementBox=this.isSpellCheck&&this.hasElementBox(),e.selectionContext=t,e.protectionInfo=this.isContentProtected(),e.pasteOption=this.selection.currentPasteAction,e},e.prototype.fetchImageFormat=function(){var e={};return e.width=this.selection.imageFormat.width,e.height=this.selection.imageFormat.height,e},e.prototype.fetchCharacterFormat=function(e){var t={};return t.bold=e.bold,t.fontSize=e.fontSize,e instanceof xt?sf.base.isNullOrUndefined(e.renderedFontFamily)||sf.base.isNullOrUndefined(e.fontFamily)?t.fontFamily=e.fontFamily:t.fontFamily=e.renderedFontFamily:t.fontFamily=e.fontFamily,t.italic=e.italic,t.baselineAlignment=e.baselineAlignment,t.underline=e.underline,t.fontColor=e.fontColor,t.highlightColor=e.highlightColor,t.strikethrough=e.strikethrough,t.allCaps=e.allCaps,t},e.prototype.fetchParagraphFormat=function(e){var t={};return t.leftIndent=e.leftIndent,t.rightIndent=e.rightIndent,t.firstLineIndent=e.firstLineIndent,t.lineSpacing=e.lineSpacing,t.lineSpacingType=e.lineSpacingType,t.textAlignment=e.textAlignment,t.beforeSpacing=e.beforeSpacing,t.afterSpacing=e.afterSpacing,t.spaceBeforeAuto=e.spaceBeforeAuto,t.spaceAfterAuto=e.spaceAfterAuto,t.bidi=e.bidi,t.keepWithNext=e.keepWithNext,t.keepLinesTogether=e.keepLinesTogether,t.widowControl=e.widowControl,t.contextualSpacing=e.contextualSpacing,t.styleName=e.styleName,t.borders=this.getParaBorder(),sf.base.isNullOrUndefined(e.listFormat)||(t.listFormat=this.fetchListFormat(e.listFormat)),t},e.prototype.getParaBorder=function(){var e={};if(!sf.base.isNullOrUndefined(this.selection.paragraphFormat)){var t=this.selection.paragraphFormat.borders;e.top=this.copySelectionBorderFormat({},t.top),e.bottom=this.copySelectionBorderFormat({},t.bottom),e.left=this.copySelectionBorderFormat({},t.left),e.right=this.copySelectionBorderFormat({},t.right),e.horizontal=this.copySelectionBorderFormat({},t.horizontal),e.vertical=this.copySelectionBorderFormat({},t.vertical)}return e},e.prototype.copySelectionBorderFormat=function(e,t){return sf.base.isNullOrUndefined(t.lineStyle)||(e.lineStyle=t.lineStyle),sf.base.isNullOrUndefined(t.color)||(e.color=t.color),sf.base.isNullOrUndefined(t.lineWidth)||(e.lineWidth=t.lineWidth),sf.base.isNullOrUndefined(t.shadow)||(e.shadow=t.shadow),sf.base.isNullOrUndefined(t.space)||(e.space=t.space),e},e.prototype.fetchListFormat=function(e){var t={},i=e.getValue("listId");sf.base.isNullOrUndefined(i)||(t.listId=i);var r=e.getValue("listLevelNumber");return sf.base.isNullOrUndefined(r)||(t.listLevelNumber=r),t},e.prototype.fetchTableFormat=function(e){var t={};return t.topMargin=e.topMargin,t.bottomMargin=e.bottomMargin,t.leftMargin=e.leftMargin,t.rightMargin=e.rightMargin,t.leftIndent=e.leftIndent,t.background=e.background,t.tableAlignment=e.tableAlignment,t.cellSpacing=e.cellSpacing,t.bidi=e.bidi,t.preferredWidth=e.preferredWidth,t.preferredWidthType=e.preferredWidthType,t.borders=this.getTableBorder(),t.shading=this.getTableShading(),t},e.prototype.fetchCellFormat=function(e){var t={};return t.topMargin=e.topMargin,t.bottomMargin=e.bottomMargin,t.leftMargin=e.leftMargin,t.rightMargin=e.rightMargin,t.verticalAlignment=e.verticalAlignment,t.background=e.background,t.preferredWidth=e.preferredWidth,t.preferredWidthType=e.preferredWidthType,t.canMerge=this.editor.canMergeCells(),t.borders=this.getCellBorder(),t.shading=this.getCellShading(),t},e.prototype.fetchRowFormat=function(e){var t={};return t.allowBreakAcrossPages=e.allowBreakAcrossPages,t.height=e.height,t.heightType=e.heightType,t.isHeader=e.isHeader,t},e.prototype.fetchList=function(e,t){var i={};return i.listId=e.listId,i.sourceListId=e.sourceListId,i.abstractListId=e.abstractListId,i.listLength=this.documentHelper.lists.length,i.abstractLength=this.documentHelper.abstractLists.length,JSON.stringify(i)},e.prototype.hasElementBox=function(){var e=!1;return this.errorElementInfo=this.spellChecker.findCurretText(),this.errorElementInfo.element&&(e=!0,this.spellChecker.currentContextInfo=this.errorElementInfo,this.errorElementInfo=this.spellChecker.retriveText()),e},e.prototype.fetchSectionFormat=function(e){var t={};t.topMargin=e.topMargin,t.bottomMargin=e.bottomMargin,t.leftMargin=e.leftMargin,t.rightMargin=e.rightMargin,t.pageHeight=e.pageHeight,t.pageWidth=e.pageWidth,t.footerDistance=e.footerDistance,t.headerDistance=e.headerDistance,t.differentFirstPage=e.differentFirstPage,t.differentOddAndEvenPages=e.differentOddAndEvenPages,t.numberOfColumns=e.numberOfColumns,t.equalWidth=e.equalWidth,t.lineBetweenColumns=e.lineBetweenColumns,t.columns=[];for(var i=0,r=e.columns;i<r.length;i++){var n=r[i],o={};o.width=n.width,o.space=n.space,t.columns.push(o)}return t},e.prototype.fetchStyleValue=function(e){var t={};return t.name=e.name,t.type=e.type,t.paragraphFormat=this.fetchParagraphFormat(e.paragraphFormat),t.characterFormat=this.fetchCharacterFormat(e.characterFormat),sf.base.isNullOrUndefined(e.next)||(t.next=e.next.name),sf.base.isNullOrUndefined(e.basedOn)||(t.basedOn=e.basedOn.name),sf.base.isNullOrUndefined(e.link)||(t.link=e.link.name),JSON.stringify(t)},e.prototype.fetchComments=function(){var e=this.getComments();return!sf.base.isNullOrUndefined(e)&&e.length>0?JSON.stringify(e):""},e.prototype.getComments=function(e){var t=[],i=e||this.documentHelper.comments;if(!sf.base.isNullOrUndefined(i)&&i.length>0){for(var r=0;r<i.length;r++){var n={},o=i[r];if(sf.base.isNullOrUndefined(o.commentStart)||sf.base.isNullOrUndefined(o.commentEnd))i.splice(r,1),r--;else{if(n.date=o.date,n.text=o.text,n.isReply=o.isReply,n.isResolved=o.isResolved,n.author=o.author,n.initial=o.initial,n.commentId=o.commentId,n.userColor=this.documentHelper.getAuthorColor(o.author),o.ownerComment&&o.ownerComment.commentId&&(n.ownerCommentId=o.ownerComment.commentId),!e){var s=this.getComments(o.replyComments);s&&s.length>0&&(n.replyComments=s)}t.push(n)}}return t}},e.prototype.getCellBorder=function(){if(!sf.base.isNullOrUndefined(this.selection.start.paragraph.associatedCell)){var e=this.selection.start.paragraph.associatedCell.cellFormat.borders;return this.sfdtExportModule.writeBorders(e)}return{}},e.prototype.getTableBorder=function(){if(!sf.base.isNullOrUndefined(this.selection.tableFormat.table)){var e=this.selection.tableFormat.table.tableFormat.borders;return this.sfdtExportModule.writeBorders(e)}return{}},e.prototype.getCellShading=function(){var e={};if(!sf.base.isNullOrUndefined(this.selection.tableFormat.table)){var t=this.selection.start.paragraph.associatedCell.cellFormat.shading;e.backgroundColor=t.backgroundColor,e.foregroundColor=t.foregroundColor,e.textureStyle=t.textureStyle}return e},e.prototype.getTableShading=function(){var e={};if(!sf.base.isNullOrUndefined(this.selection.start.paragraph.associatedCell)){var t=this.selection.start.paragraph.associatedCell.cellFormat.shading;e.backgroundColor=t.backgroundColor,e.foregroundColor=t.foregroundColor,e.textureStyle=t.textureStyle}return e},e.prototype.applyCellOption=function(e){if(this.documentHelper.owner.editorHistory.initComplexHistory(this.documentHelper.selection,"CellMarginsSelection"),this.documentHelper.owner.editorModule.initHistory("CellOptions"),!sf.base.isNullOrUndefined(this.documentHelper.selection.start.paragraph.associatedCell)){var t=this.documentHelper.selection.start.paragraph.associatedCell.ownerTable;t=t.combineWidget(this.viewer),this.applyCellmarginsValue(this.documentHelper.selection.start.paragraph.associatedCell.ownerRow.combineWidget(this.viewer),this.documentHelper.selection.start,this.documentHelper.selection.end,e),this.documentHelper.owner.editorModule.reLayout(this.documentHelper.selection,!1),sf.base.isNullOrUndefined(this.documentHelper.owner.editorHistory.currentHistoryInfo)||this.documentHelper.owner.editorHistory.updateComplexHistory()}},e.prototype.applyCellmarginsValue=function(e,t,i,r){if(this.applyCellMarginsInternal(e,r),i.paragraph.associatedCell.ownerRow!==e){var n=e.nextWidget;sf.base.isNullOrUndefined(n)||this.applyCellmarginsValue(n,t,i,r)}},e.prototype.applyCellMarginsInternal=function(e,t){if(!sf.base.isNullOrUndefined(this.documentHelper.owner.editorHistory.currentBaseHistoryInfo)){var i=e.childWidgets[0].cellFormat;t=this.documentHelper.owner.editorHistory.currentBaseHistoryInfo.addModifiedCellOptions(i,t,e.ownerTable)}sf.base.isNullOrUndefined(t)||this.applyCellMarginsForCells(e,t)},e.prototype.applyCellMarginsForCells=function(e,t){for(var i=e.childWidgets,r=0;r<i.length;r++)this.applySubCellMargins(i[r].cellFormat,t);this.calculateGridValue(i[0].ownerTable)},e.prototype.applySubCellMargins=function(e,t){e.leftMargin=t.leftMargin,e.topMargin=t.topMargin,e.rightMargin=t.rightMargin,e.bottomMargin=t.bottomMargin},e.prototype.calculateGridValue=function(e){e.isGridUpdated=!1,e.buildTableColumns(),e.isGridUpdated=!0,this.documentHelper.selection.owner.isLayoutEnabled=!0,this.documentHelper.layout.reLayoutTable(e),this.documentHelper.owner.editorModule.reLayout(this.documentHelper.selection),this.documentHelper.owner.editorModule.updateSelectionTextPosition(!0);var t=this.documentHelper.owner.editorHistory;t&&t.currentBaseHistoryInfo&&(t.currentBaseHistoryInfo.modifiedProperties.length>0&&t.currentBaseHistoryInfo.updateSelection(),t.updateHistory()),this.documentHelper.owner.editorModule.fireContentChange()},e.prototype.applyTableOption=function(e){if(this.documentHelper.owner.editorHistory.initComplexHistory(this.documentHelper.selection,"TableMarginsSelection"),this.documentHelper.owner.editorModule.initHistory("TableOptions"),!sf.base.isNullOrUndefined(this.documentHelper.selection.start.currentWidget.paragraph.associatedCell)){var t=this.documentHelper.selection.start.currentWidget.paragraph.associatedCell.ownerTable,i=(t=t.combineWidget(this.viewer)).tableFormat;sf.base.isNullOrUndefined(this.documentHelper.owner.editorHistory.currentBaseHistoryInfo)||this.documentHelper.owner.editorHistory.currentBaseHistoryInfo.addModifiedTableOptions(i),i.cellSpacing=e.cellSpacing,i.leftMargin=e.leftMargin,i.topMargin=e.topMargin,i.rightMargin=e.rightMargin,i.bottomMargin=e.bottomMargin,this.calculateGridValue(t),sf.base.isNullOrUndefined(this.documentHelper.owner.editorHistory.currentHistoryInfo)||this.documentHelper.owner.editorHistory.updateComplexHistory()}},e.prototype.applyTableProperties=function(e,t,i){this.documentHelper.owner.editorModule.initComplexHistory("TableProperties"),this.documentHelper.owner.editorModule.onTableFormat(e),this.documentHelper.owner.editorModule.onRowFormat(t),this.documentHelper.owner.editorModule.onCellFormat(i),this.documentHelper.owner.editorHistory.updateComplexHistory()},e.prototype.enableRepeatHeader=function(){var e=this.documentHelper.selection,t=e.start,i=e.end;e.isForward||(t=e.end,i=e.start);var r=t.paragraph.associatedCell,n=i.paragraph.associatedCell;return 0===r.ownerRow.index&&n.ownerTable.equals(r.ownerTable)},e.prototype.fireZoomFactorChange=function(){this.dotNetRef.invokeMethodAsync("ZoomFactorChange",this.documentHelper.zoomFactor)},e.prototype.fireBeforeFormFieldFill=function(e){this.dotNetRef.invokeMethodAsync("BeforeFieldFill",JSON.stringify(e))},e.prototype.fireAfterFormFieldFill=function(){},e.prototype.fireBeforePaneSwitch=function(e){this.dotNetRef.invokeMethodAsync("BeforePaneSwitch",e)},e.prototype.fireServiceFailure=function(e){},e.prototype.fireViewChange=function(){if(this.viewer&&this.documentHelper.pages.length>0&&this.viewer.visiblePages.length>0){var e=this.viewer.visiblePages,t={startPage:e[0].index+1,endPage:e[e.length-1].index+1};this.dotNetRef.invokeMethodAsync("ViewChange",JSON.stringify(t))}},e.prototype.fireCustomContextMenuSelect=function(e){},e.prototype.fireCustomContextMenuBeforeOpen=function(e){},e.prototype.showParagraphDialog=function(e){},e.prototype.showPageSetupDialog=function(){},e.prototype.showFontDialog=function(e){},e.prototype.showCellOptionsDialog=function(){},e.prototype.showTableOptionsDialog=function(){},e.prototype.showTableDialog=function(){},e.prototype.showTableOfContentsDialog=function(){},e.prototype.showStyleDialog=function(){},e.prototype.showHyperlinkDialog=function(){},e.prototype.showBookmarkDialog=function(){},e.prototype.showStylesDialog=function(){},e.prototype.showListDialog=function(){},e.prototype.showTablePropertiesDialog=function(){},e.prototype.showBordersAndShadingDialog=function(){},e.prototype.requiredModules=function(){this.parser=new wt(this.documentHelper),this.enablePrint&&sf.base.isNullOrUndefined(this.printModule)&&(this.printModule=new s),(this.enableSfdtExport||this.enableWordExport||this.enableTextExport||this.enableSelection||this.enableEditor)&&sf.base.isNullOrUndefined(this.sfdtExportModule)&&(this.sfdtExportModule=new li(this.documentHelper)),this.enableWordExport&&sf.base.isNullOrUndefined(this.wordExportModule)&&(this.wordExportModule=new si),this.enableTextExport&&sf.base.isNullOrUndefined(this.textExportModule)&&(this.textExportModule=new ai),(this.enableSelection||this.enableSearch||this.enableEditor)&&(sf.base.isNullOrUndefined(this.selectionModule)&&(this.selectionModule=new kt(this)),this.enableContextMenu),this.enableSearch&&(sf.base.isNullOrUndefined(this.searchModule)&&(this.searchModule=new Bt(this)),this.enableOptionsPane&&sf.base.isNullOrUndefined(this.optionsPaneModule)&&(this.optionsPaneModule=new _t)),sf.base.isNullOrUndefined(this.documentEditorSettings)||(this.documentEditorSettings.enableOptimizedTextMeasuring?this.textMeasureHelper=new hi(this.documentHelper):this.textMeasureHelper=new di(this.documentHelper)),this.enableEditor&&(sf.base.isNullOrUndefined(this.editorModule)&&(this.editorModule=new ii(this.documentHelper)),this.enableImageResizer&&sf.base.isNullOrUndefined(this.imageResizerModule)&&(this.imageResizerModule=new ri(this,this.documentHelper)),this.enableEditorHistory&&sf.base.isNullOrUndefined(this.editorHistoryModule)&&(this.editorHistoryModule=new ei(this)),this.enableHyperlinkDialog,this.enableTableDialog,this.enableBookmarkDialog,this.enableTableOfContentsDialog,this.enablePageSetupDialog,this.enableStyleDialog,this.enableListDialog,this.enableParagraphDialog,this.enableFontDialog,this.enableTablePropertiesDialog,this.enableBordersAndShadingDialog,this.enableTableOptionsDialog,this.enableSpellCheck,this.enableFormField)},e.prototype.open=function(e){sf.base.isNullOrUndefined(this.viewer)||(this.showComments=!1,this.clearPreservedCollectionsInViewer(),this.documentHelper.userCollection.push("Everyone"),this.documentHelper.lists=[],this.documentHelper.abstractLists=[],this.documentHelper.styles=new mt,this.documentHelper.cachedPages=[],this.showRevisions=!1,this.isSpellCheck&&!this.spellChecker.enableOptimizedSpellCheck&&(this.documentHelper.triggerElementsOnLoading=!0,this.documentHelper.triggerSpellCheck=!0),!sf.base.isNullOrUndefined(e)&&this.viewer&&(this.documentHelper.setDefaultDocumentFormat(),this.documentHelper.onDocumentChanged(this.parser.convertJsonToDocument(e)),this.editorModule&&this.editorModule.intializeDefaultStyles()),this.isSpellCheck&&!this.spellChecker.enableOptimizedSpellCheck&&(this.documentHelper.triggerElementsOnLoading=!1,this.documentHelper.triggerSpellCheck=!1))},e.prototype.scrollToPage=function(e){return!(sf.base.isNullOrUndefined(this.viewer)||e<1||e>this.documentHelper.pages.length)&&(this.viewer.scrollToPage(e-1),!0)},e.prototype.enableAllModules=function(){this.enablePrint=this.enableSfdtExport=this.enableWordExport=this.enableTextExport=this.enableSelection=this.enableContextMenu=this.enableSearch=this.enableOptionsPane=this.enableEditor=this.enableImageResizer=this.enableEditorHistory=this.enableHyperlinkDialog=this.enableTableDialog=this.enableBookmarkDialog=this.enableTableOfContentsDialog=this.enablePageSetupDialog=this.enableStyleDialog=this.enableListDialog=this.enableParagraphDialog=this.enableFontDialog=this.enableTablePropertiesDialog=this.enableBordersAndShadingDialog=this.enableTableOptionsDialog=this.enableComment=this.enableFormField=!0,this.requiredModules()},e.prototype.resize=function(e,t){this.element&&(!sf.base.isNullOrUndefined(e)&&e>200&&(this.element.style.width=e+"px"),!sf.base.isNullOrUndefined(t)&&t>200&&(this.element.style.height=t+"px")),this.documentHelper&&this.documentHelper.updateViewerSize()},e.prototype.getFormFieldNames=function(){for(var e=[],t=this.documentHelper.formFields,i=0;i<t.length;i++)""!==t[i].formFieldData.name&&e.push(t[parseInt(i.toString(),10)].formFieldData.name);return e},e.prototype.exportAsImage=function(e,t){if(sf.base.isNullOrUndefined(this.viewer))throw new Error("Invalid operation.");if(this.printModule){var i="Png"===t?"image/png":"image/jpeg";return this.printModule.exportAsImage(this.documentHelper,e,i)}},e.prototype.exportAsPath=function(e){if(!sf.base.isNullOrUndefined(e)&&e<=this.documentHelper.pages.length&&e>=1){var t=this.documentHelper.pages[e-1];this.documentHelper.render.isExporting=!0,this.documentHelper.render.renderWidgets(t,0,0,0,0);var i=this.documentHelper.render.pageCanvas.toDataURL();return this.documentHelper.render.pageCanvas.getContext("2d").renderedPath="",this.documentHelper.render.isExporting=!1,i}},e.prototype.getFormFieldInfo=function(e){for(var t=this.documentHelper.formFields,i=0;i<t.length;i++)if(t[i].formFieldData.name===e&&""!==t[i].formFieldData.name)return t[parseInt(i.toString(),10)].formFieldData.getFormFieldInfo()},e.prototype.setFormFieldInfo=function(e,t){for(var i=this.documentHelper.formFields,r=0;r<i.length;r++)if(i[parseInt(r.toString(),10)].formFieldData.name===e&&""!==i[parseInt(r.toString(),10)].formFieldData.name){var n=i[parseInt(r.toString(),10)];return void(this.selection&&(this.selection.selectFieldInternal(n),this.editor&&this.editor.setFormField(n,t)))}},e.prototype.resetFormFields=function(e){for(var t=this.documentHelper.formFields,i=0;i<t.length;i++)(sf.base.isNullOrUndefined(e)||e===t[parseInt(i.toString(),10)].formFieldData.name)&&(t[parseInt(i.toString(),10)].formFieldData instanceof ye?this.editor.updateFormField(t[parseInt(i.toString(),10)],t[parseInt(i.toString(),10)].formFieldData.defaultValue,!0):t[parseInt(i.toString(),10)].formFieldData instanceof ve?this.editor.toggleCheckBoxFormField(t[parseInt(i.toString(),10)],!0,t[parseInt(i.toString(),10)].formFieldData.defaultValue):t[parseInt(i.toString(),10)].formFieldData instanceof be&&this.editor.updateFormField(t[parseInt(i.toString(),10)],0,!0))},e.prototype.importFormData=function(e){for(var t=this.documentHelper.formFields,i=0;i<e.length;i++)for(var r=e[parseInt(i.toString(),10)],n=r.fieldName,o=0;o<t.length;o++)t[parseInt(o.toString(),10)].formFieldData.name===n&&(t[parseInt(o.toString(),10)].formFieldData instanceof ve?this.editor.toggleCheckBoxFormField(t[parseInt(o.toString(),10)],!0,r.value):(t[parseInt(o.toString(),10)].formFieldData instanceof ye||t[parseInt(o.toString(),10)].formFieldData instanceof be)&&this.editor.updateFormField(t[parseInt(o.toString(),10)],r.value))},e.prototype.exportFormData=function(){for(var e=[],t=this.documentHelper.formFields,i=0;i<t.length;i++)if(""!==t[parseInt(i.toString(),10)].formFieldData.name){var r={fieldName:"",value:""};if(r.fieldName=t[parseInt(i.toString(),10)].formFieldData.name,t[parseInt(i.toString(),10)].formFieldData instanceof ve)r.value=t[parseInt(i.toString(),10)].formFieldData.checked;else if(t[parseInt(i.toString(),10)].formFieldData instanceof ye){var n="",o=RegExp(this.documentHelper.textHelper.getEnSpaceCharacter(),"gi");""===n.replace(o,"")&&(n=""),r.value=n}else t[parseInt(i.toString(),10)].formFieldData instanceof be&&(r.value=t[parseInt(i.toString(),10)].formFieldData.selectedIndex);e.push(r)}return e},e.prototype.updateFields=function(){for(var e=0;e<this.documentHelper.fields.length;e++){var t=this.documentHelper.fields[parseInt(e.toString(),10)];0===this.selection.getFieldCode(t).toLowerCase().trim().indexOf("ref ")&&this.selection.updateRefField(t)}},e.prototype.focusIn=function(){this.viewer&&this.documentHelper.updateFocus()},e.prototype.fitPage=function(e){sf.base.isNullOrUndefined(e)&&(e="None"),this.viewer&&(this.viewer.pageFitType=e)},e.prototype.print=function(e){if(sf.base.isNullOrUndefined(this.viewer))throw new Error("Invalid operation.");if(!this.printModule)throw new Error("Invalid operation. Print is not enabled.");"Continuous"===this.layoutType?(this.documentHelper.isWebPrinting=!0,this.viewer=new X(this),this.editor.layoutWholeDocument(),this.printModule.print(this.documentHelper,e),this.viewer=new Z(this),this.editor.layoutWholeDocument(),this.documentHelper.isWebPrinting=!1):this.printModule.print(this.documentHelper,e)},e.prototype.serialize=function(){if(!(this.enableSfdtExport&&this.sfdtExportModule instanceof li))throw new Error("Invalid operation. Sfdt export is not enabled.");return this.sfdtExportModule.serialize()},e.prototype.save=function(e,t){if(e=e||"Untitled",sf.base.isNullOrUndefined(this.documentHelper))throw new Error("Invalid operation.");if("Docx"===t&&this.wordExportModule)this.wordExportModule&&this.wordExportModule.save(this.documentHelper,e);else if("Txt"===t&&this.textExportModule)this.textExportModule.save(this.documentHelper,e);else{if("Sfdt"!==t||!this.enableSfdtExport||!this.sfdtExportModule)throw new Error("Invalid operation. Specified export is not enabled.");var i=this.serialize(),r=new Blob([i],{type:"application/json"});sf.fileutils.Save.save(e+".sfdt",r)}},e.prototype.saveAsBlob=function(e){var t=this;if(sf.base.isNullOrUndefined(this.viewer))throw new Error("Invalid operation");return new Promise((function(i,r){"Docx"===e&&t.wordExportModule?i(t.wordExportModule.saveAsBlob(t.documentHelper)):"Txt"===e&&t.textExportModule?i(t.textExportModule.saveAsBlob(t.documentHelper)):"Sfdt"===e&&t.enableSfdtExport&&t.sfdtExportModule&&i(t.sfdtExportModule.saveAsBlob(t.documentHelper))}))},e.prototype.openBlank=function(){var e=[];e.push(this.createNewBodyWidget());var t=this.parser.parseHeaderFooter({header:{},footer:{},evenHeader:{},evenFooter:{},firstPageHeader:{},firstPageFooter:{}},void 0);if(this.viewer){if(this.clearPreservedCollectionsInViewer(),this.documentHelper.userCollection.push("Everyone"),this.documentHelper.cachedPages=[],this.documentHelper.setDefaultDocumentFormat(),this.documentHelper.headersFooters.push(t),this.editorModule){this.editorModule.intializeDefaultStyles();for(var i=this.documentHelper.styles.findByName("Normal"),r=0;r<e.length;r++){var n=e[parseInt(r.toString(),10)].childWidgets[0];n.paragraphFormat.baseStyle=i,n.paragraphFormat.listFormat.baseStyle=i}}this.documentHelper.onDocumentChanged(e)}},e.prototype.createNewBodyWidget=function(){var e=new ne;e.index=0,e.sectionFormat=new d(e),this.sectionFormat&&this.parser.parseSectionFormat(this.sectionFormat,e.sectionFormat);var t=new le;return t.index=0,t.paragraphFormat=new ct(t),t.characterFormat=new P(t),e.childWidgets.push(t),t.containerWidget=e,e},e.prototype.getStyleNames=function(e){return this.viewer?this.documentHelper.styles.getStyleNames(e):[]},e.prototype.getStyles=function(e){return this.viewer?this.documentHelper.styles.getStyles(e):[]},e.prototype.getBookmarks=function(){var e=[];return this.viewer&&(e=this.documentHelper.getBookmarks(!0)),e},e.prototype.showDialog=function(e){this.dotNetRef.invokeMethodAsync("ShowDialog",e)},e.prototype.showOptionsPane=function(){},e.prototype.showRestrictEditingPane=function(){},e.prototype.destroy=function(){this.destroyDependentModules(),sf.base.isNullOrUndefined(this.documentHelper)||this.documentHelper.destroy(),this.viewer=void 0,this.findResultsList=[],this.findResultsList=void 0},e.prototype.destroyDependentModules=function(){this.printModule&&(this.printModule.destroy(),this.printModule=void 0),this.sfdtExportModule&&(this.sfdtExportModule.destroy(),this.sfdtExportModule=void 0),this.optionsPaneModule&&(this.optionsPaneModule=void 0),this.trackChangesPane&&(this.trackChangesPane.destroy(),this.trackChangesPane=void 0),this.searchModule&&(this.searchModule.destroy(),this.searchModule=void 0),this.editorModule&&(this.editorModule.destroy(),this.editorModule=void 0),this.selectionModule&&(this.selectionModule.destroy(),this.selectionModule=void 0),this.editorHistoryModule&&(this.editorHistoryModule.destroy(),this.editorHistoryModule=void 0),this.textExportModule&&(this.textExportModule.destroy(),this.textExportModule=void 0),this.wordExportModule&&(this.wordExportModule.destroy(),this.wordExportModule=void 0),this.spellCheckerModule&&(this.spellCheckerModule.destroy(),this.spellCheckerModule=void 0)},e}(),pi=function(e,t,i,r){return new(i||(i=Promise))((function(n,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){e.done?n(e.value):new i((function(t){t(e.value)})).then(s,a)}l((r=r.apply(e,t||[])).next())}))},ui=function(e,t){var i,r,n,o,s={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(i)throw new TypeError("Generator is already executing.");for(;s;)try{if(i=1,r&&(n=2&o[0]?r.return:o[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,o[1])).done)return n;switch(r=0,n&&(o=[2&o[0],n.value]),o[0]){case 0:case 1:n=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(n=s.trys,(n=n.length>0&&n[n.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){s.label=o[1];break}if(6===o[0]&&s.label<n[1]){s.label=n[1],n=o;break}if(n&&s.label<n[2]){s.label=n[2],s.ops.push(o);break}n[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],r=0}finally{i=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}};return{sendHandler:null,info:null,isSpellChecking:null,elementRef:null,dotnetRef:null,initialize:function(e,t,i,r,n){sf.base.enableBlazorMode();var o=new ci(e,t,r,i,n);o.preRender(),o.render(),this.elementRef=t,this.dotnetRef=r,this.sendHandler=W.prototype.send,W.prototype.send=this.docEditRequestHandler.bind(this)},destroy:function(e){var t=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t.element)||(t.isDestroyed=!0)},updateOptions:function(e,t,i){var r=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(r)||sf.base.isNullOrUndefined(r.element)||(r.setOptions(t,r.options,!0),r.options=t)},getClientSizeFromDOM:function(e){var t=e.getBoundingClientRect();return t.width+":"+t.height},checkAndAutoResizeDocumentEditor:function(e,t,i){var r=this.getClientSizeFromDOM(t);if(i!==r&&"0:0"!==r){i=r;var n=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.element)||n.resize()}return i},docEditRequestHandler:function(e){return pi(this,void 0,void 0,(function(){var t,i;return ui(this,(function(r){switch(r.label){case 0:return"string"!=typeof e?[3,1]:(""!==JSON.parse(e).LanguageID&&this.sendHandler.call(e),[3,3]);case 1:return e.action="SystemClipboard",[4,this.dotnetRef.invokeMethodAsync("SystemClipboard",e)];case 2:t=r.sent(),i={data:JSON.parse(t)},window.sfBlazor.getCompInstance(e.dataId).editor.pasteRequestHandler.successHandler(i),r.label=3;case 3:return[2]}}))}))},openblank:function(e){var t=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t.element)||t.openBlank()},loadDocument:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||i.open(t)},insertTable:function(e,t,i){var r=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(r)||sf.base.isNullOrUndefined(r.element)||r.editor.insertTable(t,i)},goToHeader:function(e){var t=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t.element)||t.selection.goToHeader()},goToFooter:function(e){var t=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t.element)||t.selection.goToFooter()},insertPageNumber:function(e){var t=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t.element)||t.editor.insertPageNumber()},undo:function(e){var t=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t.element)||t.editorHistory.undo()},redo:function(e){var t=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t.element)||t.editorHistory.redo()},updateFields:function(e){var t=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t.element)||t.updateFields()},canUndo:function(e){var t,i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(t=i.editorHistory.canUndo()),t},canRedo:function(e){var t,i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(t=i.editorHistory.canRedo()),t},getBookMarks:function(e){var t,i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(t=i.getBookmarks()),t},getText:function(e,t){var i=void 0,r=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(r)||sf.base.isNullOrUndefined(r.element)||(i=r.selection.getText(t)),i},sfdt:function(e,t){var i=void 0,r=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(r)||sf.base.isNullOrUndefined(r.element)||(i=r.selection.sfdt),i},insertHyperlinkInternal:function(e,t,i,r,n){var o=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(o)||sf.base.isNullOrUndefined(o.element)||o.editor.insertHyperlinkInternal(t,i,r,n)},insertTableOfContents:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||i.editor.insertTableOfContents(t)},insertText:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||i.editor.insertText(t)},applyStyle:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||i.editor.applyStyle(t)},insertRow:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||i.editor.insertRow(t)},insertColumn:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||i.editor.insertColumn(t)},deleteTable:function(e){var t=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t.element)||t.editor.deleteTable()},deleteRow:function(e){var t=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t.element)||t.editor.deleteRow()},deleteColumn:function(e){var t=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t.element)||t.editor.deleteColumn()},canMergeCells:function(e){var t=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t.element)||t.editor.canMergeCells()},insertPageBreak:function(e){var t=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t.element)||t.editor.insertPageBreak()},toggleBold:function(e){var t=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t.element)||t.editor.toggleBold()},toggleItalic:function(e){var t=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t.element)||t.editor.toggleItalic()},toggleSubscript:function(e){var t=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t.element)||t.editor.toggleSubscript()},toggleSuperscript:function(e){var t=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t.element)||t.editor.toggleSuperscript()},toggleUnderline:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||i.editor.toggleUnderline(t)},toggleHighlightColor:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||i.editor.toggleHighlightColor(t)},toggleStrikethrough:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||i.editor.toggleStrikethrough(t)},toggleTextAlignment:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||i.editor.toggleTextAlignment(t)},toggleBaselineAlignment:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||i.editor.toggleBaselineAlignment(t)},applyBullet:function(e,t,i){var r=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(r)||sf.base.isNullOrUndefined(r.element)||r.editor.applyBullet(t,i)},applyNumbering:function(e,t,i){var r=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(r)||sf.base.isNullOrUndefined(r.element)||(t="%"+(r.selection.paragraphFormat.listLevelNumber+1)+".",r.editor.applyNumbering(t,i))},paste:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||i.editor.paste(t)},clearFormatting:function(e){var t=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t.element)||t.editor.clearFormatting()},createStyle:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||i.editor.createStyle(i.documentHelper.preDefinedStyles.get(t))},closeHeaderFooter:function(e){var t=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t.element)||t.selection.closeHeaderFooter()},selectAll:function(e){var t=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t.element)||t.selection.selectAll()},selectLine:function(e){var t=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t.element)||t.selection.selectLine()},selectCurrentWord:function(e){var t=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t.element)||t.selection.selectCurrentWord()},selectParagraph:function(e){var t=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t.element)||t.selection.selectParagraph()},selectTable:function(e){var t=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t.element)||t.selection.selectTable()},mergeCells:function(e){var t=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t.element)||t.editor.mergeCells()},autoFitTable:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||i.editor.autoFitTable(t)},fitPage:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||i.fitPage(t)},updateZoomFactor:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||i.setOptions({zoomFactor:parseInt(t,0)/100},{zoomFactor:i.options.zoomFactor},!1)},goToPage:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||i.selection.goToPage(t)},extendToWordStart:function(e){var t=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t.element)||t.selection.extendToWordStart()},insertEditingRegion:function(e){var t=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t.element)||t.editor.insertEditingRegion()},moveToLineStart:function(e){var t=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t.element)||t.selection.moveToLineStart()},insertSectionBreak:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||i.editor.insertSectionBreak(t)},insertColumnBreak:function(e){var t=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t.element)||t.editor.insertColumnBreak()},enforceProtection:function(e,t,i,r){var n=window.sfBlazor.getCompInstance(e);if(!sf.base.isNullOrUndefined(n)&&!sf.base.isNullOrUndefined(n.element)){var o=[t,i],s={data:JSON.stringify(o)};n.editor.enforceProtectionInternal(s,r)}},stopProtection:function(e,t,i){var r=window.sfBlazor.getCompInstance(e);if(!sf.base.isNullOrUndefined(r)&&!sf.base.isNullOrUndefined(r.element)){var n=[t,i],o={data:JSON.stringify(n)};r.editor.onUnProtectionSuccess(o)}return r.documentHelper.isDocumentProtected},getCurrentSaltValue:function(e){var t=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t.element)?"":t.documentHelper.saltValue},insertEditRangeElement:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(i.selection.isHighlightEditRegion=!0,i.editor.insertEditRangeElement(t))},removeUserRestrictions:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||i.editor.removeUserRestrictions(t)},setIsHighlightEditRegion:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(i.selection.isHighlightEditRegion=t)},navigateNextEditRegion:function(e){var t=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t.element)||t.selection.navigateToNextEditingRegion()},showAllEditingRegion:function(e){var t=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t.element)||t.selection.showAllEditingRegion()},deleteComment:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||i.editor.deleteCommentInternal(this.getComment(e,t))},getCurrentEditRangeUser:function(e){var t=window.sfBlazor.getCompInstance(e);if(!sf.base.isNullOrUndefined(t)&&!sf.base.isNullOrUndefined(t.element)&&t.documentHelper.selection.checkSelectionIsAtEditRegion()){var i=t.documentHelper.selection.getEditRangeStartElement();if(i)return i.user}return""},hasEditRange:function(e){var t=window.sfBlazor.getCompInstance(e);return!sf.base.isNullOrUndefined(t)&&!sf.base.isNullOrUndefined(t.element)&&t.documentHelper.editRanges.length>0},resolveReOpenComment:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(t.isResolved?i.editor.resolveComment(this.getComment(e,t)):i.editor.reopenComment(this.getComment(e,t)))},updateCommentText:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(this.getComment(e,t).text=t.text)},addEmptyComment:function(e){var t=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t.element)||t.selection.selectComment(t.editor.insertCommentInternal(""))},addReplyComment:function(e,t,i){var r,n=window.sfBlazor.getCompInstance(e);if(!sf.base.isNullOrUndefined(n)&&!sf.base.isNullOrUndefined(n.element)){var o=this.getComment(e,t);n.editor.replyComment(o,i),r=JSON.stringify(n.editor.getCommentObj(o.replyComments[o.replyComments.length-1]))}return r},selectComment:function(e,t){var i=window.sfBlazor.getCompInstance(e);if(!sf.base.isNullOrUndefined(i)&&!sf.base.isNullOrUndefined(i.element)){var r=this.getComment(e,t);i.selection.selectComment(r)}},updateCommentPaneHeight:function(e,t){var i=window.sfBlazor.getCompInstance(e);if(!sf.base.isNullOrUndefined(i)&&!sf.base.isNullOrUndefined(i.element)){var r,n=i.element.getBoundingClientRect();r=n.height>0?n.height:200;var o=t.getElementsByClassName("e-tab-header")[0].getBoundingClientRect().height,s=t.getElementsByClassName("e-de-cmt-toolbar")[0].getBoundingClientRect().height;t.getElementsByClassName("e-de-cmt-container")[0].style.height=r-o-s+"px"}},setFocusToElement:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||t.focus()},updateTextBoxHeight:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||setTimeout((function(){t.style.height="auto";var e=t.scrollHeight;t.style.height=e+"px"}))},getComment:function(e,t){var i=window.sfBlazor.getCompInstance(e);if(!sf.base.isNullOrUndefined(i)&&!sf.base.isNullOrUndefined(i.element))for(var r=i.documentHelper.comments,n=0;n<r.length;n++)if(t.isReply)for(var o=0;o<r[n].replyComments.length;o++){var s=r[n].replyComments[o];if(s.commentId==t.commentId)return s}else if(r[n].commentId==t.commentId)return r[n]},navigateNextComment:function(e){var t=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t.element)||t.selection.navigateNextComment()},navigatePreviousComment:function(e){var t=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t.element)||t.selection.navigatePreviousComment()},increaseIndent:function(e){var t=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t.element)||t.editor.increaseIndent()},decreaseIndent:function(e){var t=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t.element)||t.editor.decreaseIndent()},insertField:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||i.editor.insertField(t)},getIsInField:function(e){var t,i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(t=i.selection.isInField),t},insertHyperlink:function(e,t,i){var r=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(r)||sf.base.isNullOrUndefined(r.element)||r.editor.insertHyperlink(t,i)},removeHyperlink:function(e){var t=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t.element)||t.editor.removeHyperlink()},insertBookmark:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||i.editor.insertBookmark(t)},clearList:function(e){var t=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t.element)||t.editor.clearList()},setRedoLimit:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(i.editorHistory.redoLimit=t)},getRedoLimit:function(e){var t,i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(t=i.editorHistory.redoLimit),t},setIndex:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||setTimeout((function(){var e=document.activeElement;i.searchModule.searchResults.index=t,e.focus()}),10)},getIndex:function(e){var t,i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(t=i.searchModule.searchResults.index),t},findAll:function(e,t,i){var r=window.sfBlazor.getCompInstance(e);return!sf.base.isNullOrUndefined(r)&&!sf.base.isNullOrUndefined(r.element)&&(r.documentHelper.owner.findResultsList=[],r.searchModule.findAll(t,i),r.searchModule.textSearchResults.length>0)?(r.searchModule.addFindResultView(r.searchModule.textSearchResults),r.documentHelper.owner.findResultsList):[]},find:function(e,t,i){var r,n,o=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(o)||sf.base.isNullOrUndefined(o.element)||(o.documentHelper.owner.findResultsList=[],r=o.searchModule.textSearch.findAll(t,i),sf.base.isNullOrUndefined(r)||(o.searchModule.addFindResultView(r),n=o.documentHelper.owner.findResultsList)),n},navigateNextResult:function(e,t,i){var r=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(r)||sf.base.isNullOrUndefined(r.element)||r.searchModule.find(t,i)},navigatePreviousResult:function(e,t,i){var r=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(r)||sf.base.isNullOrUndefined(r.element)||r.searchModule.find(t,i)},replace:function(e,t,i,r){var n=window.sfBlazor.getCompInstance(e);if(!sf.base.isNullOrUndefined(n)&&!sf.base.isNullOrUndefined(n.element)){var o=n.documentHelper,s=o.owner.searchModule.textSearchResults;if(""!==t&&!sf.base.isNullOrUndefined(t)&&null!=o.owner.selection){var a=o.owner.selection.text;if(o.owner.selection.isEmpty||(o.owner.selection.isForward?o.owner.selection.selectContent(o.owner.selection.start,!0):o.owner.selection.selectContent(o.owner.selection.end,!0)),!sf.base.isNullOrUndefined(s)&&!sf.base.isNullOrUndefined(s.currentSearchResult)){var l=s.currentSearchResult;if(o.owner.searchModule.navigate(l),l.text===a){var h=sf.base.isNullOrUndefined(i)?"":i;o.owner.searchModule.replace(h,l,s)}}}}},replaceAll:function(e,t,i){var r=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(r)||sf.base.isNullOrUndefined(r.element)||r.searchModule.replaceAllInternal(t,i)},getsearchresults:function(e){var t=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t.element)||t.searchModule.searchResults},clear:function(e){var t=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t.element)||t.searchModule.searchResults.clear},setBackground:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(i.selection.cellFormat.background=t)},getBackground:function(e){var t,i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(t=i.selection.cellFormat.background),t},setBottomMargin:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(i.selection.cellFormat.bottomMargin=t)},getBottomMargin:function(e){var t,i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(t=i.selection.cellFormat.bottomMargin),t},setLeftMargin:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(i.selection.cellFormat.leftMargin=t)},getLeftMargin:function(e){var t,i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(t=i.selection.cellFormat.leftMargin),t},setPreferredWidth:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(i.selection.cellFormat.preferredWidth=t)},getPreferredWidth:function(e){var t,i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(t=i.selection.cellFormat.preferredWidth),t},setRightMargin:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(i.selection.cellFormat.rightMargin=t)},getRightMargin:function(e){var t,i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(t=i.selection.cellFormat.rightMargin),t},setTopMargin:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(i.selection.cellFormat.topMargin=t)},getTopMargin:function(e){var t,i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(t=i.selection.cellFormat.topMargin),t},setPreferredWidthType:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(i.selection.cellFormat.preferredWidthType=t)},getPreferredWidthType:function(e){var t,i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(t=i.selection.cellFormat.preferredWidthType),t},setVerticalAlignment:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(i.selection.cellFormat.verticalAlignment=t)},getVerticalAlignment:function(e){var t,i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(t=i.selection.cellFormat.verticalAlignment),t},insertImage:function(e,t,i,r){var n=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.element)||n.editor.insertImage(t,i,r)},resizeWindow:function(e){var t=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t.element)||setTimeout((function(){t.resize()}),100)},resize:function(e,t,i){var r=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(r)||sf.base.isNullOrUndefined(r.element)||r.selection.imageFormat.resize(t,i)},getImageHeight:function(e){var t=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t.element)||t.selection.imageFormat.height},getImageWidth:function(e){var t=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t.element)||t.selection.imageFormat.width},setAfterSpacing:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(i.selection.paragraphFormat.afterSpacing=t)},getAfterSpacing:function(e){var t,i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(t=i.selection.paragraphFormat.afterSpacing),t},setBeforeSpacing:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(i.selection.paragraphFormat.beforeSpacing=t)},getBeforeSpacing:function(e){var t,i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(t=i.selection.paragraphFormat.beforeSpacing),t},setBidi:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(i.selection.paragraphFormat.bidi=t)},getBidi:function(e){var t,i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(t=i.selection.paragraphFormat.bidi),t},setContextualSpacing:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(i.selection.paragraphFormat.contextualSpacing=t)},getContextualSpacing:function(e){var t,i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(t=i.selection.paragraphFormat.contextualSpacing),t},setFirstLineIndent:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(i.selection.paragraphFormat.firstLineIndent=t)},getFirstLineIndent:function(e){var t,i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(t=i.selection.paragraphFormat.firstLineIndent),t},setLeftIndent:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(i.selection.paragraphFormat.leftIndent=t)},getLeftIndent:function(e){var t,i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(t=i.selection.paragraphFormat.leftIndent),t},setLineSpacing:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(i.selection.paragraphFormat.lineSpacing=t)},getLineSpacing:function(e){var t,i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(t=i.selection.paragraphFormat.lineSpacing),t},setListLevelNumber:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(i.selection.paragraphFormat.listLevelNumber=t)},getListLevelNumber:function(e){var t,i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(t=i.selection.paragraphFormat.listLevelNumber),t},setRightIndent:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(i.selection.paragraphFormat.rightIndent=t)},getRightIndent:function(e){var t,i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(t=i.selection.paragraphFormat.rightIndent),t},getListText:function(e){var t=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t.element)||t.selection.paragraphFormat.listText},setLineSpacingType:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(i.selection.paragraphFormat.lineSpacingType=t)},getLineSpacingType:function(e){var t,i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(t=i.selection.paragraphFormat.lineSpacingType),t},setTextAlignment:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(i.selection.paragraphFormat.textAlignment=t)},getTextAlignment:function(e){var t,i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(t=i.selection.paragraphFormat.textAlignment),t},setBaselineAlignment:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(i.selection.characterFormat.baselineAlignment=t)},getBaselineAlignment:function(e){var t,i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(t=i.selection.characterFormat.baselineAlignment),t},setBold:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(i.selection.characterFormat.bold=t)},getBold:function(e){var t,i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(t=i.selection.characterFormat.bold),t},setItalic:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(i.selection.characterFormat.italic=t)},getItalic:function(e){var t,i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(t=i.selection.characterFormat.italic),t},setFontColor:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(i.selection.characterFormat.fontColor=t)},getFontColor:function(e){var t,i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(t=i.selection.characterFormat.fontColor),t},setFontFamily:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(i.selection.characterFormat.fontFamily=t)},getFontFamily:function(e){var t,i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(t=i.selection.characterFormat.fontFamily),t},setFontSize:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(i.selection.characterFormat.fontSize=t)},exportAsImage:function(e,t,i){var r,n=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.element)||(r=n.exportAsImage(t,i)),r},getFontSize:function(e){var t,i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(t=i.selection.characterFormat.fontSize),t},setHighlightColor:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(i.selection.characterFormat.highlightColor=t)},getHighlightColor:function(e){var t,i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(t=i.selection.characterFormat.highlightColor),t},setStrikethrough:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(i.selection.characterFormat.strikethrough=t)},getStrikethrough:function(e){var t,i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(t=i.selection.characterFormat.strikethrough),t},setUnderline:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(i.selection.characterFormat.underline=t)},getUnderline:function(e){var t,i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(t=i.selection.characterFormat.underline),t},selectRow:function(e){var t=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t.element)||t.selection.selectRow()},setAllowBreakAcrossPages:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(i.selection.rowFormat.allowBreakAcrossPages=t)},getAllowBreakAcrossPages:function(e){var t,i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(t=i.selection.rowFormat.allowBreakAcrossPages),t},setIsHeader:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(i.selection.rowFormat.isHeader=t)},getIsHeader:function(e){var t,i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(t=i.selection.rowFormat.isHeader),t},setRowHeight:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(i.selection.rowFormat.height=t)},getRowHeight:function(e){var t,i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(t=i.selection.rowFormat.height),t},setHeightType:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(i.selection.rowFormat.heightType=t)},getHeightType:function(e){var t,i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(t=i.selection.rowFormat.heightType),t},setSectionBottomMargin:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(i.selection.sectionFormat.bottomMargin=t)},getSectionBottomMargin:function(e){var t,i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(t=i.selection.sectionFormat.bottomMargin),t},setFooterDistance:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(i.selection.sectionFormat.footerDistance=t)},getFooterDistance:function(e){var t,i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(t=i.selection.sectionFormat.footerDistance),t},setHeaderDistance:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(i.selection.sectionFormat.headerDistance=t)},getHeaderDistance:function(e){var t,i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(t=i.selection.sectionFormat.headerDistance),t},setSectionLeftMargin:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(i.selection.sectionFormat.leftMargin=t)},getSectionLeftMargin:function(e){var t,i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(t=i.selection.sectionFormat.leftMargin),t},setPageHeight:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(i.selection.sectionFormat.pageHeight=t)},getPageHeight:function(e){var t,i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(t=i.selection.sectionFormat.pageHeight),t},setPageWidth:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(i.selection.sectionFormat.pageWidth=t)},getPageWidth:function(e){var t,i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(t=i.selection.sectionFormat.pageWidth),t},setSectionRightMargin:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(i.selection.sectionFormat.rightMargin=t)},getSectionRightMargin:function(e){var t,i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(t=i.selection.sectionFormat.rightMargin),t},setSectionTopMargin:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(i.selection.sectionFormat.topMargin=t)},getSectionTopMargin:function(e){var t,i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(t=i.selection.sectionFormat.topMargin),t},setDifferentFirstPage:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(i.selection.sectionFormat.differentFirstPage=t)},getDifferentFirstPage:function(e){var t,i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(t=i.selection.sectionFormat.differentFirstPage),t},setDifferentOddAndEvenPages:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(i.selection.sectionFormat.differentOddAndEvenPages=t)},getDifferentOddAndEvenPages:function(e){var t,i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(t=i.selection.sectionFormat.differentOddAndEvenPages),t},setTableBackground:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(i.selection.tableFormat.background=t)},getTableBackground:function(e){var t,i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(t=i.selection.tableFormat.background),t},setTableBottomMargin:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(i.selection.tableFormat.bottomMargin=t)},getTableBottomMargin:function(e){var t,i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(t=i.selection.tableFormat.bottomMargin),t},setTableCellSpacing:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(i.selection.tableFormat.cellSpacing=t)},getTableCellSpacing:function(e){var t,i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(t=i.selection.tableFormat.cellSpacing),t},setTableLeftIndent:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(i.selection.tableFormat.leftIndent=t)},getTableLeftIndent:function(e){var t,i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(t=i.selection.tableFormat.leftIndent),t},setTableLeftMargin:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(i.selection.tableFormat.leftMargin=t)},getTableLeftMargin:function(e){var t,i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(t=i.selection.tableFormat.leftMargin),t},setTablePreferredWidth:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(i.selection.tableFormat.preferredWidth=t)},getTablePreferredWidth:function(e){var t,i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(t=i.selection.tableFormat.preferredWidth),t},setTableRightMargin:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(i.selection.tableFormat.rightMargin=t)},getTableRightMargin:function(e){var t,i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(t=i.selection.tableFormat.rightMargin),t},setTableTopMargin:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(i.selection.tableFormat.topMargin=t)},getTableTopMargin:function(e){var t,i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(t=i.selection.tableFormat.topMargin),t},setTableBidi:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(i.selection.tableFormat.bidi=t)},getTableBidi:function(e){var t,i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(t=i.selection.tableFormat.bidi),t},setTablePreferredWidthType:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(i.selection.tableFormat.preferredWidthType=t)},getTablePreferredWidthType:function(e){var t,i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(t=i.selection.tableFormat.preferredWidthType),t},setTableAlignment:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(i.selection.tableFormat.tableAlignment=t)},getTableAlignment:function(e){var t,i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(t=i.selection.tableFormat.tableAlignment),t},getListFormat:function(e){var t,i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(t=i.selection.start.paragraph.paragraphFormat.listFormat),t},getList:function(e){var t={},i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(t=i.fetchList(i.documentHelper.lists,i.documentHelper.abstractLists)),t},getListLength:function(e){var t=0,i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||this.documentHelper.owner.documentHelper.lists.length>0&&(t=this.documentHelper.owner.documentHelper.lists[this.documentHelper.owner.documentHelper.lists.length-1].listId+1),t},getAbstractListLength:function(e){var t=0;return this.documentHelper.owner.documentHelper.abstractLists.length>0&&(t=this.documentHelper.owner.documentHelper.abstractLists[this.documentHelper.owner.documentHelper.abstractLists.length-1].abstractListId+1),t},getListLevel:function(e){var t,i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(t=i.selection.getListLevel(i.selection.start.paragraph)),t},getListLevelPattern:function(e,t){var i,r=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(r)||sf.base.isNullOrUndefined(r.element)||(i=r.documentHelper.layout.getListLevelPattern(t)),i},setListLevelPattern:function(e,t){var i=window.sfBlazor.getCompInstance(e);!sf.base.isNullOrUndefined(i)&&sf.base.isNullOrUndefined(i.element)},applyListProperties:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||i.selection.paragraphFormat.setList(t)},applyPageSetupProperties:function(e,t){var i=window.sfBlazor.getCompInstance(e);if(!sf.base.isNullOrUndefined(i)&&!sf.base.isNullOrUndefined(i.element)){var r=new d;if(!sf.base.isNullOrUndefined(t)){if(r.topMargin=t.topMargin,r.bottomMargin=t.bottomMargin,r.leftMargin=t.leftMargin,r.rightMargin=t.rightMargin,r.pageHeight=t.pageHeight,r.pageWidth=t.pageWidth,r.footerDistance=t.footerDistance,r.headerDistance=t.headerDistance,r.differentFirstPage=t.differentFirstPage,r.differentOddAndEvenPages=t.differentOddAndEvenPages,!sf.base.isNullOrUndefined(t.columns)){r.numberOfColumns=0==t.columns.length?1:t.columns.length;for(var n=[],o=0;o<t.columns.length;o++){var s=new c;s.width=x.convertPointToPixel(t.columns[o].width),s.space=x.convertPointToPixel(t.columns[o].space),n.push(s)}r.columns=n}r.equalWidth=t.equalWidth,r.lineBetweenColumns=t.lineBetweenColumns}i.editor.onApplySectionFormat(void 0,r)}},applyParagraphFormat:function(e,t){var i=new ct,r=window.sfBlazor.getCompInstance(e);if(!sf.base.isNullOrUndefined(r)&&!sf.base.isNullOrUndefined(r.element)){if(!sf.base.isNullOrUndefined(t)){i.leftIndent=t.leftIndent,i.rightIndent=t.rightIndent,i.firstLineIndent=t.firstLineIndent,i.lineSpacing=t.lineSpacing,i.lineSpacingType=t.lineSpacingType,i.textAlignment=t.textAlignment;var n=t.textAlignment;t.bidi&&("Right"===n?n="Left":"Left"===n&&(n="Right")),i.textAlignment=n,i.beforeSpacing=t.beforeSpacing,i.afterSpacing=t.afterSpacing,i.spaceBeforeAuto=t.spaceBeforeAuto,i.spaceAfterAuto=t.spaceAfterAuto,i.bidi=t.bidi,i.keepWithNext=t.keepWithNext,i.keepLinesTogether=t.keepLinesTogether,i.widowControl=t.widowControl,i.contextualSpacing=t.contextualSpacing,i.borders=void 0}r.editor.onParagraphFormat(i)}},getStyleName:function(e,t){var i,r=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(r)||sf.base.isNullOrUndefined(r.element)||(i=r.getStyleNames(t)),i},getStyles:function(e,t){var i,r=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(r)||sf.base.isNullOrUndefined(r.element)||(i=r.getStyles(t)),i},findByName:function(e,t){var i={},r=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(r)||sf.base.isNullOrUndefined(r.element)||(i=r.documentHelper.styles.findByName(t)),i=r.fetchStyleValue(i)},layoutWholeDocument:function(e){var t=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t.element)||t.editor.layoutWholeDocument()},shiftingEnableDisable:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(i.isShiftingEnabled=t)},updateStyleValues:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||i.documentHelper.styles.push(t)},setCharStyleName:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(i.selection.characterFormat.styleName=t)},setParaStyleName:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(i.selection.paragraphFormat.styleName=t)},getCharStyleName:function(e){var t,i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(t=i.selection.characterFormat.styleName),t},getParaStyleName:function(e){var t,i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(t=i.selection.paragraphFormat.styleName),t},gotoBookmark:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||i.selection.selectBookmark(t)},deleteBookmark:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||i.editorModule.deleteBookmark(t)},applyBorderAndShading:function(e,t,i,r){var n=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.element)||("Table"===t?(n.editorModule.applyBordersInternal(n.selection.tableFormat.table.tableFormat.borders,i),n.editorModule.applyShading(n.selection.tableFormat.table.tableFormat.shading,r)):(n.editorModule.applyBordersInternal(n.selection.start.paragraph.associatedCell.cellFormat.borders,i),n.editorModule.applyShading(n.selection.start.paragraph.associatedCell.cellFormat.shading,r)))},applyBorders:function(e,t){var i=window.sfBlazor.getCompInstance(e);if(!sf.base.isNullOrUndefined(i)&&!sf.base.isNullOrUndefined(i.element)){var r=new u;i.parser.parseBorders(t,r),i.editorModule.onApplyParagraphFormat("borders",r,!1,!1)}},insertFormField:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||i.editor.insertFormField(t)},insertTextFormField:function(e,t){var i=window.sfBlazor.getCompInstance(e);if(!sf.base.isNullOrUndefined(i)&&!sf.base.isNullOrUndefined(i.element)){var r=new ye;r.type=t.type,r.name=t.name,r.enabled=t.enabled,r.helpText=t.helpText,r.statusText=t.statusText,r.maxLength=t.maxLength,r.defaultValue=t.defaultValue,r.format=t.format,i.editorModule.editFormField("Text",r)}},exportAsPath:function(e,t){var i,r=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(r)||sf.base.isNullOrUndefined(r.element)||(i=r.exportAsPath(t)),i},insertCheckBoxFormField:function(e,t){var i=window.sfBlazor.getCompInstance(e);if(!sf.base.isNullOrUndefined(i)&&!sf.base.isNullOrUndefined(i.element)){var r=new ve;r.name=t.name,r.enabled=t.enabled,r.helpText=t.helpText,r.sizeType=t.sizeType,r.size=t.size,r.defaultValue=t.defaultValue,r.checked=t.checked,i.editorModule.editFormField("CheckBox",r)}},insertDropDownFormField:function(e,t){var i=window.sfBlazor.getCompInstance(e);if(!sf.base.isNullOrUndefined(i)&&!sf.base.isNullOrUndefined(i.element)){var r=new be;r.name=t.name,r.enabled=t.enabled,r.helpText=t.helpText,r.statusText=t.statusText,r.dropdownItems=t.dropdownItems.slice(),r.selectedIndex=t.selectedIndex,i.editorModule.editFormField("DropDown",r)}},getCurrentField:function(e){var t,i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(t=i.selection.getCurrentFormField()),JSON.stringify(t.formFieldData)},updateFormFieldValue:function(e,t){var i=window.sfBlazor.getCompInstance(e);if(!sf.base.isNullOrUndefined(i)&&!sf.base.isNullOrUndefined(i.element)){var r=i.selection.getCurrentFormField();r&&i.editorModule.updateFormField(r,t)}},onCharacterFormat:function(e,t){var i=new P;sf.base.isNullOrUndefined(t)||(i.bold=t.bold,i.fontSize=t.fontSize,i.fontFamily=t.fontFamily,i.italic=t.italic,i.baselineAlignment=t.baselineAlignment,i.underline=t.underline,i.fontColor=t.fontColor,i.highlightColor=t.highlightColor,i.strikethrough=t.strikethrough,i.allCaps=t.allCaps);var r=window.sfBlazor.getCompInstance(e);if(!sf.base.isNullOrUndefined(r)&&!sf.base.isNullOrUndefined(r.element)){if(r.editor.initHistory("CharacterFormat"),r.selection.isEmpty)return void(r.selection.start.offset===r.selection.getParagraphLength(r.selection.start.paragraph)&&(r.editor.applyCharFormatValueInternal(r.selection,r.selection.start.paragraph.characterFormat,void 0,i),r.editor.reLayout(r.selection)));r.editor.setOffsetValue(r.selection),r.editor.updateSelectionCharacterFormatting("CharacterFormat",i,!1)}},applyCellOption:function(e,t){var i=window.sfBlazor.getCompInstance(e);if(!sf.base.isNullOrUndefined(i)&&!sf.base.isNullOrUndefined(i.element)){var r=new bt;sf.base.isNullOrUndefined(t)||(r.topMargin=t.topMargin,r.bottomMargin=t.bottomMargin,r.leftMargin=t.leftMargin,r.rightMargin=t.rightMargin),i.applyCellOption(r)}},applyTableOption:function(e,t){var i=window.sfBlazor.getCompInstance(e);if(!sf.base.isNullOrUndefined(i)&&!sf.base.isNullOrUndefined(i.element)){var r=new vt;sf.base.isNullOrUndefined(t)||(r.topMargin=t.topMargin,r.bottomMargin=t.bottomMargin,r.leftMargin=t.leftMargin,r.rightMargin=t.rightMargin),i.applyTableOption(r)}},applyTableProperties:function(e,t,i,r){var n=window.sfBlazor.getCompInstance(e);if(!sf.base.isNullOrUndefined(n)&&!sf.base.isNullOrUndefined(n.element)){if(n.editorModule.initComplexHistory("TableProperties"),t){var o=new vt;t.cellSpacing&&(o.cellSpacing=t.cellSpacing),t.leftMargin&&(o.leftMargin=t.leftMargin),t.topMargin&&(o.topMargin=t.topMargin),t.rightMargin&&(o.rightMargin=t.rightMargin),t.bottomMargin&&(o.bottomMargin=t.bottomMargin),t.leftIndent&&(o.leftIndent=t.leftIndent),t.tableAlignment&&(o.tableAlignment=t.tableAlignment),t.preferredWidth&&(o.preferredWidth=t.preferredWidth),t.preferredWidthType&&(o.preferredWidthType=t.preferredWidthType),t.bidi&&(o.bidi=t.bidi),n.editorModule.onTableFormat(o)}if(i){var s=new C;i.isHeader&&(s.isHeader=i.isHeader),i.allowBreakAcrossPages&&(s.allowBreakAcrossPages=i.allowBreakAcrossPages),i.height&&(s.height=i.height),i.heightType&&(s.heightType=i.heightType),n.editorModule.onRowFormat(s)}if(r){var a=new bt;r.leftMargin&&(a.leftMargin=r.leftMargin),r.topMargin&&(a.topMargin=r.topMargin),r.bottomMargin&&(a.bottomMargin=r.bottomMargin),r.rightMargin&&(a.rightMargin=r.rightMargin),n.editorModule.onCellFormat(a)}n.editorHistory.updateComplexHistory()}},enableRepeatHeader:function(e){var t,i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(t=i.enableRepeatHeader()),t},RowFormatIsInHeader:function(e){var t,i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(t=i.documentHelper.selection.rowFormat.isHeader),t},applyShading:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(i.selection.cellFormat.background=t)},applyBorder:function(e,t,i,r){var n=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.element)||n.editor.applyBorders(this.getBorder(t,i,r))},getBorder:function(e,t,i){return{type:e,borderColor:i,lineWidth:t,borderStyle:0===t?"Cleared":"Single"}},initTrackChangesPane:function(e){var t=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t.element)||t.trackChangesPane.initTrackChangePane()},sortByUser:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||i.trackChangesPane.onUserSelect(t)},sortByRevision:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||i.trackChangesPane.onTypeSelect(t)},acceptOrRejectChanges:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||i.trackChangesPane.onMenuSelect(t)},navigatePreviousRevision:function(e){var t=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t.element)||t.selection.navigatePreviousRevision()},navigateNextChanges:function(e){var t=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t.element)||t.selection.navigateNextRevision()},getHyperlinkField:function(e){var t=window.sfBlazor.getCompInstance(e);if(!sf.base.isNullOrUndefined(t)&&!sf.base.isNullOrUndefined(t.element)){var i,r,n=t.selection.getHyperlinkField(),o="";if(!sf.base.isNullOrUndefined(n.fieldSeparator)){o=t.selection.getHyperlinkDisplayText(n.fieldSeparator.line.paragraph,n.fieldSeparator,n.fieldEnd,!1,void 0).displayText}return i=t.selection.getLinkText(n,!0),r=t.selection.getLinkText(n,!1),JSON.stringify({displayText:o,link:i,screenTip:r})}return""},isTableSelected:function(e){var t=window.sfBlazor.getCompInstance(e);return!sf.base.isNullOrUndefined(t)&&!sf.base.isNullOrUndefined(t.element)&&t.selection.isTableSelected()},getPageCount:function(e){var t=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t.element)?1:t.pageCount},getContextType:function(e){var t="",i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(t=i.selection.contextType),t},copy:function(e){var t=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t.element)||t.selection.copy()},cut:function(e){var t=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t.element)||t.editor.cut()},pasteInternal:function(e){var t=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t.element)||t.isReadOnlyMode||t.editorModule.pasteInternal(void 0)},updateField:function(e){var t=window.sfBlazor.getCompInstance(e);if(!sf.base.isNullOrUndefined(t)&&!sf.base.isNullOrUndefined(t.element)){var i=t.isReadOnlyMode;t.selection.isReferenceField()&&(!i||i&&"FormFieldsOnly"===t.documentHelper.protectionType)?t.selection.updateRefField():t.editorModule.updateToc()}},navigateHyperlink:function(e){var t=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t.element)||t.selection.navigateHyperlink()},copyHyperlink:function(e){var t=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t.element)||t.selection.copyHyperlink()},applyContinueNumbering:function(e){var t=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t.element)||t.editorModule.applyContinueNumbering()},applyRestartNumbering:function(e){var t=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t.element)||t.editorModule.applyRestartNumbering(t.selection)},handleAcceptReject:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||i.selection.handleAcceptReject(t)},spellCheck:function(e,t,i){var r=window.sfBlazor.getCompInstance(e);if(!sf.base.isNullOrUndefined(r)&&!sf.base.isNullOrUndefined(r.element)){var n=r.element.id+t;if(i.substring(0,n.length)===n){var o=i.substring(i.lastIndexOf("_")+1);"Add To Dictionary"===o||("Ignore All"===o?this.spellChecker.handleIgnoreAllItems():this.spellChecker.manageReplace(o))}else r.fireCustomContextMenuSelect(i)}},checkEmpty:function(e){var t,i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(t=i.selection.isEmpty),t},checkReadOnly:function(e){var t,i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(t=i.isReadOnlyMode),t},hasRevision:function(e){var t=window.sfBlazor.getCompInstance(e);return!sf.base.isNullOrUndefined(t)&&!sf.base.isNullOrUndefined(t.element)&&t.selection.hasRevisions()},isContentProtected:function(e){var t=window.sfBlazor.getCompInstance(e);if(!sf.base.isNullOrUndefined(t)&&!sf.base.isNullOrUndefined(t.element)){var i=t,r=i.documentHelper.isDocumentProtected,n={isDocumentProtected:r,allowFormatting:r&&i.documentHelper.restrictFormatting,isInProtectecRegion:i.editor.restrictEditing,isReadOnly:i.isReadOnly,protectionType:i.documentHelper.protectionType};return JSON.stringify(n)}return""},clearSelectionHighlight:function(e){var t=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t.element)||t.documentHelper.clearSelectionHighlight()},onIgnore:function(e){var t=window.sfBlazor.getCompInstance(e);if(!sf.base.isNullOrUndefined(t)&&!sf.base.isNullOrUndefined(t.element)&&!sf.base.isNullOrUndefined(this.info.element)){var i=t;i.spellChecker.manageReplace("Ignore Once",this.info.element),this.removeErrors(t.element),i.spellChecker.checkForNextError()}},removeErrors:function(e){var t=window.sfBlazor.getCompInstance(e);if(!sf.base.isNullOrUndefined(t)&&!sf.base.isNullOrUndefined(t.element)){var i=t;if(!sf.base.isNullOrUndefined(this.info.text)&&i.spellChecker.errorWordCollection.containsKey(this.info.text)){var r=i.spellChecker.errorWordCollection.get(this.info.text);r.splice(0,1),0===r.length&&i.spellChecker.errorWordCollection.remove(this.info.text)}i.spellChecker.errorWordCollection.length}},onIgnoreAll:function(e){var t=window.sfBlazor.getCompInstance(e);if(!sf.base.isNullOrUndefined(t)&&!sf.base.isNullOrUndefined(t.element)){var i=t;if(!sf.base.isNullOrUndefined(this.info.element)){var r=this.info.element.text;i.spellChecker.handleIgnoreAllItems({element:this.info.element,text:r}),i.spellChecker.checkForNextError()}}},addToDictionary:function(e){var t=window.sfBlazor.getCompInstance(e);if(!sf.base.isNullOrUndefined(t)&&!sf.base.isNullOrUndefined(t.element)&&sf.base.isNullOrUndefined(this.info.element)){var i=t;i.spellChecker.handleAddToDictionary({element:this.info.element,text:this.info.element.text}),i.spellChecker.errorWordCollection.containsKey(this.info.text)&&i.spellChecker.errorWordCollection.remove(this.info.text)}},onChange:function(e,t){var i=window.sfBlazor.getCompInstance(e);if(!sf.base.isNullOrUndefined(i)&&!sf.base.isNullOrUndefined(i.element)&&!sf.base.isNullOrUndefined(t)){this.isSpellChecking=!0;var r=i;r.spellChecker.manageReplace(t,this.info.element),this.removeErrors(i.element),r.spellChecker.checkForNextError()}},onChangeAll:function(e,t){var i=window.sfBlazor.getCompInstance(e);if(!sf.base.isNullOrUndefined(i)&&!sf.base.isNullOrUndefined(i.element)&&!sf.base.isNullOrUndefined(t)){this.isSpellChecking=!0;for(var r=i,n=r.spellChecker.errorWordCollection.get(this.info.text),o=0;o<n.length;o++)if(n[o]instanceof Ne&&!n[o].ischangeDetected)r.spellChecker.manageReplace(t,n[o]);else if(n[o]instanceof we){var s=r.spellChecker.getMatchedResultsFromElement(n[o]),a=s.textResults,l=n[o].ischangeDetected?n[o].start.offset:n[o].line.getOffset(n[o],0);r.searchModule.textSearch.updateMatchedTextLocation(s.matches,a,s.elementInfo,0,n[o],!1,null,l);for(var h=0;h<a.length;h++){var d=r.spellChecker.createErrorElementWithInfo(a.innerList[h],n[o]);r.spellChecker.manageReplace(t,d)}}r.spellChecker.errorWordCollection.containsKey(this.info.text)&&r.spellChecker.errorWordCollection.remove(this.info.text),r.spellChecker.checkForNextError()}},getErrorString:function(e){var t=[],i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||this.info.text&&t.push(this.info.text),t},getSuggestionsString:function(e){var t=[],i=this.info.text;this.isSpellChecking&&(this.isSpellChecking=!1);var r=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(r)||sf.base.isNullOrUndefined(r.element)||this.info.text&&(i=r.spellChecker.manageSpecialCharacters(i,void 0,!0),t=r.spellChecker.errorSuggestions.containsKey(i)?r.spellChecker.errorSuggestions.get(i):[]),t},hasElementBox:function(e){var t=!1,i=window.sfBlazor.getCompInstance(e);if(!sf.base.isNullOrUndefined(i)&&!sf.base.isNullOrUndefined(i.element)){var r=i;this.info=r.spellChecker.findCurretText(),this.info.element&&(t=!0,r.spellChecker.currentContextInfo=this.info,this.info=r.spellChecker.retriveText())}return t},invokeMethod:function(e,t,r,n){return pi(this,void 0,void 0,(function(){var o,s,a,l;return ui(this,(function(h){switch(h.label){case 0:return h.trys.push([0,4,,5]),o=window.sfBlazor.getCompInstance(e),s=null,sf.base.isNullOrUndefined(o)||sf.base.isNullOrUndefined(o.element)?[3,3]:(a=o)?(null===r||(a=o,a=this.getChildModule(a,r)),!(s=a[t].apply(a,n))||"object"!==i(s)||s instanceof Promise||(s=this.cleanStringify(s)),"saveAsBlob"==t&&s instanceof Promise?[4,this.promiseHandler(s)]:[3,2]):[3,3];case 1:s=h.sent(),h.label=2;case 2:return[2,s];case 3:return[3,5];case 4:return l=h.sent(),[2,this.throwError(l,a)];case 5:return[2,{}]}}))}))},promiseHandler:function(e){return pi(this,void 0,void 0,(function(){var t;return ui(this,(function(i){switch(i.label){case 0:return t=this,e instanceof Promise?[4,e.then((function(i){return pi(this,void 0,void 0,(function(){return ui(this,(function(r){switch(r.label){case 0:return[4,t.docEditFileReader(i).then((function(t){e=JSON.stringify({data:t.substr(t.indexOf(",")+1)})}))];case 1:return r.sent(),[2]}}))}))}))]:[3,2];case 1:i.sent(),i.label=2;case 2:return[2,e]}}))}))},docEditFileReader:function(e){return pi(this,void 0,void 0,(function(){return ui(this,(function(t){return[2,new Promise((function(t,i){var r=new FileReader;r.onload=function(){t(r.result)},r.readAsDataURL(e)}))]}))}))},getMethodCall:function(e,t,i){try{var r=window.sfBlazor.getCompInstance(e);if(!sf.base.isNullOrUndefined(r)&&!sf.base.isNullOrUndefined(r.element)){var n=r;return null==t||"null"==t?n[i]:(n=this.getChildModule(n,t))[i]}}catch(e){this.throwError(e,n)}},setMethodCall:function(e,t,i,r){try{var n=window.sfBlazor.getCompInstance(e);if(!sf.base.isNullOrUndefined(n)&&!sf.base.isNullOrUndefined(n.element)){var o=n;(o=this.getChildModule(o,t))[i]=r[0]}}catch(e){this.throwError(e,o)}},cleanStringify:function(e){try{return JSON.stringify(e)}catch(e){return console.log(e),""}},getChildModule:function(e,t){try{for(var i=t.split(","),r=0;r<i.length;r++)e=e[i[r]];return e}catch(e){}return e},insertNotes:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||("Footnote"===t?i.editor.insertFootnote():i.editor.insertEndnote())},pasteOptions:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||i.selection.pasteOptions(t)},modifyStyle:function(e,t,i,r,n,o,s){var a=window.sfBlazor.getCompInstance(e);if(!sf.base.isNullOrUndefined(a)&&!sf.base.isNullOrUndefined(a.element)){var l=a.documentHelper,h=i;if(!(t.length>0))throw new Error("Enter valid Style name");var d,c=l.styles.findByName(t);if(sf.base.isNullOrUndefined(c)){var p="Character"===o?new ft:new gt,u=new P;sf.base.isNullOrUndefined(h.characterFormat)||(u.bold=h.characterFormat.bold,u.fontSize=h.characterFormat.fontSize,u.fontFamily=h.characterFormat.fontFamily,u.italic=h.characterFormat.italic,u.baselineAlignment=h.characterFormat.baselineAlignment,u.underline=h.characterFormat.underline,u.fontColor=h.characterFormat.fontColor,u.highlightColor=h.characterFormat.highlightColor,u.strikethrough=h.characterFormat.strikethrough,u.allCaps=h.characterFormat.allCaps),h.characterFormat=u;var g=new ct;sf.base.isNullOrUndefined(h.paragraphFormat)||(g.leftIndent=h.paragraphFormat.leftIndent,g.rightIndent=h.paragraphFormat.rightIndent,g.firstLineIndent=h.paragraphFormat.firstLineIndent,g.lineSpacing=h.paragraphFormat.lineSpacing,g.lineSpacingType=h.paragraphFormat.lineSpacingType,g.textAlignment=h.paragraphFormat.textAlignment,g.beforeSpacing=h.paragraphFormat.beforeSpacing,g.afterSpacing=h.paragraphFormat.afterSpacing,g.bidi=h.paragraphFormat.bidi,g.contextualSpacing=h.paragraphFormat.contextualSpacing),h.paragraphFormat=g,p.copyStyle(h);var f=l.styles.findByName(r);"Paragraph"!==o&&"Linked(Paragraph and Character)"!==o||(p.next=t===n?p:l.styles.findByName(n)),p.link="Linked(Paragraph and Character)"===o?this.createLinkStyle(t):void 0,p.type="Character"===o?"Character":"Paragraph",p.name=t,p.basedOn=f,l.styles.push(p),d=t,l.owner.editorModule.applyStyle(d)}else c.type="Character"===o?"Character":"Paragraph",c.basedOn=l.styles.findByName(r),"Paragraph"!==h.type&&-1===h.type.indexOf("Linked(Paragraph and Character)")||(c.next=l.styles.findByName(h.next),a.parser.parseCharacterFormat(h.characterFormat,c.characterFormat,!1),a.parser.parseParagraphFormat(h.paragraphFormat,c.paragraphFormat),c.link=-1!==o.indexOf("Linked(Paragraph and Character)")?this.createLinkStyle(l,t,c,s):void 0),l.owner.isShiftingEnabled=!0,l.owner.editorModule.layoutWholeDocument(),l.owner.isShiftingEnabled=!1;l.updateFocus(),l.updateFocus()}},createLinkStyle:function(e,t,i,r){var n;return(n=r?e.styles.findByName(t+" Char","Character"):new ft).type="Character",n.name=t+" Char",n.characterFormat=i.characterFormat.cloneFormat(),n.basedOn=i.basedOn,r||e.styles.push(n),e.styles.findByName(n.name,"Character")},updateDialogTabHeight:function(e,t,i){var r=document.getElementById(t.id),n=r.getElementsByClassName("e-dlg-header-content")[0],o=r.getElementsByClassName("e-dlg-content")[0],s=r.getElementsByClassName("e-footer-content")[0],a=getComputedStyle(o),l=getComputedStyle(r),h=parseInt(a.paddingTop),d=parseInt(a.paddingBottom),c=(isNaN(h)?0:h)+(isNaN(d)?0:d),p=parseInt(l.borderTop),u=parseInt(l.borderBottom),g=(isNaN(p)?0:p)+(isNaN(u)?0:u),f=r.offsetHeight-(n.offsetHeight+s.offsetHeight+c+g);i.style.height=f+"px";var m=parseInt(a.paddingLeft),y=parseInt(a.paddingRight),v=(isNaN(m)?0:m)+(isNaN(y)?0:y),b=parseInt(l.borderLeft),w=parseInt(l.borderRight),x=(isNaN(b)?0:b)+(isNaN(w)?0:w);return r.offsetWidth-(v+x)},getDocumentEditorElementHeight:function(e){var t=window.sfBlazor.getCompInstance(e);if(!sf.base.isNullOrUndefined(t)&&!sf.base.isNullOrUndefined(t.element))return t.element.offsetHeight},getOptionPaneChildHeight:function(e){var t=window.sfBlazor.getCompInstance(e);if(!sf.base.isNullOrUndefined(t)&&!sf.base.isNullOrUndefined(t.element))return t.element.getElementsByClassName("e-de-op-tab")[0].offsetHeight},getTablePropertiesPaneHeight:function(e){var t=e.getElementsByClassName("e-tab-header")[0];return t?e.offsetHeight-t.offsetHeight+"px":"auto"},onSpacingValueChange:function(e,t){var i=t.getElementsByTagName("input")[0],r=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(r)||sf.base.isNullOrUndefined(r.element)||(i.value=r.localeKeys.DocumentEditor_Auto)},focusIn:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||setTimeout((function(){i.focusIn()}),t)}}}()},"./modules/sf-documenteditorcontainer.js":function(e,t){window.sfBlazor=window.sfBlazor||{},window.sfBlazor.DocumentEditorContainer=function(){"use strict";var e=function(){function e(e,t,i,r,n){this.isDestroyed=!1,window.sfBlazor=window.sfBlazor,this.previousContext="",this.showHeaderProperties=!0,this.element=t,sf.base.isNullOrUndefined(t)||(this.dotNetRef=n,this.element=t,this.dataId=e,window.sfBlazor.setCompInstance(this),this.options=i,this.editorOptions=r,this.updateOptions(i))}return Object.defineProperty(e.prototype,"documentEditor",{get:function(){return this.documentEditorInternal},enumerable:!0,configurable:!0}),e.prototype.updateOptions=function(e){this.showPropertiesPane=e.showPropertiesPane,this.currentUser=e.currentUser,this.enableComment=e.enableComment,this.enableLocalPaste=e.enableLocalPaste,this.enableSpellCheck=e.enableSpellCheck,this.enableTrackChanges=e.enableTrackChanges,this.height=e.height,this.serviceUrl=e.serviceUrl,this.userColor=e.userColor,this.width=e.width,this.zIndex=e.zIndex,this.documentEditorSettings=e.documentEditorSettings,this.requiredModules()},e.prototype.setOptions=function(e,t){for(var i=0,r=Object.keys(e);i<r.length;i++){var n=r[i],o=e[n];if(!sf.base.isNullOrUndefined(o))switch(n){case"zoomFactor":this.documentEditor.zoomFactor=o,this.documentEditor.onPropertyChanged({zoomFactor:o},null);break;case"layoutType":this.documentEditor.layoutType=o,this.documentEditor.onPropertyChanged({layoutType:o},null);break;case"enableTrackChanges":this.enableTrackChanges=o,this.documentEditor.enableTrackChanges=o,this.documentEditor.showRevisions=o,this.documentEditor.onPropertyChanged({enableTrackChanges:o},null),this.documentEditor.onPropertyChanged({showRevisions:o},null);break;case"restrictEditing":this.restrictEditing=o,this.documentEditor.isReadOnly=o,this.documentEditor.onPropertyChanged({isReadOnly:o},null);break;case"enableLocalPaste":this.enableLocalPaste=o,this.documentEditor.enableLocalPaste=o,this.documentEditor.onPropertyChanged({enableLocalPaste:o},null);break;case"documentEditorSettings":this.documentEditorSettings=o,this.customizeDocumentEditorSettings()}}},e.prototype.getModuleName=function(){return"DocumentEditorContainer"},e.prototype.onPropertyChanged=function(e,t){for(var i=0,r=Object.keys(e);i<r.length;i++){switch(r[i]){case"restrictEditing":this.documentEditor.isReadOnly=e.restrictEditing,sf.base.isNullOrUndefined(this.documentEditor.trackChangesPane)||this.documentEditor.trackChangesPane.enableDisableButton(!e.restrictEditing&&!this.documentEditor.documentHelper.isDocumentProtected);break;case"showPropertiesPane":this.showHidePropertiesPane(e.showPropertiesPane);break;case"enableTrackChanges":this.documentEditor&&(this.documentEditor.enableTrackChanges=e.enableTrackChanges,this.documentEditor.showRevisions=e.enableTrackChanges,this.documentEditor.resize());break;case"enableLocalPaste":this.documentEditor&&(this.documentEditor.enableLocalPaste=e.enableLocalPaste);break;case"serviceUrl":this.documentEditor&&(this.documentEditor.serviceUrl=e.serviceUrl);break;case"serverActionSettings":this.documentEditor&&this.setserverActionSettings();break;case"zIndex":this.documentEditor&&(this.documentEditor.zIndex=e.zIndex);break;case"headers":break;case"locale":case"enableRtl":break;case"enableComment":this.documentEditor&&(this.documentEditor.enableComment=e.enableComment);break;case"enableSpellCheck":this.documentEditor&&(this.documentEditor.enableSpellCheck=e.enableSpellCheck);break;case"documentEditorSettings":this.documentEditor&&this.customizeDocumentEditorSettings();break;case"toolbarItems":break;case"currentUser":this.documentEditor&&(this.documentEditor.currentUser=e.currentUser);break;case"userColor":this.documentEditor&&(this.documentEditor.userColor=e.userColor);break;case"layoutType":this.documentEditor&&(this.documentEditor.layoutType=e.layoutType);break;case"enableToolbar":this.documentEditor&&this.documentEditor.resize();break;case"height":var n="";n=-1!==this.height.indexOf("%")?window.innerHeight*(parseInt(this.height)/100)+"px":sf.base.formatUnit(this.height),this.element.style.height=n,this.documentEditor&&this.documentEditor.resize();break;case"width":this.element.style.width=sf.base.formatUnit(this.width),this.documentEditor&&this.documentEditor.resize()}}},e.prototype.preRender=function(e){var t="";t=-1!==this.height.indexOf("%")?window.innerHeight*(parseInt(this.height)/100)+"px":sf.base.formatUnit(this.height),this.element.style.height=t,""!==this.width&&(this.element.style.width=sf.base.formatUnit(this.width)),this.element.style.minHeight="320px"},e.prototype.render=function(e,t){this.initializeDocumentEditor(e,t),this.setserverActionSettings(),this.customizeDocumentEditorSettings()},e.prototype.setFormat=function(){},e.prototype.setserverActionSettings=function(){},e.prototype.setShowHiddenMarks=function(e){var t=this;this.documentEditorSettings.showHiddenMarks=e,this.documentEditor.documentEditorSettings.showHiddenMarks=e,this.documentEditor.viewer.updateScrollBars(),setTimeout((function(){t.documentEditor.viewer&&t.documentEditor.focusIn()}),30)},e.prototype.customizeDocumentEditorSettings=function(){if(this.documentEditorSettings.formFieldSettings){var e=this.documentEditorSettings.formFieldSettings,t=this.documentEditor;sf.base.isNullOrUndefined(e.applyShading)||(t.documentEditorSettings.formFieldSettings.applyShading=e.applyShading),sf.base.isNullOrUndefined(e.formFillingMode)||(t.documentEditorSettings.formFieldSettings.formFillingMode=e.formFillingMode),sf.base.isNullOrUndefined(e.formattingExceptions)||(t.documentEditorSettings.formFieldSettings.formattingExceptions=e.formattingExceptions),sf.base.isNullOrUndefined(e.selectionColor)||(t.documentEditorSettings.formFieldSettings.selectionColor=e.selectionColor),sf.base.isNullOrUndefined(e.shadingColor)||(t.documentEditorSettings.formFieldSettings.shadingColor=e.shadingColor)}this.documentEditorSettings.searchHighlightColor&&(this.documentEditor.documentEditorSettings.searchHighlightColor=this.documentEditorSettings.searchHighlightColor),this.documentEditorSettings.fontFamilies&&(this.documentEditor.documentEditorSettings.fontFamilies=this.documentEditorSettings.fontFamilies),this.documentEditorSettings.printDevicePixelRatio&&(this.documentEditor.documentEditorSettings.printDevicePixelRatio=this.documentEditorSettings.printDevicePixelRatio),sf.base.isNullOrUndefined(this.documentEditorSettings.enableOptimizedTextMeasuring)||(this.documentEditor.documentEditorSettings.enableOptimizedTextMeasuring=this.documentEditorSettings.enableOptimizedTextMeasuring),sf.base.isNullOrUndefined(this.documentEditorSettings.showHiddenMarks)||(this.documentEditor.documentEditorSettings.showHiddenMarks=this.documentEditorSettings.showHiddenMarks)},e.prototype.getPersistData=function(){return"documenteditor-container"},e.prototype.requiredModules=function(){var e=[];return this.enableToolbar&&e.push({member:"toolbar",args:[this]}),e},e.prototype.initializeDocumentEditor=function(e,t){var i=t,r=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(r)||sf.base.isNullOrUndefined(r.element)||(this.documentEditorInternal=r,sf.base.EventHandler.add(i,"selectionChange",this.onSelectionChange,this),this.documentEditor.enableAllModules(),this.documentEditor.enableComment=this.enableComment,this.setFormat(),this.documentEditor.resize())},e.prototype.showHidePropertiesPane=function(e){this.showPropertiesPane&&this.showPropertiesPaneOnSelection(),this.documentEditor.resize()},e.prototype.resize=function(e,t){this.element&&(sf.base.isNullOrUndefined(t)&&this.element&&this.element.parentElement.parentElement&&(t=this.element.parentElement.parentElement.clientHeight),sf.base.isNullOrUndefined(e)&&this.element&&this.element.parentElement.parentElement&&(e=this.element.parentElement.parentElement.clientWidth),!sf.base.isNullOrUndefined(e)&&e>200&&(this.width=e.toString(),this.element.style.width=e+"px"),!sf.base.isNullOrUndefined(t)&&t>200&&(this.height=t.toString(),this.element.style.height=t+"px"),this.documentEditor&&this.documentEditor.resize())},e.prototype.onContentChange=function(){},e.prototype.onDocumentChange=function(){this.enableTrackChanges=this.documentEditor.enableTrackChanges},e.prototype.onSelectionChange=function(){this.showPropertiesPaneOnSelection()},e.prototype.showPropertiesPaneOnSelection=function(){var e=this.documentEditor.selection.contextType,t=e.indexOf("Header")>=0||e.indexOf("Footer")>=0;t||(this.showHeaderProperties=!0,this.documentEditor.fireBeforePaneSwitch("PropertiesPane")),this.showPropertiesPane?t&&this.showHeaderProperties?this.showProperties("headerfooter"):e.indexOf("List")>=0||e.indexOf("Text")>=0&&e.indexOf("Table")<0?this.showProperties("text"):e.indexOf("Image")>=0?this.showProperties("image"):e.indexOf("TableOfContents")>=0?this.showProperties("toc"):e.indexOf("Table")>=0&&this.showProperties("table"):this.showHidePropertiesPane(!1),this.previousContext=this.documentEditor.selection.contextType},e.prototype.showProperties=function(e){this.tableProperties.showTableProperties("text"===e||"table"===e),this.imageProperties.showImageProperties("image"===e),this.headerFooterProperties.showHeaderFooterPane("headerfooter"===e),this.tocProperties.showTocPane("toc"===e)},e.prototype.destroy=function(){this.propertiesPaneContainer&&this.editorContainer.parentElement&&(this.propertiesPaneContainer.innerHTML="",this.propertiesPaneContainer.parentElement.removeChild(this.propertiesPaneContainer)),this.propertiesPaneContainer=void 0,this.editorContainer&&this.editorContainer.parentElement&&(this.editorContainer.innerHTML="",this.editorContainer.parentElement.removeChild(this.editorContainer)),this.statusBarElement&&this.statusBarElement.parentElement&&(this.statusBarElement.innerHTML="",this.statusBarElement.parentElement.removeChild(this.statusBarElement)),this.containerTarget&&this.containerTarget.parentElement&&(this.containerTarget.innerHTML="",this.containerTarget.parentElement.removeChild(this.containerTarget)),this.containerTarget=void 0,this.statusBarElement=void 0,this.editorContainer=void 0},e}(),t=function(e){var t=this;this.showImageProperties=function(e){!e&&"none"===t.element.style.display||e&&"block"===t.element.style.display||(t.element.style.display=e?"block":"none")},this.element=e},i=function(e){var t=this;this.showTableProperties=function(e){!e&&"none"===t.element.style.display||e&&"block"===t.element.style.display||(t.element.style.display=e?"block":"none")},this.element=e},r=function(e){var t=this;this.showTocPane=function(e){!e&&"none"===t.element.style.display||e&&"block"===t.element.style.display||(t.element.style.display=e?"block":"none")},this.element=e},n=function(){function e(e){this.element=e}return e.prototype.onSelectionChange=function(){},e.prototype.showHeaderFooterPane=function(e){e&&this.onSelectionChange(),!e&&"none"===this.element.style.display||e&&"block"===this.element.style.display||(this.element.style.display=e?"block":"none")},e}(),o=function(e,t,i,r){return new(i||(i=Promise))((function(n,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){e.done?n(e.value):new i((function(t){t(e.value)})).then(s,a)}l((r=r.apply(e,t||[])).next())}))},s=function(e,t){var i,r,n,o,s={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(i)throw new TypeError("Generator is already executing.");for(;s;)try{if(i=1,r&&(n=2&o[0]?r.return:o[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,o[1])).done)return n;switch(r=0,n&&(o=[2&o[0],n.value]),o[0]){case 0:case 1:n=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(n=s.trys,(n=n.length>0&&n[n.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){s.label=o[1];break}if(6===o[0]&&s.label<n[1]){s.label=n[1],n=o;break}if(n&&s.label<n[2]){s.label=n[2],s.ops.push(o);break}n[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],r=0}finally{i=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}};return{dotnetRef:null,filePicker:null,imagePicker:null,docEditElement:null,docEditDataId:null,initialize:function(o,s,a,l,h,d,c,p){sf.base.enableBlazorMode();var u=new e(o,s,h,d,c);if(u.tableProperties=new i(p[0]),u.imageProperties=new t(p[1]),u.headerFooterProperties=new n(p[2]),u.tocProperties=new r(p[3]),u.preRender(l),u.render(a,l),this.dotnetRef=c,this.docEditElement=l,this.docEditDataId=a,l.parentElement){var g=l.parentElement.getElementsByClassName("e-de-ctnr-file-picker"),f=l.parentElement.getElementsByClassName("e-de-ctnr-image-picker");g.length>0&&(this.filePicker=g[0],this.filePicker.addEventListener("change",this.fileReader.bind(this))),f.length>0&&(this.imagePicker=f[0],this.imagePicker.addEventListener("change",this.imageReader.bind(this)))}},updateOptions:function(e,t,i){var r=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(r)||sf.base.isNullOrUndefined(r.element)||(r.setOptions(t,r.options),r.options=t)},destroy:function(e){var t=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t.element)||(t.isDestroyed=!0)},imageReader:function(){return o(this,void 0,void 0,(function(){var e,t,i,r;return s(this,(function(n){return t=(e=this).imagePicker.files[0],i=new FileReader,r=window.sfBlazor.getCompInstance(e.docEditDataId),i.onload=function(){var e=i.result,t=document.createElement("img");t.addEventListener("load",(function(){r.editor.insertImageInternal(e,!0,this.width,this.height)})),t.src=e},i.readAsDataURL(t),[2]}))}))},fileReader:function(){return o(this,void 0,void 0,(function(){var e,t,i,r,n;return s(this,(function(o){return this.dotnetRef.invokeMethodAsync("ShowSpinner"),(t=(e=this).filePicker.files[0])&&(i=t.name,r=i.substr(i.lastIndexOf(".")),(n=new FileReader).onload=function(){var t=n.result;e.dotnetRef.invokeMethodAsync("LoadDocument",t,i)},".sfdt"===r?n.readAsText(t):n.readAsDataURL(t)),[2]}))}))},openDocument:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||("File"==t?this.filePicker&&(this.filePicker.value="",this.filePicker.click()):"Image"==t&&this.imagePicker&&(this.imagePicker.value="",this.imagePicker.click()))},showProperties:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||i.showProperties(t)},resize:function(e,t,i){var r=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(r)||sf.base.isNullOrUndefined(r.element)||r.resize(t,i)},setShowHeaderProperties:function(e){var t=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t.element)||(t.showHeaderProperties=!t.showHeaderProperties)},showPropertiesPaneOnSelection:function(e){var t=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t.element)||t.showPropertiesPaneOnSelection()},getPreviousContext:function(e){var t=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t.element)?"":t.previousContext},navigateToUrl:function(e){window.open(e)},setShowHiddenMarks:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||i.setShowHiddenMarks(t)}}}()},"./modules/sf-drop-down-button.js":function(e,t){window.sfBlazor=window.sfBlazor||{},window.sfBlazor.DropDownButton=function(){"use strict";var e="e-colorpicker-container",t="mousedown touchstart",i=function(){function i(e,t,i,r,n){this.dataId=r,this.cp_dataId=n,this.element=e,this.dotNetRef=i,this.popup=t,window.sfBlazor.setCompInstance(this),this.addScrollEvents(!0)}return i.prototype.openPopup=function(i){this.popup.style.visibility="hidden",document.body.appendChild(this.popup),i&&sf.splitbuttons.setBlankIconStyle(this.popup),this.popup.classList.remove("e-transparent");var r=sf.popups.getZindexPartial(this.element),n=this.element.parentElement.classList.contains(e);n&&window.sfBlazor.getCompInstance(this.cp_dataId).setPaletteWidth(this.popup.querySelector(".e-container"),!1,r);(this.setPosition(n),sf.base.EventHandler.remove(document,t,this.mouseDownHandler),this.addEventListener(),this.popup.style.zIndex=r+"",this.popup.style.visibility="",n)&&window.sfBlazor.getCompInstance(this.cp_dataId).setOffset(this.popup,r);this.popup.firstElementChild&&(this.popup.firstElementChild.firstElementChild&&n?this.popup.firstElementChild.firstElementChild.focus():this.popup.firstElementChild.focus())},i.prototype.setPosition=function(e){var t,i,r=this.element.getBoundingClientRect(),n=this.popup.getBoundingClientRect();e&&sf.base.Browser.isDevice?(t=document.documentElement.clientWidth/2-n.width/2+pageXOffset,i=document.documentElement.clientHeight/2-n.height/2+pageYOffset):(t=r.left+pageXOffset,i=r.bottom+pageYOffset,r.bottom+n.height>document.documentElement.clientHeight&&i-r.height-n.height>document.documentElement.clientTop&&(i=i-r.height-n.height),r.left+n.width>document.documentElement.clientWidth&&r.right-n.width>document.documentElement.clientLeft&&(t=t+r.width-n.width)),this.popup.style.left=Math.ceil(t)+"px",this.popup.style.top=Math.ceil(i)+"px"},i.prototype.mouseDownHandler=function(t){if(this.popup.parentElement){var i=t.target,r=!0,n=this.element.parentElement.classList.contains(e);if(n){var o=window.sfBlazor.getCompInstance(this.cp_dataId);(sf.base.closest(i,".e-apply")||sf.base.closest(i,".e-cancel"))&&o.removeZIndex()}if(!sf.base.Browser.isDevice&&i.classList.contains("e-hsv-model")){var s=i.parentElement.getBoundingClientRect(),a=this.element.getBoundingClientRect();r=t.clientX>=s.left&&t.clientX<=s.right&&t.clientY>=s.top&&t.clientY<=s.bottom||t.clientX>=a.left&&t.clientX<=a.right&&t.clientY>=a.top&&t.clientY<=a.bottom}if(!r||!sf.base.closest(i,"#"+this.getDropDownButton().id)&&!sf.base.closest(t.target,"#"+this.popup.id)&&!sf.base.closest(t.target,".e-colorpicker.e-modal")){if(n)(o=window.sfBlazor.getCompInstance(this.cp_dataId)).removeZIndex();this.dotNetRef.invokeMethodAsync("ButtonClickAsync",null),this.removeEventListener()}}else this.removeEventListener()},i.prototype.keydownHandler=function(t){var i=this.getElement(),r=this.element.parentElement.classList.contains(e),n=this.element.parentElement.classList.contains("e-rtl");r&&window.sfBlazor.getCompInstance(this.cp_dataId).paletteKeyDown(t,n);if(t.altKey)38===t.keyCode&&(t.stopPropagation(),t.preventDefault(),this.dotNetRef.invokeMethodAsync("ButtonClickAsync",null),i.focus(),this.removeEventListener());else{var o=this.popup.firstElementChild;if((27===t.keyCode||9===t.keyCode&&!r)&&(t.stopPropagation(),this.dotNetRef.invokeMethodAsync("ButtonClickAsync",null),27===t.keyCode&&t.preventDefault(),i.focus(),this.removeEventListener()),!o||!o.classList.contains("e-dropdown-menu"))return;if(13===t.keyCode)return t.preventDefault(),void(t.target.classList.contains("e-item")&&t.target.classList.contains("e-focused")?(i.focus(),this.removeEventListener()):t.stopPropagation());38!==t.keyCode&&40!==t.keyCode||(t.target.classList.contains("e-dropdown-menu")&&t.stopPropagation(),t.preventDefault(),sf.splitbuttons.upDownKeyHandler(o,t.keyCode))}},i.prototype.getElement=function(){return this.element.classList.contains("e-split-btn-wrapper")?this.element.firstElementChild:this.element},i.prototype.getDropDownButton=function(){return this.element.classList.contains("e-split-btn-wrapper")?this.element.getElementsByClassName("e-dropdown-btn")[0]:this.element},i.prototype.clickHandler=function(e){sf.base.closest(e.target,".e-item")&&(this.removeEventListener(),this.getElement().focus())},i.prototype.dropDownClickHandler=function(t){if(this.element.parentElement.classList.contains(e)){var i=window.sfBlazor.getCompInstance(this.cp_dataId);sf.base.closest(t.target,".e-dropdown-btn")&&i.removeZIndex()}},i.prototype.scrollHandler=function(t){if(this.popup&&document.getElementById(this.popup.id)){var i=this.element.parentElement.classList.contains(e);if(this.setPosition(i),i)window.sfBlazor.getCompInstance(this.cp_dataId).setOffset(this.popup)}else{var r=this.getDropDownButton();r&&document.getElementById(r.id)||sf.base.EventHandler.remove(t.target,"scroll",this.scrollHandler)}},i.prototype.addEventListener=function(e){if(sf.base.EventHandler.add(document,t,this.mouseDownHandler,this),sf.base.EventHandler.add(this.popup,"click",this.clickHandler,this),sf.base.EventHandler.add(this.popup,"keydown",this.keydownHandler,this),sf.base.EventHandler.add(this.element,"click",this.dropDownClickHandler,this),e&&this.popup.firstElementChild){var i=this.popup.querySelector(".e-focused");i?i.focus():this.popup.firstElementChild.focus()}},i.prototype.removeEventListener=function(e){if(sf.base.EventHandler.remove(document,t,this.mouseDownHandler),sf.base.EventHandler.remove(this.element,"click",this.dropDownClickHandler),this.popup.parentElement&&(sf.base.EventHandler.remove(this.popup,"click",this.clickHandler),sf.base.EventHandler.remove(this.popup,"keydown",this.keydownHandler),e)){var i=this.getDropDownButton();i&&document.getElementById(i.id)&&(this.addScrollEvents(!1),this.element.appendChild(this.popup))}},i.prototype.addScrollEvents=function(e){for(var t=0,i=sf.popups.getScrollableParent(this.element);t<i.length;t++){var r=i[t];e?sf.base.EventHandler.add(r,"scroll",this.scrollHandler,this):sf.base.EventHandler.remove(r,"scroll",this.scrollHandler)}},i}();return{openPopup:function(e,t,r,n,o,s){var a=window.sfBlazor.getCompInstance(o);sf.base.isNullOrUndefined(e)||(sf.base.isNullOrUndefined(a)?(new i(e,t,r,o,s),a=window.sfBlazor.getCompInstance(o)):a.popup=t,a.openPopup(n))},addEventListener:function(e){var t=window.sfBlazor.getCompInstance(e);t.removeEventListener(),t.addEventListener(!0)},removeEventListener:function(e){window.sfBlazor.getCompInstance(e).removeEventListener(!0)},setIconStyle:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.splitbuttons.setBlankIconStyle(i.popup,t)}}}()},"./modules/sf-dropdownlist.js":function(e,t){window.sfBlazor=window.sfBlazor||{},window.sfBlazor.DropDownList=function(){"use strict";var e="e-list-group-item",t=function(){function t(e,t,i,r,n){this.activeIndex=null,this.prevSelectPoints={},window.sfBlazor=window.sfBlazor,this.dataId=e,this.containerElement=t,this.element=i,this.options=n,window.sfBlazor.setCompInstance(this),this.dotNetRef=r}return t.prototype.initialize=function(){this.keyConfigure={tab:"tab",enter:"13",escape:"27",end:"35",home:"36",down:"40",up:"38",pageUp:"33",pageDown:"34",open:"alt+40",close:"shift+tab",hide:"alt+38",space:"32"},sf.base.Browser.isDevice||new sf.base.KeyboardEvents(this.containerElement,{keyAction:this.keyActionHandler.bind(this),keyConfigs:this.keyConfigure,eventName:"keydown"}),"SfComboBox"===this.options.moduleName&&sf.base.EventHandler.add(this.element,"keydown",this.onFilterDown,this)},t.prototype.setAutoFillSelection=function(e){this.isAndroidAutoFill(e)||this.autoFillSelection(e)},t.prototype.onFilterDown=function(e){13!==e.keyCode&&40!==e.keyCode&&38!==e.keyCode&&9!==e.keyCode&&(this.prevSelectPoints=this.getSelectionPoints())},t.prototype.getSelectionPoints=function(){var e=this.element;return{start:Math.abs(e.selectionStart),end:Math.abs(e.selectionEnd)}},t.prototype.autoFillSelection=function(e){var t=this.getSelectionPoints(),i=this.element.value.substr(0,t.start);if(i&&i.toLowerCase()===e.substr(0,t.start).toLowerCase()){var r=i+e.substr(i.length,e.length);this.element.value=r,this.element.setSelectionRange(t.start,this.element.value.length)}else this.element.value=e,this.element.setSelectionRange(0,this.element.value.length)},t.prototype.isAndroidAutoFill=function(e){if(sf.base.Browser.isAndroid){var t=this.getSelectionPoints(),i=this.prevSelectPoints.end,r=t.end,n=this.prevSelectPoints.start,o=t.start;return 0!==i&&(i===e.length&&n===e.length||n>o&&i>r||i===r&&n===o)}return!1},t.prototype.removeFillSelection=function(){var e=this.getSelectionPoints();this.element.setSelectionRange(e.end,e.end)},t.prototype.keyActionHandler=function(e){var t={Action:e.action,Key:e.key,Events:e,Type:e.type};this.isDisposed||this.dotNetRef.invokeMethodAsync("KeyActionHandler",t),("tab"!==e.action&&"close"!==e.action&&"space"!==e.action&&"enter"!==e.action&&"open"!==e.action&&("SfDropDownList"===this.options.moduleName||"home"!==e.action&&"end"!==e.action)||"enter"===e.action&&!sf.base.isNullOrUndefined(this.isPopupOpen()))&&e.preventDefault()},t.prototype.getOffsetValue=function(e){var t=getComputedStyle(e),i=parseInt(t.borderTopWidth,10),r=parseInt(t.borderBottomWidth,10);return this.setPopupPosition(i+r)},t.prototype.setPopupPosition=function(e){var t,i=e,r=this.list.querySelector(".e-item-focus")||this.list.querySelector(".e-active"),n=this.isEmptyList()?this.list:this.liCollections[0],o=this.isEmptyList()?this.list:this.liCollections[this.getItems().length-1],s=n.getBoundingClientRect().height,a=this.list.offsetHeight/2,l=sf.base.isNullOrUndefined(r)?n.offsetTop:r.offsetTop;if(o.offsetTop-a<l&&!sf.base.isNullOrUndefined(this.liCollections)&&this.liCollections.length>0&&!sf.base.isNullOrUndefined(r)){var h=this.list.offsetHeight/s,d=parseInt(getComputedStyle(this.list).paddingBottom,10);t=(h-(this.liCollections.length-this.activeIndex))*s-i+d,this.list.scrollTop=r.offsetTop}else l>a?(t=a-s/2,this.list.scrollTop=l-a+s/2):t=l;return-(t=t+s+i-(s-this.containerElement.offsetHeight)/2)},t.prototype.getItems=function(){return this.list?this.list.querySelectorAll(".e-list-item"):[]},t.prototype.renderPopup=function(e,t,i,r,n,o){this.options=n,this.popupHolder=t,this.list=t.querySelector(".e-content")||sf.base.select(".e-content",this.popupContainer),this.liCollections=this.getItems();var s,a,l=0,h=sf.base.formatUnit(this.options.popupHeight);if(this.wireListEvents(),e){var d=document.getElementById(e.id);d&&sf.base.remove(d)}if(document.body.appendChild(e),e.style.visibility="hidden",this.options.allowFiltering&&("SfDropDownList"===this.options.moduleName?(this.filterInput=e.querySelector("input.e-input"),a=this.filterInput.parentElement,new sf.base.KeyboardEvents(this.filterInput,{keyAction:this.keyActionHandler.bind(this),keyConfigs:this.keyConfigure,eventName:"keydown"})):this.filterInput=this.element),"auto"!==this.options.popupHeight){var c=0;if(sf.base.isNullOrUndefined(a)||(c=a.parentElement.getBoundingClientRect().height,h=(parseInt(h,10)-c).toString()+"px"),e.querySelector(".e-ddl-header")){var p=e.querySelector(".e-ddl-header"),u=Math.round(p.getBoundingClientRect().height);h=(parseInt(h,10)-(u+c)).toString()+"px"}if(e.querySelector(".e-ddl-footer")){var g=e.querySelector(".e-ddl-footer");u=Math.round(g.getBoundingClientRect().height);h=(parseInt(h,10)-(u+c)).toString()+"px"}this.list.style.maxHeight=(parseInt(h,10)-2).toString()+"px",e.style.maxHeight=sf.base.formatUnit(this.options.popupHeight)}else e.style.height="auto";if(this.list&&this.list.querySelector(".e-active")&&this.setScrollPosition(),sf.base.Browser.isDevice&&!this.options.allowFiltering&&("SfDropDownList"===this.options.moduleName||"SfComboBox"===this.options.moduleName)){l=this.getOffsetValue(e);var f=this.isEmptyList()?this.list:this.liCollections[0];s=-(parseInt(getComputedStyle(f).textIndent,10)-parseInt(getComputedStyle(this.element).paddingLeft,10)+parseInt(getComputedStyle(this.element.parentElement).borderLeftWidth,10))}if(this.popupCreation(e,l,s),this.checkCollision(e),sf.base.Browser.isDevice&&(this.popupObj.element.classList.add("e-ddl-device"),("SfDropDownList"===this.options.moduleName||"SfComboBox"===this.options.moduleName&&!this.options.allowFiltering)&&(this.popupObj.collision={X:"fit",Y:"fit"}),this.options.allowFiltering&&"SfDropDownList"===this.options.moduleName&&(this.popupObj.element.classList.add("e-ddl-device-filter"),this.popupObj.position={X:0,Y:0},this.popupObj.dataBind(),sf.base.attributes(this.popupObj.element,{style:"left:0px;right:0px;top:0px;bottom:0px;z-index:"+this.options.zIndex.toString()+";"}),sf.base.addClass([document.body,this.popupObj.element],"e-popup-full-page"),this.setSearchBoxPosition())),e.style.visibility="visible",sf.base.addClass([e],"e-popup-close"),sf.base.Browser.isDevice){if("SfDropDownList"===this.options.moduleName&&!this.options.allowFiltering||"SfComboBox"===this.options.moduleName&&!this.options.allowFiltering)for(var m=0,y=this.popupObj.getScrollableParent(this.containerElement);m<y.length;m++){var v=y[m];sf.base.EventHandler.add(v,"scroll",this.scrollHandler,this)}this.isFilterLayout()&&sf.base.EventHandler.add(this.list,"scroll",this.listScroll,this)}if(null!==i&&null!==i.popup&&r){for(var b=0,w=Object.keys(i.popup);b<w.length;b++){switch(w[b]){case"collision":!i.popup.collision||this.popupObj.collision.X===i.popup.collision.X.toLowerCase()&&this.popupObj.collision.Y===i.popup.collision.Y.toLowerCase()||(this.popupObj.collision={X:i.popup.collision.X.toLowerCase(),Y:i.popup.collision.Y.toLowerCase()});break;case"position":!this.popupObj.position||this.popupObj.position.X===i.popup.position.X&&this.popupObj.position.Y===i.popup.position.Y||(this.popupObj.position={X:i.popup.position.X,Y:i.popup.position.Y});break;case"relateTo":this.popupObj.relateTo!==i.popup.relateTo&&(this.popupObj.relateTo=i.popup.relateTo);break;case"targetType":this.popupObj.targetType!==i.popup.targetType.toLowerCase()&&(this.popupObj.targetType=i.popup.targetType);break;case"offsetX":this.popupObj.offsetX!==i.popup.offsetX&&(this.popupObj.offsetX=i.popup.offsetX);break;case"offsetY":this.popupObj.offsetY!==i.popup.offsetY&&(this.popupObj.offsetY=i.popup.offsetY)}}this.popupObj.dataBind(),this.popupObj.refreshPosition(this.popupObj.relateTo,!0)}this.options.enableVirtualization&&sf.base.EventHandler.add(this.list,"scroll",this.virtualScroll,this),sf.base.attributes(this.containerElement,{"aria-expanded":"true"});var x=this.options.allowFiltering?this.filterInput.parentElement:this.containerElement;sf.base.addClass([x],["e-input-focus"]);this.popupObj.show(new sf.base.Animation({name:"FadeIn",duration:100}),1e3===this.options.zIndex?this.element:null);var M=navigator.platform&&/iPad|iPhone|iPod/.test(navigator.platform);this.options.allowFiltering&&"SfDropDownList"===this.options.moduleName&&sf.base.Browser.isDevice&&M&&this.popupObj.element.classList.add("e-ios")},t.prototype.wireListEvents=function(){sf.base.EventHandler.add(this.list,"mouseover",this.onMouseOver,this),sf.base.EventHandler.add(this.list,"mouseout",this.onMouseLeave,this)},t.prototype.unWireListEvents=function(){sf.base.EventHandler.remove(this.list,"mouseover",this.onMouseOver),sf.base.EventHandler.remove(this.list,"mouseout",this.onMouseLeave)},t.prototype.onMouseOver=function(e){var t=sf.base.closest(e.target,".e-list-item");this.setHover(t)},t.prototype.onMouseLeave=function(e){this.removeHover()},t.prototype.listScroll=function(){this.filterInput.blur()},t.prototype.scrollHandler=function(){this.isDisposed||this.dotNetRef.invokeMethodAsync("Hide")},t.prototype.setFloatingHeader=function(t){var i=this.popupContainer&&this.popupContainer.querySelector(".e-content");i&&i.classList.contains("e-nodata")&&this.fixedHeaderElement?(sf.base.remove(this.fixedHeaderElement),this.fixedHeaderElement=null):this.list&&this.list.querySelector("li")&&(sf.base.isNullOrUndefined(this.fixedHeaderElement)&&(this.fixedHeaderElement=sf.base.createElement("div",{className:"e-fixed-head"}),this.list.querySelector("li").classList.contains(e)||(this.fixedHeaderElement.style.display="none"),sf.base.prepend([this.fixedHeaderElement],this.list),this.setFixedHeader()),this.scrollStop(t))},t.prototype.setFixedHeader=function(){this.list.parentElement.style.display="block";var t=0;this.list&&this.list.parentElement&&(t=parseInt(document.defaultView.getComputedStyle(this.list.parentElement,null).getPropertyValue("border-width"),10));var i=(this.list?this.list.querySelectorAll(".e-list-item")[0].offsetWidth:0)-t;this.fixedHeaderElement.style.width=i.toString()+"px",sf.base.setStyleAttribute(this.fixedHeaderElement,{zIndex:10});var r=this.list.querySelector("."+e);this.fixedHeaderElement.innerHTML=r.innerHTML},t.prototype.scrollStop=function(t){for(var i=t.target,r=this.list.querySelectorAll("li"),n=parseInt(getComputedStyle(r[0],null).getPropertyValue("height"),10),o=Math.round(i.scrollTop/n);o>-1;o--){if(!sf.base.isNullOrUndefined(r[o])&&r[o].classList.contains(e)){var s=r[o];this.fixedHeaderElement.innerHTML=s.innerHTML,this.fixedHeaderElement.style.top=t.target.scrollTop+"px",this.fixedHeaderElement.style.display="block";break}this.fixedHeaderElement.style.display="none",this.fixedHeaderElement.style.top="none"}},t.prototype.isFilterLayout=function(){return"SfDropDownList"===this.options.moduleName&&this.options.allowFiltering},t.prototype.setSearchBoxPosition=function(){var e=this.popupObj.element.querySelector("span.e-filter-parent").getBoundingClientRect().height,t=this.popupObj.element.querySelector(".e-ddl-footer"),i=this.popupObj.element.querySelector(".e-ddl-header");this.popupObj.element.style.maxHeight="100%",this.popupObj.element.style.width="100%";var r=t?t.getBoundingClientRect().height:0,n=i?i.getBoundingClientRect().height:0;this.list.style.maxHeight=this.list.style.height=window.innerHeight-(r+n+e+4)+"px"},t.prototype.checkCollision=function(e){(!sf.base.Browser.isDevice||sf.base.Browser.isDevice&&"SfDropDownList"!==this.options.moduleName)&&(sf.popups.isCollide(e).length>0&&(e.style.marginTop=-parseInt(getComputedStyle(e).marginTop,10)+"px"))},t.prototype.destroy=function(){sf.base.EventHandler.remove(document,"mousedown",this.onDocumentClick)},t.prototype.refreshPopup=function(){this.isPopupOpen()&&(this.popupObj.refreshPosition(this.containerElement),this.popupObj.element.querySelector(".e-content").classList.contains("e-nodata")&&this.fixedHeaderElement&&(sf.base.remove(this.fixedHeaderElement),this.fixedHeaderElement=null))},t.prototype.popupCreation=function(t,i,r){var n=this;this.popupContainer=t,this.popupObj=new sf.popups.Popup(this.popupContainer,{width:this.setWidth(),targetType:"relative",relateTo:this.containerElement,collision:{X:"flip",Y:"flip"},offsetY:i,enableRtl:this.options.enableRtl,offsetX:r,position:{X:"left",Y:"bottom"},zIndex:this.options.zIndex,close:function(){sf.base.EventHandler.remove(n.list,"scroll",n.setFloatingHeader),sf.base.removeClass([n.containerElement],"e-icon-anim"),n.fixedHeaderElement=null,n.popupHolder.appendChild(n.popupContainer),n.unWireListEvents();for(var e=0,t=n.popupObj.getScrollableParent(n.containerElement);e<t.length;e++){var i=t[e];sf.base.EventHandler.remove(i,"scroll",n.scrollHandler)}sf.base.Browser.isDevice&&n.isFilterLayout()&&(sf.base.removeClass([document.body,n.popupObj.element],"e-popup-full-page"),sf.base.EventHandler.remove(n.list,"scroll",n.listScroll)),n.options.enableVirtualization&&sf.base.EventHandler.remove(n.list,"scroll",n.virtualScroll),n.popupObj&&n.popupObj.destroy(),!n.isDisposed&&document.body.contains(n.element)&&n.dotNetRef.invokeMethodAsync("ClosePopup").catch((function(){})),n.popupObj=null},open:function(){var t=n.list.querySelector("li")&&n.list.querySelector("li").classList.contains(e),i=!sf.base.isNullOrUndefined(n.list)&&n.list.classList.contains("e-nodata");sf.base.EventHandler.add(document,"mousedown",n.onDocumentClick,n),n.options.allowFiltering&&n.filterInput&&n.filterInput.focus(),t&&sf.base.EventHandler.add(n.list,"scroll",n.setFloatingHeader,n),!n.options.enableVirtualization||t||i||n.virtualScroll()},targetExitViewport:function(){sf.base.Browser.isDevice||n.isDisposed||n.dotNetRef.invokeMethodAsync("Hide")}})},t.prototype.virtualScroll=function(){if(this.popupObj&&this.popupObj.element){var e=parseInt(getComputedStyle(this.popupObj.element).borderWidth,10);e=0==e?1:e;var t=this.popupObj.element.classList.contains("e-popup-open");this.list.scrollTop+this.list.offsetHeight+e>=this.list.scrollHeight&&t&&!this.isDisposed&&this.dotNetRef.invokeMethodAsync("VirtualScrollHandler")}},t.prototype.isEmptyList=function(){return!sf.base.isNullOrUndefined(this.liCollections)&&0===this.liCollections.length},t.prototype.setWidth=function(){var e=sf.base.formatUnit(this.options.popupWidth);e.indexOf("%")>-1&&(e=(this.containerElement.offsetWidth*parseFloat(e)/100).toString()+"px");if(sf.base.Browser.isDevice&&!this.options.allowFiltering){var t=this.isEmptyList()?this.list:this.liCollections[0];e=parseInt(e,10)+2*(parseInt(getComputedStyle(t).textIndent,10)-parseInt(getComputedStyle(this.element).paddingLeft,10)+parseInt(getComputedStyle(this.element.parentElement).borderLeftWidth,10))+"px"}return e},t.prototype.onDocumentClick=function(e){var t=e.target;!sf.base.isNullOrUndefined(this.popupObj)&&sf.base.closest(t,"[id='"+this.popupObj.element.id+"']")||this.containerElement.contains(e.target)?t===this.element||this.options.allowFiltering&&t===this.filterInput||"SfComboBox"===this.options.moduleName&&!this.options.allowFiltering&&sf.base.Browser.isDevice&&t===this.containerElement.querySelector(".e-ddl-icon")||e.preventDefault():!this.containerElement.classList.contains("e-input-focus")&&!this.isPopupOpen()||this.isDisposed||this.dotNetRef.invokeMethodAsync("Hide")},t.prototype.closePopup=function(e,t){if(this.options=t,this.isPopupOpen()&&!e.cancel&&this.popupObj){this.popupObj.hide(new sf.base.Animation({name:"FadeOut",duration:20,delay:0}))}},t.prototype.setScrollPosition=function(e){if(sf.base.isNullOrUndefined(e))this.scrollBottom(!0);else switch(e.action){case"pageDown":case"down":case"end":this.scrollBottom();break;default:this.scrollTop()}},t.prototype.scrollBottom=function(t){if(this.list&&(this.list.querySelector(".e-item-focus")||this.list.querySelector(".e-active"))){var i=this.list.querySelector(".e-item-focus")||this.list.querySelector(".e-active"),r=this.list.offsetHeight,n=this.list.querySelector("li").classList.contains(e),o=i.offsetTop+i.offsetHeight-this.list.scrollTop,s=this.list.scrollTop+o-r;s=t?s+2*parseInt(getComputedStyle(this.list).paddingTop,10):s+parseInt(getComputedStyle(this.list).paddingTop,10);var a=i.offsetTop+i.offsetHeight-this.list.scrollTop;a=n&&!sf.base.isNullOrUndefined(this.fixedHeaderElement)?a-this.fixedHeaderElement.offsetHeight:a,0===this.activeIndex?this.list.scrollTop=0:(o>r||!(a>0&&this.list.offsetHeight>a))&&(this.list.scrollTop=s)}},t.prototype.scrollTop=function(){if(this.list&&(this.list.querySelector(".e-item-focus")||this.list.querySelector(".e-active"))){var t=this.list.querySelector(".e-item-focus")||this.list.querySelector(".e-active"),i=t.offsetTop-this.list.scrollTop,r=this.list.querySelector("li").classList.contains(e);i=r&&!sf.base.isNullOrUndefined(this.fixedHeaderElement)?i-this.fixedHeaderElement.offsetHeight:i;var n=t.offsetTop+t.offsetHeight-this.list.scrollTop;0===this.activeIndex?this.list.scrollTop=0:i<0?this.list.scrollTop=this.list.scrollTop+i:n>0&&this.list.offsetHeight>n||(this.list.scrollTop=t.offsetTop-(r&&!sf.base.isNullOrUndefined(this.fixedHeaderElement)?this.fixedHeaderElement.offsetHeight:0))}},t.prototype.setHover=function(e){e&&!e.classList.contains("e-hover")&&(this.removeHover(),sf.base.addClass([e],"e-hover"))},t.prototype.removeHover=function(){if(this.list){var e=this.list.querySelectorAll(".e-hover");e&&e.length&&sf.base.removeClass(e,"e-hover")}},t.prototype.isPopupOpen=function(){return this.popupObj&&document.body.contains(this.popupObj.element)},t}();return{initialize:function(e,i,r,n,o){r&&new t(e,i,r,n,o).initialize()},renderPopup:function(e,t,i,r,n,o,s){var a=window.sfBlazor.getCompInstance(e);!sf.base.isNullOrUndefined(a)&&t&&i&&a.renderPopup(t,i,r,n,o,s)},refreshPopup:function(e){var t=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(t)||t.refreshPopup()},closePopup:function(e,t,i){var r=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(r)||r.closePopup(t,i)},updateScrollPosition:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||i.setScrollPosition(t)},getPageCount:function(e){var t=e&&e.querySelector(".e-content");if(t){var i=t.classList.contains("e-nodata")?null:getComputedStyle(t.querySelectorAll(".e-list-item")[0],null).getPropertyValue("height");return Math.round(t.getBoundingClientRect().height/parseInt(i,10))}return 0},setAutoFillSelection:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||i.setAutoFillSelection(t)},removeFillSelection:function(e){var t=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(t)||t.removeFillSelection()},focusIn:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||(t?i.containerElement.focus():i.element.focus())},focusOut:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||(t?i.containerElement.blur():i.element.blur())},destroy:function(e,t,i,r,n){var o=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(o)||(t&&t instanceof HTMLElement&&i&&(o.isDisposed=!0,o.closePopup(r,n)),o.destroy())}}}()},"./modules/sf-listbox.js":function(e,t){window.sfBlazor=window.sfBlazor||{},window.sfBlazor.ListBox=function(){"use strict";var e,t="e-list-item",i=function(){function i(t,i,r,n,o){this.element=t,this.dotnetRef=n,this.allowDragAndDrop=r,e=o,this.element.blazor__instance=this,this.scope=i,sf.base.EventHandler.add(this.element,"keydown",this.keyDownHandler,this),r&&this.initializeDraggable()}return i.prototype.initializeDraggable=function(){var e=this;if(this.allowDragAndDrop){var i=sf.base.select(".e-ul",this.element),r=new sf.lists.Sortable(i,{scope:this.scope,itemClass:t,beforeDragStart:this.triggerBeforeDragStart.bind(this),drag:this.triggerDrag.bind(this),dragStart:this.triggerDragStart.bind(this),beforeDrop:this.dragEnd.bind(this),placeHolder:function(){return sf.base.createElement("span",{className:"e-placeholder"})},helper:function(i){var r=e.element.cloneNode(),n=i.sender.cloneNode(!0);r.appendChild(n);var o=sf.base.select("."+t,e.element);r.style.width=o.offsetWidth+"px",r.style.height=o.offsetHeight+"px";var s=[].slice.call(sf.base.selectAll("."+t+".e-selected",e.element));return s.length&&s.length>1&&s.indexOf(i.sender)>-1&&n.appendChild(sf.base.createElement("span",{className:"e-list-badge",innerHTML:s.length.toString()})),r.style.zIndex=sf.popups.getZindexPartial(e.element).toString(),r}});this.updateDraggable(r,this.allowDragAndDrop)}},i.prototype.triggerBeforeDragStart=function(e){e.cancel=e.target.classList.contains("e-drag-prevent")},i.prototype.triggerDragStart=function(e){e.bindEvents(e.dragElement)},i.prototype.triggerDrag=function(t){var i,r,n,o=0,s=10,a=t.event;e&&(s=t.target.scrollHeight),t.target&&(t.target.classList.contains("e-listbox-container")||t.target.classList.contains("e-list-item")||t.target.classList.contains("e-input-group")||t.target.classList.contains("e-filter-parent"))&&(r=(i=(n=t.target.classList.contains("e-list-item")||t.target.classList.contains("e-input-group")||t.target.classList.contains("e-filter-parent")?t.target.closest(".e-listbox-container"):t.target).querySelector(".e-list-parent")).getBoundingClientRect(),n.classList.contains("e-filter-list")&&(o=40),r.y+i.offsetHeight-(a.pageY+36)<1?i.scrollTop=i.scrollTop+s:a.pageY-36-(r.y+o)<1&&(i.scrollTop=i.scrollTop-s)),t.target},i.prototype.dragEnd=function(e){var t,i,r,n=!1,o=!1,s=!1;r=e.target.parentElement.parentElement,"UL"==e.target.tagName&&e.target.className.indexOf("e-list-parent")>-1&&(r=e.target.parentElement),r.blazor__instance||((r=r.parentElement).className.indexOf("e-list-item")>-1&&(r=r.parentElement),r.className.indexOf("e-list-parent")>-1?r=r.parentElement.parentElement:r.className.indexOf("e-list-wrap")>-1&&(r=r.parentElement)),e.cancel=!0,r.blazor__instance?(t=r.blazor__instance.scope,i=r.blazor__instance.dotnetRef,o=this.scope===t,this.element===r&&(s=!0,o=!1)):n=!0,this.dotnetRef.invokeMethodAsync("DragEndAsync",n,e.droppedElement.getAttribute("data-value"),s,o,e.previousIndex,e.currentIndex,i)},i.prototype.keyDownHandler=function(e){var i=e.target;if(38===e.keyCode||40===e.keyCode)if(e.preventDefault(),i.classList.contains("e-listbox-container")){var r=sf.base.select("."+t,this.element);r&&r.focus()}else{var n=[].slice.call(sf.base.selectAll("."+t,this.element)),o=n.indexOf(i);if(o<0)return;if((o=38===e.keyCode?o-1:o+1)<0||o>n.length-1)return;n[o].focus()}else 65===e.keyCode&&e.ctrlKey&&e.preventDefault()},i.prototype.updateDraggable=function(e,i){if(e){var r=sf.base.getComponent(e.element,sf.base.Draggable);r.abort=i?"":"."+t}},i.prototype.destroyDraggable=function(){var e=sf.base.getComponent(sf.base.select(".e-ul",this.element),"sortable");sf.base.isNullOrUndefined(e)||(this.updateDraggable(e,this.allowDragAndDrop),e.destroy())},i.prototype.destroy=function(){this.destroyDraggable(),sf.base.EventHandler.remove(this.element,"keydown",this.keyDownHandler)},i.prototype.onPropertyChanged=function(e){this.allowDragAndDrop=e,e?this.initializeDraggable():this.destroyDraggable()},i.prototype.getScopedElement=function(e){return sf.base.select("#"+e).blazor__instance.dotnetRef},i}();return{initialize:function(e,t,r,n,o){sf.base.isNullOrUndefined(e)||new i(e,t,r,n,o)},destroy:function(e){sf.base.isNullOrUndefined(e)||sf.base.isNullOrUndefined(e.blazor__instance)||e.blazor__instance.destroy()},onPropertyChanged:function(e,t){sf.base.isNullOrUndefined(e)||sf.base.isNullOrUndefined(e.blazor__instance)||e.blazor__instance.onPropertyChanged(t)},getScopedListBox:function(e,t){return e.blazor__instance.getScopedElement(t)}}}()},"./modules/sf-listview.js":function(e,t){window.sfBlazor=window.sfBlazor||{},window.sfBlazor.ListView=function(){"use strict";var e={None:[],SlideLeft:["SlideRightOut","SlideLeftOut","SlideLeftIn","SlideRightIn"],SlideDown:["SlideTopOut","SlideBottomOut","SlideBottomIn","SlideTopIn"],Zoom:["FadeOut","FadeZoomOut","FadeZoomIn","FadeIn"],Fade:["FadeOut","FadeOut","FadeIn","FadeIn"]},t={None:[],SlideLeft:["SlideLeftOut","SlideRightOut","SlideRightIn","SlideLeftIn"],SlideDown:["SlideBottomOut","SlideTopOut","SlideTopIn","SlideBottomIn"],Zoom:["FadeZoomOut","FadeOut","FadeIn","FadeZoomIn"],Fade:["FadeOut","FadeOut","FadeIn","FadeIn"]},i="e-focused",r="e-list-item",n="e-has-child",o="e-list-header",s="e-disabled",a="e-check",l="none",h=function(){function h(e,t,i,r,n,o){this.dataSourceLevel=["defaultData_Key"],this.currentDataSourceKey="defaultData_Key",this.isWindow=!1,this.liDifference=0,this.liHeight=0,this.virtualListDifference=0,this.isCheckAll=!1,this.isFocus=!1,this.element=t,this.dotNetRef=i,this.dataId=e,this.showCheckBox=r.ShowCheckBox,this.showHeader=r.ShowHeader,this.enable=r.Enabled,this.currentUlElement=t.querySelector("ul"),this.enableVirtualization=r.EnableVirtualization,this.isWindow=!r.Height,this.enableSelectEvent=n,this.height=r.Height,this.headerTitleInfo=[r.HeaderTitle],this.selectedItems={defaultData_Key:r.SelectedElementIdInfo},this.enableRtl=r.EnableRtl,this.animation=r.Animation,this.isTemplate=r.Template,this.focusId=[],window.sfBlazor.setCompInstance(this),this.datasource=o}return h.prototype.initialize=function(){if(this.enableVirtualization){if(this.isWindow)this.dotNetRef.invokeMethodAsync("GetComponenetHeight",window.innerHeight);else if(-1!==this.height.indexOf("%")){var e=this.element.parentElement.getBoundingClientRect().height;this.dotNetRef.invokeMethodAsync("GetComponenetHeight",e/100*parseFloat(this.height))}this.updateLiElementHeight()}this.headerElement=this.element.querySelector(".e-headertext"),this.animationObject=new sf.base.Animation(this.animateOptions),this.wireEvents()},h.prototype.wireEvents=function(){sf.base.EventHandler.add(this.element,"focus",this.focusHandler,this),sf.base.EventHandler.add(this.element,"mousedown",this.mouseDownHandler,this),sf.base.EventHandler.add(this.element,"keydown",this.keyActionHandler,this),sf.base.EventHandler.add(this.element,"click",this.clickHandler,this),sf.base.EventHandler.add(this.element,"focusout",this.removeFocus,this),this.touchModule=new sf.base.Touch(this.element,{swipe:this.swipeActionHandler.bind(this)}),this.enableVirtualization?(sf.base.EventHandler.add(this.element,"scroll",this.scrollHandler,this),this.isWindow&&window.addEventListener("scroll",this.scrollHandler.bind(this))):(sf.base.EventHandler.add(this.element,"mouseover",this.mouseHoverHandler,this),sf.base.EventHandler.add(this.element,"mouseout",this.mouseOutHandler,this))},h.prototype.unWireEvents=function(){sf.base.EventHandler.remove(this.element,"focus",this.focusHandler),sf.base.EventHandler.remove(this.element,"mousedown",this.mouseDownHandler),sf.base.EventHandler.remove(this.element,"keydown",this.keyActionHandler),sf.base.EventHandler.remove(this.element,"click",this.clickHandler),sf.base.EventHandler.remove(this.element,"focusout",this.removeFocus),this.enableVirtualization?(sf.base.EventHandler.remove(this.element,"scroll",this.scrollHandler),this.isWindow&&window.removeEventListener("scroll",this.scrollHandler.bind(this))):(sf.base.EventHandler.remove(this.element,"mouseover",this.mouseHoverHandler),sf.base.EventHandler.remove(this.element,"mouseout",this.mouseOutHandler)),this.touchModule.destroy()},h.prototype.swipeActionHandler=function(e){"Right"===e.swipeDirection&&e.velocity>.5&&"touchend"===e.originalEvent.type&&(this.showCheckBox&&this.dataSourceLevel[this.dataSourceLevel.length-1]&&this.uncheckAllItems(),this.back())},h.prototype.showHideItem=function(e,t){var i=this.getLi(e);i&&(i.style.display=t)},h.prototype.enableState=function(e,t){var i=this.getLi(e);i&&(t?i.classList.remove("e-disabled"):i.classList.add("e-disabled"))},h.prototype.getLi=function(e){var t;return this.element&&(t=this.element.querySelector('[data-uid="'+e.id+'"]')),t},h.prototype.scrollHandler=function(e){var t,r=this.isWindow?e.target.documentElement.scrollTop:e.target.scrollTop;if(this.liHeight||this.updateLiElementHeight(),(t=Math.round(r/this.liHeight))-this.liDifference>=this.virtualListDifference||t-this.liDifference<=-1){var n=this.currentUlElement.querySelector("."+i);n&&(this.focusedElementId=n.getAttribute("data-uid"));var o=this.element.querySelector(".e-list-virtualcontainer");o&&(o.style.top=(t-1)*this.liHeight<0?"0px":(t-2)*this.liHeight+"px",this.liDifference=t,this.dotNetRef.invokeMethodAsync("VirtualScrolling",t-2))}},h.prototype.preventSelection=function(e){var t=this.mouseEvent.target,i=sf.base.closest(t,"."+r);e?this.dataSourceLevel.length>1&&this.dataSourceLevel.pop():this.performSelection(i)},h.prototype.performSelection=function(e){null!==e&&!e.classList.contains(s)&&this.enable&&(this.removeFocus(),this.focusId=[],this.addFocusId(e.getAttribute("data-uid")),this.showCheckBox?this.mouseEvent.target.classList.contains("e-frame")?this.checkUncheckItem(e):e.classList.contains(n)?(this.removeHover(),this.removeFocus(),this.setSelectLI(e,this.mouseEvent)):this.checkUncheckItem(e):(this.currentUlElement.querySelector("."+i)&&this.currentUlElement.querySelector("."+i).classList.remove(i),e.classList.contains(n)?this.setSelectLI(e,this.mouseEvent):e.classList.contains(i)||(e.classList.add(i),this.selectedItems[this.currentDataSourceKey][0]=e.getAttribute("data-uid"))))},h.prototype.updateLiElementHeight=function(){var e=this.element.querySelector(".e-list-virtualcontainer");if(e){this.currentUlElement||(this.currentUlElement=this.element.querySelector("ul"));var t=e.children[0];if(t){if(this.liHeight=t.getBoundingClientRect().height,this.liHeight&&this.enableVirtualization){var i=e.getBoundingClientRect().height;e.parentElement.style.height=i+"px"}}else{var n=sf.base.createElement("li",{className:r});e.appendChild(n),this.liHeight=e.children[0].getBoundingClientRect().height,sf.base.detach(n)}this.liHeight&&this.dotNetRef.invokeMethodAsync("UpdateLiElementHeight",this.liHeight)}},h.prototype.updateElementDifference=function(e){this.virtualListDifference=e,this.enableVirtualization&&this.updateLiElementHeight()},h.prototype.selectItem=function(e){var t=this.getLi(e);this.showCheckBox?this.setChecked(t,t.querySelector(".e-checkbox-wrapper")):(sf.base.isNullOrUndefined(t)?this.removeFocus():this.setSelectLI(t,null),this.selectedItems[this.currentDataSourceKey][0]=t.getAttribute("data-uid"))},h.prototype.clickHandler=function(e){if(this.currentUlElement&&!this.element.classList.contains("e-disabled")){var t=e.target,i=t.classList;if(this.mouseEvent=e,i.contains("e-icon-back")||i.contains("e-headertext"))this.back();else{var o=sf.base.closest(t.parentNode,"."+r)?sf.base.closest(t.parentNode,"."+r):sf.base.closest(t,"."+r);if(this.enableSelectEvent||this.performSelection(o),null!==o&&!o.classList.contains(s)&&this.enable){if(o.classList.contains(n)){var a=o.getAttribute("data-uid");-1===this.dataSourceLevel.indexOf(a)&&this.dataSourceLevel.push(a)}this.enableSelectEvent&&(this.isFocus=!1,this.getSelectEventData(o,e))}}}},h.prototype.checkUncheckItem=function(e){e.classList.add(i),e.querySelector("."+a)?this.uncheckItem(e):this.setChecked(e,e.querySelector(".e-checkbox-wrapper")),this.dotNetRef.invokeMethodAsync("UpdateData",!sf.base.isNullOrUndefined(e.querySelector("."+a)),e.getAttribute("data-uid"))},h.prototype.back=function(){if(this.dataSourceLevel.length>1){for(var e=this.element.querySelectorAll("ul"),t=this.element.querySelector("."+o),r=0;r<e.length;r++)this.dataSourceLevel.length>2?e[r].getAttribute("pid")===this.dataSourceLevel[this.dataSourceLevel.length-2]?(this.switchView(this.currentUlElement,e[r],!0),this.currentUlElement=e[r]):e[r].style.display=l:null===e[r].getAttribute("pid")?(this.switchView(this.currentUlElement,e[r],!0),this.currentUlElement=e[r]):e[r].style.display=l;if(this.dataSourceLevel.pop(),!this.showCheckBox)this.currentUlElement.querySelectorAll("."+i)[0].setAttribute("aria-selected","false");this.isTemplate||(this.headerTitleInfo.length>1&&this.headerTitleInfo.pop(),this.headerElement&&(this.headerElement.innerText=this.headerTitleInfo[this.headerTitleInfo.length-1])),this.currentDataSourceKey=this.dataSourceLevel[this.dataSourceLevel.length-1],1===this.dataSourceLevel.length&&t&&(t.children[0].style.display=l,t.classList.remove("e-list-navigation"));var n={IsInteracted:!(!event&&!this.isRootFocus),Level:this.dataSourceLevel.length>0?this.dataSourceLevel.length-1:this.dataSourceLevel.length};this.dotNetRef.invokeMethodAsync("TriggerBackEvent",n)}},h.prototype.setHoverLI=function(e){this.element.classList.contains(s)||e.classList.contains(s)||e.classList.add("e-hover")},h.prototype.mouseHoverHandler=function(e){var t=sf.base.closest(e.target.parentNode,"."+r);t&&this.setHoverLI(t)},h.prototype.mouseOutHandler=function(e){this.removeHover()},h.prototype.removeHover=function(){var e=this.element.querySelector(".e-hover");e&&e.classList.remove("e-hover")},h.prototype.removeFocus=function(){this.currentUlElement||(this.currentUlElement=this.element.querySelector("ul"));for(var e=0,t=this.currentUlElement.querySelectorAll("."+i);e<t.length;e++){t[e].classList.remove(i)}this.isRestrictFocus=void 0},h.prototype.isValidLI=function(e){return e&&e.classList.contains(r)&&!e.classList.contains("e-list-group-item")&&!e.classList.contains(s)},h.prototype.setSelectLI=function(e,t){if(this.enable&&this.isValidLI(e)&&!e.classList.contains(i)){var r=this.currentUlElement.querySelector("."+i);r&&this.removeFocusId(r.getAttribute("data-uid")),this.removeFocus(),this.addAriaAttribute(!0,e),this.removeHover(),e.classList.contains(n)&&this.renderSubList(e)}},h.prototype.addAriaAttribute=function(e,t){e?(this.isCheckAll||t.classList.add(i),this.addFocusId(t.getAttribute("data-uid"))):this.showCheckBox||e||!t.classList.contains(i)||(t.classList.remove(i),this.focusId.indexOf(t.getAttribute("data-uid"))>=0&&this.focusId.splice(this.focusId.indexOf(t.getAttribute("data-uid")),1)),(this.showCheckBox||t.classList.contains(n))&&t.setAttribute("aria-selected",e.toString())},h.prototype.renderSubList=function(e){var t=e,r=e.getAttribute("data-uid"),s=this.element.querySelector("."+o);if(e.classList.remove(i),e.classList.add(i),this.showHeader&&s&&(s.children[0].style.display=null,s.classList.add("e-list-navigation")),t.classList.contains(n)&&r){if(this.element.querySelector("[pid='"+r+"']"))this.renderChildList(r,[r]);else{var a={ElementId:r,Key:this.currentDataSourceKey};this.dotNetRef.invokeMethodAsync("ListChildDataSource",a)}this.isTemplate||(this.headerTitleInfo.push(t.innerText.trim()),this.headerElement&&(this.headerElement.innerText=this.headerTitleInfo[this.headerTitleInfo.length-1])),-1==this.dataSourceLevel.indexOf(r)&&this.dataSourceLevel.push(r),this.currentDataSourceKey=r}},h.prototype.renderChildList=function(e,t){var i=this.element.querySelectorAll("ul");i[i.length-1].getAttribute("pid")||i[i.length-1].setAttribute("pid",e);for(var r=0;r<i.length;r++)if(i[r].getAttribute("pid")===e){this.switchView(this.currentUlElement,i[r],!1),this.currentUlElement=i[r];var n=i[r].querySelectorAll(".e-list-item");if(n[0].getAttribute("aria-level")!==r.toString())for(var o=0;o<n.length;o++)n[o].setAttribute("aria-level",r.toString());t&&(this.selectedItems[e]=t)}},h.prototype.mouseDownHandler=function(){this.isRestrictFocus=null==this.isRestrictFocus||this.isRestrictFocus},h.prototype.focusHandler=function(e){this.isRestrictFocus?this.isRestrictFocus=!1:sf.base.isNullOrUndefined(this.focusId)||0==this.focusId.length?(this.isRootFocus=!0,this.arrowKeyHandler(e),this.isRootFocus=!1):(this.isFocus=!0,this.updateFocusElement(e))},h.prototype.keyActionHandler=function(e){if("INPUT"!=e.target.tagName&&"TEXTAREA"!=e.target.tagName)switch(e.keyCode){case 36:this.homeKeyHandler(e);break;case 35:this.homeKeyHandler(e,!0);break;case 40:this.arrowKeyHandler(e);break;case 38:this.arrowKeyHandler(e,!0);break;case 39:this.arrowKeyHandler(e);break;case 37:this.arrowKeyHandler(e,!0);break;case 13:this.enterKeyHandler(e);break;case 8:var t=this.element.querySelector("."+o+" .e-icon-back");t&&t.style.display!=l&&(this.showCheckBox&&this.currentDataSourceKey&&this.uncheckAllItems(),this.back());break;case 32:this.spaceKeyHandler(e)}},h.prototype.addFocusId=function(e){this.focusId.indexOf(e)<0&&this.focusId.push(e)},h.prototype.removeFocusId=function(e){this.focusId.indexOf(e)>=0&&this.focusId.splice(this.focusId.indexOf(e),1)},h.prototype.updateFocusElement=function(e){var t=this.currentUlElement.querySelector("."+i);t&&(t.classList.remove(i),this.focusId.indexOf(t.getAttribute("data-uid"))>=0&&this.focusId.splice(this.focusId.indexOf(t.getAttribute("data-uid")),1));for(var r=this.currentUlElement.children,n=0;n<r.length;n++)this.focusId.indexOf(r[n].getAttribute("data-uid"))>=0&&(r[n].classList.add(i),this.addFocusId(r[n].getAttribute("data-uid")),this.addAriaAttribute(!0,r[n]),this.element.setAttribute("aria-activedescendant",r[n].id.toString()),this.enableSelectEvent&&(this.getSelectEventData(r[n],e),this.isFocus=!1))},h.prototype.homeKeyHandler=function(e,t){e.preventDefault();var r=this.currentUlElement.querySelector("."+i);r&&(r.classList.remove(i),this.removeFocusId(r.getAttribute("data-uid")));var n=t?this.currentUlElement.children.length-1:0;n=this.currentUlElement.children[n].classList.contains("e-list-group-item")&&this.currentUlElement.children.length>1?n+1:n;var o=this.currentUlElement.children[n];this.addAriaAttribute(!0,o),o.classList.add(i),this.addFocusId(o.getAttribute("data-uid")),this.currentUlElement.children[n]?this.element.setAttribute("aria-activedescendant",this.currentUlElement.children[n].id.toString()):this.element.removeAttribute("aria-activedescendant"),this.enableSelectEvent&&this.getSelectEventData(o,e)},h.prototype.onArrowKeyDown=function(e,t){var o,s;return!sf.base.isNullOrUndefined(this.currentUlElement.querySelector("."+n))||this.showCheckBox?((s=this.currentUlElement.querySelector("."+i)||this.currentUlElement.querySelector("."+i))&&this.removeFocusId(s.getAttribute("data-uid")),o=this.getSiblingLI(this.currentUlElement.querySelectorAll("."+r),s,t),sf.base.isNullOrUndefined(o)||(s&&(s.classList.remove(i),this.showCheckBox||s.classList.remove(i),this.removeFocusId(s.getAttribute("data-uid"))),o.classList.contains(n)||this.showCheckBox?o.classList.add(i):this.setSelectLI(o,e))):(s=this.currentUlElement.querySelector("."+i),o=this.getSiblingLI(this.currentUlElement.querySelectorAll("."+r),s,t),this.setSelectLI(o,e)),o?this.element.setAttribute("aria-activedescendant",o.id.toString()):this.element.removeAttribute("aria-activedescendant"),o},h.prototype.getSiblingLI=function(e,t,i){var r=Array.prototype.slice.call(e),n=r.indexOf(t);return i?r[n-1]:r[n+1]},h.prototype.arrowKeyHandler=function(e,t){if(this.isRootFocus||e.preventDefault(),this.currentUlElement){var i=this.onArrowKeyDown(e,t);i&&this.addFocusId(i.getAttribute("data-uid"));var r=this.element.getBoundingClientRect().top,n=this.element.getBoundingClientRect().height,o=void 0;if(i){var s=i.getBoundingClientRect().top,a=i.getBoundingClientRect().height;if(t)(o=this.isWindow?s:s-r)<0&&(this.isWindow?window.scroll(0,pageYOffset+o):this.element.scrollTop=this.element.scrollTop+o);else{var l=this.isWindow?window.innerHeight:n;(o=this.isWindow?s+a:s-r+a)>l&&(this.isWindow?window.scroll(0,pageYOffset+(o-l)):this.element.scrollTop=this.element.scrollTop+(o-l))}}}},h.prototype.enterKeyHandler=function(e){if(this.currentUlElement){var t=this.currentUlElement.querySelector("."+i);this.currentUlElement.querySelector("."+n)&&t?(t.classList.remove(i),this.showCheckBox&&(this.removeFocus(),this.removeHover()),this.setSelectLI(t,e)):sf.base.isNullOrUndefined(t)||this.spaceKeyHandler(e)}},h.prototype.checkAllItems=function(){this.isCheckAll=!0,this.updateCheckBoxState(!0),this.isCheckAll=!1},h.prototype.uncheckAllItems=function(){this.updateCheckBoxState(!1)},h.prototype.updateCheckBoxState=function(e){if(this.showCheckBox)for(var t=this.currentUlElement.querySelectorAll("li"),i=this.enableVirtualization?this.currentUlElement.querySelector(".e-list-virtualcontainer").childElementCount:this.currentUlElement.childElementCount,r=0;r<i;r++){var n=t[r].querySelector(".e-frame");n&&(e&&!n.classList.contains(a)?this.checkItem(t[r]):!e&&n.classList.contains(a)&&this.uncheckItem(t[r]))}},h.prototype.checkItem=function(e){this.toggleCheckBox(e,!0)},h.prototype.getCheckData=function(e,t,i){var r=e.id;if(i!==e.id||sf.base.isNullOrUndefined(e.id)){i=i.toLowerCase();for(var n=0,o=Object.entries(e);n<o.length;n++){var s=o[n],a=""+s[0],l=""+s[1];(a=a.toLowerCase())===i&&(r=l)}}var h=this.currentUlElement.querySelector("[data-uid='"+r+"']");t?this.checkItem(h):this.uncheckItem(h),this.removeFocus()},h.prototype.spaceKeyHandler=function(e){if(this.isTemplate||e.preventDefault(),this.enable&&this.showCheckBox&&this.currentUlElement){var t=this.currentUlElement.querySelector("."+i);!sf.base.isNullOrUndefined(t)&&sf.base.isNullOrUndefined(t.querySelector("."+a))?this.setChecked(t,t.querySelector(".e-checkbox-wrapper")):this.uncheckItem(t),this.enableSelectEvent&&this.getSelectEventData(t,e)}},h.prototype.setChecked=function(e,t){this.removeFocus(),e.classList.add(i),this.addAriaAttribute(!0,e),t&&(t.querySelector(".e-frame").classList.add(a),t.setAttribute("aria-checked","true")),this.selectedItems[this.currentDataSourceKey]&&-1===this.selectedItems[this.currentDataSourceKey].indexOf(e.getAttribute("data-uid"))&&this.selectedItems[this.currentDataSourceKey].push(e.getAttribute("data-uid"))},h.prototype.toggleCheckBox=function(e,t){if(this.showCheckBox){var i=e;if(!sf.base.isNullOrUndefined(i)){var r=i.querySelector(".e-frame");this.addAriaAttribute(t,i),sf.base.isNullOrUndefined(r)||(t?r.classList.add(a):r.classList.remove(a),r.parentElement.setAttribute("aria-checked",t?"true":"false"))}}},h.prototype.uncheckItem=function(e){e&&(this.selectedItems[this.currentDataSourceKey]&&-1!==this.selectedItems[this.currentDataSourceKey].indexOf(e.getAttribute("data-uid"))&&this.selectedItems[this.currentDataSourceKey].splice(this.selectedItems[this.currentDataSourceKey].indexOf(e.getAttribute("data-uid")),1),this.toggleCheckBox(e,!1))},h.prototype.addCheckClass=function(){this.currentUlElement||(this.currentUlElement=this.element.querySelector("ul"));for(var e=this.enableVirtualization?this.currentUlElement.querySelector(".e-list-virtualcontainer").children:this.currentUlElement.children,t=this.selectedItems[this.currentDataSourceKey],r=0;r<e.length;r++)this.showCheckBox?(this.focusedElementId&&(this.focusedElementId===e[r].getAttribute("data-uid")?e[r].classList.add(i):e[r].classList.remove(i)),t.length>0&&(-1!==t.indexOf(e[r].getAttribute("data-uid"))?this.toggleCheckBox(e[r],!0):this.toggleCheckBox(e[r],!1))):t[0]===e[r].getAttribute("data-uid")?e[r].classList.add(i):e[r].classList.remove(i);for(r=0;r<e.length;r++)this.showCheckBox?(this.focusedElementId&&(this.focusedElementId===e[r].getAttribute("data-uid")?e[r].classList.add(i):e[r].classList.remove(i)),t.length>0&&(-1!==t.indexOf(e[r].getAttribute("data-uid"))?this.toggleCheckBox(e[r],!0):this.toggleCheckBox(e[r],!1))):t&&t[0]===e[r].getAttribute("data-uid")?e[r].classList.add(i):e[r].classList.remove(i)},h.prototype.getSelectedItems=function(){var e=this.currentUlElement.querySelectorAll(".e-check");this.selectedItems[this.currentDataSourceKey]=[];for(var t=0;t<e.length;t++){var i=sf.base.closest(e[t],"."+r);this.selectedItems[this.currentDataSourceKey]&&-1===this.selectedItems[this.currentDataSourceKey].indexOf(i.getAttribute("data-uid"))&&this.selectedItems[this.currentDataSourceKey].push(i.getAttribute("data-uid"))}return{ElementId:this.selectedItems[this.currentDataSourceKey],Key:this.currentDataSourceKey}},h.prototype.getSelectEventData=function(e,t){if(e){var i="click"===t.type?!e.querySelector("."+a):!!e.querySelector("."+a),r={ElementId:e.getAttribute("data-uid"),IsChecked:i,Key:e.classList.contains(n)&&!t.target.classList.contains("e-frame")?this.dataSourceLevel[this.dataSourceLevel.length-2]:this.currentDataSourceKey,IsInteracted:!(!t&&!this.isRootFocus),Level:this.dataSourceLevel.length>0?this.dataSourceLevel.length-1:this.dataSourceLevel.length};this.isFocus||this.dotNetRef.invokeMethodAsync("TriggerClickEvent",r)}},h.prototype.switchView=function(i,r,n){var o=this;if(i&&r){var s=i.style.position,a="hidden"!==this.element.style.overflow?this.element.style.overflow:"",h=void 0,d=this.animation.duration;if(i.style.position="absolute",i.classList.add("e-view"),"Disable"===sf.base.animationMode){h=this.enableRtl?t.None:e.None,n=this.enableRtl,d=0}else if(this.animation.effect)"None"===this.animation.effect&&"Enable"===sf.base.animationMode&&(this.animation.effect="SlideLeft"),h=this.enableRtl?t[this.animation.effect]:e[this.animation.effect];else{h=e.SlideLeft,n=this.enableRtl,d=0}this.element.style.overflow="hidden",this.animationObject.animate(i,{name:n?h[0]:h[1],duration:d,timingFunction:this.animation.easing,end:function(e){i.style.display=l,o.element.style.overflow=a,i.style.position=s,i.classList.remove("e-view")}}),r.style.display="",this.animationObject.animate(r,{name:n?h[2]:h[3],duration:d,timingFunction:this.animation.easing,end:function(){o.dotNetRef.invokeMethodAsync("TriggerActionComplete",o.datasource)}}),this.currentUlElement=r}},h.prototype.setAnimation=function(e){this.animation=e},h.prototype.setSelectedItems=function(e){var t=this.element.querySelector("."+o);sf.base.isNullOrUndefined(e)||(this.selectedItems={defaultData_Key:e}),e.length>0?this.currentUlElement=this.element.querySelector('[data-uid="'+e+'"]').closest("ul"):this.currentUlElement=this.element.querySelector("ul");var i=this.element.querySelector('[data-uid="'+e+'"]').classList.contains("e-has-child");i?(this.dataSourceLevel=["defaultData_Key"],this.currentUlElement.style.removeProperty("display"),this.addCheckClass(),this.currentDataSourceKey="defaultData_Key"):this.selectedItems[this.currentDataSourceKey]=[this.currentDataSourceKey],this.showCheckBox&&this.removeFocus(),this.headerElement&&i&&(this.headerTitleInfo=this.headerTitleInfo.splice(0,1),this.headerElement.innerText=this.headerTitleInfo[this.headerTitleInfo.length-1]),1===this.dataSourceLevel.length&&t&&i&&(t.children[0].style.display=l,t.classList.remove("e-list-navigation"))},h.prototype.updateHeaderTitle=function(e){this.headerTitleInfo[0]=e,this.headerElement&&(this.headerElement.innerText=e)},h.prototype.destroy=function(){this.element.style.display=l,this.unWireEvents()},h}();return{initialize:function(e,t,i,r,n,o,s){if(t&&e){new h(e,t,i,r,n,s);var a=window.sfBlazor.getCompInstance(e);a.initialize(),a.updateElementDifference(o)}},renderChildList:function(e,t,i){var r=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(r)||r.renderChildList(t,i)},addActiveClass:function(e){var t=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(t)||t.addCheckClass()},showHideItem:function(e,t,i){var r=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(r)||r.showHideItem(t,i)},enableState:function(e,t,i){var r=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(r)||r.enableState(t,i)},back:function(e){var t=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(t)||t.back()},checkAllItems:function(e){var t=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(t)||t.checkAllItems()},uncheckAllItems:function(e){var t=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(t)||t.uncheckAllItems()},getCheckData:function(e,t,i,r){var n=window.sfBlazor.getCompInstance(e);if(!sf.base.isNullOrUndefined(n)&&null!=t)for(var o=0;o<t.length;o++)n.getCheckData(t[o],i,r)},selectItem:function(e,t){var i=window.sfBlazor.getCompInstance(e);if(!sf.base.isNullOrUndefined(i)&&null!=t)for(var r=0;r<t.length;r++)i.selectItem(t[r])},preventSelection:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||i.preventSelection(t)},updateLiElementHeight:function(e){var t=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(t)||t.updateLiElementHeight()},getCheckedItems:function(e){var t=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(t)?{}:t.getSelectedItems()},setAnimation:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||i.setAnimation(t)},setCheckedItems:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||i.setSelectedItems(t)},updateHeaderTitle:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||i.updateHeaderTitle(t)},destroy:function(e){var t=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(t)||t.destroy()},updateElementDifference:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||i.updateElementDifference(t)}}}()},"./modules/sf-numerictextbox.js":function(e,t){window.sfBlazor=window.sfBlazor||{},window.sfBlazor.NumericTextBox=function(){"use strict";var e=new RegExp("^(-)?(\\d*)$"),t=0,i=function(){function i(e,t,i,r,n){window.sfBlazor=window.sfBlazor,this.dataId=e,this.wrapperElement=t,this.element=i,this.options=n,window.sfBlazor.setCompInstance(this),this.dotNetRef=r}return i.prototype.initialize=function(){this.spinButtonEvents(),sf.base.EventHandler.add(this.element,"focus",this.focusHandler,this),sf.base.EventHandler.add(this.element,"blur",this.focusOutHandler,this),sf.base.EventHandler.add(this.element,"keypress",this.keyPressHandler,this),sf.base.EventHandler.add(this.element,"keydown",this.keyDownHandler,this),sf.base.EventHandler.add(this.element,"paste",this.pasteHandler,this),sf.base.Browser.isDevice&&sf.base.EventHandler.add(document,"scroll",this.scrollHandler)},i.prototype.clearInvalid=function(e){this.element.value=e},i.prototype.keyPressHandler=function(e){if(!this.options.enabled||this.options.readonly)return!0;var t=e.keyCode;if(0===e.which||e.metaKey||e.ctrlKey||8===t||13===t)return!0;var i=this.options.decimalSeparator,r=String.fromCharCode(e.which),n="NumpadDecimal"===e.code&&this.keyPressHelper(e)!==i;n&&(r=i);var o=this.element.value;if(o=o.substring(0,this.element.selectionStart)+r+o.substring(this.element.selectionEnd),this.numericRegex().test(o)){if(n){var s=this.element.selectionStart+1;this.element.value=o,this.element.setSelectionRange(s,s),e.preventDefault(),e.stopPropagation()}return!0}return e.preventDefault(),e.stopPropagation(),!1},i.prototype.pasteHandler=function(e){if(this.options.enabled&&!this.options.readonly){var t=e.clipboardData.getData("text/plain");this.numericRegex().test(t.trim())?this.dotNetRef.invokeMethodAsync("InvokePasteHandler",t):e.preventDefault()}},i.prototype.preventHandler=function(){var e=this,t=!!navigator.platform&&/iPad|iPhone|iPod|MacIntel/.test(navigator.platform);setTimeout((function(){if(e.element.selectionStart>0){var i=e.element.selectionStart,r=e.element.selectionStart-1,n=e.element.value.split(""),o=e.options.decimalSeparator.charCodeAt(0);" "===e.element.value[r]&&e.element.selectionStart>0&&!t?(sf.base.isNullOrUndefined(e.prevVal)?e.element.value=e.element.value.trim():0!==r?e.element.value=e.prevVal:0===r&&(e.element.value=e.element.value.trim()),e.element.setSelectionRange(r,r)):isNaN(parseFloat(e.element.value[e.element.selectionStart-1]))&&45!==e.element.value[e.element.selectionStart-1].charCodeAt(0)?(n.indexOf(e.element.value[e.element.selectionStart-1])!==n.lastIndexOf(e.element.value[e.element.selectionStart-1])&&e.element.value[e.element.selectionStart-1].charCodeAt(0)===o||e.element.value[e.element.selectionStart-1].charCodeAt(0)!==o)&&(e.element.value=e.element.value.substring(0,r)+e.element.value.substring(i,e.element.value.length),e.element.setSelectionRange(r,r),isNaN(parseFloat(e.element.value[e.element.selectionStart-1]))&&e.element.selectionStart>0&&e.element.value.length&&e.preventHandler()):isNaN(parseFloat(e.element.value[e.element.selectionStart-2]))&&e.element.selectionStart>1&&45!==e.element.value[e.element.selectionStart-2].charCodeAt(0)&&(n.indexOf(e.element.value[e.element.selectionStart-2])!==n.lastIndexOf(e.element.value[e.element.selectionStart-2])&&e.element.value[e.element.selectionStart-2].charCodeAt(0)===o||e.element.value[e.element.selectionStart-2].charCodeAt(0)!==o)&&(e.element.setSelectionRange(r,r),e.nextEle=e.element.value[e.element.selectionStart],e.cursorPosChanged=!0,e.preventHandler()),!0===e.cursorPosChanged&&e.element.value[e.element.selectionStart]===e.nextEle&&isNaN(parseFloat(e.element.value[e.element.selectionStart-1]))&&(e.element.setSelectionRange(e.element.selectionStart+1,e.element.selectionStart+1),e.cursorPosChanged=!1,e.nextEle=null),""===e.element.value.trim()&&e.element.setSelectionRange(0,0),e.element.selectionStart>0&&45===e.element.value[e.element.selectionStart-1].charCodeAt(0)&&e.element.selectionStart>1&&(sf.base.isNullOrUndefined(e.prevVal)?e.element.value=e.element.value:e.element.value=e.prevVal,e.element.setSelectionRange(e.element.selectionStart,e.element.selectionStart)),e.prevVal=e.element.value}}))},i.prototype.keyDownHandler=function(e){var t=!!navigator.platform&&/iPad|iPhone|iPod|MacIntel/.test(navigator.platform);this.options.readonly||(sf.base.Browser.isDevice&&38!==e.keyCode&&40!==e.keyCode&&8!==e.keyCode&&(this.numericRegex().test(this.keyPressHelper(e))||(t&&sf.base.Browser.isDevice?this.preventHandler():e.preventDefault())),!t&&sf.base.Browser.isDevice&&this.preventHandler(),38===e.keyCode?(e.preventDefault(),this.dotNetRef.invokeMethodAsync("ServerAction","increment",e,this.element.value)):40===e.keyCode&&(e.preventDefault(),this.dotNetRef.invokeMethodAsync("ServerAction","decrement",e,this.element.value)))},i.prototype.keyPressHelper=function(e){return this.element.value.substring(0,this.element.selectionStart)+String.fromCharCode(e.which)+this.element.value.substring(this.element.selectionEnd)},i.prototype.numericRegex=function(){var t=this.options.decimalSeparator,i="*";return"."===t&&(t="\\"+t),0===this.options.decimals&&this.options.validateDecimalOnType?e:(this.options.decimals&&this.options.validateDecimalOnType&&(i="{0,"+this.options.decimals+"}"),new RegExp("^(-)?(((\\d+("+t+"\\d"+i+")?)|("+t+"\\d"+i+")))?$"))},i.prototype.mouseWheel=function(e){var t;e.preventDefault();var i=e;i.wheelDelta?t=i.wheelDelta/120:i.detail&&(t=-i.detail/3),t>0?this.dotNetRef.invokeMethodAsync("ServerAction","increment",e,this.element.value):t<0&&this.dotNetRef.invokeMethodAsync("ServerAction","decrement",e,this.element.value)},i.prototype.focusHandler=function(e){this.isFocused=!0,this.options.enabled&&!this.options.readonly&&(sf.base.Browser.isDevice||sf.base.EventHandler.add(this.element,"mousewheel DOMMouseScroll",this.mouseWheel,this))},i.prototype.focusOutHandler=function(e){this.isFocused=!1,e.preventDefault(),sf.base.Browser.isDevice||sf.base.EventHandler.remove(this.element,"mousewheel DOMMouseScroll",this.mouseWheel)},i.prototype.mouseDownOnSpinner=function(e){var t=this;if(this.options.enabled&&!this.options.readonly){this.isFocused&&(this.isPrevFocused=!0,e.cancelable&&e.preventDefault());var i=e.currentTarget,r=i.classList.contains("e-spin-up")?"increment":"decrement";sf.base.EventHandler.add(i,"mouseleave",this.mouseUpClick,this),this.timeOut=setInterval((function(){t.isCalled=!0,t.dotNetRef.invokeMethodAsync("ServerAction",r,e,t.element.value)}),150),sf.base.EventHandler.add(document,"mouseup",this.mouseUpClick,this)}},i.prototype.mouseUpOnSpinner=function(e){if(this.options.enabled&&!this.options.readonly){if(this.isPrevFocused&&(this.element.focus(),!sf.base.Browser.isDevice&&e.cancelable&&(this.isPrevFocused=!1)),sf.base.Browser.isDevice||e.preventDefault(),!this.getElementData(e))return;var t=e.currentTarget,i=t.classList.contains("e-spin-up")?"increment":"decrement";sf.base.EventHandler.remove(t,"mouseleave",this.mouseUpClick),this.isCalled||this.dotNetRef.invokeMethodAsync("ServerAction",i,e,this.element.value),this.isCalled=!1,sf.base.EventHandler.remove(document,"mouseup",this.mouseUpClick)}},i.prototype.touchMoveOnSpinner=function(e){!this.options.enabled||this.options.readonly?document.elementFromPoint(e.clientX,e.clientY).classList.contains("e-input-group-icon")||clearInterval(this.timeOut):clearInterval(this.timeOut)},i.prototype.scrollHandler=function(e){clearInterval(this.timeOut)},i.prototype.getElementData=function(e){return!(e.which&&3===e.which||e.button&&2===e.button||!this.options.enabled||this.options.readonly)&&(clearInterval(this.timeOut),!0)},i.prototype.mouseUpClick=function(e){e.stopPropagation(),clearInterval(this.timeOut),this.isCalled=!1,sf.base.EventHandler.remove(this.spinUp,"mouseleave",this.mouseUpClick),sf.base.EventHandler.remove(this.spinDown,"mouseleave",this.mouseUpClick)},i.prototype.selectRange=function(e){var i=this;if(clearTimeout(t),sf.base.Browser.isDevice||"11.0"!==sf.base.Browser.info.version){var r=sf.base.Browser.isDevice&&sf.base.Browser.isIos?600:90;t=setTimeout((function(){i.element.setSelectionRange(0,e.length)}),r)}else this.element.setSelectionRange(0,e.length)},i.prototype.isDevice=function(){return sf.base.Browser.isDevice},i.prototype.spinButtonEvents=function(){this.spinDown=this.wrapperElement?this.wrapperElement.querySelector(".e-spin-down"):null,this.spinUp=this.wrapperElement?this.wrapperElement.querySelector(".e-spin-up"):null,this.spinDown&&this.spinUp&&(this.unBindSpinButton(),this.bindSpinButton())},i.prototype.bindSpinButton=function(){sf.base.EventHandler.add(this.spinUp,sf.base.Browser.touchStartEvent,this.mouseDownOnSpinner,this),sf.base.EventHandler.add(this.spinDown,sf.base.Browser.touchStartEvent,this.mouseDownOnSpinner,this),sf.base.EventHandler.add(this.spinUp,sf.base.Browser.touchEndEvent,this.mouseUpOnSpinner,this),sf.base.EventHandler.add(this.spinDown,sf.base.Browser.touchEndEvent,this.mouseUpOnSpinner,this),sf.base.EventHandler.add(this.spinUp,sf.base.Browser.touchMoveEvent,this.touchMoveOnSpinner,this),sf.base.EventHandler.add(this.spinDown,sf.base.Browser.touchMoveEvent,this.touchMoveOnSpinner,this)},i.prototype.unBindSpinButton=function(){sf.base.EventHandler.remove(this.spinUp,sf.base.Browser.touchStartEvent,this.mouseDownOnSpinner),sf.base.EventHandler.remove(this.spinDown,sf.base.Browser.touchStartEvent,this.mouseDownOnSpinner),sf.base.EventHandler.remove(this.spinUp,sf.base.Browser.touchEndEvent,this.mouseUpOnSpinner),sf.base.EventHandler.remove(this.spinDown,sf.base.Browser.touchEndEvent,this.mouseUpOnSpinner),sf.base.EventHandler.remove(this.spinUp,sf.base.Browser.touchMoveEvent,this.touchMoveOnSpinner),sf.base.EventHandler.remove(this.spinDown,sf.base.Browser.touchMoveEvent,this.touchMoveOnSpinner)},i.prototype.destroy=function(){sf.base.EventHandler.remove(this.element,"focus",this.focusHandler),sf.base.EventHandler.remove(this.element,"blur",this.focusOutHandler),sf.base.EventHandler.remove(this.element,"keypress",this.keyPressHandler),sf.base.EventHandler.remove(this.element,"keydown",this.keyDownHandler),sf.base.EventHandler.remove(this.element,"paste",this.pasteHandler),sf.base.Browser.isDevice&&sf.base.EventHandler.remove(document,"scroll",this.scrollHandler)},i}();return{initialize:function(e,t,r,n,o){r&&e&&new i(e,t,r,n,o).initialize()},selectRange:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||i.selectRange(t)},propertyChanges:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||(i.options=t)},focusIn:function(e){var t=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(t)||t.element.focus()},focusOut:function(e){var t=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(t)||t.element.blur()},spinButtonEvents:function(e){var t=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(t)||t.spinButtonEvents()},clearInvalid:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||i.clearInvalid(t)},destroy:function(e){var t=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(t)||t.destroy()}}}()},"./modules/sf-spinner.js":function(e,t){window.sfBlazor=window.sfBlazor||{},window.sfBlazor.Spinner=function(){"use strict";var e=function(){function e(e){this.element=e,this.element.blazor__instance=this}return e.prototype.initialize=function(e){return window.getComputedStyle(e,":after").getPropertyValue("content").replace(/['"]+/g,"")},e}();return{initialize:function(t){return sf.base.isNullOrUndefined(t)?null:(new e(t),sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t.blazor__instance)?null:t.blazor__instance.initialize(t))}}}()},"./modules/sf-tab.js":function(e,t){window.sfBlazor=window.sfBlazor||{},window.sfBlazor.Tab=function(){"use strict";var e="e-tab-header",t="e-tab-wrap",i="e-toolbar-items",r="e-toolbar-item",n="e-toolbar-popup",o=function(){function o(e,t,i,r){this.show={},this.hide={},this.draggableItems=[{}],this.resizeContext=this.refreshActElePosition.bind(this),window.sfBlazor=window.sfBlazor,this.keyConfigs={tab:"tab",home:"home",end:"end",enter:"enter",space:"space",delete:"delete",moveLeft:"leftarrow",moveRight:"rightarrow",moveUp:"uparrow",moveDown:"downarrow"},this.element=t,this.dotNetRef=r,this.options=i,this.dataId=e,window.sfBlazor.setCompInstance(this)}return o.prototype.render=function(){var e=sf.base.closest(this.element,".e-content");this.prevIndex=0,this.isNested=!1,this.isPopup=!1,this.initRender=!0,this.isSwipeed=!1,sf.base.isNullOrUndefined(e)||(e.parentElement.classList.add("e-nested"),this.isNested=!0);var t=sf.base.Browser.info.name,i="msie"===t?"e-ie":"edge"===t?"e-edge":"safari"===t?"e-safari":"";sf.base.setStyleAttribute(this.element,{width:sf.base.formatUnit(this.options.width),height:sf.base.formatUnit(this.options.height)}),sf.base.attributes(this.element,{"aria-disabled":"false"}),this.setCssClass(this.element,i,!0),this.updatePopAnimationConfig(),this.tabId=this.element.id.length>0?"-"+this.element.id:sf.base.getRandomId(),this.wireEvents(),this.initRender=!1},o.prototype.serverItemsChanged=function(){if(this.enableAnimation=!1,this.setActive(this.options.selectedItem),"Dynamic"!==this.options.loadOn&&!sf.base.isNullOrUndefined(this.cntEle)){var e=[].slice.call(this.cntEle.children),t="e-content"+this.tabId+"_"+this.options.selectedItem;e.forEach((function(e){e.classList.contains("e-active")&&e.id!==t&&e.classList.remove("e-active"),e.id===t&&e.classList.add("e-active")})),this.prevIndex=this.options.selectedItem,this.triggerAnimation("e-item"+this.tabId+"_"+this.options.selectedItem,!1)}"Disable"!==sf.base.animationMode&&(this.enableAnimation=!0)},o.prototype.headerReady=function(){if(this.initRender=!0,this.hdrEle=this.getTabHeader(),this.setOrientation(this.options.headerPlacement,this.hdrEle),this.tbItems=sf.base.select("."+e+" ."+i,this.element),sf.base.isNullOrUndefined(this.tbItems)||sf.base.rippleEffect(this.tbItems,{selector:".e-tab-wrap"}),sf.base.selectAll("."+r,this.element).length>0){this.bdrLine=sf.base.select(".e-indicator.e-ignore",this.element);var t=sf.base.select("."+this.scrCntClass,this.tbItems);sf.base.isNullOrUndefined(t)?this.tbItems.insertBefore(this.bdrLine,this.tbItems.firstElementChild):t.insertBefore(this.bdrLine,t.firstElementChild),this.select(this.options.selectedItem)}if(this.cntEle=sf.base.select(".e-tab > .e-content",this.element),sf.base.isNullOrUndefined(this.cntEle)||(this.touchModule=new sf.base.Touch(this.cntEle,{swipe:this.swipeHandler.bind(this)}),"auto"===this.options.height||this.isVertical()||(this.cntEle.style.height="calc(100% - "+this.hdrEle.offsetHeight+"px)")),"Demand"===this.options.loadOn){var n=this.setActiveContent();this.triggerAnimation(n,!1)}this.initRender=!1},o.prototype.setActiveContent=function(){var e="e-item"+this.tabId+"_"+this.options.selectedItem,t=this.getTrgContent(this.cntEle,this.extIndex(e));return sf.base.isNullOrUndefined(t)||t.classList.add("e-active"),e},o.prototype.removeActiveClass=function(){var e=this.getTabHeader();if(e){var t=sf.base.selectAll("."+r+".e-active",e);sf.base.removeClass(t,"e-active"),[].slice.call(t).forEach((function(e){return e.firstElementChild.setAttribute("aria-selected","false")}))}},o.prototype.checkPopupOverflow=function(e){this.tbPop=sf.base.select(".e-toolbar-pop",this.element);var t=sf.base.select(".e-hor-nav",this.element),r=sf.base.select("."+i,this.element),o=r.lastChild;return(!this.isVertical()&&(this.options.enableRtl&&t.offsetLeft+t.offsetWidth>r.offsetLeft||!this.options.enableRtl&&t.offsetLeft<r.offsetWidth)||this.isVertical()&&t.offsetTop<o.offsetTop+o.offsetHeight)&&(e.classList.add(n),this.tbPop.insertBefore(e,sf.base.selectAll("."+n,this.tbPop)[0])),!0},o.prototype.popupHandler=function(e){var o=e.querySelector(".e-ripple-element");sf.base.isNullOrUndefined(o)||(o.outerHTML="",e.querySelector("."+t).classList.remove("e-ripple")),this.tbItem=sf.base.selectAll("."+i+" ."+r,this.hdrEle);var s=this.tbItem[this.tbItem.length-1];if(0!==this.tbItem.length){if(e.classList.remove(n),e.removeAttribute("style"),this.tbItems.appendChild(e),this.checkPopupOverflow(s)){var a=this.tbItems.lastChild.previousElementSibling;this.checkPopupOverflow(a)}this.isPopup=!0}return sf.base.selectAll("."+r,this.tbItems).length-1},o.prototype.previousContentAnimation=function(e,t){return this.isPopup||e<=t?"SlideLeftIn"===this.options.animation.previous.effect?{name:"SlideLeftOut",duration:this.options.animation.previous.duration,timingFunction:this.options.animation.previous.easing}:null:"SlideRightIn"===this.options.animation.next.effect?{name:"SlideRightOut",duration:this.options.animation.next.duration,timingFunction:this.options.animation.next.easing}:null},o.prototype.triggerPreviousAnimation=function(e,t){var i=this.previousContentAnimation(t,this.options.selectedItem);sf.base.isNullOrUndefined(i)?e.classList.remove("e-active"):(i.begin=function(){sf.base.setStyleAttribute(e,{position:"absolute"}),sf.base.addClass([e],["e-progress","e-view"])},i.end=function(){e.style.display="none",sf.base.removeClass([e],["e-active","e-progress","e-view"]),sf.base.setStyleAttribute(e,{display:"",position:""}),0===e.childNodes.length&&sf.base.detach(e)},new sf.base.Animation(i).animate(e))},o.prototype.triggerAnimation=function(e,t){var i,r,n=this,o=this.prevIndex;if("Dynamic"!==this.options.loadOn){[].slice.call(this.element.querySelector(".e-content").children).forEach((function(e){e.id===n.prevActiveEle&&(i=e)}));var s=this.tbItem[o];if(r=this.getTrgContent(this.cntEle,this.extIndex(e)),sf.base.isNullOrUndefined(i)&&!sf.base.isNullOrUndefined(s)){var a=this.extIndex(s.id);i=this.getTrgContent(this.cntEle,a)}}else r=this.cntEle.firstElementChild;if(sf.base.isNullOrUndefined(r)||(this.prevActiveEle=r.id),this.initRender||!1===t||this.options.animation==={}||sf.base.isNullOrUndefined(this.options.animation))i&&i!==r&&i.classList.remove("e-active");else{var l,h=sf.base.select(".e-content",this.element);if(this.prevIndex>this.options.selectedItem&&!this.isPopup){var d="None"===this.options.animation.previous.effect&&"Enable"===sf.base.animationMode?"SlideLeftIn":this.options.animation.previous.effect;l={name:"None"===d?"":"SlideLeftIn"!==d?d:"SlideLeftIn",duration:this.options.animation.previous.duration,timingFunction:this.options.animation.previous.easing}}else if(this.isPopup||this.prevIndex<this.options.selectedItem||this.prevIndex===this.options.selectedItem){var c="None"===this.options.animation.next.effect&&"Enable"===sf.base.animationMode?"SlideRightIn":this.options.animation.next.effect;l={name:"None"===c?"":"SlideRightIn"!==c?c:"SlideRightIn",duration:this.options.animation.next.duration,timingFunction:this.options.animation.next.easing}}l.progress=function(){h.classList.add("e-progress"),n.setActiveBorder()},l.end=function(){h.classList.remove("e-progress"),r.classList.add("e-active")},this.initRender||sf.base.isNullOrUndefined(i)||this.triggerPreviousAnimation(i,o),this.isPopup=!1,""===l.name?r.classList.add("e-active"):new sf.base.Animation(l).animate(r)}},o.prototype.keyPressed=function(t){var i=sf.base.closest(t,"."+e+" ."+r),n=this.getEleIndex(i);!sf.base.isNullOrUndefined(this.popEle)&&t.classList.contains("e-hor-nav")?this.popEle.classList.contains("e-popup-open")?this.popObj.hide(this.hide):this.popObj.show(this.show):t.classList.contains("e-scroll-nav")?t.click():sf.base.isNullOrUndefined(i)||!1!==i.classList.contains("e-active")||(this.select(n,!0),sf.base.isNullOrUndefined(this.popEle)||this.popObj.hide(this.hide))},o.prototype.getTabHeader=function(){var t=[].slice.call(this.element.children).filter((function(t){return t.classList.contains(e)}));if(t.length>0)return t[0];var i=[].slice.call(this.element.children).filter((function(e){return!e.classList.contains("blazor-template")}))[0];return i?[].slice.call(i.children).filter((function(t){return t.classList.contains(e)}))[0]:void 0},o.prototype.getEleIndex=function(e){return Array.prototype.indexOf.call(sf.base.selectAll("."+r,this.getTabHeader()),e)},o.prototype.extIndex=function(e){return e.replace("e-item"+this.tabId+"_","")},o.prototype.getTrgContent=function(e,t){return this.element.classList.contains("e-nested")?sf.base.select(".e-nested> .e-content > #e-content"+this.tabId+"_"+t,this.element):this.findEle(e.children,"e-content"+this.tabId+"_"+t)},o.prototype.findEle=function(e,t){for(var i,r=0;r<e.length;r++)if(e[r].id===t){i=e[r];break}return i},o.prototype.isVertical=function(){var e="Left"===this.options.headerPlacement||"Right"===this.options.headerPlacement;return this.scrCntClass=e?"e-vscroll-content":"e-hscroll-content",e},o.prototype.updatePopAnimationConfig=function(){this.show={name:this.isVertical()?"FadeIn":"SlideDown",duration:100},this.hide={name:this.isVertical()?"FadeOut":"SlideUp",duration:100}},o.prototype.focusItem=function(){var e=sf.base.select(" #e-item"+this.tabId+"_"+this.options.selectedItem,this.hdrEle);sf.base.isNullOrUndefined(e)||e.firstElementChild.focus()},o.prototype.serverChangeOrientation=function(e,t,i,r){if(this.setOrientation(e,this.hdrEle),sf.base.removeClass([this.element],["e-vertical-tab","e-vertical-left","e-vertical-right","e-horizontal-bottom"]),r&&this.changeToolbarOrientation(t,i),"Bottom"===this.options.headerPlacement&&sf.base.addClass([this.element],"e-horizontal-bottom"),this.isVertical()){var n="Left"===this.options.headerPlacement?"e-vertical-left":"e-vertical-right";this.element.classList.contains("e-nested")?sf.base.addClass([this.hdrEle],["e-vertical-tab",n]):sf.base.addClass([this.element],["e-vertical-tab",n])}this.setActiveBorder(),this.focusItem()},o.prototype.changeToolbarOrientation=function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(i.options.width=t?"auto":"100%",i.options.height=t?"100%":"auto",i.options.isVertical=t,i.changeOrientation()),this.updatePopAnimationConfig()},o.prototype.setOrientation=function(e,t){var i=Array.prototype.indexOf.call(this.element.children,t),r=Array.prototype.indexOf.call(this.element.children,this.element.querySelector(".e-content"));"Bottom"===e&&r>i?this.element.appendChild(t):(sf.base.removeClass([t],["e-horizontal-bottom"]),this.element.insertBefore(t,sf.base.select(".e-content",this.element)))},o.prototype.setCssClass=function(e,t,i){""!==t&&(i?sf.base.addClass([e],t.split(" ")):sf.base.removeClass([e],t.split(" ")))},o.prototype.setActiveBorder=function(){var e=this.getTabHeader(),t=sf.base.select("."+r+".e-active",e);if(!sf.base.isNullOrUndefined(t)){this.options.reorderActiveTab?e.classList.remove("e-reorder-active-item"):(t.classList.contains(n)&&!this.bdrLine.classList.contains("e-hidden")&&this.bdrLine.classList.add("e-hidden"),e.classList.contains("e-reorder-active-item")||e.classList.add("e-reorder-active-item")),t.classList.contains(n)&&this.options.reorderActiveTab&&this.popupHandler(t);var o=sf.base.closest(t,".e-tab");if(this.element===o){this.tbItems=sf.base.select("."+i,e);var s=sf.base.select(".e-indicator",e),a=sf.base.select("."+i+" ."+this.scrCntClass,e);if(this.isVertical()){sf.base.setStyleAttribute(s,{left:"",right:""}),0!==(sf.base.isNullOrUndefined(a)?this.tbItems.offsetHeight:a.offsetHeight)?sf.base.setStyleAttribute(s,{top:t.offsetTop+"px",height:t.offsetHeight+"px"}):sf.base.setStyleAttribute(s,{top:0,height:0})}else{if("MultiRow"===this.options.overflowMode){var l="Bottom"===this.options.headerPlacement?t.offsetTop:t.offsetHeight+t.offsetTop;sf.base.setStyleAttribute(s,{top:l+"px",height:""})}else sf.base.setStyleAttribute(s,{top:"",height:""});var h=sf.base.isNullOrUndefined(a)?this.tbItems.offsetWidth:a.offsetWidth;0!==h?sf.base.setStyleAttribute(s,{left:t.offsetLeft+"px",right:h-(t.offsetLeft+t.offsetWidth)+"px"}):sf.base.setStyleAttribute(s,{left:"auto",right:"auto"})}sf.base.isNullOrUndefined(this.bdrLine)||t.classList.contains(n)||this.bdrLine.classList.remove("e-hidden")}}},o.prototype.setActive=function(e){this.tbItem=sf.base.selectAll("."+r,this.getTabHeader()),sf.base.isNullOrUndefined(this.hdrEle)&&(this.hdrEle=this.getTabHeader());var t=this.hdrEle.querySelector("."+r+'[data-index="'+e+'"]');if(!(!t||e<0||isNaN(e)||0===this.tbItem.length))if(this.options.selectedItem=e,t.classList.contains("e-active"))this.setActiveBorder();else{var i=this.tbItem[this.prevIndex];sf.base.isNullOrUndefined(i)||i.firstElementChild.removeAttribute("aria-controls"),sf.base.attributes(t.firstElementChild,{"aria-controls":"e-content"+this.tabId+"_"+e});var n=t.id;this.removeActiveClass(),t.classList.add("e-active"),t.firstElementChild.setAttribute("aria-selected","true");var o=Number(this.extIndex(n));if(sf.base.isNullOrUndefined(this.prevActiveEle)&&(this.prevActiveEle="e-content"+this.tabId+"_"+o),"Init"===this.options.loadOn){this.cntEle=sf.base.select(".e-tab > .e-content",this.element);var s=this.getTrgContent(this.cntEle,this.extIndex(n));sf.base.isNullOrUndefined(s)||s.classList.add("e-active"),this.triggerAnimation(n,this.enableAnimation)}this.setActiveBorder(),this.refreshItemVisibility(t),this.initRender||t.firstElementChild.focus()}},o.prototype.contentReady=function(){var e=this.setActiveContent();this.triggerAnimation(e,this.enableAnimation)},o.prototype.setRTL=function(e){this.setCssClass(this.element,"e-rtl",e),this.refreshActiveBorder()},o.prototype.refreshActiveBorder=function(){sf.base.isNullOrUndefined(this.bdrLine)||this.bdrLine.classList.add("e-hidden"),this.setActiveBorder()},o.prototype.setDragAndDrop=function(e){e?this.bindDraggable():this.draggableItems&&this.draggableItems.forEach((function(e){e&&0!==Object.keys(e).length&&e.destroy()}))},o.prototype.showPopup=function(e){var t=sf.base.select(".e-popup.e-toolbar-pop",this.hdrEle);if(t&&t.classList.contains("e-popup-close")){var i=t&&t.ej2_instances[0];i.position.X="Left"===this.options.headerPlacement?"left":"right",i.dataBind(),i.show(e)}},o.prototype.initializeDrag=function(i){var n=this;this.options.dragArea=sf.base.isNullOrUndefined(this.options.dragArea)?"#"+this.element.id+" ."+e:this.options.dragArea;var o=new sf.base.Draggable(i,{dragArea:this.options.dragArea,dragTarget:"."+r,clone:!0,distance:5,helper:this.helper.bind(this),dragStart:this.itemDragStart.bind(this),drag:function(i){var o,s=n.getEleIndex(n.dragItem);if(sf.base.isNullOrUndefined(i.target.closest(".e-tab"))||i.target.closest(".e-tab").isEqualNode(n.element)||n.options.dragArea==="."+e){if(i.target.closest(n.options.dragArea)||"Popup"===n.options.overflowMode?(document.body.style.cursor="",n.dragItem.querySelector("."+t).style.visibility="hidden",n.cloneElement.classList.contains("e-hidden")&&sf.base.removeClass([n.cloneElement],"e-hidden")):(document.body.style.cursor="not-allowed",sf.base.addClass([n.cloneElement],"e-hidden"),n.dragItem.classList.contains("e-hidden")&&sf.base.removeClass([n.dragItem],"e-hidden"),n.dragItem.querySelector("."+t).style.visibility="visible"),"Scrollable"===n.options.overflowMode&&!sf.base.isNullOrUndefined(n.element.querySelector(".e-hscroll"))){var a=n.element.querySelector(".e-scroll-right-nav"),l=n.element.querySelector(".e-scroll-left-nav"),h=n.element.querySelector(".e-hscroll-bar");!sf.base.isNullOrUndefined(a)&&Math.abs(a.offsetWidth/2+a.offsetLeft)>n.cloneElement.offsetLeft+n.cloneElement.offsetWidth&&(h.scrollLeft-=10),!sf.base.isNullOrUndefined(l)&&Math.abs(l.offsetLeft+l.offsetWidth-n.cloneElement.offsetLeft)>l.offsetWidth/2&&(h.scrollLeft+=10)}n.cloneElement.style.pointerEvents="none";var d=n.cloneElement.getBoundingClientRect().left,c=n.cloneElement.getBoundingClientRect().top,p=document.elementFromPoint(d,c),u=sf.base.closest(p,"."+e+" ."+r),g=0;"Scrollable"!==n.options.overflowMode||sf.base.isNullOrUndefined(n.element.querySelector(".e-hscroll"))||(g=n.element.querySelector(".e-hscroll-content").offsetWidth),null!=u&&!u.isSameNode(n.dragItem)&&u.closest(".e-tab").isSameNode(n.dragItem.closest(".e-tab"))&&((o=n.getEleIndex(u))<s&&Math.abs(u.offsetLeft+u.offsetWidth-n.cloneElement.offsetLeft)>u.offsetWidth/2&&n.dragAction(u,s,o),o>s&&Math.abs(u.offsetWidth/2)+u.offsetLeft-g<n.cloneElement.offsetLeft+n.cloneElement.offsetWidth&&n.dragAction(u,s,o)),n.droppedIndex=n.getEleIndex(n.dragItem)}},dragStop:this.itemDragStop.bind(this)});this.draggableItems.push(o)},o.prototype.helper=function(e){return e.element&&(this.cloneElement=e.element.cloneNode(!0),sf.base.addClass([this.cloneElement],["e-tab-clone-element","e-tab"]),sf.base.removeClass([this.cloneElement.querySelector("."+t)],"e-ripple"),sf.base.isNullOrUndefined(this.cloneElement.querySelector(".e-ripple-element"))||sf.base.remove(this.cloneElement.querySelector(".e-ripple-element")),document.body.appendChild(this.cloneElement)),this.cloneElement},o.prototype.itemDragStart=function(e){var i=this;this.dragItem=e.element,this.dragStartIndex=this.getEleIndex(this.dragItem);this.element.querySelector(".e-toolbar");this.dotNetRef.invokeMethodAsync("OnDragStart",this.dragStartIndex).then((function(r){r?sf.base.detach(i.cloneElement):(i.removeActiveClass(),sf.base.addClass([i.tbItems.querySelector(".e-indicator")],"e-hidden"),i.dragItem.querySelector("."+t).style.visibility="hidden",e.bindEvents(sf.base.getElement(e.dragElement)))}))},o.prototype.dragAction=function(e,t,i){if("MultiRow"===this.options.overflowMode&&e.parentNode.insertBefore(this.dragItem,e.nextElementSibling),t>i)if(this.dragItem.parentElement.isSameNode(e.parentElement))this.dragItem.parentNode.insertBefore(this.dragItem,e);else if("Extended"===this.options.overflowMode)if(e.isSameNode(e.parentElement.lastChild)){var r=this.dragItem.parentNode;e.parentNode.insertBefore(this.dragItem,e),r.insertBefore(e.parentElement.lastChild,r.childNodes[0])}else this.dragItem.parentNode.insertBefore(e.parentElement.lastChild,this.dragItem.parentElement.childNodes[0]),e.parentNode.insertBefore(this.dragItem,e);else{var n=e.parentElement.lastChild;if(e.isSameNode(n)){r=this.dragItem.parentNode;e.parentNode.insertBefore(this.dragItem,e),r.insertBefore(n,r.childNodes[0])}else this.dragItem.parentNode.insertBefore(e.parentElement.lastChild,this.dragItem.parentElement.childNodes[0]),e.parentNode.insertBefore(this.dragItem,e)}t<i&&(this.dragItem.parentElement.isSameNode(e.parentElement)?this.dragItem.parentNode.insertBefore(e,this.dragItem):"Extended"===this.options.overflowMode?(this.dragItem.parentElement.appendChild(e.parentElement.firstElementChild),e.parentNode.insertBefore(this.dragItem,e.nextSibling)):(this.dragItem.parentNode.insertBefore(e.parentElement.lastChild,this.dragItem.parentElement.childNodes[0]),e.parentNode.insertBefore(this.dragItem,e)))},o.prototype.itemDragStop=function(e){sf.base.detach(this.cloneElement);var i=this.element.querySelector(".e-toolbar");this.dragItem.querySelector("."+t).style.visibility="visible",sf.base.addClass([i],"e-drag-action"),document.body.style.cursor="";var r=this.getXYValue(e.event,"X"),n=this.getXYValue(e.event,"Y");this.dotNetRef.invokeMethodAsync("Dragged",this.droppedIndex,this.dragStartIndex,r,n)},o.prototype.getXYValue=function(e,t){var i,r=e.changedTouches;return i="X"===t?r?r[0].clientX:e.clientX:r?r[0].clientY:e.clientY,Math.ceil(i)},o.prototype.bindDraggable=function(){var t=this;this.options.allowDragAndDrop&&this.element.querySelectorAll("."+e+" ."+r).forEach((function(i){sf.base.isNullOrUndefined(t.options.dragArea)&&(t.options.dragArea="#"+t.element.id+" ."+e),i.classList.contains("e-draggable")||t.initializeDrag(i)}))},o.prototype.wireEvents=function(){this.bindDraggable(),window.addEventListener("resize",this.resizeContext),sf.base.EventHandler.add(this.element,"keydown",this.spaceKeyDown,this),sf.base.isNullOrUndefined(this.cntEle)||(this.touchModule=new sf.base.Touch(this.cntEle,{swipe:this.swipeHandler.bind(this)})),this.keyModule=new sf.base.KeyboardEvents(this.element,{keyAction:this.keyHandler.bind(this),keyConfigs:this.keyConfigs}),this.tabKeyModule=new sf.base.KeyboardEvents(this.element,{keyAction:this.keyHandler.bind(this),keyConfigs:{openPopup:"shift+f10",tab:"tab",shiftTab:"shift+tab"},eventName:"keydown"})},o.prototype.unWireEvents=function(){this.keyModule.destroy(),this.tabKeyModule.destroy(),sf.base.isNullOrUndefined(this.cntEle)||this.touchModule.destroy(),window.removeEventListener("resize",this.resizeContext),sf.base.EventHandler.remove(this.element,"keydown",this.spaceKeyDown),sf.base.removeClass([this.element],["e-rtl","e-focused"])},o.prototype.swipeHandler=function(e){if(!(e.velocity<3&&sf.base.isNullOrUndefined(e.originalEvent.changedTouches))){this.isNested&&this.element.setAttribute("data-swipe","true");var t=this.element.querySelector('[data-swipe="true"]');if(t)t.removeAttribute("data-swipe");else{if(this.isSwipeed=!0,"Right"===e.swipeDirection&&0!==this.options.selectedItem){for(var i=this.options.selectedItem-1;i>=0;i--)if(!this.tbItem[i].classList.contains("e-hidden")&&!this.tbItem[i].classList.contains("e-disable")){this.select(i,!0);break}}else if("Left"===e.swipeDirection&&this.options.selectedItem!==sf.base.selectAll("."+r,this.element).length-1)for(var n=this.options.selectedItem+1;n<this.tbItem.length;n++)if(!this.tbItem[n].classList.contains("e-hidden")&&!this.tbItem[n].classList.contains("e-disable")){this.select(n,!0);break}this.isSwipeed=!1}}},o.prototype.spaceKeyDown=function(t){if(32===t.keyCode&&32===t.which||35===t.keyCode&&35===t.which){var i=sf.base.closest(t.target,"."+e);sf.base.isNullOrUndefined(i)||t.preventDefault()}},o.prototype.keyHandler=function(e){if(!this.element.classList.contains("e-disable")){this.element.classList.add("e-focused");var i,n,o=e.target,s=this.getTabHeader(),a=sf.base.select(".e-active",s);switch(this.popEle=sf.base.select(".e-toolbar-pop",s),sf.base.isNullOrUndefined(this.popEle)||(this.popObj=this.popEle.ej2_instances[0]),e.action){case"space":case"enter":if(o.parentElement.classList.contains("e-disable"))return;if("enter"===e.action&&o.classList.contains("e-hor-nav")){this.showPopup(this.show);break}this.keyPressed(o);break;case"tab":case"shiftTab":o.classList.contains(t)&&!1===sf.base.closest(o,"."+r).classList.contains("e-active")&&o.setAttribute("tabindex",o.getAttribute("data-tabindex")),this.popObj&&sf.base.isVisible(this.popObj.element)&&this.popObj.hide(this.hide),sf.base.isNullOrUndefined(a)||"-1"!==a.children.item(0).getAttribute("tabindex")||a.children.item(0).setAttribute("tabindex","0");break;case"moveLeft":case"moveRight":i=sf.base.closest(document.activeElement,"."+r),sf.base.isNullOrUndefined(i)||this.refreshItemVisibility(i);break;case"openPopup":e.preventDefault(),!sf.base.isNullOrUndefined(this.popEle)&&this.popEle.classList.contains("e-popup-close")&&this.popObj.show(this.show);break;case"delete":if(n=sf.base.closest(o,"."+r),!0===this.options.showCloseButton&&!sf.base.isNullOrUndefined(n)){if(-1===this.getEleIndex(n))return;var l=n.nextSibling;!sf.base.isNullOrUndefined(l)&&l.classList.contains(r)&&l.firstElementChild.focus(),this.dotNetRef.invokeMethodAsync("RemoveTab",parseInt(n.getAttribute("data-index"),10))}this.setActiveBorder()}}},o.prototype.refreshActElePosition=function(){var e=sf.base.select("."+r+"."+n+".e-active",this.element);!sf.base.isNullOrUndefined(e)&&this.options.reorderActiveTab&&this.select(this.getEleIndex(e)),this.refreshActiveBorder()},o.prototype.refreshItemVisibility=function(e){var t=sf.base.select("."+this.scrCntClass,this.tbItems);if(!this.isVertical()&&!sf.base.isNullOrUndefined(t)){var i=sf.base.select(".e-hscroll-bar",this.tbItems),r=i.scrollLeft,n=r+i.offsetWidth,o=e.offsetLeft,s=e.offsetWidth,a=e.offsetLeft+e.offsetWidth;if(r<o&&n<a){var l=n-o;i.scrollLeft=r+(s-l)}else if(r>o&&n>a){l=a-r;i.scrollLeft=r-(s-l)}}},o.prototype.enableTab=function(e,t){var i=sf.base.selectAll("."+r,this.element)[e];sf.base.isNullOrUndefined(i)||(!0===t?(i.classList.remove("e-disable","e-overlay"),i.firstElementChild.setAttribute("tabindex",i.firstElementChild.getAttribute("data-tabindex"))):(i.classList.add("e-disable","e-overlay"),i.firstElementChild.removeAttribute("tabindex"),i.classList.contains("e-active")&&this.select(e+1)),i.setAttribute("aria-disabled",!0===t?"false":"true"))},o.prototype.hideTab=function(e,t){var i;void 0===t&&(t=!0);var n=sf.base.selectAll("."+r,this.element)[e];if(!sf.base.isNullOrUndefined(n)){if(this.bdrLine.classList.add("e-hidden"),t)if(n.classList.add("e-hidden"),0!==(i=sf.base.selectAll("."+r+":not(.e-hidden)",this.tbItems)).length&&n.classList.contains("e-active")){if(0!==e)for(var o=e-1;o>=0;o--){if(!this.tbItem[o].classList.contains("e-hidden")){this.select(o);break}if(0===o)for(var s=e+1;s<this.tbItem.length;s++)if(!this.tbItem[s].classList.contains("e-hidden")){this.select(s);break}}else for(s=e+1;s<this.tbItem.length;s++)if(!this.tbItem[s].classList.contains("e-hidden")){this.select(s);break}}else 0===i.length&&this.element.classList.add("e-hidden");else this.element.classList.remove("e-hidden"),i=sf.base.selectAll("."+r+":not(.e-hidden)",this.tbItems),n.classList.remove("e-hidden"),0===i.length&&this.select(e);this.setActiveBorder(),n.setAttribute("aria-hidden",""+t)}},o.prototype.select=function(e,t){void 0===t&&(t=!1);var n,o=this.getTabHeader();this.tbItems=sf.base.select("."+i,o),this.tbItem=sf.base.selectAll("."+r,o),this.prevItem=this.tbItem[this.prevIndex];var s=this.options.selectedItem;(sf.base.isNullOrUndefined(s)||s<0||this.tbItem.length<=s||isNaN(s))&&(this.options.selectedItem=0);var a=this.tbItem[e];if(sf.base.isNullOrUndefined(this.prevItem)||this.prevItem.classList.contains("e-disable")||this.prevItem.children.item(0).setAttribute("tabindex",this.prevItem.firstElementChild.getAttribute("tabindex")),this.initRender)this.selectingContent(e);else{a&&(n=parseInt(a.getAttribute("data-index"),10));var l={previousItem:null,previousIndex:this.prevIndex,selectedItem:null,selectedIndex:this.options.selectedItem,selectedContent:null,selectingItem:null,selectingIndex:n,selectingContent:null,isSwiped:this.isSwipeed,isInteracted:t,cancel:!1};this.dotNetRef.invokeMethodAsync("SelectingEvent",l,n)}},o.prototype.setPersistence=function(e,t){this.options.enablePersistence&&window.localStorage.setItem(e,t)},o.prototype.selectingContent=function(e){if(this.tbItem=sf.base.selectAll("."+r,this.hdrEle),this.tbItem.length>e&&e>=0&&!isNaN(e)){this.prevIndex=this.options.selectedItem;var t=this.hdrEle.querySelector("."+r+'[data-index="'+e+'"]');t&&t.classList.contains(n)&&this.options.reorderActiveTab&&this.popupHandler(t),this.setActive(e)}else this.setActive(0)},o.prototype.disable=function(e){this.setCssClass(this.element,"e-disable",e),this.element.setAttribute("aria-disabled",""+e)},o.prototype.headerItemsUpdate=function(e){var t=this.getTabHeader();this.tbItems=sf.base.select("."+i,t),this.tbItem=sf.base.selectAll("."+r,t),this.prevItem=this.tbItem[this.prevIndex],sf.base.isNullOrUndefined(this.prevItem)||this.prevItem.classList.contains("e-disable")||this.prevItem.children.item(0).setAttribute("tabindex",this.prevItem.firstElementChild.getAttribute("tabindex")),this.selectingContent(e)},o.prototype.destroy=function(){this.unWireEvents(),this.element.removeAttribute("aria-disabled")},o.prototype.getContentElement=function(e){return sf.base.select(".e-content #e-content"+this.tabId+"_"+e,this.element)},o}();return{initialize:function(e,t,i,r,n,s){if(t&&e){var a=new o(e,t,i,r);a.render(),n&&(a.headerReady(),s||a.isDestroyed||a.dotNetRef.invokeMethodAsync("CreatedEvent",null))}},headerReady:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(i.headerReady(),t||i.isDestroyed||i.dotNetRef.invokeMethodAsync("CreatedEvent",null))},contentReady:function(t,n){var o=window.sfBlazor.getCompInstance(t);if(!sf.base.isNullOrUndefined(o)&&!sf.base.isNullOrUndefined(o.element)){var s={isPopupElement:!1};o.element.classList.remove("e-focused"),o.isPopup=!1;var a=o.element.querySelector("."+e+" ."+r+'[data-index="'+n+'"]');sf.base.isNullOrUndefined(a)||(s.isPopupElement=!sf.base.isNullOrUndefined(sf.base.closest(a,".e-toolbar-pop")));var l=sf.base.selectAll("."+e+" ."+i+" ."+r,o.element);return s.toolbarItemIndex=l.length-1,o.headerItemsUpdate(n),o.setPersistence("tab"+o.element.id,n.toString()),"Init"!==o.options.loadOn&&o.contentReady(),JSON.stringify(s)}return null},selectingContent:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(i.selectingContent(t),i.setPersistence("tab"+i.element.id,t.toString()),"Init"!==i.options.loadOn&&i.contentReady())},serverItemsChanged:function(e,t,i,r){var n=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.element)||(n.options.selectedItem=t,n.options.animation=i,sf.base.isNullOrUndefined(n.element.querySelector(".e-toolbar"))||(sf.base.removeClass([n.element.querySelector(".e-toolbar")],"e-drag-action"),sf.base.removeClass([n.element.querySelector(".e-indicator")],"e-hidden")),r?sf.base.addClass([n.element],"e-vertical-icon"):sf.base.removeClass([n.element],"e-vertical-icon"),n.serverItemsChanged(),n.options.allowDragAndDrop&&n.bindDraggable())},enableTab:function(e,t,i){var r=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(r)||sf.base.isNullOrUndefined(r.element)||r.enableTab(t,i)},hideTab:function(e,t,i){var r=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(r)||sf.base.isNullOrUndefined(r.element)||r.hideTab(t,i)},select:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||i.select(t)},disable:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||i.disable(t)},setCssClass:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(""!==i.options.cssClass&&i.setCssClass(i.element,i.options.cssClass,!1),i.setCssClass(i.element,t,!0),i.options.cssClass=t)},showCloseButton:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(i.options.showCloseButton=t,i.refreshActElePosition())},headerPlacement:function(e,t,i,r,n,o,s){var a=window.sfBlazor.getCompInstance(e);if(!sf.base.isNullOrUndefined(a)&&!sf.base.isNullOrUndefined(a.element)){a.options.headerPlacement=t,a.options.selectedItem=i;var l=window.sfBlazor.getCompInstance(r);sf.base.isNullOrUndefined(l.element)||l.setCssClass(n),a.serverChangeOrientation(t,r,o,s)}},enableRtl:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(i.options.enableRtl=t,i.setRTL(t))},overflowMode:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(i.options.overflowMode=t,i.refreshActElePosition())},allowDragAndDrop:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(i.options.allowDragAndDrop=t,i.setDragAndDrop(t))},refresh:function(e){var t=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t.element)||t.refreshActiveBorder()},destroy:function(e,t,i){var r=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(r)||sf.base.isNullOrUndefined(r.element)||(r.isDestroyed=!0,r.setPersistence(t,i),r.destroy())},getTabItem:function(e,t){if(!sf.base.isNullOrUndefined(e)){var i=e.querySelector("."+r+'[data-index="'+t+'"]');if(i)return JSON.stringify(window.sfBlazor.getDomObject("tabitem",i))}return null},getTabContent:function(e,t){var i=window.sfBlazor.getCompInstance(e);if(!sf.base.isNullOrUndefined(i)&&!sf.base.isNullOrUndefined(i.Element)){var r=i.getContentElement(t);if(r)return JSON.stringify(window.sfBlazor.getDomObject("tabcontent",r))}return null}}}()},"./modules/sf-textbox.js":function(e,t){window.sfBlazor=window.sfBlazor||{},window.sfBlazor.TextBox=function(){"use strict";var e=function(){function e(e,t,i){this.element=e,this.container=i,this.element.blazor_input_instance=this,this.dotNetRef=t,this.isDestroyed=!1}return e.prototype.initialize=function(){sf.base.EventHandler.add(this.element,"blur",this.blurHandler,this);var e=this.container?this.container.querySelectorAll(".e-input-group-icon"):null;if(e&&e.length>0)for(var t=0;t<e.length;t++)sf.base.EventHandler.add(e[t],"mousedown",this.onMouseDownRipple,this),sf.base.EventHandler.add(e[t],"mouseup",this.onMouseUpRipple,this)},e.prototype.onMouseDownRipple=function(e){var t=e?e.currentTarget:null;!t||this.container.classList.contains("e-disabled")||this.container.querySelector("input").readOnly||t.classList.add("e-input-btn-ripple")},e.prototype.onMouseUpRipple=function(e){var t=e?e.currentTarget:null;t&&setTimeout((function(){t.classList.remove("e-input-btn-ripple")}),500)},e.prototype.blurHandler=function(){this.isDestroyed?sf.base.EventHandler.remove(this.element,"blur",this.blurHandler):this.dotNetRef.invokeMethodAsync("BlurHandler").catch((function(){}))},e.prototype.destroy=function(){sf.base.EventHandler.remove(this.element,"blur",this.blurHandler)},e}();return{initialize:function(t,i,r){t&&new e(t,i,r),t&&t.blazor_input_instance&&t.blazor_input_instance.initialize()},focusIn:function(e){e.focus()},focusOut:function(e){e.blur()},destroyInput:function(e){e&&e.blazor_input_instance&&(e.blazor_input_instance.isDestroyed=!0,e.blazor_input_instance.destroy())}}}()},"./modules/sf-toolbar.js":function(e,t){window.sfBlazor=window.sfBlazor||{},window.sfBlazor.Toolbar=function(){"use strict";var e="e-toolbar-items",t="e-blazor-toolbar-items",i="e-toolbar-item",r="e-toolbar-popup",n=function(){function n(e,t,i,r){this.resizeContext=this.resize.bind(this),window.sfBlazor=window.sfBlazor,this.keyConfigs={moveLeft:"leftarrow",moveRight:"rightarrow",moveUp:"uparrow",moveDown:"downarrow",popupOpen:"enter",popupClose:"escape",tab:"tab",home:"home",end:"end"},this.element=t,this.dotNetRef=r,this.options=i,this.dataId=e,window.sfBlazor.setCompInstance(this)}return n.prototype.destroy=function(){this.unwireEvents(),this.clearProperty(),this.popObj=null,this.tbarAlign=null},n.prototype.wireEvents=function(){sf.base.EventHandler.add(this.element,"click",this.clickHandler,this),window.addEventListener("resize",this.resizeContext),this.options.allowKeyboard&&this.wireKeyboardEvent()},n.prototype.wireKeyboardEvent=function(){this.keyModule=new sf.base.KeyboardEvents(this.element,{keyAction:this.keyActionHandler.bind(this),keyConfigs:this.keyConfigs}),sf.base.EventHandler.add(this.element,"keydown",this.docKeyDown,this),this.updateTabIndex("0")},n.prototype.updateTabIndex=function(e){var t=this.element.querySelector("."+i+":not(.e-overlay ):not(.e-separator ):not(.e-hidden )");if(!sf.base.isNullOrUndefined(t)&&!sf.base.isNullOrUndefined(t.firstElementChild)){var r=t.firstElementChild.getAttribute("data-tabindex");r&&"-1"===r&&"INPUT"!==t.firstElementChild.tagName&&t.firstElementChild.setAttribute("tabindex",e)}},n.prototype.unwireKeyboardEvent=function(){this.keyModule&&(sf.base.EventHandler.remove(this.element,"keydown",this.docKeyDown),this.keyModule.destroy(),this.keyModule=null)},n.prototype.docKeyDown=function(e){if("INPUT"!==e.target.tagName){var t=!sf.base.isNullOrUndefined(this.popObj)&&sf.base.isVisible(this.popObj.element)&&"Extended"!==this.options.overflowMode;9===e.keyCode&&!0===e.target.classList.contains("e-hor-nav")&&t&&this.popObj.hide({name:"FadeOut",duration:100}),(40===e.keyCode||38===e.keyCode||35===e.keyCode||36===e.keyCode)&&e.preventDefault()}},n.prototype.unwireEvents=function(){sf.base.EventHandler.remove(this.element,"click",this.clickHandler),this.destroyScroll(),this.unwireKeyboardEvent(),window.removeEventListener("resize",this.resizeContext),sf.base.EventHandler.remove(document,"scroll",this.docEvent),sf.base.EventHandler.remove(document,"click",this.docEvent)},n.prototype.clearProperty=function(){this.tbarEle=[],this.tbarAlgEle={lefts:[],centers:[],rights:[]}},n.prototype.docEvent=function(e){var t=sf.base.closest(e.target,".e-popup");this.popObj&&sf.base.isVisible(this.popObj.element)&&!t&&"Popup"===this.options.overflowMode&&this.popObj.hide({name:"FadeOut",duration:100})},n.prototype.destroyScroll=function(){this.scrollModule&&(this.tbarAlign&&sf.base.addClass([this.scrollModule.element],"e-tbar-pos"),this.scrollModule.destroy(),this.scrollModule=null)},n.prototype.destroyMode=function(){this.scrollModule&&(sf.base.removeClass([this.scrollModule.element],"e-rtl"),this.destroyScroll()),sf.base.removeClass([this.element],"e-tbar-extended"),sf.base.removeClass([this.element],"e-extended-toolbar");var e=this.element.querySelector(".e-toolbar-multirow");e&&sf.base.removeClass([e],"e-toolbar-multirow"),this.popObj&&this.popupRefresh(this.popObj.element,!0)},n.prototype.elementFocus=function(e){var t=e.firstElementChild;t?(t.focus(),this.activeEleSwitch(e)):e.focus()},n.prototype.clstElement=function(e,t){return e&&this.popObj&&sf.base.isVisible(this.popObj.element)?this.popObj.element.querySelector("."+i):this.element===t||e?this.element.querySelector("."+i+":not(.e-overlay ):not(.e-separator ):not(.e-hidden )"):sf.base.closest(t,"."+i)},n.prototype.keyHandling=function(t,r,n,o,s){var a,l,h,d=this.popObj,c=this.element,p={name:"FadeOut",duration:100};switch(r.action){case"moveRight":if(this.options.isVertical)return;c===n?this.elementFocus(t):o||this.eleFocus(t,"next");break;case"moveLeft":if(this.options.isVertical)return;o||this.eleFocus(t,"previous");break;case"home":case"end":if(t){var u=sf.base.closest(t,".e-popup"),g=this.element.querySelector(".e-toolbar-extended");"Extended"===this.options.overflowMode&&g&&g.classList.contains("e-popup-open")&&(u="end"===r.action?g:null),u?sf.base.isVisible(this.popObj.element)&&(l=[].slice.call(u.children),a="home"===r.action?l[0]:l[l.length-1]):(l=this.element.querySelectorAll("."+e+" ."+i+":not(.e-separator)"),a="home"===r.action?l[0]:l[l.length-1]),a&&this.elementFocus(a)}break;case"moveUp":case"moveDown":if(h="moveUp"===r.action?"previous":"next",this.options.isVertical)"moveUp"===r.action?this.eleFocus(t,"previous"):this.eleFocus(t,"next");else if(d&&sf.base.closest(n,".e-popup")){var f=d.element,m=f.firstElementChild;if("previous"===h&&m===t||"next"===h&&f.lastElementChild===t)return;this.eleFocus(t,h)}else"moveDown"===r.action&&d&&sf.base.isVisible(d.element)&&this.elementFocus(t);break;case"tab":if(!s&&!o){var y=t.firstElementChild;c===n&&(this.activeEle?this.activeEle.focus():(this.activeEleRemove(y),y.focus()))}break;case"popupClose":d&&"Extended"!==this.options.overflowMode&&d.hide(p);break;case"popupOpen":if(!o)return;d&&!sf.base.isVisible(d.element)?(d.element.style.top=c.offsetHeight+"px",d.show({name:"FadeIn",duration:100})):d.hide(p)}},n.prototype.keyActionHandler=function(e){var t=e.target;if("INPUT"!==t.tagName&&"TEXTAREA"!==t.tagName&&!this.element.classList.contains("e-overlay")){e.preventDefault();var i=t.classList.contains("e-hor-nav"),r=t.classList.contains("e-scroll-nav"),n=this.clstElement(i,t);(n||r)&&this.keyHandling(n,e,t,i,r)}},n.prototype.eleContains=function(e){var t=!!e.classList.contains("e-template")&&!sf.base.isNullOrUndefined(e.querySelector(".e-input"));return e.classList.contains("e-separator")||e.classList.contains("e-overlay")||e.getAttribute("disabled")||e.classList.contains("e-hidden")||!sf.base.isVisible(e)||t},n.prototype.eleFocus=function(e,t){var r=Object(e)[t+"ElementSibling"];if(r){if(this.eleContains(r))return void this.eleFocus(r,t);this.elementFocus(r)}else if(this.tbarAlign){var n=Object(e.parentElement)[t+"ElementSibling"];if(sf.base.isNullOrUndefined(n)||0!==n.children.length||(n=Object(n)[t+"ElementSibling"]),!sf.base.isNullOrUndefined(n)&&n.children.length>0)if("next"===t){var o=n.querySelector("."+i);this.eleContains(o)?this.eleFocus(o,t):(o.firstElementChild.focus(),this.activeEleSwitch(o))}else{o=n.lastElementChild;this.eleContains(o)?this.eleFocus(o,t):this.elementFocus(o)}}},n.prototype.clickHandler=function(e){if(!this.element.classList.contains("e-drag-action")){var t=sf.base.closest(e.target,"."+i);if(sf.base.isNullOrUndefined(t)||t.classList.contains("e-overlay")||"true"===t.getAttribute("aria-disabled")){var r,n,o=e.target,s=o.classList,a=this.element,l=sf.base.closest(o,".e-hor-nav");if(l||(l=o),a.children[0].classList.contains("e-hscroll")||a.children[0].classList.contains("e-vscroll")||!s.contains("e-hor-nav")||(s=o.querySelector(".e-icons").classList),(s.contains("e-popup-up-icon")||s.contains("e-popup-down-icon"))&&this.popupClickHandler(a,l,"e-rtl"),!sf.base.isNullOrUndefined(t)||l.classList.contains("e-hor-nav")){sf.base.isNullOrUndefined(t)||(r=parseInt(t.getAttribute("data-index"),10),n={id:t.id});var h={altKey:e.altKey,button:e.button,buttons:e.buttons,clientX:e.clientX,clientY:e.clientY,ctrlKey:e.ctrlKey,detail:e.detail,metaKey:e.metaKey,offsetX:e.offsetX,offsetY:e.offsetY,screenX:e.screenX,screenY:e.screenY,shiftKey:e.shiftKey,type:e.type};this.dotNetRef.invokeMethodAsync("TriggerClickEvent",h,r,n)}}}},n.prototype.popupClickHandler=function(e,t,i){var r=this.popObj;sf.base.isVisible(r.element)?(t.classList.remove("e-nav-active"),r.hide({name:"FadeOut",duration:100})):((e.classList.contains(i)||this.options.isVerticalLeft)&&(e.classList.contains(i)&&(r.enableRtl=!0),r.position={X:"left",Y:"top"}),0!==r.offsetX||e.classList.contains(i)||this.options.isVerticalLeft||(r.enableRtl=!1,r.position={X:"right",Y:"top"}),r.dataBind(),r.refreshPosition(),r.element.style.top=this.getElementOffsetY()+"px","Extended"===this.options.overflowMode&&(r.element.style.left="0px",r.element.style.minHeight="0px"),t.classList.add("e-nav-active"),r.show({name:"FadeIn",duration:100}))},n.prototype.render=function(){this.scrollModule=null,this.popObj=null,this.isExtendedOpen=!1,this.popupPriCount=0;var e=sf.base.formatUnit(this.options.width),t=sf.base.formatUnit(this.options.height);this.element&&("msie"===sf.base.Browser.info.name&&"auto"===this.options.height||sf.base.setStyleAttribute(this.element,{height:t}),sf.base.setStyleAttribute(this.element,{width:e}),this.renderControl(),this.wireEvents())},n.prototype.renderControl=function(){this.tbarAlgEle={lefts:[],centers:[],rights:[]},this.renderItems(),this.renderLayout()},n.prototype.renderLayout=function(){this.renderOverflowMode(),this.tbarAlign&&this.itemPositioning(),this.popObj&&this.popObj.element.childElementCount>1&&this.checkPopupRefresh(this.element,this.popObj.element)&&this.popupRefresh(this.popObj.element,!1),this.separator()},n.prototype.itemsAlign=function(e,r,n){var o,s;this.tbarEle||(this.tbarEle=[]);for(var a=0;a<e.length;a++){var l=this.element.querySelector("."+t);(o="MultiRow"===this.options.overflowMode&&n?r.querySelector("."+i+'[id="'+e[a].id+'"]'):l.querySelector("."+i+'[id="'+e[a].id+'"]'))&&("Show"!==e[a].overflow&&e[a].showAlwaysInPopup&&!o.classList.contains("e-separator")&&this.popupPriCount++,e[a].htmlAttributes&&this.setAttr(e[a].htmlAttributes,o),"Button"===e[a].type&&(sf.base.EventHandler.remove(o,"click",this.itemClick),sf.base.EventHandler.add(o,"click",this.itemClick,this)),-1===this.tbarEle.indexOf(o)&&this.tbarEle.push(o),"MultiRow"===this.options.overflowMode&&n||(this.tbarAlign||this.tbarItemAlign(e[a],r,a),(s=r.querySelector(".e-toolbar-"+e[a].align.toLowerCase()))?(e[a].showAlwaysInPopup&&"Show"!==e[a].overflow||this.tbarAlgEle[(e[a].align+"s").toLowerCase()].push(o),s.appendChild(o)):r.appendChild(o)))}},n.prototype.serverItemsRefresh=function(i){var r=this.element,n=r.querySelector("."+t),o=r.querySelector("."+e);(o&&o.children.length>0||n.children.length>0)&&(!o&&r&&r.classList.contains("e-toolbar")&&r.firstElementChild&&(o=sf.base.createElement("div",{className:e}),r.insertBefore(o,r.firstElementChild)),this.itemsAlign(this.options.items,o,i),this.renderLayout(),this.refreshOverflow())},n.prototype.resetServerItems=function(r){if("MultiRow"!==this.options.overflowMode||!r){var n=this.element.querySelector("."+t),o=[].slice.call(sf.base.selectAll("."+e+" ."+i,this.element));sf.base.append(o,n),this.clearProperty()}},n.prototype.changeOrientation=function(){this.options.isVertical?(this.element.classList.add("e-vertical"),this.element.setAttribute("aria-orientation","vertical"),sf.base.setStyleAttribute(this.element,{height:sf.base.formatUnit(this.options.height),width:sf.base.formatUnit(this.options.width)})):(this.element.classList.remove("e-vertical"),this.element.setAttribute("aria-orientation","horizontal"),"auto"!==this.options.height&&"100%"!==this.options.height||(this.element.style.height=this.options.height)),this.destroyMode(),this.refreshOverflow()},n.prototype.initScroll=function(t,i){!this.scrollModule&&this.checkOverflow(t,i[0])&&(this.tbarAlign&&this.element.querySelector("."+e+" .e-toolbar-center").removeAttribute("style"),this.options.isVertical?this.scrollModule=new sf.navigations.VScroll({scrollStep:this.options.scrollStep,enableRtl:this.options.enableRtl},i[0]):this.scrollModule=new sf.navigations.HScroll({scrollStep:this.options.scrollStep,enableRtl:this.options.enableRtl},i[0]),sf.base.removeClass([this.scrollModule.element],"e-tbar-pos"),sf.base.setStyleAttribute(this.element,{overflow:"hidden"}))},n.prototype.itemWidthCal=function(e){var t,r=this,n=0;return[].slice.call(sf.base.selectAll("."+i,e)).forEach((function(e){sf.base.isVisible(e)&&(t=window.getComputedStyle(e),n+=r.options.isVertical?e.offsetHeight:e.offsetWidth,n+=parseFloat(r.options.isVertical?t.marginTop:t.marginRight),n+=parseFloat(r.options.isVertical?t.marginBottom:t.marginLeft))})),n},n.prototype.getScrollCntEle=function(e){var t=this.options.isVertical?".e-vscroll-content":".e-hscroll-content";return e.querySelector(t)},n.prototype.checkOverflow=function(e,t){if(sf.base.isNullOrUndefined(e)||sf.base.isNullOrUndefined(t)||!sf.base.isVisible(e))return!1;var i=this.options.isVertical?e.offsetHeight:e.offsetWidth,r=this.options.isVertical?t.offsetHeight:t.offsetWidth;(this.tbarAlign||this.scrollModule||i===r)&&(r=this.itemWidthCal(this.scrollModule?this.getScrollCntEle(t):t));var n=e.querySelector(".e-hor-nav"),o=e.querySelector(".e-scroll-nav"),s=0;return n?s=this.options.isVertical?n.offsetHeight:n.offsetWidth:o&&(s=this.options.isVertical?2*o.offsetHeight:2*o.offsetWidth),r>i-s},n.prototype.refreshOverflow=function(){this.resize()},n.prototype.toolbarAlign=function(e){this.tbarAlign&&(sf.base.addClass([e],"e-tbar-pos"),this.itemPositioning())},n.prototype.renderOverflowMode=function(){var t=this.element,i=t.querySelector("."+e),r=this.popupPriCount>0;if(t&&t.children.length>0)switch(this.offsetWid=t.offsetWidth,sf.base.removeClass([this.element],"e-toolpop"),"msie"===sf.base.Browser.info.name&&"auto"===this.options.height&&(t.style.height=""),this.options.overflowMode){case"Scrollable":sf.base.isNullOrUndefined(this.scrollModule)&&this.initScroll(t,[].slice.call(t.getElementsByClassName(e)));break;case"Popup":sf.base.addClass([this.element],"e-toolpop"),this.tbarAlign&&this.removePositioning(),(this.checkOverflow(t,i)||r)&&this.setOverflowAttributes(t),this.toolbarAlign(i);break;case"MultiRow":sf.base.addClass([i],"e-toolbar-multirow"),this.checkOverflow(t,i)&&this.tbarAlign&&(this.removePositioning(),sf.base.addClass([i],"e-multirow-pos")),"hidden"===t.style.overflow&&(t.style.overflow=""),"msie"!==sf.base.Browser.info.name&&"auto"===t.style.height||(t.style.height="auto");break;case"Extended":sf.base.addClass([this.element],"e-extended-toolbar"),(this.checkOverflow(t,i)||r)&&(this.tbarAlign&&this.removePositioning(),this.setOverflowAttributes(t)),this.toolbarAlign(i)}},n.prototype.setOverflowAttributes=function(t){this.createPopupEle(t,[].slice.call(sf.base.selectAll("."+e+" ."+i,t)));sf.base.attributes(this.element.querySelector(".e-hor-nav"),{tabindex:"0",role:"button","aria-haspopup":"true","aria-label":"overflow"})},n.prototype.separator=function(){var e=this.element,t=[].slice.call(e.querySelectorAll(".e-separator")),i=e.querySelector(".e-multirow-separator"),r=e.querySelector(".e-extended-separator"),n="MultiRow"===this.options.overflowMode?i:r;null!==n&&("MultiRow"===this.options.overflowMode?n.classList.remove("e-multirow-separator"):"Extended"===this.options.overflowMode&&n.classList.remove("e-extended-separator"));for(var o=0;o<=t.length-1;o++)t[o].offsetLeft<30&&0!==t[o].offsetLeft&&("MultiRow"===this.options.overflowMode?t[o].classList.add("e-multirow-separator"):"Extended"===this.options.overflowMode&&t[o].classList.add("e-extended-separator"))},n.prototype.createPopupEle=function(e,t){var i=e.querySelector(".e-hor-nav"),r=this.options.isVertical;i||this.createPopupIcon(e),i=e.querySelector(".e-hor-nav");var n=r?i.offsetHeight:i.offsetWidth,o=(r?e.offsetHeight:e.offsetWidth)-n;this.element.classList.remove("e-rtl"),sf.base.setStyleAttribute(this.element,{direction:"initial"}),this.checkPriority(e,t,o,!0),this.options.enableRtl&&this.element.classList.add("e-rtl"),this.element.style.removeProperty("direction"),this.createPopup()},n.prototype.pushingPoppedEle=function(t,n,o,s,a){var l=this.element,h=sf.base.selectAll(".e-overflow-show",o),d=0,c=[].slice.call(sf.base.selectAll("."+r,l.querySelector("."+e))),p=0;c.forEach((function(e,i){h=sf.base.selectAll(".e-overflow-show",o),e.classList.contains("e-overflow-show")&&h.length>0?t.tbResize&&h.length>i?(o.insertBefore(e,h[i]),++p):(o.insertBefore(e,o.children[h.length]),++p):e.classList.contains("e-overflow-show")||t.tbResize&&e.classList.contains("e-overflow-hide")&&o.children.length>0&&0===h.length?(o.insertBefore(e,o.firstChild),++p):e.classList.contains("e-overflow-hide")?n.push(e):t.tbResize?(o.insertBefore(e,o.childNodes[d+p]),++d):o.appendChild(e),e.classList.contains("e-separator")?sf.base.setStyleAttribute(e,{display:"",height:a+"px"}):sf.base.setStyleAttribute(e,{display:"",height:s+"px"})})),n.forEach((function(e){o.appendChild(e)}));for(var u=sf.base.selectAll("."+i,l.querySelector("."+e)),g=u.length-1;g>=0;g--){var f=u[g];if(!f.classList.contains("e-separator")||"Extended"===this.options.overflowMode)break;sf.base.setStyleAttribute(f,{display:"none"})}},n.prototype.createPopup=function(){var e,t,n=this.element;"Extended"===this.options.overflowMode&&(t=n.querySelector(".e-separator:not(."+r+")"),e="auto"===n.style.height||""===n.style.height?null:t&&t.offsetHeight);var o,s=n.querySelector("."+i+":not(.e-separator):not(."+r+"):not(.e-hidden)"),a="auto"===n.style.height||""===n.style.height?null:s&&s.offsetHeight;if(n.querySelector("#"+n.id+"_popup.e-toolbar-pop"))o=n.querySelector("#"+n.id+"_popup.e-toolbar-pop");else{var l=sf.base.createElement("div",{id:n.id+"_popup",className:"e-toolbar-pop e-toolbar-extended"}),h=sf.base.createElement("div",{id:n.id+"_popup",className:"e-toolbar-pop"});o="Extended"===this.options.overflowMode?l:h}this.pushingPoppedEle(this,[],o,a,e),this.popupInit(n,o)},n.prototype.getElementOffsetY=function(){return"Extended"===this.options.overflowMode&&"border-box"===window.getComputedStyle(this.element).getPropertyValue("box-sizing")?this.element.clientHeight:this.element.offsetHeight},n.prototype.popupInit=function(e,t){if(this.popObj){var i=this.popObj.element;if("Extended"===this.options.overflowMode){var r=window.getComputedStyle(this.element);this.popObj.width=parseFloat(r.width)+2*parseFloat(r.borderRightWidth),this.popObj.offsetX=0,this.popObj.dataBind()}sf.base.setStyleAttribute(i,{maxHeight:"",display:"block"}),sf.base.setStyleAttribute(i,{maxHeight:i.offsetHeight+"px",display:""})}else{e.appendChild(t),sf.base.setStyleAttribute(this.element,{overflow:""});var n=window.getComputedStyle(this.element),o=new sf.popups.Popup(null,{relateTo:this.element,offsetY:this.options.isVertical?0:this.getElementOffsetY(),enableRtl:this.options.enableRtl,open:this.popupOpen.bind(this),close:this.popupClose.bind(this),collision:{Y:this.options.enableCollision?"flip":"none"},position:this.options.enableRtl?{X:"left",Y:"top"}:{X:"right",Y:"top"}});if(o.appendTo(t),"Extended"===this.options.overflowMode&&(o.width=parseFloat(n.width)+2*parseFloat(n.borderRightWidth),o.offsetX=0),sf.base.EventHandler.add(document,"scroll",this.docEvent.bind(this)),sf.base.EventHandler.add(document,"click ",this.docEvent.bind(this)),o.element.style.maxHeight=o.element.offsetHeight+"px",this.options.isVertical&&(o.element.style.visibility="hidden"),this.isExtendedOpen){var s=this.element.querySelector(".e-hor-nav");s.classList.add("e-nav-active"),sf.base.classList(s.firstElementChild,["e-popup-up-icon"],["e-popup-down-icon"]),this.element.querySelector(".e-toolbar-extended").classList.add("e-popup-open")}else o.hide();this.popObj=o}},n.prototype.tbarPopupHandler=function(e){"Extended"===this.options.overflowMode&&(e?sf.base.addClass([this.element],"e-tbar-extended"):sf.base.removeClass([this.element],"e-tbar-extended"))},n.prototype.popupOpen=function(e){var t=this.popObj;this.options.isVertical||(t.offsetY=this.getElementOffsetY(),t.dataBind());var i=this.popObj.element,r=this.popObj.element.parentElement,n=r.querySelector(".e-hor-nav");n.setAttribute("aria-expanded","true"),sf.base.setStyleAttribute(t.element,{height:"auto",maxHeight:""}),t.element.style.maxHeight=t.element.offsetHeight+"px","Extended"===this.options.overflowMode&&(t.element.style.left="",t.element.style.minHeight="");var o=i.offsetTop+i.offsetHeight+sf.popups.calculatePosition(r).top,s=n.firstElementChild;n.classList.add("e-nav-active"),sf.base.classList(s,["e-popup-up-icon"],["e-popup-down-icon"]),this.tbarPopupHandler(!0);var a=sf.base.isNullOrUndefined(window.scrollY)?0:window.scrollY;if(!this.options.isVertical&&window.innerHeight+a<o&&this.element.offsetTop<i.offsetHeight){var l=i.offsetHeight-(o-window.innerHeight-a+5);t.height=l+"px";for(var h=0;h<=i.childElementCount;h++){var d=i.children[h];if(d.offsetTop+d.offsetHeight>l){l=d.offsetTop;break}}sf.base.setStyleAttribute(t.element,{maxHeight:l+"px"})}else if(this.options.isVertical){var c=this.element.getBoundingClientRect();sf.base.setStyleAttribute(t.element,{maxHeight:c.top+this.element.offsetHeight+"px",bottom:0,visibility:""})}if(t){var p=i.getBoundingClientRect();p.right>document.documentElement.clientWidth&&p.width>r.getBoundingClientRect().width&&(t.collision={Y:"none"},t.dataBind()),t.refreshPosition()}},n.prototype.popupClose=function(e){var t=this.element.querySelector(".e-hor-nav");t.setAttribute("aria-expanded","false");var i=t.firstElementChild;t.classList.remove("e-nav-active"),sf.base.classList(i,["e-popup-down-icon"],["e-popup-up-icon"]),this.tbarPopupHandler(!1)},n.prototype.checkPriority=function(e,t,n,o){for(var s,a=this.popupPriCount>0,l=n,h=0,d=0,c=0,p=function(e,t){var i=!1;return t.forEach((function(t){e.classList.contains(t)&&(i=!0)})),i},u=t.length-1;u>=0;u--){var g=void 0,f=window.getComputedStyle(t[u]);this.options.isVertical?(g=parseFloat(f.marginTop),g+=parseFloat(f.marginBottom)):(g=parseFloat(f.marginRight),g+=parseFloat(f.marginLeft));var m=t[u]===this.tbarEle[0];m&&(this.tbarEleMrgn=g),s=this.options.isVertical?t[u].offsetHeight:t[u].offsetWidth;var y=m?s+g:s;if(p(t[u],["e-popup-alone"])&&a&&(t[u].classList.add(r),this.options.isVertical?sf.base.setStyleAttribute(t[u],{display:"none",minHeight:y+"px"}):sf.base.setStyleAttribute(t[u],{display:"none",minWidth:y+"px"}),c++),this.options.isVertical?t[u].offsetTop+t[u].offsetHeight+g>n:t[u].offsetLeft+t[u].offsetWidth+g>n){if(t[u].classList.contains("e-separator")){if("Extended"===this.options.overflowMode){if(d===c)p(v=t[u],["e-separator","e-ignore"])&&(t[u].classList.add(r),c++);d++}else if("Popup"===this.options.overflowMode){var v;if(h>0&&d===c)p(v=t[u+d+(h-1)],["e-separator","e-ignore"])&&sf.base.setStyleAttribute(v,{display:"none"});h++,d=0,c=0}}else d++;t[u].classList.contains("e-overflow-show")&&o||p(t[u],["e-separator","e-ignore"])?n-=(this.options.isVertical?t[u].offsetHeight:t[u].offsetWidth)+g:(t[u].classList.add(r),this.options.isVertical?sf.base.setStyleAttribute(t[u],{display:"none",minHeight:y+"px"}):sf.base.setStyleAttribute(t[u],{display:"none",minWidth:y+"px"}),c++)}}if(o){var b=sf.base.selectAll("."+i+":not(."+r+")",this.element);this.checkPriority(e,b,l,!1)}},n.prototype.createPopupIcon=function(e){var t=e.id.concat("_nav"),i="e-"+e.id.concat("_nav e-hor-nav");i="Extended"===this.options.overflowMode?i+" e-expended-nav":i;var r=sf.base.createElement("div",{id:t,className:i});"msie"!==sf.base.Browser.info.name&&"edge"!==sf.base.Browser.info.name||r.classList.add("e-ie-align");var n=sf.base.createElement("div",{className:"e-popup-down-icon e-icons"});r.appendChild(n),r.setAttribute("tabindex","0"),r.setAttribute("role","button"),e.appendChild(r)},n.prototype.tbarPriRef=function(e,t,i,n,o,s,a,l){var h=l,d=this.popObj.element,c=sf.base.selectAll("."+r+":not(.e-overflow-show)",d).length,p=function(e,t){return e.classList.contains(t)};if(0===sf.base.selectAll(".e-toolbar-item:not(.e-separator):not(.e-overflow-show)",e).length){var u=e.children[t-(t-i)-1],g=!sf.base.isNullOrUndefined(u)&&p(u,"e-ignore");if(!sf.base.isNullOrUndefined(u)&&p(u,"e-separator")&&!sf.base.isVisible(u)||g){u.style.display="inherit";var f=u.offsetWidth+2*parseFloat(window.getComputedStyle(u).marginRight),m=u.previousElementSibling;s+f<a||o?(e.insertBefore(n,e.children[t+h-(t-i)]),sf.base.isNullOrUndefined(m)||(m.style.display="")):m.classList.contains("e-separator")&&(m.style.display="none"),u.style.display=""}else e.insertBefore(n,e.children[t+h-(t-i)])}else e.insertBefore(n,e.children[t+h-c])},n.prototype.popupRefresh=function(t,i){var r=this,n=this.element,o=this.options.isVertical,s=n.querySelector(".e-hor-nav"),a=n.querySelector("."+e);if(!sf.base.isNullOrUndefined(s)&&!sf.base.isNullOrUndefined(a)){var l;a.removeAttribute("style"),t.style.display="block",l=o?n.offsetHeight-(s.offsetHeight+a.offsetHeight):n.offsetWidth-(s.offsetWidth+a.offsetWidth);var h=0;[].slice.call(t.children).forEach((function(e){h+=r.popupEleWidth(e),sf.base.setStyleAttribute(e,{position:""})})),l+(o?s.offsetHeight:s.offsetWidth)>h&&0===this.popupPriCount&&(i=!0),this.popupEleRefresh(l,t,i),t.style.display="",0===t.children.length&&s&&this.popObj&&(sf.base.detach(s),s=null,this.popObj.destroy(),sf.base.detach(this.popObj.element),this.popObj=null)}},n.prototype.ignoreEleFetch=function(e,t){var i=[].slice.call(t.querySelectorAll(".e-ignore")),r=[],n=0;return i.length>0?(i.forEach((function(e){r.push([].slice.call(t.children).indexOf(e))})),r.forEach((function(t){t<=e&&n++})),n):0},n.prototype.checkPopupRefresh=function(t,i){i.style.display="block";var r=this.popupEleWidth(i.firstElementChild);i.firstElementChild.style.removeProperty("Position");var n=t.offsetWidth-t.querySelector(".e-hor-nav").offsetWidth,o=t.querySelector("."+e).offsetWidth;return i.style.removeProperty("display"),n>r+o},n.prototype.popupEleWidth=function(e){e.style.position="absolute";var t=this.options.isVertical?e.offsetHeight:e.offsetWidth,i=e.querySelector(".e-tbar-btn-text");if(e.classList.contains("e-tbtn-align")||e.classList.contains("e-popup-text")){var r=e.children[0];!sf.base.isNullOrUndefined(i)&&e.classList.contains("e-popup-text")?i.style.display="none":!sf.base.isNullOrUndefined(i)&&e.classList.contains("e-toolbar-text")&&(i.style.display="block"),r.style.minWidth="0%",t=parseFloat(this.options.isVertical?e.style.minHeight:e.style.minWidth),r.style.minWidth="",r.style.minHeight="",sf.base.isNullOrUndefined(i)||(i.style.display="")}return t},n.prototype.popupEleRefresh=function(t,i,n){for(var o,s,a=this.popupPriCount>0,l=this.tbarEle,h=this.element.querySelector("."+e),d=0,c=function(i){if(i.classList.contains("e-popup-alone")&&a&&!n)return"continue";var c=p.popupEleWidth(i);if(i===p.tbarEle[0]&&(c+=p.tbarEleMrgn),i.style.position="",!(c<t||n))return"break";if(sf.base.setStyleAttribute(i,{minWidth:"",height:"",minHeight:""}),i.classList.contains("e-overflow-hide")||i.classList.remove(r),s=p.tbarEle.indexOf(i),p.tbarAlign){var u=p.options.items[s].align;s=p.tbarAlgEle[(u+"s").toLowerCase()].indexOf(i),l=p.tbarAlgEle[(u+"s").toLowerCase()],h=p.element.querySelector("."+e+" .e-toolbar-"+u.toLowerCase())}var g=0;"Extended"!==p.options.overflowMode&&l.slice(0,s).forEach((function(e){(e.classList.contains("e-overflow-show")||e.classList.contains("e-separator"))&&(e.classList.contains("e-separator")&&(e.style.display="",t-=e.offsetWidth),g++)})),d=p.ignoreEleFetch(s,h),i.classList.contains("e-overflow-show")?(p.tbarPriRef(h,s,g,i,n,c,t,d),t-=i.offsetWidth):0===s?(h.insertBefore(i,h.firstChild),t-=i.offsetWidth):(o=sf.base.selectAll(".e-overflow-show",p.popObj.element).length,h.insertBefore(i,h.children[s+d-o]),t-=i.offsetWidth),i.style.height=""},p=this,u=0,g=[].slice.call(i.children);u<g.length;u++){if("break"===c(g[u]))break}this.checkOverflow(this.element,this.element.getElementsByClassName(e)[0])&&!n&&this.renderOverflowMode()},n.prototype.removePositioning=function(){var t=this.element.querySelector("."+e);if(!sf.base.isNullOrUndefined(t)&&t.classList.contains("e-tbar-pos")){sf.base.removeClass([t],"e-tbar-pos");var i=[].slice.call(t.childNodes);i[1].removeAttribute("style"),i[2].removeAttribute("style")}},n.prototype.refreshPositioning=function(){var t=this.element.querySelector("."+e);sf.base.addClass([t],"e-tbar-pos"),this.itemPositioning()},n.prototype.itemPositioning=function(){var t,i=this.element.querySelector("."+e);if(!sf.base.isNullOrUndefined(i)&&i.classList.contains("e-tbar-pos")){var r,n=this.element.querySelector(".e-hor-nav");if(this.scrollModule){var o=this.options.isVertical?"e-vscroll-content":"e-hscroll-content";r=[].slice.call(i.querySelector("."+o).children)}else r=[].slice.call(i.childNodes);t=this.options.isVertical?r[0].offsetHeight+r[2].offsetHeight:r[0].offsetWidth+r[2].offsetWidth;var s=this.options.isVertical?this.element.offsetHeight:this.element.offsetWidth;if(n){s-=this.options.isVertical?n.offsetHeight:n.offsetWidth;var a=(this.options.isVertical?n.offsetHeight:n.offsetWidth)+"px";r[2].removeAttribute("style"),this.options.isVertical?this.options.enableRtl?r[2].style.top=a:r[2].style.bottom=a:this.options.enableRtl?r[2].style.left=a:r[2].style.right=a}if(!(s<=t)){var l=(s-t-(this.options.isVertical?r[1].offsetHeight:r[1].offsetWidth))/2;r[1].removeAttribute("style");var h=(this.options.isVertical?r[0].offsetHeight:r[0].offsetWidth)+l+"px";this.options.isVertical?this.options.enableRtl?r[1].style.marginBottom=h:r[1].style.marginTop=h:this.options.enableRtl?r[1].style.marginRight=h:r[1].style.marginLeft=h}}},n.prototype.tbarItemAlign=function(e,t,i){var r=this;if(!e.showAlwaysInPopup||"Show"===e.overflow){var n=[];if(n.push(sf.base.createElement("div",{className:"e-toolbar-left"})),n.push(sf.base.createElement("div",{className:"e-toolbar-center"})),n.push(sf.base.createElement("div",{className:"e-toolbar-right"})),0===i&&"Left"!==e.align)n.forEach((function(e){t.appendChild(e)})),this.tbarAlign=!0,sf.base.addClass([t],"e-tbar-pos");else if("Left"!==e.align){var o=t.childNodes,s=n[0];[].slice.call(o).forEach((function(e){r.tbarAlgEle.lefts.push(e),s.appendChild(e)})),t.appendChild(s),t.appendChild(n[1]),t.appendChild(n[2]),this.tbarAlign=!0,sf.base.addClass([t],"e-tbar-pos")}}},n.prototype.renderItems=function(){var t=this.element,i=this.options.items;if(t&&i.length>0){var r=t.querySelector("."+e);r||(r=sf.base.createElement("div",{className:e})),this.itemsAlign(i,r,!0),sf.base.isNullOrUndefined(t.firstElementChild)?t.appendChild(r):t.insertBefore(r,t.firstElementChild)}},n.prototype.setAttr=function(e,t){for(var i,r=Object.keys(e),n=0;n<r.length;n++)"class"===(i=r[n])?sf.base.addClass([t],e[i]):t.setAttribute(i,e[i])},n.prototype.getDataTabindex=function(e){return sf.base.isNullOrUndefined(e.getAttribute("data-tabindex"))?"-1":e.getAttribute("data-tabindex")},n.prototype.itemClick=function(e){this.activeEleSwitch(e.currentTarget)},n.prototype.activeEleSwitch=function(e){this.activeEleRemove(e.firstElementChild),this.activeEle.focus()},n.prototype.activeEleRemove=function(e){sf.base.isNullOrUndefined(this.activeEle)||this.activeEle.setAttribute("tabindex",this.getDataTabindex(this.activeEle)),this.activeEle=e,"-1"===this.getDataTabindex(this.activeEle)&&(sf.base.isNullOrUndefined(this.trgtEle)&&!e.parentElement.classList.contains("e-template")?(this.updateTabIndex("-1"),e.removeAttribute("tabindex")):this.activeEle.setAttribute("tabindex",this.getDataTabindex(this.activeEle)))},n.prototype.resize=function(){var t=this.element;this.tbResize=!0,this.tbarAlign&&this.itemPositioning(),this.popObj&&"Popup"===this.options.overflowMode&&this.popObj.hide();var i=this.checkOverflow(t,t.getElementsByClassName(e)[0]);if(!i){this.destroyScroll();var r=t.querySelector("."+e);sf.base.isNullOrUndefined(r)||(sf.base.removeClass([r],"e-multirow-pos"),this.tbarAlign&&sf.base.addClass([r],"e-tbar-pos"))}if(!i||!this.scrollModule||this.offsetWid!==t.offsetWidth){if((this.offsetWid>t.offsetWidth||i)&&this.renderOverflowMode(),this.popObj){if("Extended"===this.options.overflowMode){var n=window.getComputedStyle(this.element);this.popObj.width=parseFloat(n.width)+2*parseFloat(n.borderRightWidth)}this.tbarAlign&&this.removePositioning(),this.popupRefresh(this.popObj.element,!1),this.tbarAlign&&this.refreshPositioning()}this.offsetWid=t.offsetWidth,this.tbResize=!1,this.separator()}},n.prototype.extendedOpen=function(){var e=this.element.querySelector(".e-toolbar-extended");"Extended"===this.options.overflowMode&&e&&(this.isExtendedOpen=e.classList.contains("e-popup-open"))},n.prototype.updateHideEleTabIndex=function(e,t,i,r){for(var n=r[++i];n;){if(!this.eleContains(n)){var o=n.firstElementChild.getAttribute("data-tabindex");t||"-1"!==o?o!==n.firstElementChild.getAttribute("tabindex")&&n.firstElementChild.setAttribute("tabindex",o):n.firstElementChild.setAttribute("tabindex","0");break}n=r[++i]}},n.prototype.disable=function(e){var t=this.element;e?t.classList.add("e-overlay"):t.classList.remove("e-overlay"),this.activeEle&&this.activeEle.setAttribute("tabindex",this.activeEle.getAttribute("data-tabindex")),this.scrollModule&&this.scrollModule.disable(e),this.popObj&&(sf.base.isVisible(this.popObj.element)&&"Extended"!==this.options.overflowMode&&this.popObj.hide(),t.querySelector("#"+t.id+"_nav").setAttribute("tabindex",e?"-1":"0"))},n.prototype.setCssClass=function(e){this.extendedOpen(),this.options.cssClass&&sf.base.removeClass([this.element],this.options.cssClass.split(" ")),e&&sf.base.addClass([this.element],e.split(" ")),this.options.cssClass=e},n}();return{initialize:function(e,t,i,r){0===i.scrollStep&&(i.scrollStep=null),new n(e,t,i,r).render()},hidePopup:function(e,t){var r=window.sfBlazor.getCompInstance(e);if(!sf.base.isNullOrUndefined(r)&&!sf.base.isNullOrUndefined(r.element)&&!sf.base.isNullOrUndefined(r.popObj)){var n=r.element.querySelector("."+i+'[data-index="'+t+'"]');sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(sf.base.closest(n,".e-toolbar-pop"))||r.popObj.hide({name:"FadeOut",duration:100})}},setCssClass:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||i.setCssClass(t)},setWidth:function(e,t){var i=window.sfBlazor.getCompInstance(e);if(!sf.base.isNullOrUndefined(i)&&!sf.base.isNullOrUndefined(i.element)){i.options.width=t,i.extendedOpen();var r=i.element.offsetWidth;sf.base.setStyleAttribute(i.element,{width:sf.base.formatUnit(t)}),i.renderOverflowMode(),i.popObj&&r<i.element.offsetWidth&&i.popupRefresh(i.popObj.element,!1)}},setHeight:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(i.options.height=t,i.extendedOpen(),sf.base.setStyleAttribute(i.element,{height:sf.base.formatUnit(t)}))},setOverflowMode:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(i.options.overflowMode=t,i.extendedOpen(),i.destroyMode(),i.renderOverflowMode(),i.options.enableRtl&&sf.base.addClass([i.element],"e-rtl"),i.refreshOverflow())},setEnableRTL:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(i.options.enableRtl=t,i.extendedOpen(),t?sf.base.addClass([i.element],"e-rtl"):sf.base.removeClass([i.element],"e-rtl"),sf.base.isNullOrUndefined(i.scrollModule)||(t?sf.base.addClass([i.scrollModule.element],"e-rtl"):sf.base.removeClass([i.scrollModule.element],"e-rtl")),sf.base.isNullOrUndefined(i.popObj)||(t?sf.base.addClass([i.popObj.element],"e-rtl"):sf.base.removeClass([i.popObj.element],"e-rtl")),i.tbarAlign&&i.itemPositioning())},setScrollStep:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(i.options.scrollStep=t,i.extendedOpen(),i.scrollModule&&(i.scrollModule.scrollStep=t))},setEnableCollision:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(i.options.enableCollision=t,i.extendedOpen(),i.popObj&&(i.popObj.collision={Y:t?"flip":"none"}))},setAllowKeyboard:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(i.options.allowKeyboard=t,i.extendedOpen(),i.unwireKeyboardEvent(),t&&i.wireKeyboardEvent())},serverItemsRerender:function(e,t,i){var r=window.sfBlazor.getCompInstance(e);if(!sf.base.isNullOrUndefined(r)&&!sf.base.isNullOrUndefined(r.element)){var n=document.activeElement;r.options.items=t,r.extendedOpen(),r.destroyMode(),r.resetServerItems(i),r.serverItemsRefresh(i),document.activeElement!=n&&n.focus()}},hideItem:function(e,t,r){var n=window.sfBlazor.getCompInstance(e);if(!sf.base.isNullOrUndefined(n)&&!sf.base.isNullOrUndefined(n.element)){n.options.items=t;var o=[].slice.call(sf.base.selectAll("."+i,this.element)),s=o[parseInt(r.toString(),10)];s&&(t[r].visible?s.classList.contains("e-separator")||n.updateHideEleTabIndex(s,t[r].visible,r,o):s.classList.contains("e-separator")||(sf.base.isNullOrUndefined(s.firstElementChild.getAttribute("tabindex"))||"-1"!==s.firstElementChild.getAttribute("tabindex"))&&n.updateHideEleTabIndex(s,t[r].visible,r,o)),n.refreshOverflow()}},disable:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||i.disable(t)},refreshOverflow:function(e){var t=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t.element)||t.refreshOverflow()},destroy:function(e){var t=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t.element)||t.destroy()},refresh:function(e,t){var i=window.sfBlazor.getCompInstance(e);0===t.scrollStep&&(t.scrollStep=null),sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(i.options=t,i.destroyMode(),i.resetServerItems(!1),i.serverItemsRefresh(!1))}}}()},"./modules/sortable.js":function(e,t){function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}window.sf=window.sf||{};sf.lists=sf.base.extend({},sf.lists,function(e){"use strict";var t,r=(t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,i)},function(e,i){function r(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}),n=function(e,t,r,n){var o,s=arguments.length,a=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(s<3?o(a):s>3?o(t,r,a):o(t,r))||a);return s>3&&a&&Object.defineProperty(t,r,a),a},o=function(e){function t(t,i){var r=e.call(this,i,t)||this;return r.getHelper=function(e){var t,i=r.getSortableElement(e.sender.target);return!!r.isValidTarget(i,r)&&(r.helper?t=r.helper({sender:i,element:e.element}):((t=i.cloneNode(!0)).style.width=i.offsetWidth+"px",t.style.height=i.offsetHeight+"px"),sf.base.addClass([t],["e-sortableclone"]),document.body.appendChild(t),t)},r.onDrag=function(e){if(e.target){r.trigger("drag",{event:e.event,element:r.element,target:e.target});var t,i=r.getSortableInstance(e.target),n=r.getSortableElement(e.target,i);if(!(r.isValidTarget(n,i)||e.target.className.indexOf("e-list-group-item")>-1)||r.curTarget===n&&sf.base.isNullOrUndefined(i.placeHolder)||i.placeHolderElement&&i.placeHolderElement===e.target)r.curTarget!==r.target&&r.scope&&r.curTarget!==n&&!sf.base.isNullOrUndefined(i.placeHolder)&&(sf.base.remove(r.getSortableInstance(r.curTarget).placeHolderElement),r.curTarget=r.target);else{if(e.target.className.indexOf("e-list-group-item")>-1&&(n=e.target),r.curTarget=n,r.target===n)return;var o=r.getIndex(i.placeHolderElement,i),s=r.getPlaceHolder(n,i),a=void 0;if(s){o=sf.base.isNullOrUndefined(o)?r.getIndex(r.target):o,a=r.getIndex(n,i,e.event);var l=r.isPlaceHolderPresent(i);if(l&&o===a)return;l&&sf.base.remove(i.placeHolderElement),i.placeHolderElement=s,e.target.className.indexOf("e-list-group-item")>-1?i.element.insertBefore(i.placeHolderElement,i.element.children[a]):i.element!==r.element&&a===i.element.childElementCount?i.element.appendChild(i.placeHolderElement):i.element.insertBefore(i.placeHolderElement,i.element.children[a]),r.refreshDisabled(o,a,i)}else{o=sf.base.isNullOrUndefined(o)?r.getIndex(r.target):r.getIndex(n,i)<o||!o?o:o-1,a=r.getIndex(n,i);var h=i.element!==r.element?a:o<a?a+1:a;r.updateItemClass(i),i.element.insertBefore(r.target,i.element.children[h]),r.refreshDisabled(o,a,i),r.curTarget=r.target,r.trigger("drop",{droppedElement:r.target,element:i.element,previousIndex:o,currentIndex:a,target:e.target,helper:document.getElementsByClassName("e-sortableclone")[0],event:e.event,scope:r.scope})}}if(i=r.getSortableInstance(r.curTarget),sf.base.isNullOrUndefined(n)&&e.target!==i.placeHolderElement)r.isPlaceHolderPresent(i)&&r.removePlaceHolder(i);else[].slice.call(document.getElementsByClassName("e-sortable-placeholder")).forEach((function(e){(t=r.getSortableInstance(e)).element&&t!==i&&r.removePlaceHolder(t)}))}},r.onDragStart=function(e){r.target=r.getSortableElement(e.target);var t=!1;r.target.classList.add("e-grabbed"),r.curTarget=r.target,e.helper=document.getElementsByClassName("e-sortableclone")[0];var i={cancel:!1,element:r.element,target:r.target};r.trigger("beforeDragStart",i,(function(i){i.cancel&&(t=i.cancel,r.onDragStop(e))})),t||(sf.base.isBlazor?r.trigger("dragStart",{event:e.event,element:r.element,target:r.target,bindEvents:e.bindEvents,dragElement:e.dragElement}):r.trigger("dragStart",{event:e.event,element:r.element,target:r.target}))},r.onDragStop=function(e){var t,i,n,o=r.getSortableInstance(r.curTarget);t=r.getIndex(r.target);var s=r.isPlaceHolderPresent(o);if(s){var a=r.getIndex(o.placeHolderElement,o),l={previousIndex:t,currentIndex:a,target:e.target,droppedElement:r.target,helper:e.helper,cancel:!1,handled:!1};r.trigger("beforeDrop",l,(function(i){if(!i.cancel){if(n=i.handled,r.updateItemClass(o),i.handled){var s=r.target.cloneNode(!0);r.target.classList.remove("e-grabbed"),r.target=s}o.element.insertBefore(r.target,o.placeHolderElement);var a=r.getIndex(r.target,o);t=r===o&&t-a>1?t-1:t,r.trigger("drop",{event:e.event,element:o.element,previousIndex:t,currentIndex:a,target:e.target,helper:e.helper,droppedElement:r.target,scopeName:r.scope,handled:n})}sf.base.remove(o.placeHolderElement)}))}if(o=r.getSortableInstance(e.target),i=o.element.childElementCount,t=r.getIndex(r.target),o.element===e.target||!s&&r.curTarget===r.target){var h={previousIndex:t,currentIndex:r.curTarget===r.target?t:i,target:e.target,droppedElement:r.target,helper:e.helper,cancel:!1};r.trigger("beforeDrop",h,(function(n){o.element!==e.target||n.cancel||(r.updateItemClass(o),o.element.appendChild(r.target),r.trigger("drop",{event:e.event,element:o.element,previousIndex:t,currentIndex:i,target:e.target,helper:e.helper,droppedElement:r.target,scopeName:r.scope}))}))}r.target.classList.remove("e-grabbed"),r.target=null,r.curTarget=null,sf.base.remove(e.helper),sf.base.getComponent(r.element,sf.base.Draggable).intDestroy(e.event)},r.bind(),r}var i;return r(t,e),i=t,t.prototype.bind=function(){this.element.id||(this.element.id=sf.base.getUniqueID("sortable")),this.itemClass||(this.itemClass="e-sort-item",this.dataBind()),this.initializeDraggable()},t.prototype.initializeDraggable=function(){new sf.base.Draggable(this.element,{helper:this.getHelper,dragStart:this.onDragStart,drag:this.onDrag,dragStop:this.onDragStop,dragTarget:"."+this.itemClass,enableTapHold:!0,tapHoldThreshold:200,queryPositionInfo:this.queryPositionInfo,distance:5})},t.prototype.getPlaceHolder=function(e,t){if(t.placeHolder){var i=t.placeHolder({element:t.element,grabbedElement:this.target,target:e});return i.classList.add("e-sortable-placeholder"),i}return null},t.prototype.isValidTarget=function(e,t){return e&&sf.base.compareElementParent(e,t.element)&&e.classList.contains(t.itemClass)&&!e.classList.contains("e-disabled")},t.prototype.removePlaceHolder=function(e){sf.base.remove(e.placeHolderElement),e.placeHolderElement=null},t.prototype.updateItemClass=function(e){this!==e&&(this.target.classList.remove(this.itemClass),this.target.classList.add(e.itemClass))},t.prototype.getSortableInstance=function(e){if(e=sf.base.closest(e,".e-"+this.getModuleName())){var t=sf.base.getComponent(e,i);return t.scope&&this.scope&&t.scope===this.scope?t:this}return this},t.prototype.refreshDisabled=function(e,t,i){if(i===this)for(var r=void 0,n=e<t,o=void 0,s=n?e:t,a=n?t:e;s<=a;)(r=this.element.children[s]).classList.contains("e-disabled")?(o=this.getIndex(r),this.element.insertBefore(r,this.element.children[n?o+2:o-1]),s=n?o+2:o+1):s++},t.prototype.getIndex=function(e,t,i){var r,n;return void 0===t&&(t=this),[].slice.call(t.element.children).forEach((function(t,o){if(t.classList.contains("e-sortable-placeholder")&&(n=!0),t!==e);else if(r=o,!sf.base.isNullOrUndefined(i)){n&&(r-=1);var s=e.getBoundingClientRect(),a=s.bottom-(s.bottom-s.top)/2;r=i.clientY<=a?r:r+1}})),r},t.prototype.getSortableElement=function(e,t){return void 0===t&&(t=this),sf.base.closest(e,"."+t.itemClass)},t.prototype.queryPositionInfo=function(e){return e.left=pageXOffset?parseFloat(e.left)-pageXOffset+"px":e.left,e.top=pageYOffset?parseFloat(e.top)-pageYOffset+"px":e.top,e},t.prototype.isPlaceHolderPresent=function(e){return e.placeHolderElement&&!!sf.base.closest(e.placeHolderElement,"#"+e.element.id)},t.prototype.moveTo=function(e,t,i){s(this.element,e,t,i)},t.prototype.destroy=function(){"e-sort-item"===this.itemClass&&(this.itemClass=null,this.dataBind()),sf.base.getComponent(this.element,sf.base.Draggable).destroy(),e.prototype.destroy.call(this)},t.prototype.getModuleName=function(){return"sortable"},t.prototype.onPropertyChanged=function(e,t){for(var i=0,r=Object.keys(e);i<r.length;i++){switch(r[i]){case"itemClass":[].slice.call(this.element.children).forEach((function(i){i.classList.contains(t.itemClass)&&i.classList.remove(t.itemClass),e.itemClass&&i.classList.add(e.itemClass)}))}}},n([sf.base.Property(!1)],t.prototype,"enableAnimation",void 0),n([sf.base.Property(null)],t.prototype,"itemClass",void 0),n([sf.base.Property(null)],t.prototype,"scope",void 0),n([sf.base.Property()],t.prototype,"helper",void 0),n([sf.base.Property()],t.prototype,"placeHolder",void 0),n([sf.base.Event()],t.prototype,"drag",void 0),n([sf.base.Event()],t.prototype,"beforeDragStart",void 0),n([sf.base.Event()],t.prototype,"dragStart",void 0),n([sf.base.Event()],t.prototype,"beforeDrop",void 0),n([sf.base.Event()],t.prototype,"drop",void 0),t=i=n([sf.base.NotifyPropertyChanges],t)}(sf.base.Base);function s(e,t,i,r){var n=[];if(t||(t=e),i&&i.length?i.forEach((function(t){n.push(e.children[t])})):n=[].slice.call(e.children),sf.base.isNullOrUndefined(r))n.forEach((function(e){t.appendChild(e)}));else{var o=t.children[r];n.forEach((function(e){t.insertBefore(e,o)}))}}return e.Sortable=o,e.moveTo=s,e}({}))},"./modules/splitbuttonsbase.js":function(e,t){function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}window.sf=window.sf||{};window.sf.splitbuttons=window.sf.base.extend({},window.sf.splitbuttons,function(e){"use strict";var t,r=(t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,i)},function(e,i){function r(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}),n=function(e,t,r,n){var o,s=arguments.length,a=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(s<3?o(a):s>3?o(t,r,a):o(t,r))||a);return s>3&&a&&Object.defineProperty(t,r,a),a};var o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),n([sf.base.Property("")],t.prototype,"iconCss",void 0),n([sf.base.Property("")],t.prototype,"id",void 0),n([sf.base.Property(!1)],t.prototype,"separator",void 0),n([sf.base.Property("")],t.prototype,"text",void 0),n([sf.base.Property("")],t.prototype,"url",void 0),n([sf.base.Property(!1)],t.prototype,"disabled",void 0),t}(sf.base.ChildProperty);return e.getModel=function(e,t){for(var i=sf.base.extend({},e),r=0,n=Object.keys(i);r<n.length;r++){var o=n[r];t.indexOf(o)<0&&sf.base.deleteObject(i,o)}return i},e.upDownKeyHandler=function(e,t){var i=40===t?0:e.childElementCount-1,r=i,n=e.querySelector(".e-selected");n&&n.classList.remove("e-selected");for(var o=0,s=e.children.length;o<s;o++)e.children[o].classList.contains("e-focused")&&(r=o,e.children[o].classList.remove("e-focused"),40===t?r++:r--,r===(40===t?e.childElementCount:-1)&&(r=i));-1!==(r=function e(t,i,r,n,o){void 0===o&&(o=0);(i.classList.contains("e-separator")||i.classList.contains("e-disabled"))&&(r===(40===n?t.childElementCount-1:0)?r=40===n?0:t.childElementCount-1:40===n?r++:r--);if((i=t.children[r]).classList.contains("e-separator")||i.classList.contains("e-disabled")){if(++o===t.childElementCount)return r=-1;r=e(t,i,r,n,o)}return r}(e,e.children[r],r,t))&&(sf.base.addClass([e.children[r]],"e-focused"),e.children[r].focus())},e.setBlankIconStyle=function(e,t){var i=[].slice.call(e.getElementsByClassName("e-blank-icon"));if(t&&[].slice.call(e.getElementsByClassName("e-item")).forEach((function(e){(e.style.paddingLeft||e.style.paddingRight)&&e.removeAttribute("style")})),i.length){var r=e.querySelector(".e-item:not(.e-blank-icon):not(.e-separator)");if(!sf.base.isNullOrUndefined(r)){r.classList.contains("e-url")&&(r=r.querySelector(".e-menu-url"));var n,o=r.querySelector(".e-menu-icon"),s=e.classList.contains("e-rtl");n=s?{padding:"paddingRight",margin:"marginLeft"}:{padding:"paddingLeft",margin:"marginRight"};var a=parseInt(getComputedStyle(o).fontSize,10)+parseInt(getComputedStyle(o)[n.margin],10)+parseInt(getComputedStyle(r).paddingLeft,10)+"px";i.forEach((function(e){e.classList.contains("e-url")?e.querySelector(".e-menu-url").style[n.padding]=a:e.style[n.padding]=a}))}}},e.Item=o,e}({}))},"./modules/svgbase.js":function(e,t){function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}window.sf=window.sf||{},window.sf.svgbase=function(e){"use strict";var t=function(){function e(e){this.svgLink="http://www.w3.org/2000/svg",this.rootId=e}return e.prototype.getOptionValue=function(e,t){return e[t]},e.prototype.createSvg=function(e){return sf.base.isNullOrUndefined(e.id)&&(e.id=this.rootId+"_svg"),this.svgObj=document.getElementById(e.id),sf.base.isNullOrUndefined(document.getElementById(e.id))&&(this.svgObj=document.createElementNS(this.svgLink,"svg")),this.svgObj=this.setElementAttributes(e,this.svgObj),this.setSVGSize(e.width,e.height),this.svgObj},e.prototype.setSVGSize=function(e,t){var i=document.getElementById(this.rootId),r=sf.base.isNullOrUndefined(i)?null:i.getBoundingClientRect();sf.base.isNullOrUndefined(this.width)||this.width<=0?this.svgObj.setAttribute("width",e?e.toString():r.width.toString()):this.svgObj.setAttribute("width",this.width.toString()),sf.base.isNullOrUndefined(this.height)||this.height<=0?this.svgObj.setAttribute("height",t?t.toString():"450"):this.svgObj.setAttribute("height",this.height.toString())},e.prototype.drawPath=function(e){var t=document.getElementById(e.id);return null===t&&(t=document.createElementNS(this.svgLink,"path")),t=this.setElementAttributes(e,t)},e.prototype.drawLine=function(e){var t=document.getElementById(e.id);return null===t&&(t=document.createElementNS(this.svgLink,"line")),t=this.setElementAttributes(e,t)},e.prototype.drawRectangle=function(e){var t=document.getElementById(e.id);return null===t&&(t=document.createElementNS(this.svgLink,"rect")),t=this.setElementAttributes(e,t)},e.prototype.drawCircle=function(e){var t=document.getElementById(e.id);return null===t&&(t=document.createElementNS(this.svgLink,"circle")),t=this.setElementAttributes(e,t)},e.prototype.drawPolyline=function(e){var t=document.getElementById(e.id);return null===t&&(t=document.createElementNS(this.svgLink,"polyline")),t=this.setElementAttributes(e,t)},e.prototype.drawEllipse=function(e){var t=document.getElementById(e.id);return null===t&&(t=document.createElementNS(this.svgLink,"ellipse")),t=this.setElementAttributes(e,t)},e.prototype.drawPolygon=function(e){var t=document.getElementById(e.id);return null===t&&(t=document.createElementNS(this.svgLink,"polygon")),t=this.setElementAttributes(e,t)},e.prototype.drawImage=function(e){var t=document.createElementNS(this.svgLink,"image");return t.setAttributeNS(null,"height",e.height.toString()),t.setAttributeNS(null,"width",e.width.toString()),t.setAttributeNS("http://www.w3.org/1999/xlink","href",e.href),t.setAttributeNS(null,"x",e.x.toString()),t.setAttributeNS(null,"y",e.y.toString()),t.setAttributeNS(null,"id",e.id),t.setAttributeNS(null,"visibility",e.visibility),sf.base.isNullOrUndefined(this.getOptionValue(e,"clip-path"))||t.setAttributeNS(null,"clip-path",this.getOptionValue(e,"clip-path")),sf.base.isNullOrUndefined(e.preserveAspectRatio)||t.setAttributeNS(null,"preserveAspectRatio",e.preserveAspectRatio),t},e.prototype.createText=function(e,t){var i=document.createElementNS(this.svgLink,"text");return i=this.setElementAttributes(e,i),sf.base.isNullOrUndefined(t)||(i.textContent=t),i},e.prototype.createTSpan=function(e,t){var i=document.createElementNS(this.svgLink,"tspan");return i=this.setElementAttributes(e,i),sf.base.isNullOrUndefined(t)||(i.textContent=t),i},e.prototype.createTitle=function(e){var t=document.createElementNS(this.svgLink,"title");return t.textContent=e,t},e.prototype.createDefs=function(){return document.createElementNS(this.svgLink,"defs")},e.prototype.createClipPath=function(e){var t=document.createElementNS(this.svgLink,"clipPath");return t=this.setElementAttributes(e,t)},e.prototype.createForeignObject=function(e){var t=document.createElementNS(this.svgLink,"foreignObject");return t=this.setElementAttributes(e,t)},e.prototype.createGroup=function(e){var t=document.createElementNS(this.svgLink,"g");return t=this.setElementAttributes(e,t)},e.prototype.createPattern=function(e,t){var i=document.createElementNS(this.svgLink,t);return i=this.setElementAttributes(e,i)},e.prototype.createRadialGradient=function(e,t,i){var r;if(sf.base.isNullOrUndefined(e[0].colorStop))r=e[0].color.toString();else{var n={id:this.rootId+"_"+t+"radialGradient",cx:i.cx+"%",cy:i.cy+"%",r:i.r+"%",fx:i.fx+"%",fy:i.fy+"%"};this.drawGradient("radialGradient",n,e),r="url(#"+this.rootId+"_"+t+"radialGradient)"}return r},e.prototype.createLinearGradient=function(e,t,i){var r;if(sf.base.isNullOrUndefined(e[0].colorStop))r=e[0].color.toString();else{var n={id:this.rootId+"_"+t+"linearGradient",x1:i.x1+"%",y1:i.y1+"%",x2:i.x2+"%",y2:i.y2+"%"};this.drawGradient("linearGradient",n,e),r="url(#"+this.rootId+"_"+t+"linearGradient)"}return r},e.prototype.drawGradient=function(e,t,i){var r=this.createDefs(),n=document.createElementNS(this.svgLink,e);n=this.setElementAttributes(t,n);for(var o=0;o<i.length;o++){var s=document.createElementNS(this.svgLink,"stop");s.setAttribute("offset",i[o].colorStop),s.setAttribute("stop-color",i[o].color),s.setAttribute("stop-opacity",i[o].opacity?i[o].opacity:"1"),sf.base.isNullOrUndefined(i[o].style)||(s.style.cssText=i[o].style),n.appendChild(s)}return r.appendChild(n),r},e.prototype.drawClipPath=function(e){var t=this.createDefs(),i=this.createClipPath({id:e.id});e.id=e.id+"_Rect";var r=this.drawRectangle(e);return i.appendChild(r),t.appendChild(i),t},e.prototype.drawCircularClipPath=function(e){var t=this.createDefs(),i=this.createClipPath({id:e.id});e.id=e.id+"_Circle";var r=this.drawCircle(e);return i.appendChild(r),t.appendChild(i),t},e.prototype.setElementAttributes=function(e,t){for(var i=Object.keys(e),r=0;r<i.length;r++)"style"===i[r]?t.style.cssText=e[i[r]]:t.setAttribute(i[r],e[i[r]]);return t},e.prototype.createCanvas=function(){return null},e}(),r=function(){function e(e){this.rootId=e}return e.prototype.getOptionValue=function(e,t){return e[t]},e.prototype.createCanvas=function(e){var t=document.createElement("canvas");return t.setAttribute("id",this.rootId+"_canvas"),this.ctx=t.getContext("2d"),this.canvasObj=t,this.setCanvasSize(e.width,e.height),this.canvasObj},e.prototype.setCanvasSize=function(e,t){var i=document.getElementById(this.rootId),r=sf.base.isNullOrUndefined(i)?null:i.getBoundingClientRect();sf.base.isNullOrUndefined(this.width)?this.canvasObj.setAttribute("width",e?e.toString():r.width.toString()):this.canvasObj.setAttribute("width",this.width.toString()),sf.base.isNullOrUndefined(this.height)?this.canvasObj.setAttribute("height",t?t.toString():"450"):this.canvasObj.setAttribute("height",this.height.toString())},e.prototype.setAttributes=function(e){this.ctx.lineWidth=this.getOptionValue(e,"stroke-width");var t=this.getOptionValue(e,"stroke-dasharray");if(!sf.base.isNullOrUndefined(t)){var i=t.split(",");this.ctx.setLineDash([parseInt(i[0],10),parseInt(i[1],10)])}this.ctx.strokeStyle=this.getOptionValue(e,"stroke")},e.prototype.drawLine=function(e){this.ctx.save(),this.ctx.beginPath(),this.ctx.lineWidth=this.getOptionValue(e,"stroke-width"),this.ctx.strokeStyle=e.stroke,this.ctx.moveTo(e.x1,e.y1),this.ctx.lineTo(e.x2,e.y2),this.ctx.stroke(),this.ctx.restore()},e.prototype.drawRectangle=function(e,t){var i=this.ctx,r=e.rx;return this.ctx.save(),this.ctx.beginPath(),t&&this.ctx.translate(t[0],t[1]),this.ctx.globalAlpha=this.getOptionValue(e,"opacity"),this.setAttributes(e),this.ctx.rect(e.x,e.y,e.width,e.height),null!==r&&r>=0?this.drawCornerRadius(e):("none"===e.fill&&(e.fill="transparent"),this.ctx.fillStyle=e.fill,this.ctx.fillRect(e.x,e.y,e.width,e.height),this.ctx.stroke()),this.ctx.restore(),this.ctx=i,this.canvasObj},e.prototype.drawCornerRadius=function(e){var t=e.rx,i=e.x,r=e.y,n=e.width,o=e.height;"none"===e.fill&&(e.fill="transparent"),this.ctx.fillStyle=e.fill,n<2*t&&(t=n/2),o<2*t&&(t=o/2),this.ctx.beginPath(),this.ctx.moveTo(i+n-t,r),this.ctx.arcTo(i+n,r,i+n,r+o,t),this.ctx.arcTo(i+n,r+o,i,r+o,t),this.ctx.arcTo(i,r+o,i,r,t),this.ctx.arcTo(i,r,i+n,r,t),this.ctx.closePath(),this.ctx.fill(),this.ctx.stroke()},e.prototype.drawPath=function(e,t){var i=e.d.split(" "),r=this.getOptionValue(e,"stroke-width"),n=this.ctx,o=!0;this.ctx.save(),this.ctx.beginPath(),t&&this.ctx.translate(t[0],t[1]),this.ctx.globalAlpha=e.opacity?e.opacity:this.getOptionValue(e,"fill-opacity"),this.setAttributes(e);for(var s=0;s<i.length;s+=3){var a=parseFloat(i[s+1]),l=parseFloat(i[s+2]);switch(i[s]){case"M":e.innerR||e.cx||this.ctx.moveTo(a,l);break;case"L":e.innerR||this.ctx.lineTo(a,l);break;case"Q":var h=parseFloat(i[s+3]),d=parseFloat(i[s+4]);this.ctx.quadraticCurveTo(a,l,h,d),s+=2;break;case"C":var c=parseFloat(i[s+3]),p=parseFloat(i[s+4]),u=parseFloat(i[s+5]),g=parseFloat(i[s+6]);this.ctx.bezierCurveTo(a,l,c,p,u,g),s+=4;break;case"A":e.innerR?o&&(this.ctx.arc(e.x,e.y,e.radius,e.start,e.end,e.counterClockWise),this.ctx.arc(e.x,e.y,e.innerR,e.end,e.start,!e.counterClockWise),o=!1):e.cx?this.ctx.arc(e.cx,e.cy,e.radius,0,2*Math.PI,e.counterClockWise):(this.ctx.moveTo(e.x,e.y),this.ctx.arc(e.x,e.y,e.radius,e.start,e.end,e.counterClockWise),this.ctx.lineTo(e.x,e.y)),s+=5;break;case"z":case"Z":this.ctx.closePath(),s-=2}}return"none"!==e.fill&&void 0!==e.fill&&(this.ctx.fillStyle=e.fill,this.ctx.fill()),r>0&&this.ctx.stroke(),this.ctx.restore(),this.ctx=n,this.canvasObj},e.prototype.createText=function(e,t,i,r,n,o){var s=this.getOptionValue(e,"font-weight");sf.base.isNullOrUndefined(s)||"regular"!==s.toLowerCase()||(s="normal");var a=this.getOptionValue(e,"font-size"),l=this.getOptionValue(e,"font-family"),h=this.getOptionValue(e,"font-style").toLowerCase()+" "+s+" "+a+" "+l,d=this.getOptionValue(e,"text-anchor"),c=void 0!==e.opacity?e.opacity:1;if("middle"===d&&(d="center"),this.ctx.save(),this.ctx.fillStyle=e.fill,this.ctx.font=h,this.ctx.textAlign=d,this.ctx.globalAlpha=c,e.baseline&&(this.ctx.textBaseline=e.baseline),!o){this.ctx.translate(e.x+0+(i||0),e.y+(r||0)),this.ctx.rotate(e.labelRotation*Math.PI/180)}return this.ctx.fillText(t,o?e.x:0,o?n:0),this.ctx.restore(),this.canvasObj},e.prototype.drawCircle=function(e,t){var i=this.ctx;return this.ctx.save(),this.ctx.beginPath(),this.ctx.arc(e.cx,e.cy,e.r,0,2*Math.PI),this.ctx.fillStyle=e.fill,this.ctx.globalAlpha=e.opacity,this.ctx.fill(),t&&this.ctx.translate(t[0],t[1]),this.setAttributes(e),this.ctx.stroke(),this.ctx.restore(),this.ctx=i,this.canvasObj},e.prototype.drawPolyline=function(e){this.ctx.save(),this.ctx.beginPath();for(var t=e.points.split(" "),i=0;i<t.length-1;i++){var r=t[i].split(","),n=parseFloat(r[0]),o=parseFloat(r[1]);0===i?this.ctx.moveTo(n,o):this.ctx.lineTo(n,o)}this.ctx.lineWidth=this.getOptionValue(e,"stroke-width"),this.ctx.strokeStyle=e.stroke,this.ctx.stroke(),this.ctx.restore()},e.prototype.drawEllipse=function(e,t){var i=this.ctx,r=Math.max(e.rx,e.ry),n=e.rx/r,o=e.ry/r;this.ctx.save(),this.ctx.beginPath(),this.ctx.translate(e.cx,e.cy),t&&this.ctx.translate(t[0],t[1]),this.ctx.save(),this.ctx.scale(n,o),this.ctx.arc(0,0,r,0,2*Math.PI,!1),this.ctx.fillStyle=e.fill,this.ctx.fill(),this.ctx.restore(),this.ctx.lineWidth=this.getOptionValue(e,"stroke-width"),this.ctx.strokeStyle=e.stroke,this.ctx.stroke(),this.ctx.restore(),this.ctx=i},e.prototype.drawImage=function(e){this.ctx.save();var t=new Image;sf.base.isNullOrUndefined(e.href)||(t.src=e.href,this.ctx.drawImage(t,e.x,e.y,e.width,e.height)),this.ctx.restore()},e.prototype.createLinearGradient=function(e){var t;return sf.base.isNullOrUndefined(e[0].colorStop)||(t=this.ctx.createLinearGradient(0,0,0,this.canvasObj.height)),this.setGradientValues(e,t)},e.prototype.createRadialGradient=function(e){var t;return sf.base.isNullOrUndefined(e[0].colorStop)||(t=this.ctx.createRadialGradient(0,0,0,0,0,this.canvasObj.height)),this.setGradientValues(e,t)},e.prototype.setGradientValues=function(e,t){var i;if(sf.base.isNullOrUndefined(e[0].colorStop))i=e[0].color.toString();else{for(var r=0;r<=e.length-1;r++){var n=e[r].color,o=e[r].colorStop.slice(0,-1),s=parseInt(o,10)/100;t.addColorStop(s,n)}i=t.toString()}return i},e.prototype.setElementAttributes=function(e,t){for(var i=Object.keys(e),r=Object.keys(e).map((function(t){return e[t]})),n=0;n<i.length;n++)t.setAttribute(i[n],r[n]);return null},e.prototype.updateCanvasAttributes=function(e){this.setElementAttributes(e,this.canvasObj);var t=this.ctx;if(!sf.base.isNullOrUndefined(this.dataUrl)){var i=new Image;i.onload=function(){t.drawImage(i,0,0)},i.src=this.dataUrl}},e.prototype.clearRect=function(e){this.ctx.restore(),this.ctx.clearRect(e.x,e.y,e.width,e.height)},e.prototype.createGroup=function(){return null},e.prototype.drawClipPath=function(){return null},e.prototype.drawCircularClipPath=function(){return null},e.prototype.canvasClip=function(e){this.ctx.save(),this.ctx.fillStyle="transparent",this.ctx.rect(e.x,e.y,e.width,e.height),this.ctx.fill(),this.ctx.clip()},e.prototype.canvasRestore=function(){this.ctx.restore()},e.prototype.drawPolygon=function(){return null},e.prototype.createDefs=function(){return null},e.prototype.createClipPath=function(){return null},e.prototype.createSvg=function(){return null},e}();function n(e){var t;switch(e){case"Highcontrast":case"HighContrast":t={tooltipFill:"#ffffff",tooltipBoldLabel:"#000000",tooltipLightLabel:"#000000",tooltipHeaderLine:"#969696"};break;case"MaterialDark":case"FabricDark":case"BootstrapDark":t={tooltipFill:"#F4F4F4",tooltipBoldLabel:"#282727",tooltipLightLabel:"#333232",tooltipHeaderLine:"#9A9A9A"};break;case"Bootstrap4":t={tooltipFill:"#020202",tooltipBoldLabel:"rgba(255, 255, 255)",tooltipLightLabel:"rgba(255, 255, 255, 0.9)",tooltipHeaderLine:"rgba(255, 255, 255, 0.2)"};break;case"Tailwind":t={tooltipFill:"#111827",tooltipBoldLabel:"#D1D5DB",tooltipLightLabel:"#F9FAFB",tooltipHeaderLine:"#6B7280"};break;case"TailwindDark":t={tooltipFill:"#F9FAFB",tooltipBoldLabel:"#6B7280",tooltipLightLabel:"#1F2937",tooltipHeaderLine:"#9CA3AF"};break;case"Bootstrap5":t={tooltipFill:"#212529",tooltipBoldLabel:"#F9FAFB",tooltipLightLabel:"#F9FAFB",tooltipHeaderLine:"#9CA3AF"};break;case"Bootstrap5Dark":t={tooltipFill:"#E9ECEF",tooltipBoldLabel:"#212529",tooltipLightLabel:"#212529",tooltipHeaderLine:"#ADB5BD"};break;case"Fluent":t={tooltipFill:"#FFFFFF",tooltipBoldLabel:"#323130",tooltipLightLabel:"#323130",tooltipHeaderLine:"#D2D0CE"};break;case"FluentDark":t={tooltipFill:"#252423",tooltipBoldLabel:"#F3F2F1",tooltipLightLabel:"#F3F2F1",tooltipHeaderLine:"#3B3A39"};break;default:t={tooltipFill:"#000816",tooltipBoldLabel:"#ffffff",tooltipLightLabel:"#dbdbdb",tooltipHeaderLine:"#ffffff"}}return t}var o,s=(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});function a(e,t){var i=e||"",r=document.getElementById("chartmeasuretext");if(null===r&&(r=sf.base.createElement("text",{id:"chartmeasuretext"}),document.body.appendChild(r)),"string"==typeof e&&(e.indexOf("<")>-1||e.indexOf(">")>-1)){for(var n=e.split(" "),o=0;o<n.length;o++)-1===n[o].indexOf("<br/>")&&(n[o]=n[o].replace(/[<>]/g,"&"));e=n.join(" ")}return r.innerHTML=i.indexOf("<br>")>-1||i.indexOf("<br/>")>-1?i:e,r.style.position="fixed",r.style.fontSize=t.size,r.style.fontWeight=t.fontWeight,r.style.fontStyle=t.fontStyle,r.style.fontFamily=t.fontFamily,r.style.visibility="hidden",r.style.top="-100",r.style.left="0",r.style.whiteSpace="nowrap",r.style.lineHeight="normal",new d(r.clientWidth,r.clientHeight)}function l(e,t,i,r,n){return void 0===r&&(r=0),void 0===n&&(n=0),e>=i.x-r&&e<=i.x+i.width+r&&t>=i.y-n&&t<=i.y+i.height+n}function h(e,t,i,r,n,o,s,a,l,h,d){void 0===d&&(d="");var c="",p=i.x,u=i.y,g=i.x+i.width,f=i.y+i.height;return o?(c=(c=c.concat("M "+p+" "+(u+t)+" Q "+p+" "+u+" "+(p+e)+" "+u+"  L "+(g-e)+" "+u+" Q "+g+" "+u+" "+g+" "+(u+t))).concat(" L "+g+" "+(f-t)+" Q "+g+" "+f+" "+(g-e)+" "+f),0!==n&&(c="RangeNavigator"===d?r.x-n>g/2?(c=c.concat(" L "+(r.x+n)+" "+f)).concat(" L "+(l+n)+" "+(f+n)+" L "+r.x+" "+f):(c=c.concat(" L "+r.x+" "+f)).concat(" L "+(l-n)+" "+(f+n)+" L "+(r.x-n)+" "+f):(c=c.concat(" L "+(r.x+n)+" "+f)).concat(" L "+l+" "+(f+n)+" L "+(r.x-n)+" "+f)),c=r.x-n>p||0===n?c.concat(" L "+(p+e)+" "+f+" Q "+p+" "+f+" "+p+" "+(f-t)+" z"):c.concat(" L "+p+" "+(f+t)+" z")):s?c=(c=(c=(c=(c=c.concat("M "+p+" "+(u+t)+" Q "+p+" "+u+" "+(p+e)+" "+u+" L "+(r.x-n)+" "+u)).concat(" L "+l+" "+r.y)).concat(" L "+(r.x+n)+" "+u)).concat(" L "+(g-e)+" "+u+" Q "+g+" "+u+" "+g+" "+(u+t))).concat(" L "+g+" "+(f-t)+" Q "+g+" "+f+" "+(g-e)+" "+f+" L "+(p+e)+" "+f+" Q "+p+" "+f+" "+p+" "+(f-t)+" z"):a?(c=(c=c.concat("M "+p+" "+(u+t)+" Q "+p+" "+u+" "+(p+e)+" "+u)).concat(" L "+(g-e)+" "+u+" Q "+g+" "+u+" "+g+" "+(u+t)+" L "+g+" "+(r.y-n)),c="RangeNavigator"===d?c.concat(" L "+(g+n)+" "+(h-n)):c.concat(" L "+(g+n)+" "+h),c=(c=(c="RangeNavigator"===d?c.concat(" L "+g+" "+r.y):c.concat(" L "+g+" "+(r.y+n))).concat(" L "+g+" "+(f-t)+" Q "+g+" "+f+" "+(g-e)+" "+f)).concat(" L "+(p+e)+" "+f+" Q "+p+" "+f+" "+p+" "+(f-t)+" z")):(c=c.concat("M "+(p+e)+" "+u+" Q "+p+" "+u+" "+p+" "+(u+t)+" L "+p+" "+(r.y-n)),c="RangeNavigator"===d?c.concat(" L "+(p-n)+" "+(h-n)):c.concat(" L "+(p-n)+" "+h),c=(c=(c="RangeNavigator"===d?c.concat(" L "+p+" "+r.y):c.concat(" L "+p+" "+(r.y+n))).concat(" L "+p+" "+(f-t)+" Q "+p+" "+f+" "+(p+e)+" "+f)).concat(" L "+(g-e)+" "+f+" Q "+g+" "+f+" "+g+" "+(f-t)+" L "+g+" "+(u+t)+" Q "+g+" "+u+" "+(g-e)+" "+u+" z")),c}var d=function(e,t){this.width=e,this.height=t},c=function(e,t,i,r){this.x=e,this.y=t,this.width=i,this.height=r},p=function(e,t){this.isRight=t,this.isBottom=e},u=function(e){this.id=e},g=function(e){function t(t,i,r,n,o,s,a,l){void 0===s&&(s="");var h=e.call(this,t)||this;return h.transform="",h.baseLine="auto",h.labelRotation=0,h.x=i,h.y=r,h.anchor=n,h.text=o,h.transform=s,h.baseLine=a,h.labelRotation=l,h}return s(t,e),t}(u);function f(e){return document.getElementById(e)}function m(e){var t=f(e);t&&sf.base.remove(t)}function y(e,i,r,n,o,s){var a=new t(""),l=v(e,r,i,o,n),h=a["draw"+l.functionName](l.renderOption);return h.setAttribute("aria-label",s),h}function v(e,t,i,r,n){var o,s="Path",a=t.width,l=t.height,h=e.x,d=e.y,c=e.x+-a/2,p=e.y+-l/2;switch(i){case"Circle":case"Bubble":s="Ellipse",sf.base.merge(r,{rx:a/2,ry:l/2,cx:h,cy:d});break;case"Cross":o="M "+c+" "+d+" L "+(h+a/2)+" "+d+" M "+h+" "+(d+l/2)+" L "+h+" "+(d+-l/2),sf.base.merge(r,{d:o});break;case"HorizontalLine":o="M "+c+" "+d+" L "+(h+a/2)+" "+d,sf.base.merge(r,{d:o});break;case"VerticalLine":o="M "+h+" "+(d+l/2)+" L "+h+" "+(d+-l/2),sf.base.merge(r,{d:o});break;case"Diamond":o="M "+c+" "+d+" L "+h+" "+(d+-l/2)+" L "+(h+a/2)+" "+d+" L "+h+" "+(d+l/2)+" L "+c+" "+d+" z",sf.base.merge(r,{d:o});break;case"Rectangle":o="M "+c+" "+(d+-l/2)+" L "+(h+a/2)+" "+(d+-l/2)+" L "+(h+a/2)+" "+(d+l/2)+" L "+c+" "+(d+l/2)+" L "+c+" "+(d+-l/2)+" z",sf.base.merge(r,{d:o});break;case"Triangle":o="M "+c+" "+(d+l/2)+" L "+h+" "+(d+-l/2)+" L "+(h+a/2)+" "+(d+l/2)+" L "+c+" "+(d+l/2)+" z",sf.base.merge(r,{d:o});break;case"InvertedTriangle":o="M "+(h+a/2)+" "+(d-l/2)+" L "+h+" "+(d+l/2)+" L "+(h-a/2)+" "+(d-l/2)+" L "+(h+a/2)+" "+(d-l/2)+" z",sf.base.merge(r,{d:o});break;case"Pentagon":for(var u=void 0,g=void 0,f=0;f<=5;f++)u=a/2*Math.cos(Math.PI/180*(72*f)),g=l/2*Math.sin(Math.PI/180*(72*f)),o=0===f?"M "+(h+u)+" "+(d+g)+" ":o.concat("L "+(h+u)+" "+(d+g)+" ");o=o.concat("Z"),sf.base.merge(r,{d:o});break;case"Image":s="Image",sf.base.merge(r,{href:n,height:l,width:a,x:c,y:p})}return{renderOption:r,functionName:s}}var b=function(e){function t(t,i,r,n,o,s,a){var l=e.call(this,t)||this;return l.opacity=o,l.fill=i,l.stroke=n,l["stroke-width"]=r,l["stroke-dasharray"]=s,l.d=a,l}return s(t,e),t}(u);function w(e,i,r,n){var o,s=new t("");o={id:e.id,x:e.x,y:e.y,fill:r,"font-size":i.size,"font-style":i.fontStyle,"font-family":i.fontFamily,"font-weight":i.fontWeight,"text-anchor":e.anchor,transform:e.transform,opacity:i.opacity,"dominant-baseline":e.baseLine};var a="string"==typeof e.text?e.text:e.text[0],l=s.createText(o,a);return l.style.fontFamily=i.fontFamily,l.style.fontStyle=i.fontStyle,l.style.fontSize=i.size,l.style.fontWeight=i.fontWeight,l.style.color=i.color,n.appendChild(l),l}var x,M=function(e,t){this.x=e,this.y=t},N=(x=function(e,t){return(x=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}x(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),I=function(e,t,r,n){var o,s=arguments.length,a=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(s<3?o(a):s>3?o(t,r,a):o(t,r))||a);return s>3&&a&&Object.defineProperty(t,r,a),a},S=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return N(t,e),I([sf.base.Property(null)],t.prototype,"size",void 0),I([sf.base.Property("")],t.prototype,"color",void 0),I([sf.base.Property("Segoe UI")],t.prototype,"fontFamily",void 0),I([sf.base.Property("Normal")],t.prototype,"fontWeight",void 0),I([sf.base.Property("Normal")],t.prototype,"fontStyle",void 0),I([sf.base.Property(1)],t.prototype,"opacity",void 0),t}(sf.base.ChildProperty),C=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return N(t,e),I([sf.base.Property("")],t.prototype,"color",void 0),I([sf.base.Property(1)],t.prototype,"width",void 0),I([sf.base.Property("")],t.prototype,"dashArray",void 0),t}(sf.base.ChildProperty),O=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return N(t,e),I([sf.base.Property(0)],t.prototype,"x",void 0),I([sf.base.Property(0)],t.prototype,"y",void 0),I([sf.base.Property(0)],t.prototype,"width",void 0),I([sf.base.Property(0)],t.prototype,"height",void 0),t}(sf.base.ChildProperty),T=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return N(t,e),I([sf.base.Property(0)],t.prototype,"x",void 0),I([sf.base.Property(0)],t.prototype,"y",void 0),t}(sf.base.ChildProperty),P=function(e){function i(t,i){return e.call(this,t,i)||this}return N(i,e),i.prototype.preRender=function(){this.allowServerDataBinding=!1,this.initPrivateVariable(),this.isCanvas||this.removeSVG(),this.createTooltipElement()},i.prototype.initPrivateVariable=function(){this.renderer=new t(this.element.id),this.themeStyle=n(this.theme),this.formattedText=[],this.padding=5,this.areaMargin=10,this.isFirst=!0,this.markerPoint=[]},i.prototype.removeSVG=function(){var e=document.getElementById(this.element.id+"_svg"),t=document.getElementById(this.element.id+"parent_template");this.blazorTemplate&&sf.base.resetBlazorTemplate(this.element.id+"parent_template_blazorTemplate"),e&&e.parentNode&&sf.base.remove(e),t&&t.parentNode&&sf.base.remove(t)},i.prototype.render=function(){if(this.fadeOuted=!1,this.template)this.updateTemplateFn(),this.createTemplate(this.areaBounds,this.location);else{this.renderText(this.isFirst);var e={cancel:!1,name:"tooltipRender",tooltip:this};this.trigger("tooltipRender",e);var t=this.renderTooltipElement(this.areaBounds,this.location);this.drawMarker(t.isBottom,t.isRight,this.markerSize)}this.trigger("loaded",{tooltip:this});var i=document.getElementById("chartmeasuretext");i&&sf.base.remove(i),this.allowServerDataBinding=!0},i.prototype.createTooltipElement=function(){if(this.textElements=[],!this.template||this.shared){this.enableRTL&&this.element.setAttribute("dir","ltr");var e=this.renderer.createSvg({id:this.element.id+"_svg"});this.element.appendChild(e);var t=document.getElementById(this.element.id+"_group");t||(t=this.renderer.createGroup({id:this.element.id+"_group"})).setAttribute("transform","translate(0,0)"),e.appendChild(t);var i=this.renderer.drawPath({id:this.element.id+"_path","stroke-width":this.border.width,fill:this.fill||this.themeStyle.tooltipFill,opacity:"TailwindDark"!==this.theme&&"Tailwind"!==this.theme&&"Bootstrap5"!==this.theme&&"Bootstrap5Dark"!==this.theme||.75!==this.opacity?this.opacity:1,stroke:this.border.color});t.appendChild(i)}},i.prototype.drawMarker=function(e,t,i){if(this.shapes.length<=0)return null;for(var r,n=0,o=this.renderer.createGroup({id:this.element.id+"_trackball_group"}),s=f(this.element.id+"_group"),a=(this.enableRTL?this.elementSize.width-i/2:2*this.marginX+i/2)+(t?this.arrowPadding:0),l=0,h=this.shapes;l<h.length;l++){var c=h[l];if("None"!==c){if(r=new b(this.element.id+"_Trackball_"+n,this.palette[n],1,"#cccccc",1,null),this.markerPoint[n]){var p=0;this.header.indexOf("<br")>-1&&(p=this.header.split(/<br.*?>/g).length+n),o.appendChild(y(new M(a,this.markerPoint[n]-this.padding+(e?this.arrowPadding:p)),c,new d(i,i),"",r,null))}n++}}s.appendChild(o)},i.prototype.renderTooltipElement=function(e,t){var i,r=f(this.element.id),n=new M(0,0),o=new M(0,0),s=f(this.element.id+"_svg"),l=f(this.element.id+"_group"),d=f(this.element.id+"_path"),u=!1,g=!1,m=!1,y=0,v=0;if(""!==this.header&&(this.elementSize.height+=this.marginY),this.content.length>1?(i=this.sharedTooltipLocation(e,this.location.x,this.location.y),u=!0):(i=this.tooltipLocation(e,t,n,o),this.inverted?y=(g=i.x<t.x+this.clipBounds.x)?0:this.arrowPadding:(m=!(u=i.y<t.y+this.clipBounds.y),v=u?0:this.arrowPadding)),""!==this.header){var b=2,w=0,x=this.isWrap?this.wrappedText:this.header;if(this.isWrap&&"string"==typeof x&&(x.indexOf("<")>-1||x.indexOf(">")>-1))b=x.split("<br>").length;this.header.indexOf("<br")>-1&&(w=5*(this.header.split(/<br.*?>/g).length-1));var N=a(this.isWrap?this.wrappedText:this.header,this.textStyle).height+this.marginY*b+(m?this.arrowPadding:0)+(this.isWrap?5:w),I="M "+(3*this.marginX+(g||u||m?0:this.arrowPadding))+" "+N+"L "+(i.width+(g||u||m?0:this.arrowPadding)-2*this.marginX)+" "+N,S=this.renderer.drawPath({id:this.element.id+"_header_path","stroke-width":1,fill:null,opacity:.8,stroke:this.themeStyle.tooltipHeaderLine,d:I});l.appendChild(S)}var C=this.border.width/2,O=new c(C+y,C+v,i.width-C,i.height-C);if(l.setAttribute("opacity","1"),!this.enableAnimation||this.isFirst||this.crosshair?this.updateDiv(r,i.x,i.y):this.animateTooltipDiv(r,i),s.setAttribute("height",(i.height+this.border.width+(this.inverted?0:this.arrowPadding)+5).toString()),s.setAttribute("width",(i.width+this.border.width+(this.inverted?this.arrowPadding:0)+5).toString()),s.setAttribute("opacity","1"),sf.base.isNullOrUndefined(this.tooltipPlacement)||(u=this.tooltipPlacement.indexOf("Top")>-1,m=this.tooltipPlacement.indexOf("Bottom")>-1,g=this.tooltipPlacement.indexOf("Left")>-1),d.setAttribute("d",h(this.rx,this.ry,O,n,this.arrowPadding,u,m,g,o.x,o.y,this.controlName)),this.enableShadow&&"Bootstrap4"!==this.theme){var T=this.element.id+"_shadow";"Tailwind"===this.theme||"TailwindDark"===this.theme||"Bootstrap5"===this.theme||"Bootstrap5Dark"===this.theme?d.setAttribute("box-shadow","0px 1px 2px rgba(0, 0, 0, 0.06), 0px 1px 3px rgba(0, 0, 0, 0.1)"):d.setAttribute("filter",sf.base.Browser.isIE?"":"url(#"+T+")");var P='<filter id="'+T+'" height="130%"><feGaussianBlur in="SourceAlpha" stdDeviation="3"/>';P+='<feOffset dx="3" dy="3" result="offsetblur"/><feComponentTransfer><feFuncA type="linear" slope="0.5"/>',P+='</feComponentTransfer><feMerge><feMergeNode/><feMergeNode in="SourceGraphic"/></feMerge></filter>';var A=this.renderer.createDefs();A.setAttribute("id",this.element.id+"SVG_tooltip_definition"),l.appendChild(A),A.innerHTML=P}var L="Fluent"===this.theme?"#FFFFFF":"FluentDark"===this.theme?"#323130":this.border.color;return d.setAttribute("stroke",L),sf.base.isNullOrUndefined(this.border.dashArray)||d.setAttribute("stroke-dasharray",this.border.dashArray),this.changeText(new M(y,v),m,!g&&!u&&!m),this.revert&&(this.inverted=!this.inverted,this.revert=!1),new p(m,!g&&!u&&!m)},i.prototype.changeText=function(e,t,i){var r=document.getElementById(this.element.id+"_text");t&&r.setAttribute("transform","translate(0,"+this.arrowPadding+")"),i&&r.setAttribute("transform","translate("+this.arrowPadding+" 0)")},i.prototype.findFormattedText=function(){this.formattedText=[],""!==this.header.replace(/<b>/g,"").replace(/<\/b>/g,"").trim()&&(this.formattedText=this.formattedText.concat(this.header)),this.formattedText=this.formattedText.concat(this.content)},i.prototype.renderText=function(e){var t,i,r,n,o,s=0,l=0,h=0,c=sf.base.extend({},this.textStyle,null,!0).properties,p=f(this.element.id+"_group"),u="";this.findFormattedText(),this.isWrap=!1;var y="rtl"===document.body.getAttribute("dir")&&!this.enableRTL?"end":"start";this.leftSpace=this.areaBounds.x+this.location.x,this.rightSpace=this.areaBounds.x+this.areaBounds.width-this.leftSpace;var v=this.header.replace(/<b>/g,"").replace(/<\/b>/g,"").trim(),b=this.header.indexOf("<b>")>-1&&this.header.indexOf("</b>")>-1,x=a(this.formattedText[0],c).width+2*this.marginX+this.arrowPadding,M=this.location.x-x<this.location.x,N=this.areaBounds.x+this.areaBounds.width<this.location.x+x,I=""!==v?this.marginY:0,S=!0,C=!0;this.markerPoint=[];var O,T=this.shapes.length>0?10:0,P=this.shapes.length>0?5:0,A="Normal",L=this.themeStyle.tooltipLightLabel,F=22/parseFloat("13px")*parseFloat(c.size),D=[];e&&!this.isCanvas||(m(this.element.id+"_text"),m(this.element.id+"_header_path"),m(this.element.id+"_trackball_group"),m(this.element.id+"SVG_tooltip_definition"));for(var E=new g(this.element.id+"_text",2*this.marginX,2*this.marginY+2*this.padding+(2===this.marginY?3:0),y,""),z=w(E,c,null,p),k=1===this.formattedText.length&&this.formattedText[0].indexOf(" : <b>")>-1,W=""!==this.header,R=W&&b?16:13,j=0,U=this.formattedText.length;j<U;j++)if(r=this.formattedText[j].replace(/<(b|strong)>/g,"<b>").replace(/<\/(b|strong)>/g,"</b>").split(/<br.*?>/g),0===j&&!k&&this.isTextWrap&&(this.leftSpace<x||M)&&(this.rightSpace<x||N)&&(O=Math.round(this.leftSpace>this.rightSpace?this.leftSpace/R:this.rightSpace/R),r=(""!==v?v:this.formattedText[j]).match(new RegExp(".{1,"+O+"}","g")),this.wrappedText=b?"<b>"+r.join("<br>")+"</b>":r.join("<br>"),this.isWrap=r.length>1),""!==r[0]){0===j&&""!==v||this.markerPoint.push((""!==v?this.marginY:0)+E.y+s);for(var H=0,B=r.length;H<B;H++){t=r[H].replace(/<b>/g,"<br><b>").replace(/<\/b>/g,"</b><br>").replace(/:/g,this.enableRTL?"<br>‎: <br>":"<br>‎:<br>").split("<br>"),this.enableRTL&&t.length>0&&r[H].match(/:/g)&&(t[0]=t[0].trim(),t.reverse()),h=0,C=!0,s+=F;for(var _=0,V=t.length;_<V;_++)n=t[_],this.enableRTL&&""!==n&&this.isRTLText(n)&&(n=n.concat("‎")),/\S/.test(n)||""===n||(n=" "),(!C&&" "===n||""!==n.replace(/<b>/g,"").replace(/<\/b>/g,"").trim())&&(h+=" "!==n?4:0,C&&!S?(this.header.indexOf("<br")>-1&&0!==j&&(I+=this.header.split(/<br.*?>/g).length),o={x:2*this.marginX+(T+P),dy:F+(C?I:0),fill:""},I=null):o=S&&C?{x:""===v?2*this.marginX+(T+P):2*this.marginX+(this.isWrap?T+P:0)}:{},C=!1,i=this.renderer.createTSpan(o,""),z.appendChild(i),n.indexOf("<b>")>-1||b&&0===_&&0===j&&(W||this.isWrap)?(A="bold",L=this.themeStyle.tooltipBoldLabel,u="font-weight:"+A,c.fontWeight=A,i.setAttribute("fill",this.textStyle.color||L)):(u="bold"===A?"font-weight:"+A:"",c.fontWeight=A,i.setAttribute("fill",this.textStyle.color||L)),(n.indexOf("</b>")>-1||b&&_===V-1&&0===j&&(W||this.isWrap))&&(A="Normal",L=this.themeStyle.tooltipLightLabel),i.textContent=n=this.getTooltipTextContent(n),h+=a(n,c).width,""!==u&&(i.style.fontWeight=u.split("font-weight:")[1],i.style.color=i.getAttribute("fill")),i.style.fontFamily="inherit",i.style.fontStyle="inherit",i.style.fontSize="inherit",S=!1);h-=4,l=Math.max(l,h),D.push(h)}}this.elementSize=new d(l+(l>0?2*this.marginX:0),s),this.elementSize.width+=T+P;var Y=z.childNodes[0];if(""!==v&&Y&&!this.isWrap){c.fontWeight="bold";var Q=(this.elementSize.width+2*this.padding)/2-a(v,c).width/2;Y.setAttribute("x",Q.toString())}this.renderContentRTL(z,W,T+P,D)},i.prototype.renderContentRTL=function(e,t,i,r){if(this.enableRTL)for(var n=void 0,o=t?1:0,s=0;s<e.childNodes.length;s++)n=e.childNodes[s],t&&!(s>0)||sf.base.isNullOrUndefined(n.getAttribute("x"))||(n.setAttribute("x",(this.elementSize.width-(i+r[o])).toString()),o++)},i.prototype.getTooltipTextContent=function(e){var t=e.match(/<[a-zA-Z\/](.|\n)*?>/g);if(sf.base.isNullOrUndefined(t))return e;for(var i=this.isRTLText(e),r=0;r<t.length;r++)this.isValidHTMLElement(t[r].replace("<","").replace("/","").replace(">","").trim())&&(e=e.replace(t[r],i?"‎":""));return e},i.prototype.isValidHTMLElement=function(e){return"[object HTMLUnknownElement]"!=document.createElement(e).toString()},i.prototype.isRTLText=function(e){return/[\u0590-\u07FF\u200F\u202B\u202E\uFB1D-\uFDFD\uFE70-\uFEFC]/.test(e)},i.prototype.createTemplate=function(e,t){var i={cancel:!1,name:"tooltipRender",tooltip:this};this.trigger("tooltipRender",i);var r=document.getElementById(this.element.id);this.isCanvas&&this.removeSVG();var n=r.firstElementChild;if(n&&sf.base.remove(n),i.cancel)sf.base.remove(f(this.element.id+"_tooltip"));else{for(var o=sf.base.createElement("div",{id:this.element.id+"parent_template"}),s=this.templateFn(this.data,this.controlInstance,o.id,o.id+"_blazorTemplate","");s&&s.length>0;)sf.base.isBlazor()||1===s.length?(o.appendChild(s[0]),s=null):o.appendChild(s[0]);r.appendChild(o);var a=this.isCanvas?o:this.element,l=a.getBoundingClientRect();this.padding=0,this.elementSize=new d(l.width,l.height);var h=this.shared?this.sharedTooltipLocation(e,this.location.x,this.location.y):this.tooltipLocation(e,t,new M(0,0),new M(0,0));if(!this.enableAnimation||this.isFirst||this.crosshair?this.updateDiv(a,h.x,h.y):this.animateTooltipDiv(this.element,h),this.blazorTemplate){var c=function(){var i=f(p.element.id).getBoundingClientRect();p.elementSize=new d(i.width,i.height);var r=p.tooltipLocation(e,t,new M(0,0),new M(0,0));p.updateDiv(f(p.element.id),r.x,r.y)},p=this;c.bind(p,e,t),sf.base.updateBlazorTemplate(this.element.id+"parent_template_blazorTemplate",this.blazorTemplate.name,this.blazorTemplate.parent,void 0,c)}}},i.prototype.sharedTooltipLocation=function(e,t,i){var r=this.elementSize.width+2*this.marginX,n=this.elementSize.height+2*this.marginY,o=new c(t+2*this.padding,i-n-this.padding,r,n);return o.y<e.y&&(o.y+=o.height+2*this.padding),o.x+o.width>e.x+e.width&&(o.x-=o.width+4*this.padding),o.x<e.x&&(o.x=e.x),o},i.prototype.getCurrentPosition=function(e,t,i,r){var n=this.tooltipPlacement,o=this.clipBounds.x,s=this.clipBounds.y,a=this.offset,l=this.elementSize.width+2*this.marginX,h=this.elementSize.height+2*this.marginY,d=new M(t.x,t.y);return"Top"===n||"Bottom"===n?(d=new M(d.x+o-this.elementSize.width/2-this.padding,d.y+s-this.elementSize.height-2*this.padding-this.arrowPadding-a),i.x=r.x=l/2,"Bottom"===n&&(d.y=t.y+s+a),e.x+e.width<d.x+l?(d.x=e.width>l?e.x+e.width-l+6:e.x,i.x=r.x=e.width>l?e.x+t.x-d.x:t.x):e.x>d.x&&(d.x=e.x,i.x=r.x=t.x)):(d=new M(d.x+o+a,d.y+s-this.elementSize.height/2-this.padding),i.y=r.y=h/2,"Left"===n&&(d.x=t.x+o-a-(l+this.arrowPadding)),e.y+e.height<d.y+h?(d.y=e.height>h?e.y+e.height-h+6:e.y,i.y=r.y=e.height>h?e.y+t.y-d.y:t.y):e.y>d.y&&(d.y=e.y,i.y=r.y=t.y)),new c(d.x,d.y,l,h)},i.prototype.tooltipLocation=function(e,t,i,r){if(!sf.base.isNullOrUndefined(this.tooltipPlacement))return this.getCurrentPosition(e,t,i,r);var n=new M(t.x,t.y),o=this.elementSize.width+2*this.marginX,s=this.elementSize.height+2*this.marginY,a=this.offset,h=this.clipBounds.x,d=this.clipBounds.y,p=e.x,u=e.y;return this.outOfBounds=!1,this.inverted?(n=new M(n.x+h+a,n.y+d-this.elementSize.height/2-this.padding),i.y=r.y=s/2,(n.x+o+this.arrowPadding>p+e.width||this.isNegative)&&(n.x=(t.x>e.width+e.x?e.width:t.x)+h-a-(o+this.arrowPadding)),n.x<p&&(n.x=(t.x<0?0:t.x)+h+a),n.y<=u&&(i.y-=u-n.y,r.y-=u-n.y,n.y=u),n.y+s>=u+e.height&&(i.y+=n.y+s-(u+e.height),r.y+=n.y+s-(u+e.height),n.y-=n.y+s-(u+e.height)),i.y+this.arrowPadding>s-this.ry&&(i.y=s-this.ry-this.arrowPadding,r.y=s),i.y-this.arrowPadding<this.ry&&(i.y=r.y=this.ry+this.arrowPadding),"Chart"===this.controlName&&((n.y+i.y<this.areaMargin+this.arrowPadding||e.y+e.height-(n.y+i.y)<this.areaMargin+this.arrowPadding)&&(this.outOfBounds=!0),l(n.x,n.y,e)&&!this.outOfBounds||(this.inverted=!this.inverted,n=new M(t.x+h-this.padding-this.elementSize.width/2,t.y+d-this.elementSize.height-2*this.padding-a-this.arrowPadding),this.revert=!0,r.x=i.x=o/2,r.y=i.y=0,(n.y<u||this.isNegative)&&(n.y=(t.y<0?0:t.y)+a+d),n.y+this.arrowPadding+s>u+e.height&&(n.y=Math.min(t.y,u+e.height)+d-this.elementSize.height-2*this.padding-a-this.arrowPadding),r.x=o/2,n.x<p&&(r.x-=p-n.x,i.x-=p-n.x,n.x=p),n.x+o>e.width+p&&(i.x+=n.x+o-(e.width+p),r.x+=n.x+o-(e.width+p),n.x-=n.x+o-(e.width+p)),this.arrowPadding+i.x>o-this.rx&&(r.x=o-this.rx-this.arrowPadding,i.x=o-this.rx-this.arrowPadding),i.x-this.arrowPadding<this.rx&&(i.x=r.x=this.rx+this.arrowPadding)))):(n=new M(n.x+h-this.elementSize.width/2-this.padding,n.y+d-this.elementSize.height-2*this.padding-this.arrowPadding-a),i.x=r.x=o/2,(n.y<u||this.isNegative)&&(n.y=(t.y<0?0:t.y)+d+a),n.y+s+this.arrowPadding>u+e.height&&(n.y=Math.min(t.y,u+e.height)+d-this.elementSize.height-2*this.padding-this.arrowPadding-a),r.x=o/2,n.x<p&&(i.x-=p-n.x,r.x-=p-n.x,n.x=p),n.x+o>p+e.width&&(i.x+=n.x+o-(p+e.width),r.x+=n.x+o-(p+e.width),n.x-=n.x+o-(p+e.width)),i.x+this.arrowPadding>o-this.rx&&(i.x=o-this.rx-this.arrowPadding,r.x=o-this.rx-this.arrowPadding),i.x-this.arrowPadding<this.rx&&(i.x=r.x=this.rx+this.arrowPadding),"Chart"===this.controlName&&((e.x+e.width-(n.x+i.x)<this.areaMargin+this.arrowPadding||n.x+i.x<this.areaMargin+this.arrowPadding)&&(this.outOfBounds=!0),l(n.x,n.y,e)&&!this.outOfBounds||(this.inverted=!this.inverted,this.revert=!0,n=new M(t.x+a+h,t.y+d-this.elementSize.height/2-this.padding),r.x=i.x=0,r.y=i.y=s/2,(n.x+this.arrowPadding+o>p+e.width||this.isNegative)&&(n.x=(t.x>e.width?e.width:t.x)+h-a-(this.arrowPadding+o)),n.x<p&&(n.x=(t.x<0?0:t.x)+a+h),n.y<=u&&(r.y-=u-n.y,i.y-=u-n.y,n.y=u),n.y+s>=e.height+u&&(i.y+=n.y+s-(e.height+u),r.y+=n.y+s-(e.height+u),n.y-=n.y+s-(e.height+u)),this.arrowPadding+i.y>s-this.ry&&(i.y=s-this.arrowPadding-this.ry,r.y=s),i.y-this.arrowPadding<this.ry&&(i.y=this.arrowPadding+this.ry,r.y=0)))),new c(n.x,n.y,o,s)},i.prototype.animateTooltipDiv=function(e,t){var i,r=this,n=parseFloat(e.style.left),o=parseFloat(e.style.top);new sf.base.Animation({}).animate(e,{duration:this.duration,progress:function(s){i=s.timeStamp/s.duration,e.style.animation=null,"Chart"===r.controlName&&r.shared&&!r.enableRTL?(e.style.transition="transform 0.1s",e.style.transform="translate("+(n+i*(t.x-n))+"px,"+(o+i*(t.y-o))+"px)"):(e.style.left=n+i*(t.x-n)+"px",e.style.top=o+i*(t.y-o)+"px")},end:function(i){r.updateDiv(e,t.x,t.y),r.trigger("animationComplete",{tooltip:r})}})},i.prototype.updateDiv=function(e,t,i){"Chart"!==this.controlName||!this.shared||this.crosshair||this.enableRTL?(e.style.left=t+"px",e.style.top=i+"px"):e.style.transform="translate("+t+"px,"+i+"px)"},i.prototype.updateTemplateFn=function(){if(this.template)try{document.querySelectorAll(this.template).length?this.templateFn=sf.base.compile(document.querySelector(this.template).innerHTML.trim()):this.templateFn=sf.base.compile(this.template)}catch(e){this.templateFn=sf.base.compile(this.template)}},i.prototype.fadeOut=function(){var e=this,t=this.isCanvas&&!this.template?f(this.element.id+"_svg"):f(this.element.id),i=f(this.element.id);if(t){var r=t.firstChild;if(r.nodeType!=Node.ELEMENT_NODE&&(r=t.firstElementChild),this.isCanvas&&!this.template&&(r=document.getElementById(this.element.id+"_group")?document.getElementById(this.element.id+"_group"):r),!r)return null;var n=parseFloat(r.getAttribute("opacity"));n=sf.base.isNullOrUndefined(n)?1:n,new sf.base.Animation({}).animate(r,{duration:200,progress:function(t){e.progressAnimation(r,n,t.timeStamp/t.duration)},end:function(){e.fadeOuted=!0,e.endAnimation(r),i.style.transition=""}})}},i.prototype.progressAnimation=function(e,t,i){e.style.animation="",e.setAttribute("opacity",(t-i).toString())},i.prototype.endAnimation=function(e){e.setAttribute("opacity","0"),this.template&&(e.style.display="none"),this.trigger("animationComplete",{tooltip:this})},i.prototype.getPersistData=function(){return this.addOnPersist([])},i.prototype.getModuleName=function(){return"tooltip"},i.prototype.destroy=function(){e.prototype.destroy.call(this),this.element.classList.remove("e-tooltip")},i.prototype.onPropertyChanged=function(e,t){this.blazorTemplate&&sf.base.resetBlazorTemplate(this.element.id+"parent_template_blazorTemplate"),this.isFirst=!1,this.render()},I([sf.base.Property(!1)],i.prototype,"enable",void 0),I([sf.base.Property(!1)],i.prototype,"shared",void 0),I([sf.base.Property(!1)],i.prototype,"crosshair",void 0),I([sf.base.Property(!0)],i.prototype,"enableShadow",void 0),I([sf.base.Property(null)],i.prototype,"fill",void 0),I([sf.base.Property("")],i.prototype,"header",void 0),I([sf.base.Property(.75)],i.prototype,"opacity",void 0),I([sf.base.Complex({size:"13px",fontWeight:"Normal",color:null,fontStyle:"Normal",fontFamily:"Segoe UI"},S)],i.prototype,"textStyle",void 0),I([sf.base.Property(null)],i.prototype,"template",void 0),I([sf.base.Property(!0)],i.prototype,"enableAnimation",void 0),I([sf.base.Property(300)],i.prototype,"duration",void 0),I([sf.base.Property(!1)],i.prototype,"inverted",void 0),I([sf.base.Property(!1)],i.prototype,"isNegative",void 0),I([sf.base.Complex({color:"#cccccc",width:.5},C)],i.prototype,"border",void 0),I([sf.base.Property([])],i.prototype,"content",void 0),I([sf.base.Property(10)],i.prototype,"markerSize",void 0),I([sf.base.Complex({x:0,y:0},T)],i.prototype,"clipBounds",void 0),I([sf.base.Property([])],i.prototype,"palette",void 0),I([sf.base.Property([])],i.prototype,"shapes",void 0),I([sf.base.Complex({x:0,y:0},T)],i.prototype,"location",void 0),I([sf.base.Property(0)],i.prototype,"offset",void 0),I([sf.base.Property(4)],i.prototype,"rx",void 0),I([sf.base.Property(4)],i.prototype,"ry",void 0),I([sf.base.Property(5)],i.prototype,"marginX",void 0),I([sf.base.Property(5)],i.prototype,"marginY",void 0),I([sf.base.Property(7)],i.prototype,"arrowPadding",void 0),I([sf.base.Property(null)],i.prototype,"data",void 0),I([sf.base.Property("Material")],i.prototype,"theme",void 0),I([sf.base.Complex({x:0,y:0,width:0,height:0},O)],i.prototype,"areaBounds",void 0),I([sf.base.Property(null)],i.prototype,"availableSize",void 0),I([sf.base.Property()],i.prototype,"blazorTemplate",void 0),I([sf.base.Property(!1)],i.prototype,"isCanvas",void 0),I([sf.base.Property(!1)],i.prototype,"isTextWrap",void 0),I([sf.base.Property(null)],i.prototype,"tooltipPlacement",void 0),I([sf.base.Property(null)],i.prototype,"controlInstance",void 0),I([sf.base.Property("")],i.prototype,"controlName",void 0),I([sf.base.Event()],i.prototype,"tooltipRender",void 0),I([sf.base.Event()],i.prototype,"loaded",void 0),I([sf.base.Event()],i.prototype,"animationComplete",void 0),I([sf.base.Property(!1)],i.prototype,"enableRTL",void 0),i=I([sf.base.NotifyPropertyChanges],i)}(sf.base.Component);return e.TextStyle=S,e.TooltipBorder=C,e.AreaBounds=O,e.ToolLocation=T,e.Tooltip=P,e.getTooltipThemeColor=n,e.measureText=a,e.withInAreaBounds=l,e.findDirection=h,e.Size=d,e.Rect=c,e.Side=p,e.CustomizeOption=u,e.TextOption=g,e.getElement=f,e.removeElement=m,e.drawSymbol=y,e.calculateShapes=v,e.PathOption=b,e.textElement=w,e.TooltipLocation=M,e.SvgRenderer=t,e.CanvasRenderer=r,e},sf.svgbase=sf.svgbase({})},"./modules/syncfusion-blazor-extended.js":function(e,t,i){"use strict";i("./syncfusion-blazor-extended.js")},"./single-documenteditor-bundle.js":function(e,t,i){"use strict";i.r(t);i("./modules/base.js"),i("./syncfusion-blazor.js"),i("./modules/syncfusion-blazor-extended.js"),i("./modules/popup.js"),i("./modules/popupsbase.js"),i("./modules/navigationsbase.js"),i("./modules/splitbuttonsbase.js"),i("./modules/sortable.js"),i("./modules/data.js"),i("./modules/svgbase.js"),i("./modules/fileutils.js"),i("./modules/compression.js"),i("./modules/chart.js"),i("./modules/accumulationchart.js"),i("./modules/officechart.js"),i("./modules/sf-textbox.js"),i("./modules/sf-spinner.js"),i("./modules/sf-listview.js"),i("./modules/sf-tab.js"),i("./modules/sf-colorpicker.js"),i("./modules/sf-numerictextbox.js"),i("./modules/sf-drop-down-button.js"),i("./modules/sf-dialog.js"),i("./modules/sf-dropdownlist.js"),i("./modules/sf-datepicker.js"),i("./modules/sf-toolbar.js"),i("./modules/sf-contextmenu.js"),i("./modules/sf-listbox.js"),i("./modules/sf-documenteditor.js"),i("./modules/sf-documenteditorcontainer.js")},"./syncfusion-blazor-extended.js":function(module,exports){function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,_toPropertyKey(r.key),r)}}function _createClass(e,t,i){return t&&_defineProperties(e.prototype,t),i&&_defineProperties(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"===_typeof(t)?t:String(t)}function _toPrimitive(e,t){if("object"!==_typeof(e)||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!==_typeof(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper(e){var t=_isNativeReflectConstruct();return function(){var i,r=_getPrototypeOf(e);if(t){var n=_getPrototypeOf(this).constructor;i=Reflect.construct(r,arguments,n)}else i=r.apply(this,arguments);return _possibleConstructorReturn(this,i)}}function _possibleConstructorReturn(e,t){if(t&&("object"===_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?_arrayLikeToArray(e,t):void 0}}function _iterableToArray(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,r=new Array(t);i<t;i++)r[i]=e[i];return r}function _regeneratorRuntime(){"use strict";/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */_regeneratorRuntime=function(){return e};var e={},t=Object.prototype,i=t.hasOwnProperty,r=Object.defineProperty||function(e,t,i){e[t]=i.value},n="function"==typeof Symbol?Symbol:{},o=n.iterator||"@@iterator",s=n.asyncIterator||"@@asyncIterator",a=n.toStringTag||"@@toStringTag";function l(e,t,i){return Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,i){return e[t]=i}}function h(e,t,i,n){var o=t&&t.prototype instanceof p?t:p,s=Object.create(o.prototype),a=new S(n||[]);return r(s,"_invoke",{value:x(e,i,a)}),s}function d(e,t,i){try{return{type:"normal",arg:e.call(t,i)}}catch(e){return{type:"throw",arg:e}}}e.wrap=h;var c={};function p(){}function u(){}function g(){}var f={};l(f,o,(function(){return this}));var m=Object.getPrototypeOf,y=m&&m(m(C([])));y&&y!==t&&i.call(y,o)&&(f=y);var v=g.prototype=p.prototype=Object.create(f);function b(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function w(e,t){var n;r(this,"_invoke",{value:function(r,o){function s(){return new t((function(n,s){!function r(n,o,s,a){var l=d(e[n],e,o);if("throw"!==l.type){var h=l.arg,c=h.value;return c&&"object"==_typeof(c)&&i.call(c,"__await")?t.resolve(c.__await).then((function(e){r("next",e,s,a)}),(function(e){r("throw",e,s,a)})):t.resolve(c).then((function(e){h.value=e,s(h)}),(function(e){return r("throw",e,s,a)}))}a(l.arg)}(r,o,n,s)}))}return n=n?n.then(s,s):s()}})}function x(e,t,i){var r="suspendedStart";return function(n,o){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===n)throw o;return O()}for(i.method=n,i.arg=o;;){var s=i.delegate;if(s){var a=M(s,i);if(a){if(a===c)continue;return a}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if("suspendedStart"===r)throw r="completed",i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);r="executing";var l=d(e,t,i);if("normal"===l.type){if(r=i.done?"completed":"suspendedYield",l.arg===c)continue;return{value:l.arg,done:i.done}}"throw"===l.type&&(r="completed",i.method="throw",i.arg=l.arg)}}}function M(e,t){var i=t.method,r=e.iterator[i];if(void 0===r)return t.delegate=null,"throw"===i&&e.iterator.return&&(t.method="return",t.arg=void 0,M(e,t),"throw"===t.method)||"return"!==i&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+i+"' method")),c;var n=d(r,e.iterator,t.arg);if("throw"===n.type)return t.method="throw",t.arg=n.arg,t.delegate=null,c;var o=n.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,c):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,c)}function N(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function I(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function S(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(N,this),this.reset(!0)}function C(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,n=function t(){for(;++r<e.length;)if(i.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return n.next=n}}return{next:O}}function O(){return{value:void 0,done:!0}}return u.prototype=g,r(v,"constructor",{value:g,configurable:!0}),r(g,"constructor",{value:u,configurable:!0}),u.displayName=l(g,a,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===u||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,g):(e.__proto__=g,l(e,a,"GeneratorFunction")),e.prototype=Object.create(v),e},e.awrap=function(e){return{__await:e}},b(w.prototype),l(w.prototype,s,(function(){return this})),e.AsyncIterator=w,e.async=function(t,i,r,n,o){void 0===o&&(o=Promise);var s=new w(h(t,i,r,n),o);return e.isGeneratorFunction(i)?s:s.next().then((function(e){return e.done?e.value:s.next()}))},b(v),l(v,a,"Generator"),l(v,o,(function(){return this})),l(v,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),i=[];for(var r in t)i.push(r);return i.reverse(),function e(){for(;i.length;){var r=i.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},e.values=C,S.prototype={constructor:S,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(I),!e)for(var t in this)"t"===t.charAt(0)&&i.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(i,r){return s.type="throw",s.arg=e,t.next=i,r&&(t.method="next",t.arg=void 0),!!r}for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n],s=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var a=i.call(o,"catchLoc"),l=i.call(o,"finallyLoc");if(a&&l){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(a){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&i.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=e,s.arg=t,o?(this.method="next",this.next=o.finallyLoc,c):this.complete(s)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),c},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var i=this.tryEntries[t];if(i.finallyLoc===e)return this.complete(i.completion,i.afterLoc),I(i),c}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var i=this.tryEntries[t];if(i.tryLoc===e){var r=i.completion;if("throw"===r.type){var n=r.arg;I(i)}return n}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,i){return this.delegate={iterator:C(e),resultName:t,nextLoc:i},"next"===this.method&&(this.arg=void 0),c}},e}function asyncGeneratorStep(e,t,i,r,n,o,s){try{var a=e[o](s),l=a.value}catch(e){return void i(e)}a.done?t(l):Promise.resolve(l).then(r,n)}function _asyncToGenerator(e){return function(){var t=this,i=arguments;return new Promise((function(r,n){var o=e.apply(t,i);function s(e){asyncGeneratorStep(o,r,n,s,a,"next",e)}function a(e){asyncGeneratorStep(o,r,n,s,a,"throw",e)}s(void 0)}))}}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var extended={modules:{},tempCallBacks:[],dataSourceProperties:["dataSource","dataSource_custom","shapeData"],enableRtl:function(e){sf.base.enableRtl(e)},loadCldr:function(e){sf.base.loadCldr(JSON.parse(e))},setCulture:function(e,t){sf.base.setCulture(e),sf.base.extend(sf.base.blazorCultureFormats,t)},convertOptions:function(e,t){var i={};for(var r in e){for(var n=r.trim().split("."),o=i,s=0;s<n.length-1;s++){var a=n[s].match(/^(\w+)\[(\d+)\]$/);if(a){var l=o[a[1]];l||(l=o[a[1]]=[]),o=l[a[2]]=l[a[2]]||{}}else o=o[n[s]]=o[n[s]]||{}}o[n[s]]=e[r],t&&delete e[r]}return i},convertInitialOptions:function(e){return e=sfBlazor.convertOptions(JSON.parse(e),!0),JSON.stringify(e)},initialize:function(e,t,i,r,n,o,s,a,l){try{if(null==r)return;if("sf.popups.Spinner"==r)return;sf.base.enableBlazorMode(),!window.BlazorAdaptor&&sf.data&&"object"===_typeof(sf.data)&&sfBlazor.initBlazorAdaptor(),t=sfBlazor.convertInitialOptions(t);var h={dotnetInstance:n,templateRefs:a};(t=JSON.parse(t,sfBlazor.parseRevive.bind(h))).elementID="_ejs"+e;var d=sf.base.getValue(r,window);if(sfBlazor.bindEvents(t,i,n,r),d)var c=new d(t);if(c){if(c.isServerRendered=!0,c._dotnetInstance=n,c.templateDotnetInstance=a,c.interopAdaptor=l,c.bindableProps=o=JSON.parse(o),s){var p=document.getElementById(e);for(var u in s)p.setAttribute(u,s[u])}"sf.pdfviewer.PdfViewer"==r&&null==c.serviceUrl&&(sf.pdfviewer.AjaxHandler.prototype.send=sfBlazor.requestHandler.bind(c)),"sf.documenteditor.DocumentEditorContainer"!=r&&"sf.documenteditor.DocumentEditor"!=r||null!=c.serviceUrl&&""!=c.serviceUrl&&null!=c.serviceUrl||(sf.documenteditor.XmlHttpRequestHandler.prototype.send=sfBlazor.docEditRequestHandler.bind(c)),c.appendTo("#"+e)}}catch(e){sfBlazor.throwError(e,r)}},renderComplete:function(e,t){null!=e&&(window[e]&&(window[e.id]instanceof e||window[e.id]instanceof HTMLElement)&&delete window[e.id],e.classList.remove("e-blazor-hidden"))},isDataSourceProperty:function(e){return-1!==sfBlazor.dataSourceProperties.indexOf(e)},setModel:function(e,t,i){try{var r=document.getElementById(e);if(!r)return;var n,o=r.ej2_instances[0];o.preventUpdate=!0,sfBlazor.updateOldProperties(o,t);var s={dotnetInstance:o._dotnetInstance};n=sfBlazor.getCompObject(o,t,s,i),o.setProperties(n),o.dataBind(),o.preventUpdate=!1}catch(e){window.sfBlazor.throwError(e,o)}},getCompObject:function(e,t,i,r){var n=sfBlazor.getModelObject(e,t,i,!1);if(n){for(var o=Object.keys(n),s=0;s<o.length;s++){var a=o[s],l=e[a],h=n[a],d=l&&l.isComplexArray,c=h&&"object"===_typeof(h)&&Object.keys(h)[0];if((l instanceof sf.base.ChildProperty||d)&&!isNaN(c)){var p,u=h[c];if(!Array.isArray(h)&&u&&u.isNewComponent){var g=a.charAt(0).toUpperCase()+a.substr(1,a.length),f=r.split(".").splice(0,2).join(".")+"."+g,m=sf.base.getValue(f,window);m&&(p=sf.base.createInstance(m,[e,a,u,d]))}p&&(n[a][c]=p,e[a]&&Array.isArray(e[a])&&e[a].filter((function(e,t){c!==t&&(n[a][t]=e)})))}}return n}},getModelObject:function(e,t,i,r){for(var n={},o=t.match(/"(.*?)":/g),s=0;s<o.length;s++){var a=o[s].replace(":","").replace(/"/g,""),l=sfBlazor.convertInitialOptions(t),h=r?sf.base.getValue(a,e):sf.base.getValue(a,JSON.parse(l,sfBlazor.parseRevive.bind(i)));if(void 0!==h){a=a.split(/\[(\d+)\]/).join(".").replace(/\.\./g,".");var d=sfBlazor.getNestedObject(e,a,h);sf.base.extend(n,{},d.model,!0),r||(e.deepMerge=e.deepMerge?Array.from(new Set(e.deepMerge.concat(d.deepMerge))):d.deepMerge)}}return n},updateOldProperties:function(e,t){var i=sfBlazor.getModelObject(e,t,null,!0);sf.base.extend(e.oldProperties,{},i,!0)},getNestedObject:function(e,t,i,r){var n=r||{},o=[];if(-1!==t.indexOf(".")){var s=t.split(".");-1===o.indexOf(s[0])&&o.push(s[0]);for(var a=0;a<s.length;a++){var l=a===s.length-1?i:{},h=0===a?n:h[s[a-1]];e=0===a?e:e[s[a-1]],h=sfBlazor.getNestedObject(e,s[a],l,h,s[a+1]).model}}else n[t]=i;return{model:n,deepMerge:o}},updateModel:(_updateModel=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){var i,r;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,t.isRendered&&!t.preventUpdate&&t._dotnetInstance){e.next=3;break}return e.abrupt("return");case 3:return i=sfBlazor.copyWithoutCircularReferences([t.bulkChanges],t.bulkChanges),r=sfBlazor.getUpdatedValue(t,i),e.next=7,t._dotnetInstance.invokeMethodAsync("UpdateModel",r);case 7:t.preventUpdate=!1,e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),window.sfBlazor.throwError(e.t0,t);case 13:case"end":return e.stop()}}),e,null,[[0,10]])}))),function(e){return _updateModel.apply(this,arguments)}),getUpdatedValue:function(e,t){for(var i={},r=["query","formatter"],n=Object.keys(t),o=0;o<n.length;o++){var s=n[o],a=t[s];-1===r.indexOf(s)&&(sfBlazor.isChildProperty(e,s)?i[s]=sfBlazor.getUpdatedValue(e,a):("object"!==_typeof(a)||null===a||a instanceof Date||Array.isArray(a)&&a[0]instanceof Date||(a=JSON.stringify(a)),i[s]=a))}return i},isChildProperty:function(e,t){return e.properties&&e.properties[t]&&void 0!==e.properties[t].parentObj},updateBlazorProperties:function(e,t){t._dotnetInstance.invokeMethodAsync("UpdateBlazorDiagramObjects",e)},updateBlazorDiagramEvents:(_updateBlazorDiagramEvents=_asyncToGenerator(_regeneratorRuntime().mark((function e(t,i){var r;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,i._dotnetInstance.invokeMethodAsync("UpdateBlazorDiagramEvents",t);case 3:(r=e.sent)&&"string"==typeof r&&(r=JSON.parse(r)),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),window.sfBlazor.throwError(e.t0,this);case 10:return e.abrupt("return",r);case 11:case"end":return e.stop()}}),e,this,[[0,7]])}))),function(e,t){return _updateBlazorDiagramEvents.apply(this,arguments)}),callDiagramMethod:(_callDiagramMethod=_asyncToGenerator(_regeneratorRuntime().mark((function e(t,i){var r;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=document.getElementById(i)&&document.getElementById(i).ej2_instances[0],"updateDiagramObjects"===t.methodName&&(t.obj=JSON.parse(t.obj,sfBlazor.parseRevive)),e.abrupt("return",r.callFromServer(t));case 3:case"end":return e.stop()}}),e)}))),function(e,t){return _callDiagramMethod.apply(this,arguments)}),diagramSetTemplateInstance:function(e,t,i){sfBlazor.templateDotnetInstance||(sfBlazor.templateDotnetInstance=[]),sfBlazor.templateDotnetInstance[i||e]=t},diagramSetTemplate:function(e,t){setTimeout((function(){if(null!=e)for(var t=document.getElementsByClassName("blazor-template"),i=0;i<t.length;i++){for(var r=t[i].getElementsByClassName("blazor-inner-template"),n=0;n<r.length;n++)for(var o=document.getElementsByClassName("e-blazor-template"),s=0;s<o.length;s++){var a=o[s];a&&r[n].children.length?0==a.children.length&&s===n&&a.appendChild(r[n].children[0].cloneNode(!0)):a&&(a.innerHTML=r[n].innerHTML)}if(window.sfBlazor.tempCallBacks.length)for(var l=0;l<window.sfBlazor.tempCallBacks.length;l++)window.sfBlazor.tempCallBacks[l].Id==e&&(window.sfBlazor.tempCallBacks[l].Promise(window.sfBlazor.tempCallBacks[l].Id),window.sfBlazor.tempCallBacks.splice(l,1))}}),100)},updateTemplate:function(e,t,i,r,n){void 0===r&&(r={}),n&&window.sfBlazor.tempCallBacks.push({Id:i,Promise:n});var o=[],s=[],a=[];if(sf.base.isNullOrUndefined(t)||!t.length||sf.base.isNullOrUndefined(t[0].BlazId)){if(!sf.base.isNullOrUndefined(t))for(l=0;l<t.length;l++)a.push(t[l].BlazorTemplateId),o.push(JSON.parse(window.sfBlazor.cleanStringify(t[l]))),delete o[l].BlazorTemplateId}else for(var l=0;l<t.length;l++)s.push(t[l].BlazId),a.push(t[l].BlazorTemplateId);var h=setInterval((function(){var t=r.templateDotnetInstance?r.templateDotnetInstance[e]||window.sfBlazor.templateDotnetInstance[r.guid||e]:window.sfBlazor.templateDotnetInstance?window.sfBlazor.templateDotnetInstance[r.guid||e]:null;if(!t){if(r.templateDotnetInstance&&!window.sfBlazor.templateDotnetInstance[r.guid||e])return;if(!(r.parentObj&&r.parentObj.templateDotnetInstance&&r.parentObj.templateDotnetInstance[e]))return;t=r.parentObj.templateDotnetInstance[e]}t&&(t.invokeMethodAsync("UpdateTemplate",e,JSON.stringify(o),i,a,s),clearInterval(h))}),10)},setTemplateInstance:function(e,t,i){sfBlazor.templateDotnetInstance||(sfBlazor.templateDotnetInstance=[]),sfBlazor.templateDotnetInstance[i||e]=t},setTemplate:function(e,t){setTimeout((function(){if(null!=e){for(var t=document.getElementById(e).getElementsByClassName("blazor-inner-template"),i=0;i<t.length;i++){var r=t[i].getAttribute("data-templateid"),n=document.getElementById(r);if(n&&t[i].childNodes)for(var o=t[i].childNodes.length,s=0;s<o;s++)n.appendChild(t[i].childNodes[0]);else n&&(n.innerHTML=t[i].innerHTML)}if(window.sfBlazor.tempCallBacks.length)for(var a=0;a<window.sfBlazor.tempCallBacks.length;a++)window.sfBlazor.tempCallBacks[a].Id==e&&(window.sfBlazor.tempCallBacks[a].Promise(window.sfBlazor.tempCallBacks[a].Id),window.sfBlazor.tempCallBacks.splice(a,1))}}),100)},invokeMethod:(_invokeMethod=_asyncToGenerator(_regeneratorRuntime().mark((function e(t,i,r,n,o){var s,a;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,s=null,n=JSON.parse(n,sfBlazor.parseRevive),a=document.getElementById(t)&&document.getElementById(t).ej2_instances&&document.getElementById(t).ej2_instances[0],"destroy"===i&&a&&(a._dotnetInstance=null),o&&n.push(o),!a){e.next=23;break}if(null!==r){e.next=11;break}s=a[i].apply(a,n),e.next=17;break;case 11:return a=sfBlazor.getDocEditor(a,r),a=window.sfBlazor.getChildModule(a,r),s=a[i].apply(a,n),e.next=16,sfBlazor.promiseHandler(s);case 16:s=e.sent;case 17:if(!s||"object"!==_typeof(s)||s instanceof Promise||(s=sfBlazor.cleanStringify(s)),!("PdfViewer"==a.getModuleName()&&"saveAsBlob"==i&&s instanceof Promise)){e.next=22;break}return e.next=21,sfBlazor.promiseHandler(s);case 21:s=e.sent;case 22:return e.abrupt("return",s);case 23:e.next=28;break;case 25:return e.prev=25,e.t0=e.catch(0),e.abrupt("return",window.sfBlazor.throwError(e.t0,a));case 28:case"end":return e.stop()}}),e,null,[[0,25]])}))),function(e,t,i,r,n){return _invokeMethod.apply(this,arguments)}),promiseHandler:(_promiseHandler=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t instanceof Promise)){e.next=3;break}return e.next=3,t.then(function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(i){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(i instanceof Blob)){e.next=5;break}return e.next=3,window.sfBlazor.docEditFileReader(i).then((function(e){t=JSON.stringify({data:e.substr(e.indexOf(",")+1)})}));case 3:e.next=6;break;case 5:t=i;case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 3:return e.abrupt("return",t);case 4:case"end":return e.stop()}}),e)}))),function(e){return _promiseHandler.apply(this,arguments)}),getDocEditor:function(e,t){return"DocumentEditorContainer"===e.getModuleName()&&"documentEditor"!==t?e.documentEditor:e},getChildModule:function(e,t){try{for(var i=t.split(","),r=0;r<i.length;r++)e=e[i[r]];return e}catch(t){window.sfBlazor.throwError(t,e)}},getMethodCall:function(e,t,i){try{var r=document.getElementById(e)&&document.getElementById(e).ej2_instances[0];return r=sfBlazor.getDocEditor(r),null==t||"null"==t?r[i]:(r=window.sfBlazor.getChildModule(r,t))[i]}catch(e){window.sfBlazor.throwError(e,r)}},setMethodCall:function(e,t,i,r){try{var n=document.getElementById(e)&&document.getElementById(e).ej2_instances[0];n=sfBlazor.getDocEditor(n),(n=window.sfBlazor.getChildModule(n,t))[i]=r[0]}catch(e){window.sfBlazor.throwError(e,n)}},methodCall:function(e,t,i,r){try{var n=document.getElementById(e)&&document.getElementById(e).ej2_instances[0];(n=window.sfBlazor.getChildModule(n,t))[i].apply(n,[r])}catch(e){window.sfBlazor.throwError(e,n)}},parseRevive:function parseRevive(key,value){var dateRegex=new RegExp(/(\d{4})-(\d{2})-(\d{2})T(\d{2})\:(\d{2})\:(\d{2}).*/),arrayRegex=new RegExp(/^\[.*?\]$/),objectRegex=new RegExp(/^\{.*?\}$/);if(""===key&&value&&value.dataSource_custom&&(value.dataSource_custom.key=value.dataSource.key,value.dataSource=value.dataSource_custom),!value||"string"!=typeof value||-1===value.indexOf("sf.data.Query()")&&"formatter"!==key){if(sfBlazor.isDataSourceProperty(key)){if(null===value)return;if(value="string"==typeof value?JSON.parse(value):value,!value.adaptor||value instanceof sf.data.DataManager)return value;var isOffline=value.offline;value.offline=!1,value.adaptor=sfBlazor.getAdaptor(value.adaptor);var dataManager=new sf.data.DataManager(value);return dataManager.offline=isOffline,this.dotnetInstance&&(dataManager.dotnetInstance=this.dotnetInstance,dataManager.key=value.key,dataManager.adaptor instanceof BlazorAdaptor&&(dataManager.adaptorName=value.adaptorName,dataManager.dataSource.offline=!1)),(this[value.guid]||this.templateRefs&&this.templateRefs[value.guid])&&(dataManager.baseAdaptorInstance=this[value.guid]||this.templateRefs[value.guid],dataManager.adaptorName="CustomAdaptor"),dataManager}if("string"==typeof value&&dateRegex.test(value)){if(arrayRegex.test(value)){var values=JSON.parse(value),val=[];for(i=0;i<values.length;i++)val.push(new Date(values[i]));return val}return isNaN(Date.parse(value))?value:new Date(value)}if("string"==typeof value&&(arrayRegex.test(value)||objectRegex.test(value))&&sfBlazor.isJson(value))return JSON.parse(value)}else try{return eval(value)}catch(e){var funValue=sfBlazor.getEvaluatedFunc(value);return funValue}return value},getEvaluatedFunc:function(e){var t=new RegExp(/\(+[^\)]+\)+/g),i=e.split("new sf.data.Query().")[1],r=e.trim().split("new sf.richtexteditor.MarkdownFormatter")[1];if(i){var n=i.split(t)[0],o=i.match(t)[0],s=new RegExp(/(\([a-z])+[^\)]+\)+/g),a=e.match(s);if(null!==a)var l=a[0],h=l.match(/\{+[^\)]+\}/g)[0],d=l.split(/\{+[^\)]+\}/g)[0];if(-1!==o.indexOf("sf"))var c=(w=d.match(/[^(]+/g)[0]).split("."),p=(new sf.data.Query)[n](sf[c[1]][c[2]][c[3]](JSON.parse(h)));else if(i.split(".").length>1){t=new RegExp(/([^\"]([A-Z]|[a-z])+[\"\]])/g);if(null!==i.match(t)){s=new RegExp(/([^\"]([A-Z]|[a-z])+[\"\]])|[0-9]/g);for(var u=i.match(s),g=i.split("."),f=[],m=0;m<g.length;m++){var y=g[m].match(/([A-z])+/g)[0];f.push(y)}p=(new sf.data.Query)[f[0]]()[f[1]](u[0].slice(0,-1))[f[2]](Number(u[1]))}else{var v=new RegExp(/([^\']+([A-Z]|[a-z])+[\'\)])|[0-9]/g);for(u=i.match(v),g=i.split("."),f=[],m=0;m<g.length;m++){y=g[m].match(/([A-z])+/g)[0];f.push(y)}p=(new sf.data.Query)[f[0]](u[0].slice(0,-1))[f[1]](u[1].slice(0,-1))[f[2]](Number(u[2]))}}else{var b,w=o.match(/([A-z]+|[0-9]+)+/g);p=(b=new sf.data.Query)[n].apply(b,_toConsumableArray(w))}}else if(r){var x=r.trim(),M=x.substring(1,x.length-1).trim();if(M.length>0){var N=M.replace(/'/g,'"'),I=JSON.parse(N);p=new sf.richtexteditor.MarkdownFormatter(I)}else p=new sf.richtexteditor.MarkdownFormatter({})}else p=new sf.data.Query;return p},triggerEJEvents:(_triggerEJEvents=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){var i;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!t){e.next=8;break}return t.elementID=this.elementID,e.next=5,this.dotnet.invokeMethodAsync("Trigger",this.eventName,window.sfBlazor.cleanStringify(t));case 5:i=e.sent,e.next=11;break;case 8:return e.next=10,this.dotnet.invokeMethodAsync("Trigger",this.eventName,"");case 10:i=e.sent;case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(0),window.sfBlazor.throwError(e.t0,this);case 16:return e.abrupt("return",i);case 17:case"end":return e.stop()}}),e,this,[[0,13]])}))),function(e){return _triggerEJEvents.apply(this,arguments)}),copyWithoutCircularReferences:function(e,t){try{var i=t&&Array.isArray(t),r=i?[]:{};return(i?t:t instanceof Node?[t]:sfBlazor.getObjectKeys(t)).forEach(function(){var n=_asyncToGenerator(_regeneratorRuntime().mark((function n(o){var s,a,l,h,d,c,p,u,g;return _regeneratorRuntime().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(s=t.hasOwnProperty("parentObj")&&t.properties?t.properties:t,a=i?o:s[o],!i||"string"!=typeof a&&"number"!=typeof a)if(a instanceof Node)l=sfBlazor.getDomObject(o,a,t),i?r.push(l):r[o]=l;else if(a&&Array.isArray(a))if(a.length>0)for(h=0;h<a.length;h++)r[o]||(r[o]=[]),"ej2_instances"!==o&&(!a[h]||"object"!==_typeof(a[h])||a[h]instanceof Date?r[o].push(a[h]):r[o].push(window.sfBlazor.copyWithoutCircularReferences(e,a[h])));else r[o]=[];else if(a&&window.sfBlazor.isJson(a)&&new RegExp(/^\[.*?\]$/).test(a))for(d=JSON.parse(a),r[o]||(r[o]=[]),c=0;c<d.length;c++)r[o].push(d[c]);else if(a&&a instanceof Event){for(u in p={},a)(g=a[u])instanceof Node||g instanceof Window||"path"===u||(p[u]=g);r[o]=p}else a&&"object"===_typeof(a)?a instanceof File?r[o]=a:e.indexOf(a)<0?(e.push(a),a&&a instanceof Date?r[o]=a:sfBlazor.isJsonStringfy(a)&&!sfBlazor.doesHaveFileObject(a)?i?r.push(a):r[o]=a:sfBlazor.isIgnoreProperty(o.toString())?r[o]="###_Circular_###":r[o]=window.sfBlazor.copyWithoutCircularReferences(e,a),e.pop()):r[o]="###_Circular_###":"function"!=typeof a&&(r[o]=a);else r.push(a);case 3:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()),r}catch(e){return console.log(e),{}}},doesHaveFileObject:function(e){for(var t=Object.keys(e),i=0;i<t.length;i++)if(e[t[i]]instanceof File)return!0;return!1},isJsonStringfy:function(e){try{return JSON.stringify(e)&&!0}catch(e){return!1}},getObjectKeys:function(e){var t=[];if(e instanceof Event)t=Object.keys(e);else for(var i in e)t.push(i);return t},isIgnoreProperty:function(e){return["parentObj","controlParent","modelObserver","localObserver","moduleLoader"].indexOf(e)>=0},isJson:function(e){try{return JSON.parse(e)}catch(e){return!1}},cleanStringify:function(e){try{return e&&"object"===_typeof(e)&&(e=window.sfBlazor.copyWithoutCircularReferences([e],e)),JSON.stringify(e)}catch(e){return console.log(e),""}},bindEvents:function(e,t,i,r){if(t)for(var n=0;n<t.length;n+=1){var o=t[n],s={dotnet:i,eventName:o,elementID:e.elementID,namespace:r};if(o.indexOf(".")>0){for(var a=o.split("."),l=e,h=0;h<a.length-1;h++){var d=new RegExp(/\[.*?\]/);if(d.test(a[h])){var c=a[h].match(d)[0],p=a[h].replace(c,"");c=c.match(/\[(.*?)\]/)[1],h+=1,l=l[p][c]}else l=l[a[h]]}l[a[a.length-1]]=window.sfBlazor.triggerEJEvents.bind(s)}else e[o]=window.sfBlazor.triggerEJEvents.bind(s)}},tryParseInt:function(e){return/^-?\d+\.?\d*$/.test(e)},throwError:function(e,t){console.error(e.message+"\n"+e.stack)},getAdaptor:function(e){var t;switch(e){case"ODataAdaptor":t=new sf.data.ODataAdaptor;break;case"ODataV4Adaptor":t=new sf.data.ODataV4Adaptor;break;case"UrlAdaptor":t=new sf.data.UrlAdaptor;break;case"WebApiAdaptor":t=new sf.data.WebApiAdaptor;break;case"JsonAdaptor":t=new sf.data.JsonAdaptor;break;case"RemoteSaveAdaptor":t=new sf.data.RemoteSaveAdaptor;break;case"CustomAdaptor":sfBlazor.initCustomAdaptor(),t=new window.CustomAdaptor;break;default:t=new window.BlazorAdaptor}return t},spinnerUtility:function(e,t,i,r){try{sf.popups.Spinner(e,t,i,r)}catch(e){return window.sfBlazor.throwError(e)}},initBlazorAdaptor:function(){var e=sf.data?sf.data.UrlAdaptor:function(){};window.BlazorAdaptor=function(e){_inherits(i,e);var t=_createSuper(i);function i(){return _classCallCheck(this,i),t.apply(this,arguments)}return _createClass(i,[{key:"processQuery",value:function(e,t,i){var r=sf.data.UrlAdaptor.prototype.processQuery.apply(this,arguments);return r.dotnetInstance=e.dotnetInstance,r.key=e.key,r}},{key:"makeRequest",value:function(e,t,i,r){var n=JSON.parse(e.data);n.serverSideGroup=!1;var o=this;e.dotnetInstance.invokeMethodAsync("DataProcess",JSON.stringify(n),e.key).then((function(i){null===(i=sf.data.DataUtil.parse.parseJson(i))?i=[]:null===i.result&&(i.result=[]),function(e,i,r){var n={};n.count=e.count?parseInt(e.count.toString(),10):0,n.result=e.result?e.result:e,n.aggregates=e.aggregates,n.virtualSelectRecords=r,t.resolve(n)}(o.processResponse(i,{},r,null,e))})).catch((function(e){!function(e){i.error=e,t.reject(i)}(e)}))}},{key:"insert",value:function(e,t,i,r,n){var o={};return o.dm=e,o.data=t,o.tableName=i,o.query=r,o.requestType="insert",o.position=n,o}},{key:"remove",value:function(e,t,i,r,n){var o={};return o.dm=e,o.data=i,o.keyField=t,o.tableName=r,o.query=n,o.requestType="remove",o}},{key:"update",value:function(e,t,i,r,n){var o={};return o.dm=e,o.data=i,o.keyField=t,o.tableName=r,o.query=n,o.requestType="update",o}},{key:"batchRequest",value:function(e,t,i,r,n){var o={};return o.dm=e,o.changed=t.changedRecords,o.added=t.addedRecords,o.deleted=t.deletedRecords,o.requestType="batchsave",o.keyField=i.key,o.dropIndex=sf.base.isNullOrUndefined(r)?null:r.dragDropDestinationIndex,o.query=r,o}},{key:"doAjaxRequest",value:function(e){var t=new sf.data.Deferred,i=e.dm,r=sf.data.UrlAdaptor.prototype.processQuery.apply(this,[i,e.query,!1]),n=function(i){e.error=i,t.reject(e)};if("insert"===e.requestType&&i.dotnetInstance.invokeMethodAsync("Insert",JSON.stringify(e.data),i.key,e.position?e.position:0,r.data).then((function(e){t.resolve(e)})).catch((function(e){n(e)})),"remove"===e.requestType){var o="string"==typeof e.data?e.data:JSON.stringify(e.data);e.data instanceof Date&&(o=e.data.toJSON()),i.dotnetInstance.invokeMethodAsync("Remove",o,e.keyField,i.key,r.data).then((function(e){t.resolve()})).catch((function(e){n(e)}))}return"update"===e.requestType&&i.dotnetInstance.invokeMethodAsync("Update",JSON.stringify(e.data),e.keyField,i.key,r.data).then((function(e){var i=sf.data.DataUtil.parse.parseJson(e);t.resolve(i)})).catch((function(e){n(e)})),"batchsave"===e.requestType&&i.dotnetInstance.invokeMethodAsync("BatchUpdate",JSON.stringify(e.changed),JSON.stringify(e.added),JSON.stringify(e.deleted),e.keyField,i.key,e.dropIndex,r.data).then((function(e){var i=sf.data.DataUtil.parse.parseJson(e);t.resolve(i)})).catch((function(e){n(e)})),t.promise}}]),i}(e)},initCustomAdaptor:function(){window.CustomAdaptor=function(e){_inherits(i,window.BlazorAdaptor);var t=_createSuper(i);function i(){return _classCallCheck(this,i),t.apply(this,arguments)}return _createClass(i,[{key:"processQuery",value:function(e,t,i){var r=sf.data.UrlAdaptor.prototype.processQuery.apply(this,arguments);return r.dotnetInstance=e.dotnetInstance,r.baseAdaptorInstance=e.baseAdaptorInstance,r.key=e.key,r}},{key:"makeRequest",value:function(e,t,i,r){var n=JSON.parse(e.data);n.serverSideGroup=!1;var o=this;e.baseAdaptorInstance.invokeMethodAsync("BaseRead",JSON.stringify(n),e.key).then((function(i){null===(i=sf.data.DataUtil.parse.parseJson(i)).result&&(i.result=[]),function(e,i,r){var n={};n.count=e.count?parseInt(e.count.toString(),10):0,n.result=e.result?e.result:e,n.aggregates=i,n.virtualSelectRecords=r,t.resolve(n)}(o.processResponse(i,{},r,null,e))})).catch((function(e){!function(e){i.error=e,t.reject(i)}(e)}))}},{key:"doAjaxRequest",value:function(e){var t=new sf.data.Deferred,i=e.dm,r=function(i){e.error=i,t.reject(e)};return"insert"===e.requestType&&i.baseAdaptorInstance.invokeMethodAsync("BaseInsert",JSON.stringify(e.data),i.key).then((function(e){e=sf.data.DataUtil.parse.parseJson(e),t.resolve(e)})).catch((function(e){r(e)})),"remove"===e.requestType&&i.baseAdaptorInstance.invokeMethodAsync("BaseRemove",JSON.stringify(e.data),e.keyField,i.key).then((function(e){e=sf.data.DataUtil.parse.parseJson(e),t.resolve(e)})).catch((function(e){r(e)})),"update"===e.requestType&&i.baseAdaptorInstance.invokeMethodAsync("BaseUpdate",JSON.stringify(e.data),e.keyField,i.key).then((function(e){e=sf.data.DataUtil.parse.parseJson(e),t.resolve(e)})).catch((function(e){r(e)})),"batchsave"===e.requestType&&i.baseAdaptorInstance.invokeMethodAsync("BaseBatchUpdate",JSON.stringify(e.changed),JSON.stringify(e.added),JSON.stringify(e.deleted),e.keyField,i.key,e.dropIndex).then((function(e){e=sf.data.DataUtil.parse.parseJson(e),t.resolve(e)})).catch((function(e){r(e)})),t.promise}}]),i}()},requestHandler:function(e){try{var t=document.getElementById(e.elementId);if(null!=t)if(t.ej2_instances.length>0)t.ej2_instances[0]._dotnetInstance.invokeMethodAsync("GetPDFInfo",e);else"Unload"==e.action&&DotNet.invokeMethodAsync("Syncfusion.Blazor.PdfViewerServer","Unload",e)}catch(e){window.sfBlazor.throwError(e,this)}},ioSuccessHandler:function(e,t,i,r){try{var n=document.getElementById(e);if(n){var o=n.ej2_instances[0],s={data:r};if("sf.pdfviewer.PdfViewer"==t)switch(i){case"Load":o.viewerBase.loadRequestHandler.successHandler(s);break;case"RenderPdfPages":o.viewerBase.pageRequestHandler.successHandler(s);break;case"VirtualLoad":o.viewerBase.virtualLoadRequestHandler.successHandler(s);break;case"Download":o.viewerBase.dowonloadRequestHandler.successHandler(s);break;case"PrintImages":o.printModule.printRequestHandler.successHandler(s);break;case"Search":o.textSearchModule.searchRequestHandler.successHandler(s);break;case"Bookmarks":o.bookmarkViewModule.bookmarkRequestHandler.successHandler(s);break;case"RenderThumbnailImages":o.thumbnailViewModule.thumbnailRequestHandler.successHandler(s);break;case"RenderAnnotationComments":o.annotationModule.stickyNotesAnnotationModule.commentsRequestHandler.successHandler(s);break;case"RenderPdfTexts":o.textSearchModule.searchRequestHandler.successHandler(s);break;case"ImportAnnotations":o.viewerBase.importAnnotationRequestHandler.successHandler(s);break;case"ExportAnnotations":o.viewerBase.exportAnnotationRequestHandler.successHandler(s);break;case"ExportFormFields":o.viewerBase.exportFormFieldsRequestHandler.successHandler(s);break;case"ImportFormFields":o.viewerBase.importFormFieldsRequestHandler.successHandler(s)}if("sf.documenteditor.DocumentEditorContainer"==t||"sf.documenteditor.DocumentEditor"==t){var a=sfBlazor.getDocEditor(o);switch(i){case"SystemClipboard":s.data=JSON.parse(s.data),a.editor.pasteRequestHandler.successHandler(s);break;case"Import":o.toolbarModule.importHandler.successHandler(s);break;case"EnforceProtection":a.editor.enforceProtectionInternal(s);break;case"UnprotectDocument":a.editor.onUnProtectionSuccess(s)}}}}catch(e){window.sfBlazor.throwError(e,this)}},docEditRequestHandler:(_docEditRequestHandler=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){var i,r,n;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!(t instanceof FormData)){e.next=10;break}return i=t.get("files"),r="",e.next=6,window.sfBlazor.docEditFileReader(i).then((function(e){r=e}));case 6:n={documentData:r.substr(r.indexOf(",")+1),fileName:i.name,action:"Import"},this._dotnetInstance.invokeMethodAsync("GetDocumentInfo",n),e.next=12;break;case 10:t.hasOwnProperty("saltBase64")?t.action=""===t.saltBase64?"EnforceProtection":"UnprotectDocument":t.hasOwnProperty("type")&&t.hasOwnProperty("content")&&(t.action="SystemClipboard"),this._dotnetInstance.invokeMethodAsync("GetDocumentInfo",t);case 12:e.next=17;break;case 14:e.prev=14,e.t0=e.catch(0),window.sfBlazor.throwError(e.t0,this);case 17:case"end":return e.stop()}}),e,this,[[0,14]])}))),function(e){return _docEditRequestHandler.apply(this,arguments)}),docEditFileReader:function(e){try{return new Promise((function(t,i){var r=new FileReader;r.onload=function(){t(r.result)},r.readAsDataURL(e)}))}catch(e){window.sfBlazor.throwError(e,this)}}},_docEditRequestHandler,_triggerEJEvents,_promiseHandler,_invokeMethod,_callDiagramMethod,_updateBlazorDiagramEvents,_updateModel;sf.base.enableBlazorMode(),window.sfBlazor=window.sfBlazor||{},Object.assign(window.sfBlazor,extended)},"./syncfusion-blazor.js":function(e,t){var i={instances:[],getElementByXpath:function(e){return document.evaluate(e,document,null,XPathResult.FIRST_ORDERED_NODE_TYPE,null).singleNodeValue},getElement:function(e,t,i){var r=null!=e&&null!=window[e]?window[e][t]:null;return null!=r?r:window.sfBlazor.getElementByXpath(i)},getAttribute:function(e,t,i,r){var n=window.sfBlazor.getElement(e,t,i);if(null!=n)return n.getAttribute(r)},setAttribute:function(e,t,i,r,n){window.sfBlazor.getElement(e,t,i).setAttribute(r,n)},addClass:function(e,t,i,r){sf.base.addClass([window.sfBlazor.getElement(e,t,i)],r)},removeClass:function(e,t,i,r){sf.base.removeClass([window.sfBlazor.getElement(e,t,i)],r)},getClassList:function(e,t,i){return Array.prototype.slice.call(window.sfBlazor.getElement(e,t,i).classList)},enableRipple:function(e){sf.base.enableRipple(e)},isDevice:function(e){return e&&this.enableRtl(e),sf.base.Browser.isDevice},animate:function(e,t){new sf.base.Animation(t).animate(e)},setGlobalAnimationValue:function(e){sf.base.setGlobalAnimation(e)},callRipple:function(e,t){sf.base.rippleEffect(e,t)},createXPathFromElement:function(e){for(var t=document.getElementsByTagName("*"),i=[];e&&1===e.nodeType;e=e.parentNode)if(e.hasAttribute("id")){for(var r=0,n=0;n<t.length&&(t[n].hasAttribute("id")&&t[n].id===e.id&&r++,!(r>1));n++);if(1===r)return i.unshift('id("'+e.getAttribute("id")+'")'),i.join("/");i.unshift(e.localName.toLowerCase()+'[@id="'+e.getAttribute("id")+'"]')}else{for(var o=1,s=e.previousSibling;s;s=s.previousSibling)s.localName===e.localName&&o++;i.unshift(e.localName.toLowerCase()+"["+o+"]")}return i.length?"/"+i.join("/"):null},getDomObject:function(e,t,i){var r=e+sf.base.getUniqueID(e),n={id:t.id,class:t.className,xPath:window.sfBlazor.createXPathFromElement(t),domUUID:r},o=i&&i.elementID;return o&&(window[o]=sf.base.isNullOrUndefined(window[o])?{}:window[o],window[o][r]=t,n.elementID=o),n},focusButton:function(e){e.focus()},setCompInstance:function(e){window.sfBlazor.instances[e.dataId]=e},getCompInstance:function(e){return window.sfBlazor.instances[e]},setProgress:function(e,t,i,r,n,o){return i=i.querySelector(".e-spinner"),window.requestAnimationFrame((function(){n&&(e.style[o?"height":"width"]=r+"%"),t.parentElement.setAttribute("aria-valuenow",r.toString()),100===r&&(t.classList.remove("e-cont-animate","e-animate-end"),i.style.width="auto",i.style.height="auto")}))},setAnimation:function(e,t,i,r,n,o){t=t.querySelector(".e-spinner"),new sf.base.Animation({}).animate(e,{duration:r,name:"Progress"+i,timingFunction:n,begin:function(){o&&(t.style.width=Math.max(t.offsetWidth,e.offsetWidth)+"px",t.style.height=Math.max(t.offsetHeight,e.offsetHeight)+"px",e.classList.add("e-cont-animate"))},end:function(){e.classList.add("e-animate-end")}})},cancelAnimation:function(e){window.cancelAnimationFrame(e)},getSpinnerTheme:function(e){var t=e?window.getComputedStyle(e,":after").getPropertyValue("content"):"Material";return t&&t.replace(/['"]+/g,"")},chipKeydownHandler:function(e){e&&e.addEventListener("keydown",(function(e){e.target&&e.target.classList.contains("e-chip")&&" "==e.key&&e.preventDefault()}))},MediaQuery:{initialize:function(e){return e.dataId?(sf.base.extend(e,this,e),window.sfBlazor.setCompInstance(e),e.activeBreakpoint="",e.isMediaChanged=!1,e.initializeMediaQueries(e),e.updateActiveBreakpoint(e,!0),e.activeBreakpoint):null},initializeMediaQueries:function(e){for(var t=0;t<e.mediaBreakpoints.length;t++){var i=window.matchMedia(e.mediaBreakpoints[t].mediaQuery);e.mediaBreakpoints[t].mq=i,sf.base.EventHandler.add(i,"change",e.mediaQueryChangeHandler,e)}},updateActiveBreakpoint:function(e,t){for(var i=!1,r=0;r<e.mediaBreakpoints.length;r++){if(e.mediaBreakpoints[r].mq.matches){e.isMediaChanged&&!i||t||(e.isMediaChanged=e.activeBreakpoint!=e.mediaBreakpoints[r].breakpoint),e.activeBreakpoint=e.mediaBreakpoints[r].breakpoint;break}e.activeBreakpoint==e.mediaBreakpoints[r].breakpoint&&(i=e.isMediaChanged=!0,e.activeBreakpoint="")}},mediaQueryChangeHandler:function(){this.updateActiveBreakpoint(this),this.isMediaChanged&&(this.dotNetRef.invokeMethodAsync("UpdateActiveBreakpoint",this.activeBreakpoint),this.isMediaChanged=!1)},destroyComponent:function(){for(var e=0;e<this.mediaBreakpoints.length;e++)sf.base.EventHandler.remove(this.mediaBreakpoints[e].mq,"change",this.mediaQueryChangeHandler)},destroy:function(e){e&&window.sfBlazor.getCompInstance(e).destroyComponent()}},validateBlazorLicense:function(e,t,i){if(i){var r=sf.base.createElement("div",{innerHTML:'<div style="position: fixed;\n                width: 100%;\n                height: 100%;\n                top: 0;\n                left: 0;\n                right: 0;\n                bottom: 0;\n                background-color: rgba(0, 0, 0, 0.5);\n                z-index: 99999;">\n                    <div style="background: #FFFFFF;\n                    height: 490px;\n                    width: 840px;\n                    font-family: Helvetica Neue, Helvetica, Arial;\n                    color: #000000;\n                    box-shadow: 0px 4.8px 14.4px rgb(0 0 0 / 18%), 0px 25.6px 57.6px rgb(0 0 0 / 22%);\n                    display: block;\n                    margin: 6% auto;\n                    border-radius: 20px;">\n                        <div style="\n                        position: absolute;\n                        width: 838px;\n                        height: 80px;\n                        background-color: #F9F9F9;\n                        border: 1px solid #EEEEEE;\n                        border-top-left-radius: 20px;\n                        border-top-right-radius: 20px;">\n                <img src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTQ2IiBoZWlnaHQ9IjMyIiB2aWV3Qm94PSIwIDAgMTQ2IDMyIiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPgo8cGF0aCBkPSJNNDAuNTk2NSAxNS4wMDc4SDMyLjQyNUMzMS41NTU3IDE1LjAwNzggMzAuOTAzNyAxNS4xODEyIDMwLjUxMjUgMTUuNDg0NkMzMC4xMjEzIDE1LjgzMTQgMjkuOTA0IDE2LjMwODIgMjkuOTA0IDE3LjA0NTFDMjkuOTA0IDE3LjYwODYgMzAuMDc3OCAxOC4wNDIxIDMwLjQyNTYgMTguMzAyMkMzMC43NzMzIDE4LjYwNTYgMzEuMjk0OSAxOC43MzU2IDMxLjk5MDMgMTguNzM1NkgzNi4zMzY5QzM4LjExODkgMTguNzM1NiAzOS40MjI5IDE5LjA4MjQgNDAuMTYxOCAxOS43MzI2QzQwLjk0NDIgMjAuNDI2MiA0MS4yOTE5IDIxLjU1MzIgNDEuMjkxOSAyMy4xMTM3QzQxLjI5MTkgMjQuNzE3NiA0MC44NTcyIDI1Ljg4OCAzOS45ODc5IDI2LjY2ODJDMzkuMTE4NiAyNy40MDUxIDM3LjcyNzcgMjcuNzk1MyAzNS44NTg3IDI3Ljc5NTNIMjcuMDc4N1YyNS4wMjFIMzUuMzM3MkMzNi4yOTM0IDI1LjAyMSAzNi45NDU0IDI0Ljg5MSAzNy4zMzY2IDI0LjYzMDlDMzcuNzI3NyAyNC4zNzA4IDM3LjkwMTYgMjMuODk0IDM3LjkwMTYgMjMuMjg3MUMzNy45MDE2IDIyLjYzNjkgMzcuNzI3NyAyMi4xNjAxIDM3LjM4IDIxLjlDMzcuMDMyMyAyMS42Mzk5IDM2LjQyMzggMjEuNDY2NSAzNS41NTQ1IDIxLjQ2NjVIMzEuNjQyNkMyOS44NjA1IDIxLjQ2NjUgMjguNTEzMSAyMS4xMTk4IDI3LjY4NzMgMjAuMzgyOEMyNi44NjE0IDE5LjY0NTkgMjYuNDI2OCAxOC41MTg5IDI2LjQyNjggMTcuMDAxN0MyNi40MjY4IDE1LjM1NDUgMjYuODYxNCAxNC4xNDA4IDI3LjczMDcgMTMuMzYwNkMyOC42IDEyLjU4MDMgMjkuOTkwOSAxMi4yMzM1IDMxLjkwMzQgMTIuMjMzNUg0MC41OTY1VjE1LjAwNzhaIiBmaWxsPSIjMzU0M0E4Ii8+CjxwYXRoIGQ9Ik00OC4wNzI3IDI1LjI4MTFINTAuNTA2OFYxNi4zOTQ5SDUzLjU0OTNWMjcuNTM1MkM1My41NDkzIDI5LjA1MjQgNTMuMjAxNiAzMC4xNzk0IDUyLjUwNjIgMzAuOTE2M0M1MS44MTA3IDMxLjY1MzIgNTAuNzI0MSAzMiA0OS4yNDYzIDMySDQzLjMzNVYyOS42NTkySDQ4LjcyNDdDNDkuMjg5NyAyOS42NTkyIDQ5Ljc2NzkgMjkuNTI5MiA1MC4wNzIxIDI5LjIyNThDNTAuMzc2NCAyOC45NjU3IDUwLjU1MDIgMjguNTMyMiA1MC41NTAyIDI4LjAxMlYyNy44Mzg2SDQ3Ljg5ODlDNDYuMjAzNyAyNy44Mzg2IDQ0Ljk0MzIgMjcuNDkxOSA0NC4yNDc4IDI2Ljg0MTZDNDMuNTA4OSAyNi4xNDgxIDQzLjE2MTEgMjUuMDY0NCA0My4xNjExIDIzLjQ2MDVWMTYuMzk0OUg0Ni4xNjAyVjIzLjIwMDVDNDYuMTYwMiAyNC4wNjc0IDQ2LjI5MDYgMjQuNjMwOSA0Ni41NTE0IDI0Ljg5MUM0Ni43MjUzIDI1LjE1MTEgNDcuMjQ2OSAyNS4yODExIDQ4LjA3MjcgMjUuMjgxMVoiIGZpbGw9IiMzNTQzQTgiLz4KPHBhdGggZD0iTTU1Ljg5NjUgMTYuMzk0OUg2MS41OTA0QzYzLjMyOTEgMTYuMzk0OSA2NC41NDYxIDE2LjY5ODMgNjUuMjg1IDE3LjM0ODVDNjYuMDIzOSAxNy45OTg4IDY2LjM3MTYgMTkuMDgyNCA2Ni4zNzE2IDIwLjU1NjNWMjcuNzk1M0g2My4zMjkxVjIwLjk0NjRDNjMuMzI5MSAyMC4wNzk0IDYzLjE5ODcgMTkuNTE1OSA2Mi45Mzc5IDE5LjI5OTJDNjIuNjc3MSAxOS4wMzkxIDYyLjE1NTUgMTguOTA5MSA2MS4zMjk3IDE4LjkwOTFINTguODk1NlYyNy44Mzg2SDU1Ljg1M1YxNi4zOTQ5SDU1Ljg5NjVaIiBmaWxsPSIjMzU0M0E4Ii8+CjxwYXRoIGQ9Ik03NC45MzQyIDI1LjM2NzhINzguMTUwNlYyNy43OTUySDc0LjAyMTRDNzIuOTc4MiAyNy43OTUyIDcyLjEwODkgMjcuNjY1MiA3MS40NTcgMjcuNDkxOEM3MC44MDUgMjcuMjc1IDcwLjE5NjUgMjYuOTI4MyA2OS43MTgzIDI2LjQ1MTRDNjkuMTk2OCAyNS45MzEzIDY4Ljc2MjEgMjUuMjgxMSA2OC40NTc4IDI0LjU0NDJDNjguMTUzNiAyMy44MDcyIDY4LjAyMzIgMjIuOTgzNiA2OC4wMjMyIDIyLjE2QzY4LjAyMzIgMjEuMjkzMSA2OC4xNTM2IDIwLjQ2OTUgNjguNDU3OCAxOS42ODkyQzY4Ljc2MjEgMTguOTA5IDY5LjE1MzMgMTguMzAyMSA2OS43MTgzIDE3Ljc4MTlDNzAuMjM5OSAxNy4zMDUxIDcwLjgwNSAxNi45NTgzIDcxLjUwMDQgMTYuNzQxNkM3Mi4xOTU5IDE2LjUyNDkgNzMuMDIxNyAxNi40MzgyIDc0LjA2NDkgMTYuNDM4Mkg3OC4xOTQxVjE4LjkwOUg3NC45MzQyQzczLjQ5OTggMTguOTA5IDcyLjU0MzYgMTkuMTY5MSA3MS45Nzg1IDE5LjY0NTlDNzEuNDU2OSAyMC4xMjI3IDcxLjE1MjcgMjAuOTg5NyA3MS4xNTI3IDIyLjIwMzRDNzEuMTUyNyAyMi44OTY5IDcxLjI4MzEgMjMuNDYwNSA3MS41MDA0IDIzLjkzNzNDNzEuNzE3NyAyNC40MTQxIDcyLjA2NTUgMjQuNzYwOSA3Mi41MDAxIDI1LjA2NDNDNzIuNzE3NCAyNS4xOTQ0IDcyLjk3ODIgMjUuMjgxMSA3My4yODI1IDI1LjM2NzhDNzMuNjMwMiAyNS4zMjQ0IDc0LjE1MTggMjUuMzY3OCA3NC45MzQyIDI1LjM2NzhaIiBmaWxsPSIjMzU0M0E4Ii8+CjxwYXRoIGQ9Ik04MC44NDU2IDE4LjY0ODlINzguNjcyNFYxNi4zNTE1SDgwLjg0NTZWMTUuMTgxMUM4MC44NDU2IDE0LjAxMDggODEuMDYzIDEzLjIzMDUgODEuNDk3NiAxMi44NDA0QzgxLjkzMjMgMTIuNDUwMyA4Mi43NTgxIDEyLjIzMzUgODMuOTc1MSAxMi4yMzM1SDg2Ljg0MzhWMTQuNDAwOUg4NS40MDk1Qzg0Ljg4NzkgMTQuNDAwOSA4NC41NDAyIDE0LjQ4NzYgODQuMzIyOSAxNC42NjFDODQuMTA1NSAxNC44MzQ0IDgzLjk3NTEgMTUuMDk0NSA4My45NzUxIDE1LjQ0MTJWMTYuMzUxNUg4Ni44NDM4VjE4LjY0ODlIODMuOTc1MVYyNy43OTUzSDgwLjg0NTZWMTguNjQ4OVoiIGZpbGw9IiMzNTQzQTgiLz4KPHBhdGggZD0iTTk4LjQwNTYgMjcuNzk1M0g5Mi43MTE2QzkxLjAxNjUgMjcuNzk1MyA4OS44NDI5IDI3LjQ0ODUgODkuMDYwNSAyNi43OTgzQzg4LjMyMTYgMjYuMTQ4MSA4Ny45MzA0IDI1LjA2NDQgODcuOTMwNCAyMy41OTA2VjE2LjM5NDlIOTAuOTI5NVYyMy40MTcyQzkwLjkyOTUgMjQuMTk3NCA5MS4wNTk5IDI0LjY3NDMgOTEuMzIwNyAyNC45MzQ0QzkxLjU4MTUgMjUuMTk0NCA5Mi4xMDMxIDI1LjMyNDUgOTIuOTI4OSAyNS4zMjQ1SDk1LjM2M1YxNi4zOTQ5SDk4LjQwNTZWMjcuNzk1M1oiIGZpbGw9IiMzNTQzQTgiLz4KPHBhdGggZD0iTTEwMC42MjIgMjUuNDExMkgxMDcuMDExQzEwNy41NzcgMjUuNDExMiAxMDguMDExIDI1LjMyNDUgMTA4LjI3MiAyNS4xNTExQzEwOC41MzMgMjQuOTc3NyAxMDguNjYzIDI0LjY3NDMgMTA4LjY2MyAyNC4zMjc1QzEwOC42NjMgMjMuOTM3NCAxMDguNTMzIDIzLjY3NzMgMTA4LjI3MiAyMy40NjA1QzEwOC4wMTEgMjMuMjg3MSAxMDcuNTc3IDIzLjIwMDUgMTA3LjA1NSAyMy4yMDA1SDEwNC40NDdDMTAyLjg4MiAyMy4yMDA1IDEwMS44MzkgMjIuOTgzNyAxMDEuMzE4IDIyLjUwNjlDMTAwLjc1MiAyMi4wMzAxIDEwMC40OTIgMjEuMjA2NSAxMDAuNDkyIDE5Ljk5MjdDMTAwLjQ5MiAxOC43NzkgMTAwLjgzOSAxNy44Njg3IDEwMS40OTEgMTcuMjYxOEMxMDIuMTQzIDE2LjY5ODMgMTAzLjE4NyAxNi4zOTQ5IDEwNC41MzQgMTYuMzk0OUgxMTEuMDU0VjE4Ljc3OUgxMDUuNzA4QzEwNC44MzggMTguNzc5IDEwNC4yNzMgMTguODY1NyAxMDQuMDEyIDE4Ljk5NTdDMTAzLjc1MiAxOS4xNjkxIDEwMy42MjEgMTkuNDI5MiAxMDMuNjIxIDE5LjgxOTRDMTAzLjYyMSAyMC4xNjYxIDEwMy43NTIgMjAuNDI2MiAxMDMuOTY5IDIwLjU5OTZDMTA0LjE4NiAyMC43NzMgMTA0LjU3NyAyMC44NTk3IDEwNS4wNTYgMjAuODU5N0gxMDcuNzk0QzEwOS4wNTQgMjAuODU5NyAxMTAuMDExIDIxLjE2MzEgMTEwLjY2MyAyMS43MjY2QzExMS4zMTUgMjIuMjkwMiAxMTEuNjYyIDIzLjE1NzEgMTExLjY2MiAyNC4yNDA4QzExMS42NjIgMjUuMjgxMSAxMTEuMzU4IDI2LjE0ODEgMTEwLjc5MyAyNi43OTgzQzExMC4yMjggMjcuNDQ4NSAxMDkuNDQ2IDI3Ljc5NTMgMTA4LjUzMyAyNy43OTUzSDEwMC43MDlWMjUuNDExMkgxMDAuNjIyWiIgZmlsbD0iIzM1NDNBOCIvPgo8cGF0aCBkPSJNMTE2LjU3NCAxNS4wOTQ0SDExMy40MDFWMTIuMjc2OUgxMTYuNTc0VjE1LjA5NDRaTTExNi41NzQgMjcuNzk1M0gxMTMuNDAxVjE2LjM5NDlIMTE2LjU3NFYyNy43OTUzWiIgZmlsbD0iIzM1NDNBOCIvPgo8cGF0aCBkPSJNMTMwLjMwOSAyMi4xMTY3QzEzMC4zMDkgMjMuODkzOSAxMjkuNzQ0IDI1LjMyNDQgMTI4LjY1NyAyNi40MDgxQzEyNy41NzEgMjcuNDkxOCAxMjYuMDkzIDI4LjAxMiAxMjQuMjI0IDI4LjAxMkMxMjIuMzU1IDI4LjAxMiAxMjAuODc3IDI3LjQ5MTggMTE5Ljc5IDI2LjQwODFDMTE4LjcwNCAyNS4zMjQ0IDExOC4xMzkgMjMuODkzOSAxMTguMTM5IDIyLjExNjdDMTE4LjEzOSAyMC4zMzk0IDExOC43MDQgMTguOTA5IDExOS43OSAxNy44MjUzQzEyMC44NzcgMTYuNzQxNiAxMjIuMzk4IDE2LjIyMTQgMTI0LjIyNCAxNi4yMjE0QzEyNi4wNDkgMTYuMjIxNCAxMjcuNTI3IDE2Ljc0MTYgMTI4LjY1NyAxNy44MjUzQzEyOS43NDQgMTguODY1NiAxMzAuMzA5IDIwLjI5NjEgMTMwLjMwOSAyMi4xMTY3Wk0xMjEuMjY4IDIyLjExNjdDMTIxLjI2OCAyMy4yMDA0IDEyMS41MjkgMjQuMDY3MyAxMjIuMDUxIDI0LjY3NDJDMTIyLjU3MiAyNS4yODExIDEyMy4yNjggMjUuNTg0NSAxMjQuMTggMjUuNTg0NUMxMjUuMDkzIDI1LjU4NDUgMTI1Ljc4OSAyNS4yODExIDEyNi4zMSAyNC42NzQyQzEyNi44MzIgMjQuMDY3MyAxMjcuMDkzIDIzLjIwMDQgMTI3LjA5MyAyMi4xMTY3QzEyNy4wOTMgMjEuMDMzIDEyNi44MzIgMjAuMTY2MSAxMjYuMzEgMTkuNjAyNUMxMjUuNzg5IDE4Ljk5NTcgMTI1LjA5MyAxOC42OTIyIDEyNC4xMzcgMTguNjkyMkMxMjMuMjI0IDE4LjY5MjIgMTIyLjUyOSAxOC45OTU3IDEyMi4wMDcgMTkuNjAyNUMxMjEuNTI5IDIwLjE2NjEgMTIxLjI2OCAyMS4wMzMgMTIxLjI2OCAyMi4xMTY3WiIgZmlsbD0iIzM1NDNBOCIvPgo8cGF0aCBkPSJNMTMxLjc4NyAxNi4zOTQ5SDEzNy40ODFDMTM5LjIxOSAxNi4zOTQ5IDE0MC40MzYgMTYuNjk4MyAxNDEuMTc1IDE3LjM0ODVDMTQxLjkxNCAxNy45OTg4IDE0Mi4yNjIgMTkuMDgyNCAxNDIuMjYyIDIwLjU1NjNWMjcuNzk1M0gxMzkuMjE5VjIwLjk0NjRDMTM5LjIxOSAyMC4wNzk0IDEzOS4wODkgMTkuNTE1OSAxMzguODI4IDE5LjI5OTJDMTM4LjU2NyAxOS4wMzkxIDEzOC4wNDYgMTguOTA5MSAxMzcuMjIgMTguOTA5MUgxMzQuNzg2VjI3LjgzODZIMTMxLjc0M1YxNi4zOTQ5SDEzMS43ODdaIiBmaWxsPSIjMzU0M0E4Ii8+CjxwYXRoIGQ9Ik03LjEyODMxIDMuNzM3NDNIMFYxMC44NDY0SDcuMTI4MzFWMy43Mzc0M1oiIGZpbGw9IiMzNTQzQTgiLz4KPHBhdGggZD0iTTIzLjI1MTMgLTIuMTU3MjVlLTA1TDE4LjU1MTMgNS41MTY4NUwyNC4wODMxIDEwLjIwNDFMMjguNzgzMSA0LjY4NzI1TDIzLjI1MTMgLTIuMTU3MjVlLTA1WiIgZmlsbD0iI0ZGODYwMCIvPgo8cGF0aCBkPSJNMTUuNjA0MSAzLjczNzQzSDguNDc1ODNWMTAuODQ2NEgxNS42MDQxVjMuNzM3NDNaIiBmaWxsPSIjMzU0M0E4Ii8+CjxwYXRoIGQ9Ik03LjEyODMxIDEyLjE5MDJIMFYxOS4yOTkySDcuMTI4MzFWMTIuMTkwMloiIGZpbGw9IiMzNTQzQTgiLz4KPHBhdGggZD0iTTE1LjYwNDEgMTIuMTkwMkg4LjQ3NTgzVjE5LjI5OTJIMTUuNjA0MVYxMi4xOTAyWiIgZmlsbD0iIzM1NDNBOCIvPgo8cGF0aCBkPSJNMjQuMDc5NyAxMi4xOTAySDE2Ljk1MTRWMTkuMjk5MkgyNC4wNzk3VjEyLjE5MDJaIiBmaWxsPSIjRkY4NjAwIi8+CjxwYXRoIGQ9Ik03LjEyODMxIDIwLjY4NjNIMFYyNy43OTUzSDcuMTI4MzFWMjAuNjg2M1oiIGZpbGw9IiMzNTQzQTgiLz4KPHBhdGggZD0iTTE1LjYwNDEgMjAuNjg2M0g4LjQ3NTgzVjI3Ljc5NTNIMTUuNjA0MVYyMC42ODYzWiIgZmlsbD0iIzM1NDNBOCIvPgo8cGF0aCBkPSJNMjQuMTIzMiAyMC42ODYzSDE2Ljk5NDlWMjcuNzk1M0gyNC4xMjMyVjIwLjY4NjNaIiBmaWxsPSIjMzU0M0E4Ii8+CjxwYXRoIGQ9Ik0xNDYgMTUuODMxM0MxNDYgMTYuODcxNyAxNDUuMTc0IDE3LjY5NTMgMTQ0LjEzMSAxNy42OTUzQzE0My4wODggMTcuNjk1MyAxNDIuMjYyIDE2Ljg3MTcgMTQyLjI2MiAxNS44MzEzQzE0Mi4yNjIgMTQuNzkxIDE0My4wODggMTQuMDEwNyAxNDQuMTMxIDE0LjAxMDdDMTQ1LjEzMSAxMy45Njc0IDE0NiAxNC43OTEgMTQ2IDE1LjgzMTNaTTE0Mi45NTcgMTQuNzkxQzE0Mi42OTcgMTUuMDUxMSAxNDIuNTY2IDE1LjQ0MTIgMTQyLjU2NiAxNS44MzEzQzE0Mi41NjYgMTYuNjk4MyAxNDMuMjYyIDE3LjM5MTggMTQ0LjEzMSAxNy4zOTE4QzE0NSAxNy4zOTE4IDE0NS42OTYgMTYuNjk4MyAxNDUuNjk2IDE1LjgzMTNDMTQ1LjY5NiAxNS4wMDc3IDE0NSAxNC4yNzA4IDE0NC4xNzQgMTQuMjcwOEMxNDMuNjUzIDE0LjI3MDggMTQzLjI2MiAxNC40NDQyIDE0Mi45NTcgMTQuNzkxWk0xNDQuODcgMTYuOTE1SDE0NC40NzlMMTQzLjkxNCAxNi4wOTE0VjE2LjkxNUgxNDMuNjA5VjE0Ljc0NzZIMTQzLjk1N0MxNDQuNDM1IDE0Ljc0NzYgMTQ0LjY1MyAxNC45NjQ0IDE0NC42NTMgMTUuMzU0NUMxNDQuNjUzIDE1LjY1NzkgMTQ0LjQ3OSAxNS44NzQ3IDE0NC4xNzQgMTUuOTYxNEwxNDQuODcgMTYuOTE1Wk0xNDQuMDQ0IDE1LjY1NzlDMTQ0LjI2MSAxNS42NTc5IDE0NC4zOTIgMTUuNTI3OSAxNDQuMzkyIDE1LjM1NDVDMTQ0LjM5MiAxNS4xMzc4IDE0NC4yNjEgMTUuMDUxMSAxNDQuMDAxIDE1LjA1MTFIMTQzLjkxNFYxNS42NTc5SDE0NC4wNDRaIiBmaWxsPSIjMzU0M0E4Ii8+Cjwvc3ZnPgo=" style="\n                text-align: left;\n                width: 146px;\n                position: absolute;\n                top: 24px;\n                left: 40px;"></div>\n                <div style="position: relative;\n                top: 104px;\n                left: 32px;\n                font-size: 20px;\n                text-align: left;\n                font-weight: 700;\n                letter-spacing: 0.02em;\n                font-style: normal;\n                line-height: 125%;">Claim your FREE account and get a key in less than a minute</div>\n                        <ul style="font-size: 15px;\n                        margin-top: 15px;\n                        font-weight: 400;\n                        color: #333333;\n                        letter-spacing: 0.01em;\n                        position: relative;\n                        left: 40px;\n                        top: 103px;\n                        line-height: 180%;">\n                            <li><span>Access to a 30-day free trial of any of our products.</span></li>\n                            <li><span>Access to 24x5 support by developers via the <a\n                                        href="https://support.syncfusion.com/create"\n                                        style="text-decoration: none;\n                            color: #0D6EFD;\n                            font-weight: 500;">support tickets</a>, <a\n                                        href="https://www.syncfusion.com/forums"\n                                        style="text-decoration: none;\n                            color: #0D6EFD;\n                            font-weight: 500;">forum</a>, <a\n                                        href="https://www.syncfusion.com/feedback"\n                                        style="text-decoration: none;\n                            color: #0D6EFD;\n                            font-weight: 500;">feature & feedback page</a> and chat.</span></li>\n                            <li><span>200+ <a\n                                        href="https://www.syncfusion.com/succinctly-free-ebooks"\n                                        style="text-decoration: none;\n                            color: #0D6EFD;\n                            font-weight: 500;">ebooks</a> on the latest technologies, industry trends, and research topics.</span>\n                            </li>\n                            <li><span>Largest collection of over 7,000 flat and wireframe icons for free with Syncfusion <a\n                                        href="https://www.syncfusion.com/downloads/metrostudio"\n                                        style="text-decoration: none;\n                            color: #0D6EFD;\n                            font-weight: 500;">Metro Studio</a>.</span></li>\n                            <li><span>Free and unlimited access to Syncfusion technical <a\n                                        href="https://www.syncfusion.com/blogs/"\n                                        style="text-decoration: none;\n                            color: #0D6EFD;\n                            font-weight: 500;">blogs</a> and <a\n                                        href="https://www.syncfusion.com/resources/techportal/whitepapers"\n                                        style="text-decoration: none;\n                            color: #0D6EFD;\n                            font-weight: 500;">white papers.</a></span></li>\n                        </ul>\n                        <div style="font-size: 18px;\n                        font-weight: 700;\n                        position: relative;\n                        line-height: 125%;\n                        letter-spacing: 0.02em;\n                        top: 113px;\n                        left: 32px;">Syncfusion is trusted by 29,000+ businesses worldwide</div>\n                <img src=\'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iODIwIiBoZWlnaHQ9IjU2IiB2aWV3Qm94PSIwIDAgODIwIDU2IiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPg0KPHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik00MjcuNjE3IDIyLjU2NTlWMjQuNzIyNkM0MjYuNTU4IDI0LjM2MzggNDI1LjM5OCAyNC4xNTQ0IDQyNC40NzQgMjQuMTU0NEM0MjMuMzMzIDI0LjE1NDQgNDIyLjY5OCAyNC40OTEyIDQyMi42OTggMjUuMDk2M0M0MjIuNjk4IDI1LjQ4MjQgNDIyLjk3NiAyNS43MzgzIDQyMy43NzMgMjYuMDg1NEw0MjUuOTE3IDI3LjAxNzRDNDI3LjYzMyAyNy43NjM5IDQyOC40OTcgMjguODUzIDQyOC40OTcgMzAuMjY4MUM0MjguNDk3IDMyLjQ1MjIgNDI2LjU0NiAzMy44MyA0MjMuNDUyIDMzLjgzQzQyMi4zMjQgMzMuODMgNDIxLjAxOCAzMy42NzM2IDQxOS42MzYgMzMuMzcwOVYzMS4xNDE2QzQyMS4wMDYgMzEuNTAyOCA0MjIuMjYyIDMxLjY5NTcgNDIzLjIzOSAzMS42OTU3QzQyNC41MTggMzEuNjk1NyA0MjUuMjAzIDMxLjM1MDYgNDI1LjIwMyAzMC43MDc0QzQyNS4yMDMgMzAuMzIwOCA0MjQuOTM1IDMwLjAzNjcgNDI0LjMyMiAyOS43NzE3TDQyMS45NzUgMjguNzU5M0M0MjAuMjM2IDI4LjAwNzggNDE5LjQzMyAyNi45OTU0IDQxOS40MzMgMjUuNTUyMUM0MTkuNDMzIDIzLjQ4MzcgNDIxLjMxNCAyMi4xNjQ5IDQyNC4yNjUgMjIuMTY0OUM0MjUuMjk4IDIyLjE2NDkgNDI2LjU3IDIyLjMxNzEgNDI3LjYxNyAyMi41NjU5VjIyLjU2NTlaTTQzMC4xNjcgMjIuMzkwOUg0MzMuNjM1VjMzLjYwMzlINDMwLjE2N1YyMi4zOTA5Wk00NDQuOTExIDIyLjM5MDlWMjQuNDQ1MUg0MzkuNjc1VjI2Ljk3NDJINDQ0LjI0OVYyOC44MzIzSDQzOS42NzVWMzEuNDU0M0g0NDQuOTc4VjMzLjYwMzlINDM2LjMwNVYyMi4zOTA5SDQ0NC45MTFaTTQ2MS4yOTQgMjIuMzkwOVYzMy42MDM5SDQ1Ny45MzlWMjYuMjIzNkw0NTQuNjUyIDMzLjY5MTVINDUyLjUzMUw0NDkuMjY2IDI2LjIyMzZWMzMuNjAzOUg0NDYuOTQ5VjIyLjM5MDlINDUxLjE4NEw0NTQuMTc4IDI5LjIxMTRMNDU3LjE1NiAyMi4zOTA5SDQ2MS4yOTRWMjIuMzkwOVpNNDcyLjU3OSAyMi4zOTA5VjI0LjQ0NTFINDY3LjMzNVYyNi45NzQySDQ3MS45MDhWMjguODMyM0g0NjcuMzM1VjMxLjQ1NDNINDcyLjYzOFYzMy42MDM5SDQ2My45NTdWMjIuMzkwOUg0NzIuNTc5Wk00ODQuNzk0IDIyLjM5MDlWMzMuNjAzOUg0ODEuMDkzTDQ3Ni45MjYgMjYuNDEyM1YzMy42MDM5SDQ3NC42MDhWMjIuMzkwOUg0NzguNDA3TDQ4Mi40ODQgMjkuNDg3NlYyMi4zOTA5SDQ4NC43OTRaTTQ5NC44NTggMjIuNTY1OVYyNC43MjI2QzQ5My44MDcgMjQuMzY2MyA0OTIuNjQgMjQuMTU0NCA0OTEuNzMyIDI0LjE1NDRDNDkwLjU3MyAyNC4xNTQ0IDQ4OS45MzkgMjQuNDg1OCA0ODkuOTM5IDI1LjA5M0M0ODkuOTM5IDI1LjQ4ODYgNDkwLjE5OCAyNS43MjUgNDkxLjAyMyAyNi4wODU5TDQ5My4xNTcgMjcuMDE3OEM0OTQuODg1IDI3Ljc3MjIgNDk1LjczOSAyOC44NTE4IDQ5NS43MzkgMzAuMjgzNUM0OTUuNzM5IDMyLjQ1NTkgNDkzLjc4NiAzMy44MzA4IDQ5MC42OTkgMzMuODMwOEM0ODkuNTY5IDMzLjgzMDggNDg4LjI1OSAzMy42NzM2IDQ4Ni44NzggMzMuMzcxN1YzMS4xNDI0QzQ4OC4yNDcgMzEuNTAyOCA0ODkuNDk5IDMxLjY5NjUgNDkwLjQ3IDMxLjY5NjVDNDkxLjc0IDMxLjY5NjUgNDkyLjQ0NCAzMS4zNTE1IDQ5Mi40NDQgMzAuNzI4NUM0OTIuNDQ0IDMwLjMxNjMgNDkyLjE5NyAzMC4wNTA0IDQ5MS41NTUgMjkuNzcyNUw0ODkuMjE4IDI4Ljc2MDFDNDg3LjQ2NyAyOC4wMDI4IDQ4Ni42NzQgMjcuMDAyIDQ4Ni42NzQgMjUuNTUzM0M0ODYuNjc0IDIzLjQ4NjIgNDg4LjU1NiAyMi4xNjY1IDQ5MS41IDIyLjE2NjVDNDkyLjUzNiAyMi4xNjUzIDQ5My44MTMgMjIuMzE3MSA0OTQuODU4IDIyLjU2NTlWMjIuNTY1OVoiIGZpbGw9IiMwMEEwQjAiLz4NCjxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNMzUyLjQxMyAyNi44MTlDMzUwLjk5MiAyNS4yNzU5IDM0OS42MzggMjMuODMxNSAzNDguMzQ5IDIyLjE1NzRMMzQ3LjkyIDIxLjU5OTVDMzQ5LjQwNiAyMS4zNjkzIDM1MC42OTUgMjAuMzg0OCAzNTAuNjk1IDE4Ljc0MzNDMzUwLjY5NSAxNy4yMzMxIDM0OS41MzkgMTYuMjQ4MiAzNDcuODIxIDE2LjI0ODJDMzQ2LjU5OCAxNi4yNDgyIDM0NS43MDYgMTYuMzEzNyAzNDUuMjQzIDE2LjMxMzdDMzQ0LjcxNSAxNi4zMTM3IDM0NC4yODUgMTYuMzEzNyAzNDMuNzkgMTYuMjgwOEMzNDMuODU2IDE4LjE1MjEgMzQzLjg4OSAxOC4yODM0IDM0My44ODkgMTkuNDMyMlYyMy42MzQzQzM0My44ODkgMjQuNDU1MyAzNDMuODU2IDI1LjI3NTkgMzQzLjc5IDI2LjgxODZDMzQ0LjE1MyAyNi43MjAyIDM0NC41MTcgMjYuNzIwMiAzNDQuNzgxIDI2LjcyMDJDMzQ1LjA0NSAyNi43MjAyIDM0NS40MDkgMjYuNzUzMSAzNDUuNzA2IDI2LjgxODZDMzQ1LjY0IDI1Ljc2NzkgMzQ1LjYwNyAyNC4wMjgzIDM0NS42MDcgMjMuNjM0M1YyMS4yMDUxQzM0Ny4xNiAyMy4yMDc3IDM0OS4yMDkgMjUuNjY5NSAzNTAuMDAxIDI2LjgxODZDMzUwLjM5OCAyNi43MjAyIDM1MC43MjggMjYuNzIwMiAzNTEuMTI0IDI2LjcyMDJDMzUxLjQ1NSAyNi43MjA2IDM1MS45MTggMjYuNzIwNiAzNTIuNDEzIDI2LjgxOVYyNi44MTlaTTM0OC44NzggMTkuMDA2QzM0OC44NzggMjAuMDIzNCAzNDguMzE3IDIxLjIwNTQgMzQ2Ljc5NyAyMS4yMDU0QzM0Ni40IDIxLjIwNTQgMzQ2LjAwMyAyMS4yMDU0IDM0NS42MDcgMjEuMTcyNVYxNy4wNjg4QzM0Ni4wMDMgMTYuOTcwNCAzNDYuNDk5IDE2LjkwNDYgMzQ2Ljc2MyAxNi45MDQ2QzM0OC4wODUgMTYuOTA0OSAzNDguODc4IDE3LjY2IDM0OC44NzggMTkuMDA2VjE5LjAwNlpNMzgyLjM4IDI2Ljg4NDVDMzgxLjgxOSAyNi4yOTM2IDM4MC45NiAyNS4zNDE3IDM4MC4xMzQgMjQuNDIyM0MzODAuODI4IDIzLjY2NzIgMzgxLjU1NSAyMi41NTEgMzgxLjk4NCAyMS41OTkxQzM4MS43MTkgMjEuNDY3OCAzODEuMzU2IDIxLjIwNTEgMzgxLjA5MiAyMC45NzUzQzM4MC45OTMgMjEuNzk1OSAzODAuNDMyIDIyLjg3OTIgMzc5LjYzOSAyMy44MzE1QzM3OC41MTUgMjIuNTE4NSAzNzguMjE4IDIyLjE1NzQgMzc3LjE5MyAyMC43Nzg1QzM3OC41ODEgMTkuODkyMSAzNzkuMjQyIDE4Ljg3NDMgMzc5LjI0MiAxOC4wNTM3QzM3OS4yNDIgMTcuMTAxNyAzNzguNTgxIDE2LjExNjkgMzc2Ljk2MiAxNi4xMTY5QzM3NS4yMTEgMTYuMTE2OSAzNzQuMzUyIDE3LjIwMDIgMzc0LjM1MiAxOC40ODAzQzM3NC4zNTIgMTkuMjM1NCAzNzQuNTUgMTkuODkxNyAzNzUuMzc2IDIwLjk3NTNDMzc0LjA1NCAyMS42OTc1IDM3Mi43NjYgMjIuNzQ3OSAzNzIuNzY2IDI0LjQyMjNDMzcyLjc2NiAyNi4wNjM5IDM3NC4wODcgMjYuOTE3NCAzNzUuNzA3IDI2LjkxNzRDMzc3LjE5MyAyNi45MTc0IDM3OC4xNTEgMjYuMzI2NiAzNzguOTEyIDI1LjYzNjlMMzc5LjkwMiAyNi44MTlDMzgwLjIgMjYuNzg2MSAzODAuNTMxIDI2LjcyMDYgMzgwLjg2MSAyNi43MjA2QzM4MS4zMjQgMjYuNzIwNiAzODEuODUyIDI2Ljc4NjEgMzgyLjM4IDI2Ljg4NDVWMjYuODg0NVpNMzgzLjM3MiA0MC4wMTU4QzM4MS45MTggMzguNDczIDM4MC41OTcgMzcuMDYxMiAzNzkuMzA4IDM1LjM4NzFMMzc4Ljg3OCAzNC44Mjg4QzM4MC4zMzIgMzQuNTk5MSAzODEuNjU0IDMzLjYxNSAzODEuNjU0IDMxLjk0MDFDMzgxLjY1NCAzMC40NjMyIDM4MC40OTggMjkuNDQ1NCAzNzguNzc5IDI5LjQ0NTRDMzc3LjU1NyAyOS40NDU0IDM3Ni42MzIgMjkuNTQzNSAzNzYuMTY5IDI5LjU0MzVDMzc1LjY3MyAyOS41NDM1IDM3NS4yNDQgMjkuNTQzNSAzNzQuNzQ4IDI5LjQ3NzZDMzc0LjgxNCAzMS4zODIyIDM3NC44NDggMzEuNDgwMiAzNzQuODQ4IDMyLjYyOTRWMzYuODMxMUMzNzQuODQ4IDM3LjY1MjQgMzc0LjgxNCAzOC41MDUyIDM3NC43NDggNDAuMDE1NEMzNzUuMTEyIDM5Ljk0OTYgMzc1LjQ3NSAzOS45NDk2IDM3NS43MDcgMzkuOTQ5NkMzNzYuMDA0IDM5Ljk0OTYgMzc2LjM2OCAzOS45NDk2IDM3Ni42MzIgNDAuMDE1NEMzNzYuNTY1IDM4Ljk5OCAzNzYuNTMzIDM3LjI1ODEgMzc2LjUzMyAzNi44MzExVjM0LjQzNDhDMzc4LjExOSAzNi40MDQyIDM4MC4xNjcgMzguODk5NiAzODAuOTYgNDAuMDE1NEMzODEuMzU2IDM5Ljk0OTYgMzgxLjY4NyAzOS45NDk2IDM4Mi4wODMgMzkuOTQ5NkMzODIuMzggMzkuOTUgMzgyLjg3NiAzOS45NSAzODMuMzcyIDQwLjAxNThaTTM2Mi4xNiAyNi44MTlDMzYwLjk3MSAyNS41NzE1IDM1OC44ODkgMjIuOTc4IDM1OC4wNjMgMjEuOTkzNUwzNTcuMjM3IDIwLjk3NTdDMzU4LjA5NiAxOS45NTgzIDM1OC42OSAxOS4zMzQxIDM1OS4zMTkgMTguNTc5QzM2MC4wNDUgMTcuNzkxIDM2MC43MDYgMTYuOTcwNCAzNjEuNDk5IDE2LjI0ODJDMzYxLjEzNiAxNi4zMTM3IDM2MC45MzcgMTYuMzEzNyAzNjAuNzM5IDE2LjMxMzdDMzYwLjU0MSAxNi4zMTM3IDM2MC4zNDMgMTYuMzEzNyAzNjAuMTQ0IDE2LjI0ODJDMzU5LjkxMyAxNi42MDkzIDM1OS41NSAxNy4wNjg4IDM1OS4xNTMgMTcuNTI4N0MzNTguNzU2IDE3Ljk1NTYgMzU4LjM2IDE4LjM4MjIgMzU4LjA2MyAxOC43NDMzQzM1Ny4yMzYgMTkuNjk1MiAzNTYuNzc0IDIwLjE1NDcgMzU1LjU4NSAyMS4yNzA5VjE5LjQ2NTVDMzU1LjU4NSAxOC40MTUxIDM1NS41ODUgMTcuNzI1NSAzNTUuNjUxIDE2LjI0ODJDMzU1LjMyMSAxNi4zMTM3IDM1NC45NTcgMTYuMzEzNyAzNTQuNzI2IDE2LjMxMzdDMzU0LjQ2MSAxNi4zMTM3IDM1NC4wMzIgMTYuMzEzNyAzNTMuNzY4IDE2LjI0ODJDMzUzLjgzMyAxNy44MjM5IDM1My44NjcgMTguMjgzNCAzNTMuODY3IDE5LjQzMjVWMjMuNjM0N0MzNTMuODY3IDI0LjY4NSAzNTMuODMzIDI1LjMwODggMzUzLjc2OCAyNi44MTlDMzU0LjE2NCAyNi43MjA2IDM1NC40OTUgMjYuNzIwNiAzNTQuNzI2IDI2LjcyMDZDMzU0Ljk1NyAyNi43MjA2IDM1NS4zNTMgMjYuNzUzNSAzNTUuNjUxIDI2LjgxOUMzNTUuNTg1IDI1LjE0NDkgMzU1LjU4NSAyNC4xNTk3IDM1NS41ODUgMjMuNjM0N1YyMS40MzUyQzM1Ni44MDcgMjIuODc5NiAzNTguNjkgMjUuMjQzMyAzNTkuNzQ4IDI2LjgxOUMzNjAuMTMgMjYuNzU2MyAzNjAuNTE3IDI2LjcyMzQgMzYwLjkwNSAyNi43MjA2QzM2MS4yMDIgMjYuNzIwNiAzNjEuNjY1IDI2LjcyMDYgMzYyLjE2IDI2LjgxOVYyNi44MTlaTTM3Mi42MDEgNDAuMDE1OEMzNzIuNTY4IDM5Ljg1MTkgMzcyLjUzNSAzOS43MjA2IDM3Mi41MzUgMzkuNTIzNEMzNzIuNTM1IDM5LjM5MjggMzcyLjU2OCAzOS4yMjgxIDM3Mi42MDEgMzkuMDk2NEMzNzEuMjggMzkuMTI5NyAzNjguOTAxIDM5LjE5NTIgMzY4LjM3MiAzOS4xOTUyVjM0LjY2NDlDMzY5LjY5NCAzNC42NjQ5IDM3MC45ODIgMzQuNjY0OSAzNzIuMjcgMzQuNzk2M0MzNzIuMjM4IDM0LjYzMjQgMzcyLjIwNCAzNC40Njc3IDM3Mi4yMDQgMzQuMzM2NEMzNzIuMjA0IDM0LjIwNTggMzcyLjIwNCAzNC4wNDE5IDM3Mi4yNyAzMy44NDQ3QzM3MS4zNDYgMzMuOTQyOCAzNjkuMTk4IDMzLjk3NiAzNjguMzcyIDMzLjk3NlYzMC4yNjZDMzY5LjgyNiAzMC4yNjYgMzcwLjY4NSAzMC4yNjYgMzcxLjE4IDMwLjI5OTNMMzcyLjUwMiAzMC4zNjUxQzM3Mi40MzYgMzAuMTY3OSAzNzIuNDM2IDMwLjA2OTIgMzcyLjQzNiAyOS45MDUzQzM3Mi40MzYgMjkuNzQxNCAzNzIuNDM2IDI5LjcwODEgMzcyLjUwMiAyOS40NDU4QzM3MS40MTEgMjkuNDc4MyAzNjkuOTI1IDI5LjU0MzggMzY5LjI2NCAyOS41NDM4QzM2OC44MDIgMjkuNTQzOCAzNjcuMzQ4IDI5LjUxMTMgMzY2LjU4NyAyOS40NDU4QzM2Ni42NTQgMzAuMjY2NCAzNjYuNjg2IDMxLjYxMjMgMzY2LjY4NiAzMi41NjQyVjM2Ljg2NTFDMzY2LjY4NiAzNy40ODg1IDM2Ni42MiAzOC43MzU3IDM2Ni41ODcgNDAuMDE2MkMzNjcuNTEzIDM5Ljk1MDMgMzY4LjgwMiAzOS45NTAzIDM2OS4yNjQgMzkuOTUwM0MzNzAuMDI0IDM5Ljk1IDM3MS42NDMgMzkuOTUgMzcyLjYwMSA0MC4wMTU4Wk0zNjQuNjA1IDM5LjEyOTRDMzY0LjQ0IDM4LjgwMDggMzY0LjM0MSAzOC4zMDg4IDM2NC4yNzUgMzguMDQ2MUMzNjIuOTIgMzkuMTYxOSAzNjEuOTk1IDM5LjM5MjQgMzYwLjkzOCAzOS4zOTI0QzM1OC41OTIgMzkuMzkyNCAzNTcuMzM3IDM3LjI5MTMgMzU3LjMzNyAzNC42NjQ5QzM1Ny4zMzcgMzEuNzQzNiAzNTguNzU3IDMwLjAzNjIgMzYxLjE2OSAzMC4wMzYyQzM2Mi40MjUgMzAuMDM2MiAzNjMuNjE0IDMwLjU5NDUgMzY0LjE3NiAzMS4xNTI4QzM2NC4yMDggMzAuODg5OCAzNjQuMzA4IDMwLjM2NDggMzY0LjQ3MyAzMC4wNjg4QzM2My4zMTYgMjkuNTExMyAzNjIuMjU5IDI5LjM0NjYgMzYxLjEwMiAyOS4zNDY2QzM1Ny4yMzcgMjkuMzQ2NiAzNTUuNDUzIDMxLjc0MzYgMzU1LjQ1MyAzNC44Mjg4QzM1NS40NTMgMzguMzA5MSAzNTcuNzk4IDQwLjE0NzEgMzYwLjczOSA0MC4xNDcxQzM2Mi40MjUgNDAuMTQ3MSAzNjMuODEyIDM5LjYyMjIgMzY0LjYwNSAzOS4xMjk0VjM5LjEyOTRaTTM0Mi4zMDMgMjYuODE5QzM0MC41MTkgMjMuNDA0OSAzMzguOCAxOS4xMzczIDMzNy41NzggMTYuMTE2OUgzMzcuMzhDMzM2LjU4NyAxOC4wMjA3IDMzNS4xMzMgMjEuMjcwOSAzMzQuNzM3IDIyLjE4OTlDMzM0LjI3NCAyMy4zMDYxIDMzMy4yNSAyNS41MDU2IDMzMi41ODkgMjYuODE4NkMzMzIuODAzIDI2Ljc1MzggMzMzLjAyNiAyNi43MjA2IDMzMy4yNSAyNi43MjAyQzMzMy40NDggMjYuNzIwMiAzMzMuNjEzIDI2Ljc1MzEgMzMzLjg0NSAyNi44MTg2QzMzNC4xNzUgMjUuOTMyMiAzMzQuNjM4IDI0LjgxNiAzMzUuMTMzIDIzLjYzNDNDMzM1Ljc5NCAyMy42MDE0IDMzNi4zODkgMjMuNTY4OCAzMzYuOTg0IDIzLjU2ODhDMzM3LjYxMiAyMy41Njg4IDMzOC4yNzIgMjMuNjAxNCAzMzguOTMzIDIzLjYzNDNMMzM5LjU5NCAyNS4yMUwzNDAuMjU1IDI2LjgxODZDMzQwLjcxNyAyNi43MjAyIDM0MS4wOCAyNi43MjAyIDM0MS4zMTIgMjYuNzIwMkMzNDEuNjA5IDI2LjcyMDYgMzQxLjg3MyAyNi43MjA2IDM0Mi4zMDMgMjYuODE5VjI2LjgxOVpNMzUzLjYzNiAyOS40NDU0QzM1My40MzggMjkuNTExMyAzNTMuMjczIDI5LjU0MzUgMzUzLjEwNyAyOS41NDM1QzM1Mi45MDkgMjkuNTQzNSAzNTIuNzQ0IDI5LjUxMDkgMzUyLjU0NiAyOS40NDU0QzM1Mi42NDQgMzAuNzU4NCAzNTIuNjc4IDMyLjA3MTQgMzUyLjY3OCAzMy4zNTE5VjM2LjczMzRDMzUyLjE0OSAzNi4yNzM2IDM1MC44NiAzNS4wOTE5IDM0OS4zNzQgMzMuNzEzQzM0Ny44NiAzMi4zMDc0IDM0Ni4zOTQgMzAuODUxMSAzNDQuOTc5IDI5LjM0NjZIMzQ0Ljc0OEMzNDQuNzgxIDMwLjgyNDMgMzQ0LjgxNCAzMi40IDM0NC44MTQgMzMuODExNFYzNS44Nzk5QzM0NC44MTQgMzcuNjUyOCAzNDQuODE0IDM4LjYwNDcgMzQ0LjcxNSA0MC4wMTYyQzM0NC45OCAzOS45NTAzIDM0NS4xMTIgMzkuOTUwMyAzNDUuMzEgMzkuOTUwM0MzNDUuNDQyIDM5Ljk1MDMgMzQ1LjU3NSAzOS45NTAzIDM0NS44MDYgNDAuMDE2MkMzNDUuNzQgMzguNjcwNiAzNDUuNzA3IDM2LjQ3MDggMzQ1LjcwNyAzNS44Nzk5VjMyLjU5NjhDMzQ4LjE4NSAzNC44NjI1IDM1MS4yMjQgMzcuODgyNiAzNTMuNDcxIDQwLjE0NzVIMzUzLjYwM0MzNTMuNjAzIDM4LjkzMjkgMzUzLjUzNyAzNy43MTc5IDM1My41MzcgMzYuNTA0VjM0LjYzMjdDMzUzLjUzNiAzMi40MzI1IDM1My41MzYgMzEuMzQ5MyAzNTMuNjM2IDI5LjQ0NTRaTTM0Mi41NjcgNDAuMDE1OEMzNDIuNTM0IDM5Ljg1MTkgMzQyLjUwMSAzOS43MjA2IDM0Mi41MDEgMzkuNTIzNEMzNDIuNTAxIDM5LjM5MjggMzQyLjUzNCAzOS4yMjgxIDM0Mi41NjcgMzkuMDk2NEMzNDEuMjQ2IDM5LjEyOTcgMzM4Ljg2NyAzOS4xOTUyIDMzOC4zNzEgMzkuMTk1MlYzNC42NjQ5QzMzOS42NiAzNC42NjQ5IDM0MC45NDggMzQuNjY0OSAzNDIuMjM3IDM0Ljc5NjNDMzQyLjIwNCAzNC42MzI0IDM0Mi4xNzEgMzQuNDY3NyAzNDIuMTcxIDM0LjMzNjRDMzQyLjE3MSAzNC4yMDU4IDM0Mi4xNzEgMzQuMDQxOSAzNDIuMjM3IDMzLjg0NDdDMzQxLjMxMiAzMy45NDI4IDMzOS4xOTcgMzMuOTc2IDMzOC4zNzEgMzMuOTc2VjMwLjI2NkMzMzkuNzkyIDMwLjI2NiAzNDAuNjUxIDMwLjI2NiAzNDEuMTc5IDMwLjI5OTNMMzQyLjQ2OCAzMC4zNjUxQzM0Mi40MzUgMzAuMTY3OSAzNDIuNDM1IDMwLjA2OTIgMzQyLjQzNSAyOS45MDUzQzM0Mi40MzUgMjkuNzQxNCAzNDIuNDM1IDI5LjY3NTUgMzQyLjQ2OCAyOS40NDU4QzM0MS4zNzggMjkuNDc4MyAzMzkuODkxIDI5LjU0MzggMzM5LjIzIDI5LjU0MzhDMzM4Ljc2NyAyOS41NDM4IDMzNy4zMTQgMjkuNTExMyAzMzYuNTU0IDI5LjQ0NThDMzM2LjYyIDMwLjI2NjQgMzM2LjY1MyAzMS42MTIzIDMzNi42NTMgMzIuNTY0MlYzNi44NjUxQzMzNi42NTMgMzcuNDg4NSAzMzYuNTg3IDM4LjczNTcgMzM2LjU1NCA0MC4wMTYyQzMzNy41MTIgMzkuOTUwMyAzMzguNzY3IDM5Ljk1MDMgMzM5LjIzIDM5Ljk1MDNDMzM5Ljk5IDM5Ljk1IDM0MS42NDIgMzkuOTUgMzQyLjU2NyA0MC4wMTU4VjQwLjAxNThaTTMzMS4yMDEgMjYuODE5QzMzMC42NzMgMjMuMjQwNiAzMzAuMjEgMTkuNDk4NCAzMjkuODQ3IDE2LjExNjlDMzI5Ljc0OCAxNi4xNDk4IDMyOS43MTQgMTYuMTQ5OCAzMjkuNjQ5IDE2LjExNjlDMzI4Ljk1NSAxNy4zMzE1IDMyOC4xNjIgMTguNjQ0NSAzMjcuNTY3IDE5LjU2MzlDMzI3LjAwNiAyMC40NTAzIDMyNi4zNDUgMjEuNTAwNyAzMjUuNTg1IDIyLjYxNjlDMzIzLjk5OSAyMC41ODE3IDMyMi4zNDcgMTguMDIxMSAzMjEuMjU2IDE2LjExNjlDMzIxLjE5IDE2LjE0OTggMzIxLjE1NyAxNi4xMTY5IDMyMS4wOTEgMTYuMTE2OUMzMjAuNzI4IDE5LjQ5OCAzMjAuMjMyIDIzLjI3MzIgMzE5LjczNiAyNi44MTlDMzIwLjAwMSAyNi43MjA2IDMyMC4xNjYgMjYuNzIwNiAzMjAuMjk4IDI2LjcyMDZDMzIwLjQ5NiAyNi43MjA2IDMyMC42MjggMjYuNzUzNSAzMjAuODU5IDI2LjgxOUMzMjAuOTkyIDI0LjQ1NTMgMzIxLjI1NiAyMi4xMjQ0IDMyMS41NTMgMTkuNjYyM0MzMjIuODQyIDIxLjUzMzYgMzIzLjk2NSAyMy4xNDIyIDMyNS4yMjEgMjQuODQ5M0MzMjYuMjc4IDIzLjIwNzcgMzI3LjM2OCAyMS40MzQ4IDMyOC41NTggMTkuNjI5NEMzMjguODg4IDIyLjE1NyAzMjkuMTg2IDI0LjQ1NTMgMzI5LjM1MSAyNi44MTlDMzI5Ljc4IDI2LjcyMDYgMzMwLjA3OCAyNi43MjA2IDMzMC4yNzYgMjYuNzIwNkMzMzAuNTQgMjYuNzIwNiAzMzAuODA1IDI2LjcyMDYgMzMxLjIwMSAyNi44MTlWMjYuODE5Wk0zMzQuOTY4IDMyLjIwMjhDMzM0Ljk2OCAzMC4yOTg5IDMzMy40NDggMjkuNDQ1NCAzMzEuNTk4IDI5LjQ0NTRDMzMwLjc3MiAyOS40NDU0IDMyOS44OCAyOS41NDM1IDMyOS4yNTIgMjkuNTQzNUMzMjkuMDIxIDI5LjU0MzUgMzI4LjUyNSAyOS41NDM1IDMyNy45OTcgMjkuNDc3NkMzMjguMDMgMzAuNTI4MyAzMjguMDk2IDMxLjQxNDggMzI4LjA5NiAzMi40MzIyVjM2LjkyOTVDMzI4LjA5NiAzNy45MTQ4IDMyOC4wMyAzOC45OTggMzI3Ljk5NyA0MC4wMTU0QzMyOC40MjYgMzkuOTQ5NiAzMjguNzI0IDM5Ljk0OTYgMzI4LjkyMiAzOS45NDk2QzMyOS4xNTMgMzkuOTQ5NiAzMjkuNDg0IDM5Ljk0OTYgMzI5Ljg4IDQwLjAxNTRDMzI5LjgxNSAzOS4wMzE5IDMyOS43ODIgMzguMDQ2NSAzMjkuNzgxIDM3LjA2MDlWMzUuNDJDMzMwLjE0NSAzNS40NTI2IDMzMC41MDggMzUuNDUyNiAzMzAuOTA1IDM1LjQ1MjZDMzMyLjgyIDM1LjQ1MjYgMzM0Ljk2OCAzNC43MzA0IDMzNC45NjggMzIuMjAyOFYzMi4yMDI4Wk0zMjYuMDE0IDM2Ljg5NzNDMzI2LjAxNCAzNS4yNTU4IDMyNC45MjQgMzQuNTMzNiAzMjMuMDQgMzMuNzQ1NkMzMjEuNjg2IDMzLjE4OCAzMjAuOTkyIDMyLjY5NTYgMzIwLjk5MiAzMS42NDQ1QzMyMC45OTIgMzAuNjYgMzIxLjc1MiAzMC4wMzYyIDMyMy4wMDggMzAuMDM2MkMzMjMuODM0IDMwLjAzNjIgMzI0LjU2MSAzMC4zMzE1IDMyNS4yMjIgMzAuODU2OEMzMjUuMjg3IDMwLjQ5NTcgMzI1LjQ1MyAzMC4xMzQ3IDMyNS42NTEgMjkuODM5NEMzMjQuODU4IDI5LjQ3ODMgMzIzLjk5OSAyOS4zNDcgMzIzLjA3NCAyOS4zNDdDMzIwLjM2NSAyOS4zNDcgMzE5LjUwNSAzMC44OTA1IDMxOS41MDUgMzIuMjAzNUMzMTkuNTA1IDMzLjgxMTggMzIwLjI5OSAzNC41NjcyIDMyMi4zNDcgMzUuMzU1M0MzMjMuNjM2IDM1Ljg0NyAzMjQuMjk2IDM2LjQ3MTEgMzI0LjI5NiAzNy41NTQ0QzMyNC4yOTYgMzguNzAzNSAzMjMuNDM3IDM5LjQyNTcgMzIyLjI0OCAzOS40MjU3QzMyMS41NTQgMzkuNDI1NyAzMjAuMzY1IDM5LjA2NDYgMzE5LjUzOSAzOC4zMDk5QzMxOS41MDUgMzguNzM2MSAzMTkuNTA1IDM5LjEzMDQgMzE5LjM3MyAzOS40OTE1QzMxOS45MDIgMzkuNzU0NiAzMjEuMTI1IDQwLjE0NzkgMzIyLjIxNSA0MC4xNDc5QzMyNC45OSA0MC4xNDcxIDMyNi4wMTQgMzguNDM5NyAzMjYuMDE0IDM2Ljg5NzNWMzYuODk3M1pNMzc4LjE1MiAxNy45ODgyQzM3OC4xNTIgMTguOTczIDM3Ny40NTggMTkuNjYyMyAzNzYuNzY0IDIwLjIyMDJDMzc2LjMwMSAxOS41NjM5IDM3NS43NCAxOC42NzcxIDM3NS43NCAxNy45ODgyQzM3NS43NCAxNy4yMzMxIDM3Ni4yNjggMTYuODA2MSAzNzYuOTk1IDE2LjgwNjFDMzc3Ljk4NyAxNi44MDY1IDM3OC4xNTIgMTcuNjkyNiAzNzguMTUyIDE3Ljk4ODJWMTcuOTg4MlpNMzc4LjQ4MiAyNS4wMTMyQzM3OC4xMTkgMjUuMzQxNyAzNzcuMjYgMjUuOTY1NSAzNzYuNTMzIDI1Ljk2NTVDMzc1LjU3NCAyNS45NjU1IDM3NC40MTggMjUuMjc1OSAzNzQuNDE4IDIzLjc5ODZDMzc0LjQxOCAyMi40ODU1IDM3NS4yNzcgMjEuODk0NyAzNzUuODA2IDIxLjU2NjVDMzc3LjAyOCAyMy4yNDA2IDM3Ny4wOTUgMjMuMzM5MSAzNzguNDgyIDI1LjAxMzJaTTM3OS44MDQgMzIuMjAyOEMzNzkuODA0IDMzLjI1MzUgMzc5LjI3NSAzNC40MDI2IDM3Ny43NTUgMzQuNDAyNkMzNzcuMzI2IDM0LjQwMjYgMzc2LjkyOSAzNC40MDI2IDM3Ni41MzMgMzQuMzY5M1YzMC4yNjU2QzM3Ni45MjkgMzAuMTY3NiAzNzcuNDI1IDMwLjEzNDMgMzc3LjcyMiAzMC4xMzQzQzM3OS4wMTEgMzAuMTM0MyAzNzkuODA0IDMwLjg4OTggMzc5LjgwNCAzMi4yMDI4Wk0zMzguNjAyIDIyLjgxNDFDMzM3LjkwOSAyMi44NDY2IDMzNy41NDUgMjIuODQ2NiAzMzcuMDgyIDIyLjg0NjZDMzM2LjUyMSAyMi44NDY2IDMzNi4xOSAyMi44NDY2IDMzNS40NjMgMjIuODE0MUwzMzcuMDgyIDE5LjAwNkwzMzguNjAyIDIyLjgxNDFaTTMzMy4xNTEgMzIuMzAwOEMzMzMuMTUxIDMzLjgxMTEgMzMyLjI1OCAzNC43OTU5IDMzMC44MDUgMzQuNzk1OUMzMzAuNTA3IDM0Ljc5NTkgMzMwLjE3NyAzNC43OTU5IDMyOS43OCAzNC43MzAxVjMwLjIzMjdDMzMwLjI0MyAzMC4xNjY5IDMzMC42MzkgMzAuMTMzOSAzMzEuMDM2IDMwLjEzMzlDMzMyLjQyNCAzMC4xMzQzIDMzMy4xNTEgMzEuMDIxMSAzMzMuMTUxIDMyLjMwMDhaTTM2OS41MjggMjMuNjY3NkMzNjkuNTI4IDIyLjAyNiAzNjguNDM4IDIxLjMwMzkgMzY2LjU1NSAyMC41MTYyQzM2NS4yIDE5Ljk1ODMgMzY0LjUwNiAxOS40OTg4IDM2NC41MDYgMTguNDE1MUMzNjQuNTA2IDE3LjQ2MzIgMzY1LjI2NiAxNi44MDY1IDM2Ni41MjEgMTYuODA2NUMzNjcuMzQ4IDE2LjgwNjUgMzY4LjA3NSAxNy4xMDE3IDM2OC43MzUgMTcuNjI3NUMzNjguODAyIDE3LjI2NjQgMzY4Ljk2NyAxNi45MDQ5IDM2OS4xMzEgMTYuNjQyMkMzNjguMzcyIDE2LjI4MTEgMzY3LjQ3OSAxNi4xMTcyIDM2Ni41ODcgMTYuMTE3MkMzNjMuOTQ0IDE2LjExNzIgMzYyLjk4NiAxNy42NiAzNjIuOTg2IDE5LjAwNkMzNjIuOTg2IDIwLjU4MTcgMzYzLjgxMiAyMS4zMzY4IDM2NS44NjEgMjIuMTI0NEMzNjcuMTQ5IDIyLjYxNjkgMzY3LjgxIDIzLjI0MDYgMzY3LjgxIDI0LjM1NjhDMzY3LjgxIDI1LjQ3MyAzNjYuOTUxIDI2LjE5NTIgMzY1Ljc2MiAyNi4xOTUyQzM2NS4wMzUgMjYuMTk1MiAzNjMuODc5IDI1LjgzNDEgMzYzLjA1MiAyNS4xMTE5QzM2My4wMiAyNS41Mzg5IDM2Mi45ODYgMjUuOSAzNjIuODg3IDI2LjI2MTFDMzYzLjM4MyAyNi41MjM4IDM2NC42MDYgMjYuOTE3NCAzNjUuNzI5IDI2LjkxNzRDMzY4LjUwNCAyNi45MTc0IDM2OS41MjggMjUuMjQzMyAzNjkuNTI4IDIzLjY2NzZWMjMuNjY3NloiIGZpbGw9IiMwMzY1NTUiLz4NCjxwYXRoIGQ9Ik02NDAuNDE2IDIwLjU1NzNDNjM4LjY3MSAxOS44MzU0IDYzNy42MzEgMTkuNTU1MSA2MzYuNTk4IDE5LjU1NTFDNjM1LjUxNCAxOS41NTUxIDYzNC44MTkgMTkuOTE3IDYzNC44MTkgMjAuNDc2NUM2MzQuODE5IDIyLjE2NDUgNjQwLjk2MiAyMS42ODkzIDY0MC45NjIgMjUuNTkzNkM2NDAuOTYyIDI3Ljc0NjQgNjM5LjAyNCAyOC45OTc0IDYzNi4zMzIgMjguOTk3NEM2MzQuMjIgMjguOTk3NCA2MzMuMTggMjguNDg4IDYzMS45ODMgMjcuOTExNlYyNS40OTYyQzYzMy43MSAyNi41NjM1IDYzNC43NjggMjYuOTQwMSA2MzYuMTAxIDI2Ljk0MDFDNjM3LjI1NiAyNi45NDAxIDYzNy44NzkgMjYuNTYzNSA2MzcuODc5IDI1LjkwNjNDNjM3Ljg3OSAyNC4wNjg1IDYzMS43MzcgMjQuNzQxNSA2MzEuNzM3IDIwLjcyMTNDNjMxLjczNyAxOC43ODI3IDYzMy41MzQgMTcuNDk5IDYzNi4zMzIgMTcuNDk5QzYzNy42ODIgMTcuNDk5IDYzOC45MDEgMTcuNzYzNSA2NDAuNDE2IDE4LjM3MDdWMjAuNTU3M1pNNjQ5LjAxNiAyOC40ODQxQzY0Ny45OTIgMjguODMwNiA2NDcuMTI2IDI4Ljk5NTQgNjQ2LjI2MiAyOC45OTU0QzY0My40MDIgMjguOTk1NCA2NDEuNTUyIDI3LjQ0MjIgNjQxLjU1MiAyNS4wNzkyQzY0MS41NTIgMjIuNzU5NCA2NDMuNDczIDIxLjEyMDIgNjQ2LjE1NiAyMS4xMjAyQzY0Ni45ODUgMjEuMTIwMiA2NDguMDQ0IDIxLjMxODIgNjQ4Ljg5MSAyMS42MTIzVjIzLjM4ODFDNjQ4LjIyMSAyMy4wNTYyIDY0Ny40NDQgMjIuODc0MSA2NDYuODA5IDIyLjg3NDFDNjQ1LjI3MyAyMi44NzQxIDY0NC4yODYgMjMuNzM0MyA2NDQuMjg2IDI1LjA2MTlDNjQ0LjI4NiAyNi40MDggNjQ1LjI1NiAyNy4yOTQgNjQ2LjcyIDI3LjI5NEM2NDcuMzM3IDI3LjI5NCA2NDcuODg2IDI3LjE2MjMgNjQ5LjAxNiAyNi43NjhMNjQ5LjAxNiAyOC40ODQxWk02NzEuMzIgMjQuMjA5QzY3MS40MjUgMjMuMTU0OCA2NzIuMDgxIDIyLjU0NTcgNjczLjA4NyAyMi41NDU3QzY3NC4wNzYgMjIuNTQ1NyA2NzQuNzQ2IDIzLjE3MjEgNjc0Ljg1MiAyNC4yMDlINjcxLjMyWk02NzIuOTEgMjEuMTIyOUM2NzAuNCAyMS4xMjI5IDY2OC42MTQgMjIuNzc1NSA2NjguNjE0IDI1LjEwMTJDNjY4LjYxNCAyNy40NDQxIDY3MC40NzEgMjguOTk1NCA2NzMuMzM1IDI4Ljk5NTRDNjczLjk3IDI4Ljk5NTQgNjc1LjUwNCAyOC45OTU0IDY3Ni45NjYgMjcuOTg3VjI2LjUwNDJDNjc1Ljc2OSAyNy4yOTkzIDY3NC45NzcgMjcuNTczMSA2NzMuOTU1IDI3LjU3MzFDNjcyLjM0MSAyNy41NzMxIDY3MS4zNTQgMjYuNzk0OSA2NzEuMjY1IDI1LjQ2NjZINjc3LjExQzY3Ny4yMzIgMjIuNjkzOSA2NzUuMjc5IDIxLjEyMjkgNjcyLjkxIDIxLjEyMjlWMjEuMTIyOVpNNjc4LjA5OSAyOC44NTcySDY4MC42NTRWMjEuMjYyN0g2NzguMDk5VjI4Ljg1NzJaTTY4Ny43NjcgMjYuNzgxNUM2ODcuMjM0IDI3LjIyODEgNjg2Ljc5MiAyNy40MDcyIDY4Ni4yNDYgMjcuNDA3MkM2ODUuMDQzIDI3LjQwNzIgNjg0LjI4MSAyNi40ODM4IDY4NC4yODEgMjUuMTAwNEM2ODQuMjgxIDIzLjU4NDEgNjg1LjA0MyAyMi43MTAxIDY4Ni4zMzEgMjIuNzEwMUM2ODYuNzkyIDIyLjcxMDEgNjg3LjM5NCAyMi45MDggNjg3Ljc2NyAyMy4xNTU5VjI2Ljc4MTVaTTY4Ny43NjcgMTcuNjM5MVYyMS41OTU4QzY4Ny4wNzYgMjEuMjg0NyA2ODYuMzg4IDIxLjEyMDIgNjg1LjY0NCAyMS4xMjAyQzY4My4zMTMgMjEuMTIwMiA2ODEuNyAyMi43MjY2IDY4MS43IDI1LjA1MDdDNjgxLjcgMjcuMzI0OCA2ODMuMzEzIDI4Ljk5NzQgNjg1LjUgMjguOTk3NEM2ODYuMzY3IDI4Ljk5NzQgNjg3LjAzNyAyOC43ODU2IDY4Ny43NjcgMjguMjQzNVYyOC44NTQ5SDY5MC4zMjJWMTcuNjM5MUg2ODcuNzY3Wk02OTQuMTA1IDI0LjIwOUM2OTQuMjExIDIzLjE1NDggNjk0Ljg2NCAyMi41NDU3IDY5NS44NjggMjIuNTQ1N0M2OTYuODU4IDIyLjU0NTcgNjk3LjUzNSAyMy4xNzIxIDY5Ny42NDEgMjQuMjA5SDY5NC4xMDVaTTY5NS42OTQgMjEuMTIyOUM2OTMuMTg0IDIxLjEyMjkgNjkxLjQgMjIuNzc1NSA2OTEuNCAyNS4xMDEyQzY5MS40IDI3LjQ0NDEgNjkzLjI1OSAyOC45OTU0IDY5Ni4xMTkgMjguOTk1NEM2OTYuNzUzIDI4Ljk5NTQgNjk4LjI5IDI4Ljk5NTQgNjk5Ljc1NSAyNy45ODdWMjYuNTA0MkM2OTguNTU3IDI3LjI5OTMgNjk3Ljc2MyAyNy41NzMxIDY5Ni43MzYgMjcuNTczMUM2OTUuMTMxIDI3LjU3MzEgNjk0LjE0IDI2Ljc5NDkgNjk0LjA1MSAyNS40NjY2SDY5OS44OTRDNzAwLjAxNSAyMi42OTM5IDY5OC4wNjEgMjEuMTIyOSA2OTUuNjk0IDIxLjEyMjkiIGZpbGw9IiMwMDlFNEQiLz4NCjxwYXRoIGQ9Ik03MDMuNzIxIDIzLjQzNjhINzAzLjc1OEM3MDQuNTE3IDIxLjg1NjIgNzA1LjM2NiAyMS4xMTUgNzA2LjM1MiAyMS4xMTVDNzA2Ljg2MiAyMS4xMTUgNzA3LjMwMyAyMS4yOTY0IDcwOC4wNDQgMjEuODA3Nkw3MDcuMzQxIDIzLjkxMzNDNzA2LjY3IDIzLjUxODYgNzA2LjIyOSAyMy4zNTM1IDcwNS44MjMgMjMuMzUzNUM3MDQuODg2IDIzLjM1MzUgNzA0LjI4NiAyNC4xNzc1IDcwMy43MjEgMjUuNTcwNFYyOC44NDY2SDcwMS4xNjJWMjEuMjU0MUg3MDMuNzIxVjIzLjQzNjhaTTY4MC43NzUgMTguMDY3NEM2ODEuMDE1IDE4LjY1NzUgNjgwLjU4MyAxOS40ODA1IDY3OS44MTQgMTkuOTA0QzY3OS4wNDEgMjAuMzI3MSA2NzguMjI0IDIwLjE5MjggNjc3Ljk4NiAxOS42MDI3QzY3Ny43NDMgMTkuMDExNyA2NzguMTczIDE4LjE4NzcgNjc4Ljk0NSAxNy43NjY2QzY3OS43MTYgMTcuMzQxMSA2ODAuNTMzIDE3LjQ3NTkgNjgwLjc3NSAxOC4wNjc0WiIgZmlsbD0iIzAwOUU0RCIvPg0KPHBhdGggZD0iTTY1OC4yMiAyNC4wMjMxQzY1OC4yMiAyMS45NjUxIDY1Ni43MTkgMjEuMTIyNiA2NTUuMjM5IDIxLjEyMjZDNjU0LjIzMiAyMS4xMjI2IDY1My40MDQgMjEuNTE4NCA2NTIuNjY0IDIyLjM5MjFINjUyLjYyOVYxNy42MzkySDY1MC4wNzFWMjguODM1M0g2NTIuNjI5VjI0LjAyMzFDNjUzLjIyOCAyMy4yMTYxIDY1My43MzggMjIuODcxMSA2NTQuMzM4IDIyLjg3MTFDNjU1LjEzNCAyMi44NzExIDY1NS42NjIgMjMuMzk4NiA2NTUuNjYyIDI0LjUzMjlWMjcuMjAwOEM2NTYuNTIgMjYuNzg5NiA2NTcuMzkzIDI2LjUzNzQgNjU4LjIyIDI2LjQ0MzhWMjQuMDIzMVpNNjY0LjYzNiAyMS4xMTk5QzY2My41OTQgMjEuMTE5OSA2NjIuNzk5IDIxLjQ4MTEgNjYxLjk4NCAyMi4zNDkzVjIxLjI2MjRINjU5LjQyOFYyNi40MjM0QzY2MC4zMTMgMjYuNTA1OCA2NjEuNDQzIDI2Ljg4NDcgNjYxLjk4NCAyNy41MTA0VjIzLjk2MzRDNjYyLjY1NyAyMy4wMjMyIDY2My4xMzQgMjIuNzA5NyA2NjMuNzcgMjIuNzA5N0M2NjQuNDk0IDIyLjcwOTcgNjY1LjA0NSAyMy4xNTU2IDY2NS4wNDUgMjQuMjI2NFYyOC44MzcySDY2Ny42MDJWMjQuMDI4OUM2NjcuNjAyIDIxLjc5MjYgNjY1LjkwOCAyMS4xMTk5IDY2NC42MzYgMjEuMTE5OVYyMS4xMTk5Wk02NjkuMDE1IDMxLjAxODFINjY2LjA0M1YzMi45ODY0SDY2OC45MDlWMzMuODMxMkg2NjYuMDQzVjM1Ljg2MTlINjY5LjEwM1YzNi43MDU1SDY2NS4wNDZWMzAuMTc1Mkg2NjkuMDE1TDY2OS4wMTUgMzEuMDE4MVpNNjcxLjQ0MiAzNi43MDkzSDY3Mi4zNTJWMzAuMTczM0g2NzEuNDQyVjM2LjcwOTNaTTY3Ni44NTkgMzMuMDQ4NEM2NzcuNTA0IDMzLjA0ODQgNjc3LjkwNCAzMy40NjMxIDY3Ny45MzUgMzQuMTE0Mkg2NzUuNjE2QzY3NS43NDIgMzMuNDM0MiA2NzYuMTYxIDMzLjA0ODQgNjc2Ljg1OSAzMy4wNDg0Wk02NzUuNiAzNC42ODFINjc4Ljg0MkM2NzguODQyIDMzLjA4NjkgNjc4LjA2MiAzMi4zMTggNjc2LjgzOCAzMi4zMThDNjc1LjU2OSAzMi4zMTggNjc0LjY4OCAzMy4xOTI0IDY3NC42ODggMzQuNDk2OUM2NzQuNjg4IDM1LjY4OSA2NzUuNDg0IDM2Ljc4OTggNjc2LjkxNyAzNi43ODk4QzY3Ny42OTggMzYuNzg5OCA2NzguMjAzIDM2LjYyODEgNjc4Ljc2MyAzNi4yODJWMzUuNDU2QzY3OC4yMjIgMzUuNzg1NiA2NzcuNjk4IDM1Ljk3NTggNjc3LjE0NyAzNS45NzU4QzY3Ni4yNjUgMzUuOTc1OCA2NzUuNzQyIDM1LjUzNSA2NzUuNiAzNC42ODA2VjM0LjY4MVpNNjg0Ljc4NiAzMy41MzA5QzY4NC4yNjMgMzMuMTk2NiA2ODMuOTE0IDMzLjA5ODUgNjgzLjUxNSAzMy4wOTg1QzY4Mi42ODIgMzMuMDk4NSA2ODIuMTA1IDMzLjY5NDUgNjgyLjEwNSAzNC41NjdDNjgyLjEwNSAzNS40NTYgNjgyLjcxOSAzNS45OTE2IDY4My42NjggMzUuOTkxNkM2ODQuMDU4IDM1Ljk5MTYgNjg0LjQzIDM1Ljg5NzMgNjg0Ljg4OCAzNS43MDU5VjM2LjU0MjZDNjg0LjU4MiAzNi42Nzc0IDY4My45OTcgMzYuNzg5OCA2ODMuNTE1IDM2Ljc4OThDNjgyLjEzNiAzNi43ODk4IDY4MS4xOCAzNS45MDYyIDY4MS4xOCAzNC42NDMyQzY4MS4xOCAzMy4yMTc4IDY4Mi4wNTQgMzIuMzE4IDY4My40NTMgMzIuMzE4QzY4My45ODcgMzIuMzE4IDY4NC4zNDYgMzIuNDMzOSA2ODQuNzg3IDMyLjYxNDVMNjg0Ljc4NiAzMy41MzA5Wk02ODguOTM0IDMyLjQwMDRINjkwLjM5NVYzMy4xNjUxSDY4OC45MzRWMzUuMzc1MkM2ODguOTM0IDM1Ljg4MTEgNjg5LjMyNyAzNi4wMjc0IDY4OS41OTMgMzYuMDI3NEM2ODkuOTIyIDM2LjAyNzQgNjkwLjI2MiAzNS45MiA2OTAuNjMgMzUuNzA3OVYzNi41MDM3QzY5MC4zMSAzNi42Njc4IDY4OS44MiAzNi43ODk4IDY4OS41MTkgMzYuNzg5OEM2ODguNTI4IDM2Ljc4OTggNjg4LjAyNyAzNi4yMTYxIDY4OC4wMjcgMzUuNDM5MVYzMy4xNjUxSDY4Ny4yMjRWMzMuMDcwM0w2ODguOTM0IDMxLjUxMDJWMzIuNDAwNFpNNjkzLjg3NiAzMi40MDA0VjMzLjM5NjlINjkzLjg5NUM2OTQuMzU5IDMyLjYzNDUgNjk0LjggMzIuMzE4IDY5NS4yMyAzMi4zMThDNjk1LjYwMSAzMi4zMTggNjk1Ljk0NyAzMi40ODAxIDY5Ni4zMjkgMzIuODE2Nkw2OTUuODQ3IDMzLjU2NDRDNjk1LjU3IDMzLjMwOTEgNjk1LjIxMSAzMy4xMzMxIDY5NC45OTUgMzMuMTMzMUM2OTQuMzY4IDMzLjEzMzEgNjkzLjg3NiAzMy43MjY4IDY5My44NzYgMzQuNDYyNlYzNi43MDkzSDY5Mi45NjdWMzIuNDAwNEg2OTMuODc2Wk03MDUuNjU3IDMzLjUzMDlDNzA1LjEzMSAzMy4xOTY2IDcwNC43ODIgMzMuMDk4NSA3MDQuMzgxIDMzLjA5ODVDNzAzLjU0OSAzMy4wOTg1IDcwMi45NzcgMzMuNjk0NSA3MDIuOTc3IDM0LjU2N0M3MDIuOTc3IDM1LjQ1NiA3MDMuNTkyIDM1Ljk5MTYgNzA0LjUzNSAzNS45OTE2QzcwNC45MjUgMzUuOTkxNiA3MDUuMjk1IDM1Ljg5NzMgNzA1Ljc2IDM1LjcwNTlWMzYuNTQyNkM3MDUuNDQ3IDM2LjY3NzQgNzA0Ljg2MiAzNi43ODk4IDcwNC4zOCAzNi43ODk4QzcwMy4wMDQgMzYuNzg5OCA3MDIuMDQ0IDM1LjkwNjIgNzAyLjA0NCAzNC42NDMyQzcwMi4wNDQgMzMuMjE3OCA3MDIuOTIyIDMyLjMxOCA3MDQuMzIgMzIuMzE4QzcwNC44NTUgMzIuMzE4IDcwNS4yMTIgMzIuNDMzOSA3MDUuNjU3IDMyLjYxNDVMNzA1LjY1NyAzMy41MzA5Wk02OTguNzQyIDM2LjcwOTNINjk5LjY1MlYzMi40MDA4SDY5OC43NDJWMzYuNzA5M1oiIGZpbGw9IiMwMDlFNEQiLz4NCjxwYXRoIGQ9Ik02OTkuNjg0IDMwLjg1MjVDNjk5Ljc3MyAzMS4wNjA0IDY5OS42MTggMzEuMzU0NCA2OTkuMzQ0IDMxLjUwNDFDNjk5LjA2OCAzMS42NTQzIDY5OC43NzYgMzEuNjA2MiA2OTguNjkzIDMxLjM5NzhDNjk4LjYxIDMxLjE4NzQgNjk4Ljc2MSAzMC44OTU4IDY5OS4wMzggMzAuNzQ1NkM2OTkuMzExIDMwLjU5MzUgNjk5LjYwMSAzMC42NDIxIDY5OS42ODQgMzAuODUyNVYzMC44NTI1Wk02NTguOTQgMzEuMjAwOUM2NTguNzc5IDMxLjIwMDkgNjU4LjcxMSAzMS4yMjU1IDY1OC42NDYgMzEuMjkzOEM2NTguNjIgMzEuMzIwMyA2NTguNjEgMzEuMzQ3MiA2NTguNiAzMS40MDExTDY1Ny43ODQgMzQuMjg3QzY1Ny41OTMgMzUuMjk5MiA2NTYuMjU5IDM2LjMwOTkgNjU0LjUyMSAzNi4zMDk5SDY1Mi4xMDRMNjUyLjUyMyAzNC44MjdINjU0LjA3NkM2NTQuMjM0IDM0LjgyNyA2NTQuMzU4IDM0Ljc3MjEgNjU0LjQ2MiAzNC42NjQzQzY1NC41IDM0LjYyMjUgNjU0LjU1IDM0LjU1NyA2NTQuNTU2IDM0LjQ4OTZMNjU1LjIwMSAzMS45NjgxQzY1NS4zOTEgMzAuOTU1NSA2NTYuNTM4IDI5LjgzNjkgNjU4LjI3NiAyOS44MzY5SDY2MC43NTFMNjYwLjQzNSAzMS4yMDA5SDY1OC45NFpNNjU5LjQ5NyAzMi45NTk2TDY1OS43NzMgMzIuMDI1OUg2NjIuMjg4QzY2Mi41OTggMzAuNjcyIDY2Mi4zNTQgMjkuNDE3NyA2NjEuNDczIDI4LjU5NjFDNjU5LjY4OSAyNi45MzMyIDY1NS45NTcgMjcuNDk4MyA2NTMuMTc3IDI5Ljk3NzlDNjUyLjc0MyAzMC4zNjMgNjUyLjM3NiAzMC43NzkzIDY1Mi4wNDIgMzEuMjA0OEg2NTMuNTU2TDY1My4yMDQgMzIuMTQwNEg2NTEuMzk1QzY1MS4yMjIgMzIuNDM1NCA2NTEuMDYgMzIuNzI4MSA2NTAuOTM2IDMzLjAyNUg2NTMuMDgxTDY1Mi43MzcgMzMuOTYwN0g2NTAuNjNDNjUwLjI2OSAzNS4zOTAxIDY1MC40OTkgMzYuNzIzMyA2NTEuNDA2IDM3LjU2OTlDNjUzLjE2NyAzOS4yMTE2IDY1Ni44ODggMzguNjM0NiA2NTkuNjY3IDM2LjE1NTRDNjYwLjE1MyAzNS43MjQyIDY2MC41NTUgMzUuMjU4NyA2NjAuOTE4IDM0Ljc4MDhINjU4Ljk3M0w2NTkuMjY5IDMzLjg0NzFINjYxLjU0M0M2NjEuNzEgMzMuNTUwMSA2NjEuODYzIDMzLjI1NjUgNjYxLjk4MyAzMi45NTk2SDY1OS40OTdaIiBmaWxsPSIjMDA5RTREIi8+DQo8ZyBjbGlwLXBhdGg9InVybCgjY2xpcDBfNThfMTExKSI+DQo8cGF0aCBkPSJNNzc1LjA2OCA0MS4yMjc0Qzc2Ni4yODUgNDIuMDQ2MyA3NTcuMTMxIDQwLjc1NjQgNzU1Ljg0OCAzMy44MTlDNzU1LjIyMSAzMC4zOTkgNzU2Ljc2NSAyNi43NzI1IDc1OC44MSAyNC41MTg0VjIzLjMxNDhDNzU1LjEyNiAyNi41OCA3NTMuMTMgMzAuNzExNSA3NTQuMjggMzUuNTkyQzc1NS43NDggNDEuODUxOCA3NjMuNjAzIDQ1LjM5NjcgNzc1LjU5NSA0NC4yMTk1Qzc4MC4zNDIgNDMuNzU0NSA3ODYuNTUgNDIuMjEyIDc5MC44NjkgMzkuODE0NFYzNi40MTA5Qzc4Ni45NDkgMzguNzcxMyA3ODAuNDY4IDQwLjcyMTEgNzc1LjA2OCA0MS4yMjc0VjQxLjIyNzRaTTc5OC4yMDUgMjMuMjMzNUM3OTYuMTIyIDEyLjk1MzMgNzc2LjM3MyAxMi4zMDE2IDc2My42NDMgMjAuMTMzOFYyMC45OTg5Qzc3Ni4zNTkgMTQuMzkxNSA3OTQuMzk1IDE0LjQzMTcgNzk2LjAzNyAyMy45MDE2Qzc5Ni41ODkgMjcuMDM0MiA3OTQuODQzIDMwLjI5NzggNzkxLjcyMyAzMi4xNzdWMzQuNjM0MkM3OTUuNDc2IDMzLjI0MzIgNzk5LjMyNCAyOC43NDQyIDc5OC4yMDUgMjMuMjMzNVYyMy4yMzM1WiIgZmlsbD0iIzBFN0RDMiIvPg0KPHBhdGggZD0iTTc5MC4xNTkgMjEuNzM2OEg3ODcuODU2VjMyLjEwM0M3ODcuODU2IDMzLjMxNzkgNzg4LjQzNyAzNC4zNzQ0IDc5MC4xNTkgMzQuNTQzMlYyMS43MzY4Wk03NjIuNzM5IDI1LjUyMTdINzYwLjQzMkw3NjAuNDMxIDMyLjI5NDNDNzYwLjQzMSAzMy41MTM0IDc2MS4wMTMgMzQuNTY4OCA3NjIuNzM5IDM0LjczNDRWMjUuNTIxN1YyNS41MjE3Wk03NjAuNDMyIDIyLjA1MjFINzYyLjczMlYyNC4yNTg0SDc2MC40MzJWMjIuMDUyMVpNNzc2LjUzIDM0LjYyNzJDNzc0LjY2NiAzNC42MjcyIDc3My44NzcgMzMuMzE3NyA3NzMuODc3IDMyLjAyOFYyMy4wMzU1SDc3Ni4xNlYyNS41MjE3SDc3Ny44NzlWMjcuMzg1M0g3NzYuMTZWMzEuODg1NEM3NzYuMTYgMzIuNDExMyA3NzYuNDA3IDMyLjcwNDQgNzc2Ljk1IDMyLjcwNDRINzc3Ljg3OVYzNC42MjcyTDc3Ni41MyAzNC42MjcyVjM0LjYyNzJaTTc4MC43MzEgMzAuNzk2MUM3ODAuNzMxIDMxLjk3NjggNzgxLjQ2MSAzMi44NDQ2IDc4Mi43NTQgMzIuODQ0NkM3ODMuNzY2IDMyLjg0NDYgNzg0LjI2NiAzMi41NjA1IDc4NC44NSAzMS45NzY4TDc4Ni4yNjEgMzMuMzM0OUM3ODUuMzU3IDM0LjIzNzkgNzg0LjQwOSAzNC43ODcgNzgyLjczNyAzNC43ODdDNzgwLjU1MiAzNC43ODcgNzc4LjQ1OSAzMy41ODE5IDc3OC40NTkgMzAuMDY4NkM3NzguNDU5IDI3LjA2NTEgNzgwLjI4OCAyNS4zNjczIDc4Mi42ODYgMjUuMzY3M0M3ODUuMTI0IDI1LjM2NzMgNzg2LjUyNSAyNy4zNTQ5IDc4Ni41MjUgMjkuOTYzOVYzMC43OTYzSDc4MC43MzFWMzAuNzk2MVpNNzgyLjU4NiAyNy4yNzU2Qzc4MS44MDUgMjcuMjc1NiA3ODEuMjA0IDI3LjY4MjMgNzgwLjk1IDI4LjIzMDlDNzgwLjgwMiAyOC41NjA3IDc4MC43NDcgMjguODE3NyA3ODAuNzMxIDI5LjIyMjlINzg0LjI0OUM3ODQuMjA0IDI4LjIzMDkgNzgzLjc1OSAyNy4yNzU2IDc4Mi41ODYgMjcuMjc1NlpNNzY4LjkzOSAyNy4zODUzQzc2OS42MDggMjcuMzg1MyA3NjkuODg3IDI3LjcxOTggNzY5Ljg4NyAyOC4yNjI2VjM0LjY0MDZINzcyLjE3VjI4LjI0OTJDNzcyLjE3IDI2Ljk1NDIgNzcxLjQ4NyAyNS41MjQxIDc2OS40ODIgMjUuNTI0MUw3NjQuNzY2IDI1LjUyMTdWMzQuNjQwNkg3NjcuMDVWMjcuMzg1M0g3NjguOTM5VjI3LjM4NTNaTTc5Mi42MzcgMjMuNTg5MUM3OTIuMTI5IDIzLjU4OTEgNzkxLjcyNCAyMy4xNzU0IDc5MS43MjQgMjIuNjYyOUM3OTEuNzI0IDIyLjE1MjkgNzkyLjEyOSAyMS43MzY4IDc5Mi42MzcgMjEuNzM2OEM3OTMuMTQyIDIxLjczNjggNzkzLjU1NiAyMi4xNTI5IDc5My41NTYgMjIuNjYyOUM3OTMuNTU2IDIzLjE3NTQgNzkzLjE0MiAyMy41ODkxIDc5Mi42MzcgMjMuNTg5MVpNNzkyLjYzNyAyMS44OTEyQzc5Mi4yMTggMjEuODkxMiA3OTEuODgyIDIyLjI0MDcgNzkxLjg4MiAyMi42NjI5Qzc5MS44ODIgMjMuMDg3NiA3OTIuMjE4IDIzLjQzMDkgNzkyLjYzNyAyMy40MzA5Qzc5My4wNTUgMjMuNDMwOSA3OTMuNDAyIDIzLjA4NzYgNzkzLjQwMiAyMi42NjI5Qzc5My40MDIgMjIuMjQwNyA3OTMuMDU1IDIxLjg5MTIgNzkyLjYzNyAyMS44OTEyWk03OTMuMDQzIDIzLjIxOEg3OTIuODcyQzc5Mi44NjQgMjMuMjE3OSA3OTIuODU3IDIzLjIxNTcgNzkyLjg1MSAyMy4yMTE2Qzc5Mi44NDUgMjMuMjA3NSA3OTIuODQgMjMuMjAxNyA3OTIuODM3IDIzLjE5NDlMNzkyLjYwNSAyMi43OTdDNzkyLjU5OCAyMi43ODg1IDc5Mi41NzkgMjIuNzc4OCA3OTIuNTczIDIyLjc3ODhINzkyLjQ2N1YyMy4xNzU0Qzc5Mi40NjcgMjMuMTk1IDc5Mi40NTMgMjMuMjE4MSA3OTIuNDI4IDIzLjIxODFINzkyLjI3NEM3OTIuMjUxIDIzLjIxODEgNzkyLjIzNSAyMy4xOTUgNzkyLjIzNSAyMy4xNzU0VjIyLjE3NDlDNzkyLjIzNSAyMi4xMTY0IDc5Mi4yNTQgMjIuMDkyNCA3OTIuMzA1IDIyLjA4NUM3OTIuMzYxIDIyLjA3OSA3OTIuNTA1IDIyLjA3MTYgNzkyLjU4NiAyMi4wNzE2Qzc5Mi44NzIgMjIuMDcxNiA3OTMuMDM5IDIyLjE1NjYgNzkzLjAzOSAyMi40MjQ0VjIyLjQ0NEM3OTMuMDM5IDIyLjYwOTQgNzkyLjk1OSAyMi42OTk1IDc5Mi44MzMgMjIuNzM5N0w3OTMuMDc0IDIzLjE1NDdDNzkzLjA3OCAyMy4xNjQgNzkzLjA4IDIzLjE3MzkgNzkzLjA4IDIzLjE4NEM3OTMuMDggMjMuMTk5NyA3OTMuMDcyIDIzLjIxOCA3OTMuMDQzIDIzLjIxOFYyMy4yMThaTTc5Mi44MjEgMjIuNDI0NEM3OTIuODIxIDIyLjMxMjcgNzkyLjc1MiAyMi4yNzczIDc5Mi42MDUgMjIuMjc3M0g3OTIuNDU5VjIyLjU5NDdDNzkyLjQ4MiAyMi41OTQ3IDc5Mi41ODYgMjIuNTk5NiA3OTIuNjA1IDIyLjU5OTZDNzkyLjc1MiAyMi41OTk2IDc5Mi44MjEgMjIuNTUgNzkyLjgyMSAyMi40NDRWMjIuNDI0NFoiIGZpbGw9IiMwRTdEQzIiLz4NCjwvZz4NCjxnIGNsaXAtcGF0aD0idXJsKCNjbGlwMV81OF8xMTEpIj4NCjxwYXRoIGQ9Ik01MzMuNzczIDIwLjk5MTFDNTI5LjI2MyAyMC45OTExIDUyNS41OTkgMjQuNjU0NyA1MjUuNTk5IDI5LjE2NDRDNTI1LjU5OSAzMy42NzQxIDUyOS4yNjMgMzcuMzM3NyA1MzMuNzczIDM3LjMzNzdDNTM4LjI4MiAzNy4zMzc3IDU0MS45NDYgMzMuNjc0MSA1NDEuOTQ2IDI5LjE2NDRDNTQxLjk0NiAyNC42NTQ3IDUzOC4yODIgMjAuOTkxMSA1MzMuNzczIDIwLjk5MTFaTTUzMy43NzMgMzYuNTE4NkM1MjkuNzEzIDM2LjUxODYgNTI2LjQxOSAzMy4yMTUgNTI2LjQxOSAyOS4xNjQ0QzUyNi40MTkgMjUuMTEzNyA1MjkuNzEzIDIxLjgxMDIgNTMzLjc3MyAyMS44MTAyQzUzNy44MzIgMjEuODEwMiA1NDEuMTI3IDI1LjExMzcgNTQxLjEyNyAyOS4xNjQ0QzU0MS4xMjcgMzMuMjE1IDUzNy44MzIgMzYuNTE4NiA1MzMuNzczIDM2LjUxODZaIiBmaWxsPSJibGFjayIvPg0KPHBhdGggZD0iTTUzNi42OSAyMy45MjUyQzUzNi42NjMgMjMuOTA3MiA1MzYuNjI3IDIzLjg5ODIgNTM2LjU5MSAyMy44OTgyQzUzNi40ODMgMjMuODk4MiA1MzYuNDAyIDIzLjk3OTIgNTM2LjQwMiAyNC4wODczVjI2LjY0MzdDNTM2LjQwMiAyNi43MzM3IDUzNi4zMyAyNi44MDU3IDUzNi4yNCAyNi44MDU3SDUzMS4yOUM1MzEuMiAyNi44MDU3IDUzMS4xMzcgMjYuNzMzNyA1MzEuMTI4IDI2LjY0MzdWMjQuMDg3M0M1MzEuMTI4IDI0LjA1MTMgNTMxLjExOSAyNC4wMjQyIDUzMS4xMDEgMjMuOTg4MkM1MzEuMDQ3IDIzLjg5ODIgNTMwLjkzIDIzLjg3MTIgNTMwLjgzOSAyMy45MjUyQzUyOS4wMTIgMjUuMDUwNCA1MjcuOTA1IDI3LjAwMzcgNTI3LjkwNSAyOS4xNjQxQzUyNy45MDUgMzEuMzI0NCA1MjkuMDEyIDMzLjI3NzcgNTMwLjg1NyAzNC40MDI5QzUzMC44ODUgMzQuNDIwOSA1MzAuOTIxIDM0LjQyOTkgNTMwLjk1NyAzNC40Mjk5QzUzMS4wNjUgMzQuNDI5OSA1MzEuMTQ2IDM0LjM0ODkgNTMxLjE0NiAzNC4yNDA5VjMxLjY4NDVDNTMxLjE0NiAzMS41OTQ0IDUzMS4yMTggMzEuNTMxNCA1MzEuMzA4IDMxLjUyMjRINTM2LjI1OEM1MzYuMzQ4IDMxLjUyMjQgNTM2LjQyIDMxLjU5NDQgNTM2LjQyIDMxLjY4NDVWMzQuMjQwOUM1MzYuNDIgMzQuMjc2OSA1MzYuNDI5IDM0LjMwMzkgNTM2LjQ0NyAzNC4zMzk5QzUzNi41MDEgMzQuNDI5OSA1MzYuNjE4IDM0LjQ1NjkgNTM2LjcwOCAzNC40MDI5QzUzOC41NTQgMzMuMjc3NyA1MzkuNjYxIDMxLjMyNDQgNTM5LjY2MSAyOS4xNjQxQzUzOS42NjEgMjcuMDAzNyA1MzguNTM2IDI1LjA1MDQgNTM2LjY5IDIzLjkyNTJWMjMuOTI1MlpNNTMwLjE5MSAzMi4zNjg2TDUzMC4yMTggMzIuNjc0Nkw1MzAuMDIgMzIuNDMxNkM1MjguNDk5IDMwLjUxNDMgNTI4LjQ5OSAyNy44MDQ4IDUzMC4wMiAyNS44ODc1TDUzMC4xOTEgMjUuNjcxNUw1MzAuMjE4IDI1LjY0NDVMNTMwLjE5MSAyNS45NTk2QzUzMC4xNjQgMjYuMjExNiA1MzAuMTU1IDI2LjQ3MjYgNTMwLjE1NSAyNi43MzM3VjMxLjU4NTRDNTMwLjE1NSAzMS44NDY1IDUzMC4xNzMgMzIuMTA3NSA1MzAuMTkxIDMyLjM2ODZaTTUzNi40MDIgMzAuMzg4M0M1MzYuNDAyIDMwLjQ3ODMgNTM2LjMzIDMwLjU1MDMgNTM2LjI0IDMwLjU1MDNINTMxLjI5QzUzMS4yIDMwLjU1MDMgNTMxLjEzNyAzMC40NzgzIDUzMS4xMjggMzAuMzg4M1YyNy45Mzk5QzUzMS4xMjggMjcuODQ5OSA1MzEuMiAyNy43Nzc4IDUzMS4yOSAyNy43Nzc4SDUzNi4yNEM1MzYuMzMgMjcuNzc3OCA1MzYuNDAyIDI3Ljg0OTkgNTM2LjQwMiAyNy45Mzk5VjMwLjM4ODNaTTUzNy41MTkgMzIuNDMxNkw1MzcuMzIxIDMyLjY3NDZMNTM3LjM0OCAzMi4zNjg2QzUzNy4zNzUgMzIuMTE2NSA1MzcuMzg0IDMxLjg1NTUgNTM3LjM4NCAzMS41OTQ0VjI2LjczMzdDNTM3LjM4NCAyNi40NzI2IDUzNy4zNzUgMjYuMjExNiA1MzcuMzQ4IDI1Ljk1OTZMNTM3LjMzOSAyNS44MjQ1TDUzNy4zMyAyNS42ODA1VjI1LjY0NDVMNTM3LjUxOSAyNS44ODc1QzUzOC4yNTcgMjYuODA1NyA1MzguNjYyIDI3Ljk3NTkgNTM4LjY2MiAyOS4xNTUxQzUzOC42NjIgMzAuMzM0MiA1MzguMjU3IDMxLjUxMzQgNTM3LjUxOSAzMi40MzE2VjMyLjQzMTZaIiBmaWxsPSJibGFjayIvPg0KPHBhdGggZD0iTTU1NC4yNzYgMjkuMDIwMkM1NTQuMjMxIDI5LjAwMjIgNTU0LjE3NyAyOC45ODQyIDU1NC4xNzcgMjguOTMwMkM1NTQuMTc3IDI4Ljg5NDIgNTU0LjE5NSAyOC44NjcyIDU1NC4yMzEgMjguODQ5MkM1NTQuMjk0IDI4LjgyMjIgNTU1Ljg1MSAyOC4yNjQxIDU1NS44NTEgMjYuNDI3OEM1NTUuODUxIDI0LjM4NDUgNTU0LjQ3NCAyMy4xNjkzIDU1Mi4xNTIgMjMuMTY5M0g1NDYuNTI2VjM1LjE3NzJINTUyLjY2NUM1NTQuNDU2IDM1LjE3NzIgNTU2LjM4MiAzMy45MDggNTU2LjM4MiAzMS44NjQ2QzU1Ni4zODIgMjkuOTExMyA1NTQuOTA2IDI5LjIyNzIgNTU0LjI3NiAyOS4wMjAyVjI5LjAyMDJaTTU0OS4zNjEgMjUuNjI2N0M1NDkuMzYxIDI1LjU4MTcgNTQ5LjM5NyAyNS41NDU2IDU0OS40NDIgMjUuNTQ1Nkg1NTEuNjc1QzU1Mi40MTMgMjUuNTQ1NiA1NTIuOTE3IDI2LjA0MDcgNTUyLjkxNyAyNi43Nzg4QzU1Mi45MTcgMjcuMzU0OSA1NTIuNDY3IDI3Ljk3NiA1NTEuNjIxIDI3Ljk3Nkg1NDkuNDQyQzU0OS4zOTcgMjcuOTc2IDU0OS4zNjEgMjcuOTQgNTQ5LjM2MSAyNy44OTVWMjUuNjI2N1pNNTUxLjY3NSAzMi44MDk4SDU0OS40NDJDNTQ5LjM5NyAzMi44MDk4IDU0OS4zNjEgMzIuNzczOCA1NDkuMzYxIDMyLjcyODhWMzAuMzM0NEM1NDkuMzYxIDMwLjI4OTQgNTQ5LjM5NyAzMC4yNTM0IDU0OS40NDIgMzAuMjUzNEg1NTEuNjIxQzU1Mi42OTIgMzAuMjUzNCA1NTMuMzA0IDMwLjcxMjUgNTUzLjMwNCAzMS41MjI2QzU1My4zMDQgMzIuMzU5NyA1NTIuNzM3IDMyLjgwOTggNTUxLjY3NSAzMi44MDk4VjMyLjgwOThaTTU3NS4zODQgMjcuOTQ5TDU3NC45NTIgMjcuODU5QzU3My45OCAyNy42NTIgNTczLjAzNSAyNy4zOTA5IDU3My4wMzUgMjYuNTUzOEM1NzMuMDM1IDI1LjcxNjcgNTczLjgxOCAyNS4zMzg2IDU3NC41OTIgMjUuMzM4NkM1NzUuNTAxIDI1LjMzODYgNTc2LjQwMSAyNS43NDM3IDU3Ny4wODYgMjYuNDQ1OEw1NzguODY4IDI0LjY4MTVDNTc4LjEwMyAyMy44MzU0IDU3Ni43NDQgMjIuODYzMiA1NzQuNTQ3IDIyLjg2MzJDNTcxLjkwMSAyMi44NjMyIDU3MC4xMTggMjQuMzY2NSA1NzAuMTE4IDI2LjYwNzhDNTcwLjExOCAyOC45NzUyIDU3MS45ODIgMjkuODY2MyA1NzMuNTQ4IDMwLjE5OTRMNTczLjk3MSAzMC4yODk0QzU3NS40OTIgMzAuNjEzNSA1NzYuMjEyIDMwLjg1NjUgNTc2LjIxMiAzMS43MjA2QzU3Ni4yMTIgMzIuNDk0NyA1NzUuNTE5IDMzLjAwNzggNTc0LjQ5MyAzMy4wMDc4QzU3My4yODcgMzMuMDA3OCA1NzIuMjE2IDMyLjQ3NjcgNTcxLjQwNiAzMS40Nzc2TDU2OS41NzggMzMuMjY4OUM1NzAuNTUxIDM0LjQyMTEgNTcxLjgzOCAzNS40NjUyIDU3NC41MjkgMzUuNDY1MkM1NzYuODI1IDM1LjQ2NTIgNTc5LjE1NiAzNC4xMzMgNTc5LjE1NiAzMS41NzY2QzU3OS4xNDcgMjguOTU3MiA1NzcuMzY1IDI4LjM2MzEgNTc1LjM4NCAyNy45NDlWMjcuOTQ5Wk01OTkuMTAzIDIzLjE2OTNWMjcuNTYyQzU5OS4xMDMgMjcuNjA3IDU5OS4wNjcgMjcuNjQzIDU5OS4wMjIgMjcuNjQzSDU5NS4zMzFDNTk1LjI4NiAyNy42NDMgNTk1LjI1IDI3LjYwNyA1OTUuMjUgMjcuNTYyVjIzLjE2OTNINTkyLjIyNlYzNS4xNzcySDU5NS4yNVYzMC40NjA0QzU5NS4yNSAzMC40MTU0IDU5NS4yODYgMzAuMzc5NCA1OTUuMzMxIDMwLjM3OTRINTk5LjAyMkM1OTkuMDY3IDMwLjM3OTQgNTk5LjEwMyAzMC40MTU0IDU5OS4xMDMgMzAuNDYwNFYzNS4xNzcySDYwMi4xNDZWMjMuMTY5M0g1OTkuMTAzWk01ODYuMTQxIDMyLjcxOThDNTg0Ljc4MiAzMi43MTk4IDU4My4zMTUgMzEuNTg1NiA1ODMuMzE1IDI5LjA5MjJDNTgzLjMxNSAyNi44MTQ4IDU4NC42OTIgMjUuNjI2NyA1ODYuMDUxIDI1LjYyNjdDNTg3LjA0MSAyNS42MjY3IDU4Ny43MzQgMjYuMDQwNyA1ODguMjgzIDI2Ljk1ODlMNTkwLjYwNiAyNS40MTk2QzU4OS40MTggMjMuNjczMyA1ODguMDA0IDIyLjg4MTIgNTg2LjAzMyAyMi44ODEyQzU4Mi4xNzEgMjIuODgxMiA1ODAuNDQzIDI2LjAwNDcgNTgwLjQ0MyAyOS4wOTIyQzU4MC40NDMgMzIuODQ1OCA1ODIuNzI5IDM1LjQ2NTIgNTg1Ljk5NyAzNS40NjUyQzU4OC40MjcgMzUuNDY1MiA1ODkuNTM1IDM0LjU3NDEgNTkwLjY5NiAzMi45MjY4TDU4OC4zNTUgMzEuMzUxNkM1ODcuODMzIDMyLjE5NzcgNTg3LjI2NiAzMi43MTk4IDU4Ni4xNDEgMzIuNzE5OFpNNTYzLjE3OCAyMi44NjMyQzU1OS44NzUgMjIuODYzMiA1NTcuNjYxIDI1LjM5MjYgNTU3LjY2MSAyOS4xNjQyQzU1Ny42NjEgMzIuOTM1OCA1NTkuODc1IDM1LjQ2NTIgNTYzLjE3OCAzNS40NjUyQzU2Ni40ODIgMzUuNDY1MiA1NjguNjk2IDMyLjkzNTggNTY4LjY5NiAyOS4xNjQyQzU2OC42OTYgMjUuMzkyNiA1NjYuNDgyIDIyLjg2MzIgNTYzLjE3OCAyMi44NjMyVjIyLjg2MzJaTTU2My4xNzggMzIuNzE5OEM1NjEuNTU4IDMyLjcxOTggNTYwLjUxNCAzMS4zMjQ2IDU2MC41MTQgMjkuMTY0MkM1NjAuNTE0IDI3LjAxMjkgNTYxLjU1OCAyNS42MjY3IDU2My4xNzggMjUuNjI2N0M1NjQuODA4IDI1LjYyNjcgNTY1Ljg2MSAyNy4wMTI5IDU2NS44NjEgMjkuMTY0MkM1NjUuODYxIDMxLjMyNDYgNTY0LjgwOCAzMi43MTk4IDU2My4xNzggMzIuNzE5OFoiIGZpbGw9IiNGODAwMDAiLz4NCjwvZz4NCjxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNMTQ2LjM0NCAyMi4xODExQzE0Ny41OTUgMjIuMjg1NCAxNDguODQ1IDIxLjU1NTMgMTQ5LjYyNyAyMC42Mjk4QzE1MC4zOTUgMTkuNjc4MSAxNTAuOTAzIDE4LjQwMDUgMTUwLjc3MyAxNy4wOTY5QzE0OS42NjYgMTcuMTQ5MSAxNDguMjk4IDE3LjgyNjkgMTQ3LjUxNyAxOC43Nzg2QzE0Ni44IDE5LjU5OTkgMTQ2LjE4OCAyMC45Mjk2IDE0Ni4zNDQgMjIuMTgxMVpNMTQ3Ljg0MSAyMy4wNzk3QzE0OC42NTMgMjIuNzYwNiAxNDkuNjU4IDIyLjM2NTYgMTUwLjc2IDIyLjQyOTFDMTUxLjQ2MyAyMi40ODEyIDE1My40OTUgMjIuNjg5OCAxNTQuNzk4IDI0LjYxOTJDMTU0Ljc5MiAyNC42MjM3IDE1NC43NzggMjQuNjMyMyAxNTQuNzU5IDI0LjY0NUMxNTQuNDM2IDI0Ljg1NDggMTUyLjM5IDI2LjE4NzEgMTUyLjQxNCAyOC44MTY5QzE1Mi40MzkgMzEuOTQ5OSAxNTQuOTg4IDMzLjExODMgMTU1LjMyMiAzMy4yNzExQzE1NS4zNDQgMzMuMjgxMSAxNTUuMzU2IDMzLjI4NjcgMTU1LjM1OCAzMy4yODgzQzE1NS4zNTYgMzMuMjkyNiAxNTUuMzU0IDMzLjMwMSAxNTUuMzUgMzMuMzEzM0MxNTUuMjgzIDMzLjUyODggMTU0Ljg0NSAzNC45NDg5IDE1My44NDcgMzYuNDA0QzE1Mi45MjIgMzcuNzU5OCAxNTEuOTcxIDM5LjA4OTUgMTUwLjQ2IDM5LjExNTZDMTQ5Ljc0OSAzOS4xMjgzIDE0OS4yNyAzOC45MjExIDE0OC43NzIgMzguNzA1NEMxNDguMjQ3IDM4LjQ3ODUgMTQ3LjcwMSAzOC4yNDIyIDE0Ni44NCAzOC4yNDIyQzE0NS45NDcgMzguMjQyMiAxNDUuMzc2IDM4LjQ4NDggMTQ0LjgyNiAzOC43MTg0QzE0NC4zNDggMzguOTIxNCAxNDMuODg3IDM5LjExNzQgMTQzLjI0NSAzOS4xNDE3QzE0MS43ODYgMzkuMTkzOCAxNDAuNjc5IDM3LjcwNzcgMTM5Ljc1NCAzNi4zNTE5QzEzNy44NjYgMzMuNjE0MyAxMzYuNDIgMjguNjM0NCAxMzguMzc0IDI1LjI3MUMxMzkuMzI1IDIzLjU4OTMgMTQxLjA1NyAyMi41MzM0IDE0Mi45MTkgMjIuNTA3M0MxNDMuNzMyIDIyLjQ5MjUgMTQ0LjUwNyAyMi44MDA2IDE0NS4xODQgMjMuMDcwMUMxNDUuNzAyIDIzLjI3NTggMTQ2LjE2MiAyMy40NTg5IDE0Ni41NCAyMy40NTg5QzE0Ni44NzcgMjMuNDU4OSAxNDcuMzE5IDIzLjI4NTEgMTQ3Ljg0MSAyMy4wNzk3WiIgZmlsbD0iYmxhY2siLz4NCjxwYXRoIGQ9Ik0zNi44NTg3IDM3LjUyNDFIMzEuOTg3NEwzNS4wMzQyIDE5LjY2NjhIMzkuOTA1MkwzNi44NTg3IDM3LjUyNDFaIiBmaWxsPSIjMDA1NzlGIi8+DQo8cGF0aCBkPSJNNTQuNTE1NyAyMC4xMDQxQzUzLjU1NDkgMTkuNzQyOCA1Mi4wMzA5IDE5LjM0MzggNTAuMTQ2NiAxOS4zNDM4QzQ1LjMzNjEgMTkuMzQzOCA0MS45NDg2IDIxLjc3NTMgNDEuOTI3OCAyNS4yNTE2QzQxLjg4NzggMjcuODE2NSA0NC4zNTMxIDI5LjI0MSA0Ni4xOTcgMzAuMDk2MkM0OC4wODE2IDMwLjk3MDEgNDguNzIyMyAzMS41NDA1IDQ4LjcyMjMgMzIuMzE5NEM0OC43MDMxIDMzLjUxNTcgNDcuMTk5NCAzNC4wNjcyIDQ1Ljc5NjkgMzQuMDY3MkM0My44NTIxIDM0LjA2NzIgNDIuODEgMzMuNzgyOSA0MS4yMjY0IDMzLjExNzNMNDAuNTg1IDMyLjgzMkwzOS45MDMzIDM2Ljg0MDZDNDEuMDQ1OCAzNy4zMzM5IDQzLjE1MDcgMzcuNzcxNyA0NS4zMzYxIDM3Ljc5MDlDNTAuNDQ3MyAzNy43OTA5IDUzLjc3NDkgMzUuMzk3MSA1My44MTQzIDMxLjY5MjVDNTMuODMzOCAyOS42NTk3IDUyLjUzMiAyOC4xMDIgNDkuNzI1NCAyNi44MjkyQzQ4LjAyMTcgMjYuMDEyMSA0Ni45NzgzIDI1LjQ2MTIgNDYuOTc4MyAyNC42MjUyQzQ2Ljk5ODMgMjMuODY1MiA0Ny44NjA4IDIzLjA4NjggNDkuNzg0IDIzLjA4NjhDNTEuMzY3NyAyMy4wNDg2IDUyLjUzMTIgMjMuNDA5NCA1My40MTI2IDIzLjc3MDVMNTMuODUzMiAyMy45NjAxTDU0LjUxNTcgMjAuMTA0MVoiIGZpbGw9IiMwMDU3OUYiLz4NCjxwYXRoIGQ9Ik02MC45OTI0IDMxLjE5NzlDNjEuMzkzNiAzMC4xNzIgNjIuOTM3MiAyNi4yMDE2IDYyLjkzNzIgMjYuMjAxNkM2Mi45MTcgMjYuMjM5NyA2My4zMzc2IDI1LjE1NjggNjMuNTc4MSAyNC40OTE5TDYzLjkxODYgMjYuMDMwNkM2My45MTg2IDI2LjAzMDYgNjQuODQxIDMwLjMwNTEgNjUuMDQxNCAzMS4xOTc5QzY0LjI4IDMxLjE5NzkgNjEuOTU0NiAzMS4xOTc5IDYwLjk5MjQgMzEuMTk3OVpNNjcuMDA1NCAxOS42NjY4SDYzLjIzNzRDNjIuMDc1NSAxOS42NjY4IDYxLjE5MjcgMTkuOTg5NSA2MC42OTE0IDIxLjE0ODRMNTMuNDU1OCAzNy41MjM5SDU4LjU2NzFDNTguNTY3MSAzNy41MjM5IDU5LjQwODUgMzUuMzE5OSA1OS41ODk0IDM0Ljg0NTJDNjAuMTUwMSAzNC44NDUyIDY1LjEyMjMgMzQuODQ1MiA2NS44NDM3IDM0Ljg0NTJDNjUuOTgzNSAzNS40NzIxIDY2LjQyNDkgMzcuNTIzOSA2Ni40MjQ5IDM3LjUyMzlINzAuOTM1Mkw2Ny4wMDU0IDE5LjY2NjhWMTkuNjY2OFoiIGZpbGw9IiMwMDU3OUYiLz4NCjxwYXRoIGQ9Ik0yNy45MTggMTkuNjY2OEwyMy4xNDc1IDMxLjg0MzhMMjIuNjI2MiAyOS4zNzQxQzIxLjc0NDIgMjYuNTI0NSAxOC45NzgxIDIzLjQyODQgMTUuODkxNCAyMS44ODlMMjAuMjYxIDM3LjUwNTJIMjUuNDEyMkwzMy4wNjkgMTkuNjY2OEgyNy45MThWMTkuNjY2OFoiIGZpbGw9IiMwMDU3OUYiLz4NCjxwYXRoIGQ9Ik0xOC43MTg0IDE5LjY2NjhIMTAuODgxMUwxMC44MDA5IDIwLjAyNzZDMTYuOTE0NSAyMS41MDk1IDIwLjk2MzUgMjUuMDgxNSAyMi42MjcgMjkuMzc0OUwyMC45MjMyIDIxLjE2NzlDMjAuNjQyNyAyMC4wMjc0IDE5Ljc4MDcgMTkuNzA0NCAxOC43MTg0IDE5LjY2NjhaIiBmaWxsPSIjRkFBNjFBIi8+DQo8ZyBjbGlwLXBhdGg9InVybCgjY2xpcDJfNThfMTExKSI+DQo8cGF0aCBkPSJNMjIxLjE1OCAxNy40OTlWMTguOTM1NkgyMzEuMzA2VjE3LjQ5OUgyMjEuMTU4Wk0yMzIuNzQ0IDE3LjQ5OVYxOC45MzU2SDI0Ny4yMDZDMjQ3LjIwNiAxOC45MzU2IDI0NS43MjkgMTcuNDk5IDI0My43NzMgMTcuNDk5SDIzMi43NDRaTTI1MC4wNDMgMTcuNDk5VjE4LjkzNTZIMjU4Ljc5M0wyNTguMjczIDE3LjQ5OUgyNTAuMDQzWk0yNjUuMDY1IDE3LjQ5OUwyNjQuNTQ2IDE4LjkzNTZIMjczLjIxNlYxNy40OTlIMjY1LjA2NVpNMjIxLjE1OCAyMC4yOTI5VjIxLjcyOTZIMjMxLjMwNlYyMC4yOTI5SDIyMS4xNThaTTIzMi43NDQgMjAuMjk1VjIxLjcyOTdIMjQ4Ljg4NEMyNDguODg0IDIxLjcyOTcgMjQ4LjY5NiAyMC42MjM5IDI0OC4zNjcgMjAuMjk1SDIzMi43NDRaTTI1MC4wNDMgMjAuMjk1VjIxLjcyOTdIMjU5Ljc1MkwyNTkuMjcxIDIwLjI5NUgyNTAuMDQzWk0yNjQuMDI3IDIwLjI5NUwyNjMuNTQ2IDIxLjcyOTdIMjczLjIxNlYyMC4yOTVIMjY0LjAyN1YyMC4yOTVaTTIyNC4wNzQgMjMuMDg2OVYyNC41MjU3SDIyOC40NjlWMjMuMDg2OUgyMjQuMDc0VjIzLjA4NjlaTTIzNS42NjEgMjMuMDg2OVYyNC41MjU3SDI0MC4wNTZWMjMuMDg2OUgyMzUuNjYxVjIzLjA4NjlaTTI0NC4zMzEgMjMuMDg2OVYyNC41MjU3SDI0OC43MjZDMjQ4LjcyNiAyNC41MjU3IDI0OS4wMDUgMjMuNzY1OSAyNDkuMDA1IDIzLjA4NjlIMjQ0LjMzMVYyMy4wODY5Wk0yNTIuOTYgMjMuMDg2OVYyNC41MjU3SDI2MC43NTJMMjYwLjIzMiAyMy4wODY5SDI1Mi45NlYyMy4wODY5Wk0yNjMuMDY5IDIzLjA4NjlMMjYyLjU0OCAyNC41MjU3SDI3MC4zNzlWMjMuMDg2OUgyNjMuMDY5VjIzLjA4NjlaTTIyNC4wNzQgMjUuODgzVjI3LjMxOTdIMjI4LjQ2OVYyNS44ODNIMjI0LjA3NFYyNS44ODNaTTIzNS42NjEgMjUuODgzVjI3LjMxOTdIMjQ2Ljg4N0MyNDYuODg3IDI3LjMxOTcgMjQ3LjgyNiAyNi41ODI1IDI0OC4xMjUgMjUuODgzSDIzNS42NjFaTTI1Mi45NiAyNS44ODNWMjcuMzE5N0gyNTcuMzU1VjI2LjUyTDI1Ny42MzQgMjcuMzE5N0gyNjUuNjg0TDI2NS45ODQgMjYuNTJWMjcuMzE5N0gyNzAuMzc5VjI1Ljg4M0gyNjIuMTI5TDI2MS42OTEgMjcuMDk5OUwyNjEuMjUxIDI1Ljg4M0gyNTIuOTZaTTIyNC4wNzQgMjguNjc3VjMwLjExMzdIMjI4LjQ2OVYyOC42NzdIMjI0LjA3NFpNMjM1LjY2MSAyOC42NzdWMzAuMTEzN0gyNDguMTI1QzI0Ny44MjYgMjkuNDE2NSAyNDYuODg3IDI4LjY3NyAyNDYuODg3IDI4LjY3N0gyMzUuNjYxWk0yNTIuOTYgMjguNjc3VjMwLjExMzdIMjU3LjM1NVYyOC42NzdIMjUyLjk2Wk0yNTguMTUzIDI4LjY3N0wyNTguNjg1IDMwLjExMzdIMjY0LjcyMUwyNjUuMjI2IDI4LjY3N0gyNTguMTUzWk0yNjUuOTg0IDI4LjY3N1YzMC4xMTM3SDI3MC4zNzlWMjguNjc3SDI2NS45ODRaTTIyNC4wNzQgMzEuNDcxVjMyLjkwNzZIMjI4LjQ2OVYzMS40NzFIMjI0LjA3NFpNMjM1LjY2MSAzMS40NzFWMzIuOTA3NkgyNDAuMDU2VjMxLjQ3MUgyMzUuNjYxWk0yNDQuMzMxIDMxLjQ3MVYzMi45MDc2SDI0OS4wMDVDMjQ5LjAwNSAzMi4yMjk2IDI0OC43MjYgMzEuNDcxIDI0OC43MjYgMzEuNDcxSDI0NC4zMzFWMzEuNDcxWk0yNTIuOTYgMzEuNDcxVjMyLjkwNzZIMjU3LjM1NVYzMS40NzFIMjUyLjk2Wk0yNTkuMTUxIDMxLjQ3MUwyNTkuNjY2IDMyLjkwNzZIMjYzLjcxM0wyNjQuMjMyIDMxLjQ3MUgyNTkuMTUxWk0yNjUuOTg0IDMxLjQ3MVYzMi45MDc2SDI3MC4zNzlWMzEuNDcxSDI2NS45ODRaTTIyMS4yMzcgMzQuMjY1VjM1LjcwMzdIMjMxLjM4NlYzNC4yNjVIMjIxLjIzN1pNMjMyLjc0NCAzNC4yNjVWMzUuNzAzN0gyNDguMzY3QzI0OC42OTYgMzUuMzc0MyAyNDguODg0IDM0LjI2NSAyNDguODg0IDM0LjI2NUgyMzIuNzQ0VjM0LjI2NVpNMjUwLjEyMyAzNC4yNjVWMzUuNzAzN0gyNTcuMzU1VjM0LjI2NUgyNTAuMTIzWk0yNjAuMTUxIDM0LjI2NUwyNjAuNjggMzUuNzAzN0gyNjIuNzM5TDI2My4yMzYgMzQuMjY1SDI2MC4xNTFaTTI2NS45ODQgMzQuMjY1VjM1LjcwMzdIMjczLjI5NVYzNC4yNjVIMjY1Ljk4NFpNMjIxLjIzNyAzNy4wNjFWMzguNDk3N0gyMzEuMzg2VjM3LjA2MUgyMjEuMjM3Wk0yMzIuNzQ0IDM3LjA2MVYzOC40OTU2SDI0My43NzNDMjQ1LjcyOSAzOC40OTU2IDI0Ny4yMDYgMzcuMDYxIDI0Ny4yMDYgMzcuMDYxSDIzMi43NDRaTTI1MC4xMjMgMzcuMDYxVjM4LjQ5NzdIMjU3LjM1NVYzNy4wNjFIMjUwLjEyM1pNMjYxLjE1NSAzNy4wNjFMMjYxLjY2NCAzOC40OTM2TDI2MS43NTIgMzguNDk1NkwyNjIuMjY5IDM3LjA2MUgyNjEuMTU1VjM3LjA2MVpNMjY1Ljk4NCAzNy4wNjFWMzguNDk3N0gyNzMuMjk1VjM3LjA2MUgyNjUuOTg0WiIgZmlsbD0iIzFGNzBDMSIvPg0KPC9nPg0KPGRlZnM+DQo8Y2xpcFBhdGggaWQ9ImNsaXAwXzU4XzExMSI+DQo8cmVjdCB3aWR0aD0iNDQuNDQ3MyIgaGVpZ2h0PSIyOS42MzE1IiBmaWxsPSJ3aGl0ZSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNzUzLjk1NSAxNC44MTU1KSIvPg0KPC9jbGlwUGF0aD4NCjxjbGlwUGF0aCBpZD0iY2xpcDFfNThfMTExIj4NCjxyZWN0IHdpZHRoPSI3Ni41NDgxIiBoZWlnaHQ9IjE2LjM1MDciIGZpbGw9IndoaXRlIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSg1MjUuNTk5IDIwLjk4ODkpIi8+DQo8L2NsaXBQYXRoPg0KPGNsaXBQYXRoIGlkPSJjbGlwMl81OF8xMTEiPg0KPHJlY3Qgd2lkdGg9IjUyLjEzNzIiIGhlaWdodD0iMjAuOTk4NyIgZmlsbD0id2hpdGUiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDIyMS4xNTggMTcuNDk5KSIvPg0KPC9jbGlwUGF0aD4NCjwvZGVmcz4NCjwvc3ZnPg0K\'style="width: 742.5px;\n                    position: relative;\n                    top: 123px;\n                    left: 32px;"/>\n                    <a href="'.concat(t,'" style="float: left;\n                    border-radius: 56px;\n                    background: #0D6EFD;\n                    padding-top: 12px;\n                    width: 280px;\n                    height: 45px;\n                    text-align: center;\n                    position: relative;\n                    top: 141px;\n                    left: 270px;\n                    font-size: 17px;\n                    color: white;\n                    text-decoration: none;\n                    line-height: 125%;\n                    letter-spacing: 0.02em;">Claim your free account</a>\n                        <div style="\n                        font-size: 14px;\n                        position: relative;\n                        top: 197px;\n                        left: 15px;\n                        letter-spacing: 0.02em;\n                        font-weight: 500;\n                        line-height: 125%;">have a Syncfusion account? <a\n                href="https://www.syncfusion.com/account/login?ReturnUrl=/account/login"\n                style="text-decoration: none;\n                color: #0D6EFD;\n                font-weight: 500;">Sign In</a></div>\n                    </div>\n                </div>')});document.body.appendChild(r)}else{var n=sf.base.createElement("div",{innerHTML:"<img src='data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPGcgY2xpcC1wYXRoPSJ1cmwoI2NsaXAwXzE5OV80KSI+CjxwYXRoIGQ9Ik0xMiAyMUMxNi45NzA2IDIxIDIxIDE2Ljk3MDYgMjEgMTJDMjEgNy4wMjk0NCAxNi45NzA2IDMgMTIgM0M3LjAyOTQ0IDMgMyA3LjAyOTQ0IDMgMTJDMyAxNi45NzA2IDcuMDI5NDQgMjEgMTIgMjFaIiBzdHJva2U9IiM3MzczNzMiIHN0cm9rZS13aWR0aD0iMiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIi8+CjxwYXRoIGQ9Ik0xMS4yNSAxMS4yNUgxMlYxNi41SDEyLjc1IiBmaWxsPSIjNjE2MDYzIi8+CjxwYXRoIGQ9Ik0xMS4yNSAxMS4yNUgxMlYxNi41SDEyLjc1IiBzdHJva2U9IiM3MzczNzMiIHN0cm9rZS13aWR0aD0iMiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIi8+CjxwYXRoIGQ9Ik0xMS44MTI1IDlDMTIuNDMzOCA5IDEyLjkzNzUgOC40OTYzMiAxMi45Mzc1IDcuODc1QzEyLjkzNzUgNy4yNTM2OCAxMi40MzM4IDYuNzUgMTEuODEyNSA2Ljc1QzExLjE5MTIgNi43NSAxMC42ODc1IDcuMjUzNjggMTAuNjg3NSA3Ljg3NUMxMC42ODc1IDguNDk2MzIgMTEuMTkxMiA5IDExLjgxMjUgOVoiIGZpbGw9IiM3MzczNzMiLz4KPC9nPgo8ZGVmcz4KPGNsaXBQYXRoIGlkPSJjbGlwMF8xOTlfNCI+CjxyZWN0IHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgZmlsbD0id2hpdGUiLz4KPC9jbGlwUGF0aD4KPC9kZWZzPgo8L3N2Zz4K' style=\"\n            position: absolute;\n            left: 16px;\n            height: 24px;\"/><span>".concat(e,' <a style="text-decoration: none;color: #0D6EFD;font-weight: 500;" href="').concat(t,'">Claim your free account</a>.</span>')});n.setAttribute("style","position: fixed;\n            top: 10px;\n            left: 10px;\n            right: 10px;\n            font-size: 14px;\n            background: #EEF2FF;\n            color: #222222;\n            z-index: 999999999;\n            text-align: left;\n            border: 1px solid #EEEEEE;\n            padding: 10px 11px 10px 50px;\n            border-radius: 8px;\n            font-family: Helvetica Neue, Helvetica, Arial;"),document.body.appendChild(n)}}};sf.base.enableBlazorMode(),window.sfBlazor=window.sfBlazor||{},Object.assign(window.sfBlazor,i)}});